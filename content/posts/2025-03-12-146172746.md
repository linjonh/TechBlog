---
layout: post
title: "CentOS-7-64-安装-Docker"
date: 2025-03-12 16:26:13 +0800
description: "在虚拟机中安装 Docker 是一种常见的测试和开发环境搭建方式。通过在虚拟机上安装 Docker，可以方便地创建和管理容器化应用，同时避免对宿主机系统造成影响。以下是在 CentOS 7 虚拟机中安装 Docker 的详细步骤。"
keywords: "CentOS 7 64 安装 Docker"
categories: ['入门与实战指南', 'Docker']
tags: ['Eureka', 'Docker', 'Centos']
artid: "146172746"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146172746
    alt: "CentOS-7-64-安装-Docker"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146172746
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146172746
cover: https://bing.ee123.net/img/rand?artid=146172746
image: https://bing.ee123.net/img/rand?artid=146172746
img: https://bing.ee123.net/img/rand?artid=146172746
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     CentOS 7 64 安装 Docker
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-github-gist" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h4>
     <a id="_0">
     </a>
     前言
    </h4>
    <p>
     在虚拟机中安装 Docker 是一种常见的测试和开发环境搭建方式。通过在虚拟机上安装 Docker，可以方便地创建和管理容器化应用，同时避免对宿主机系统造成影响。以下是在 CentOS 7 虚拟机中安装 Docker 的详细步骤。
    </p>
    <hr/>
    <h4>
     <a id="1__5">
     </a>
     1.
     <strong>
      更新系统（可以不操作）
     </strong>
    </h4>
    <p>
     在安装 Docker 之前，建议先更新虚拟机中的系统软件包：
    </p>
    <pre><code class="prism language-bash"><span class="token function">sudo</span> yum update <span class="token parameter variable">-y</span>
</code></pre>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/18e3594d890048789b906256575e131b.png"/>
    </p>
    <h4>
     <a id="2__Docker_11">
     </a>
     2.
     <strong>
      卸载旧版本的 Docker（如果已安装）
     </strong>
    </h4>
    <h5>
     <a id="21__Docker_12">
     </a>
     2.1 确认系统中是否已安装 Docker
    </h5>
    <p>
     运行以下命令检查系统中是否已安装 Docker 相关包：
    </p>
    <pre><code class="prism language-bash">yum list installed <span class="token operator">|</span> <span class="token function">grep</span> <span class="token function">docker</span>
</code></pre>
    <p>
     如果没有任何输出，则说明系统中未安装 Docker。
    </p>
    <h5>
     <a id="22__Docker_18">
     </a>
     2.2 如果虚拟机中之前安装过 Docker，需要先卸载旧版本
    </h5>
    <h6>
     <a id="221___Docker__19">
     </a>
     2.2.1 停止 Docker 服务
    </h6>
    <p>
     在卸载 Docker 之前，需要先停止 Docker 服务：
    </p>
    <pre><code class="prism language-bash"><span class="token function">sudo</span> systemctl stop <span class="token function">docker</span>
</code></pre>
    <h6>
     <a id="222___Docker__24">
     </a>
     2.2.2 禁用 Docker 自启动
    </h6>
    <pre><code class="prism language-bash"><span class="token function">sudo</span> systemctl disable <span class="token function">docker</span>
</code></pre>
    <h6>
     <a id="223___Docker__28">
     </a>
     2.2.3 卸载 Docker 软件包
    </h6>
    <p>
     运行以下命令卸载 Docker 及其相关组件：
    </p>
    <pre><code class="prism language-bash"><span class="token function">sudo</span> yum remove <span class="token function">docker</span>  docker-client docker-client-latest docker-common docker-latest docker-latest-logrotate docker-logrotate docker-engine docker-ce docker-ce-cli  containerd.io <span class="token punctuation">\</span>
docker-buildx-plugin <span class="token punctuation">\</span>
docker-compose-plugin
</code></pre>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/0347bca8518342c8b633f62f80154ef9.png"/>
    </p>
    <h6>
     <a id="224___Docker__36">
     </a>
     2.2.4 卸载 Docker 软件包
    </h6>
    <p>
     删除 Docker 的数据目录和配置文件：
    </p>
    <pre><code class="prism language-bash"><span class="token function">sudo</span> <span class="token function">rm</span> <span class="token parameter variable">-rf</span> /var/lib/docker
<span class="token function">sudo</span> <span class="token function">rm</span> <span class="token parameter variable">-rf</span> /etc/docker
</code></pre>
    <h6>
     <a id="225__Docker__42">
     </a>
     2.2.5 删除 Docker 用户组
    </h6>
    <p>
     如果之前创建了 Docker 用户组，可以删除该用户组：
    </p>
    <pre><code class="prism language-bash"><span class="token function">sudo</span> <span class="token function">groupdel</span> <span class="token function">docker</span>
</code></pre>
    <h6>
     <a id="226__YUM__47">
     </a>
     2.2.6 清理 YUM 配置
    </h6>
    <p>
     删除 Docker 的 YUM 仓库配置文件：
    </p>
    <pre><code class="prism language-bash"><span class="token function">sudo</span> <span class="token function">rm</span> <span class="token parameter variable">-rf</span> /etc/yum.repos.d/docker-ce*
</code></pre>
    <h6>
     <a id="227__YUM__52">
     </a>
     2.2.7 清理 YUM 缓存
    </h6>
    <p>
     清理 YUM 缓存以确保系统状态一致：
    </p>
    <pre><code class="prism language-bash"><span class="token function">sudo</span> yum clean all
</code></pre>
    <h6>
     <a id="228__Docker__57">
     </a>
     2.2.8 验证 Docker 是否已完全卸载
    </h6>
    <p>
     运行以下命令检查系统中是否还残留 Docker 组件：
    </p>
    <pre><code class="prism language-bash">yum list installed <span class="token operator">|</span> <span class="token function">grep</span> <span class="token function">docker</span>
</code></pre>
    <p>
     如果没有任何输出，则表示 Docker 已完全卸载。
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/3615faa014b64466a3a2cdf692480223.png"/>
    </p>
    <h4>
     <a id="3__64">
     </a>
     3.
     <strong>
      安装必要的依赖
     </strong>
    </h4>
    <p>
     安装一些必要的依赖包，这些包用于管理 Docker 的存储和配置：
    </p>
    <pre><code class="prism language-bash"><span class="token function">sudo</span> yum <span class="token function">install</span> <span class="token parameter variable">-y</span> yum-utils device-mapper-persistent-data lvm2
</code></pre>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/7ae7cfc12ae04437b7456baf8dd183c1.png"/>
    </p>
    <h4>
     <a id="4__Docker__YUM__70">
     </a>
     4.
     <strong>
      添加 Docker 的官方 YUM 仓库
     </strong>
    </h4>
    <p>
     使用
     <code>
      yum-utils
     </code>
     添加 Docker 的官方仓库：
    </p>
    <pre><code class="prism language-bash"><span class="token function">sudo</span> yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo
</code></pre>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/e8480581080744779779287e2ec5decf.jpeg"/>
    </p>
    <h4>
     <a id="5__Docker_76">
     </a>
     5.
     <strong>
      安装 Docker
     </strong>
    </h4>
    <p>
     从 Docker 的官方仓库安装最新版本的 Docker：
    </p>
    <pre><code class="prism language-bash">yum <span class="token parameter variable">-y</span> <span class="token function">install</span> <span class="token function">docker</span>
</code></pre>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/4bdb65ce00644d0b974a27ecf45205f4.png"/>
    </p>
    <h4>
     <a id="6__Docker__82">
     </a>
     6.
     <strong>
      启动 Docker 服务
     </strong>
    </h4>
    <p>
     安装完成后，启动 Docker 守护进程并设置开机自启：
    </p>
    <pre><code class="prism language-bash"><span class="token function">sudo</span> systemctl start <span class="token function">docker</span>
<span class="token function">sudo</span> systemctl <span class="token builtin class-name">enable</span> <span class="token function">docker</span>
</code></pre>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/a8d3cafe6f50496abdcd2e4d1b53b47c.png"/>
    </p>
    <h4>
     <a id="7__Docker__89">
     </a>
     7.
     <strong>
      验证 Docker 是否安装成功
     </strong>
    </h4>
    <p>
     运行一个简单的测试容器来验证 Docker 是否正常工作：
    </p>
    <pre><code class="prism language-bash"><span class="token function">sudo</span> <span class="token function">docker</span> run hello-world
</code></pre>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/8be25529323c40239b80a2fb9d898643.png"/>
    </p>
    <h5>
     <a id="71_Docker_helloworld__95">
     </a>
     7.1
     <strong>
      Docker运行/拉取 hello-world 镜像失败或超时
     </strong>
    </h5>
    <pre><code class="prism language-bash"><span class="token function">sudo</span> <span class="token function">mkdir</span> <span class="token parameter variable">-p</span> /etc/docker
<span class="token function">sudo</span> <span class="token function">tee</span> /etc/docker/daemon.json <span class="token operator">&lt;&lt;-</span><span class="token string">'EOF'
{
    "registry-mirrors": [
        "https://dockerproxy.com",
        "https://hub-mirror.c.163.com",
        "https://mirror.baidubce.com",
        "https://ccr.ccs.tencentyun.com",
        "https://zfzbet67.mirror.aliyuncs.com"
      ]
}
EOF</span>
<span class="token function">sudo</span> systemctl daemon-reload
<span class="token function">sudo</span> systemctl restart <span class="token function">docker</span>
systemctl status <span class="token function">docker</span>
</code></pre>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/fb230594b8224fbdb5e2beab64ccca74.png"/>
    </p>
    <h4>
     <a id="8__Docker__114">
     </a>
     8.
     <strong>
      （可选）将用户添加到 Docker 组
     </strong>
    </h4>
    <p>
     默认情况下，Docker 需要以 root 用户运行。为了避免每次运行 Docker 命令时都需要使用
     <code>
      sudo
     </code>
     ，可以将当前用户添加到
     <code>
      docker
     </code>
     组：
    </p>
    <pre><code class="prism language-bash"><span class="token function">sudo</span> <span class="token function">usermod</span> <span class="token parameter variable">-aG</span> <span class="token function">docker</span> <span class="token environment constant">$USER</span>
</code></pre>
    <p>
     然后重新登录或重启虚拟机以使更改生效。
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/b05cec9355da40df8b4e38a9900dde56.png"/>
     <br/>
     如果Docker提示组不存在，使用如下方式：
    </p>
    <h5>
     <a id="81__docker_122">
     </a>
     8.1 创建
     <code>
      docker
     </code>
     组
    </h5>
    <p>
     如果
     <code>
      docker
     </code>
     组确实不存在，可以通过以下命令创建：
    </p>
    <pre><code class="prism language-bash"><span class="token function">sudo</span> <span class="token function">groupadd</span> <span class="token function">docker</span>
</code></pre>
    <p>
     如果组已存在，该命令会提示“group ‘docker’ already exists”，但这不会影响后续操作。
    </p>
    <h5>
     <a id="82_docker_128">
     </a>
     8.2. 将用户添加到
     <code>
      docker
     </code>
     组
    </h5>
    <p>
     创建组后，需要将当前用户添加到
     <code>
      docker
     </code>
     组中：
    </p>
    <pre><code class="prism language-bash"><span class="token function">sudo</span> <span class="token function">usermod</span> <span class="token parameter variable">-aG</span> <span class="token function">docker</span> <span class="token environment constant">$USER</span>
</code></pre>
    <p>
     此命令会将当前用户（
     <code>
      $USER
     </code>
     ）添加到
     <code>
      docker
     </code>
     组中，而不会移除用户原有的其他组。
    </p>
    <h5>
     <a id="83__134">
     </a>
     8.3. 应用组变更
    </h5>
    <p>
     为了让组变更生效，可以执行以下命令：
    </p>
    <pre><code class="prism language-bash">newgrp <span class="token function">docker</span>
</code></pre>
    <p>
     或者重新登录当前用户。
    </p>
    <h5>
     <a id="84__140">
     </a>
     8.4. 检查组成员资格
    </h5>
    <p>
     通过以下命令确认用户是否已成功加入
     <code>
      docker
     </code>
     组：
    </p>
    <pre><code class="prism language-bash"><span class="token function">groups</span>
</code></pre>
    <p>
     如果输出中包含
     <code>
      docker
     </code>
     ，则表示用户已正确加入。
    </p>
    <h5>
     <a id="85_Docker_146">
     </a>
     8.5. 检查Docker权限
    </h5>
    <p>
     如果问题仍未解决，可以检查Docker的socket文件权限：
    </p>
    <pre><code class="prism language-bash"><span class="token function">ls</span> <span class="token parameter variable">-l</span> /var/run/docker.sock
</code></pre>
    <p>
     该文件的组所有权应为
     <code>
      docker
     </code>
     ，权限应为
     <code>
      srw-rw----
     </code>
     。如果不是，可以通过以下命令修复：
    </p>
    <pre><code class="prism language-bash"><span class="token function">sudo</span> <span class="token function">chown</span> root:docker /var/run/docker.sock
<span class="token function">sudo</span> <span class="token function">chmod</span> <span class="token number">660</span> /var/run/docker.sock
</code></pre>
    <h5>
     <a id="86_Docker_156">
     </a>
     8.6. 重启Docker服务
    </h5>
    <p>
     如果上述步骤仍未解决问题，可以尝试重启Docker服务：
    </p>
    <pre><code class="prism language-bash"><span class="token function">sudo</span> systemctl restart <span class="token function">docker</span>
</code></pre>
    <h5>
     <a id="87_Docker_161">
     </a>
     8.7. 测试Docker命令
    </h5>
    <p>
     完成上述步骤后，运行以下命令测试Docker是否可以正常工作：
    </p>
    <pre><code class="prism language-bash"><span class="token function">docker</span> <span class="token function">ps</span>
</code></pre>
    <p>
     如果不再提示权限问题，则表示问题已解决。
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/a70938fdeb28419ab6014382edc2df7d.png"/>
    </p>
    <p>
     如果问题仍然存在，建议检查Docker的安装是否完整，或者查看系统日志以获取更多信息。
    </p>
    <h4>
     <a id="9__Docker_Compose_170">
     </a>
     9.
     <strong>
      安装 Docker Compose（可选）
     </strong>
    </h4>
    <p>
     如果需要使用 Docker Compose，可以通过以下命令安装：
    </p>
    <pre><code class="prism language-bash"><span class="token function">sudo</span> <span class="token function">curl</span> <span class="token parameter variable">-L</span> <span class="token string">"https://github.com/docker/compose/releases/latest/download/docker-compose-<span class="token variable"><span class="token variable">$(</span><span class="token function">uname</span> <span class="token parameter variable">-s</span><span class="token variable">)</span></span>-<span class="token variable"><span class="token variable">$(</span><span class="token function">uname</span> <span class="token parameter variable">-m</span><span class="token variable">)</span></span>"</span> <span class="token parameter variable">-o</span> /usr/local/bin/docker-compose
<span class="token function">sudo</span> <span class="token function">chmod</span> +x /usr/local/bin/docker-compose
</code></pre>
    <h3>
     <a id="httpsiblogcsdnimgcndirect35b693f73678495198eab7814ffa5df5png_176">
     </a>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/35b693f73678495198eab7814ffa5df5.png"/>
    </h3>
    <h4>
     <a id="_178">
     </a>
     注意事项
    </h4>
    <ol>
     <li>
      <strong>
       内核版本
      </strong>
      ：Docker 需要较新的内核版本（建议 3.10 或更高）。如果虚拟机的内核版本较低，可能需要升级内核。
     </li>
     <li>
      <strong>
       虚拟机网络配置
      </strong>
      ：确保虚拟机的网络配置正确，以便 Docker 容器可以正常访问外部网络。
     </li>
     <li>
      <strong>
       存储空间
      </strong>
      ：Docker 容器和镜像会占用一定的磁盘空间，请确保虚拟机有足够的存储空间。
     </li>
     <li>
      <strong>
       防火墙规则
      </strong>
      ：如果虚拟机启用了防火墙，可能需要调整防火墙规则以允许 Docker 容器的网络通信。
     </li>
    </ol>
    <p>
     通过以上步骤，您可以在 CentOS 7 虚拟机中成功安装并运行 Docker。
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f71715f34303732383238352f:61727469636c652f64657461696c732f313436313732373436" class_="artid" style="display:none">
 </p>
</div>


