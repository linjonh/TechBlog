---
layout: post
title: "蓝队基本技能-web入侵指南-日志分析-后门查杀-流量分析"
date: 2025-03-13 18:10:24 +0800
description: "为了赶工我是没学过红队的，首先我们要做的是1、拿到用户给的web的时候 要先知道 web的源码  服务器  中间件  数据库这些信息2、知道web日志放在哪里   会一些基本的分析3、webshell查杀的基本技能4、会分析基本的工具链 会写报告。"
keywords: "蓝队基本技能 && web入侵指南 && 日志分析 后门查杀 &&流量分析"
categories: ['未分类']
tags: ['蓝队', '日志分析', '入门']
artid: "146143907"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146143907
    alt: "蓝队基本技能-web入侵指南-日志分析-后门查杀-流量分析"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146143907
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146143907
cover: https://bing.ee123.net/img/rand?artid=146143907
image: https://bing.ee123.net/img/rand?artid=146143907
img: https://bing.ee123.net/img/rand?artid=146143907
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     蓝队基本技能 &amp;&amp; web入侵指南 &amp;&amp; 日志分析 后门查杀 &amp;&amp;流量分析
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <h3>
     前言
    </h3>
    <p>
     为了赶工我是没学过红队的，首先我们要做的是
    </p>
    <p>
     1、拿到用户给的web的时候 要先知道 web的源码  服务器  中间件  数据库这些信息
    </p>
    <p>
     2、知道web日志放在哪里   会一些基本的分析
    </p>
    <p>
     3、webshell查杀的基本技能
    </p>
    <p>
     4、会分析基本的工具链 会写报告
    </p>
    <h3>
     .NET + IIS
    </h3>
    <p>
     <img alt="" height="811" src="https://i-blog.csdnimg.cn/direct/f1e176b8ced64436a60acdbd0e823beb.png" width="1222"/>
    </p>
    <p>
     <img alt="" height="752" src="https://i-blog.csdnimg.cn/direct/10d8ecbc9d66443b9a2819c18ea98040.png" width="1071"/>
    </p>
    <p>
     <img alt="" height="721" src="https://i-blog.csdnimg.cn/direct/ea5408231ca1452381233462191615b7.png" width="1127"/>
    </p>
    <p>
     <img alt="" height="787" src="https://i-blog.csdnimg.cn/direct/d5687cce949241d1a40df3545aa3d531.png" width="1324"/>
    </p>
    <p>
     <img alt="" height="804" src="https://i-blog.csdnimg.cn/direct/be27be83159b43449c98e7c1a870c6b7.png" width="1153"/>
    </p>
    <p>
     配置靶机信息
    </p>
    <p>
     <img alt="" height="616" src="https://i-blog.csdnimg.cn/direct/ba627f633ce84f6ba9ac443f639b6783.png" width="913"/>
    </p>
    <p>
     知道路径之后我们模拟一下  sqlmap注入 分析一下时间 和攻击者的手段
     <img alt="" height="708" src="https://i-blog.csdnimg.cn/direct/01c9450aba554f5c8ebb72d962786eeb.png" width="1517"/>
    </p>
    <p>
     这边只是爆出了他的一些数据库
    </p>
    <p>
     <img alt="" height="646" src="https://i-blog.csdnimg.cn/direct/527da4590800452dbcef63a979ac1a5a.png" width="1084"/>
    </p>
    <p>
     在高级设置中去查看
     <img alt="" height="735" src="https://i-blog.csdnimg.cn/direct/311c5f0d85ec4aa8961943a6a45bc066.png" width="1029"/>
    </p>
    <p>
     查看目录
    </p>
    <h3>
     PHP+apache
    </h3>
    <p>
     首先呢 先了解一下 这个中间件的基本的目录结构
    </p>
    <p>
     <img alt="" height="636" src="https://i-blog.csdnimg.cn/direct/f8c119837cec44eaa9700063766e0088.png" width="1103"/>
    </p>
    <p>
     然后这个中间件内有个 logs目录就是日志文件
     <img alt="" height="690" src="https://i-blog.csdnimg.cn/direct/2860c08ebd7a409f8d581a9c28b62b68.png" width="1055"/>
    </p>
    <p>
     然后我们搭建一个TP框架的网站
    </p>
    <pre><code>http://192.168.170.79:91/</code></pre>
    <p>
     外网不用访问内网地址不然只会向本机的服务器进行寻址
     <img alt="" height="975" src="https://i-blog.csdnimg.cn/direct/880b1086bd5b4d06994ecb47fa2fb047.png" width="1403"/>
    </p>
    <p>
     找access.log文件
    </p>
    <p>
     <img alt="" height="808" src="https://i-blog.csdnimg.cn/direct/9f9f78074fe24f08a19bb1ea5c8cb612.png" width="2059"/>
    </p>
    <p>
     模拟一下攻击 利用TP框架进行 攻击网站
     <img alt="" height="1220" src="https://i-blog.csdnimg.cn/direct/0120d09b661f44d3a8a644801563aabd.png" width="1819"/>
    </p>
    <p>
     这个时候  是攻击者完成攻击了
    </p>
    <p>
     所以我们需要在日志中找到攻击的时间  方法   攻击者的ip
     <img alt="" height="1133" src="https://i-blog.csdnimg.cn/direct/8413f69f1510413a90f5dee99c045015.png" width="2164"/>
    </p>
    <p>
     攻击时间我们可以记录一下我们进行操作的时间  然后找之后的
    </p>
    <p>
     我们可以知道的是这个是个命令执行   并且知道他是使用工具进行操作的（工具操作的一大特点就是在短时间内有大量的请求包）
    </p>
    <p>
     当然这个txt日志有个缺点就是  post 是没有data的     只有显示有post模式
    </p>
    <h3>
     Java+tomcat
    </h3>
    <p>
     tomcat也是个集成 的中间件
    </p>
    <p>
     tomcat的基本配置  官网下载之后   找到
    </p>
    <p>
     配置环境变量
     <img alt="" height="151" src="https://i-blog.csdnimg.cn/direct/28d0255f6716464f9a1ff98466490bd8.png" width="651"/>
    </p>
    <p>
     <img alt="" height="442" src="https://i-blog.csdnimg.cn/direct/e7866a8a5cef419a8a6f013fe6848473.png" width="392"/>
    </p>
    <p>
     直接在汤姆猫下  cmd   输入  startup.bat    启动起来
    </p>
    <p>
     如果报错 ：不知道jar和jre
    </p>
    <p>
     复制一下错误去  ai 问一下  ：  应该是直接在文件头配置  jar=""   jre = "" 的路径
    </p>
    <p>
     直接启动
     <img alt="" height="626" src="https://i-blog.csdnimg.cn/direct/f9a389d3a1a14f439fbec505abd7a674.png" width="1113"/>
    </p>
    <p>
     启动成功的页面
    </p>
    <p>
     <img alt="" height="1014" src="https://i-blog.csdnimg.cn/direct/6c2c32c2fd4e49d7aaf2db7603b0de3f.png" width="1867"/>
     <br/>
     配置管理员的用户账号和密码 ：
    </p>
    <p>
     <img alt="" height="776" src="https://i-blog.csdnimg.cn/direct/7cec41a72952443893765eb8bc9a52e0.png" width="1431"/>
    </p>
    <pre><code>&lt;role rolename="manager-gui"/&gt;
&lt;user username="tomcat" password="123456" roles="manager-gui"/&gt;</code></pre>
    <p>
     之后正常登录  我们来完成实验 ：
    </p>
    <p>
     先完成日志分析 之后再说webshell的流量分析
     <br/>
     模拟上传tomcat后门 ：
    </p>
    <p>
     <img alt="" height="191" src="https://i-blog.csdnimg.cn/direct/b97eab5f4b8b493597406a6468b18397.png" width="679"/>
    </p>
    <p>
     只能上传war文件  整个骚操作 ：
     <img alt="" height="618" src="https://i-blog.csdnimg.cn/direct/0e353b0a4e83402eaa4d96089dafdeec.png" width="1199"/>
    </p>
    <p>
     之后创建一个文件夹  改名为 xxx和jar文件一样的
     <img alt="" height="93" src="https://i-blog.csdnimg.cn/direct/9cc7afba83864661a34ddc2fadf474e4.png" width="115"/>
     压缩为压缩包
     <img alt="" height="85" src="https://i-blog.csdnimg.cn/direct/023a63bb6935496ea5f8b634e3740abd.png" width="86"/>
    </p>
    <p>
     改个名改为   xxx.war
     <img alt="" height="81" src="https://i-blog.csdnimg.cn/direct/062abea40b244afd9ae1a2b846985e19.png" width="91"/>
     上传一下
     <img alt="" height="177" src="https://i-blog.csdnimg.cn/direct/55870f4bf9d2422ca0fd3c70aa3fba4a.png" width="1154"/>
    </p>
    <p>
     复制一下连接
     <img alt="" height="335" src="https://i-blog.csdnimg.cn/direct/3fc4242b521b4fa48c54ac75933335ba.png" width="828"/>
    </p>
    <p>
     网站后台上传成功
    </p>
    <p>
     分析日志
     <img alt="" height="426" src="https://i-blog.csdnimg.cn/direct/1ed5f6bbb77849e888d5e6db47fcac4b.png" width="1693"/>
    </p>
    <h3 style="background-color:transparent">
     JAVA shiro框架
    </h3>
    <p>
     这个情况是直接jar包启动的没有日志啊？ 日志就是在这个黑框框内的
    </p>
    <p>
     <img alt="" height="626" src="https://i-blog.csdnimg.cn/direct/7be4237ac92a49adb968c6025612571e.png" width="1113"/>
    </p>
    <p>
     当然有骚操作   jar包反编译  看看内容
     <img alt="" height="403" src="https://i-blog.csdnimg.cn/direct/20d2b1f269224ef88250b9cdb4578e95.png" width="923"/>
    </p>
    <p>
     <img alt="" height="810" src="https://i-blog.csdnimg.cn/direct/d8d4049fa49c4af1a33250379cac0ac7.png" width="1063"/>
    </p>
    <p>
     那就得使用流量记录工具 wireshark  进行记录
    </p>
    <p>
     关闭混杂模式 （什么是混杂模式就是监听整个网段不论是不是给你的数据）
     <img alt="" height="728" src="https://i-blog.csdnimg.cn/direct/ca975fcb16a047b5a6ce912365da3edd.png" width="1166"/>
    </p>
    <p>
     监听之后我们进行shiro框架的利用
     <img alt="" height="772" src="https://i-blog.csdnimg.cn/direct/67820bc0ecd34dc7872b120578a5c8aa.png" width="976"/>
    </p>
    <p>
     开启shiro检测工具
     <img alt="" height="347" src="https://i-blog.csdnimg.cn/direct/594b0e90313346c7aa9c00142bf1c5ca.png" width="1122"/>
    </p>
    <p>
     网络监听起来
    </p>
    <p>
     <img alt="" height="769" src="https://i-blog.csdnimg.cn/direct/a9157b6e3582497490d72c3fb1cad9ef.png" width="1139"/>
    </p>
    <p>
     看一下监听
    </p>
    <p>
     流量中找到http  然后复制一次框架利用的命令 ：
     <img alt="" height="937" src="https://i-blog.csdnimg.cn/direct/bbad0326a8a341ef96db32c9841a82c8.png" width="1424"/>
    </p>
    <p>
     shiro框架漏洞的一个特点就是在cookie中 有个
     <span style="color:#fe2c24">
      <span style="background-color:#dad5e9">
       rememberMe=1
      </span>
     </span>
    </p>
    <p>
     所以漏洞框架的利用也是在这个上面进行的
    </p>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f:672e6373646e2e6e65742f323330315f38313135353339312f:61727469636c652f64657461696c732f313436313433393037" class_="artid" style="display:none">
 </p>
</div>


