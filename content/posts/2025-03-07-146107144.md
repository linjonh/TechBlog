---
layout: post
title: "Jenkins在Windows上的使用二自动拉取打包部署"
date: 2025-03-07 23:48:22 +0800
description: "访问部署好的Jenkins服务器网址localhost:8080，完成默认插件的安装后，接下来将使用SSH登录远程主机以实现自动化部署。在dashboard->Manage Jenkins->system下配置远程主机的ip、用户名、密码等。在dashboard->Manage Jenkins->tools里配置。密码不是直接填写的，在【添加】选项里完成“密码本”的配置。新建item，输入任意的名称，进入item配置。"
keywords: "Jenkins在Windows上的使用（二）：自动拉取、打包、部署"
categories: ['未分类']
tags: ['运维', 'Windows', 'Jenkins']
artid: "146107144"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146107144
    alt: "Jenkins在Windows上的使用二自动拉取打包部署"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146107144
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146107144
cover: https://bing.ee123.net/img/rand?artid=146107144
image: https://bing.ee123.net/img/rand?artid=146107144
img: https://bing.ee123.net/img/rand?artid=146107144
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     Jenkins在Windows上的使用（二）：自动拉取、打包、部署
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h3>
     <a id="Jenkins_0">
     </a>
     （一）Jenkins全局配置
    </h3>
    <p>
     访问部署好的Jenkins服务器网址localhost:8080，完成默认插件的安装后，接下来将使用SSH登录远程主机以实现自动化部署。
    </p>
    <h4>
     <a id="1__2">
     </a>
     1. 配置插件
    </h4>
    <p>
     选择dashboard-&gt;Manage Jenkins-&gt;plugins
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/bd5332991d3f4d9d9c666f223a4ef921.png">
      <br/>
      安装下面两个插件
      <br/>
      <code>
       Publish over SSH
      </code>
      <br/>
      <code>
       Deploy to container Plugin
      </code>
     </img>
    </p>
    <h4>
     <a id="2__8">
     </a>
     2. 配置远程主机
    </h4>
    <p>
     在dashboard-&gt;Manage Jenkins-&gt;system下配置远程主机的ip、用户名、密码等
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/33a3d55ec81f4128846855456aee2828.png"/>
    </p>
    <h4>
     <a id="3mavengitjdk_11">
     </a>
     3.配置maven、git、jdk的路径
    </h4>
    <p>
     在dashboard-&gt;Manage Jenkins-&gt;tools里配置
    </p>
    <ul>
     <li>
      <p>
       修改maven的配置文件路径、根目录
       <br/>
       <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/d7f760d6bbd14493af06d8cc732b8f32.png">
        <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/7cbf4998c43a451ba62ddd1deb47ab74.png"/>
       </img>
      </p>
     </li>
     <li>
      <p>
       配置git路径
       <br/>
       <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/8600ae5c20604260a72abe995e29628c.png"/>
      </p>
     </li>
     <li>
      <p>
       配置jdk路径
       <br/>
       <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/b645b06caed64ebf994135be7c3ddb73.png"/>
      </p>
     </li>
    </ul>
    <h3>
     <a id="item_20">
     </a>
     （二）新建item
    </h3>
    <p>
     新建item，输入任意的名称，进入item配置
    </p>
    <h4>
     <a id="1_github_22">
     </a>
     1. 选择github项目，配置项目的仓库地址、用户、密码
    </h4>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/4828208f519841d88a020d2b3f92d966.png">
      密码不是直接填写的，在【添加】选项里完成“密码本”的配置
     </img>
    </p>
    <h4>
     <a id="2maven_25">
     </a>
     2.配置maven命令
    </h4>
    <p>
     这里是先clean然后install
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/cf0aea93adfe4a49b9d444b79f4f2fa2.png"/>
    </p>
    <h4>
     <a id="3_jar_28">
     </a>
     3. 配置需自动上传的jar包和自动部署的脚本
    </h4>
    <p>
     <code>
      demo1
     </code>
     是远程主机的名称
     <br/>
     <code>
      Source files
     </code>
     是需要自动上传到远程主机的jar包，
     <strong>
      路径容易填错，可以填
     </strong>
     <code>
      **/*.jar
     </code>
     ，再根据之后实际传过来的文件修改这个配置
     <br/>
     <code>
      Remove prefix
     </code>
     是需要抹掉的文件前缀，例如
     <code>
      target/
     </code>
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/cfd485dad50c46a38fc416a5fa45abae.png"/>
     <code>
      Exec command
     </code>
     放需要执行的脚本命令
    </p>
    <p>
     启动脚本
     <code>
      start.sh
     </code>
     举例
    </p>
    <pre><code class="prism language-bash"><span class="token shebang important">#!/bin/bash</span>

<span class="token builtin class-name">echo</span> <span class="token string">'Start the program : demo-start-0.0.1-SNAPSHOT.jar'</span>
<span class="token function">chmod</span> <span class="token number">777</span> /var/www/jenkins/demo1/demo-start-0.0.1-SNAPSHOT.jar
<span class="token builtin class-name">echo</span> <span class="token string">'-------Starting-------'</span>

<span class="token function">nohup</span> <span class="token function">java</span> <span class="token parameter variable">-jar</span> /var/www/jenkins/demo1/demo-start-0.0.1-SNAPSHOT.jar <span class="token operator">&gt;</span> myapp.log <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span class="token file-descriptor important">&amp;1</span> <span class="token operator">&amp;</span>
<span class="token builtin class-name">echo</span> <span class="token string">'start success'</span>

</code></pre>
    <p>
     关闭脚本
     <code>
      stop.sh
     </code>
     举例
    </p>
    <pre><code class="prism language-bash"><span class="token shebang important">#!/bin/bash</span>
<span class="token builtin class-name">echo</span> <span class="token string">"Stop Procedure"</span>
<span class="token assign-left variable">pid</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token function">ps</span> <span class="token parameter variable">-ef</span> <span class="token operator">|</span><span class="token function">grep</span> <span class="token function">java</span><span class="token operator">|</span><span class="token function">grep</span> demo-start-0.0.1-SNAPSHOT.jar<span class="token operator">|</span><span class="token function">awk</span> <span class="token string">'{print $2}'</span><span class="token variable">`</span></span>
<span class="token builtin class-name">echo</span> <span class="token string">'old Procedure pid:'</span><span class="token variable">$pid</span>
<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token parameter variable">-n</span> <span class="token string">"<span class="token variable">$pid</span>"</span> <span class="token punctuation">]</span>
<span class="token keyword">then</span>
<span class="token function">kill</span> <span class="token parameter variable">-9</span> <span class="token variable">$pid</span>
<span class="token keyword">fi</span>
</code></pre>
    <h4>
     <a id="_58">
     </a>
     （三）测试及一些遇到的坑
    </h4>
    <ul>
     <li>
      在主面板开始构建项目，测试效果
      <br/>
      <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/37cbf1fa9c9e40ee939ed53725c114f7.png"/>
     </li>
     <li>
      如果jar包运行时显示【没有主机清单】，在pom配置里添上
      <code>
       &lt;skip&gt;false&lt;/skip&gt;
      </code>
     </li>
    </ul>
    <pre><code class="prism language-bash">   <span class="token operator">&lt;</span>build<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>plugins<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>plugin<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>groupId<span class="token operator">&gt;</span>org.apache.maven.plugins<span class="token operator">&lt;</span>/groupId<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>artifactId<span class="token operator">&gt;</span>maven-compiler-plugin<span class="token operator">&lt;</span>/artifactId<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>version<span class="token operator">&gt;</span><span class="token number">3.8</span>.<span class="token operator"><span class="token file-descriptor important">1</span>&lt;</span>/version<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>configuration<span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span>source<span class="token operator">&gt;</span><span class="token number">1</span>.<span class="token operator"><span class="token file-descriptor important">8</span>&lt;</span>/source<span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span>target<span class="token operator">&gt;</span><span class="token number">1</span>.<span class="token operator"><span class="token file-descriptor important">8</span>&lt;</span>/target<span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span>encoding<span class="token operator">&gt;</span>UTF-<span class="token operator"><span class="token file-descriptor important">8</span>&lt;</span>/encoding<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>/configuration<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>/plugin<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>plugin<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>groupId<span class="token operator">&gt;</span>org.springframework.boot<span class="token operator">&lt;</span>/groupId<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>artifactId<span class="token operator">&gt;</span>spring-boot-maven-plugin<span class="token operator">&lt;</span>/artifactId<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>version<span class="token operator">&gt;</span><span class="token number">2.6</span>.1<span class="token operator"><span class="token file-descriptor important">3</span>&lt;</span>/version<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>configuration<span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span>mainClass<span class="token operator">&gt;</span>com.example.demo.DemoApplication<span class="token operator">&lt;</span>/mainClass<span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span>skip<span class="token operator">&gt;</span>false<span class="token operator">&lt;</span>/skip<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>/configuration<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>executions<span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span>execution<span class="token operator">&gt;</span>
                        <span class="token operator">&lt;</span>id<span class="token operator">&gt;</span>repackage<span class="token operator">&lt;</span>/id<span class="token operator">&gt;</span>
                        <span class="token operator">&lt;</span>goals<span class="token operator">&gt;</span>
                            <span class="token operator">&lt;</span>goal<span class="token operator">&gt;</span>repackage<span class="token operator">&lt;</span>/goal<span class="token operator">&gt;</span>
                        <span class="token operator">&lt;</span>/goals<span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span>/execution<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>/executions<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>/plugin<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>/plugins<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>/build<span class="token operator">&gt;</span>
</code></pre>
    <ul>
     <li>
      使用nohup运行jar包时要把错误重定向到指定文件或者合并到标准输出中
      <br/>
      <code>
       nohup java -jar xxx.jar &gt; myapp.log 2&gt;&amp;1 &amp;
      </code>
      合并标准错误和标准输出
      <br/>
      <code>
       nohup java -jar xxx.jar &gt; myapp.log 2&gt; error.log &amp;
      </code>
      将标准错误重定向到error.log文件
      <br/>
      <code>
       nohup java -jar xxx.jar &amp;
      </code>
      这个写法不会记录错误，只会将错误信息显示在终端
     </li>
    </ul>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a:2f2f626c6f672e6373646e2e6e65742f616c6963696e79612f:61727469636c652f64657461696c732f313436313037313434" class_="artid" style="display:none">
 </p>
</div>


