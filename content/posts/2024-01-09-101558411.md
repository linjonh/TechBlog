---
layout: post
title: "怎么高效率批量插入1000条数据到数据库"
date: 2024-01-09 22:18:51 +0800
description: "问题：每隔5毫秒就有30多条数据发送过来，然后需要及时插入到数据库，怎样才能更高效插入到数据库？要求"
keywords: "数据表中快速插入1000条数据"
categories: ['未分类']
tags: ['无标签']
artid: "101558411"
image:
  path: https://api.vvhan.com/api/bing?rand=sj&artid=101558411
  alt: "怎么高效率批量插入1000条数据到数据库"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=101558411
featuredImagePreview: https://bing.ee123.net/img/rand?artid=101558411
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     怎么高效率批量插入1000条数据到数据库
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <p>
     问题：
    </p>
    <p>
     每隔5毫秒就有30多条数据发送过来，然后需要及时插入到数据库，怎样才能更高效插入到数据库？要求：插入到数据库所耗的时间必须要比发送的时间快。目前我的做法是把批量数据先放在DataTable 中，1s后一次性提交DataTable中的数据，用的方法是adapter.Update(DataTable),这种方法效率上还是比较慢，内部实现应该还是一条一条插入的，只不过少连了几次数据库
    </p>
    <p>
    </p>
    <p>
     回答一：
    </p>
    <p>
     提供一个思路供参考:
     <br/>
     使用数据缓冲区+多线程完成这个功能, 先用队列作为数据缓冲区, 一个线程专门负责读取数据, 将读取到的数据保存到队列; 另一个线程专门负责保存数据, DbConnection不能用sqlbulkcopy, 在Insert语句中使用 Union 拼接总是可以的吧, 一次性地拼接30条数据保存到数据库中. 我有试过用此种方法接收处理1万条记录, 基本上可以确保即时地将数据保存到数据库中.
     <br/>
     当然, 如果接收到的数据量足够大足够快, 那可能还得考虑一下 sp1234 提到的 内存数据库 的问题。
    </p>
    <p>
     回答二：
    </p>
    <p>
     目前我的做法也是用一个列队存储数据，一个线程存，一个线程取，取的过程中需要分析+发送+插入，所耗时间远远不能达到那边传数据速度，所以就会产生数据堆积，然后越堆越多...
    </p>
    <p>
     回答三：
    </p>
    <p>
     5毫秒？？还多线程？。。。
     <br/>
     线程多效率就更低了。
     <br/>
     还是考虑内存数据库吧 fastdb之类的
    </p>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f67:2e6373646e2e6e65742f73696e61745f33383036383830372f:61727469636c652f64657461696c732f313031353538343131" class_="artid" style="display:none">
 </p>
</div>
