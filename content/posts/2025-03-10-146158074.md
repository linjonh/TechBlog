---
layout: post
title: "QT系列教程20-Qt-项目视图便捷类"
date: 2025-03-10 16:45:32 +0800
description: "Qt 项目视图便捷类"
keywords: "QT系列教程(20) Qt 项目视图便捷类"
categories: ['Qt', 'C']
tags: ['数据库', 'Qt', 'Mysql']
artid: "146158074"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146158074
    alt: "QT系列教程20-Qt-项目视图便捷类"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146158074
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146158074
cover: https://bing.ee123.net/img/rand?artid=146158074
image: https://bing.ee123.net/img/rand?artid=146158074
img: https://bing.ee123.net/img/rand?artid=146158074
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     QT系列教程(20) Qt 项目视图便捷类
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="./../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="./../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h3>
     <a id="_0">
     </a>
     视频连接
    </h3>
    <p>
     <a href="https://www.bilibili.com/video/BV1XY41127t3/?vd_source=8be9e83424c2ed2c9b2a3ed1d01385e9" rel="nofollow">
      https://www.bilibili.com/video/BV1XY41127t3/?vd_source=8be9e83424c2ed2c9b2a3ed1d01385e9
     </a>
    </p>
    <h3>
     <a id="Qt_2">
     </a>
     Qt项目视图便捷类
    </h3>
    <p>
     Qt项目视图提供了一些便捷类，包括QListWidget, QTableWidget， QTreeWidget等。我们分别介绍这几个便捷类。
     <br/>
     我们先创建一个Qt Application应用，然后在mainwindow的构造函数中创建一个listwidget
    </p>
    <pre><code class="prism language-cpp">    <span class="token keyword">auto</span> listWidget <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">QListWidget</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    QListWidgetItem <span class="token operator">*</span> listWidgetItem <span class="token operator">=</span> <span class="token keyword">new</span> QListWidgetItem<span class="token punctuation">;</span>
    listWidgetItem<span class="token operator">-&gt;</span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token string">"listItem"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    QPixmap <span class="token function">pixmap</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    pixmap<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span>Qt<span class="token double-colon punctuation">::</span>blue<span class="token punctuation">)</span><span class="token punctuation">;</span>
    listWidgetItem<span class="token operator">-&gt;</span><span class="token function">setIcon</span><span class="token punctuation">(</span>pixmap<span class="token punctuation">)</span><span class="token punctuation">;</span>
    listWidgetItem<span class="token operator">-&gt;</span><span class="token function">setToolTip</span><span class="token punctuation">(</span><span class="token string">"this is list item"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    listWidget<span class="token operator">-&gt;</span><span class="token function">insertItem</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>listWidgetItem<span class="token punctuation">)</span><span class="token punctuation">;</span>

    QListWidgetItem <span class="token operator">*</span> listWidgetItem2 <span class="token operator">=</span> <span class="token keyword">new</span> QListWidgetItem<span class="token punctuation">;</span>
    listWidgetItem2<span class="token operator">-&gt;</span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token string">"listItem2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    QPixmap <span class="token function">pixmap2</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    pixmap2<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span>Qt<span class="token double-colon punctuation">::</span>green<span class="token punctuation">)</span><span class="token punctuation">;</span>
    listWidgetItem2<span class="token operator">-&gt;</span><span class="token function">setIcon</span><span class="token punctuation">(</span>pixmap2<span class="token punctuation">)</span><span class="token punctuation">;</span>
    listWidgetItem2<span class="token operator">-&gt;</span><span class="token function">setToolTip</span><span class="token punctuation">(</span><span class="token string">"this is list item2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    listWidget<span class="token operator">-&gt;</span><span class="token function">insertItem</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span>listWidgetItem2<span class="token punctuation">)</span><span class="token punctuation">;</span>

    listWidget<span class="token operator">-&gt;</span><span class="token function">sortItems</span><span class="token punctuation">(</span>Qt<span class="token double-colon punctuation">::</span>DescendingOrder<span class="token punctuation">)</span><span class="token punctuation">;</span>
    listWidget<span class="token operator">-&gt;</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token operator">-&gt;</span><span class="token function">setCentralWidget</span><span class="token punctuation">(</span>listWidget<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
    <p>
     运行效果如下
     <br/>
     <img alt="https://cdn.llfc.club/1671679301439.jpg" src="https://i-blog.csdnimg.cn/img_convert/d2e8cb463d6b1429f91df24f9e58bf74.jpeg"/>
    </p>
    <p>
     接下来我们在mainwindow.h里添加QTableWidget和QTreeWidget成员变量
    </p>
    <pre><code class="prism language-cpp">    QTreeWidget <span class="token operator">*</span> _treeWidget<span class="token punctuation">;</span>
    QTableWidget <span class="token operator">*</span> _tableWidget<span class="token punctuation">;</span>
</code></pre>
    <p>
     然后继续在mainwindow的构造函数中创建TableWidget和TreeWidget。
    </p>
    <pre><code class="prism language-cpp">    _treeWidget <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">QTreeWidget</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//treewidget 要设置列数</span>
    _treeWidget<span class="token operator">-&gt;</span><span class="token function">setColumnCount</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    QStringList headers<span class="token punctuation">;</span>
    headers <span class="token operator">&lt;&lt;</span> <span class="token string">"name"</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"year"</span><span class="token punctuation">;</span>
    _treeWidget<span class="token operator">-&gt;</span><span class="token function">setHeaderLabels</span><span class="token punctuation">(</span>headers<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//添加项目</span>

    <span class="token comment">//父节点是_treeWidget</span>
    QTreeWidgetItem <span class="token operator">*</span> grade1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span>_treeWidget<span class="token punctuation">)</span><span class="token punctuation">;</span>
    grade1<span class="token operator">-&gt;</span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token string">"Grade1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//父节点是grade1</span>
    QTreeWidgetItem <span class="token operator">*</span> student <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span>grade1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    student<span class="token operator">-&gt;</span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token string">"Tom"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    student<span class="token operator">-&gt;</span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">"1996"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//父节点是grade1, 在student之后</span>
    QTreeWidgetItem <span class="token operator">*</span> student2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span>grade1<span class="token punctuation">,</span> student<span class="token punctuation">)</span><span class="token punctuation">;</span>
    student2<span class="token operator">-&gt;</span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token string">"Zack"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    student2<span class="token operator">-&gt;</span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">"1988"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//父节点是_treeWidget, 在grade1之后</span>
    QTreeWidgetItem <span class="token operator">*</span> grade2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span>_treeWidget<span class="token punctuation">,</span>grade1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    grade2<span class="token operator">-&gt;</span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token string">"Grade2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    QTreeWidgetItem <span class="token operator">*</span> student3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">QTreeWidgetItem</span><span class="token punctuation">(</span>grade1<span class="token punctuation">,</span> student2<span class="token punctuation">)</span><span class="token punctuation">;</span>
    student3<span class="token operator">-&gt;</span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token string">"Will"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    student3<span class="token operator">-&gt;</span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">"1989"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    _treeWidget<span class="token operator">-&gt;</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
    <p>
     我们创建了一个TreeWidget，创建TreeWidget要指明列数量，然后创建了头信息，接下来利用QTreeWidgetItem的构造函数创建了一些item，两个参数的构造函数，第一个参数是item的父节点，第二个参数是其兄弟节点。运行之后效果如下
     <br/>
     <img alt="https://cdn.llfc.club/1671680216876.jpg" src="https://i-blog.csdnimg.cn/img_convert/9b45faacf1e1885c205ccd59369034eb.jpeg">
      <br/>
      我们可以根据item的父节点是否为空判断其是否为顶层节点，然后执行删除节点操作
     </img>
    </p>
    <pre><code class="prism language-cpp">    <span class="token comment">//删除student3,先获取其父节点</span>
    <span class="token keyword">auto</span> <span class="token operator">*</span>parent_student3 <span class="token operator">=</span> student3<span class="token operator">-&gt;</span><span class="token function">parent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//获取student3在其父节点下的index</span>
    <span class="token keyword">auto</span> index_student3 <span class="token operator">=</span> parent_student3<span class="token operator">-&gt;</span><span class="token function">indexOfChild</span><span class="token punctuation">(</span>student3<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//根据index删除student3</span>
    <span class="token keyword">delete</span> parent_student3<span class="token operator">-&gt;</span><span class="token function">takeChild</span><span class="token punctuation">(</span>index_student3<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//删除grade2</span>
    <span class="token keyword">auto</span> <span class="token operator">*</span> parent_grade2 <span class="token operator">=</span> grade2<span class="token operator">-&gt;</span><span class="token function">parent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//grade2为顶层节点，所以其父节点必为null</span>
    <span class="token function">assert</span><span class="token punctuation">(</span>parent_grade2 <span class="token operator">==</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//通过treewidget获取grade2的index</span>
    <span class="token keyword">auto</span> index_grade2 <span class="token operator">=</span> _treeWidget<span class="token operator">-&gt;</span><span class="token function">indexOfTopLevelItem</span><span class="token punctuation">(</span>grade2<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">delete</span> _treeWidget<span class="token operator">-&gt;</span><span class="token function">takeTopLevelItem</span><span class="token punctuation">(</span>index_grade2<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
    <p>
     创建QTableWidget
    </p>
    <pre><code class="prism language-cpp">    <span class="token comment">//创建表格指定行号和列号</span>
   _tableWidget <span class="token operator">=</span>  <span class="token keyword">new</span> <span class="token function">QTableWidget</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//创建表格项目，将其插入到表格中</span>
    QTableWidgetItem <span class="token operator">*</span> tableWidgetItem <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">QTableWidgetItem</span><span class="token punctuation">(</span><span class="token string">"qt"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    _tableWidget<span class="token operator">-&gt;</span><span class="token function">setItem</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>tableWidgetItem<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//创建表头</span>
    QTableWidgetItem <span class="token operator">*</span> headerV <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">QTableWidgetItem</span><span class="token punctuation">(</span><span class="token string">"first"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    _tableWidget<span class="token operator">-&gt;</span><span class="token function">setVerticalHeaderItem</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> headerV<span class="token punctuation">)</span><span class="token punctuation">;</span>
    QTableWidgetItem <span class="token operator">*</span> headerH <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">QTableWidgetItem</span><span class="token punctuation">(</span><span class="token string">"ID"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    _tableWidget<span class="token operator">-&gt;</span><span class="token function">setHorizontalHeaderItem</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> headerH<span class="token punctuation">)</span><span class="token punctuation">;</span>
    _tableWidget<span class="token operator">-&gt;</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
    <p>
     运行效果
     <br/>
     <img alt="https://cdn.llfc.club/1671680542918.jpg" src="https://i-blog.csdnimg.cn/img_convert/a88c3f830fd67a7732145538bf3d3c7b.jpeg"/>
    </p>
    <h3>
     <a id="_104">
     </a>
     实现拖拽
    </h3>
    <p>
     有时我们需要实现拖拽操作, 我们可以在之前实现的listWidget设置一些拖拽属性。
    </p>
    <pre><code class="prism language-cpp">    <span class="token comment">//设置list为单选模式</span>
    listWidget<span class="token operator">-&gt;</span><span class="token function">setSelectionMode</span><span class="token punctuation">(</span>QAbstractItemView<span class="token double-colon punctuation">::</span>SingleSelection<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//启用拖动</span>
    listWidget<span class="token operator">-&gt;</span><span class="token function">setDragEnabled</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//设置接受拖放</span>
    listWidget<span class="token operator">-&gt;</span><span class="token function">viewport</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">setAcceptDrops</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//设置显示将要放置的位置</span>
    listWidget<span class="token operator">-&gt;</span><span class="token function">setDropIndicatorShown</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//设置拖放模式为移动项目，如果不设置，则为复制项目</span>
    listWidget<span class="token operator">-&gt;</span><span class="token function">setDragDropMode</span><span class="token punctuation">(</span>QAbstractItemView<span class="token double-colon punctuation">::</span>InternalMove<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
    <h3>
     <a id="_118">
     </a>
     源码链接
    </h3>
    <p>
     源码链接
     <br/>
     <a href="https://gitee.com/secondtonone1/qt-learning-notes" rel="nofollow">
      https://gitee.com/secondtonone1/qt-learning-notes
     </a>
    </p>
   </div>
   <link href="./../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="./../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f:672e6373646e2e6e65742f7365636f6e64746f6e6f6e65312f:61727469636c652f64657461696c732f313436313538303734" class_="artid" style="display:none">
 </p>
</div>


