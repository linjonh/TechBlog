---
arturl_encode: "687474:70733a2f2f626c6f672e6373646e2e6e65742f6e616e79752f:61727469636c652f64657461696c732f313436313838353535"
layout: post
title: "002-å‘Šåˆ«ä¹±ç -libiconv-Cå¼€æºåº“108æ°"
date: 2025-03-11 20:44:27 +08:00
description: "1. ç†è§£ä¹±ç äº§ç”Ÿçš„åŸå› 2. æ‰‹æŠŠæ‰‹æ•™å­¦å¦‚ä½•å°è£… libiconv çš„è½¬æ¢æ“ä½œ3. å€ŸåŠ©å°è£…æˆæœï¼Œè§£å†³ fswatch åº“ç¤ºä¾‹é¡¹ç›®çš„ä¹±ç é—®é¢˜"
keywords: "002-å‘Šåˆ«ä¹±ç -libiconv-C++å¼€æºåº“108æ°"
categories: ['C']
tags: ['ç¼–ç è½¬æ¢', 'å¼€æºåº“', 'å­—ç¬¦é›†', 'ä¹±ç ', 'Unicode', 'Gbk', 'C']
artid: "146188555"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146188555
    alt: "002-å‘Šåˆ«ä¹±ç -libiconv-Cå¼€æºåº“108æ°"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146188555
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146188555
cover: https://bing.ee123.net/img/rand?artid=146188555
image: https://bing.ee123.net/img/rand?artid=146188555
img: https://bing.ee123.net/img/rand?artid=146188555
---

# 002-å‘Šåˆ«ä¹±ç -libiconv-C++å¼€æºåº“108æ°

æœ¬è¯¾æ–‡åŒ…å«ä¸‰ä¸ªè§†é¢‘ï¼

> ä¸ºä»€ä¹ˆä¸­æ–‡ç‰ˆWindowsæ˜¯ç¼–ç¨‹å‡ºç°ä¹±ç çš„é«˜å‘åœ°å¸¦ï¼Ÿæ€ä¹ˆç”¨ libiconv æŠŠå›½æ ‡ç¼–ç çš„æ±‰å­—è½¬æ¢æˆå®‡å®™ç»Ÿä¸€ç ï¼Ÿæ€ä¹ˆç®€åŒ– libiconv é‚£äº›å……æ»¡å‘çš„ çº¯C å‡½æ•°APIï¼Ÿ

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/img_convert/a72ff904dc6e06032d073e810b09211f.png#pic_center)

## 1. å®‰è£… libiconv

é€šå¸¸ï¼Œä½ åœ¨ MSYS2 ä¸­å®‰è£…è¿‡ GCC ç¼–è¯‘å¥—ä»¶ï¼Œä½ çš„ msys2 ç³»ç»Ÿä¸­å°±ä¼šæœ‰ libiconv å¼€å‘åº“å¯ç”¨ã€‚å¯é€šè¿‡å¦‚ä¸‹æŒ‡ä»¤éªŒè¯ï¼š

```shell
pacman -S libiconv

```

æŸ¥çœ‹æ˜¯å¦å‡ºç°å¸¦æœ‰ â€œ[å·²å®‰è£…]â€ ï¼ˆæˆ– installedï¼‰çš„ libiconv åº“ï¼Ÿ

å¦‚æœç¡®å®éœ€è¦å•ç‹¬å®‰è£…ï¼ŒæŒ‡ä»¤ä¸ºï¼š

```shell
pacman -S mingw-w64-ucrt-x86_64-libiconv 

```

> å†æ¬¡æé†’ï¼Œå¦‚æœä½ ä½¿ç”¨çš„ GCC ä¸æ˜¯ UCRT64 ç‰ˆæœ¬ï¼Œé‚£ä¹ˆä½ å¯èƒ½éœ€è¦çš„åº“åç§°åº”æ˜¯
> `mingw-w64-x86_64-libiconv`
> ï¼ˆ64ä½OSï¼‰æˆ–
> `mingw-w64-i686-libiconv`
> ï¼ˆ32ä½OSï¼Œä¸æ•¢ç›¸ä¿¡ä½ åœ¨è¿˜åœ¨ç”¨ï¼‰

## 2. è½¬ç åŸºç¡€çŸ¥è¯† ğŸ¥

Windows ï¼ˆä¸­æ–‡ç‰ˆï¼‰æ˜¯ ç¼–ç¨‹å‡ºç°ä¹±ç çš„é«˜å‘åœ°å¸¦ä¹‹ä¸€ã€‚åŸå› æ¥è‡ªå†å²åŒ…è¢±ï¼šå½“å¹´ï¼Œå„å›½æ”¿åºœï¼ˆè‡ªç„¶åŒ…æ‹¬æˆ‘å›½ï¼‰éƒ½è¦æ±‚å¾®è½¯å‡ºçš„æœ¬åœ°è¯­è¨€ç‰ˆæœ¬çš„æ“ä½œç³»ç»Ÿï¼Œå…¶å­—ç¬¦ç¼–ç ï¼Œå¿…é¡»éµå®ˆå½“å¹´å„å›½å›½æ ‡ã€‚

004-libiconvç¼–ç è½¬æ¢-1åŸºç¡€çŸ¥è¯†-c++108æ°

## 3. å‡½æ•°ä½¿ç”¨åŒ…è£…

### 3.1 ä¸»è¦å‡½æ•°ä»‹ç»

libiconv ä¸»è¦å‡½æ•°æœ‰ä¸‰ä¸ªï¼š

* iconv_open

åŸå‹ï¼š

```cpp
iconv_t iconv_open(char const* toCode, char const * fromcode)

```

* å…¶ä¸­, iconv_t ä¸º â€œvoid *â€ çš„åˆ«å
* å‡½æ•°å¤±è´¥æ—¶ï¼Œå¹¶ä¸è¿”å› nullptrï¼Œè€Œæ˜¯è¿”å› (iconv_t)(-1)
* å…¥å‚ä¾åºä¸ºï¼šç›®æ ‡ç¼–ç åç§°ï¼Œæºç¼–ç åç§°

ä»¥ä¸‹ç§°è¯¥å‡½æ•°æ‰“å¼€æˆåŠŸå¾—åˆ°çš„ç»“æœä¸º â€œå¥æŸ„â€ã€‚

* iconv

åŸå‹ï¼š

```cpp
size_t iconv( iconv_t cd,
              char** in, size_t* inBytesLeft, 
              char** out, size_t* outBytesLeft);

```

ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºå¥æŸ„ã€‚å…¶ä½™å››ä¸ªå‚æ•°éƒ½æ—¢ä¸ºå…¥å‚ä¹Ÿä¸ºå‡ºå‚ã€‚

1. inï¼šä½œå…¥å‚ï¼Œç”¨äºæŒ‡ç¤ºå½“å‰å¾…è½¬æ¢çš„æºå­—ç¬¦ä¸²ç¼“å­˜åŒºå¼€å§‹ä½ç½®ï¼›ä½œå‡ºå‚ï¼Œç”¨äºå‘Šè¯‰è°ƒç”¨è€…ï¼Œæœ¬æ¬¡è½¬æ¢çš„ç»“æŸä½ç½®ï¼ˆå³ä¸‹æ¬¡è½¬æ¢çš„å¼€å§‹ä½ç½®ï¼‰ï¼›
2. inByteLeftï¼šä½œå…¥å‚ï¼ŒæŒ‡ç¤ºå½“å‰å¾…è½¬æ¢çš„æºå­—ç¬¦ä¸²ç¼“å­˜åŒºæœ‰å¤šå¤§ï¼›ä½œå‡ºå‚ï¼Œå‘Šè¯‰è°ƒç”¨è€…ï¼Œæœ¬æ¬¡è½¬æ¢åè¿˜å‰©ä¸‹å¤šå°‘å­—èŠ‚æœªè½¬æ¢ï¼›
3. out: ä½œå…¥å‚ï¼Œç”¨äºæŒ‡ç¤ºå¯ç”¨äºå­˜å‚¨è½¬æ¢ç»“æœçš„ç¼“å­˜åŒºå¼€å§‹ä½ç½®ï¼›ä½œå‡ºå‚ï¼Œç”¨äºå‘Šè¯‰è°ƒç”¨è€…ï¼Œæœ¬æ¬¡è½¬æ¢åï¼Œç»“æœå­˜æ”¾çš„ç»“æŸä½ç½®ï¼ˆå¯è€ƒè™‘ä½œä¸ºä¸‹æ¬¡ç”¨äºå­˜å‚¨ç»“æœçš„å¼€å§‹ä½ç½®ï¼Œæœ¬è¯¾å ‚å‡ºäºç®€åŒ–ï¼Œæœªé‡‡ç”¨æ­¤æ–¹æ³•ï¼‰ï¼›
4. outBytesLeft: ä½œå…¥å‚ï¼Œç”¨äºæŒ‡ç¤ºæœ¬æ¬¡è½¬æ¢å¯ç”¨æ¥å­˜å‚¨ç»“æœçš„ç¼“å­˜åŒºå¤§å°ï¼ˆå­—èŠ‚æ•°ï¼‰ï¼›ä½œå‡ºå‚ï¼Œç”¨äºå‘Šè¯‰è°ƒç”¨è€…ï¼Œæœ¬æ¬¡è½¬æ¢åï¼Œç”¨äºå­˜å‚¨ç»“æœçš„ç¼“å­˜åŒºè¿˜å‰©ä½™å¤šå°‘å­—èŠ‚ã€‚

in å’Œ out çš„å†…å®¹éƒ½æœ‰å¯èƒ½é€ æˆæœ¬å‡½æ•°è½¬æ¢ä¸­é€”åœä¸‹ã€‚æœ€å…¸å‹çš„å¦‚ï¼šout ï¼Œä¹Ÿå°±æ˜¯è¾“å‡ºç¼“å­˜åŒºå¤§å°ä¸å¤Ÿäº†ã€‚æ¯”å¦‚è¯´ï¼Œæºå­—ç¬¦ä¸²æœ‰ 61 å­—èŠ‚ï¼Œä½†ç›®æ ‡è¾“å‡ºç¼“å­˜åŒºï¼ˆä¹Ÿå°±æ˜¯ outï¼‰åªæœ‰20ä¸ªå­—èŠ‚ï¼Œå°±ä¼šé€ æˆ iconv() è½¬æ¢è‹¥å¹²å­—èŠ‚åï¼Œå°±åœä¸‹ï¼Œå¹¶å€ŸåŠ© errno ï¼ˆCåº“çš„ä¸€ä¸ªå®ï¼Œç±»ä¼¼å…¨å±€å˜é‡ï¼Œä½†æœ¬è´¨æ˜¯å¯¹åº”åˆ°ä¸€ä¸ªå‡½æ•°è°ƒç”¨ï¼Œä¸”çº¿ç¨‹å®‰å…¨ï¼‰ï¼Œå‘Šè¯‰è°ƒç”¨è€…ï¼šè¾“å‡ºç¼“å­˜åŒºä¸è¶³ã€‚

> æ³¨æ„ï¼Œç¼–ç è½¬æ¢å¹¶é 1:1 è½¬æ¢ï¼Œç”±äºæºç¼–ç å’Œç›®æ ‡ç¼–ç ç”¨ä»¥è¡¨è¾¾å•ä¸€ä¸ªæœ¬åœ°å­—ç¬¦ï¼ˆæ¯”å¦‚ä¸€ä¸ªæ±‰å­—ï¼‰çš„é•¿åº¦ä¸ä¸€æ ·ï¼Œå› æ­¤äºŒè€…ä¹‹é—´å¹¶ä¸å­˜åœ¨æŸä¸ªç®€å•çš„æ¯”ä¾‹å…³ç³»ã€‚å…¸å‹çš„å¦‚ä½¿ç”¨ UTF-8 ç¼–ç è¡¨è¾¾ä¸€ä¸ªæ±‰å­—ï¼Œå¯èƒ½æ˜¯ 2å­—èŠ‚ï¼Œä¹Ÿå¯èƒ½æ˜¯ 3å­—èŠ‚ã€4å­—èŠ‚ã€‚

ä¸ºäº†é¿å… â€œè¾“å‡ºç¼“å­˜åŒºä¸è¶³â€ ï¼Œæœ€ç²—æš´çš„æ–¹æ³•å°±æ˜¯ä¸º out åˆ†é…ä¸€ä¸ª â€œå·¨å¤§â€ çš„ç©ºé—´â€”â€”æ¯”å¦‚ï¼Œæ˜¯æºå­—ç¬¦ä¸²é•¿åº¦çš„ 4 å€ã€5 å€â€¦â€¦è¿™ç§æ–¹æ³•æ—¢æµªè´¹å†…å­˜ï¼Œå¹¶ä¸”é€šå¸¸éœ€è¦ä½¿ç”¨åˆ° new æ¥åŠ¨æ€åˆ†é…å†…å­˜ï¼Œè¿›ä¸€æ­¥æ‹‰ä½æ€§èƒ½ã€‚

æˆ‘ä»¬çš„è§£å†³æ–¹æ³•ç›¸å¯¹å¤æ‚ï¼Œä½†é«˜æ•ˆï¼ˆæˆ–è€…è¯´æ€§èƒ½å‡è¡¡ï¼‰ï¼šé‡‡ç”¨å›ºå®šå¤§å°çš„ä¸´æ—¶è¿ç»­å†…å­˜æ¥å­˜å‚¨æ¯æ¬¡è½¬æ¢çš„ç»“æœï¼ŒåŒæ—¶å‡†å¤‡ä¸€ä¸ªå­—ç¬¦ä¸²æµï¼ˆstd::stringstreamï¼‰æ¥è¿ç»­å­˜å‚¨æ¯æ¬¡è½¬æ¢çš„ç»“æœï¼ˆæ–°ç»“æœè¿½åŠ åˆ°æ—§ç»“æœä¹‹åï¼‰ã€‚

### 3.2 å‡½æ•°ç®€åŒ–å°è£… ğŸ¥

005-libiconvç¼–ç è½¬æ¢-2ç®€åŒ–å‡½æ•°-C++108æ°

### 3.3 å‡½æ•°å°è£…ä¸»è¦ä»£ç 

```cpp
namespace d2::myiconv
{

// è½¬æ¢ç»“æ„
struct IConvResult
{
    std::string result; // è½¬æ¢æˆåŠŸå¾—åˆ°çš„ï¼Œä½¿ç”¨æ–°ç¼–ç çš„å­—ç¬¦ä¸²

    int errorNumber = 0; // å¯¹åº” errno, å‡ºé”™å·
    std::string errorMessage; // å‡ºé”™ä¿¡æ¯
};

// è½¬æ¢å‡½æ•°
IConvResult Convert(std::string_view in, char const* fromCode, char const* toCode)
{

IConvResult Convert(std::string_view in, char const* fromCode, char const* toCode)
{
    IConvResult ir;

    // è°ƒç”¨ iconv_open
    iconv_t cd = iconv_open(toCode, fromCode);

    if (cd ==(iconv_t)(-1)) // æ‰“å¼€å¤±è´¥
    {
        ir.errorNumber = errno; // C -> C++

        switch (ir.errorNumber)
        {
        case EINVAL:
            ir.errorMessage = "ä¸æ”¯æŒçš„ç¼–ç ";
            break;
        case ENOMEM:
            ir.errorMessage = "å†…å­˜ä¸è¶³";
            break;
        default:
            ir.errorMessage = "æœªçŸ¥é”™è¯¯";
            break;
        }

        return ir;
    }

    char* inBufferPtr = const_cast<char *>(in.data()); // æŒ‡å‘è¾“å…¥ç¼“å­˜ä½ç½® ï¼ˆéå¸¸é‡ï¼‰
    size_t inBytesLeft = in.size(); // è¾“å…¥ç¼“å­˜å¤§å°

    std::stringstream ss;

    std::size_t const sizeOfOutBuffer = 20; // è¾“å‡ºç¼“å­˜åŒºå¤§å°
    char outBuffer[sizeOfOutBuffer]; // è¾“å‡ºç¼“å­˜

    while (inBytesLeft > 0) // è¾“å…¥ç¼“å­˜ä¸­ï¼Œè¿˜æœ‰å‰©ä½™å­—ç¬¦æœªè¢«è½¬æ¢
    {
        char *outBufferPtr = outBuffer;
        size_t outBufferLeft = sizeOfOutBuffer;

        size_t result = iconv(cd, &inBufferPtr, &inBytesLeft, &outBufferPtr, &outBufferLeft);

        if (result == (size_t)(-1)) // è½¬æ¢åœæ­¢äº†
        {
            auto n = errno;

            switch (n)
            {
                case E2BIG: // è¾“å‡ºç¼“å­˜åŒºä¸å¤Ÿç”¨äº†â€¦â€¦
                {                
                    break;
                }

                case EILSEQ: 
                {
                    ir.errorNumber = n;
                    ir.errorMessage = "è¾“å…¥å­—ç¬¦åºåˆ—ä¸ç¬¦åˆæŒ‡å®šç¼–ç è§„åˆ™";
                    break;
                }

                case EINVAL:
                {
                    ir.errorNumber = n;
                    ir.errorMessage = "è¾“å…¥çš„å­—ç¬¦åºåˆ—ä¸å®Œæ•´"; 
                    break;
                }
                
                default:
                {
                    ir.errorNumber = n;
                    ir.errorMessage = "è½¬æ¢è¿‡ç¨‹å‘ç”ŸæœªçŸ¥é”™è¯¯";                
                    break;
                }
            }
        }

        if (ir.errorNumber != 0)
        {
            break; // while
        }

        ss.write(outBuffer, sizeOfOutBuffer - outBufferLeft); // å°†æœ¬è½®çš„è¾“å‡ºç»“æœï¼Œå†™å…¥è¾“å‡ºæµ
    } // while

    iconv_close(cd);
    
    if (ir.errorNumber == 0)
    {
        ir.result = ss.str();
    }

    return ir;
}       

} //namespace d2::myiconv

```

ä½¿ç”¨ç¤ºä¾‹ï¼š

```cpp
char const* gbk = "å‡è®¾è¿™æ˜¯ä¸€ä¸ªGBKç¼–ç çš„å­—ç¬¦ä¸²";

auto ir = d2:myiconv::Convert(gbk, "GBK", "UTF-8");

if (ir.errorNumber != 0)
{
    std::cout << ir.errorNumber << " : " << ir.errorMessage << "\n";
}
else
{
    // è½¬æ¢æˆåŠŸï¼š
    std::cout << ir.result << std::endl;
}


```

å¯¹åº”çš„ CMakeLists.txt ç¤ºä¾‹ï¼š

```cmake
cmake_minimum_required(VERSION 3.10.0)
project(HelloLibIconv VERSION 0.1.0 LANGUAGES C CXX)

add_executable(HelloLibIconv main.cpp gbk_str.cpp)

target_link_libraries(${PROJECT_NAME} PRIVATE iconv)
target_link_directories(${PROJECT_NAME} PRIVATE "c:/msys64/ucrt64/lib")

```

å…¶ä¸­çš„ gbk_str.cpp åœ¨ VSCODE ä¸­åº”æ˜ç¡®ä½¿ç”¨ GBK ç¼–ç ä¿å­˜ï¼Œå…¶å†…å®¹ä¸ºï¼š

```cpp
char const* gbk_str = "æˆ‘æ˜¯ä¸€ä¸ªGBKå­—ç¬¦ç¼–ç çš„å­—ç¬¦ä¸²ï¼è¯·ä¿éšœæˆ‘æ‰€åœ¨çš„CPPæ–‡ä»¶ç¼–ç ä¸ºGBKï¼"; 

```

## 4. é¡¹ç›®åº”ç”¨ ğŸ¥

ä¸Šä¸€èŠ‚ä¸­ libfswatch åœ¨ç›‘æ§ Windows ä¸‹åå­—å¸¦æ±‰å­—çš„æ–‡ä»¶å¯¹è±¡æ—¶ï¼Œæ–‡ä»¶åè¾“å‡ºä¼šå‡ºç°ä¹±ç ã€‚å…¶åŸå› äºï¼šlibfswatch ä» Windows è¯»æ–‡ä»¶å¯¹è±¡ä¿¡æ¯æ—¶ï¼Œæœªä½¿ç”¨ç‰¹å®šçš„ UNICODE ç‰ˆæœ¬çš„ APIï¼Œè€Œæ˜¯ä½¿ç”¨ Windows æœ¬åœ°è¯­è¨€ç‰ˆ APIï¼Œå› æ­¤è¯»åˆ°çš„æ–‡ä»¶åä¸­çš„ä¸­æ–‡å­—ç¬¦æ˜¯ GBxxxx ç¼–ç ï¼ˆæ—¢ä¸­å›½å›½æ ‡ï¼‰ï¼Œä½† libfswatch å°†å®ƒè§†ä¸º UTF-8 ç¼–ç ã€‚

åŸºäº libiconvï¼Œä½¿ç”¨æˆ‘ä»¬æ‰€åŒ…è£…çš„å‡½æ•°ï¼Œè§£å†³ä¹±ç çš„æ ¸å¿ƒä»£ç æ˜¯ï¼š

```cpp
        // è¾“å‡ºå˜åŠ¨çš„æ–‡ä»¶è·¯å¾„ï¼š
        auto utf8Path = d2::myiconv::Convert(event.get_path(), "GBK", "UTF-8"); // ç¼–ç è½¬æ¢
        if (utf8Path.errorNumber != 0)
        {
            std::cout << utf8Path.errorMessage << std::endl;
            break;
        }

        std::cout << utf8Path.result << "\n";

```

ä¸‹é¢çš„è§†é¢‘ç»™å‡ºäº†é‡‡ç”¨æˆ‘ä»¬æ‰€å†™çš„ Convert() çš„è§£å†³æ–¹æ¡ˆã€‚

006-libiconvç¼–ç è½¬æ¢-3é¡¹ç›®åº”ç”¨-C++108æ°

## 5. C++ å°è£…

d2::myiconv::Convertï¼ˆï¼‰å‡½æ•°ä½¿ç”¨èµ·æ¥ï¼Œæ¯”åŸæ¥çš„çº¯Cå‡½æ•°â€œä¸‰æ¿æ–§â€ç»„åˆï¼Œè¦æ–¹ä¾¿ä¸å°‘ï¼Œä½†ä¹Ÿæœ‰ä¸ªæ¯”è¾ƒæ˜æ˜¾çš„ç¼ºç‚¹ï¼šæ— æ³•å¤ç”¨ iconv_open() å¾—åˆ°çš„å¥æŸ„ï¼Œæ¯æ¬¡è½¬æ¢éƒ½éœ€è¦å…ˆæ‰“å¼€æœ€åå†å…³é—­ã€‚å¦‚æœä»…æ˜¯ä¸€æ¬¡æ€§è½¬æ¢æ— æ‰€è°“ï¼Œä½†æœ‰æ—¶æœ‰å¤šä¸ªå­—ç¬¦ä¸²éœ€è¦åˆ†å¼€è½¬æ¢ï¼Œå¥æŸ„ä¸èƒ½å¤ç”¨çš„å¼Šç«¯å°±æ¯”è¾ƒæ˜æ˜¾äº†ã€‚

è§£å†³æ–¹æ³•æ˜¯ä½¿ç”¨ C++ é¢å‘å¯¹è±¡çš„æ€æƒ³è¿›ä¸€æ­¥åŠ ä»¥å°è£…ï¼Œæˆ‘ä»¬ç»™å‡ºä¸€ç§æ€è·¯çš„ç±»è®¾è®¡ï¼ˆä»… class è®¾è®¡ï¼‰ï¼š

```cpp
namespace d2::myiconv
{

// è½¬æ¢ç»“æœ
struct IConvResult
{
    std::string result; // è½¬æ¢æˆåŠŸå¾—åˆ°çš„ï¼Œä½¿ç”¨æ–°ç¼–ç çš„å­—ç¬¦ä¸²

    int errorNumber = 0; // å¯¹åº” errno, å‡ºé”™å·
    std::string errorMessage; // å‡ºé”™ä¿¡æ¯
};

class IconvHelper final // æ³¨ï¼šå®ç°ä¸º final ç±»
{
public:
    // æ„é€ ï¼ˆå¤±è´¥æ—¶å¯æŠ›å‡ºå¼‚å¸¸ï¼‰
    IconvHelper(char const* fromCode, char const* toCode) noexcept(false);
   
    IconvHelper(IconvHelper const& ) = delete; // ä¸å…è®¸å¤åˆ¶
    IconvHelper& operator = (IconvHelper const&) = delete;

    IconvHelper(IconvHelper&& ih) noexcept; // æ”¯æŒè½¬ç§»
    IconvHelper& operator = (IconvHelper&& ih) noexcept; 

    ~IconvHelper() noexcept; // ææ„

    // é™æ€è½¬æ¢ï¼Œæ–¹ä¾¿ä¸€æ¬¡æ€§è½¬æ¢ (ä¸å…è®¸æŠ›å‡ºå¼‚å¸¸)
    static IConvResult Convert(std::string_view in,
                  char const* fromCode, char const* toCode) noexcept;

    // éé™æ€çš„è½¬æ¢æ–¹æ³•ï¼Œæ–¹ä¾¿å¤šæ¬¡å¤ç”¨ (ä¸å…è®¸æŠ›å‡ºå¼‚å¸¸)
    IConvResult Convert(std::string_view in) noexcept;  

private:
    iconv_t cd;
};

} //  namespace d2::myiconv


```

è¯·è¿›å…¥
[d2school ç½‘ç«™](https://www.d2school.com)
æœ¬è¯¾çš„ä½œä¸šåŒºï¼Œå®Œæˆç¬¦åˆä¸Šè¿°ç±»å®šä¹‰çš„ C++ ç‰ˆæœ¬çš„ libiconv å°è£…ï¼Œå¹¶åŠæ—¶äº¤ä½œä¸šã€‚