---
layout: post
title: "Java-操作Excel-poi读写excel"
date: 2024-09-06 13:13:27 +0800
description: "Java 操作Excel poi读写excel，excel导入导出（精简版）1.所需jar包下载地址"
keywords: "javaexcel.newpoiexcelwriter"
categories: ['Java']
tags: ['Excel']
artid: "83217382"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=83217382
    alt: "Java-操作Excel-poi读写excel"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=83217382
featuredImagePreview: https://bing.ee123.net/img/rand?artid=83217382
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     Java 操作Excel poi读写excel
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <h2>
     Java 操作Excel poi读写excel，excel导入导出（精简版）
    </h2>
    <p>
     1.所需jar包
    </p>
    <p>
     下载地址：
     <a href="https://download.csdn.net/download/u014646662/10734734">
      https://download.csdn.net/download/u014646662/10734734
     </a>
    </p>
    <p>
     <img alt="" class="has" height="368" src="https://i-blog.csdnimg.cn/blog_migrate/6959dea36103e523ed02e01e35dad43d.png" width="319"/>
    </p>
    <p>
     2.源码
    </p>
    <p>
     写操作（excel导出）
    </p>
    <pre class="has"><code class="language-java">package cn.com.tengen.excel;
import java.io.File;
import java.io.FileOutputStream;
import java.io.IOException;
import java.io.OutputStream;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.Map;
import java.util.Map.Entry;
import java.util.Set;

import org.apache.poi.hssf.usermodel.HSSFWorkbook;
import org.apache.poi.ss.usermodel.Cell;
import org.apache.poi.ss.usermodel.Row;
import org.apache.poi.ss.usermodel.Sheet;
import org.apache.poi.ss.usermodel.Workbook;
import org.apache.poi.xssf.usermodel.XSSFWorkbook;
/**
 * excel写操作
 * @author lucky
 *
 */
public class ExcelWrite {
    private static final String EXCEL_XLS = "xls";
    private static final String EXCEL_XLSX = "xlsx";
    
    public static void main(String[] args) throws IOException {
    	ExcelWrite ew = new ExcelWrite();
    	//excel数据, key是sheet的名字
    	Map&lt;String, List&lt;List&lt;String&gt;&gt;&gt; dataSheets = new HashMap&lt;&gt;();
    	//excel中一个sheet的数据
    	List&lt;List&lt;String&gt;&gt; dataSheet = new ArrayList&lt;&gt;();
    	//excel的一行数据
    	List&lt;String&gt; row = new ArrayList&lt;&gt;();
    	//excel中一个单元的数据
    	row.add("aaaa");
    	row.add("aaaa");
    	row.add("aaaa");
    	dataSheet.add(row);
    	row = new ArrayList&lt;&gt;();
    	row.add("bbbbb");
    	row.add("bbbbb");
    	row.add("bbbbb");
    	dataSheet.add(row);
    	row = new ArrayList&lt;&gt;();
    	row.add("ccccc");       
    	row.add("ccccc");       
    	row.add("ccccc"); 
    	dataSheet.add(row);
    	dataSheets.put("aaa", dataSheet);
    	dataSheets.put("aab", dataSheet);
    	dataSheets.put("aac", dataSheet);
    	ew.writeExcel(dataSheets,"qqqq.xlsx");
    }

    /**
     * 创建一个excel &lt;br&gt;
     * @param dataSheets
     * @param file
     * @throws IOException
     */
    public void writeExcel(Map&lt;String, List&lt;List&lt;String&gt;&gt;&gt; dataSheets,String path) throws IOException {
    	
    	Workbook workBook = null;
    	OutputStream out = null;
    	File file = new File(path);
    	try {
    	workBook = getWriteWorkbok(file);
    	Set&lt;Entry&lt;String, List&lt;List&lt;String&gt;&gt;&gt;&gt; entrySet = dataSheets.entrySet();
    	for (Entry&lt;String, List&lt;List&lt;String&gt;&gt;&gt; dataSheet : entrySet) {
    		//创建sheet
    		Sheet sheet = workBook.createSheet(dataSheet.getKey());
    		List&lt;List&lt;String&gt;&gt; list = dataSheet.getValue();
    		if(list != null) {
    			for (int i = 0; i &lt; list.size(); i++) {
    				//创建行
    				Row row = sheet.createRow(i);
    				List&lt;String&gt; dataRow = list.get(i);
    				if(dataRow != null) {
    					for (int j = 0; j &lt; dataRow.size(); j++) {
    						//创建单元格
    						Cell cell = row.createCell(j);
    						cell.setCellValue(dataRow.get(j));
    					}
    				}
    			}
    		}
    		
		}
    	out =  new FileOutputStream(file);
        workBook.write(out);
    	}finally {
    		if(workBook != null) {
    			workBook.close();
    		}
    		if(out != null) {
    			out.close();
    		}
    	}
    }
    
    
    /**
     * 判断Excel的版本,获取Workbook
     * @param file
     * @return
     * @throws IOException
     */
    private  Workbook getWriteWorkbok(File file) throws IOException{
    	
        Workbook wb = null;
        if(file.getName().endsWith(EXCEL_XLS)){     
            wb = new HSSFWorkbook();
        }else if(file.getName().endsWith(EXCEL_XLSX)){    
            wb = new XSSFWorkbook();
        }
        return wb;
    }

}</code></pre>
    <p>
     读excel（excel导入）
    </p>
    <pre class="has"><code class="language-java">package cn.com.tengen.excel;

import java.io.FileInputStream;
import java.io.IOException;
import java.io.InputStream;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.Iterator;
import java.util.List;
import java.util.Map;
import java.util.Map.Entry;
import java.util.Set;

import org.apache.poi.hssf.usermodel.HSSFWorkbook;
import org.apache.poi.ss.usermodel.Cell;
import org.apache.poi.ss.usermodel.CellType;
import org.apache.poi.ss.usermodel.Row;
import org.apache.poi.ss.usermodel.Sheet;
import org.apache.poi.ss.usermodel.Workbook;
import org.apache.poi.xssf.usermodel.XSSFWorkbook;

public class ExcelRead {
	private static final String EXCEL_XLS = "xls";
	private static final String EXCEL_XLSX = "xlsx";



	/**
	 * 读取Excel
	 * @param path
	 * @return
	 * @throws IOException
	 */
	public Map&lt;String, List&lt;List&lt;String&gt;&gt;&gt; readExcel(String path) throws IOException {

		Workbook workbook = getWriteWorkbok(path);
		//excel数据, key是sheet的名字
    	Map&lt;String, List&lt;List&lt;String&gt;&gt;&gt; dataSheets = new HashMap&lt;&gt;();
		// Read the Sheet
		for (int numSheet = 0; numSheet &lt; workbook.getNumberOfSheets(); numSheet++) {
			Sheet sheet = workbook.getSheetAt(numSheet);
			if (sheet == null) {
				continue;
			}
			//excel中一个sheet的数据
	    	List&lt;List&lt;String&gt;&gt; dataSheet = new ArrayList&lt;&gt;();
	    	dataSheets.put(sheet.getSheetName(), dataSheet);
			
			for (int rowNum = 0; rowNum &lt;= sheet.getLastRowNum(); rowNum++) {
				Row row = sheet.getRow(rowNum);
				if (row != null) {
					//excel的一行数据
			    	List&lt;String&gt; dataRow = new ArrayList&lt;&gt;();
			    	dataSheet.add(dataRow);
					Iterator&lt;Cell&gt; it = row.cellIterator();
					while(it.hasNext()) {
						dataRow.add(getValue(it.next()));
					}
				}
			}
		}
		return dataSheets;
	}

	/**
	 * 获取单元格的值
	 * @param row
	 * @return
	 */
	private String getValue(Cell row) {
		if (row.getCellType() == CellType.BOOLEAN) {
			return String.valueOf(row.getBooleanCellValue());
		} else if (row.getCellType() == CellType.NUMERIC) {
			return String.valueOf(row.getNumericCellValue());
		} else {
			return String.valueOf(row.getStringCellValue());
		}
	}

	/**
	 * 判断Excel的版本,获取Workbook
	 * 
	 * @param file
	 * @return
	 * @throws IOException
	 */
	private Workbook getWriteWorkbok(String path) throws IOException {
		if (path == null) {
			throw new IOException("找不到文件，文件路径可能是null");
		}
		InputStream is = new FileInputStream(path);

		if (path.endsWith(EXCEL_XLS)) {
			return new HSSFWorkbook(is);
		}
		if (path.endsWith(EXCEL_XLSX)) {
			return new XSSFWorkbook(is);
		}
		
		is.close();
		throw new IOException(path + " 不是Excel文件");
	}
	
	
	public static void main(String[] args) throws IOException {
		ExcelRead er = new ExcelRead();
		Map&lt;String, List&lt;List&lt;String&gt;&gt;&gt; readExcel = er.readExcel("qqqq.xlsx");
		Set&lt;Entry&lt;String, List&lt;List&lt;String&gt;&gt;&gt;&gt; entrySet = readExcel.entrySet();
		for (Entry&lt;String, List&lt;List&lt;String&gt;&gt;&gt; sheetsMap : entrySet) {
			System.out.println("sheet: "+sheetsMap.getKey());
			for(List&lt;String&gt; sheet:sheetsMap.getValue()) {
				for (String value : sheet) {
					System.out.print(value);
					System.out.print("\t\t");
				}
				System.out.println();
			}
			System.out.println("---------------------------------------------------------");
		}
	}
}
</code></pre>
    <p>
     对人工智能感兴趣的同学，可以点击以下链接：
    </p>
    <p>
     <a href="https://www.cbedai.net/u014646662" rel="nofollow">
      现在人工智能非常火爆，很多朋友都想学，但是一般的教程都是为博硕生准备的，太难看懂了。最近发现了一个非常适合小白入门的教程，不仅通俗易懂而且还很风趣幽默。所以忍不住分享一下给大家。点这里可以跳转到教程。
     </a>
    </p>
    <p>
     <a href="https://www.cbedai.net/u014646662" rel="nofollow">
      https://www.cbedai.net/u014646662
     </a>
    </p>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f:2f626c6f672e6373646e2e6e65742f75303134363436363632:2f61727469636c652f64657461696c732f3833323137333832" class_="artid" style="display:none">
 </p>
</div>


