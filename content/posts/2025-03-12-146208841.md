---
layout: post
title: "算法精讲-树番外平衡世界的四大守护者AVL-vs-红黑树-vs-B树-vs-B树"
date: 2025-03-12 16:42:54 +0800
description: "① 文件系统需要快速定位单个文件 ② B树非叶节点存数据有利小文件 ③ B+树更适合范围扫描。是强迫症的AVL，潮流的红黑树，还是磁盘大师B+树？比如4KB页，假设key占16B，t≈4KB/(16B+8B)=170。：① 查询更稳定（都要到叶子层） ② 范围查询吊打B树 ③ 非叶节点更\"苗条\"：为什么Linux文件系统用B树而不用B+树？：红黑树为什么比AVL树应用更广？：HashMap为什么不用红黑树？：为什么数据库用B+树不用B树？：B+树叶子链表如何维护？：B树的t值怎么选？"
keywords: "算法精讲 | 树（番外）：平衡世界的四大守护者：AVL vs 红黑树 vs B树 vs B+树"
categories: ['算法精讲', '树图']
tags: ['算法', '前端', 'B']
artid: "146208841"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146208841
    alt: "算法精讲-树番外平衡世界的四大守护者AVL-vs-红黑树-vs-B树-vs-B树"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146208841
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146208841
cover: https://bing.ee123.net/img/rand?artid=146208841
image: https://bing.ee123.net/img/rand?artid=146208841
img: https://bing.ee123.net/img/rand?artid=146208841
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     算法精讲 | 树（番外）：平衡世界的四大守护者：AVL vs 红黑树 vs B树 vs B+树
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h2>
     <a id="___AVL_vs__vs_B_vs_B_1">
     </a>
     🌲
     <strong>
      算法精讲 | 树（番外）：平衡世界的四大守护者：AVL vs 红黑树 vs B树 vs B+树
     </strong>
    </h2>
    <blockquote>
     <p>
      <code>
       📅 2025/03/12 || 🌟 推荐阅读时间 30分钟
      </code>
     </p>
    </blockquote>
    <hr/>
    <h3>
     <a id="__7">
     </a>
     🚀 开篇：数据结构界的四大天王
    </h3>
    <p>
     想象你是一名图书管理员，面对四种神奇的书架：
    </p>
    <ul>
     <li>
      <strong>
       AVL树书架
      </strong>
      ：强迫症晚期，每放一本书都要拿水平仪测量 📏
     </li>
     <li>
      <strong>
       红黑树书架
      </strong>
      ：时尚弄潮儿，给书架涂红黑条纹 🎨
     </li>
     <li>
      <strong>
       B树书架
      </strong>
      ：俄罗斯套娃大师，每个隔层能装 100 本书 📚
     </li>
     <li>
      <strong>
       B+树书架
      </strong>
      ：目录狂魔，把索引刻在每一层 🗂️
     </li>
    </ul>
    <p>
     今天我们一起破解它们的秘密！
    </p>
    <hr/>
    <h3>
     <a id="__20">
     </a>
     🗺️ 知识导航图
    </h3>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/8ac7625414fb46ee9cddbe65ade7e573.png"/>
    </p>
    <hr/>
    <h3>
     <a id="AVL_27">
     </a>
     一、AVL树：平衡强迫症患者
    </h3>
    <h4>
     <a id="11__29">
     </a>
     1.1 旋转手术四部曲
    </h4>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/df21d710c4e24b04b43cd9873ea8688e.png"/>
    </p>
    <h5>
     <a id="__34">
     </a>
     ⚔️ 右旋代码演示
    </h5>
    <pre><code class="prism language-java"><span class="token class-name">TreeNode</span> <span class="token function">rightRotate</span><span class="token punctuation">(</span><span class="token class-name">TreeNode</span> y<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token class-name">TreeNode</span> x <span class="token operator">=</span> y<span class="token punctuation">.</span>left<span class="token punctuation">;</span>   <span class="token comment">// 抓住左孩子</span>
    <span class="token class-name">TreeNode</span> <span class="token constant">T2</span> <span class="token operator">=</span> x<span class="token punctuation">.</span>right<span class="token punctuation">;</span> <span class="token comment">// 寄存右孙子</span>
  
    x<span class="token punctuation">.</span>right <span class="token operator">=</span> y<span class="token punctuation">;</span>           <span class="token comment">// 乾坤大挪移</span>
    y<span class="token punctuation">.</span>left <span class="token operator">=</span> <span class="token constant">T2</span><span class="token punctuation">;</span>           <span class="token comment">// 认领新孙子</span>
  
    <span class="token function">updateHeight</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment">// 📏 更新身高</span>
    <span class="token function">updateHeight</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment">// 📐 精确到毫米</span>
    <span class="token keyword">return</span> x<span class="token punctuation">;</span>              <span class="token comment">// 新掌门登基</span>
<span class="token punctuation">}</span>
</code></pre>
    <hr/>
    <h3>
     <a id="_52">
     </a>
     二、红黑树：染发艺术家
    </h3>
    <h4>
     <a id="21__54">
     </a>
     2.1 红黑法典五条
    </h4>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/9ce687e6247847d89aabb14d0fce6387.png"/>
    </p>
    <h4>
     <a id="22__58">
     </a>
     2.2 插入修复三部曲
    </h4>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/28574bd27ecf4188b436bce4a63e2159.png"/>
    </p>
    <h5>
     <a id="__62">
     </a>
     🎨 染色代码片段
    </h5>
    <pre><code class="prism language-java"><span class="token keyword">void</span> <span class="token function">fixInsertion</span><span class="token punctuation">(</span><span class="token class-name">Node</span> z<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>z<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>color <span class="token operator">==</span> <span class="token constant">RED</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>uncle<span class="token punctuation">.</span>color <span class="token operator">==</span> <span class="token constant">RED</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>         <span class="token comment">// 叔叔是红发</span>
            parent<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token constant">BLACK</span><span class="token punctuation">;</span>        <span class="token comment">// 🔴 → ⚫</span>
            uncle<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token constant">BLACK</span><span class="token punctuation">;</span>         <span class="token comment">// 🔴 → ⚫</span>
            grandparent<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token constant">RED</span><span class="token punctuation">;</span>     <span class="token comment">// ⚫ → 🔴</span>
            z <span class="token operator">=</span> grandparent<span class="token punctuation">;</span>             <span class="token comment">// 向上检查</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// 旋转操作...</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    root<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token constant">BLACK</span><span class="token punctuation">;</span> <span class="token comment">// 最终染黑</span>
<span class="token punctuation">}</span>
</code></pre>
    <hr/>
    <h3>
     <a id="B_84">
     </a>
     三、B树：图书馆长
    </h3>
    <h4>
     <a id="31_B_86">
     </a>
     3.1 B树结构解剖
    </h4>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/f674639ae10e41ea9960deab793b0e5c.png"/>
    </p>
    <h5>
     <a id="__91">
     </a>
     📚 节点分裂演示
    </h5>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/1105cf55ca2f41649751195499c3b2b1.png"/>
    </p>
    <h4>
     <a id="32_B_95">
     </a>
     3.2 实战代码：B树插入
    </h4>
    <pre><code class="prism language-python"><span class="token keyword">class</span> <span class="token class-name">BTreeNode</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> t<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>keys <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>         <span class="token comment"># 关键码库</span>
        self<span class="token punctuation">.</span>children <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>     <span class="token comment"># 子节点库</span>
        self<span class="token punctuation">.</span>leaf <span class="token operator">=</span> <span class="token boolean">True</span>       <span class="token comment"># 是否叶子</span>

<span class="token keyword">def</span> <span class="token function">insert</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>keys<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">2</span><span class="token operator">*</span>t <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">:</span>  <span class="token comment"># 🚨 节点满了！</span>
        new_node <span class="token operator">=</span> BTreeNode<span class="token punctuation">(</span>self<span class="token punctuation">.</span>t<span class="token punctuation">)</span>
        <span class="token comment"># 分裂过程...</span>
    <span class="token comment"># 插入逻辑...</span>
</code></pre>
    <hr/>
    <h3>
     <a id="B_113">
     </a>
     四、B+树：超级目录
    </h3>
    <h4>
     <a id="41_B_115">
     </a>
     4.1 与B树的三大区别
    </h4>
    <ul>
     <li>
      📚 数据只存在叶子节点
     </li>
     <li>
      🔗 叶子节点形成有序链表
     </li>
     <li>
      🧲 非叶节点是密集索引
     </li>
    </ul>
    <h4>
     <a id="42__121">
     </a>
     4.2 范围查询演示
    </h4>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/15521be38714486f9ab9a93cea2f638b.png"/>
    </p>
    <h5>
     <a id="__125">
     </a>
     🚀 查询代码示例
    </h5>
    <pre><code class="prism language-java"><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> <span class="token function">rangeQuery</span><span class="token punctuation">(</span><span class="token class-name">BPlusTree</span> tree<span class="token punctuation">,</span> <span class="token keyword">int</span> start<span class="token punctuation">,</span> <span class="token keyword">int</span> end<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token class-name">Node</span> curr <span class="token operator">=</span> <span class="token function">findLeaf</span><span class="token punctuation">(</span>tree<span class="token punctuation">.</span>root<span class="token punctuation">,</span> start<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> result <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>curr <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> curr<span class="token punctuation">.</span>keys<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> end<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> key <span class="token operator">:</span> curr<span class="token punctuation">.</span>keys<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>key <span class="token operator">&gt;=</span> start <span class="token operator">&amp;&amp;</span> key <span class="token operator">&lt;=</span> end<span class="token punctuation">)</span> 
                result<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        curr <span class="token operator">=</span> curr<span class="token punctuation">.</span>next<span class="token punctuation">;</span> <span class="token comment">// 链表跳跃</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <hr/>
    <h3>
     <a id="PK_144">
     </a>
     五、华山论剑：四大天王终极PK
    </h3>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/4ae9dc6f196a4844b53a17dc4c232e1d.png"/>
    </p>
    <table>
     <thead>
      <tr>
       <th>
        特性
       </th>
       <th>
        AVL树
       </th>
       <th>
        红黑树
       </th>
       <th>
        B树
       </th>
       <th>
        B+树
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        <strong>
         平衡标准
        </strong>
       </td>
       <td>
        绝对平衡
       </td>
       <td>
        黑高平衡
       </td>
       <td>
        节点填充率
       </td>
       <td>
        节点填充率
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         插入复杂度
        </strong>
       </td>
       <td>
        O(log n)
       </td>
       <td>
        O(log n)
       </td>
       <td>
        O(log_t n)
       </td>
       <td>
        O(log_t n)
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         查询速度
        </strong>
       </td>
       <td>
        ⚡极快
       </td>
       <td>
        🚀快速
       </td>
       <td>
        🚢稳定
       </td>
       <td>
        ✈️极速
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         适用场景
        </strong>
       </td>
       <td>
        内存敏感
       </td>
       <td>
        综合场景
       </td>
       <td>
        文件系统
       </td>
       <td>
        数据库索引
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         磁盘友好度
        </strong>
       </td>
       <td>
        ❌
       </td>
       <td>
        ❌
       </td>
       <td>
        ✅
       </td>
       <td>
        ✅✅
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         代码复杂度
        </strong>
       </td>
       <td>
        😫高
       </td>
       <td>
        😣中
       </td>
       <td>
        😌较高
       </td>
       <td>
        😅较高
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         经典应用
        </strong>
       </td>
       <td>
        内存数据库
       </td>
       <td>
        Java TreeMap
       </td>
       <td>
        NTFS文件系统
       </td>
       <td>
        MySQL索引
       </td>
      </tr>
     </tbody>
    </table>
    <hr/>
    <h3>
     <a id="__161">
     </a>
     六、灵魂拷问室 💬
    </h3>
    <blockquote>
     <p>
      <strong>
       面试官
      </strong>
      ：为什么Linux文件系统用B树而不用B+树？
     </p>
     <p>
      <strong>
       答
      </strong>
      ：① 文件系统需要快速定位单个文件 ② B树非叶节点存数据有利小文件 ③ B+树更适合范围扫描
     </p>
    </blockquote>
    <blockquote>
     <p>
      <strong>
       面试官
      </strong>
      ：红黑树为什么比AVL树应用更广？
     </p>
     <p>
      <strong>
       答
      </strong>
      ：① 插入删除旋转次数少 ② 颜色标记比存储高度节省内存 ③ 综合性能更均衡
     </p>
    </blockquote>
    <blockquote>
     <p>
      <strong>
       面试官
      </strong>
      ：B+树叶子链表如何维护？
     </p>
     <p>
      <strong>
       答
      </strong>
      ：分裂时更新指针→类似双向链表插入节点，合并时同步调整
     </p>
    </blockquote>
    <blockquote>
     <p>
      <strong>
       面试官
      </strong>
      ：为什么数据库用B+树不用B树？
     </p>
     <p>
      <strong>
       答
      </strong>
      ：① 查询更稳定（都要到叶子层） ② 范围查询吊打B树 ③ 非叶节点更"苗条"
     </p>
    </blockquote>
    <blockquote>
     <p>
      <strong>
       面试官
      </strong>
      ：HashMap为什么不用红黑树？
     </p>
     <p>
      <strong>
       答
      </strong>
      ：① 哈希冲突少时链表更快 ② 红黑树适合持久化结构 ③ 达到阈值才树化
     </p>
    </blockquote>
    <blockquote>
     <p>
      <strong>
       面试官
      </strong>
      ：B树的t值怎么选？
     </p>
     <p>
      <strong>
       答
      </strong>
      ：根据磁盘页大小！比如4KB页，假设key占16B，t≈4KB/(16B+8B)=170
     </p>
    </blockquote>
    <hr/>
    <h3>
     <a id="_189">
     </a>
     七、实战训练场
    </h3>
    <h4>
     <a id="71_AVL_191">
     </a>
     7.1 AVL树平衡检测
    </h4>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/4e65b5349197469fb2d8a77c0796fd63.png"/>
    </p>
    <h4>
     <a id="72__195">
     </a>
     7.2 红黑树插入案例
    </h4>
    <pre><code class="prism language-java"><span class="token comment">// 插入数字序列：3 → 7 → 2 → 5 → 4</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token class-name">RedBlackTree</span> tree <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RedBlackTree</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    tree<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ⚫</span>
    tree<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 🔴 → 触发染色</span>
    tree<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 🔴 → 触发旋转</span>
    tree<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 🔴 → 叔叔节点处理</span>
    tree<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 🔴 → 复杂旋转</span>
<span class="token punctuation">}</span>
</code></pre>
    <hr/>
    <h3>
     <a id="_211">
     </a>
     八、下期预告
    </h3>
    <p>
     <strong>
      《平衡森林的奇妙物语：从2-3树到跳表》
     </strong>
     🔥 看点抢先：
    </p>
    <ul>
     <li>
      🌳 2-3树的柔性平衡之道
     </li>
     <li>
      🪜 跳表：用概率打破平衡的叛逆者
     </li>
     <li>
      🧬 B*树：在B树基础上玩出新花样
     </li>
    </ul>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/60844fc740d549dc8a44aeb0d6dc8624.png"/>
    </p>
    <hr/>
    <blockquote>
     <p>
      🌟
      <strong>
       互动时刻
      </strong>
      ：四大天王中你最喜欢哪位？是强迫症的AVL，潮流的红黑树，还是磁盘大师B+树？留言区等你故事！
     </p>
    </blockquote>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
  <div class="blog-extension-box" id="blogExtensionBox" style="width:400px;margin:auto;margin-top:12px">
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f7778647a756973686175692f:61727469636c652f64657461696c732f313436323038383431" class_="artid" style="display:none">
 </p>
</div>


