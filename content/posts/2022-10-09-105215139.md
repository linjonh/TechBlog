---
layout: post
title: "大数据hadoop学习4-通过JAVA-程序对Hadoop文件系统HDFS进行相应操作判断文件是否存在写入文本文件上传本次文件到HDFS读取HDFS文件内容"
date: 2022-10-09 17:38:45 +0800
description: "大数据hadoop学习【4】-----利用JAVA API对Hadoo"
keywords: "java上传文件到hdfs代码运行结果"
categories: ['大数据基础Hadoop']
tags: ['Linux', 'Java', 'Hdfs', 'Hadoop']
artid: "105215139"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=105215139
    alt: "大数据hadoop学习4-通过JAVA-程序对Hadoop文件系统HDFS进行相应操作判断文件是否存在写入文本文件上传本次文件到HDFS读取HDFS文件内容"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=105215139
featuredImagePreview: https://bing.ee123.net/img/rand?artid=105215139
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     大数据hadoop学习【4】-----通过JAVA 程序对Hadoop文件系统HDFS进行相应操作(判断文件是否存在、写入文本文件、上传本次文件到HDFS、读取HDFS文件内容)
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
    </p>
    <div class="toc">
     <h4>
      大数据hadoop学习【4】-----利用JAVA API对Hadoop文件系统HDFS进行相应操作目录
     </h4>
     <ul>
      <li>
       <a href="#Hadoopeclipsejava_3" rel="nofollow">
        一、运行Hadoop,并建立eclipse相应java工程项目
       </a>
      </li>
      <li>
       <ul>
        <li>
         <a href="#1Hadoop_4" rel="nofollow">
          1、运行Hadoop
         </a>
        </li>
        <li>
         <a href="#2eclipse_19" rel="nofollow">
          2、建立eclipse项目
         </a>
        </li>
       </ul>
      </li>
      <li>
       <a href="#java_23" rel="nofollow">
        二、编写java程序判定文件是否存在
       </a>
      </li>
      <li>
       <ul>
        <li>
         <a href="#1javajava_24" rel="nofollow">
          1、在创建的java项目中新建java类
         </a>
        </li>
        <li>
         <a href="#2java_27" rel="nofollow">
          2、编写判定文件是否存在的java程序
         </a>
        </li>
        <li>
         <a href="#3_55" rel="nofollow">
          3、运行结果
         </a>
        </li>
       </ul>
      </li>
      <li>
       <a href="#javaLinuxHDFS_65" rel="nofollow">
        三、编写java程序将Linux本地文件上传到HDFS文件系统
       </a>
      </li>
      <li>
       <ul>
        <li>
         <a href="#1Linux_66" rel="nofollow">
          1、准备好相应的Linux本地文件
         </a>
        </li>
        <li>
         <a href="#2java_72" rel="nofollow">
          2、编写相应的java代码
         </a>
        </li>
        <li>
         <a href="#3_99" rel="nofollow">
          3、运行结果如下
         </a>
        </li>
        <li>
         <a href="#4HDFS_102" rel="nofollow">
          4、通过相应HDFS文件操作命令，查看本地文件是否上传成功
         </a>
        </li>
       </ul>
      </li>
      <li>
       <a href="#javaHDFS_115" rel="nofollow">
        四、编写java程序将文本文件写入HDFS文件
       </a>
      </li>
      <li>
       <ul>
        <li>
         <a href="#1java_116" rel="nofollow">
          1、编写完成功能的java程序代码
         </a>
        </li>
        <li>
         <a href="#2_145" rel="nofollow">
          2、程序的运行结果
         </a>
        </li>
        <li>
         <a href="#3HDFS_148" rel="nofollow">
          3、通过相应HDFS文件操作命令，查看文件是否写入成功
         </a>
        </li>
       </ul>
      </li>
      <li>
       <a href="#javaHDFS_161" rel="nofollow">
        五、编写java程序读取HDFS文本文件内容
       </a>
      </li>
      <li>
       <ul>
        <li>
         <a href="#1HDFS_162" rel="nofollow">
          1、在HDFS文件系统中准备对应的文本文件
         </a>
        </li>
        <li>
         <a href="#2java_179" rel="nofollow">
          2、编写对应功能的java程序
         </a>
        </li>
        <li>
         <a href="#3_209" rel="nofollow">
          3、程序运行结果如下
         </a>
        </li>
       </ul>
      </li>
     </ul>
    </div>
    <br/>
    <strong>
     在进行hadoop学习时，首先需要对HDFS文件系统有一定的理解，其次，我们需要对HDFS文件系统进行操作，这和linux文件操作是类似的，只不过在不同的架构上面，HDFS是hadoop的专用文件系统，用来存储hadoop的相应文件，与本地文件进行区分！
     <br/>
     本次博客，林君学长主要带大家了解如何利用java程序对hadoop上面的HDFS进行相应的操作，已达到我们需要的对应目的
    </strong>
    <p>
    </p>
    <h2>
     <a id="Hadoopeclipsejava_3">
     </a>
     一、运行Hadoop,并建立eclipse相应java工程项目
    </h2>
    <h3>
     <a id="1Hadoop_4">
     </a>
     1、运行Hadoop
    </h3>
    <p>
     1)、在本地用户上面切换为hadoop用户
    </p>
    <pre><code class="prism language-bash"><span class="token function">su</span> - hadoop
</code></pre>
    <p>
     2）、进入hadoop运行环境
    </p>
    <pre><code class="prism language-bash"><span class="token function">cd</span> /usr/local/hadoop
</code></pre>
    <p>
     3)、运行hadoop
    </p>
    <pre><code class="prism language-bash">./sbin/start-dfs.sh
jps
</code></pre>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/41d93a52ce4e5fbc9c2031d5fd427487.png"/>
    </p>
    <h3>
     <a id="2eclipse_19">
     </a>
     2、建立eclipse项目
    </h3>
    <p>
     1）、打开eclipse，进行项目包的创建
     <br/>
     <mark>
      file-&gt;New-&gt;java project
     </mark>
     <br/>
     之前创建好的，可以用之前的java项目包哦！
    </p>
    <h2>
     <a id="java_23">
     </a>
     二、编写java程序判定文件是否存在
    </h2>
    <h3>
     <a id="1javajava_24">
     </a>
     1、在创建的java项目中新建java类
    </h3>
    <p>
     <mark>
      在项目中右击-&gt;New-&gt;class
     </mark>
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/d99979c800056c96408f6a666d973252.png"/>
    </p>
    <h3>
     <a id="2java_27">
     </a>
     2、编写判定文件是否存在的java程序
    </h3>
    <p>
     1）、判断文件是否存在的java程序如下：
    </p>
    <pre><code class="prism language-java"><span class="token keyword">import</span> org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hadoop<span class="token punctuation">.</span>conf<span class="token punctuation">.</span>Configuration<span class="token punctuation">;</span>
<span class="token keyword">import</span> org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hadoop<span class="token punctuation">.</span>fs<span class="token punctuation">.</span>FileSystem<span class="token punctuation">;</span>
<span class="token keyword">import</span> org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hadoop<span class="token punctuation">.</span>fs<span class="token punctuation">.</span>Path<span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Hdfs</span> <span class="token punctuation">{<!-- --></span>
	<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">try</span><span class="token punctuation">{<!-- --></span>
            String fileName <span class="token operator">=</span> <span class="token string">"test"</span><span class="token punctuation">;</span>
            Configuration conf <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Configuration</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            conf<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">"fs.defaultFS"</span><span class="token punctuation">,</span> <span class="token string">"hdfs://localhost:9000"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            conf<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">"fs.hdfs.impl"</span><span class="token punctuation">,</span> <span class="token string">"org.apache.hadoop.hdfs.DistributedFileSystem"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            FileSystem fs <span class="token operator">=</span> FileSystem<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>conf<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>fs<span class="token punctuation">.</span><span class="token function">exists</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Path</span><span class="token punctuation">(</span>fileName<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"文件存在"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{<!-- --></span>
                System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"文件不存在"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
 
        <span class="token punctuation">}</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     上面可以看，我们判断的文件名为
     <mark>
      test
     </mark>
     ,在本地是不存在的，所以运行结果肯定是文件不存在！
     <br/>
     <strong>
      请注意修改自己的类名！
     </strong>
    </p>
    <h3>
     <a id="3_55">
     </a>
     3、运行结果
    </h3>
    <p>
     1）、原来代码的运行结果如下所示：
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/dcb38cda29f3bc0867b64f45a946b033.png">
      <br/>
      2）、修改文件名，将HDFS中已经有的文件写入，判断文件是否存在
      <br/>
      1.将路径修改如下：
     </img>
    </p>
    <pre><code class="prism language-java">String fileName <span class="token operator">=</span> <span class="token string">"/user/hadoop/input/my.txt"</span><span class="token punctuation">;</span>
</code></pre>
    <p>
     2.运行结果如下所示：
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/5c8217421d5c677234baee3dc17c6c73.png"/>
    </p>
    <h2>
     <a id="javaLinuxHDFS_65">
     </a>
     三、编写java程序将Linux本地文件上传到HDFS文件系统
    </h2>
    <h3>
     <a id="1Linux_66">
     </a>
     1、准备好相应的Linux本地文件
    </h3>
    <p>
     1）、林君学长自己的本地文件如下所示：
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/1d2b2c2df1fa542f94a8e94d6b98cb81.png">
      <br/>
      2）、文件内容如下所示：
      <br/>
      <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/104d21f110ae43f65e3d29f4fabd5463.png"/>
     </img>
    </p>
    <h3>
     <a id="2java_72">
     </a>
     2、编写相应的java代码
    </h3>
    <p>
     1）、将Linux本地文件上传到HDFS文件系统的java程序如下所示：
    </p>
    <pre><code class="prism language-java"><span class="token keyword">import</span> org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hadoop<span class="token punctuation">.</span>conf<span class="token punctuation">.</span>Configuration<span class="token punctuation">;</span>
<span class="token keyword">import</span> org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hadoop<span class="token punctuation">.</span>fs<span class="token punctuation">.</span>FileSystem<span class="token punctuation">;</span>
<span class="token keyword">import</span> org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hadoop<span class="token punctuation">.</span>fs<span class="token punctuation">.</span>Path<span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">LinuxToHdfs</span> <span class="token punctuation">{<!-- --></span>
	<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        Configuration conf <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Configuration</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        conf<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">"fs.defaultFS"</span><span class="token punctuation">,</span> <span class="token string">"hdfs://localhost:9000"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        conf<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">"fs.hdfs.impl"</span><span class="token punctuation">,</span> <span class="token string">"org.apache.hadoop.hdfs.DistributedFileSystem"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        String localDir <span class="token operator">=</span> <span class="token string">"/home/chenlin/lenovo/hadoopTest.txt"</span><span class="token punctuation">;</span><span class="token comment">//本地路径</span>
        String hdfsDir <span class="token operator">=</span> <span class="token string">"/user/hadoop/input/"</span><span class="token punctuation">;</span><span class="token comment">//HDFS文件路径</span>
        <span class="token keyword">try</span><span class="token punctuation">{<!-- --></span>
            Path localPath <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Path</span><span class="token punctuation">(</span>localDir<span class="token punctuation">)</span><span class="token punctuation">;</span>
            Path hdfsPath <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Path</span><span class="token punctuation">(</span>hdfsDir<span class="token punctuation">)</span><span class="token punctuation">;</span>
            FileSystem hdfs <span class="token operator">=</span> FileSystem<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>conf<span class="token punctuation">)</span><span class="token punctuation">;</span>
            hdfs<span class="token punctuation">.</span><span class="token function">copyFromLocalFile</span><span class="token punctuation">(</span>localPath<span class="token punctuation">,</span>hdfsPath<span class="token punctuation">)</span><span class="token punctuation">;</span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"上传成功"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span>Exception e<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <blockquote>
     <p>
      该程序的功能是：将本地路径
      <mark>
       home/chenlin/lenovo/hadoopTest.txt
      </mark>
      的文件上传到HDFS中路径为/user/hadoop/input/的目录下面
     </p>
    </blockquote>
    <h3>
     <a id="3_99">
     </a>
     3、运行结果如下
    </h3>
    <p>
     1）、程序的运行结果：
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/b6ed8cadf0c64fc52a44e8131324cafe.png"/>
    </p>
    <h3>
     <a id="4HDFS_102">
     </a>
     4、通过相应HDFS文件操作命令，查看本地文件是否上传成功
    </h3>
    <p>
     1)、用ls命令查看是否上传到hdfs文件系统中去
    </p>
    <pre><code class="prism language-bash">./bin/hdfs dfs -ls /user/hadoop/input
</code></pre>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/8deb5ed74017901e6ac80a8527ee45c2.png">
      <br/>
      可以看到，该文件内容已经上传到我们的HDFS文件系统中去了！
      <br/>
      2)、用cat命令查看文件内容，是否与我们本地ubuntu系统下的文件内容一样
     </img>
    </p>
    <pre><code class="prism language-bash"> ./bin/hdfs dfs -cat /user/hadoop/input/hadoopTest.txt
</code></pre>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/4bba92e2b83ea29320a3520a9ed0fb40.png"/>
     <br/>
     可以看到，文件内容和本地文件内容完全一样！
    </p>
    <h2>
     <a id="javaHDFS_115">
     </a>
     四、编写java程序将文本文件写入HDFS文件
    </h2>
    <h3>
     <a id="1java_116">
     </a>
     1、编写完成功能的java程序代码
    </h3>
    <p>
     1）、将文本写入HDFS文件的java代码如下所示：
    </p>
    <pre><code class="prism language-java"><span class="token keyword">import</span> org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hadoop<span class="token punctuation">.</span>conf<span class="token punctuation">.</span>Configuration<span class="token punctuation">;</span>  
<span class="token keyword">import</span> org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hadoop<span class="token punctuation">.</span>fs<span class="token punctuation">.</span>FileSystem<span class="token punctuation">;</span>
<span class="token keyword">import</span> org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hadoop<span class="token punctuation">.</span>fs<span class="token punctuation">.</span>FSDataOutputStream<span class="token punctuation">;</span>
<span class="token keyword">import</span> org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hadoop<span class="token punctuation">.</span>fs<span class="token punctuation">.</span>Path<span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">InputFile</span> <span class="token punctuation">{<!-- --></span>
	<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> 
		<span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
                Configuration conf <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Configuration</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                conf<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">"fs.defaultFS"</span><span class="token punctuation">,</span><span class="token string">"hdfs://localhost:9000"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                conf<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">"fs.hdfs.impl"</span><span class="token punctuation">,</span><span class="token string">"org.apache.hadoop.hdfs.DistributedFileSystem"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                FileSystem fs <span class="token operator">=</span> FileSystem<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>conf<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> buff <span class="token operator">=</span> <span class="token string">"this is my first hadoop test"</span><span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 要写入的内容</span>
                String filename <span class="token operator">=</span> <span class="token string">"/user/hadoop/input/test.txt"</span><span class="token punctuation">;</span> <span class="token comment">//要写入的文件名</span>
                FSDataOutputStream os <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Path</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                os<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>buff<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>buff<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>
                System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Create:"</span><span class="token operator">+</span> filename<span class="token punctuation">)</span><span class="token punctuation">;</span>
                os<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                fs<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>  
                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token punctuation">}</span>  
   <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>
</code></pre>
    <blockquote>
     <p>
      上面程序的功能是将文本文件test.txt，写入HDFS文件系统中的input目录下面
     </p>
    </blockquote>
    <h3>
     <a id="2_145">
     </a>
     2、程序的运行结果
    </h3>
    <p>
     1）、该java程序的运行结果如下所示：
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/9eccc82fe569ef4c4710588afd6b7bae.png"/>
    </p>
    <h3>
     <a id="3HDFS_148">
     </a>
     3、通过相应HDFS文件操作命令，查看文件是否写入成功
    </h3>
    <p>
     1）、通过ls命令，在input中查看是否有该文件，如下所示：
    </p>
    <pre><code class="prism language-bash">./bin/hdfs dfs -ls /user/hadoop/input
</code></pre>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/dc28f2c37a98673d657c5cd8d6be49c1.png"/>
     <br/>
     可以看到，文本文件已经创建了
     <br/>
     2）、通过cat命名查看我们的test.txt文件内容，如下所示：
    </p>
    <pre><code class="prism language-bash">./bin/hdfs dfs -cat /user/hadoop/input/test.txt
</code></pre>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/b29d1c44725eb2168b9555837e7343d6.png"/>
     <br/>
     可以看到，我们需要写入的内容已经写入我们的文件里面了，那么我们写入文件到HDFS文件系统中的程序就实现了哦！
    </p>
    <h2>
     <a id="javaHDFS_161">
     </a>
     五、编写java程序读取HDFS文本文件内容
    </h2>
    <h3>
     <a id="1HDFS_162">
     </a>
     1、在HDFS文件系统中准备对应的文本文件
    </h3>
    <p>
     1）、在最开始打开的终端创建
     <mark>
      test.txt
     </mark>
     文件
    </p>
    <pre><code class="prism language-bash"><span class="token function">touch</span> test.txt
</code></pre>
    <p>
     2)、打开test.txt文件
    </p>
    <pre><code class="prism language-bash">gedit test.txt
</code></pre>
    <p>
     3）、文件内容如下所示：
    </p>
    <pre><code class="prism language-java"><span class="token keyword">this</span> is my first hadoop tset
</code></pre>
    <p>
     3)、将本地文件上传到HDFS文件系统中的input目录：
    </p>
    <pre><code class="prism language-bash">./bin/hdfs dfs -put ./test.txt  /user/hadoop/input
</code></pre>
    <h3>
     <a id="2java_179">
     </a>
     2、编写对应功能的java程序
    </h3>
    <p>
     1）、读取HDFS文本文件内容的java程序代码如下所示：
    </p>
    <pre><code class="prism language-java"><span class="token keyword">import</span> java<span class="token punctuation">.</span>io<span class="token punctuation">.</span>BufferedReader<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>io<span class="token punctuation">.</span>InputStreamReader<span class="token punctuation">;</span>
<span class="token keyword">import</span> org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hadoop<span class="token punctuation">.</span>conf<span class="token punctuation">.</span>Configuration<span class="token punctuation">;</span>
<span class="token keyword">import</span> org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hadoop<span class="token punctuation">.</span>fs<span class="token punctuation">.</span>FileSystem<span class="token punctuation">;</span>
<span class="token keyword">import</span> org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hadoop<span class="token punctuation">.</span>fs<span class="token punctuation">.</span>Path<span class="token punctuation">;</span>
<span class="token keyword">import</span> org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hadoop<span class="token punctuation">.</span>fs<span class="token punctuation">.</span>FSDataInputStream<span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">OutFile</span> <span class="token punctuation">{<!-- --></span>
	<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
                Configuration conf <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Configuration</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                conf<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">"fs.defaultFS"</span><span class="token punctuation">,</span><span class="token string">"hdfs://localhost:9000"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                      
				conf<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">"fs.hdfs.impl"</span><span class="token punctuation">,</span><span class="token string">"org.apache.hadoop.hdfs.DistributedFileSystem"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                FileSystem fs <span class="token operator">=</span> FileSystem<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>conf<span class="token punctuation">)</span><span class="token punctuation">;</span>
                Path file <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Path</span><span class="token punctuation">(</span><span class="token string">"/user/hadoop/input/test.txt"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
                FSDataInputStream getIt <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">;</span>
                BufferedReader d <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BufferedReader</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">InputStreamReader</span><span class="token punctuation">(</span>getIt<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                String content <span class="token operator">=</span> d<span class="token punctuation">.</span><span class="token function">readLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//读取文件一行</span>
                System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token punctuation">;</span>
                d<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//关闭文件</span>
                fs<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//关闭hdfs</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <blockquote>
     <p>
      该程序是读取HDFS文件中路径为
      <mark>
       /user/hadoop/input/test.txt
      </mark>
      的文件内容！
     </p>
    </blockquote>
    <h3>
     <a id="3_209">
     </a>
     3、程序运行结果如下
    </h3>
    <p>
     1）、该java程序的运行结果如下所示：
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/6efb5396dc60dc87168ebc11162dee05.png"/>
     <br/>
     由上面可以看出，我们的文件内容已经从HDFS文件系统中读取出来了，与我们tset.txt的文件内容一模一样，程序功能完美实现啦！
     <br/>
     <strong>
      以上就是本次博客的全部内容，对本次博客的阅读，希望对大家可以理解如何通过java程序实现对HDFS文件系统的相应操作哦！遇到问题的小伙伴请在评论区留言，林君学长看到了会给大家解答的，这个学长不太冷！
     </strong>
     <br/>
     <em>
      陈一月的又一天编程岁月^ _ ^
     </em>
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f71715f34323435313235312f:61727469636c652f64657461696c732f313035323135313339" class_="artid" style="display:none">
 </p>
</div>


