---
arturl_encode: "68747470733a2f:2f626c6f672e6373646e2e6e65742f6c696c6934303334322f:61727469636c652f64657461696c732f313238353836353333"
layout: post
title: "微软的COMDOM和COM"
date: 2025-01-01 15:17:44 +08:00
description: "COM是微软提出的软件开发技术，允许创建可重用的组件，用于构建复杂应用系统。DCOM扩展了COM，支"
keywords: "dom com"
categories: ['编程笔记']
tags: ['Windows', 'Microsoft', 'Dcom', 'Com', 'Com']
artid: "128586533"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=128586533
    alt: "微软的COMDOM和COM"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=128586533
featuredImagePreview: https://bing.ee123.net/img/rand?artid=128586533
---

# 微软的COM、DOM和COM+

![](https://i-blog.csdnimg.cn/blog_migrate/a5137cce9a62eea2e3cf1c9c0704ecd4.png)

> 纯粹的为了记录一下

##### COM

组件对象模型（COM），是微软公司为了计算机工业的软件生产更加符合人类的行为方式开发的一种新的软件开发技术。在COM构架下，人们可以开发出各种各样的功能专一的组件，然后将它们按照需要组合起来，构成复杂的应用系统。由此带来的好处是多方面的：可以将系统中的组件用新的替换掉，以便随时进行系统的升级和定制；可以在多个应用系统中重复利用同一个组件；可以方便的将应用系统扩展到网络环境下；COM与语言，平台无关的特性使所有的程序员均可充分发挥自己的才智与专长编写组件模块；等等。

COM是开发软件组件的一种方法。组件实际上是一些小的二进制可执行程序，它们可以给应用程序，操作系统以及其他组件提供服务。开发自定义的COM组件就如同开发动态的，面向对象的API。多个COM对象可以连接起来形成应用程序或组件系统。并且组件可以在运行时刻，在不被重新链接或编译应用程序的情况下被卸下或替换掉。Microsoft的许多技术，如ActiveX、DirectX以及OLE等都是基于COM而建立起来的。并且Microsoft的开发人员也大量使用COM组件来定制他们的应用程序及操作系统。

COM所含的概念并不止是在Microsoft Windows操作系统下才有效。COM并不是一个大的API，它实际上象结构化编程及面向对象编程方法那样，也是一种编程方法。在任何一种操作系统中，开发人员均可以遵循“COM方法”。

##### DCOM

DCOM是微软与其他业界厂商合作提出的一种分布组件对象模型，它是COM在分布计算方面的自然延续，为分布在网络不同节点的两个COM组件提供了互操作的基础结构。DCOM增强COM的分布处理性能，支持多种通信协议，加强组件通信的安全保障，把基于认证Internet安全机制同基于Windows NT的C2级安全机制集成在一起。但从系统内部的实现机制而言，DCOM所采用的技术仍符COM模式。

DCOM自动建立连接、传输信息并返回来自远程组件的答复。DCOM在组件中的作用有如PC机间通信的PCI和ISA总线，负责各种组件之间的信息传递，如果没有DCOM，则达不到分布计算环境的要求。微软通过纳入事务处理服务、更容易的编程以及对Unix和其它平台的支持扩充了DCOM。

建立DCOM时和使用COM建立对象的方式是相同的，只需再加入一个机器名称的参数。如果COM通过Windows
  
API的CoGetClassObject建立对象，只需再输入机器名称的参数即可在远程指定的计算机中建立对象，并且取得指定接口的信息。它构造于RPC的技术之上，并且使用TCP/IP作为网络通信协议。

##### COM+

COM+不再局限于COM的组件技术，它更加注重于分布式网络应用的设计和实现。COM+继承了COM几乎全部的优势，同时又避免了COM实现方面的一些不足，把COM、DCOM和MTS的编程模型结合起来，继承了它们的绝大多数特性，在原有的特性上增加了新的功能。

以下列出COM+的几个主要特性：

COM+不仅继承了COM所有的优点，而且还增加了一些服务，比如队列服务、负载平衡、内存数据库、事件服务等。

##### COM/DCOM/COM+关系

![在这里插入图片描述](https://i-blog.csdnimg.cn/blog_migrate/946c0f4462e96db028a58aa57f6c55d3.png)

##### DCOM/MTS/MQ/COM+

为了让企业级的应用程序能使用上COM，它必需要有以下的特定的能力：

* 验证能力
* 对象池（Object Pooling）
* 事务处理
* 支持分布式架构

为了使开发者不必去为他们的组件添加这些能力，微软公司出品了DCOM（Distributed
  
COM分布式COM）和MTS（Microsoft Transaction Server微软事务服务器）。使用这两种技术，开发者就可以把精力用在他们的商业逻辑上，而不必放在后台的他们的组件上。

DCOM是一个用于分布式的组件之间的通讯的RPC（Remote Procedure
  
Call）协议。客户端向一个本地机的代理类发送请求，然后由代理类将这个请求隐含地给安装在远程机器上的"根"类，然后执行结果原路送回给代理类，最后代理类把它们回送给客户端。因此，客户程序的位置完全与组件的位置无关。DCOM的缺点在于，由于DCOM使用的是一个独立的硬件端口，而不是HTTP协议的80端口，所以在组件间通讯的过程中，必须保证这个端口是开着的。这是一个严重的安全问题。所以DCOM不能够轻易地穿越防火墙。

为了使用MTS，程序员在它们的组件里放置特别的MTS钩子，编译后把他们放在MTS包中。把有关系的组件放在一个单一的包中有它自己的好处。当客户请求一个包中的一个组件的一个实例的时候，MTS确保为这个包建立一个新的专门的线程，一个新的组件实例被建立在这个线程上并被应用事务服务。至于对象池服务和安全服务是否要被建立，那就要看开发者的请求了。

MTS允许相关的作业单元被当作一个事务来对待，这意味着如果所有的作业单元被成功地完成，整个事务就被当作成功地完成，反之如果有一个单元未成功完成，整个事务将被重新轮回。

在客户请求对象和释放对象后，MTS仍保存着这个对象，所以当另一个客户请求同一个组件的时候，MTS就将保存着的对象交给它。通过这种方式，MTS减少了在服务器源实例化的次数。

MTS允许开发者用安全措施来组装他们的组件，以使其具有识别请求它的服务的客户的能力。这能够确保未经授权的客户不能够使用组件的功能。

MTS以COM+的名义被完整地整合到了微软公司的Windows
  
2000操作系统中，但是COM+不仅仅只有MTS，它还包括一些其它的服务。MSMQ（Microsoft Message Queue
  
Server），一个与MTS一同发布的服务，也被以COM+的名义整合到了Windows
  
2000中。MSMQ允许服务器端和客户端进行同步的通讯。事件服务（Event
  
Service）也被加了进来，它使服务器能够与客户端同步地交流事件的发生。负载平衡服务（Load
  
Balancing）自动地实例化机器上的具有最多资源的服务器上的请求对象。