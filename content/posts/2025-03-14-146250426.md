---
layout: post
title: "Java-SQL-操作指南深入理解-Statement-用法与优化"
date: 2025-03-14 10:17:51 +0800
description: "Statement接口继承了和Wrapper接口，使其具备自动关闭和封装功能。：提供close()方法，确保Statement在不再使用时释放资源。Wrapper：提供>)和方法，允许Statement作为其他数据库 API 的封装。此外，Statement还包含多个重要属性，如cursorNamepoolableconnection等。Statement是 JDBC 提供的用于执行 SQL 语句的接口，主要特点如下：适用于执行静态 SQL 语句，每次执行都需要编译。通过执行查询语句，返回。"
keywords: "《Java SQL 操作指南：深入理解 Statement 用法与优化》"
categories: ['Java']
tags: ['数据库', 'Sql', 'Java']
artid: "146250426"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146250426
    alt: "Java-SQL-操作指南深入理解-Statement-用法与优化"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146250426
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146250426
cover: https://bing.ee123.net/img/rand?artid=146250426
image: https://bing.ee123.net/img/rand?artid=146250426
img: https://bing.ee123.net/img/rand?artid=146250426
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     《Java SQL 操作指南：深入理解 Statement 用法与优化》
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <p>
     在 Java 数据库编程中，
     <code>
      Statement
     </code>
     是用于执行 SQL 语句的接口，允许程序与数据库进行交互。本文将详细介绍
     <code>
      Statement
     </code>
     的基本概念、常见用法以及
     <code>
      PreparedStatement
     </code>
     和
     <code>
      CallableStatement
     </code>
     等相关接口。
    </p>
    <h2>
     1. Statement 基本介绍
    </h2>
    <p>
     <img alt="" height="834" src="https://i-blog.csdnimg.cn/direct/b7a8ef305086448c8082f532d0e11b1a.png" width="820"/>
    </p>
    <p>
     <code>
      Statement
     </code>
     接口继承了
     <code>
      AutoCloseable
     </code>
     和
     <code>
      Wrapper
     </code>
     接口，使其具备自动关闭和封装功能。
    </p>
    <ul>
     <li>
      <p>
       <code>
        AutoCloseable
       </code>
       ：提供
       <code>
        close()
       </code>
       方法，确保
       <code>
        Statement
       </code>
       在不再使用时释放资源。
      </p>
     </li>
     <li>
      <p>
       <code>
        Wrapper
       </code>
       ：提供
       <code>
        isWrapperFor(Class&lt;?&gt;)
       </code>
       和
       <code>
        unwrap(Class&lt;T&gt;)
       </code>
       方法，允许
       <code>
        Statement
       </code>
       作为其他数据库 API 的封装。
      </p>
     </li>
    </ul>
    <p>
     此外，
     <code>
      Statement
     </code>
     还包含多个重要属性，如
     <code>
      cursorName
     </code>
     、
     <code>
      poolable
     </code>
     、
     <code>
      connection
     </code>
     等。
    </p>
    <p>
     <code>
      Statement
     </code>
     是 JDBC 提供的用于执行 SQL 语句的接口，主要特点如下：
    </p>
    <ol>
     <li>
      <p>
       适用于执行静态 SQL 语句，每次执行都需要编译。
      </p>
     </li>
     <li>
      <p>
       通过
       <code>
        executeQuery()
       </code>
       执行查询语句，返回
       <code>
        ResultSet
       </code>
       。
      </p>
     </li>
     <li>
      <p>
       通过
       <code>
        executeUpdate()
       </code>
       执行更新语句，返回影响的行数。
      </p>
     </li>
     <li>
      <p>
       存在 SQL 注入风险，建议使用
       <code>
        PreparedStatement
       </code>
       代替。
      </p>
     </li>
    </ol>
    <h2>
     2. Statement 的基本用法
    </h2>
    <pre><code class="language-java">package JDBC;

import java.io.FileInputStream;
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.Statement;
import java.util.Properties;
import java.util.Scanner;

//JDBC注入机制演示

public class Statement_ {
    public static void main(String[] args) throws Exception {

//        Class.forName("com.mysql.jdbc.Driver");
        Scanner scanner = new Scanner(System.in);
        System.out.println("Enter SQL nameusr statement");
        String username =scanner.nextLine();
        System.out.println("Enter SQL pwd statement");
        String pwd =scanner.nextLine();

        Properties properties = new Properties();
        properties.load(new FileInputStream("src\\JDBC\\mysql.properties"));
        String url = (String) properties.get("url");
        String user =(String) properties.get("user");
        String password =(String) properties.get("password");
        String driver =(String) properties.get("driver");
//        实例化
        Class.forName(driver);

        Connection connection = DriverManager.getConnection(url, user, password);

//        得到statement
        Statement statement = connection.createStatement();

//        组织查询语句
        String sql = "select * from sql_injection where NAME='"+username+"'and  pwd = '"+pwd+"';" ;
        System.out.printf(sql+"\n");

        ResultSet resultSet = statement.executeQuery(sql);
        if (resultSet.next()) {
            System.out.println("查询成功");

        }
        else {
            System.out.println("查询失败");

        }

//        关闭连接,安全操作
        resultSet.close();
        statement.close();
        connection.close();



    }
}
</code></pre>
    <h3>
     2.1 主要方法
    </h3>
    <p>
     <img alt="" height="702" src="https://i-blog.csdnimg.cn/direct/af903fb7b5124321a2a3c4198813997d.png" width="375"/>
    </p>
    <ul>
     <li>
      <p>
       <code>
        execute(String sql)
       </code>
       : 执行 SQL 语句，返回
       <code>
        boolean
       </code>
       ，如果执行的是查询语句，返回
       <code>
        true
       </code>
       ，否则返回
       <code>
        false
       </code>
       。
      </p>
     </li>
     <li>
      <p>
       <code>
        executeQuery(String sql)
       </code>
       : 仅用于
       <code>
        SELECT
       </code>
       语句，返回
       <code>
        ResultSet
       </code>
       。
      </p>
     </li>
     <li>
      <p>
       <code>
        executeUpdate(String sql)
       </code>
       : 仅用于
       <code>
        INSERT
       </code>
       、
       <code>
        UPDATE
       </code>
       或
       <code>
        DELETE
       </code>
       语句，返回受影响的行数。
      </p>
     </li>
     <li>
      <p>
       <code>
        addBatch(String sql)
       </code>
       : 添加 SQL 语句到批处理命令中。
      </p>
     </li>
     <li>
      <p>
       <code>
        executeBatch()
       </code>
       : 执行批处理命令，返回每条 SQL 语句影响的行数。
      </p>
     </li>
     <li>
      <p>
       <code>
        clearBatch()
       </code>
       : 清除已添加的批处理命令。
      </p>
     </li>
     <li>
      <p>
       <code>
        setQueryTimeout(int seconds)
       </code>
       : 设置查询超时时间。
      </p>
     </li>
     <li>
      <p>
       <code>
        getMoreResults()
       </code>
       : 检查是否存在多个
       <code>
        ResultSet
       </code>
       。
      </p>
     </li>
     <li>
      <p>
       <code>
        close()
       </code>
       : 关闭
       <code>
        Statement
       </code>
       ，释放资源。
      </p>
     </li>
    </ul>
    <h3>
     2.2 执行更新操作
    </h3>
    <p>
     可以使用
     <code>
      executeUpdate()
     </code>
     进行
     <code>
      INSERT
     </code>
     、
     <code>
      UPDATE
     </code>
     和
     <code>
      DELETE
     </code>
     操作，例如：
    </p>
    <pre><code class="language-java">Statement stmt = conn.createStatement();
int rowsAffected = stmt.executeUpdate("UPDATE users SET age = 30 WHERE id = 1");
System.out.println("更新影响的行数: " + rowsAffected);</code></pre>
    <p>
    </p>
    <h2>
     3. Statement 的问题与优化
    </h2>
    <h3>
     3.1 SQL 注入风险
    </h3>
    <p>
     使用
     <code>
      Statement
     </code>
     直接拼接 SQL 语句可能会导致 SQL 注入攻击，例如：
    </p>
    <pre><code class="language-sql">USE mydatabase;
SHOW DATABASES;

SHOW TABLES;
CREATE TABLE sql_injection  ( -- 管理表
	NAME VARCHAR(32) NOT NULL UNIQUE,
	pwd VARCHAR(32) NOT NULL DEFAULT ''
)CHARACTER SET utf8;


DROP TABLE sql_injection;
DESC sql_injection;

INSERT INTO sql_injection VALUES( 'wangya' ,'1314520'
);

SELECT * FROM sql_injection;

SELECT *  FROM  sql_injection
	WHERE NAME='wangya' AND pwd='1314520';

-- sql 注入演示
-- 用户输入密码为： 1' or
-- 输入密码为：or '1'= '1
SELECT *  FROM  sql_injection
	WHERE NAME='1' OR' or AND pwd='OR '1'= '1';

SELECT *  FROM  sql_injection
	WHERE NAME='wangya' OR pwd='1314520'  OR '1'='1' ;</code></pre>
    <p>
     <img alt="" height="308" src="https://i-blog.csdnimg.cn/direct/679b001fbb0d4de0b855411e72924edb.png" width="668"/>
    </p>
    <p>
     以上代码可能被攻击者利用，绕过密码验证。
    </p>
    <h2>
     总结
    </h2>
    <p>
     <code>
      Statement
     </code>
     是 Java 数据库操作的基本接口，但由于其存在 SQL 注入风险，在实际开发中推荐使用
     <code>
      PreparedStatement
     </code>
     。此外，
     <code>
      CallableStatement
     </code>
     适用于调用存储过程，提高数据库访问效率。了解并正确使用这些接口，可以提升数据库操作的安全性和性能。
    </p>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f2f:626c6f672e6373646e2e6e65742f6b6573686931323335342f:61727469636c652f64657461696c732f313436323530343236" class_="artid" style="display:none">
 </p>
</div>


