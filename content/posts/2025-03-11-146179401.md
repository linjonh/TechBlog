---
layout: post
title: "Vue3ä¸­ä½¿ç”¨exceljså’Œfile-saverå®ç°Excelå¯¼å‡ºå«å›¾ç‰‡å¯¼å‡ºå®Œæ•´æ–¹æ¡ˆ"
date: 2025-03-11 15:43:39 +0800
description: "å¼€ç®±å³ç”¨ï¼šå°è£…å®Œæ•´å·¥å…·å‡½æ•°çµæ´»é…ç½®ï¼šæ”¯æŒå¤šå›¾ç‰‡åˆ—ã€è‡ªå®šä¹‰æ ·å¼å¥å£®æ€§å¼ºï¼šå®Œå–„çš„å¼‚å¸¸å¤„ç†æœºåˆ¶å»ºè®®æ ¹æ®å®é™…ä¸šåŠ¡éœ€æ±‚è°ƒæ•´å›¾ç‰‡å®šä½å‚æ•°å’Œæ ·å¼é…ç½®ï¼Œå¯¹äºå¤æ‚æŠ¥è¡¨å»ºè®®ç»“åˆåç«¯ç”Ÿæˆæ–¹æ¡ˆã€‚"
keywords: "Vue3ä¸­ä½¿ç”¨exceljså’Œfile-saverå®ç°Excelå¯¼å‡ºï¼ˆå«å›¾ç‰‡å¯¼å‡ºï¼‰å®Œæ•´æ–¹æ¡ˆ"
categories: ['æœªåˆ†ç±»']
tags: ['Excel']
artid: "146179401"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146179401
    alt: "Vue3ä¸­ä½¿ç”¨exceljså’Œfile-saverå®ç°Excelå¯¼å‡ºå«å›¾ç‰‡å¯¼å‡ºå®Œæ•´æ–¹æ¡ˆ"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146179401
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146179401
cover: https://bing.ee123.net/img/rand?artid=146179401
image: https://bing.ee123.net/img/rand?artid=146179401
img: https://bing.ee123.net/img/rand?artid=146179401
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     Vue3ä¸­ä½¿ç”¨exceljså’Œfile-saverå®ç°Excelå¯¼å‡ºï¼ˆå«å›¾ç‰‡å¯¼å‡ºï¼‰å®Œæ•´æ–¹æ¡ˆ
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h3>
     <a id="__1">
     </a>
     ğŸ“ é—®é¢˜èƒŒæ™¯
    </h3>
    <p>
     åœ¨Vue3é¡¹ç›®ä¸­ï¼Œå½“æˆ‘ä»¬éœ€è¦å°†åŒ…å«å›¾ç‰‡çš„æ•°æ®å¯¼å‡ºåˆ°Excelæ—¶ï¼Œå¸¸ç”¨çš„
     <code>
      sheetjs/xlsx
     </code>
     åº“å­˜åœ¨å±€é™æ€§ï¼š
     <strong>
      æ— æ³•ç›´æ¥å¯¼å‡ºå›¾ç‰‡åˆ°å•å…ƒæ ¼
     </strong>
     ã€‚æœ¬æ–‡å°†æä¾›å®Œæ•´çš„è§£å†³æ–¹æ¡ˆï¼Œå°è£…å¯ç›´æ¥å¤ç”¨çš„å·¥å…·å‡½æ•°ã€‚
    </p>
    <hr/>
    <h3>
     <a id="__7">
     </a>
     ğŸ¯ è§£å†³æ–¹æ¡ˆ
    </h3>
    <h4>
     <a id="_9">
     </a>
     æŠ€æœ¯é€‰å‹
    </h4>
    <p>
     ä½¿ç”¨
     <code>
      exceljs
     </code>
     +
     <code>
      file-saver
     </code>
     ç»„åˆï¼š
    </p>
    <ul>
     <li>
      <code>
       exceljs
      </code>
      ï¼šæ”¯æŒå›¾ç‰‡æ’å…¥çš„Excelæ“ä½œåº“
     </li>
     <li>
      <code>
       file-saver
      </code>
      ï¼šå‰ç«¯æ–‡ä»¶ä¿å­˜å·¥å…·
     </li>
    </ul>
    <h4>
     <a id="_14">
     </a>
     åŠŸèƒ½ç‰¹æ€§
    </h4>
    <p>
     âœ… æ”¯æŒå¤šå›¾ç‰‡åˆ—å¯¼å‡º
     <br/>
     âœ… è‡ªåŠ¨è¯†åˆ«Base64å’ŒDataURLæ ¼å¼
     <br/>
     âœ… ç²¾ç¡®æ§åˆ¶å›¾ç‰‡ä½ç½®
     <br/>
     âœ… å¼‚å¸¸å¤„ç†ä¸æ€§èƒ½ä¼˜åŒ–
    </p>
    <hr/>
    <h3>
     <a id="__22">
     </a>
     ğŸ›  å®Œæ•´å®ç°ä»£ç 
    </h3>
    <h4>
     <a id="1_24">
     </a>
     æ­¥éª¤1ï¼šå®‰è£…ä¾èµ–
    </h4>
    <pre><code class="prism language-bash"><span class="token function">npm</span> <span class="token function">install</span> exceljs file-saver
</code></pre>
    <h4>
     <a id="2_29">
     </a>
     æ­¥éª¤2ï¼šåˆ›å»ºå·¥å…·æ–‡ä»¶
    </h4>
    <pre><code class="prism language-javascript"><span class="token comment">// utils/excelExport.js</span>
<span class="token keyword">import</span> ExcelJS <span class="token keyword">from</span> <span class="token string">'exceljs'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span> saveAs <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'file-saver'</span><span class="token punctuation">;</span>

<span class="token comment">/**
 *
 * @param headers è¡¨å¤´ï¼Œ[è¡¨å¤´1,è¡¨å¤´2,...]          å¿…å¡«
 * @param tableData å†…å®¹ [data1,data2,...]       å¿…å¡«
 * @param imageIndex å›¾ç‰‡ä¸‹æ ‡åˆ— [0, 1, 2 , ...],     éå¿…å¡«
 * @returns {Promise&lt;void&gt;}
 */</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">exportToExcel</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">headers<span class="token punctuation">,</span> tableData<span class="token punctuation">,</span> imageIndex <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">const</span> workbook <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ExcelJS<span class="token punctuation">.</span>Workbook</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> worksheet <span class="token operator">=</span> workbook<span class="token punctuation">.</span><span class="token function">addWorksheet</span><span class="token punctuation">(</span><span class="token string">'Sheet1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// æ·»åŠ è¡¨å¤´</span>
    <span class="token keyword">const</span> headerRow <span class="token operator">=</span> worksheet<span class="token punctuation">.</span><span class="token function">addRow</span><span class="token punctuation">(</span>headers<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// è®¾ç½®è¡¨å¤´æ ·å¼</span>
    headerRow<span class="token punctuation">.</span><span class="token function">eachCell</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">cell</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        cell<span class="token punctuation">.</span>font <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
            <span class="token literal-property property">bold</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
            <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span> <span class="token literal-property property">argb</span><span class="token operator">:</span> <span class="token string">'FFFFFFFF'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token literal-property property">size</span><span class="token operator">:</span> <span class="token number">12</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
        cell<span class="token punctuation">.</span>fill <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
            <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'pattern'</span><span class="token punctuation">,</span>
            <span class="token literal-property property">pattern</span><span class="token operator">:</span> <span class="token string">'solid'</span><span class="token punctuation">,</span>
            <span class="token literal-property property">fgColor</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span> <span class="token literal-property property">argb</span><span class="token operator">:</span> <span class="token string">'FF007BFF'</span> <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
        cell<span class="token punctuation">.</span>alignment <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
            <span class="token literal-property property">horizontal</span><span class="token operator">:</span> <span class="token string">'center'</span><span class="token punctuation">,</span>
            <span class="token literal-property property">vertical</span><span class="token operator">:</span> <span class="token string">'middle'</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// è®¾ç½®åˆ—å®½</span>
    headers<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">_<span class="token punctuation">,</span> colIndex</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">let</span> width <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span> <span class="token comment">// é»˜è®¤åˆ—å®½</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>imageIndex<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>colIndex<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            width <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">;</span> <span class="token comment">// å›¾ç‰‡åˆ—æ›´å®½</span>
        <span class="token punctuation">}</span>
        worksheet<span class="token punctuation">.</span><span class="token function">getColumn</span><span class="token punctuation">(</span>colIndex <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>width <span class="token operator">=</span> width<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// å¤„ç†æ•°æ®è¡Œï¼ˆä¿®æ”¹ä¸ºå¼‚æ­¥ï¼‰</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> rowIdx <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> rowIdx <span class="token operator">&lt;</span> tableData<span class="token punctuation">.</span>length<span class="token punctuation">;</span> rowIdx<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">const</span> row <span class="token operator">=</span> tableData<span class="token punctuation">[</span>rowIdx<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">const</span> dataRow <span class="token operator">=</span> worksheet<span class="token punctuation">.</span><span class="token function">addRow</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>imageIndex<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// ä½¿ç”¨Promise.allå¤„ç†å¤šåˆ—å›¾ç‰‡</span>
            <span class="token keyword">await</span> Promise<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span>imageIndex<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">colIdx</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">const</span> imgUrl <span class="token operator">=</span> row<span class="token punctuation">[</span>colIdx<span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>imgUrl<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>

                <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">const</span> parsed <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">parseImageData</span><span class="token punctuation">(</span>imgUrl<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>parsed<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>

                    <span class="token keyword">const</span> imageId <span class="token operator">=</span> workbook<span class="token punctuation">.</span><span class="token function">addImage</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
                        <span class="token literal-property property">base64</span><span class="token operator">:</span> parsed<span class="token punctuation">.</span>base64<span class="token punctuation">,</span>
                        <span class="token literal-property property">extension</span><span class="token operator">:</span> parsed<span class="token punctuation">.</span>extension<span class="token punctuation">,</span>
                    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                    <span class="token keyword">const</span> colLetter <span class="token operator">=</span> <span class="token function">getExcelColumnLetter</span><span class="token punctuation">(</span>colIdx<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">const</span> excelRow <span class="token operator">=</span> rowIdx <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">;</span>

                    worksheet<span class="token punctuation">.</span><span class="token function">addImage</span><span class="token punctuation">(</span>imageId<span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token literal-property property">tl</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span> <span class="token literal-property property">col</span><span class="token operator">:</span> colIdx<span class="token punctuation">,</span> <span class="token literal-property property">row</span><span class="token operator">:</span> excelRow <span class="token operator">-</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
                        <span class="token literal-property property">br</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span> <span class="token literal-property property">col</span><span class="token operator">:</span> colIdx <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token literal-property property">row</span><span class="token operator">:</span> excelRow <span class="token punctuation">}</span><span class="token punctuation">,</span>
                        <span class="token literal-property property">editAs</span><span class="token operator">:</span> <span class="token string">'oneCell'</span> <span class="token comment">// æ›´ç¨³å®šçš„å®šä½æ–¹å¼</span>
                    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">å›¾ç‰‡å¤„ç†å¤±è´¥ï¼ˆè¡Œ</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${<!-- --></span>rowIdx <span class="token operator">+</span> <span class="token number">1</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">åˆ—</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${<!-- --></span>colIdx <span class="token operator">+</span> <span class="token number">1</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">ï¼‰:</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// ç”Ÿæˆæ–‡ä»¶</span>
    <span class="token keyword">const</span> buffer <span class="token operator">=</span> <span class="token keyword">await</span> workbook<span class="token punctuation">.</span>xlsx<span class="token punctuation">.</span><span class="token function">writeBuffer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">saveAs</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Blob</span><span class="token punctuation">(</span><span class="token punctuation">[</span>buffer<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">æ•°æ®å¯¼å‡º_</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${<!-- --></span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">.xlsx</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// åˆ—ç´¢å¼•è½¬Excelå­—æ¯ï¼ˆå¦‚ï¼š0 -&gt; A, 1 -&gt; Bï¼‰</span>
<span class="token keyword">const</span> <span class="token function-variable function">getExcelColumnLetter</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">column</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">let</span> letter <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> col <span class="token operator">=</span> column <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>col <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">const</span> remainder <span class="token operator">=</span> <span class="token punctuation">(</span>col <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">26</span><span class="token punctuation">;</span>
        letter <span class="token operator">=</span> String<span class="token punctuation">.</span><span class="token function">fromCharCode</span><span class="token punctuation">(</span><span class="token number">65</span> <span class="token operator">+</span> remainder<span class="token punctuation">)</span> <span class="token operator">+</span> letter<span class="token punctuation">;</span>
        col <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span><span class="token punctuation">(</span>col <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">26</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> letter<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// æ–°å¢ï¼šå°†å›¾ç‰‡URLè½¬æ¢ä¸ºbase64</span>
<span class="token keyword">const</span> <span class="token function-variable function">urlToBase64</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">url</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">const</span> blob <span class="token operator">=</span> <span class="token keyword">await</span> response<span class="token punctuation">.</span><span class="token function">blob</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">const</span> reader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileReader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            reader<span class="token punctuation">.</span><span class="token function-variable function">onloadend</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">resolve</span><span class="token punctuation">(</span>reader<span class="token punctuation">.</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
            reader<span class="token punctuation">.</span><span class="token function">readAsDataURL</span><span class="token punctuation">(</span>blob<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'å›¾ç‰‡è½¬æ¢å¤±è´¥:'</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// ä¿®æ”¹åçš„è§£æå‡½æ•°</span>
<span class="token keyword">const</span> <span class="token function-variable function">parseImageData</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">imgData</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>imgData<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>

    <span class="token comment">// å¤„ç†URLæƒ…å†µ</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>imgData<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">'http'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">const</span> dataURL <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">urlToBase64</span><span class="token punctuation">(</span>imgData<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>dataURL<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>

        <span class="token keyword">const</span> <span class="token punctuation">[</span>header<span class="token punctuation">,</span> base64<span class="token punctuation">]</span> <span class="token operator">=</span> dataURL<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">';base64,'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">const</span> extension <span class="token operator">=</span> header<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span> base64<span class="token punctuation">,</span> extension <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// åŸæœ‰å¤„ç†dataURLçš„é€»è¾‘</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>imgData<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">'data:image'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">const</span> <span class="token punctuation">[</span>header<span class="token punctuation">,</span> base64<span class="token punctuation">]</span> <span class="token operator">=</span> imgData<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">';base64,'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>header <span class="token operator">||</span> <span class="token operator">!</span>base64<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token keyword">const</span> extension <span class="token operator">=</span> header<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span> base64<span class="token punctuation">,</span> extension <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

</code></pre>
    <hr/>
    <h3>
     <a id="__173">
     </a>
     ğŸ“Œ ä½¿ç”¨ç¤ºä¾‹
    </h3>
    <h4>
     <a id="Vue3_175">
     </a>
     Vue3ç»„ä»¶è°ƒç”¨
    </h4>
    <pre><code class="prism language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>handleExport<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>å¯¼å‡ºExcel<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">setup</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span> exportDataToExcel <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@/utils/excelExport'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> headers <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'åç§°'</span><span class="token punctuation">,</span> <span class="token string">'ä»·æ ¼'</span><span class="token punctuation">,</span> <span class="token string">'ä¸»å›¾'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> tableData <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">[</span><span class="token string">'å•†å“A'</span><span class="token punctuation">,</span> <span class="token number">99.9</span><span class="token punctuation">,</span> <span class="token string">'https://fuss10.elemecdn.com/e/5d/4a731a90594a4af544c0c25941171jpeg.jpeg'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> 
  <span class="token punctuation">[</span><span class="token string">'å•†å“B'</span><span class="token punctuation">,</span> <span class="token number">199.9</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">]</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> imageIndex <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// ç¬¬ä¸‰åˆ—ä¸ºå›¾ç‰‡åˆ—</span>

<span class="token keyword">const</span> <span class="token function-variable function">handleExport</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">await</span> <span class="token function">exportDataToExcel</span><span class="token punctuation">(</span>headers<span class="token punctuation">,</span> tableData<span class="token punctuation">,</span> imageIndex<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre>
    <hr/>
    <h3>
     <a id="__199">
     </a>
     âš™ï¸ æ‰©å±•é…ç½®
    </h3>
    <h4>
     <a id="_201">
     </a>
     è®¾ç½®åˆ—å®½
    </h4>
    <pre><code class="prism language-javascript">    headers<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">_<span class="token punctuation">,</span> colIndex</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">let</span> width <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span> <span class="token comment">// é»˜è®¤åˆ—å®½</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>imageIndex<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>colIndex<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            width <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">;</span> <span class="token comment">// å›¾ç‰‡åˆ—æ›´å®½</span>
        <span class="token punctuation">}</span>
        worksheet<span class="token punctuation">.</span><span class="token function">getColumn</span><span class="token punctuation">(</span>colIndex <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>width <span class="token operator">=</span> width<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
    <h4>
     <a id="_212">
     </a>
     è®¾ç½®è¡¨å¤´æ ·å¼
    </h4>
    <pre><code class="prism language-javascript">headerRow<span class="token punctuation">.</span><span class="token function">eachCell</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">cell</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        cell<span class="token punctuation">.</span>font <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
            <span class="token literal-property property">bold</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
            <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span> <span class="token literal-property property">argb</span><span class="token operator">:</span> <span class="token string">'FFFFFFFF'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token literal-property property">size</span><span class="token operator">:</span> <span class="token number">12</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
        cell<span class="token punctuation">.</span>fill <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
            <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'pattern'</span><span class="token punctuation">,</span>
            <span class="token literal-property property">pattern</span><span class="token operator">:</span> <span class="token string">'solid'</span><span class="token punctuation">,</span>
            <span class="token literal-property property">fgColor</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span> <span class="token literal-property property">argb</span><span class="token operator">:</span> <span class="token string">'FF007BFF'</span> <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
        cell<span class="token punctuation">.</span>alignment <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
            <span class="token literal-property property">horizontal</span><span class="token operator">:</span> <span class="token string">'center'</span><span class="token punctuation">,</span>
            <span class="token literal-property property">vertical</span><span class="token operator">:</span> <span class="token string">'middle'</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
    <hr/>
    <h3>
     <a id="__233">
     </a>
     ğŸ“Œ å¯¼å‡ºæ ·å¼
    </h3>
    <p>
     <img alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" src="https://i-blog.csdnimg.cn/direct/a7c381fa237d4256a937f6d6fdf6aec6.png"/>
    </p>
    <hr/>
    <h3>
     <a id="__238">
     </a>
     âš ï¸ æ³¨æ„äº‹é¡¹
    </h3>
    <ol>
     <li>
      <p>
       <strong>
        å›¾ç‰‡è§„èŒƒ
       </strong>
      </p>
      <ul>
       <li>
        å»ºè®®ä½¿ç”¨PNGæ ¼å¼
       </li>
       <li>
        å•å›¾ç‰‡å°ºå¯¸ä¸è¶…è¿‡500x500px
       </li>
       <li>
        Base64å­—ç¬¦ä¸²éœ€å®Œæ•´
       </li>
      </ul>
     </li>
     <li>
      <p>
       <strong>
        æ€§èƒ½å»ºè®®
       </strong>
      </p>
      <ul>
       <li>
        æ¨èæ•°æ®é‡ï¼š&lt;1000è¡Œ
       </li>
       <li>
        å•æ–‡ä»¶å›¾ç‰‡ï¼š&lt;50å¼ 
       </li>
       <li>
        å¤§æ–‡ä»¶å»ºè®®åˆ†é¡µå¯¼å‡º
       </li>
      </ul>
     </li>
     <li>
      <p>
       <strong>
        å¸¸è§é—®é¢˜
       </strong>
      </p>
      <ul>
       <li>
        å›¾ç‰‡ä¸æ˜¾ç¤ºï¼šæ£€æŸ¥Base64æ ¼å¼æ˜¯å¦æ­£ç¡®
       </li>
       <li>
        ä½ç½®åç§»ï¼šè°ƒæ•´
        <code>
         tl
        </code>
        /
        <code>
         br
        </code>
        å®šä½å‚æ•°
       </li>
       <li>
        å†…å­˜æº¢å‡ºï¼šåˆ†æ‰¹æ¬¡å¤„ç†æ•°æ®
       </li>
      </ul>
     </li>
    </ol>
    <hr/>
    <h3>
     <a id="__257">
     </a>
     ğŸ“š å®ç°åŸç†
    </h3>
    <ol>
     <li>
      <p>
       <strong>
        åæ ‡è½¬æ¢
       </strong>
       <br/>
       é€šè¿‡
       <code>
        getExcelColumnLetter
       </code>
       å‡½æ•°å°†æ•°å­—ç´¢å¼•è½¬æ¢ä¸ºExcelå­—æ¯åæ ‡
      </p>
     </li>
     <li>
      <p>
       <strong>
        å›¾ç‰‡å¤„ç†
       </strong>
      </p>
      <ul>
       <li>
        è‡ªåŠ¨å‰¥ç¦»DataURLå¤´ä¿¡æ¯
       </li>
       <li>
        æ”¯æŒçº¯Base64ç›´æ¥ä½¿ç”¨
       </li>
      </ul>
     </li>
     <li>
      <p>
       <strong>
        å®šä½ç³»ç»Ÿ
       </strong>
      </p>
      <pre><code class="prism language-javascript"><span class="token comment">// tl: å·¦ä¸Šè§’å®šä½(top-left)</span>
<span class="token comment">// br: å³ä¸‹è§’å®šä½(bottom-right)</span>
<span class="token punctuation">{<!-- --></span> 
  <span class="token literal-property property">tl</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span> <span class="token literal-property property">col</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token literal-property property">row</span><span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// A1å•å…ƒæ ¼</span>
  <span class="token literal-property property">br</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span> <span class="token literal-property property">col</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token literal-property property">row</span><span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span>  <span class="token comment">// B2å•å…ƒæ ¼</span>
<span class="token punctuation">}</span>
</code></pre>
     </li>
    </ol>
    <hr/>
    <h3>
     <a id="__278">
     </a>
     ğŸ’¡ æ€»ç»“
    </h3>
    <p>
     æœ¬æ–‡æä¾›çš„æ–¹æ¡ˆå…·æœ‰ä»¥ä¸‹ä¼˜åŠ¿ï¼š
    </p>
    <ol>
     <li>
      <strong>
       å¼€ç®±å³ç”¨
      </strong>
      ï¼šå°è£…å®Œæ•´å·¥å…·å‡½æ•°
     </li>
     <li>
      <strong>
       çµæ´»é…ç½®
      </strong>
      ï¼šæ”¯æŒå¤šå›¾ç‰‡åˆ—ã€è‡ªå®šä¹‰æ ·å¼
     </li>
     <li>
      <strong>
       å¥å£®æ€§å¼º
      </strong>
      ï¼šå®Œå–„çš„å¼‚å¸¸å¤„ç†æœºåˆ¶
     </li>
    </ol>
    <p>
     å»ºè®®æ ¹æ®å®é™…ä¸šåŠ¡éœ€æ±‚è°ƒæ•´å›¾ç‰‡å®šä½å‚æ•°å’Œæ ·å¼é…ç½®ï¼Œå¯¹äºå¤æ‚æŠ¥è¡¨å»ºè®®ç»“åˆåç«¯ç”Ÿæˆæ–¹æ¡ˆã€‚
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f:2f626c6f672e6373646e2e6e65742f414c69616e675365762f:61727469636c652f64657461696c732f313436313739343031" class_="artid" style="display:none">
 </p>
</div>


