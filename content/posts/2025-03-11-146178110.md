---
layout: post
title: "RabbitMQ容器部署"
date: 2025-03-11 15:34:27 +0800
description: "rabbitmq笔记"
keywords: "RabbitMQ容器部署"
categories: ['Rabbitmq']
tags: ['Rabbitmq']
artid: "146178110"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146178110
    alt: "RabbitMQ容器部署"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146178110
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146178110
cover: https://bing.ee123.net/img/rand?artid=146178110
image: https://bing.ee123.net/img/rand?artid=146178110
img: https://bing.ee123.net/img/rand?artid=146178110
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     RabbitMQ容器部署
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
    </p>
    <p>
    </p>
    <h2>
     <a id="1RabbitMQ_1">
     </a>
     1.RabbitMQ下载
    </h2>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/319f77c0d4fb403cb67896476e86ccf0.png"/>
    </p>
    <h3>
     <a id="11_Docker_3">
     </a>
     1.1 配置Docker
    </h3>
    <pre><code class="prism language-python"><span class="token punctuation">(</span>base<span class="token punctuation">)</span> <span class="token punctuation">[</span>root@sonarqube19 <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># cat /etc/docker/daemon.json</span>
<span class="token punctuation">{<!-- --></span>
  <span class="token string">"registry-mirrors"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
     <span class="token string">"https://hub.iyuu.cn"</span><span class="token punctuation">,</span>
     <span class="token string">"https://docker.1panel.live"</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>

<span class="token comment"># 配置完毕后，重启Docker服务</span>
systemctl restart docker
</code></pre>
    <h3>
     <a id="11_RabbitMQ_16">
     </a>
     1.1 下载RabbitMQ
    </h3>
    <pre><code class="prism language-python"><span class="token comment"># 下载4.0社区版本</span>
docker pull rabbitmq<span class="token punctuation">:</span><span class="token number">4.0</span><span class="token operator">-</span>management
</code></pre>
    <h2>
     <a id="2RabbitMQ_21">
     </a>
     2.RabbitMQ部署
    </h2>
    <h3>
     <a id="21__22">
     </a>
     2.1 创建目录
    </h3>
    <pre><code class="prism language-shell"><span class="token comment"># 创建目录</span>
<span class="token function">mkdir</span> <span class="token parameter variable">-p</span> /opt/rabbitmq/<span class="token punctuation">{<!-- --></span>conf,data,log<span class="token punctuation">}</span>
<span class="token comment"># 授权文件夹</span>
<span class="token function">chmod</span> <span class="token parameter variable">-R</span> <span class="token number">777</span> /opt/rabbitmq/<span class="token punctuation">{<!-- --></span>conf,data,log<span class="token punctuation">}</span>
</code></pre>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/9cd17303560643b19f9ea855dbf10d37.png"/>
    </p>
    <h3>
     <a id="22_RabbitMQ_30">
     </a>
     2.2 启动RabbitMQ
    </h3>
    <pre><code class="prism language-shell"><span class="token function">docker</span> run <span class="token punctuation">\</span>
	<span class="token parameter variable">-it</span> <span class="token punctuation">\</span>						<span class="token comment"># 交互式操作</span>
	<span class="token parameter variable">-d</span> <span class="token punctuation">\</span>						<span class="token comment"># 在后台运行容器</span>
	<span class="token parameter variable">-p</span> <span class="token number">5672</span>:5672 <span class="token punctuation">\</span>				<span class="token comment"># AMQP协议端口</span>
	<span class="token parameter variable">-p</span> <span class="token number">15672</span>:15672 <span class="token punctuation">\</span>			<span class="token comment"># 管理界面端口</span>
	<span class="token parameter variable">--init</span> <span class="token punctuation">\</span>					<span class="token comment"># 在容器中运行一个初始化进程</span>
	<span class="token parameter variable">--memory</span> 2G	<span class="token punctuation">\</span>				<span class="token comment"># 容器内存</span>
	<span class="token parameter variable">--restart</span><span class="token operator">=</span>always <span class="token punctuation">\</span>			<span class="token comment"># 容器失败重启</span>
	<span class="token parameter variable">--privileged</span><span class="token operator">=</span>true <span class="token punctuation">\</span>			<span class="token comment"># 获取root权限</span>
	<span class="token parameter variable">--name</span> rabbitmq <span class="token punctuation">\</span>			<span class="token comment"># 设置容器名称</span>
	<span class="token parameter variable">--hostname</span> sonarqube19 <span class="token punctuation">\</span>	<span class="token comment"># 设置容器的主机名</span>
	<span class="token parameter variable">-e</span> <span class="token assign-left variable">RABBITMQ_DEFAULT_USER</span><span class="token operator">=</span>rabbitmq <span class="token punctuation">\</span>			<span class="token comment"># 指定默认的 RabbitMQ 用户名</span>
	<span class="token parameter variable">-e</span> <span class="token assign-left variable">RABBITMQ_DEFAULT_PASS</span><span class="token operator">=</span>rabbitmq@123 <span class="token punctuation">\</span>		<span class="token comment"># 指定默认的 RabbitMQ 密码</span>
	<span class="token parameter variable">-v</span> /opt/rabbitmq/data:/var/lib/rabbitmq <span class="token punctuation">\</span>	<span class="token comment"># 数据持久化</span>
	<span class="token parameter variable">-v</span> /opt/rabbitmq/conf:/etc/rabbitmq <span class="token punctuation">\</span>		<span class="token comment"># 配置文件持久化</span>
	<span class="token parameter variable">-v</span> /opt/rabbitmq/log:/var/log/rabbitmq <span class="token punctuation">\</span>	<span class="token comment"># 日志文件持久化</span>
	rabbitmq:4.0-management		<span class="token comment"># 指定容器镜像</span>


<span class="token comment"># 后续可以添加容器健康检查参数</span>
--health-cmd <span class="token string">"curl http://localhost:15672 || exit 1"</span> <span class="token punctuation">\</span>	<span class="token comment"># 设置容器健康检查</span>
--health-interval 5s <span class="token punctuation">\</span>		<span class="token comment"># 两次健康检查的间隔，默认为30秒</span>
--health-timeout 3s <span class="token punctuation">\</span>		<span class="token comment"># 健康检查命令运行超时时间，如果超过这个时间，本次健康检查就被视为失败，默认30秒</span>
--health-retries <span class="token number">12</span>	<span class="token punctuation">\</span>		<span class="token comment"># 当连续失败指定次数后，则将容器状态视为 unhealthy，默认3次</span>
</code></pre>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/9f025c6bc8724c90a3daa0698ff6fa2b.png"/>
    </p>
    <h3>
     <a id="23__59">
     </a>
     2.3 开启控制台管理
    </h3>
    <pre><code class="prism language-shell"><span class="token function">sudo</span> <span class="token function">docker</span> <span class="token builtin class-name">exec</span> <span class="token parameter variable">-it</span> rabbitmq rabbitmq-plugins <span class="token builtin class-name">enable</span> rabbitmq_management

Enabling plugins on <span class="token function">node</span> rabbit@sonarqube19:
rabbitmq_management
The following plugins have been configured:
  rabbitmq_management
  rabbitmq_management_agent
  rabbitmq_web_dispatch
Applying plugin configuration to rabbit@sonarqube19<span class="token punctuation">..</span>.
The following plugins have been enabled:
  rabbitmq_management
  rabbitmq_management_agent
  rabbitmq_web_dispatch

started <span class="token number">3</span> plugins.

</code></pre>
    <h3>
     <a id="24__78">
     </a>
     2.4 查看日志
    </h3>
    <pre><code class="prism language-shell"><span class="token function">docker</span> logs rabbitmq
</code></pre>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/e5df43a5a5ac413cad5c5c66996dd9ed.png"/>
    </p>
    <h3>
     <a id="25__83">
     </a>
     2.5 查看用户
    </h3>
    <pre><code class="prism language-shell"><span class="token comment"># 如果容器启动的时候，没有设置默认RabbitMQ的用户名和密码，需要如下操作</span>
<span class="token function">sudo</span> <span class="token function">docker</span> <span class="token builtin class-name">exec</span> <span class="token parameter variable">-it</span> rabbitmq rabbitmqctl list_users
<span class="token comment"># Listing users ...</span>
<span class="token comment"># user    tags</span>
<span class="token comment"># rabbitmq        [administrator]</span>
</code></pre>
    <h3>
     <a id="26_guest_91">
     </a>
     2.6 删除guest用户
    </h3>
    <pre><code class="prism language-shell"><span class="token comment"># 如果容器启动的时候，没有设置默认RabbitMQ的用户名和密码，需要如下操作</span>
<span class="token function">sudo</span> <span class="token function">docker</span> <span class="token builtin class-name">exec</span> <span class="token parameter variable">-it</span> rabbitmq rabbitmqctl delete_user guest
<span class="token comment"># Deleting user "guest" ...</span>
</code></pre>
    <h3>
     <a id="27__97">
     </a>
     2.7 创建管理员账号
    </h3>
    <pre><code class="prism language-shell"><span class="token comment"># 如果容器启动的时候，没有设置默认RabbitMQ的用户名和密码，需要如下操作</span>
<span class="token function">sudo</span> <span class="token function">docker</span> <span class="token builtin class-name">exec</span> <span class="token parameter variable">-it</span> rabbitmq rabbitmqctl add_user rabbitmq rabbitmq@123
</code></pre>
    <h3>
     <a id="28__102">
     </a>
     2.8 授权管理员权限
    </h3>
    <pre><code class="prism language-shell"><span class="token comment"># 如果容器启动的时候，没有设置默认RabbitMQ的用户名和密码，需要如下操作</span>
<span class="token function">sudo</span> <span class="token function">docker</span> <span class="token builtin class-name">exec</span> <span class="token parameter variable">-it</span> rabbitmq rabbitmqctl set_user_tags rabbitmq administrator
<span class="token comment"># Setting tags for user "rabbitmq" to [administrator] ...</span>
</code></pre>
    <h2>
     <a id="3_108">
     </a>
     3.访问
    </h2>
    <pre><code class="prism language-shell">http://192.168.120.19:15672
<span class="token comment"># 用户名：rabbitmq</span>
<span class="token comment"># 密码：rabbitmq@123</span>
</code></pre>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/26cbd888e45047b48e12d487638ee034.png">
      <br/>
      <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/1d4709293ac1408aaa8fb9a94dee13d1.png"/>
     </img>
    </p>
    <h2>
     <a id="_116">
     </a>
     参考：
    </h2>
    <p>
     <a href="https://www.rabbitmq.com/docs/download" rel="nofollow">
      https://www.rabbitmq.com/docs/download
     </a>
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f672e637364:6e2e6e65742f48617070795f53756e7368696e655f426f792f:61727469636c652f64657461696c732f313436313738313130" class_="artid" style="display:none">
 </p>
</div>


