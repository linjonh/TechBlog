---
layout: post
title: "Jolt-通过JSON配置来处理复杂数据转换的工具"
date: 2025-03-13 14:27:26 +0800
description: "一个能够通过JSON配置（特定的语法）来处理复杂数据转换的工具。比如将API响应转换为内部系统所需的格式，或者处理来自不同来源的数据结构差异。例如，将嵌套的JSON结构扁平化，或者重命名字段，合并多个字段等。"
keywords: "⚡️Jolt -- 通过JSON配置来处理复杂数据转换的工具"
categories: ['工具', 'Java']
tags: ['数据处理', 'Json']
artid: "146228588"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146228588
    alt: "Jolt-通过JSON配置来处理复杂数据转换的工具"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146228588
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146228588
cover: https://bing.ee123.net/img/rand?artid=146228588
image: https://bing.ee123.net/img/rand?artid=146228588
img: https://bing.ee123.net/img/rand?artid=146228588
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     ⚡️Jolt -- 通过JSON配置来处理复杂数据转换的工具
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-tomorrow-night" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
     <strong>
      简介
     </strong>
     ：一个能够通过JSON配置（特定的语法）来处理复杂数据转换的工具。
     <br/>
     比如将API响应转换为内部系统所需的格式，或者处理来自不同来源的数据结构差异。例如，将嵌套的JSON结构扁平化，或者重命名字段，合并多个字段等。
     <br/>
     <strong>
      名称含义
     </strong>
     ：
    </p>
    <ul>
     <li>
      <p>
       JSON + Bolt：
       <br/>
       JSON 是工具处理的数据格式。
       <br/>
       ​Bolt​（闪电）象征快速和高效，暗示 Jolt 能够像闪电一样快速完成 JSON 数据的转换。
       <br/>
       Bolt​的logo就是一个闪电⚡️标志
      </p>
     </li>
     <li>
      <p>
       在社区中，Jolt 的名称被解读为 ​JSON Transformation Language 的缩写，强调其作为 JSON 转换语言的定位。
      </p>
     </li>
     <li>
      <p>
       项目地址：
       <a href="https://github.com/bazaarvoice/jolt">
        https://github.com/bazaarvoice/jolt
       </a>
      </p>
     </li>
     <li>
      <p>
       在线验证工具：
       <a href="https://jolt-demo.appspot.com/#inception" rel="nofollow">
        https://jolt-demo.appspot.com/#inception
       </a>
      </p>
     </li>
    </ul>
    <h3>
     <a id="_11">
     </a>
     使用
    </h3>
    <h4>
     <a id="1_maven_12">
     </a>
     1. 引入maven依赖
    </h4>
    <ul>
     <li>
      pom.xml
     </li>
    </ul>
    <pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.bazaarvoice.jolt<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>jolt-core<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>0.1.7<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.bazaarvoice.jolt<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>json-utils<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>0.1.7<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre>
    <h4>
     <a id="2_Joltjson_26">
     </a>
     2. 编写Jolt转换规范（json格式）
    </h4>
    <ul>
     <li>
      spec.json
     </li>
    </ul>
    <pre><code class="prism language-json"><span class="token punctuation">[</span>
  <span class="token punctuation">{<!-- --></span>
    <span class="token string-property property">"operation"</span><span class="token operator">:</span> <span class="token string">"shift"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"spec"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
      <span class="token string-property property">"id"</span><span class="token operator">:</span> <span class="token string">"id"</span><span class="token punctuation">,</span>
      <span class="token string-property property">"orderType"</span><span class="token operator">:</span> <span class="token string">"type"</span><span class="token punctuation">,</span>
      <span class="token string-property property">"orderProductList"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
        <span class="token string-property property">"*"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
          <span class="token string-property property">"sampleNumber"</span><span class="token operator">:</span> <span class="token string">"orderProductList[&amp;1].number"</span><span class="token punctuation">,</span>
          <span class="token string-property property">"id"</span><span class="token operator">:</span> <span class="token string">"orderProductList[&amp;1].id"</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token string-property property">"createTime"</span><span class="token operator">:</span> <span class="token string">"createTime"</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{<!-- --></span>
    <span class="token string-property property">"operation"</span><span class="token operator">:</span> <span class="token string">"modify-overwrite-beta"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"spec"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
      <span class="token string-property property">"id"</span><span class="token operator">:</span> <span class="token string">"=toString(@(1,id))"</span><span class="token punctuation">,</span>
      <span class="token string-property property">"createTime"</span><span class="token operator">:</span> <span class="token string">"=concat(@(1,createTime), ' 00:00:00')"</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">]</span>
</code></pre>
    <h4>
     <a id="3_Java_53">
     </a>
     3. Java集成示例
    </h4>
    <ul>
     <li>
      DataTransformTool
     </li>
    </ul>
    <pre><code class="prism language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>bazaarvoice<span class="token punctuation">.</span>jolt<span class="token punctuation">.</span></span><span class="token class-name">Chainr</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>bazaarvoice<span class="token punctuation">.</span>jolt<span class="token punctuation">.</span></span><span class="token class-name">JsonUtils</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span></span><span class="token punctuation">;</span>

<span class="token comment">/**
 * description: DataTransformTool &lt;br&gt;
 * date: 2025/3/13 11:47 &lt;br&gt;
 * author: Boo &lt;br&gt;
 * version: 1.0 &lt;br&gt;
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DataTransformTool</span> <span class="token punctuation">{<!-- --></span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token function">transform</span><span class="token punctuation">(</span><span class="token class-name">String</span> inputJson<span class="token punctuation">,</span> <span class="token class-name">String</span> specPath<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">List</span> chainrSpecJSON <span class="token operator">=</span> <span class="token class-name">JsonUtils</span><span class="token punctuation">.</span><span class="token function">classpathToList</span><span class="token punctuation">(</span> specPath <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Chainr</span> chainr <span class="token operator">=</span> <span class="token class-name">Chainr</span><span class="token punctuation">.</span><span class="token function">fromSpec</span><span class="token punctuation">(</span> chainrSpecJSON <span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">Object</span> transformedOutput <span class="token operator">=</span> chainr<span class="token punctuation">.</span><span class="token function">transform</span><span class="token punctuation">(</span> <span class="token class-name">JsonUtils</span><span class="token punctuation">.</span><span class="token function">jsonToObject</span><span class="token punctuation">(</span>inputJson<span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> <span class="token class-name">JsonUtils</span><span class="token punctuation">.</span><span class="token function">toJsonString</span><span class="token punctuation">(</span> transformedOutput <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


<span class="token punctuation">}</span>
</code></pre>
    <ul>
     <li>
      Test.java
     </li>
    </ul>
    <pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">String</span> inputJson <span class="token operator">=</span> <span class="token string">"{"</span> <span class="token operator">+</span>
                <span class="token string">"             \"id\": 123456789,"</span> <span class="token operator">+</span>
                <span class="token string">"             \"orderType\": \"orderTypecsss\","</span> <span class="token operator">+</span>
                <span class="token string">"             \"orderProductList\": ["</span> <span class="token operator">+</span>
                <span class="token string">"                   {\"sampleNumber\": \"number001\", \"id\": 2},"</span> <span class="token operator">+</span>
                <span class="token string">"                   {\"sampleNumber\": \"SKU456\", \"id\": 1}"</span> <span class="token operator">+</span>
                <span class="token string">"               ],"</span> <span class="token operator">+</span>
                <span class="token string">"             \"createTime\": \"2025-03-13\""</span> <span class="token operator">+</span>
                <span class="token string">"           }"</span><span class="token punctuation">;</span>


        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">DataTransformTool</span><span class="token punctuation">.</span><span class="token function">transform</span><span class="token punctuation">(</span>inputJson<span class="token punctuation">,</span> <span class="token string">"spec.json"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre>
    <ul>
     <li>
      运行结果
     </li>
    </ul>
    <pre><code>{
    "id": "123456789",
    "type": "orderTypecsss",
    "orderProductList": [
        {
            "number": "number001",
            "id": 2
        },
        {
            "number": "SKU456",
            "id": 1
        }
    ],
    "createTime": "2025-03-13 00:00:00"
}
</code></pre>
    <h3>
     <a id="Jolt__117">
     </a>
     Jolt 转换规范的核心语法
    </h3>
    <p>
     AI整理，仔细辨别
    </p>
    <h4>
     <a id="_119">
     </a>
     核心操作类型
    </h4>
    <table>
     <thead>
      <tr>
       <th>
        操作类型
       </th>
       <th>
        用途
       </th>
       <th>
        示例
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        shift
       </td>
       <td>
        字段映射/结构调整
       </td>
       <td>
        “oldField”: “newField”
       </td>
      </tr>
      <tr>
       <td>
        modify-overwrite-beta
       </td>
       <td>
        数据修改（类型转换/计算）
       </td>
       <td>
        “field”: “=toUpper”
       </td>
      </tr>
      <tr>
       <td>
        default
       </td>
       <td>
        设置默认值
       </td>
       <td>
        “field”: “defaultVal”
       </td>
      </tr>
      <tr>
       <td>
        remove
       </td>
       <td>
        删除字段
       </td>
       <td>
        “fieldToRemove”: “”
       </td>
      </tr>
      <tr>
       <td>
        sort
       </td>
       <td>
        字段排序
       </td>
       <td>
        无参数，直接使用
       </td>
      </tr>
     </tbody>
    </table>
    <h4>
     <a id="_128">
     </a>
     核心操作符及示例
    </h4>
    <h5>
     <a id="1_shift_129">
     </a>
     1. ​
     <strong>
      shift
     </strong>
    </h5>
    <p>
     用途：字段重映射、结构调整。
     <br/>
     语法：将输入路径映射到输出路径。
     <br/>
     示例：
    </p>
    <pre><code class="prism language-json"><span class="token punctuation">{<!-- --></span>
  <span class="token string-property property">"operation"</span><span class="token operator">:</span> <span class="token string">"shift"</span><span class="token punctuation">,</span>
  <span class="token string-property property">"spec"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string-property property">"inputField"</span><span class="token operator">:</span> <span class="token string">"output.parent.child"</span><span class="token punctuation">,</span>  <span class="token comment">// 简单映射</span>
    <span class="token string-property property">"nested.input.value"</span><span class="token operator">:</span> <span class="token string">"output.value"</span><span class="token punctuation">,</span> <span class="token comment">// 嵌套映射</span>
    <span class="token string-property property">"array[*].id"</span><span class="token operator">:</span> <span class="token string">"output.ids[]"</span>         <span class="token comment">// 数组展开</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <h5>
     <a id="2_default_144">
     </a>
     2. ​
     <strong>
      default
     </strong>
    </h5>
    <p>
     用途：设置默认值（字段不存在时生效）。
     <br/>
     语法：
    </p>
    <pre><code class="prism language-json"><span class="token punctuation">{<!-- --></span>
  <span class="token string-property property">"operation"</span><span class="token operator">:</span> <span class="token string">"default"</span><span class="token punctuation">,</span>
  <span class="token string-property property">"spec"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string-property property">"output.role"</span><span class="token operator">:</span> <span class="token string">"guest"</span><span class="token punctuation">,</span>      <span class="token comment">// 单值默认</span>
    <span class="token string-property property">"output.tags"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"default"</span><span class="token punctuation">]</span>  <span class="token comment">// 数组默认</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <h5>
     <a id="3_remove_157">
     </a>
     3. ​
     <strong>
      remove
     </strong>
    </h5>
    <p>
     用途：删除指定字段。
     <br/>
     语法：
    </p>
    <pre><code class="prism language-json"><span class="token punctuation">{<!-- --></span>
  <span class="token string-property property">"operation"</span><span class="token operator">:</span> <span class="token string">"remove"</span><span class="token punctuation">,</span>
  <span class="token string-property property">"spec"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string-property property">"unusedField"</span><span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">,</span>          <span class="token comment">// 删除字段</span>
    <span class="token string-property property">"nested.tempData"</span><span class="token operator">:</span> <span class="token string">""</span>       <span class="token comment">// 删除嵌套字段</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <h5>
     <a id="4_sort_170">
     </a>
     4. ​
     <strong>
      sort
     </strong>
    </h5>
    <p>
     用途：按字母序排序对象键。
     <br/>
     语法：
    </p>
    <pre><code class="prism language-json"><span class="token punctuation">{<!-- --></span> <span class="token string-property property">"operation"</span><span class="token operator">:</span> <span class="token string">"sort"</span> <span class="token punctuation">}</span>
</code></pre>
    <h5>
     <a id="5_cardinality_177">
     </a>
     5. ​
     <strong>
      cardinality
     </strong>
    </h5>
    <p>
     用途：强制字段为单值或数组。
     <br/>
     语法：
    </p>
    <pre><code class="prism language-json"><span class="token punctuation">{<!-- --></span>
  <span class="token string-property property">"operation"</span><span class="token operator">:</span> <span class="token string">"cardinality"</span><span class="token punctuation">,</span>
  <span class="token string-property property">"spec"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string-property property">"output.roles"</span><span class="token operator">:</span> <span class="token string">"array"</span><span class="token punctuation">,</span>  <span class="token comment">// 强制为数组</span>
    <span class="token string-property property">"output.name"</span><span class="token operator">:</span> <span class="token string">"single"</span>    <span class="token comment">// 强制为单值</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <h5>
     <a id="6_modifyoverwritebeta_190">
     </a>
     6. ​
     <strong>
      modify-overwrite-beta
     </strong>
    </h5>
    <p>
     用途：覆盖或修改字段值（需 Jolt 扩展库）。
     <br/>
     语法：
    </p>
    <pre><code class="prism language-json"><span class="token punctuation">{<!-- --></span>
  <span class="token string-property property">"operation"</span><span class="token operator">:</span> <span class="token string">"modify-overwrite-beta"</span><span class="token punctuation">,</span>
  <span class="token string-property property">"spec"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string-property property">"output.score"</span><span class="token operator">:</span> <span class="token string">"=toDouble(@(1,input.score))"</span>  <span class="token comment">// 转换为浮点数</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <h5>
     <a id="7_modifydefaultbeta_202">
     </a>
     7. ​
     <strong>
      modify-default-beta
     </strong>
    </h5>
    <p>
     用途：条件默认值（类似 default 但支持表达式）。
     <br/>
     语法：
    </p>
    <pre><code class="prism language-json"><span class="token punctuation">{<!-- --></span>
  <span class="token string-property property">"operation"</span><span class="token operator">:</span> <span class="token string">"modify-default-beta"</span><span class="token punctuation">,</span>
  <span class="token string-property property">"spec"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string-property property">"output.status"</span><span class="token operator">:</span> <span class="token string">"=if (isPresent(@(1,input.status))) then @(1,input.status) else 'pending'"</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <h4>
     <a id="_215">
     </a>
     路径语法规则
    </h4>
    <p>
     ​点号.：表示嵌套字段，如 user.address.city。
     <br/>
     ​通配符*：匹配任意字段或数组元素：
     <br/>
     users[
     <em>
      ].name：提取所有 users 元素的 name。
      <br/>
      data.
     </em>
     .value：匹配 data 下的所有子字段的 value。
     <br/>
     ​数组索引[n]：定位数组的特定位置，如 items[0].id。
     <br/>
     ​转义\：若字段名包含 . 或 *，需转义，如 field\.with\.dots。
    </p>
    <h4>
     <a id="_223">
     </a>
     链式操作示例
    </h4>
    <p>
     json
    </p>
    <pre><code class="prism language-json"><span class="token punctuation">[</span>
  <span class="token comment">// 第一步：字段映射</span>
  <span class="token punctuation">{<!-- --></span>
    <span class="token string-property property">"operation"</span><span class="token operator">:</span> <span class="token string">"shift"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"spec"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
      <span class="token string-property property">"firstName"</span><span class="token operator">:</span> <span class="token string">"user.name"</span><span class="token punctuation">,</span>
      <span class="token string-property property">"age"</span><span class="token operator">:</span> <span class="token string">"user.details.age"</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// 第二步：添加默认值</span>
  <span class="token punctuation">{<!-- --></span>
    <span class="token string-property property">"operation"</span><span class="token operator">:</span> <span class="token string">"default"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"spec"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
      <span class="token string-property property">"user.role"</span><span class="token operator">:</span> <span class="token string">"guest"</span><span class="token punctuation">,</span>
      <span class="token string-property property">"user.details.active"</span><span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// 第三步：删除冗余字段</span>
  <span class="token punctuation">{<!-- --></span>
    <span class="token string-property property">"operation"</span><span class="token operator">:</span> <span class="token string">"remove"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"spec"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
      <span class="token string-property property">"user.details.age"</span><span class="token operator">:</span> <span class="token string">""</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">]</span>
</code></pre>
    <p>
     输入：
    </p>
    <pre><code>{ "firstName": "John", "age": 30 }
</code></pre>
    <p>
     输出：
    </p>
    <pre><code>{
  "user": {
    "name": "John",
    "role": "guest",
    "details": {
      "active": true
    }
  }
}
</code></pre>
    <h4>
     <a id="_270">
     </a>
     高级技巧
    </h4>
    <ol>
     <li>
      动态键名：使用 &amp; 引用输入字段的值作为键：
     </li>
    </ol>
    <pre><code class="prism language-json"><span class="token punctuation">{<!-- --></span>
  <span class="token string-property property">"operation"</span><span class="token operator">:</span> <span class="token string">"shift"</span><span class="token punctuation">,</span>
  <span class="token string-property property">"spec"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string-property property">"userType"</span><span class="token operator">:</span> <span class="token string">"output.&amp;"</span>  <span class="token comment">// 将 userType 的值作为键</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     输入 { “userType”: “admin” } → 输出 { “output”: { “admin”: “admin” } }。
    </p>
    <ol start="2">
     <li>
      ​条件逻辑：通过 modify 系列操作符实现复杂条件：
     </li>
    </ol>
    <pre><code class="prism language-json"><span class="token punctuation">{<!-- --></span>
  <span class="token string-property property">"operation"</span><span class="token operator">:</span> <span class="token string">"modify-overwrite-beta"</span><span class="token punctuation">,</span>
  <span class="token string-property property">"spec"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string-property property">"output.discount"</span><span class="token operator">:</span> <span class="token string">"=if (@(1,price) &gt; 100) then 0.1 else 0"</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <ol start="3">
     <li>
      ​数组聚合：将多个字段合并为数组：
     </li>
    </ol>
    <pre><code class="prism language-json"><span class="token punctuation">{<!-- --></span>
  <span class="token string-property property">"operation"</span><span class="token operator">:</span> <span class="token string">"shift"</span><span class="token punctuation">,</span>
  <span class="token string-property property">"spec"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string-property property">"tags"</span><span class="token operator">:</span> <span class="token string">"output.tags[]"</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <h4>
     <a id="_304">
     </a>
     注意事项
    </h4>
    <ul>
     <li>
      大小写敏感：字段名和路径严格区分大小写。
     </li>
     <li>
      ​路径不存在：若输入路径不存在，操作符会静默忽略。
     </li>
     <li>
      性能优化：复杂嵌套或通配符可能影响性能，尽量简化规则。
     </li>
    </ul>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a:2f2f626c6f672e6373646e2e6e65742f48454c4c4f4d52502f:61727469636c652f64657461696c732f313436323238353838" class_="artid" style="display:none">
 </p>
</div>


