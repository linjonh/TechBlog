---
arturl_encode: "68747470733a2f2f626c6f672e:6373646e2e6e65742f77656978696e5f34323338303731312f:61727469636c652f64657461696c732f313436313038323138"
layout: post
title: "MuMu-LLaMAé€šè¿‡å¤§å‹è¯­è¨€æ¨¡å‹è¿›è¡Œå¤šæ¨¡æ€éŸ³ä¹ç†è§£å’Œç”ŸæˆPythonä»£ç å®ç°è®ºæ–‡"
date: 2025-03-08 00:24:41 +08:00
description: "æ–‡æœ¬åˆ°éŸ³ä¹ç”Ÿæˆï¼ˆT2M-Genï¼‰é¢ä¸´çš„ä¸»è¦éšœç¢æ˜¯ç¼ºä¹å¸¦æœ‰è‡ªç„¶è¯­è¨€æè¿°çš„å¤§è§„æ¨¡å…¬å¼€éŸ³ä¹æ•°æ®é›†ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬æå‡ºéŸ³ä¹ç†è§£å¤§è¯­è¨€æ¨¡å‹ï¼ˆMU-LLaMAï¼‰â€‹ï¼Œè¯¥æ¨¡å‹èƒ½å¤Ÿå›ç­”éŸ³ä¹ç›¸å…³é—®é¢˜å¹¶ä¸ºéŸ³ä¹æ–‡ä»¶ç”Ÿæˆå­—å¹•ã€‚æˆ‘ä»¬çš„æ¨¡å‹ä½¿ç”¨é¢„è®­ç»ƒçš„MERTæ¨¡å‹æå–éŸ³é¢‘è¡¨å¾ä½œä¸ºéŸ³ä¹ç‰¹å¾ã€‚ç„¶è€Œï¼Œè·å–é€‚åˆè®­ç»ƒMU-LLaMAæ¨¡å‹çš„æ•°æ®é›†ä»å…·æŒ‘æˆ˜ï¼Œå› ä¸ºç°æœ‰å…¬å¼€éŸ³é¢‘é—®ç­”æ•°æ®é›†ç¼ºä¹å¼€æ”¾å¼éŸ³ä¹é—®ç­”æ‰€éœ€çš„æ·±åº¦ã€‚ä¸ºå¡«è¡¥è¿™ä¸€ç©ºç™½ï¼Œæˆ‘ä»¬æå‡ºä»ç°æœ‰éŸ³é¢‘å­—å¹•æ•°æ®é›†ç”Ÿæˆé—®ç­”å¯¹çš„æ–¹æ³•ï¼Œå¹¶æ¨å‡ºä¸“ä¸ºå›ç­”å¼€æ”¾å¼éŸ³ä¹é—®é¢˜è®¾è®¡çš„MusicQAæ•°æ®é›†ã€‚"
keywords: "MuMu-LLaMAï¼šé€šè¿‡å¤§å‹è¯­è¨€æ¨¡å‹è¿›è¡Œå¤šæ¨¡æ€éŸ³ä¹ç†è§£å’Œç”Ÿæˆï¼ˆPythonä»£ç å®ç°+è®ºæ–‡ï¼‰"
categories: ['æœªåˆ†ç±»']
tags: ['è¯­è¨€æ¨¡å‹', 'äººå·¥æ™ºèƒ½', 'Llama']
artid: "146108218"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146108218
    alt: "MuMu-LLaMAé€šè¿‡å¤§å‹è¯­è¨€æ¨¡å‹è¿›è¡Œå¤šæ¨¡æ€éŸ³ä¹ç†è§£å’Œç”ŸæˆPythonä»£ç å®ç°è®ºæ–‡"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146108218
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146108218
cover: https://bing.ee123.net/img/rand?artid=146108218
image: https://bing.ee123.net/img/rand?artid=146108218
img: https://bing.ee123.net/img/rand?artid=146108218
---

# MuMu-LLaMAï¼šé€šè¿‡å¤§å‹è¯­è¨€æ¨¡å‹è¿›è¡Œå¤šæ¨¡æ€éŸ³ä¹ç†è§£å’Œç”Ÿæˆï¼ˆPythonä»£ç å®ç°+è®ºæ–‡ï¼‰

> MuMu-LLaMA æ¨¡å‹æ˜¯ä¸€ç§éŸ³ä¹ç†è§£å’Œç”Ÿæˆæ¨¡å‹ï¼Œèƒ½å¤Ÿè¿›è¡ŒéŸ³ä¹é—®ç­”ä»¥åŠä»æ–‡æœ¬ã€å›¾åƒã€è§†é¢‘å’ŒéŸ³é¢‘ç”ŸæˆéŸ³ä¹ï¼Œä»¥åŠéŸ³ä¹ç¼–è¾‘ã€‚è¯¥æ¨¡å‹åˆ©ç”¨äº†ç”¨äºéŸ³ä¹ç†è§£çš„ MERTã€ç”¨äºå›¾åƒç†è§£çš„ ViT å’Œç”¨äºè§†é¢‘ç†è§£çš„ ViViT ç­‰ç¼–ç å™¨ï¼Œä»¥åŠä½œä¸ºéŸ³ä¹ç”Ÿæˆæ¨¡å‹ï¼ˆéŸ³ä¹è§£ç å™¨ï¼‰çš„ MusicGen/AudioLDM2 æ¨¡å‹ï¼Œå†åŠ ä¸Šé€‚é…å™¨å’Œ LLaMA 2 æ¨¡å‹ï¼Œä½¿æ¨¡å‹å…·æœ‰å¤šç§èƒ½åŠ›ã€‚æ¨¡å‹æ¶æ„ä»¥
> [mumu\_llama.py](https://github.com/shansongliu/MuMu-LLaMA/blob/main/llama/mumu_llama.py "mumu_llama.py")
> ç»™å‡ºã€‚

ç”±äºç¼ºä¹å¸¦æœ‰è‡ªç„¶è¯­è¨€å­—å¹•çš„å¤§è§„æ¨¡å…¬å¼€å¯ç”¨çš„éŸ³ä¹æ•°æ®é›†ï¼Œæ–‡æœ¬åˆ°éŸ³ä¹ç”Ÿæˆ ï¼ˆT2M-Genï¼‰ é¢ä¸´é‡å¤§éšœç¢ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬æå‡ºäº†éŸ³ä¹ç†è§£ LLaMA ï¼ˆMU-LLaMAï¼‰ï¼Œå®ƒèƒ½å¤Ÿå›ç­”ä¸éŸ³ä¹ç›¸å…³çš„é—®é¢˜å¹¶ä¸ºéŸ³ä¹æ–‡ä»¶ç”Ÿæˆå­—å¹•ã€‚æˆ‘ä»¬çš„æ¨¡å‹åˆ©ç”¨æ¥è‡ªé¢„è®­ç»ƒ MERT æ¨¡å‹çš„éŸ³é¢‘è¡¨ç¤ºæ¥æå–éŸ³ä¹ç‰¹å¾ã€‚ç„¶è€Œï¼Œè·å¾—ä¸€ä¸ªåˆé€‚çš„æ•°æ®é›†æ¥è®­ç»ƒ MU-LLaMA æ¨¡å‹ä»ç„¶å…·æœ‰æŒ‘æˆ˜æ€§ï¼Œå› ä¸ºç°æœ‰çš„å¯å…¬å¼€è®¿é—®çš„éŸ³é¢‘é—®ç­”æ•°æ®é›†ç¼ºä¹å¼€æ”¾å¼éŸ³ä¹é—®ç­”çš„å¿…è¦æ·±åº¦ã€‚ä¸ºäº†å¡«è¡¥è¿™ä¸€ç©ºç™½ï¼Œæˆ‘ä»¬æå‡ºäº†ä¸€ç§ä»ç°æœ‰éŸ³é¢‘å­—å¹•æ•°æ®é›†ç”Ÿæˆé—®ç­”å¯¹çš„æ–¹æ³•ï¼Œå¹¶ä»‹ç»äº†ä¸“ä¸ºå›ç­”å¼€æ”¾å¼éŸ³ä¹ç›¸å…³é—®é¢˜è€Œè®¾è®¡çš„ MusicQA æ•°æ®é›†ã€‚å®éªŒè¡¨æ˜ï¼Œåœ¨æˆ‘ä»¬è®¾è®¡çš„ MusicQA æ•°æ®é›†ä¸Šè®­ç»ƒçš„æ‰€æå‡ºçš„ MU-LLaMA æ¨¡å‹åœ¨å„ç§æŒ‡æ ‡ä¸Šéƒ½å–å¾—äº†å‡ºè‰²çš„éŸ³ä¹é—®ç­”å’ŒéŸ³ä¹å­—å¹•ç”Ÿæˆæ–¹é¢çš„å‡ºè‰²è¡¨ç°ï¼Œåœ¨è¿™ä¸¤ä¸ªé¢†åŸŸçš„è¡¨ç°éƒ½ä¼˜äºå½“å‰æœ€å…ˆè¿›çš„ ï¼ˆSOTAï¼‰ æ¨¡å‹ï¼Œå¹¶åœ¨ T2M-Gen ç ”ç©¶é¢†åŸŸæä¾›äº†æœ‰å¸Œæœ›çš„è¿›æ­¥ã€‚

### ğŸ¤– æ¨¡å‹è®¾ç½®

æˆ‘ä»¬åœ¨è¿™ä¸ªé¡¹ç›®ä¸­ä½¿ç”¨ Python 3.9.17ï¼Œåº“è¦æ±‚åœ¨ requirements.txt ä¸­ç»™å‡ºã€‚ä½¿ç”¨ åˆ›å»º conda ç¯å¢ƒ

```
conda create --name <env> --file requirements.txt

```

ç¡®ä¿ NVIDIA é©±åŠ¨ç¨‹åºä¸º 12 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼Œä»¥ä¾¿ä¸ PyTorch 2.1.0 å…¼å®¹ã€‚

ä¸ºäº†ä½¿æˆ‘ä»¬çš„æ¨¡å‹å·¥ä½œï¼Œéœ€è¦ Facebook çš„ LLaMA-2 æ¨¡å‹æƒé‡ï¼Œæœ‰å…³è·å–è¿™äº›æƒé‡çš„è¯¦ç»†ä¿¡æ¯ï¼Œè¯·è®¿é—®
[HuggingFace](https://huggingface.co/docs/transformers/main/model_doc/llama "HuggingFace")
ã€‚

æˆ‘ä»¬æ¨¡å‹çš„è®­ç»ƒæ£€æŸ¥ç‚¹å¯åœ¨æ­¤å¤„è·å¾—ï¼š

* [MuMu-LlaMA ä¸ MusicGen Small](https://huggingface.co/M2UGen/M2UGen-MusicGen-small "MuMu-LlaMA ä¸ MusicGen Small")
* [å« MusicGen åŸ¹å…»åŸºçš„ MuMu-LlaMA](https://huggingface.co/M2UGen/M2UGen-MusicGen-medium "å« MusicGen åŸ¹å…»åŸºçš„ MuMu-LlaMA")
* [MuMu-LlaMA ä¸ AudioLDM2](https://huggingface.co/M2UGen/M2UGen-AudioLDM2 "MuMu-LlaMA ä¸ AudioLDM2")

å¯ä»¥åœ¨æ­¤å¤„æ‰¾åˆ°æ‰€éœ€çš„é¢„è®­ç»ƒå¤šæ¨¡æ€ç¼–ç å™¨å’ŒéŸ³ä¹è§£ç å™¨æ¨¡å‹ï¼š

* [MERT](https://huggingface.co/m-a-p/MERT-v1-330M "MERT")
* [ViT](https://huggingface.co/google/vit-base-patch16-224-in21k "ViT")
* [ViViT](https://huggingface.co/google/vivit-b-16x2-kinetics400 "ViViT")
* [MusicGen](https://huggingface.co/facebook/musicgen-medium "MusicGen")
* [AudioLDM 2](https://huggingface.co/cvssp/audioldm2-music "AudioLDM 2")

### ğŸ§° ç³»ç»Ÿç¡¬ä»¶è¦æ±‚

å¯¹äºè®­ç»ƒï¼Œç¬¬ 1 é˜¶æ®µå’Œç¬¬ 2 é˜¶æ®µä½¿ç”¨å•ä¸ª 32GB V100 GPUï¼Œè€Œç¬¬ 3 é˜¶æ®µä½¿ç”¨ 2 ä¸ª 32GB V100 GPUã€‚å¯¹äºæ¨ç†ï¼Œä½¿ç”¨å•ä¸ª 32GB V100 GPUã€‚è¦åŠ è½½æ¨¡å‹æ£€æŸ¥ç‚¹ï¼Œå¤§çº¦éœ€è¦ 49GB çš„ CPU å†…å­˜ã€‚

#### æ‘˜è¦

æ–‡æœ¬åˆ°éŸ³ä¹ç”Ÿæˆï¼ˆT2M-Genï¼‰é¢ä¸´çš„ä¸»è¦éšœç¢æ˜¯ç¼ºä¹å¸¦æœ‰è‡ªç„¶è¯­è¨€æè¿°çš„å¤§è§„æ¨¡å…¬å¼€éŸ³ä¹æ•°æ®é›†ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬æå‡º
**éŸ³ä¹ç†è§£å¤§è¯­è¨€æ¨¡å‹ï¼ˆMU-LLaMAï¼‰â€‹**
ï¼Œè¯¥æ¨¡å‹èƒ½å¤Ÿå›ç­”éŸ³ä¹ç›¸å…³é—®é¢˜å¹¶ä¸ºéŸ³ä¹æ–‡ä»¶ç”Ÿæˆå­—å¹•ã€‚æˆ‘ä»¬çš„æ¨¡å‹ä½¿ç”¨é¢„è®­ç»ƒçš„MERTæ¨¡å‹æå–éŸ³é¢‘è¡¨å¾ä½œä¸ºéŸ³ä¹ç‰¹å¾ã€‚ç„¶è€Œï¼Œè·å–é€‚åˆè®­ç»ƒMU-LLaMAæ¨¡å‹çš„æ•°æ®é›†ä»å…·æŒ‘æˆ˜ï¼Œå› ä¸ºç°æœ‰å…¬å¼€éŸ³é¢‘é—®ç­”æ•°æ®é›†ç¼ºä¹å¼€æ”¾å¼éŸ³ä¹é—®ç­”æ‰€éœ€çš„æ·±åº¦ã€‚ä¸ºå¡«è¡¥è¿™ä¸€ç©ºç™½ï¼Œæˆ‘ä»¬æå‡ºä»ç°æœ‰éŸ³é¢‘å­—å¹•æ•°æ®é›†ç”Ÿæˆé—®ç­”å¯¹çš„æ–¹æ³•ï¼Œå¹¶æ¨å‡ºä¸“ä¸ºå›ç­”å¼€æ”¾å¼éŸ³ä¹é—®é¢˜è®¾è®¡çš„
**MusicQAæ•°æ®é›†**
ã€‚å®éªŒè¡¨æ˜ï¼ŒåŸºäºMusicQAæ•°æ®é›†è®­ç»ƒçš„MU-LLaMAæ¨¡å‹åœ¨éŸ³ä¹é—®ç­”å’Œå­—å¹•ç”Ÿæˆä»»åŠ¡ä¸­å‡å–å¾—å“è¶Šæ€§èƒ½ï¼Œåœ¨å¤šé¡¹æŒ‡æ ‡ä¸Šè¶…è¶Šå½“å‰æœ€ä¼˜æ¨¡å‹ï¼ˆSOTAï¼‰ï¼Œä¸ºT2M-Genç ”ç©¶æä¾›äº†é‡è¦çªç ´ã€‚

**å…³é”®è¯**
ï¼šMU-LLaMAã€MusicQAæ•°æ®é›†ã€éŸ³ä¹é—®ç­”ã€æ–‡æœ¬åˆ°éŸ³ä¹ç”Ÿæˆ

---

#### 1. å¼•è¨€

éŸ³ä¹ç”Ÿæˆä»»åŠ¡éœ€è¦å¤§é‡å¸¦å­—å¹•çš„éŸ³ä¹æ•°æ®æ”¯æŒã€‚ç„¶è€Œï¼Œç”±äºç‰ˆæƒé™åˆ¶ï¼Œå¤§å¤šæ•°å«å­—å¹•çš„éŸ³ä¹æ•°æ®é›†æœªå…¬å¼€[1-3]ã€‚ç›®å‰æœ€å¤§çš„å…¬å¼€æ•°æ®é›†MusicCaps[4]ä»…åŒ…å«çº¦28.52å°æ—¶çš„éŸ³ä¹åŠå­—å¹•ï¼Œè¿œå°äºéŸ³é¢‘åˆ†ç±»æˆ–æ ‡ç­¾ä»»åŠ¡çš„æ•°æ®è§„æ¨¡ã€‚å› æ­¤ï¼Œè¿«åˆ‡éœ€è¦å¼€å‘å¤§è§„æ¨¡ç”Ÿæˆå…¬å¼€æ–‡æœ¬-éŸ³ä¹é…å¯¹æ•°æ®çš„æ–¹æ³•ã€‚

Song DescriberÂ¹ç­‰å°‘æ•°å°è¯•é€šè¿‡ä¼—åŒ…æ”¶é›†æ–‡æœ¬-éŸ³ä¹å¯¹ï¼Œä½†å…¶è€—æ—¶ä¸”ä¸å¯æ§ï¼Œéš¾ä»¥æ»¡è¶³T2M-Genç ”ç©¶çš„å¤§æ•°æ®éœ€æ±‚ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬æå‡ºåˆ©ç”¨å¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰ä¸ºå…¬å¼€éŸ³ä¹èµ„æºè‡ªåŠ¨ç”Ÿæˆå­—å¹•ã€‚

ç°æœ‰éŸ³ä¹å­—å¹•ç”Ÿæˆæ¨¡å‹åŒ…æ‹¬MusCaps[5]ã€éŸ³é¢‘å­—å¹•Transformer[6]ã€åŸºäºéŸ³é¢‘-æ–‡æœ¬æ£€ç´¢é¢„è®­ç»ƒçš„æ¨¡å‹[7]ã€Whisperå¾®å‹éŸ³é¢‘å­—å¹•Â²å’ŒLP-MusicCaps[8]ã€‚å…¶ä¸­ï¼ŒMusCapsé‡‡ç”¨å·ç§¯ç½‘ç»œä¸å¾ªç¯ç¥ç»ç½‘ç»œçš„æ··åˆæ¶æ„ï¼ŒLP-MusicCapsä½¿ç”¨è·¨æ¨¡æ€ç¼–ç å™¨-è§£ç å™¨æ¶æ„ã€‚å¦ä¸€ç§æ€è·¯æ˜¯åˆ©ç”¨éŸ³é¢‘é—®ç­”æ¨¡å‹ç”ŸæˆéŸ³ä¹å­—å¹•ã€‚

è¿‘æœŸï¼ŒLLaMA Adapter[9]ã€UniVAL[10]å’ŒLTU[11]ç­‰æ”¯æŒéŸ³é¢‘ç†è§£çš„æ¨¡å‹ç›¸ç»§å‡ºç°ã€‚ç„¶è€Œï¼Œè¿™äº›æ¨¡å‹ç¼ºä¹éŸ³ä¹æ–‡æœ¬æ•°æ®è®­ç»ƒï¼Œæˆ–ä¾èµ–ééŸ³ä¹éŸ³é¢‘æ•°æ®ï¼Œé™åˆ¶äº†å…¶åœ¨éŸ³ä¹é¢†åŸŸçš„è¡¨ç°ã€‚

æœ¬æ–‡æå‡ºä¸€ç§åˆ›æ–°æ–¹æ³•ï¼Œé€šè¿‡æ„å»ºåŸºäºLLaMAçš„
**MU-LLaMAæ¨¡å‹**
è§£å†³éŸ³ä¹é—®ç­”ä¸å­—å¹•ç”Ÿæˆé—®é¢˜ã€‚æ ¸å¿ƒè´¡çŒ®åŒ…æ‹¬ï¼š

1. æå‡ºæ€§èƒ½å“è¶Šçš„MU-LLaMAæ¨¡å‹ï¼›
2. è®¾è®¡MusicQAæ•°æ®é›†æ„å»ºæ–¹æ³•ï¼›
3. å±•ç¤ºMU-LLaMAç”Ÿæˆå¤šæ ·åŒ–å­—å¹•çš„èƒ½åŠ›ï¼Œæ”¯æŒT2M-Genæ¨¡å‹å¼€å‘ã€‚

è®ºæ–‡ç»“æ„å¦‚ä¸‹ï¼šç¬¬2ç« å¯¹æ¯”éŸ³ä¹ç‰¹å¾è¡¨ç¤ºæ–¹æ³•ï¼›ç¬¬3ç« ä»‹ç»MusicQAæ•°æ®é›†ç”Ÿæˆæ–¹æ³•ï¼›ç¬¬4ç« è¯¦è§£MU-LLaMAæ¶æ„ï¼›ç¬¬5ç« å±•ç¤ºå®éªŒç»“æœï¼›ç¬¬6ç« æ€»ç»“ä¸å±•æœ›ã€‚

---

#### 2. éŸ³ä¹ç‰¹å¾è¡¨ç¤º

ä¸ºå®ç°éŸ³ä¹ç†è§£ï¼Œæˆ‘ä»¬å¯¹æ¯”äº†ä»¥ä¸‹é¢„è®­ç»ƒéŸ³é¢‘è¡¨å¾æ¨¡å‹åœ¨MagnaTagATuneæ•°æ®é›†[15]ä¸Šçš„éŸ³ä¹æ ‡ç­¾ä»»åŠ¡æ€§èƒ½ï¼š

1. â€‹
   **ImageBind**
   [12]ï¼šè·¨6æ¨¡æ€çš„è”åˆåµŒå…¥æ¨¡å‹ï¼›
2. â€‹
   **JukeBox**
   [17]ï¼šåŸºäºVQ-VAEçš„è‡ªå›å½’Transformerï¼›
3. â€‹
   **OpenL3**
   [18]ï¼šåŸºäºéŸ³é¢‘-è§†è§‰å¯¹åº”çš„æ— ç›‘ç£åµŒå…¥ï¼›
4. â€‹
   **CLAP**
   [19]ï¼šå¯¹æ¯”è¯­è¨€-éŸ³é¢‘é¢„è®­ç»ƒæ¨¡å‹ï¼›
5. â€‹
   **Wav2CLIP**
   [20]ï¼šCLIPæ¨¡å‹çš„éŸ³é¢‘è’¸é¦ç‰ˆæœ¬ï¼›
6. â€‹
   **MERT**
   [22]ï¼šé€šè¿‡è‡ªç›‘ç£è®­ç»ƒå®ç°SOTAéŸ³ä¹ç†è§£çš„å£°å­¦æ¨¡å‹ã€‚

è¡¨1æ˜¾ç¤ºï¼ŒMERTåœ¨éŸ³ä¹æ ‡ç­¾ä»»åŠ¡ä¸­çš„å¹³å‡ç²¾åº¦ï¼ˆ59.57%ï¼‰æ˜¾è‘—ä¼˜äºå…¶ä»–æ¨¡å‹ï¼Œæ•…é€‰æ‹©å…¶ä½œä¸ºMU-LLaMAçš„éŸ³ä¹ç¼–ç å™¨ã€‚

**è¡¨1ï¼šéŸ³é¢‘è¡¨å¾æ¨¡å‹å¯¹æ¯”**

| æ¨¡å‹ | MTTAUC | MTTAP |
| --- | --- | --- |
| ImageBind | 88.55% | 40.19% |
| JukeBox | 91.5% | 41.4% |
| â€‹ **MERT** | 93.91% | 59.57% |

---

#### 3. MusicQAæ•°æ®é›†ç”Ÿæˆ

ä¸ºè®­ç»ƒMU-LLaMAï¼Œæˆ‘ä»¬åˆ©ç”¨MPT-7Bæ¨¡å‹[16]ä»MusicCapsï¼ˆå«æè¿°ï¼‰å’ŒMagnaTagATuneï¼ˆå«æ ‡ç­¾ï¼‰ç”Ÿæˆé—®ç­”å¯¹ï¼š

1. â€‹
   **æŒ‡ä»¤é›†1**
   ï¼šæ ¹æ®æè¿°/æ ‡ç­¾ç”Ÿæˆç­”æ¡ˆï¼ˆå¦‚â€œæè¿°è¿™æ®µéŸ³ä¹â€â€œä»éŸ³é¢‘ä¸­èƒ½æ¨æ–­ä»€ä¹ˆâ€ï¼‰ï¼›
2. â€‹
   **æŒ‡ä»¤é›†2**
   ï¼šç”Ÿæˆ5ä¸ªå¼€æ”¾å¼é—®ç­”å¯¹ï¼ˆå¦‚â€œéŸ³é¢‘çš„æƒ…ç»ªå¦‚ä½•â€â€œä½¿ç”¨äº†å“ªäº›ä¹å™¨â€ï¼‰ã€‚
     
   ç”Ÿæˆç¤ºä¾‹å¦‚ä¸‹ï¼ˆå®Œæ•´æŒ‡ä»¤ä¸æ ·ä¾‹è§é¡¹ç›®é¡µé¢â´ï¼‰ã€‚

---

#### 4. MU-LLaMAæ¨¡å‹æ¶æ„

å¦‚å›¾1æ‰€ç¤ºï¼ŒMU-LLaMAåŸºäºLLaMA-2 7Bæ¨¡å‹[14]ï¼Œé›†æˆMERTç¼–ç å™¨æå–éŸ³ä¹ç‰¹å¾ï¼š

1. â€‹
   **ç‰¹å¾æå–**
   ï¼šMERTçš„24ä¸ªéšè—å±‚ä¸1ä¸ªè¾“å‡ºå±‚ï¼ˆå…±25Ã—1024ç»´ï¼‰ç»å·ç§¯å±‚èšåˆä¸º1024ç»´å‘é‡ï¼›
2. â€‹
   **æŠ•å½±ä¸é€‚é…å™¨**
   ï¼šæŠ•å½±è‡³4096ç»´åï¼Œé€šè¿‡å«3ä¸ªå­å—çš„ç¨ å¯†ç½‘ç»œï¼ˆå…¬å¼1ï¼‰å¤„ç†ï¼Œè¾“å‡ºæ³¨å…¥LLaMAæœ€å19å±‚çš„æ³¨æ„åŠ›æŸ¥è¯¢ä¸­ï¼›
3. â€‹
   **è®­ç»ƒç­–ç•¥**
   ï¼šå†»ç»“MERTä¸LLaMAå‚æ•°ï¼Œä»…å¾®è°ƒè§£ç å™¨é€‚é…å™¨ã€‚

**å…¬å¼1**
ï¼šé€‚é…å™¨å‰å‘è®¡ç®—
  
![](https://i-blog.csdnimg.cn/direct/6b92e77317e3406c861c6e883aa545e3.png)

---

#### 5. å®éªŒä¸ç»“æœ

##### 5.1 å®éªŒè®¾ç½®

* â€‹
  **æ•°æ®é›†**
  ï¼šä»MTG-Jamendo[25]é€‰å–500é¦–éŸ³ä¹ç”Ÿæˆ4500 QAå¯¹ï¼ˆMTG-eval-QAï¼‰å’Œ1000å­—å¹•ï¼ˆMTG-eval-Capï¼‰ï¼›
* â€‹
  **è¯„ä¼°æŒ‡æ ‡**
  ï¼šBLEUã€METEORã€ROUGE-Lã€BERTScoreï¼›
* â€‹
  **è®­ç»ƒå‚æ•°**
  ï¼šå­¦ä¹ ç‡0.0001ï¼Œæ‰¹æ¬¡å¤§å°1ï¼Œé¢„è®­ç»ƒ150è½®ï¼Œå¾®è°ƒ20è½®ã€‚

##### 5.2 éŸ³ä¹é—®ç­”æ€§èƒ½

è¡¨2æ˜¾ç¤ºï¼ŒMU-LLaMAåœ¨METEORï¼ˆ0.385ï¼‰å’ŒROUGE-Lï¼ˆ0.466ï¼‰ä¸Šæ˜¾è‘—ä¼˜äºLLaMA Adapterä¸LTUã€‚

**è¡¨2ï¼šéŸ³ä¹é—®ç­”æ¨¡å‹å¯¹æ¯”**

| æ¨¡å‹ | BLEU | METEOR | ROUGE-L | BERTScore |
| --- | --- | --- | --- | --- |
| LTU | 0.242 | 0.274 | 0.326 | 0.887 |
| â€‹ **MU-LLaMA** | 0.306 | 0.385 | 0.466 | 0.901 |

##### 5.3 éŸ³ä¹å­—å¹•ç”Ÿæˆ

è¡¨3æ˜¾ç¤ºï¼ŒMU-LLaMAåœ¨BLEUï¼ˆ0.278ï¼‰å’ŒROUGE-Lï¼ˆ0.312ï¼‰ä¸Šè¶…è¶ŠLP-MusicCapsç­‰ä¸“ç”¨æ¨¡å‹ã€‚

**è¡¨3ï¼šéŸ³ä¹å­—å¹•æ¨¡å‹å¯¹æ¯”**

| æ¨¡å‹ | BLEU | METEOR | ROUGE-L | BERTScore |
| --- | --- | --- | --- | --- |
| LP-MusicCaps | 0.227 | 0.177 | 0.227 | 0.877 |
| â€‹ **MU-LLaMA** | 0.278 | 0.261 | 0.312 | 0.888 |

---

#### 6. ç»“è®º

æœ¬æ–‡æå‡ºçš„MU-LLaMAæ¨¡å‹åœ¨éŸ³ä¹é—®ç­”ä¸å­—å¹•ç”Ÿæˆä»»åŠ¡ä¸­å‡å®ç°SOTAæ€§èƒ½ã€‚æœªæ¥å·¥ä½œå°†æ‰©å±•è‡³æ­Œè¯ç†è§£ï¼Œå¹¶åˆ©ç”¨è¯¥æ¨¡å‹æ„å»ºT2M-Genæ‰€éœ€çš„å¤§è§„æ¨¡æ•°æ®é›†ã€‚

![](https://i-blog.csdnimg.cn/direct/46cebee1d4674ee786525eae8a392833.png)

å›¾ 1ï¼šéŸ³ä¹ç†è§£å¤§è¯­è¨€æ¨¡å‹ï¼ˆMU-LLaMAï¼‰ã€‚è¯¥æ¨¡å‹åˆ†ä¸º 3 ä¸ªéƒ¨åˆ†ï¼šï¼ˆ1ï¼‰é¢„è®­ç»ƒçš„ MERT ç¼–ç å™¨ï¼Œç”¨äºç”ŸæˆéŸ³ä¹è¡¨ç¤ºï¼›ï¼ˆ2ï¼‰éŸ³ä¹ç†è§£é€‚é…å™¨ï¼Œç”¨äºå°†è¯¥è¡¨ç¤ºèåˆåˆ° LLaMA æ¨¡å‹ä¸­ï¼›ï¼ˆ3ï¼‰LLaMA æ¨¡å‹ï¼Œå®ƒä»é€‚é…å™¨è·å–è¾“å…¥ï¼Œåœ¨æœ€å\((L - 1)\)å±‚ä¸­å­¦ä¹ éŸ³ä¹ä¸Šä¸‹æ–‡ä¿¡æ¯ã€‚

![](https://i-blog.csdnimg.cn/direct/2c03fef327864ad09ffe6e6c24615785.png)

### ä»‹ç»

MU-LLaMA æ¨¡å‹æ˜¯éŸ³ä¹ç†è§£è¯­è¨€æ¨¡å‹ï¼Œæ—¨åœ¨å›ç­”åŸºäºéŸ³ä¹çš„é—®é¢˜ã€‚æˆ‘ä»¬çš„æ¨¡å‹è¿˜æ—¨åœ¨ä¸ºéŸ³ä¹æ–‡ä»¶æ·»åŠ å­—å¹•ä»¥ç”Ÿæˆæ–‡æœ¬åˆ°éŸ³ä¹ç”Ÿæˆæ•°æ®é›†ã€‚è¯¥æ¨¡å‹ä½¿ç”¨ MERT + LLaMA ä½œä¸ºä¸»å¹²ï¼Œå¹¶é‡‡ç”¨é€‚é…å™¨æ¥è¿æ¥éŸ³ä¹ä¸Šä¸‹æ–‡ä¿¡æ¯ä»¥æŒ‡å¯¼ LLaMA çš„è¾“å‡ºã€‚åœ¨æ¯”è¾ƒäº†ä¸åŒçš„éŸ³ä¹è¡¨ç¤ºæ¨¡å‹åï¼ŒMERT è¢«é€‰ä¸ºæˆ‘ä»¬æ¨¡å‹çš„éŸ³ä¹ç¼–ç å™¨ï¼Œå¯ä»¥
[åœ¨è¿™é‡Œ](https://github.com/crypto-code/Music-Representation-Comparison "åœ¨è¿™é‡Œ")
æŸ¥çœ‹ã€‚æˆ‘ä»¬è¿˜æä¾›äº†ç”¨äºä»
[MusicCaps](https://www.kaggle.com/datasets/googleai/musiccaps "MusicCaps")
å’Œ
[MagnaTagATune](https://mirg.city.ac.uk/codeapps/the-magnatagatune-dataset "MagnaTagATune")
æ•°æ®é›†ç”Ÿæˆ MusicQA æ•°æ®é›†çš„ä»£ç ã€‚

[![](https://img-home.csdnimg.cn/images/20230724024159.png?origin_url=https%3A%2F%2Fgithub.com%2Fshansongliu%2FMU-LLaMA%2Fraw%2FLLaMA-2%2Fassets%2FMU-LLaMA.png&pos_id=AQWpHxvE)](https://github.com/shansongliu/MU-LLaMA/blob/LLaMA-2/assets/MU-LLaMA.png)

### MU-LLaMA æ¼”ç¤º

ä¸ºäº†ä½¿æˆ‘ä»¬çš„æ¨¡å‹å·¥ä½œï¼Œéœ€è¦ Facebook çš„ LLaMA-2 æ¨¡å‹æƒé‡ï¼Œæœ‰å…³è·å–è¿™äº›æƒé‡çš„è¯¦ç»†ä¿¡æ¯ï¼Œè¯·è®¿é—®
[HuggingFace](https://huggingface.co/docs/transformers/main/model_doc/llama "HuggingFace")
ã€‚æˆ‘ä»¬é’ˆå¯¹ MU-LLaMA æ¨¡å‹çš„é¢„è®­ç»ƒæƒé‡ï¼Œä»
**LLaMA 7B-2**
å¾®è°ƒï¼Œå¯ä»¥
[åœ¨æ­¤å¤„](https://huggingface.co/mu-llama/MU-LLaMA/tree/main "åœ¨æ­¤å¤„")
ä¸‹è½½ã€‚ä¸‹è½½åï¼Œå°†æ–‡ä»¶å­˜å‚¨åœ¨ MU-LLaMA ç›®å½•ä¸‹çš„ ckpts æ–‡ä»¶å¤¹ä¸­ã€‚

ä¸‹è½½åï¼Œç›®å½•ç»“æ„å°†å¦‚ä¸‹æ‰€ç¤ºã€‚

```notranslate
<span style="background-color:var(--bgColor-muted, var(--color-canvas-subtle))"><span style="color:#1f2328"><span style="color:var(--fgColor-default, var(--color-fg-default))"><span style="background-color:var(--bgColor-muted, var(--color-canvas-subtle))"><code>.
â”œâ”€â”€ ...
â”œâ”€â”€ MU-LLaMA                
â”‚   â”œâ”€â”€ ckpts
â”‚   â”‚   â”‚â”€â”€ LLaMA
â”‚   â”‚   â”‚   â”‚â”€â”€ 7B
â”‚   â”‚   â”‚   â”‚   â”‚â”€â”€ checklist.chk
â”‚   â”‚   â”‚   â”‚   â”‚â”€â”€ consolidated.00.pth
â”‚   â”‚   â”‚   â”‚   â”‚â”€â”€ params.json
â”‚   â”‚   â”‚   â”‚â”€â”€ llama.sh
â”‚   â”‚   â”‚   â”‚â”€â”€ tokenizer.model
â”‚   â”‚   â”‚   â”‚â”€â”€ tokenizer_checklist.chk
â”‚   â”‚   â”‚â”€â”€ 7B.pth
â”‚   â”‚   â”œâ”€â”€ checkpoint.pth
â””â”€â”€ ...
</code></span></span></span></span>
```

æˆ‘ä»¬åœ¨è¿™ä¸ªé¡¹ç›®ä¸­ä½¿ç”¨ Python 3.9.17ï¼Œåº“è¦æ±‚åœ¨
[requirements.txt](https://github.com/shansongliu/MU-LLaMA/blob/LLaMA-2/requirements.txt "requirements.txt")
ä¸­ç»™å‡ºã€‚å¯ä»¥ä½¿ç”¨
[gradio\_app.py](https://github.com/shansongliu/MU-LLaMA/blob/LLaMA-2/MU-LLaMA/gradio_app.py "gradio_app.py")
è¿è¡Œæ¼”ç¤ºã€‚

```notranslate
<span style="background-color:var(--bgColor-muted, var(--color-canvas-subtle))"><span style="color:#1f2328"><span style="color:var(--fgColor-default, var(--color-fg-default))"><span style="background-color:var(--bgColor-muted, var(--color-canvas-subtle))"><code>python gradio_app.py --model ./ckpts/checkpoint.pth --llama_dir ./ckpts/LLaMA
</code></span></span></span></span>
```

### è®­ç»ƒ MU-LLaMA

è¦è®­ç»ƒ MU-LLaMA æ¨¡å‹ï¼Œè¯·æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤ä½œã€‚

#### MusicQA æ•°æ®é›†

æˆ‘ä»¬ä½¿ç”¨
[MusicCaps](https://www.kaggle.com/datasets/googleai/musiccaps "MusicCaps")
å’Œ
[MagnaTagATune](https://mirg.city.ac.uk/codeapps/the-magnatagatune-dataset "MagnaTagATune")
æ•°æ®é›†æ¥ç”Ÿæˆæˆ‘ä»¬çš„è®­ç»ƒ MusicQA æ•°æ®é›†å’Œ
[MTG-Jamendo](https://github.com/MTG/mtg-jamendo-dataset "MTG-Jamendo")
è¿›è¡Œè¯„ä¼°ã€‚æ‚¨å¯ä»¥
[åœ¨æ­¤å¤„](https://huggingface.co/datasets/mu-llama/MusicQA "åœ¨æ­¤å¤„")
ä¸‹è½½ç”Ÿæˆçš„ MusicQA æ•°æ®é›†ã€‚

è¦è‡ªå·±ç”Ÿæˆæ•°æ®é›†ï¼Œè¯·å…ˆä¸‹è½½ MusicCapsã€MTT å’Œ MTG æ•°æ®é›†ã€‚ä¸‹è½½åï¼Œç›®å½•ç»“æ„å°†å¦‚å›¾æ‰€ç¤ºã€‚

```notranslate
<span style="background-color:var(--bgColor-muted, var(--color-canvas-subtle))"><span style="color:#1f2328"><span style="color:var(--fgColor-default, var(--color-fg-default))"><span style="background-color:var(--bgColor-muted, var(--color-canvas-subtle))"><code>.
â”œâ”€â”€ ...
â”œâ”€â”€ MusicQA                
â”‚   â”œâ”€â”€ MTT
â”‚   â”‚   â”œâ”€â”€ audios
â”‚   â”‚   â”‚   â”‚â”€â”€ ...
â”‚   â”‚   â”œâ”€â”€ annotations_final.csv
â”‚   â”œâ”€â”€ MusicCaps
â”‚   â”‚   â”œâ”€â”€ audios
â”‚   â”‚   â”‚   â”‚â”€â”€ ...
â”‚   â”‚   â”œâ”€â”€ musiccaps-public.csv
â”‚   â”œâ”€â”€ MTG
â”‚   â”‚   â”œâ”€â”€ audios
â”‚   â”‚   â”‚   â”‚â”€â”€ 00
â”‚   â”‚   â”‚   â”‚â”€â”€ 01
â”‚   â”‚   â”‚   â”‚â”€â”€ ...
â”‚   â”‚   â”œâ”€â”€ raw_30s_cleantags_50artists.tsv
â”‚   â”œâ”€â”€ MTT_process.py
â”‚   â”œâ”€â”€ musiccaps_process.py
â”‚   â”œâ”€â”€ MTG_process.py
â”‚   â”œâ”€â”€ generate_dataset.py
â””â”€â”€ ...
</code></span></span></span></span>
```

MusicQA æ•°æ®é›†ç”Ÿæˆæ˜¯ä¸€ä¸ªè®¡ç®—é‡éå¸¸å¤§çš„è¿‡ç¨‹ï¼Œåœ¨ Tesla V100-SXM2-32GB GPU ä¸Šï¼Œæ¯ä¸ªæ•°æ®é›†å¤§çº¦éœ€è¦ 8 å¤©ï¼Œå› æ­¤å»ºè®®ä¸‹è½½æˆ‘ä»¬ç”Ÿæˆçš„æ•°æ®é›†ã€‚

> ğŸ“
> **æ³¨æ„**
> ï¼š è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œå°† MTT éŸ³é¢‘æ–‡ä»¶ç»“æ„å‹ç¼©å¹¶æå–åï¼Œ

```notranslate
<span style="background-color:var(--bgColor-muted, var(--color-canvas-subtle))"><span style="color:#1f2328"><span style="color:var(--fgColor-default, var(--color-fg-default))"><span style="background-color:var(--bgColor-muted, var(--color-canvas-subtle))"><code>find ./MTT/audios -mindepth 2 -type f -exec mv -t ./MTT/audios -i '{}' +
</code></span></span></span></span>
```

> æˆ‘ä»¬åªä½¿ç”¨ MTG æ•°æ®é›†ä¸­çš„æ–‡ä»¶å¤¹ 00 åˆ° 09

é€šè¿‡è¿è¡Œ
[musiccaps\_process.py](https://github.com/shansongliu/MU-LLaMA/blob/LLaMA-2/MusicQA/musiccaps_process.py "musiccaps_process.py")
ã€
[MTT\_process.py](https://github.com/shansongliu/MU-LLaMA/blob/LLaMA-2/MusicQA/MTT_process.py "MTT_process.py")
å’Œ
[MTG\_process.py](https://github.com/shansongliu/MU-LLaMA/blob/LLaMA-2/MusicQA/MTG_process.py "MTG_process.py")
ï¼Œæ‚¨å¯ä»¥ä»æ¯ä¸ªæ•°æ®é›†ç”Ÿæˆé—®ç­”å¯¹ï¼Œå¹¶é€šè¿‡è¿è¡Œ
[generate\_dataset.py](https://github.com/shansongliu/MU-LLaMA/blob/LLaMA-2/MusicQA/generate_dataset.py "generate_dataset.py")
ç”Ÿæˆç”¨äºé¢„è®­ç»ƒã€å¾®è°ƒå’Œè¯„ä¼°çš„æœ€ç»ˆæ•°æ®é›†ã€‚

```notranslate
<span style="background-color:var(--bgColor-muted, var(--color-canvas-subtle))"><span style="color:#1f2328"><span style="color:var(--fgColor-default, var(--color-fg-default))"><span style="background-color:var(--bgColor-muted, var(--color-canvas-subtle))"><code>usage: generate_dataset.py [-h] --mtt MTT --mtg MTG --musiccaps MUSICCAPS --musicqa MUSICQA

optional arguments:
  -h, --help            show this help message and exit
  --mtt MTT             Directory of the MTT dataset
  --mtg MTG             Directory of the MTG dataset
  --musiccaps MUSICCAPS
                        Directory of the MusicCaps dataset
  --musicqa MUSICQA     Directory of the MusicQA dataset to be generated
</code></span></span></span></span>
```

#### MU-LLaMA é¢„è®­ç»ƒ

ä¸ºäº†é¢„è®­ç»ƒ MU-LLaMA æ¨¡å‹ï¼Œæˆ‘ä»¬ä½¿ç”¨ MusicQA æ•°æ®é›†çš„ MusicCaps éƒ¨åˆ†å’Œ
[Alpaca](https://github.com/shansongliu/MU-LLaMA/blob/LLaMA-2/MU-LLaMA/pretrain.sh "Alpaca")
Instruction æ•°æ®é›†ä»¥åŠ pretrain.sh è„šæœ¬ã€‚

```notranslate
<span style="background-color:var(--bgColor-muted, var(--color-canvas-subtle))"><span style="color:#1f2328"><span style="color:var(--fgColor-default, var(--color-fg-default))"><span style="background-color:var(--bgColor-muted, var(--color-canvas-subtle))"><code>./pretrain.sh ./ckpts/LLaMA-2 ./configs/pretrain.yaml ./ckpts/MU-LLaMA_Pretrain
</code></span></span></span></span>
```

è¿™å°†å¯¹ MU-LLaMA æ¨¡å‹è¿›è¡Œ 150 ä¸ª epoch çš„é¢„è®­ç»ƒã€‚å¯ä»¥åœ¨
[pretrain.sh](https://github.com/shansongliu/MU-LLaMA/blob/LLaMA-2/MU-LLaMA/pretrain.sh "pretrain.sh")
æ–‡ä»¶ä¸­ä¿®æ”¹è¶…å‚æ•°ã€‚

#### MU-LLaMA å¾®è°ƒ

ä¸ºäº†å¾®è°ƒ MU-LLaMA æ¨¡å‹ï¼Œæˆ‘ä»¬å°† MusicQA æ•°æ®é›†çš„ MTT éƒ¨åˆ†ä¸
[finetune.sh](https://github.com/shansongliu/MU-LLaMA/blob/LLaMA-2/MU-LLaMA/finetune.sh "finetune.sh")
è„šæœ¬ç»“åˆä½¿ç”¨ã€‚

```notranslate
<span style="background-color:var(--bgColor-muted, var(--color-canvas-subtle))"><span style="color:#1f2328"><span style="color:var(--fgColor-default, var(--color-fg-default))"><span style="background-color:var(--bgColor-muted, var(--color-canvas-subtle))"><code>./finetune.sh ./ckpts/LLaMA-2 ./ckpts/MU-LLaMA_Pretrain/checkpoint.pth ./configs/finetune.yaml ./ckpts/MU-LLaMA_Finetune
</code></span></span></span></span>
```

è¿™å°†å¯¹ MU-LLaMA æ¨¡å‹è¿›è¡Œ 20 ä¸ª epoch çš„å¾®è°ƒã€‚å¯ä»¥åœ¨
[finetune.sh](https://github.com/shansongliu/MU-LLaMA/blob/LLaMA-2/MU-LLaMA/finetune.sh "finetune.sh")
æ–‡ä»¶ä¸­ä¿®æ”¹è¶…å‚æ•°ã€‚å…·æœ‰ 7B å‚æ•°çš„ MU-LLaMA æ¨¡å‹åœ¨ Tesla V100-SXM2-32GB GPU ä¸Šè®­ç»ƒå¤§çº¦éœ€è¦ 2 å¤©æ—¶é—´ã€‚è®­ç»ƒåï¼Œå¯ä»¥ä½¿ç”¨ Gradio æ¼”ç¤ºå¯¹æ¨¡å‹è¿›è¡Œæµ‹è¯•ã€‚

#### MU-LLaMA æ¨ç†

è¦åœ¨æ²¡æœ‰ Gradio çš„æƒ…å†µä¸‹æµ‹è¯•æ¨¡å‹ï¼Œå¯ä»¥ä½¿ç”¨
[inference.py](https://github.com/shansongliu/MU-LLaMA/blob/LLaMA-2/MU-LLaMA/inference.py "inference.py")
è„šæœ¬ã€‚

```notranslate
<span style="background-color:var(--bgColor-muted, var(--color-canvas-subtle))"><span style="color:#1f2328"><span style="color:var(--fgColor-default, var(--color-fg-default))"><span style="background-color:var(--bgColor-muted, var(--color-canvas-subtle))"><code>usage: inference.py [-h] [--model MODEL] [--llama_type LLAMA_TYPE] [--llama_dir LLAMA_DIR] [--mert_path MERT_PATH] --audio_path AUDIO_PATH [--question QUESTION]

optional arguments:
  -h, --help            show this help message and exit
  --model MODEL         Name of or path to the trained checkpoint
  --llama_type LLAMA_TYPE
                        Type of llama original weight
  --llama_dir LLAMA_DIR
                        Path to LLaMA pretrained checkpoint
  --mert_path MERT_PATH
                        Path to MERT pretrained checkpoint
  --audio_path AUDIO_PATH
                        Path to the input music file
  --question QUESTION   Question to ask the model
</code></span></span></span></span>
```

#### MU-LLaMA è¯„ä¼°

æˆ‘ä»¬çš„æ¨¡å‹ä¸æ”¯æŒéŸ³é¢‘çš„æ¨¡å‹è¿›è¡Œäº†æ¯”è¾ƒï¼Œä¾‹å¦‚åœ¨æˆ‘ä»¬çš„ MusicQA æ•°æ®é›†ä¸Šè®­ç»ƒçš„ Listenï¼Œ Think and Understand ï¼ˆLTUï¼‰ æ¨¡å‹å’Œ LLaMA Adapter æ¨¡å‹ã€‚æˆ‘ä»¬ä½¿ç”¨ BLEU ï¼ˆB-Uï¼‰ã€METEOR ï¼ˆM-Rï¼‰ã€ROUGE è¯„ä¼°æ¨¡å‹Lï¼ˆR-Lï¼‰ å’Œ BERT-Score ï¼ˆBERT-Sï¼‰ æ˜¯æ–‡æœ¬ç”Ÿæˆçš„å¸¸ç”¨è¯„ä¼°æŒ‡æ ‡ã€‚å¯¹äº BLEU åˆ†æ•°ï¼ŒåŠ æƒå¹³å‡å€¼ä¸º BLEU1ã€ BLEU2ã€ BLEU3å’Œ BLEU4ï¼ˆæ¯ä¸ª weight = 0.25ï¼‰ã€‚

è¯„ä¼°è„šæœ¬åœ¨ ModelEvaluations æ–‡ä»¶å¤¹ä¸­ç»™å‡ºã€‚ç”Ÿæˆè„šæœ¬ç”¨äºç”Ÿæˆæ•°æ®é›†ä¸­æ‰€æœ‰é—®é¢˜çš„ç­”æ¡ˆã€‚

```notranslate
<span style="background-color:var(--bgColor-muted, var(--color-canvas-subtle))"><span style="color:#1f2328"><span style="color:var(--fgColor-default, var(--color-fg-default))"><span style="background-color:var(--bgColor-muted, var(--color-canvas-subtle))"><code>usage: generate_mullama.py [-h] [--model MODEL] [--knn KNN] [--llama_type LLAMA_TYPE] [--llama_dir LLAMA_DIR] [--mert_path MERT_PATH]

optional arguments:
  -h, --help            show this help message and exit
  --model MODEL         Name of or path to the trained checkpoint
  --knn KNN             Name of or path to the directory with knn checkpoint
  --llama_type LLAMA_TYPE
                        Type of llama original weight
  --llama_dir LLAMA_DIR
                        Path to LLaMA pretrained checkpoint
  --mert_path MERT_PATH
                        Path to MERT pretrained checkpoint
</code></span></span></span></span>
```

```notranslate
<span style="background-color:var(--bgColor-muted, var(--color-canvas-subtle))"><span style="color:#1f2328"><span style="color:var(--fgColor-default, var(--color-fg-default))"><span style="background-color:var(--bgColor-muted, var(--color-canvas-subtle))"><code>usage: generate_ltu.py [-h] [--demo DEMO]

optional arguments:
  -h, --help   show this help message and exit
  --demo DEMO  Link to the LTU Demo Page
</code></span></span></span></span>
```

```notranslate
<span style="background-color:var(--bgColor-muted, var(--color-canvas-subtle))"><span style="color:#1f2328"><span style="color:var(--fgColor-default, var(--color-fg-default))"><span style="background-color:var(--bgColor-muted, var(--color-canvas-subtle))"><code>usage: generate_llama-adapter.py [-h] [--model MODEL] [--llama_dir LLAMA_DIR]

optional arguments:
  -h, --help            show this help message and exit
  --model MODEL         Name of or path to the trained checkpoint
  --llama_dir LLAMA_DIR
                        Path to LLaMA pretrained checkpoint
</code></span></span></span></span>
```

ç”Ÿæˆåï¼Œ
[evaluate.py](https://github.com/shansongliu/MU-LLaMA/blob/LLaMA-2/ModelEvaluations/evaluate.py "evaluate.py")
å¯ç”¨äºè¯„ä¼°ä¸ºä¸‰ä¸ªæ¨¡å‹ç”Ÿæˆçš„ç­”æ¡ˆã€‚ç»“æœå¦‚ä¸‹æ‰€ç¤ºã€‚

| **å‹** | **B-U â†‘** | **M-R â†‘** | **R-L â†‘** | **BERT-S â†‘** |
| --- | --- | --- | --- | --- |
| LTU | 0.242 | 0.274 | 0.326 | 0.887 |
| LLaMA é€‚é…å™¨ | 0.273 | 0.334 | 0.413 | 0.895 |
| **MU-LLaMA ï¼ˆè‹±è¯­ï¼‰** | **0.306** | **0.385** | **0.466** | **0.901** |

### ç¡®è®¤

æ­¤ä»£ç åŒ…å«æ¥è‡ªä»¥ä¸‹å­˜å‚¨åº“çš„å…ƒç´ ï¼š

* [OpenGVLab/LLaMA é€‚é…å™¨](https://github.com/OpenGVLab/LLaMA-Adapter "OpenGVLab/LLaMA é€‚é…å™¨")
* [ä¼Šå…¹å¸Œå°”/MERT](https://github.com/yizhilll/MERT "ä¼Šå…¹å¸Œå°”/MERT")