---
layout: post
title: "接口测试笔记"
date: 2025-03-13 15:45:32 +0800
description: "创建Java工程新建libs库目录HttpClient 工具下载及引入工程中引入jar包请求地址中有多个参数用&符号连接，例如http://aaaaa?请求参数如包含非英文字符，需要encode转码String ulr3Param = URLEncoder.encode(\"浙江省_杭州市_滨江区\", \"UTF-8\");根据具体登录请求选择HttpEntity具体类型（HttpEntity   的两个实现类： StringEntity和 UrlEncodedFormEntity）"
keywords: "接口测试笔记"
categories: ['未分类']
tags: ['经验分享', '笔记']
artid: "146175334"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146175334
    alt: "接口测试笔记"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146175334
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146175334
cover: https://bing.ee123.net/img/rand?artid=146175334
image: https://bing.ee123.net/img/rand?artid=146175334
img: https://bing.ee123.net/img/rand?artid=146175334
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     接口测试笔记
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <h3>
     4、接口测试自动化
    </h3>
    <h3 style="background-color:transparent">
     接口自动化概述
    </h3>
    <h3>
     <img alt="" height="207" src="https://i-blog.csdnimg.cn/direct/796e0e6f4a69445281f7514ecb05fcf3.png" width="974">
      <br/>
      HttpClient
     </img>
    </h3>
    <h4>
     HttpClient开发过程
    </h4>
    <p>
     创建Java工程
     <br/>
     新建libs库目录
     <br/>
     HttpClient 工具下载及引入
    </p>
    <ul>
     <li>
      https://hc.apache.org/index.html
     </li>
     <li>
      工程中引入jar包
     </li>
    </ul>
    <p>
    </p>
    <h4>
     Get请求
    </h4>
    <h5>
     HttpGet方法---发起Get请求
    </h5>
    <p>
     创建HttpClient对象
    </p>
    <ul>
     <li>
      CloseableHttpClient httpclient = HttpClients.createDefault();
     </li>
    </ul>
    <p>
     创建带请求地址的HttpGet对象
    </p>
    <ul>
     <li>
      HttpGet httpGet = new HttpGet("http://xxxxxx");
     </li>
     <li>
      //ClassicHttpRequest get = ClassicRequestBuilder.get(url).build();
     </li>
    </ul>
    <p>
     执行HttpGet请求，获得响应
    </p>
    <ul>
     <li>
      client.execute(get, response -&gt; {})
     </li>
    </ul>
    <p>
     获取响应实体
    </p>
    <ul>
     <li>
      HttpEntity entity = response.getEntity();
     </li>
    </ul>
    <p>
     获取响应内容
    </p>
    <ul>
     <li>
      EntityUtils.toString(entity);
     </li>
    </ul>
    <p>
     断开连接
    </p>
    <ul>
     <li>
      response.close();
     </li>
     <li>
      httpclient.close();
     </li>
    </ul>
    <p>
    </p>
    <p>
     <strong>
      请求Header类型：Content-Type=application/json
     </strong>
    </p>
    <h3>
     <img alt="" height="417" src="https://i-blog.csdnimg.cn/direct/e792b2f481544136ade45b1690759fd7.png" width="1369"/>
    </h3>
    <h6>
     skulist-1测试用例详解
    </h6>
    <p>
     用例：获取所有商品的sku列表成功
    </p>
    <h3>
     <img alt="" height="610" src="https://i-blog.csdnimg.cn/direct/d3f8c29f0ea841d39c4d8aaff8576f5a.png" width="1316"/>
    </h3>
    <h6>
     skulist-2测试用例详解
    </h6>
    <p>
     用例：获取goodsId=1的商品sku信息成功
    </p>
    <p>
     <img alt="" height="246" src="https://i-blog.csdnimg.cn/direct/06f66e19901a411691cb76234084974c.png" width="1368"/>
    </p>
    <p>
     <img alt="" height="96" src="https://i-blog.csdnimg.cn/direct/7c0a21ee905442a291a459f364039bbf.png" width="1296"/>
    </p>
    <h6>
     skulist-3测试用例详解
    </h6>
    <p>
     用例：获取goodsId=2147483648的商品sku信息失败
    </p>
    <p>
     <img alt="" height="201" src="https://i-blog.csdnimg.cn/direct/d24bb278f769453b98541db0897832d3.png" width="1293"/>
    </p>
    <h5>
     HttpGet用法总结
    </h5>
    <p>
     注意事项：
    </p>
    <ul>
     <li>
      请求地址中有多个参数用&amp;符号连接，例如http://aaaaa?id=1&amp;name=tom
     </li>
     <li>
      请求参数如包含非英文字符，需要encode转码
     </li>
    </ul>
    <p>
     例如：
    </p>
    <ul>
     <li>
      URLEncoder.encode("{\"pId\":\"123456\"}", "UTF-8");
     </li>
     <li>
      String url3 = "http://localhost:8899/common/getTransportFee?id=1&amp;addressDetail=";
     </li>
     <li>
      String ulr3Param = URLEncoder.encode("浙江省_杭州市_滨江区", "UTF-8");
     </li>
    </ul>
    <h4>
     POST
    </h4>
    <h5>
     HTTP请求格式-POST方法
    </h5>
    <p>
     请求（Request）
    </p>
    <table cellspacing="0" style="height:252pt; width:374pt">
     <tbody>
      <tr>
       <td style="border-color:#000000; height:70pt; vertical-align:top; width:113pt">
        <p style="text-align:left">
         <strong>
          <span style="color:#000000">
           请求行
          </span>
         </strong>
        </p>
       </td>
       <td style="border-color:#000000; height:70pt; vertical-align:top; width:261pt">
        <p style="text-align:left">
         <span style="color:#000000">
          POST
         </span>
         <strong>
          <span style="color:#000000">
           /
          </span>
         </strong>
         <strong>
          <span style="color:#000000">
           xinhu
          </span>
         </strong>
         <strong>
          <span style="color:#000000">
           /
          </span>
         </strong>
         <strong>
          <span style="color:#000000">
           index.php?a
          </span>
         </strong>
         <strong>
          <span style="color:#000000">
           =
          </span>
         </strong>
         <strong>
          <span style="color:#000000">
           check&amp;m
          </span>
         </strong>
         <strong>
          <span style="color:#000000">
           =login
          </span>
         </strong>
        </p>
        <p style="text-align:left">
         <span style="color:#000000">
          HTTP/1.1
         </span>
        </p>
       </td>
      </tr>
      <tr>
       <td style="border-color:#000000; height:113pt; vertical-align:top; width:113pt">
        <p style="text-align:left">
         <strong>
          <span style="color:#000000">
           请求头
          </span>
         </strong>
        </p>
       </td>
       <td style="border-color:#000000; height:113pt; vertical-align:middle; width:261pt">
        <p style="text-align:left">
         <span style="color:#000000">
          Accept
         </span>
         <span style="color:#000000">
          ：
         </span>
         <span style="color:#000000">
          t
         </span>
         <span style="color:#000000">
          ext/
         </span>
         <span style="color:#000000">
          html,application
         </span>
         <span style="color:#000000">
          /
         </span>
         <span style="color:#000000">
          xhtml+xml
         </span>
        </p>
        <p style="text-align:left">
         <span style="color:#000000">
          Accept-Encoding:
         </span>
         <span style="color:#000000">
          gzip
         </span>
         <span style="color:#000000">
          , deflate
         </span>
        </p>
        <p style="text-align:left">
         <span style="color:#000000">
          Accept-Language:zh-CN,zh;q
         </span>
         <span style="color:#000000">
          =0.8,en-US;q=0.5,en;q=0.3
         </span>
        </p>
        <p style="text-align:left">
         <span style="color:#000000">
          Connection:keep-alive
         </span>
        </p>
        <p style="text-align:left">
         <span style="color:#000000">
          Host
         </span>
         <span style="color:#000000">
          ：
         </span>
         <span style="color:#000000">
          localhost:8032
         </span>
        </p>
       </td>
      </tr>
      <tr>
       <td style="border-color:#000000; height:64pt; vertical-align:top; width:113pt">
        <p style="text-align:left">
         <strong>
          <span style="color:#000000">
           请求正文
          </span>
         </strong>
        </p>
       </td>
       <td style="border-color:#000000; height:64pt; vertical-align:middle; width:261pt">
        <p style="text-align:left">
         <span style="color:#ff0000">
          adminuser
         </span>
         <span style="color:#ff0000">
          =YWRtaW4%3A&amp;=123456&amp;rempass=0&amp;button=&amp;
         </span>
         <span style="color:#ff0000">
          jmpass
         </span>
         <span style="color:#ff0000">
          =
         </span>
         <span style="color:#ff0000">
          false&amp;device
         </span>
         <span style="color:#ff0000">
          =1517376146707&amp;adminpass=MTIzNDU2
         </span>
        </p>
       </td>
      </tr>
     </tbody>
    </table>
    <p>
     响应（Response）
    </p>
    <table cellspacing="0" style="height:262pt; width:290pt">
     <tbody>
      <tr>
       <td style="border-color:#000000; height:21pt; vertical-align:top; width:102pt">
        <p style="text-align:left">
         <strong>
          <span style="color:#000000">
           状态行
          </span>
         </strong>
        </p>
       </td>
       <td style="border-color:#000000; height:21pt; vertical-align:top; width:188pt">
        <p style="text-align:left">
         <strong>
          <span style="color:#000000">
           HTTP1.1 200 OK
          </span>
         </strong>
        </p>
       </td>
      </tr>
      <tr>
       <td style="border-color:#000000; height:167pt; vertical-align:top; width:102pt">
        <p style="text-align:left">
         <strong>
          <span style="color:#000000">
           响应头
          </span>
         </strong>
        </p>
       </td>
       <td style="border-color:#000000; height:167pt; vertical-align:top; width:188pt">
        <p style="text-align:left">
         <span style="color:#000000">
          Connection
         </span>
         <span style="color:#000000">
          ：
         </span>
         <span style="color:#000000">
          Keep-Alive
         </span>
        </p>
        <p style="text-align:left">
         <span style="color:#000000">
          Content-Encoding
         </span>
         <span style="color:#000000">
          ：
         </span>
         <span style="color:#000000">
          gzip
         </span>
        </p>
        <p style="text-align:left">
         <span style="color:#000000">
          Content-Length
         </span>
         <span style="color:#000000">
          ：
         </span>
         <span style="color:#000000">
          1234
         </span>
        </p>
        <p style="text-align:left">
         <span style="color:#000000">
          Content-Type
         </span>
         <span style="color:#000000">
          ：
         </span>
         <span style="color:#000000">
          text/
         </span>
         <span style="color:#000000">
          html;charset
         </span>
         <span style="color:#000000">
          =utf-8
         </span>
        </p>
        <p style="text-align:left">
         <span style="color:#000000">
          Date
         </span>
         <span style="color:#000000">
          ：
         </span>
         <span style="color:#000000">
          Mon, 05 Feb 2018 02:43:40 GMT
         </span>
        </p>
        <p style="text-align:left">
        </p>
       </td>
      </tr>
      <tr>
       <td style="border-color:#000000; height:70pt; vertical-align:top; width:102pt">
        <p style="text-align:left">
         <strong>
          <span style="color:#000000">
           响应正文
          </span>
         </strong>
        </p>
       </td>
       <td style="border-color:#000000; height:70pt; vertical-align:top; width:188pt">
        <p style="text-align:left">
         <span style="color:#000000">
          {"
         </span>
         <span style="color:#000000">
          success":true,"face":"http
         </span>
         <span style="color:#000000">
          :\/\/localhost:8032\/
         </span>
         <span style="color:#000000">
          xinhu
         </span>
         <span style="color:#000000">
          \/upload\/face\/1.jpg"}
         </span>
        </p>
       </td>
      </tr>
     </tbody>
    </table>
    <h3>
    </h3>
    <p>
     创建HttpClient对象
    </p>
    <ul>
     <li>
      CloseableHttpClient  httpclient = HttpClients.createDefault();
     </li>
    </ul>
    <p>
     创建带请求地址的HttpPost 对象
    </p>
    <ul>
     <li>
      HttpPost httpPost = new HttpPost("https://www.xxx.com");
     </li>
    </ul>
    <p>
     设置HttpPost对象Header属性
    </p>
    <ul>
     <li>
      httpPost.setHeader("Content-Type","application/json");
     </li>
    </ul>
    <p>
     设置HttpPost 参数
    </p>
    <ul>
     <li>
      StringEntity entity = new StringEntity("para","utf-8");
     </li>
     <li>
      httpPost.setEntity(entity);
     </li>
    </ul>
    <p>
     执行HttpPost请求，获取post请求的响应
    </p>
    <ul>
     <li>
      httpclient.execute(httpPost,resp -&gt;{});
     </li>
    </ul>
    <p>
     获取响应实体
    </p>
    <ul>
     <li>
      HttpEntity entity = response.getEntity();
     </li>
    </ul>
    <p>
     获取响应内容
    </p>
    <ul>
     <li>
      EntityUtils.toString(entity);
     </li>
    </ul>
    <p>
     断开连接
    </p>
    <ul>
     <li>
      response.close();
     </li>
     <li>
      httpclient.close();
     </li>
    </ul>
    <p>
     <strong>
      请求Header类型：Content-Type=application/json
     </strong>
    </p>
    <p>
     <img alt="" height="424" src="https://i-blog.csdnimg.cn/direct/c21a45ec57f540288fd6af9a53512f1f.png" width="1384"/>
    </p>
    <p>
    </p>
    <h6>
     login-1测试用例详解
    </h6>
    <p>
     <img alt="" height="504" src="https://i-blog.csdnimg.cn/direct/b5764edc6cba4233aeb8645ca112a860.png" width="1344"/>
    </p>
    <p>
     <img alt="" height="461" src="https://i-blog.csdnimg.cn/direct/401974e517684cf897e31c20133281f9.png" width="1440"/>
    </p>
    <p>
     响应结果
     <br/>
     {"message":"success","code":200}
    </p>
    <p>
    </p>
    <h5>
     HttpClient登录模拟总结
    </h5>
    <p>
     注意事项：
    </p>
    <ul>
     <li>
      根据具体登录请求选择HttpEntity具体类型（HttpEntity   的两个实现类： StringEntity和 UrlEncodedFormEntity）
     </li>
     <li>
      登录请求的Content-Type需要正确设置
     </li>
     <li>
      如果不想使用同一个HttpClient对象传递登录信息，可以考虑对需要登录信息请求分别设置Cookie:
     </li>
    </ul>
    <p>
     <span style="color:#be191c">
      httpPost.setHeader("Cookie"," mindsparktb_232530392=true; mindsparktbsupport_232530392=true");
     </span>
    </p>
    <p>
    </p>
    <h5>
     HttpClient设置代理
    </h5>
    <ul>
     <li>
      HttpHost proxy = new HttpHost("127.0.0.1", 8888);
     </li>
     <li>
      CloseableHttpClient client = HttpClients.custom().setProxy(proxy).build();
     </li>
    </ul>
    <p>
    </p>
    <h3 style="background-color:transparent">
     引入测试框架
    </h3>
    <h4>
     测试框架：TestNG
    </h4>
    <p>
     测试验证点、用例集的组织、测试报告
    </p>
    <p>
    </p>
    <h5>
     TestNG简介
    </h5>
    <ul>
     <li>
      The next generation of unit testing
     </li>
     <li>
      Cedric Beust
     </li>
     <li>
      http://testng.org/doc/
     </li>
     <li>
      基于Junit、Nunit并支持注解、数据驱动、多线程执行等特性的Java测试框架
     </li>
    </ul>
    <p>
    </p>
    <h6>
     TestNG基础：注解（Annotation）
    </h6>
    <p>
     JDK5引入注解，TestNG用以方便的标注测试方法和组件
    </p>
    <ul>
     <li>
      @Test 标注测试方法
     </li>
     <li>
      @BeforeTest 标注全部测试方法
      <span style="color:#be191c">
       执行前
      </span>
      需要执行的方法
     </li>
     <li>
      @AfterClass 标注测试类全部方法
      <span style="color:#be191c">
       执行之后
      </span>
      需执行的方法
     </li>
     <li>
      @DataProvider 数据驱动
     </li>
    </ul>
    <p>
     <span style="color:#be191c">
      注意：TestNG执行测试方法之前，都会重新实例化测试类
     </span>
    </p>
    <p>
     <img alt="" height="190" src="https://i-blog.csdnimg.cn/direct/b779b6e2f2a348f58bf19bc8293004e2.png" width="1010"/>
    </p>
    <p>
    </p>
    <h6>
     TestNG基础：断言（Assert）
    </h6>
    <p>
     org.testng.Assert
    </p>
    <ul>
     <li>
      fail 直接失败测试用例
     </li>
     <li>
      assertTrue    判断是否为true
     </li>
     <li>
      assertNull    判断是否为null
     </li>
     <li>
      assertEquals    判断是否相等
     </li>
    </ul>
    <p>
     <img alt="" height="277" src="https://i-blog.csdnimg.cn/direct/a096d257206044649f9bf0c019cc429a.png" width="1010"/>
    </p>
    <h6>
     TestNG基础：Test属性使用
    </h6>
    <h3>
     <img alt="" height="703" src="https://i-blog.csdnimg.cn/direct/3d8df582b29343768e1ae74c9a2ec9a4.png" width="1296"/>
    </h3>
    <h6>
     TestNG基础：@DataProvider
    </h6>
    <p>
     <img alt="" height="583" src="https://i-blog.csdnimg.cn/direct/e2cc34a3a5f9499e890902732e59b56f.png" width="1242"/>
    </p>
    <h6>
     TestNG基础：DataProvider属性使用
    </h6>
    <ul>
     <li>
      使用数据驱动，复用测试方法
     </li>
    </ul>
    <p>
     <img alt="" height="443" src="https://i-blog.csdnimg.cn/direct/e2df5cd515f94ac09522861666cef08d.png" width="1179"/>
    </p>
    <p>
    </p>
    <h6>
     TestNG基础：testng.xml用例集
    </h6>
    <ul>
     <li>
      指定测试类
     </li>
    </ul>
    <p>
     <img alt="" height="451" src="https://i-blog.csdnimg.cn/direct/c561c8d94df342d68c335c2d0483994f.png" width="1123"/>
    </p>
    <p>
    </p>
    <h6>
     TestNG自带测试报告
    </h6>
    <p>
     <img alt="" height="513" src="https://i-blog.csdnimg.cn/direct/e130f28c04e9426b93c609d857dc4c34.png" width="1305"/>
    </p>
    <p>
     <strong>
      TestNG+ReportNG报告
     </strong>
    </p>
    <p>
     <img alt="" height="317" src="https://i-blog.csdnimg.cn/direct/7e38d453ba844f0c95cffaab886ff82c.png" width="1302"/>
    </p>
    <p>
     <strong>
      Allure--自动化测试报告生成
     </strong>
    </p>
    <p>
     <img alt="" height="479" src="https://i-blog.csdnimg.cn/direct/e193f1c4339f402ea023e41fd46eb96e.png" width="1378"/>
    </p>
    <p>
     <strong>
      TestNG+FreeMarker测试报告
     </strong>
    </p>
    <p>
     <img alt="" height="383" src="https://i-blog.csdnimg.cn/direct/bf07b54e45b14a70861f2cd90ea38e75.png" width="1352"/>
    </p>
    <h3>
     <br/>
     接口测试结果验证
    </h3>
    <p>
    </p>
    <h4>
     如何验证
    </h4>
    <p>
     Java中解析常用的类库有FastJson、JSON-Java、Gson等
    </p>
    <p>
     解析JSON数据
    </p>
    <ul>
     <li>
      fastjson2-2.0.39.jar
     </li>
    </ul>
    <p>
     验证JSON数据正确
    </p>
    <ul>
     <li>
      TestNG、Assert
     </li>
    </ul>
    <p>
    </p>
    <h4>
     解析JSON
    </h4>
    <p>
     <img alt="" height="443" src="https://i-blog.csdnimg.cn/direct/1ab681d6c1cc4a08909ffd1f76c804b7.png" width="953"/>
    </p>
    <h3>
     <br/>
     面向场景的接口自动化测试
    </h3>
    <h4>
     用例回顾
    </h4>
    <h5>
     用例步骤--登录成功
    </h5>
    <p>
     <img alt="" height="461" src="https://i-blog.csdnimg.cn/direct/60fd7d02e26b43be91aaf08f62de2e25.png" width="1373"/>
    </p>
    <h5>
     用例步骤-查询收货地址
    </h5>
    <h4>
     <img alt="" height="526" src="https://i-blog.csdnimg.cn/direct/66d5aa8abec24a36ad4322abca76abe8.png" width="1351"/>
    </h4>
    <h5>
     用例步骤-计算运费
    </h5>
    <p>
     <img alt="" height="669" src="https://i-blog.csdnimg.cn/direct/90cbc01f1a61468085febd2181186424.png" width="1409"/>
    </p>
    <h5>
     用例步骤-提交订单
    </h5>
    <p>
     <img alt="" height="689" src="https://i-blog.csdnimg.cn/direct/200c92af73de4b05a35d197332a2efe9.png" width="1217"/>
    </p>
    <p>
     <img alt="" height="510" src="https://i-blog.csdnimg.cn/direct/6ab05c1a866b41bcb960c3d57b03f448.png" width="1158"/>
    </p>
    <p>
    </p>
    <h4>
     场景测试总结
    </h4>
    <p>
     注意事项：
    </p>
    <ul>
     <li>
      使用TestNG的BeforeClass和AfterClass去初始化和关闭HttpClient对象
     </li>
     <li>
      使用dependsOnMethods属性关联场景的接口
     </li>
    </ul>
    <p>
     <img alt="" height="368" src="https://i-blog.csdnimg.cn/direct/7cc4f7a70ecc407b88f88dffbd892ab5.png" width="681"/>
    </p>
    <p>
    </p>
    <p>
     注意事项：
    </p>
    <ul>
     <li>
      根据具体场景分析关联的接口，使用TestNG功能来安排用例执行顺序
     </li>
     <li>
      使用成员变量来传递接口返回数据
     </li>
     <li>
      在不同的HttpClient中间显示传递Cookie
     </li>
    </ul>
    <p>
    </p>
    <h5>
     返回Cookie
    </h5>
    <p>
     CookieStore cookie =new BasicCookieStore();
     <br/>
     httpClient =HttpClients.custom().
     <br/>
     setDefaultCookieStore(cookie).build();
    </p>
    <h5>
     设置Cookie
    </h5>
    <p>
     httpClient =HttpClients.custom().
     <br/>
     setDefaultCookieStore(cookie).build();
    </p>
    <p>
    </p>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f672e:6373646e2e6e65742f77656978696e5f37343330313536362f:61727469636c652f64657461696c732f313436313735333334" class_="artid" style="display:none">
 </p>
</div>


