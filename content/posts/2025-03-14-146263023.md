---
layout: post
title: "LLM自动化评测"
date: 2025-03-14 17:46:07 +0800
description: "【代码】LLM自动化评测。"
keywords: "LLM自动化评测"
categories: ['未分类']
tags: ['Python']
artid: "146263023"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146263023
    alt: "LLM自动化评测"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146263023
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146263023
cover: https://bing.ee123.net/img/rand?artid=146263023
image: https://bing.ee123.net/img/rand?artid=146263023
img: https://bing.ee123.net/img/rand?artid=146263023
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     LLM自动化评测
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-github-gist" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
     使用的数据集：
     <a href="https://huggingface.co/datasets/ceval/ceval-exam" rel="nofollow">
      ceval-exam
     </a>
    </p>
    <pre><code class="prism language-python"><span class="token keyword">import</span> requests
<span class="token keyword">from</span> datasets <span class="token keyword">import</span> load_dataset<span class="token punctuation">,</span> concatenate_datasets
<span class="token keyword">import</span> re
<span class="token keyword">from</span> tqdm <span class="token keyword">import</span> tqdm
<span class="token keyword">import</span> re<span class="token punctuation">,</span> time<span class="token punctuation">,</span> tiktoken<span class="token punctuation">,</span> ollama
<span class="token keyword">from</span> ollama <span class="token keyword">import</span> ChatResponse
<span class="token keyword">from</span> ollama <span class="token keyword">import</span> Options


<span class="token keyword">def</span> <span class="token function">llm</span><span class="token punctuation">(</span>model<span class="token punctuation">,</span> query<span class="token punctuation">,</span> temperature<span class="token operator">=</span><span class="token number">0.6</span><span class="token punctuation">,</span> stream<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span>tiktoken<span class="token punctuation">.</span>encoding_for_model<span class="token punctuation">(</span><span class="token string">"gpt-4"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> max_tokens<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># return "A"</span>
    options <span class="token operator">=</span> Options<span class="token punctuation">(</span>
        temperature<span class="token operator">=</span>temperature<span class="token punctuation">,</span>
        num_gpu<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token comment"># num_gpu=0即使用CPU计算</span>
        <span class="token comment"># num_thread=32,</span>
        <span class="token comment"># num_ctx=4096, # 上下文窗口大小</span>
    <span class="token punctuation">)</span>
    <span class="token comment"># 流式输出</span>
    response <span class="token operator">=</span> ollama<span class="token punctuation">.</span>chat<span class="token punctuation">(</span>
        model<span class="token operator">=</span>model<span class="token punctuation">,</span>
        messages<span class="token operator">=</span><span class="token punctuation">[</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token string">"role"</span><span class="token punctuation">:</span> <span class="token string">"system"</span><span class="token punctuation">,</span>
                <span class="token string">"content"</span><span class="token punctuation">:</span> <span class="token string">"你是一个做题专家。请完成下列单项选择题。\n\n## output format\n只能输出一个选项编号字母，不要有解析等其他任何内容。"</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token string">"role"</span><span class="token punctuation">:</span> <span class="token string">"user"</span><span class="token punctuation">,</span>
                <span class="token string">"content"</span><span class="token punctuation">:</span> query<span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        options<span class="token operator">=</span>options<span class="token punctuation">,</span>
        stream<span class="token operator">=</span>stream<span class="token punctuation">,</span>
        keep_alive<span class="token operator">=</span><span class="token number">0</span>
    <span class="token punctuation">)</span>
    <span class="token keyword">if</span> stream<span class="token punctuation">:</span>
        chunks <span class="token operator">=</span> <span class="token string">""</span>
        <span class="token comment"># 逐块打印响应内容</span>
        <span class="token keyword">for</span> chunk <span class="token keyword">in</span> response<span class="token punctuation">:</span>
            chunks <span class="token operator">+=</span> chunk<span class="token punctuation">[</span><span class="token string">"message"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"content"</span><span class="token punctuation">]</span>
            <span class="token comment"># print(chunk["message"]["content"], end="", flush=True)</span>
            <span class="token keyword">if</span> max_tokens <span class="token operator">!=</span> <span class="token boolean">None</span> <span class="token keyword">and</span> <span class="token builtin">len</span><span class="token punctuation">(</span>encoding<span class="token punctuation">.</span>encode<span class="token punctuation">(</span>chunks<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> max_tokens<span class="token punctuation">:</span>
                <span class="token keyword">break</span>
        response <span class="token operator">=</span> chunks
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token comment"># print(response["message"]["content"])</span>
        response <span class="token operator">=</span> response<span class="token punctuation">[</span><span class="token string">"message"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"content"</span><span class="token punctuation">]</span>
    
    <span class="token comment"># stream=True时无效</span>
    <span class="token comment"># with open("tmp.txt", "a", encoding="utf-8") as f:</span>
    <span class="token comment">#     f.write(response + "\n"+ 100*'*' + '\n')</span>
    <span class="token keyword">if</span> <span class="token string">'&lt;think&gt;'</span> <span class="token keyword">in</span> response <span class="token keyword">and</span> <span class="token string">'&lt;/think&gt;'</span> <span class="token keyword">in</span> response<span class="token punctuation">:</span>
        response <span class="token operator">=</span> re<span class="token punctuation">.</span>sub<span class="token punctuation">(</span><span class="token string">r'&lt;think&gt;.*?&lt;/think&gt;'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">,</span> response<span class="token punctuation">,</span> flags<span class="token operator">=</span>re<span class="token punctuation">.</span>DOTALL<span class="token punctuation">)</span>
    <span class="token keyword">return</span> response<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>


task_list <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token string">"computer_network"</span><span class="token punctuation">,</span>
    <span class="token string">"operating_system"</span><span class="token punctuation">,</span>
    <span class="token string">"computer_architecture"</span><span class="token punctuation">,</span>
    <span class="token string">"college_programming"</span><span class="token punctuation">,</span>
    <span class="token string">"college_physics"</span><span class="token punctuation">,</span>
    <span class="token string">"college_chemistry"</span><span class="token punctuation">,</span>
    <span class="token string">"advanced_mathematics"</span><span class="token punctuation">,</span>
    <span class="token string">"probability_and_statistics"</span><span class="token punctuation">,</span>
    <span class="token string">"discrete_mathematics"</span><span class="token punctuation">,</span>
    <span class="token string">"electrical_engineer"</span><span class="token punctuation">,</span>
    <span class="token string">"metrology_engineer"</span><span class="token punctuation">,</span>
    <span class="token string">"high_school_mathematics"</span><span class="token punctuation">,</span>
    <span class="token string">"high_school_physics"</span><span class="token punctuation">,</span>
    <span class="token string">"high_school_chemistry"</span><span class="token punctuation">,</span>
    <span class="token string">"high_school_biology"</span><span class="token punctuation">,</span>
    <span class="token string">"middle_school_mathematics"</span><span class="token punctuation">,</span>
    <span class="token string">"middle_school_biology"</span><span class="token punctuation">,</span>
    <span class="token string">"middle_school_physics"</span><span class="token punctuation">,</span>
    <span class="token string">"middle_school_chemistry"</span><span class="token punctuation">,</span>
    <span class="token string">"veterinary_medicine"</span><span class="token punctuation">,</span>
    <span class="token string">"college_economics"</span><span class="token punctuation">,</span>
    <span class="token string">"business_administration"</span><span class="token punctuation">,</span>
    <span class="token string">"marxism"</span><span class="token punctuation">,</span>
    <span class="token string">"mao_zedong_thought"</span><span class="token punctuation">,</span>
    <span class="token string">"education_science"</span><span class="token punctuation">,</span>
    <span class="token string">"teacher_qualification"</span><span class="token punctuation">,</span>
    <span class="token string">"high_school_politics"</span><span class="token punctuation">,</span>
    <span class="token string">"high_school_geography"</span><span class="token punctuation">,</span>
    <span class="token string">"middle_school_politics"</span><span class="token punctuation">,</span>
    <span class="token string">"middle_school_geography"</span><span class="token punctuation">,</span>
    <span class="token string">"modern_chinese_history"</span><span class="token punctuation">,</span>
    <span class="token string">"ideological_and_moral_cultivation"</span><span class="token punctuation">,</span>
    <span class="token string">"logic"</span><span class="token punctuation">,</span>
    <span class="token string">"law"</span><span class="token punctuation">,</span>
    <span class="token string">"chinese_language_and_literature"</span><span class="token punctuation">,</span>
    <span class="token string">"art_studies"</span><span class="token punctuation">,</span>
    <span class="token string">"professional_tour_guide"</span><span class="token punctuation">,</span>
    <span class="token string">"legal_professional"</span><span class="token punctuation">,</span>
    <span class="token string">"high_school_chinese"</span><span class="token punctuation">,</span>
    <span class="token string">"high_school_history"</span><span class="token punctuation">,</span>
    <span class="token string">"middle_school_history"</span><span class="token punctuation">,</span>
    <span class="token string">"civil_servant"</span><span class="token punctuation">,</span>
    <span class="token string">"sports_science"</span><span class="token punctuation">,</span>
    <span class="token string">"plant_protection"</span><span class="token punctuation">,</span>
    <span class="token string">"basic_medicine"</span><span class="token punctuation">,</span>
    <span class="token string">"clinical_medicine"</span><span class="token punctuation">,</span>
    <span class="token string">"urban_and_rural_planner"</span><span class="token punctuation">,</span>
    <span class="token string">"accountant"</span><span class="token punctuation">,</span>
    <span class="token string">"fire_engineer"</span><span class="token punctuation">,</span>
    <span class="token string">"environmental_impact_assessment_engineer"</span><span class="token punctuation">,</span>
    <span class="token string">"tax_accountant"</span><span class="token punctuation">,</span>
    <span class="token string">"physician"</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>
task_chinese_name_list <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token string">"计算机网络"</span><span class="token punctuation">,</span>
    <span class="token string">"操作系统"</span><span class="token punctuation">,</span>
    <span class="token string">"计算机架构"</span><span class="token punctuation">,</span>
    <span class="token string">"大学编程"</span><span class="token punctuation">,</span>
    <span class="token string">"大学物理"</span><span class="token punctuation">,</span>
    <span class="token string">"大学化学"</span><span class="token punctuation">,</span>
    <span class="token string">"高等数学"</span><span class="token punctuation">,</span>
    <span class="token string">"概率与统计"</span><span class="token punctuation">,</span>
    <span class="token string">"离散数学"</span><span class="token punctuation">,</span>
    <span class="token string">"电气工程师"</span><span class="token punctuation">,</span>
    <span class="token string">"计量工程师"</span><span class="token punctuation">,</span>
    <span class="token string">"高中数学"</span><span class="token punctuation">,</span>
    <span class="token string">"高中物理"</span><span class="token punctuation">,</span>
    <span class="token string">"高中化学"</span><span class="token punctuation">,</span>
    <span class="token string">"高中生物学"</span><span class="token punctuation">,</span>
    <span class="token string">"中学数学"</span><span class="token punctuation">,</span>
    <span class="token string">"中学生物学"</span><span class="token punctuation">,</span>
    <span class="token string">"中学物理"</span><span class="token punctuation">,</span>
    <span class="token string">"中学化学"</span><span class="token punctuation">,</span>
    <span class="token string">"兽医学"</span><span class="token punctuation">,</span>
    <span class="token string">"大学经济学"</span><span class="token punctuation">,</span>
    <span class="token string">"工商管理"</span><span class="token punctuation">,</span>
    <span class="token string">"马克思主义"</span><span class="token punctuation">,</span>
    <span class="token string">"毛泽东思想"</span><span class="token punctuation">,</span>
    <span class="token string">"教育科学"</span><span class="token punctuation">,</span>
    <span class="token string">"教师资格"</span><span class="token punctuation">,</span>
    <span class="token string">"高中政治"</span><span class="token punctuation">,</span>
    <span class="token string">"高中地理"</span><span class="token punctuation">,</span>
    <span class="token string">"中学政治"</span><span class="token punctuation">,</span>
    <span class="token string">"中学地理"</span><span class="token punctuation">,</span>
    <span class="token string">"现代中国史"</span><span class="token punctuation">,</span>
    <span class="token string">"思想道德修养"</span><span class="token punctuation">,</span>
    <span class="token string">"逻辑"</span><span class="token punctuation">,</span>
    <span class="token string">"法律"</span><span class="token punctuation">,</span>
    <span class="token string">"汉语与文学"</span><span class="token punctuation">,</span>
    <span class="token string">"艺术研究"</span><span class="token punctuation">,</span>
    <span class="token string">"专业旅游指南"</span><span class="token punctuation">,</span>
    <span class="token string">"法律专业"</span><span class="token punctuation">,</span>
    <span class="token string">"高中汉语"</span><span class="token punctuation">,</span>
    <span class="token string">"高中历史"</span><span class="token punctuation">,</span>
    <span class="token string">"中学历史"</span><span class="token punctuation">,</span>
    <span class="token string">"公务员"</span><span class="token punctuation">,</span>
    <span class="token string">"体育科学"</span><span class="token punctuation">,</span>
    <span class="token string">"植物保护"</span><span class="token punctuation">,</span>
    <span class="token string">"基础医学"</span><span class="token punctuation">,</span>
    <span class="token string">"临床医学"</span><span class="token punctuation">,</span>
    <span class="token string">"城市与农村规划"</span><span class="token punctuation">,</span>
    <span class="token string">"会计"</span><span class="token punctuation">,</span>
    <span class="token string">"消防工程师"</span><span class="token punctuation">,</span>
    <span class="token string">"环境影响评估工程师"</span><span class="token punctuation">,</span>
    <span class="token string">"税务会计"</span><span class="token punctuation">,</span>
    <span class="token string">"医生"</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>

<span class="token keyword">def</span> <span class="token function">test_split</span><span class="token punctuation">(</span>model_name<span class="token punctuation">)</span><span class="token punctuation">:</span>
    encoding <span class="token operator">=</span> tiktoken<span class="token punctuation">.</span>encoding_for_model<span class="token punctuation">(</span><span class="token string">"gpt-4"</span><span class="token punctuation">)</span>
    model_name_write <span class="token operator">=</span> model_name<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">":"</span><span class="token punctuation">,</span> <span class="token string">"_"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">,</span> <span class="token string">"_"</span><span class="token punctuation">)</span>
    <span class="token comment"># with open(f"{model_name_write}.txt", "w", encoding="utf-8") as f:</span>
    <span class="token comment">#     f.write(f"")</span>
    <span class="token comment"># 加载数据集</span>
    sum_total <span class="token operator">=</span> <span class="token number">0</span>
    sum_correct <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">26</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>task_list<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            dataset_tmp <span class="token operator">=</span> load_dataset<span class="token punctuation">(</span><span class="token string">r"ceval/data"</span><span class="token punctuation">,</span> name<span class="token operator">=</span>task_list<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
            dataset <span class="token operator">=</span> concatenate_datasets<span class="token punctuation">(</span>
                <span class="token punctuation">[</span>dataset_tmp<span class="token punctuation">[</span><span class="token string">"dev"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dataset_tmp<span class="token punctuation">[</span><span class="token string">"val"</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
            <span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"\nNo.</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>i<span class="token punctuation">}</span></span><span class="token string">: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>task_list<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">(</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>task_chinese_name_list<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">)数据集加载完成, len(dataset)=</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token builtin">len</span><span class="token punctuation">(</span>dataset<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
        <span class="token keyword">except</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"\nNo.</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>i<span class="token punctuation">}</span></span><span class="token string">: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>task_list<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">(</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>task_chinese_name_list<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">)数据集加载失败"</span></span><span class="token punctuation">)</span>
            <span class="token keyword">continue</span>

        <span class="token comment"># 初始化统计变量</span>
        correct <span class="token operator">=</span> <span class="token number">0</span>
        total <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>dataset<span class="token punctuation">)</span>
        <span class="token keyword">for</span> item <span class="token keyword">in</span> tqdm<span class="token punctuation">(</span>dataset<span class="token punctuation">,</span> desc<span class="token operator">=</span><span class="token string-interpolation"><span class="token string">f"No.</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>i<span class="token punctuation">}</span></span><span class="token string">: Processing"</span></span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># for item in dataset:</span>
            <span class="token keyword">try</span><span class="token punctuation">:</span>
                <span class="token comment"># 构造完整问题</span>
                user_prompt <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>item<span class="token punctuation">[</span><span class="token string">'question'</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">\nA. </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>item<span class="token punctuation">[</span><span class="token string">'A'</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">\nB. </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>item<span class="token punctuation">[</span><span class="token string">'B'</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">\nC. </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>item<span class="token punctuation">[</span><span class="token string">'C'</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">\nD. </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>item<span class="token punctuation">[</span><span class="token string">'D'</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">\n答案："</span></span>

                <span class="token comment"># 调用Ollama API</span>
                model_answer <span class="token operator">=</span> llm<span class="token punctuation">(</span>model_name<span class="token punctuation">,</span> user_prompt<span class="token punctuation">,</span> stream<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span>encoding<span class="token punctuation">,</span> max_tokens<span class="token operator">=</span><span class="token number">4096</span><span class="token punctuation">)</span>
                <span class="token comment"># 提取并验证答案</span>
                <span class="token triple-quoted-string string">"""从模型输出中提取答案选项（A/B/C/D）"""</span>
                <span class="token keyword">match</span> <span class="token operator">=</span> re<span class="token punctuation">.</span>search<span class="token punctuation">(</span><span class="token string">r"[A-D]"</span><span class="token punctuation">,</span> model_answer<span class="token punctuation">.</span>upper<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                extracted <span class="token operator">=</span> <span class="token keyword">match</span><span class="token punctuation">.</span>group<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">if</span> <span class="token keyword">match</span> <span class="token keyword">else</span> <span class="token boolean">None</span>
                <span class="token keyword">if</span> extracted <span class="token keyword">and</span> extracted <span class="token operator">==</span> item<span class="token punctuation">[</span><span class="token string">"answer"</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
                    correct <span class="token operator">+=</span> <span class="token number">1</span>
            <span class="token keyword">except</span><span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\nerror."</span><span class="token punctuation">)</span>
        <span class="token comment"># 输出结果</span>
        sum_total <span class="token operator">+=</span> total
        sum_correct <span class="token operator">+=</span> correct
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"No.</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>i<span class="token punctuation">}</span></span><span class="token string">: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>task_list<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">(</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>task_chinese_name_list<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">)数据集准确率: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>correct<span class="token punctuation">}</span></span><span class="token string">/</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>total<span class="token punctuation">}</span></span><span class="token string"> = </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>correct<span class="token operator">/</span>total<span class="token punctuation">:</span><span class="token format-spec">.2%</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
        <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>model_name_write<span class="token punctuation">}</span></span><span class="token string">.txt"</span></span><span class="token punctuation">,</span> <span class="token string">"a"</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
            f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"No.</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>i<span class="token punctuation">}</span></span><span class="token string">: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>task_list<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">(</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>task_chinese_name_list<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">)数据集准确率: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>correct<span class="token punctuation">}</span></span><span class="token string">/</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>total<span class="token punctuation">}</span></span><span class="token string"> = </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>correct<span class="token operator">/</span>total<span class="token punctuation">:</span><span class="token format-spec">.2%</span><span class="token punctuation">}</span></span><span class="token string">\n\n"</span></span><span class="token punctuation">)</span>

    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>model_name_write<span class="token punctuation">}</span></span><span class="token string">.txt"</span></span><span class="token punctuation">,</span> <span class="token string">"a"</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
        f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"总准确率: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>sum_correct<span class="token punctuation">}</span></span><span class="token string">/</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>sum_total<span class="token punctuation">}</span></span><span class="token string"> = </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>sum_correct<span class="token operator">/</span>sum_total<span class="token punctuation">:</span><span class="token format-spec">.2%</span><span class="token punctuation">}</span></span><span class="token string">\n\n"</span></span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"总准确率: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>sum_correct<span class="token punctuation">}</span></span><span class="token string">/</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>sum_total<span class="token punctuation">}</span></span><span class="token string"> = </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>sum_correct<span class="token operator">/</span>sum_total<span class="token punctuation">:</span><span class="token format-spec">.2%</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>

<span class="token comment"># huihui_ai/qwen2.5-abliterate:7b-instruct-q4_K_M    </span>
<span class="token comment"># qwen2.5:3b-instruct-q8_0                           </span>
<span class="token comment"># qwen2.5:7b-instruct-q5_K_M                         </span>
<span class="token comment"># deepseek-r1-7b:latest </span>
<span class="token comment"># test_split(model_name="qwen2.5:3b-instruct-q8_0")</span>
<span class="token comment"># test_split(model_name="qwen2.5:7b-instruct-q5_K_M")</span>
<span class="token comment"># test_split(model_name="huihui_ai/qwen2.5-abliterate:7b-instruct-q4_K_M")</span>
<span class="token comment"># test_split(model_name="qwen2.5:1.5b")</span>
<span class="token comment"># test_split(model_name="qwen2.5:1.5b-instruct-fp16")</span>
<span class="token comment"># test_split(model_name="qwen2.5:3b")</span>
<span class="token comment"># test_split(model_name="gemma3:4b")</span>
<span class="token comment"># test_split(model_name="qwen2.5:7b")</span>
<span class="token comment"># test_split(model_name="gemma3:4b-it-q8_0")</span>
<span class="token comment"># test_split(model_name="qwen2.5:0.5b-instruct-fp16")</span>
<span class="token comment"># test_split(model_name="qwen2.5:0.5b")</span>

test_split<span class="token punctuation">(</span>model_name<span class="token operator">=</span><span class="token string">"deepseek-r1:1.5b"</span><span class="token punctuation">)</span>
<span class="token comment"># test_split(model_name="deepseek-r1:1.5b-qwen-distill-fp16")</span>
<span class="token comment"># test_split(model_name="deepseek-r1:7b")</span>
</code></pre>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f67:2e6373646e2e6e65742f4c6f756973655f5472656e6465722f:61727469636c652f64657461696c732f313436323633303233" class_="artid" style="display:none">
 </p>
</div>


