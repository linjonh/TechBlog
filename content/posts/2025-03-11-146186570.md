---
layout: post
title: "Vue3的基本使用"
date: 2025-03-11 18:58:21 +0800
description: "本文章讲解了Vue3的基本使用，以及相较于vue2中的一些变化"
keywords: "Vue3的基本使用"
categories: ['未分类']
tags: ['前端框架', 'Vue', 'Javascript']
artid: "146186570"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146186570
    alt: "Vue3的基本使用"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146186570
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146186570
cover: https://bing.ee123.net/img/rand?artid=146186570
image: https://bing.ee123.net/img/rand?artid=146186570
img: https://bing.ee123.net/img/rand?artid=146186570
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     Vue3的基本使用
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="./../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="./../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h2>
     <a id="1_vue3_0">
     </a>
     1.
     <code>
      vue3
     </code>
     的基本简介
    </h2>
    <p>
     <code>
      Vue.js 3
     </code>
     是
     <code>
      Vue
     </code>
     框架的重大版本升级，专注于性能提升、开发体验优化和更好的
     <code>
      TypeScript
     </code>
     支持。其核心特性如下：
    </p>
    <table>
     <thead>
      <tr>
       <th align="center">
        <strong>
         特性
        </strong>
       </th>
       <th align="center">
        <strong>
         说明
        </strong>
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td align="center">
        <code>
         Composition API
        </code>
       </td>
       <td align="center">
        引入
        <code>
         setup()
        </code>
        函数和响应式函数（
        <code>
         ref
        </code>
        ,
        <code>
         reactive
        </code>
        ），逻辑复用更灵活，替代 Options API 的碎片化问题。
       </td>
      </tr>
      <tr>
       <td align="center">
        性能优化
       </td>
       <td align="center">
        虚拟
        <code>
         DOM
        </code>
        重构（
        <code>
         Diff
        </code>
        算法优化）、
        <code>
         Tree-shaking
        </code>
        支持（按需打包代码），包体积减少 41%。
       </td>
      </tr>
      <tr>
       <td align="center">
        <code>
         TypeScript
        </code>
        支持
       </td>
       <td align="center">
        源码用
        <code>
         TypeScript
        </code>
        重写，提供完整的类型定义，开发体验更友好。
       </td>
      </tr>
      <tr>
       <td align="center">
        新内置组件
       </td>
       <td align="center">
        <code>
         &lt;Teleport&gt;
        </code>
        ：跨组件层级渲染内容 -
        <code>
         &lt;Suspense&gt;
        </code>
        ：异步组件加载状态管理
       </td>
      </tr>
      <tr>
       <td align="center">
        <code>
         Fragment
        </code>
        支持
       </td>
       <td align="center">
        单组件支持多根节点，无需外层包裹
        <code>
         &lt;div&gt;
        </code>
        。
       </td>
      </tr>
     </tbody>
    </table>
    <h2>
     <a id="2_Vue3_14">
     </a>
     2. 创建
     <code>
      Vue3
     </code>
     工程
    </h2>
    <ul>
     <li>
      <p>
       <code>
        vue-cli
       </code>
       创建
      </p>
      <pre><code class="prism language-js">npm create vue
</code></pre>
     </li>
     <li>
      <p>
       <code>
        vite
       </code>
       创建
      </p>
      <pre><code class="prism language-js">npm create vite@latest project<span class="token operator">-</span>name <span class="token operator">--</span> <span class="token operator">--</span>template vue
cd <span class="token operator">&lt;</span>project<span class="token operator">-</span>name<span class="token operator">&gt;</span>
npm install
<span class="token comment">// 启动开发服务器</span>
npm run dev
</code></pre>
     </li>
    </ul>
    <p>
     <code>
      Vue3
     </code>
     项目结构说明：
    </p>
    <pre><code class="prism language-text">my-vue-app/
├── src/
│   ├── assets/       # 静态资源（图片、CSS）
│   ├── components/   # 组件目录
│   ├── App.vue       # 根组件
│   └── main.js       # 应用入口文件
├── index.html        # 主 HTML 文件
├── vite.config.js    # Vite 配置文件
└── package.json
</code></pre>
    <p>
     使用
     <code>
      vite
     </code>
     创建
     <code>
      vue3
     </code>
     项目和使用
     <code>
      vuecli
     </code>
     创建
     <code>
      vue3
     </code>
     项目的核心区别如下：
    </p>
    <table>
     <thead>
      <tr>
       <th align="center">
        <strong>
         特性
        </strong>
       </th>
       <th align="center">
        <strong>
         Vite
        </strong>
       </th>
       <th align="center">
        <strong>
         Vue CLI
        </strong>
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td align="center">
        <strong>
         底层构建工具
        </strong>
       </td>
       <td align="center">
        基于
        <strong>
         ESBuild
        </strong>
        （开发） +
        <strong>
         Rollup
        </strong>
        （生产）
       </td>
       <td align="center">
        基于
        <strong>
         Webpack
        </strong>
       </td>
      </tr>
      <tr>
       <td align="center">
        <strong>
         启动速度
        </strong>
       </td>
       <td align="center">
        极快（毫秒级冷启动）
       </td>
       <td align="center">
        较慢（需打包所有模块）
       </td>
      </tr>
      <tr>
       <td align="center">
        <strong>
         热更新（HMR）
        </strong>
       </td>
       <td align="center">
        极快（按需更新）
       </td>
       <td align="center">
        较慢（需重新打包部分模块）
       </td>
      </tr>
      <tr>
       <td align="center">
        <strong>
         配置复杂度
        </strong>
       </td>
       <td align="center">
        轻量级，开箱即用
       </td>
       <td align="center">
        复杂，依赖
        <code>
         vue.config.js
        </code>
       </td>
      </tr>
      <tr>
       <td align="center">
        <strong>
         生态兼容性
        </strong>
       </td>
       <td align="center">
        兼容 Rollup 插件生态
       </td>
       <td align="center">
        依赖 Webpack 插件生态
       </td>
      </tr>
      <tr>
       <td align="center">
        <strong>
         浏览器支持
        </strong>
       </td>
       <td align="center">
        默认面向现代浏览器（ES Modules）
       </td>
       <td align="center">
        默认兼容旧浏览器（通过 polyfill）
       </td>
      </tr>
      <tr>
       <td align="center">
        <strong>
         官方定位
        </strong>
       </td>
       <td align="center">
        下一代前端工具，Vue 3 官方推荐
       </td>
       <td align="center">
        旧版 Vue 的官方脚手架
       </td>
      </tr>
     </tbody>
    </table>
    <h2>
     <a id="3_Composition_API_64">
     </a>
     3. 常用的
     <code>
      Composition API
     </code>
    </h2>
    <h3>
     <a id="31_setup_66">
     </a>
     3.1
     <code>
      setup
     </code>
     函数
    </h3>
    <p>
     在
     <code>
      Vue 3
     </code>
     中，
     <code>
      setup
     </code>
     函数是
     <strong>
      <code>
       Composition API
      </code>
     </strong>
     的核心，用于替代
     <code>
      Vue 2
     </code>
     的
     <code>
      data
     </code>
     、
     <code>
      methods
     </code>
     等选项。
     <code>
      setup
     </code>
     函数在n
     <code>
      beforeCreate
     </code>
     之前执行一次，所以
     <code>
      this
     </code>
     是
     <code>
      undefined
     </code>
     ，所以在
     <code>
      setup
     </code>
     中不能使用
     <code>
      this
     </code>
     。
     <code>
      setup
     </code>
     函数的作用如下：
    </p>
    <ul>
     <li>
      <p>
       初始化响应式数据：使用
       <code>
        ref
       </code>
       或
       <code>
        reactive
       </code>
       声明响应式变量。
      </p>
     </li>
     <li>
      <p>
       定义方法：直接在函数内声明并返回方法。
      </p>
     </li>
     <li>
      <p>
       访问组件上下文：通过参数获取
       <code>
        props
       </code>
       、
       <code>
        emit
       </code>
       、
       <code>
        slots
       </code>
       等。
      </p>
     </li>
     <li>
      <p>
       组合逻辑：将相关逻辑组织在一起，提升代码可维护性。
       <code>
        setup
       </code>
       中无法访问
       <code>
        this
       </code>
       ，所有逻辑通过
       <code>
        Composition API
       </code>
       实现。
      </p>
      <pre><code class="prism language-js"><span class="token comment">// 基本使用</span>
<span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span> ref<span class="token punctuation">,</span> reactive<span class="token punctuation">,</span> onMounted <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{<!-- --></span>
  <span class="token literal-property property">props</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token literal-property property">title</span><span class="token operator">:</span> String
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">setup</span><span class="token punctuation">(</span><span class="token parameter">props<span class="token punctuation">,</span> context</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 响应式数据</span>
    <span class="token keyword">const</span> count <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> state <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Vue 3'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 方法</span>
    <span class="token keyword">const</span> <span class="token function-variable function">increment</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
      count<span class="token punctuation">.</span>value<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token comment">// 生命周期钩子</span>
    <span class="token function">onMounted</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'组件已挂载'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 暴露给模板的数据和方法</span>
    <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span>
      count<span class="token punctuation">,</span>
      state<span class="token punctuation">,</span>
      increment
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
     </li>
    </ul>
    <p>
     从上述案例可以看出
     <code>
      setup
     </code>
     函数有两个参数，如下：
    </p>
    <ul>
     <li>
      <p>
       <code>
        pros
       </code>
       ：
       <code>
        props
       </code>
       是组件接收的响应式属性，对应组件通过
       <code>
        props
       </code>
       选项声明的属性。
      </p>
      <ul>
       <li>
        <p>
         响应式：
         <code>
          props
         </code>
         是响应式对象，修改会导致组件更新。
        </p>
       </li>
       <li>
        <p>
         禁止直接解构赋值，否则会丢失响应式，需使用
         <code>
          toRefs
         </code>
         或
         <code>
          toRef
         </code>
         。
        </p>
        <pre><code class="prism language-js"><span class="token comment">// 父组件通过&lt;Demo msg='你好' school='CQUT'&gt;向子组件传递数据</span>

<span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span> toRefs<span class="token punctuation">,</span> toRef <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>

<span class="token comment">// 需要声明</span>
props <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'msg'</span><span class="token punctuation">,</span> <span class="token string">'school'</span><span class="token punctuation">]</span>
<span class="token function">setup</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token comment">// 解构所有 props 并保持响应性</span>
  <span class="token keyword">const</span> <span class="token punctuation">{<!-- --></span> title <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">toRefs</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span>
  <span class="token comment">// 处理可选 prop</span>
  <span class="token keyword">const</span> subtitle <span class="token operator">=</span> <span class="token function">toRef</span><span class="token punctuation">(</span>props<span class="token punctuation">,</span> <span class="token string">'subtitle'</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span> title<span class="token punctuation">,</span> subtitle <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
       </li>
       <li>
        <p>
         只读性：子组件不应直接修改
         <code>
          props
         </code>
         ，需通过父组件传递新值。
        </p>
       </li>
      </ul>
     </li>
     <li>
      <p>
       <code>
        context
       </code>
       ：提供组件上下文信息，包含三个核心属性：
       <code>
        attrs
       </code>
       、
       <code>
        slots
       </code>
       和
       <code>
        emit
       </code>
       。
      </p>
      <ul>
       <li>
        <p>
         <code>
          attrs
         </code>
         ：包含未在
         <code>
          props
         </code>
         中声明的属性，如
         <code>
          class
         </code>
         、
         <code>
          style
         </code>
         、
         <code>
          v-on
         </code>
         监听器等。避免基于
         <code>
          attrs
         </code>
         创建副作用，如
         <code>
          watch
         </code>
         。
        </p>
       </li>
       <li>
        <p>
         <code>
          slots
         </code>
         ：收到的插槽内容，相当于
         <code>
          this.$slots
         </code>
         。
        </p>
        <pre><code class="prism language-js"><span class="token operator">&lt;</span>Demo @hello<span class="token operator">=</span><span class="token string">"sayHello"</span><span class="token operator">&gt;</span>
    <span class="token comment">// vue3中推荐使用v-slot</span>
    <span class="token operator">&lt;</span>template v<span class="token operator">-</span>slot<span class="token operator">:</span>aaa<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>span<span class="token operator">&gt;</span>你好子组件<span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>Demo<span class="token operator">&gt;</span>
</code></pre>
       </li>
       <li>
        <p>
         <code>
          emit
         </code>
         ：触发自定义事件，替代
         <code>
          Vue 2
         </code>
         的
         <code>
          this.$emit
         </code>
         。
        </p>
        <pre><code class="prism language-js"><span class="token comment">// 父组件</span>
<span class="token operator">&lt;</span>Demo @hello<span class="token operator">=</span><span class="token string">"sayHello"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>Demo<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
	<span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">function</span> <span class="token function">sayHello</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
    
    
<span class="token comment">// 子组件</span>
emits <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'hello'</span><span class="token punctuation">]</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{<!-- --></span>
  <span class="token literal-property property">emits</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'submit'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token function">setup</span><span class="token punctuation">(</span><span class="token parameter">props<span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span> emit <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">const</span> <span class="token function-variable function">handleClick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
      <span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">'submit'</span><span class="token punctuation">,</span> <span class="token string">'数据'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span> handleClick <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
       </li>
      </ul>
     </li>
    </ul>
    <h3>
     <a id="32__ref_186">
     </a>
     3.2
     <code>
      _ref
     </code>
     函数
    </h3>
    <p>
     在
     <code>
      Vue 3
     </code>
     中，
     <code>
      ref
     </code>
     是组合式
     <code>
      API
     </code>
     的核心函数，用于创建响应式的引用对象。
    </p>
    <pre><code class="prism language-js"><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token literal-property property">count</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span> count <span class="token punctuation">}</span><span class="token punctuation">}</span> <span class="token operator">&lt;</span>button @click<span class="token operator">=</span><span class="token string">"increment"</span><span class="token operator">&gt;</span>count<span class="token operator">++</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
  <span class="token literal-property property">str</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span> str <span class="token punctuation">}</span><span class="token punctuation">}</span>
  person<span class="token punctuation">.</span>name<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span> person<span class="token punctuation">.</span>name <span class="token punctuation">}</span><span class="token punctuation">}</span>
  <span class="token operator">&lt;</span>hr<span class="token operator">&gt;</span>
  person<span class="token punctuation">.</span>person_info<span class="token punctuation">.</span>number<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span> person<span class="token punctuation">.</span>person_info<span class="token punctuation">.</span>number<span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
<span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span>ref<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"vue"</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{<!-- --></span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'App'</span><span class="token punctuation">,</span>
    <span class="token function">setup</span><span class="token punctuation">(</span><span class="token parameter">props<span class="token punctuation">,</span> context</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">const</span> count <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> str <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token string">'Hello Vue3'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> person <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
        <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Tom'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span>
        <span class="token literal-property property">person_info</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
          <span class="token literal-property property">number</span><span class="token operator">:</span> <span class="token string">'666'</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token keyword">function</span> <span class="token function">increment</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 修改基本类型数据直接使用.value</span>
        count<span class="token punctuation">.</span>value<span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token comment">// 对象数据类型只需要第一层.value</span>
        person<span class="token punctuation">.</span>value<span class="token punctuation">.</span>person_info<span class="token punctuation">.</span>number <span class="token operator">=</span> <span class="token string">'777'</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span>
        count<span class="token punctuation">,</span>
        str<span class="token punctuation">,</span>
        increment<span class="token punctuation">,</span>
        person
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>style scoped<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span>
</code></pre>
    <p>
     对于
     <code>
      ref
     </code>
     函数，接收的数据可以是基本数据类型，也可以是对象数据类型，区别如下：
    </p>
    <ul>
     <li>
      基本数据类型：响应式依然是靠
      <code>
       Object.defineProperty()
      </code>
      的
      <code>
       get
      </code>
      和
      <code>
       set
      </code>
      完成的。
     </li>
     <li>
      对象数据类型：响应式本质上还是使用
      <code>
       Vue3
      </code>
      中的
      <code>
       reactive
      </code>
      ，使用
      <code>
       Proxy
      </code>
      完成响应式。
     </li>
    </ul>
    <h3>
     <a id="33_reactive_246">
     </a>
     3.3
     <code>
      reactive
     </code>
     函数
    </h3>
    <p>
     在
     <code>
      Vue 3
     </code>
     中，
     <code>
      reactive
     </code>
     是
     <code>
      Composition API
     </code>
     的核心函数之一，用于创建响应式的对象或数组。
     <code>
      reactive
     </code>
     函数不能用于基本数据类型。从现象上来看，
     <code>
      reactive
     </code>
     函数封装的对象数据操作不需要
     <code>
      .value
     </code>
     。
    </p>
    <pre><code class="prism language-js"><span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span> reactive <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> state <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Alice'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">30</span><span class="token punctuation">,</span>
  <span class="token literal-property property">address</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token literal-property property">city</span><span class="token operator">:</span> <span class="token string">'New York'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 修改属性（自动触发视图更新）</span>
state<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">31</span><span class="token punctuation">;</span>
state<span class="token punctuation">.</span>address<span class="token punctuation">.</span>city <span class="token operator">=</span> <span class="token string">'Los Angeles'</span><span class="token punctuation">;</span>


<span class="token comment">// 数组</span>
<span class="token keyword">const</span> list <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'apple'</span><span class="token punctuation">,</span> <span class="token string">'banana'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
list<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'orange'</span><span class="token punctuation">;</span> <span class="token comment">// 触发更新</span>
list<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">'grape'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 触发更新</span>
</code></pre>
    <pre><code class="prism language-js"><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>p<span class="token operator">&gt;</span>Name<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span> state<span class="token punctuation">.</span>name <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>p<span class="token operator">&gt;</span>Age<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span> state<span class="token punctuation">.</span>age <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>p<span class="token operator">&gt;</span>City<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span> state<span class="token punctuation">.</span>address<span class="token punctuation">.</span>city <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
</code></pre>
    <p>
     <code>
      reactive
     </code>
     返回原始对象的
     <code>
      Proxy
     </code>
     代理，而非原始对象本身。验证如下：
    </p>
    <pre><code class="prism language-js">console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>state <span class="token operator">===</span> <span class="token function">reactive</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true（同一代理）</span>
</code></pre>
    <p>
     与
     <code>
      ref
     </code>
     对比如下：
    </p>
    <table>
     <thead>
      <tr>
       <th align="center">
        <strong>
         特性
        </strong>
       </th>
       <th align="center">
        <code>
         reactive
        </code>
       </th>
       <th align="center">
        <code>
         ref
        </code>
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td align="center">
        <strong>
         适用类型
        </strong>
       </td>
       <td align="center">
        对象、数组
       </td>
       <td align="center">
        基本类型、对象、数组
       </td>
      </tr>
      <tr>
       <td align="center">
        <strong>
         访问方式
        </strong>
       </td>
       <td align="center">
        直接访问属性（
        <code>
         state.name
        </code>
        ）
       </td>
       <td align="center">
        需
        <code>
         .value
        </code>
        （脚本中）
       </td>
      </tr>
      <tr>
       <td align="center">
        <strong>
         解构赋值
        </strong>
       </td>
       <td align="center">
        需使用
        <code>
         toRefs
        </code>
        保持响应性
       </td>
       <td align="center">
        需保持
        <code>
         .value
        </code>
        引用
       </td>
      </tr>
      <tr>
       <td align="center">
        <strong>
         模板使用
        </strong>
       </td>
       <td align="center">
        直接使用属性（
        <code>
         state.name
        </code>
        ）
       </td>
       <td align="center">
        自动解包（无需
        <code>
         .value
        </code>
        ）
       </td>
      </tr>
     </tbody>
    </table>
    <h3>
     <a id="34_computed_303">
     </a>
     3.4
     <code>
      computed
     </code>
     计算属性
    </h3>
    <p>
     通过
     <code>
      computed
     </code>
     函数创建计算属性，支持两种形式：
    </p>
    <ul>
     <li>
      <p>
       <code>
        Getter
       </code>
       函数，只读
      </p>
     </li>
     <li>
      <p>
       对象形式，可读可写，含
       <code>
        get
       </code>
       和
       <code>
        set
       </code>
       方法
      </p>
      <pre><code class="prism language-js"><span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span> ref<span class="token punctuation">,</span> computed <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{<!-- --></span>
  <span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">const</span> count <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>

    <span class="token comment">// 1. 只读计算属性Getter</span>
    <span class="token keyword">const</span> doubleCount <span class="token operator">=</span> <span class="token function">computed</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> count<span class="token punctuation">.</span>value <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span>

    <span class="token comment">// 2. 可读写计算属性Getter + Setter</span>
    <span class="token keyword">const</span> writableCount <span class="token operator">=</span> <span class="token function">computed</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
      <span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> count<span class="token punctuation">.</span>value <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span>
      <span class="token function-variable function">set</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">val</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        count<span class="token punctuation">.</span>value <span class="token operator">=</span> val <span class="token operator">-</span> <span class="token number">1</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span> count<span class="token punctuation">,</span> doubleCount<span class="token punctuation">,</span> writableCount <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
      <pre><code class="prism language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>原始值: {<!-- -->{ count }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>只读计算值: {<!-- -->{ doubleCount }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>可写计算值: {<!-- -->{ writableCount }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>writableCount = 10<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>修改可写计算属性<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
</code></pre>
     </li>
    </ul>
    <p>
     <code>
      computed
     </code>
     与
     <code>
      ref
     </code>
     的区别如下：
    </p>
    <table>
     <thead>
      <tr>
       <th align="center">
        <strong>
         特性
        </strong>
       </th>
       <th align="center">
        <strong>
         <code>
          ref
         </code>
        </strong>
       </th>
       <th align="center">
        <strong>
         <code>
          computed
         </code>
        </strong>
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td align="center">
        数据来源
       </td>
       <td align="center">
        直接赋值
       </td>
       <td align="center">
        依赖其他响应式数据计算得出
       </td>
      </tr>
      <tr>
       <td align="center">
        缓存
       </td>
       <td align="center">
        无
       </td>
       <td align="center">
        有【依赖不变时复用缓存值】
       </td>
      </tr>
      <tr>
       <td align="center">
        可写性
       </td>
       <td align="center">
        可直接修改
        <code>
         .value
        </code>
       </td>
       <td align="center">
        默认只读，需配置
        <code>
         set
        </code>
        方法
       </td>
      </tr>
     </tbody>
    </table>
    <p>
     下面是一些计算属性的使用场景：
    </p>
    <ul>
     <li>
      <p>
       依赖多个数据源
      </p>
      <pre><code class="prism language-js"><span class="token keyword">const</span> firstName <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token string">'John'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> lastName <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token string">'Doe'</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> fullName <span class="token operator">=</span> <span class="token function">computed</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${<!-- --></span>firstName<span class="token punctuation">.</span>value<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${<!-- --></span>lastName<span class="token punctuation">.</span>value<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
</code></pre>
     </li>
     <li>
      <p>
       结合
       <code>
        reactive
       </code>
       对象
      </p>
      <pre><code class="prism language-js"><span class="token keyword">const</span> state <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
  <span class="token literal-property property">price</span><span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">,</span>
  <span class="token literal-property property">quantity</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
  <span class="token literal-property property">total</span><span class="token operator">:</span> <span class="token function">computed</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> state<span class="token punctuation">.</span>price <span class="token operator">*</span> state<span class="token punctuation">.</span>quantity<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
     </li>
     <li>
      <p>
       链式计算属性
      </p>
      <pre><code class="prism language-js"><span class="token keyword">const</span> discount <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token number">0.8</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> discountedTotal <span class="token operator">=</span> <span class="token function">computed</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> state<span class="token punctuation">.</span>total <span class="token operator">*</span> discount<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
</code></pre>
     </li>
    </ul>
    <p>
     对于
     <code>
      vue3
     </code>
     中的计算属性的使用，有以下注意点：
    </p>
    <ul>
     <li>
      <p>
       <strong>
        不要在计算属性内执行异步操作或副作用
       </strong>
       ，如修改
       <code>
        DOM
       </code>
       、发送请求。副作用应使用
       <code>
        watch
       </code>
       或
       <code>
        watchEffect
       </code>
       处理。
      </p>
     </li>
     <li>
      <p>
       确保计算函数
       <strong>
        轻量
       </strong>
       ，避免复杂计算。复杂逻辑可拆分为多个计算属性。如果计算属性依赖大量数据，考虑使用
       <code>
        computed
       </code>
       的缓存特性替代
       <code>
        method
       </code>
       。
      </p>
     </li>
     <li>
      <p>
       解构
       <code>
        reactive
       </code>
       对象中的计算属性会丢失响应性，需用
       <code>
        toRefs
       </code>
       。
      </p>
      <pre><code class="prism language-js"><span class="token keyword">const</span> state <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
  <span class="token literal-property property">count</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token literal-property property">double</span><span class="token operator">:</span> <span class="token function">computed</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> state<span class="token punctuation">.</span>count <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// ❌ 错误：解构后失去响应性</span>
<span class="token keyword">const</span> <span class="token punctuation">{<!-- --></span> double <span class="token punctuation">}</span> <span class="token operator">=</span> state

<span class="token comment">// ✅ 正确：保持响应性</span>
<span class="token keyword">const</span> <span class="token punctuation">{<!-- --></span> double <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">toRefs</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span>
</code></pre>
     </li>
    </ul>
    <h3>
     <a id="35_watch_410">
     </a>
     3.5
     <code>
      watch
     </code>
     监视
    </h3>
    <p>
     在
     <code>
      Vue 3
     </code>
     的
     <code>
      Composition API
     </code>
     中，
     <code>
      watch
     </code>
     函数用于观察响应式数据的变化并执行副作用操作，如异步请求、
     <code>
      DOM
     </code>
     操作等。语法结构如下：
    </p>
    <pre><code class="prism language-js"><span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span> watch <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>

<span class="token function">watch</span><span class="token punctuation">(</span>
  source<span class="token punctuation">,</span>              <span class="token comment">// 要监听的数据源 ref/reactive/getter/数组</span>
  callback<span class="token punctuation">,</span>            <span class="token comment">// 变化回调函数</span>
  options<span class="token operator">?</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>          <span class="token comment">// 可选的配置项</span>
    immediate<span class="token operator">?</span><span class="token operator">:</span> boolean<span class="token punctuation">,</span>
    deep<span class="token operator">?</span><span class="token operator">:</span> boolean<span class="token punctuation">,</span>
    flush<span class="token operator">?</span><span class="token operator">:</span> <span class="token string">'pre'</span> <span class="token operator">|</span> <span class="token string">'post'</span> <span class="token operator">|</span> <span class="token string">'sync'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span>
</code></pre>
    <table>
     <thead>
      <tr>
       <th align="center">
        <strong>
         选项
        </strong>
       </th>
       <th align="center">
        <strong>
         说明
        </strong>
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td align="center">
        <code>
         immediate
        </code>
       </td>
       <td align="center">
        是否立即执行回调，默认
        <code>
         false
        </code>
       </td>
      </tr>
      <tr>
       <td align="center">
        <code>
         deep
        </code>
       </td>
       <td align="center">
        是否深度监听对象/数组，默认
        <code>
         false
        </code>
       </td>
      </tr>
      <tr>
       <td align="center">
        <code>
         flush
        </code>
       </td>
       <td align="center">
        回调触发时机：
        <code>
         pre
        </code>
        ：组件更新前【默认】；
        <code>
         post
        </code>
        ：组件更新后 ；
        <code>
         sync
        </code>
        ：同步触发
       </td>
      </tr>
     </tbody>
    </table>
    <p>
     <code>
      watch
     </code>
     可以监听不同类型的数据源，如下：
    </p>
    <ul>
     <li>
      <p>
       基本数据类型
      </p>
      <pre><code class="prism language-js"><span class="token function">setup</span><span class="token punctuation">(</span><span class="token parameter">props<span class="token punctuation">,</span> context</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">const</span> count <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> str <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token string">'Hello Vue3'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token keyword">function</span> <span class="token function">increment</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        count<span class="token punctuation">.</span>value<span class="token operator">++</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      <span class="token keyword">function</span> <span class="token function">changePName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        person<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'Jerry'</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      <span class="token comment">// 监视单个基本数据类型</span>
      <span class="token function">watch</span><span class="token punctuation">(</span>count<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'count changed'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>

      <span class="token comment">// 监视多个基本数据类型</span>
      <span class="token function">watch</span><span class="token punctuation">(</span><span class="token punctuation">[</span>count<span class="token punctuation">,</span> str<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'count 或 str changed'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre>
     </li>
     <li>
      <p>
       对象数据类型
      </p>
      <ul>
       <li>
        <p>
         监听整个
         <code>
          reactive
         </code>
         对象，默认浅层监听。
        </p>
        <pre><code class="prism language-js"><span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span> reactive<span class="token punctuation">,</span> watch <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>

<span class="token keyword">const</span> state <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> 
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Alice'</span><span class="token punctuation">,</span> 
  <span class="token literal-property property">profile</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span> <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">25</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 浅层监听，只响应对象引用变化</span>
<span class="token function">watch</span><span class="token punctuation">(</span>
  state<span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token parameter">newVal<span class="token punctuation">,</span> oldVal</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'state 变化:'</span><span class="token punctuation">,</span> newVal<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span>

<span class="token comment">// ❌ 不会触发, 修改嵌套属性，对象引用未变</span>
state<span class="token punctuation">.</span>profile<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">30</span> 

<span class="token comment">// ✅ 触发（替换整个对象）</span>
state <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Bob'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> 
</code></pre>
       </li>
       <li>
        <p>
         深度监听嵌套属性，即
         <code>
          deep: true
         </code>
         。在该情况需要注意
         <code>
          newVal
         </code>
         和
         <code>
          oldVal
         </code>
         会指同一引用。
        </p>
        <pre><code class="prism language-js"><span class="token function">watch</span><span class="token punctuation">(</span>
  state<span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token parameter">newVal</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'深度监听:'</span><span class="token punctuation">,</span> newVal<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{<!-- --></span> <span class="token literal-property property">deep</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span> <span class="token comment">// 启用深度监听</span>
<span class="token punctuation">)</span>

<span class="token comment">// ✅ 触发 修改嵌套属性</span>
state<span class="token punctuation">.</span>profile<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">30</span> 
</code></pre>
       </li>
       <li>
        <p>
         监听特定属性
        </p>
        <ul>
         <li>
          <p>
           使用
           <code>
            getter
           </code>
           函数监听单个属性
          </p>
          <pre><code class="prism language-js"><span class="token function">watch</span><span class="token punctuation">(</span>
  <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> state<span class="token punctuation">.</span>name<span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token parameter">newName<span class="token punctuation">,</span> oldName</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'name变化:'</span><span class="token punctuation">,</span> oldName<span class="token punctuation">,</span> <span class="token string">'→'</span><span class="token punctuation">,</span> newName<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span>

<span class="token comment">// ✅ 触发</span>
state<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'Bob'</span> 
</code></pre>
         </li>
         <li>
          <p>
           监听嵌套对象属性
          </p>
          <pre><code class="prism language-js"><span class="token function">watch</span><span class="token punctuation">(</span>
  <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> state<span class="token punctuation">.</span>profile<span class="token punctuation">.</span>age<span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token parameter">newAge</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'age变化:'</span><span class="token punctuation">,</span> newAge<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span>

<span class="token comment">// ✅ 触发</span>
state<span class="token punctuation">.</span>profile<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">30</span> 
</code></pre>
         </li>
         <li>
          <p>
           监听多个属性，使用数组形式
          </p>
          <pre><code class="prism language-js"><span class="token function">watch</span><span class="token punctuation">(</span>
  <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> state<span class="token punctuation">.</span>name<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> state<span class="token punctuation">.</span>profile<span class="token punctuation">.</span>age<span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">[</span>newName<span class="token punctuation">,</span> newAge<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>oldName<span class="token punctuation">,</span> oldAge<span class="token punctuation">]</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">多个变化: name=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${<!-- --></span>oldName<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">→</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${<!-- --></span>newName<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">, age=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${<!-- --></span>oldAge<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">→</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${<!-- --></span>newAge<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span>
</code></pre>
         </li>
        </ul>
       </li>
      </ul>
     </li>
    </ul>
    <h3>
     <a id="36_watchEffect_548">
     </a>
     3.6
     <code>
      watchEffect
     </code>
     函数
    </h3>
    <p>
     在
     <code>
      Vue 3
     </code>
     的
     <code>
      Composition API
     </code>
     中，
     <code>
      watchEffect
     </code>
     是一个用于
     <strong>
      自动追踪依赖
     </strong>
     并执行副作用的函数。它的特点是无需显式声明依赖，而是通过回调函数内部实际使用的响应式数据自动收集依赖。语法结构如下：
    </p>
    <pre><code class="prism language-js"><span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span> watchEffect <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>

<span class="token keyword">const</span> stop <span class="token operator">=</span> <span class="token function">watchEffect</span><span class="token punctuation">(</span>
  <span class="token punctuation">(</span><span class="token parameter">onInvalidate</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 副作用逻辑（自动追踪依赖）</span>
    <span class="token comment">// onInvalidate: 注册清理函数（可选）</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{<!-- --></span>
    flush<span class="token operator">?</span><span class="token operator">:</span> <span class="token string">'pre'</span> <span class="token operator">|</span> <span class="token string">'post'</span> <span class="token operator">|</span> <span class="token string">'sync'</span><span class="token punctuation">,</span> <span class="token comment">// 回调执行时机</span>
    onTrack<span class="token operator">?</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">,</span>        <span class="token comment">// 调试依赖追踪</span>
    onTrigger<span class="token operator">?</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span>       <span class="token comment">// 调试依赖触发</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span>

<span class="token comment">// 手动停止监听</span>
<span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
    <p>
     其核心特性如下：
    </p>
    <ul>
     <li>
      自动依赖收集：
      <code>
       watchEffect
      </code>
      会自动追踪回调函数内部使用到的响应式数据。当依赖的数据变化时，回调函数会重新执行。
     </li>
     <li>
      立即执行：默认在初始化时立即执行一次回调，类似
      <code>
       watch
      </code>
      的
      <code>
       immediate: true
      </code>
      。
     </li>
     <li>
      无新旧值：回调函数不提供新旧值参数，仅关注当前值。
     </li>
    </ul>
    <table>
     <thead>
      <tr>
       <th align="center">
        <strong>
         特性
        </strong>
       </th>
       <th align="center">
        <strong>
         <code>
          watchEffect
         </code>
        </strong>
       </th>
       <th align="center">
        <strong>
         <code>
          watch
         </code>
        </strong>
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td align="center">
        依赖声明
       </td>
       <td align="center">
        自动收集回调内的依赖
       </td>
       <td align="center">
        显式声明数据源
       </td>
      </tr>
      <tr>
       <td align="center">
        初始执行
       </td>
       <td align="center">
        立即执行
       </td>
       <td align="center">
        需配置
        <code>
         immediate: true
        </code>
       </td>
      </tr>
      <tr>
       <td align="center">
        新旧值
       </td>
       <td align="center">
        无
       </td>
       <td align="center">
        提供
        <code>
         newVal
        </code>
        和
        <code>
         oldVal
        </code>
       </td>
      </tr>
      <tr>
       <td align="center">
        适用场景
       </td>
       <td align="center">
        依赖复杂或需要立即执行的副作用
       </td>
       <td align="center">
        需要精确控制监听源和访问旧值时
       </td>
      </tr>
     </tbody>
    </table>
    <h3>
     <a id="37_Vue3_590">
     </a>
     3.7
     <code>
      Vue3
     </code>
     生命周期
    </h3>
    <p>
     首先是
     <code>
      Option API
     </code>
     钩子，如下：
    </p>
    <table>
     <thead>
      <tr>
       <th align="center">
        钩子函数
       </th>
       <th align="center">
        执行阶段
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td align="center">
        <code>
         beforeCreate
        </code>
       </td>
       <td align="center">
        组件实例初始化前【数据观测和事件配置未完成】
       </td>
      </tr>
      <tr>
       <td align="center">
        <code>
         created
        </code>
       </td>
       <td align="center">
        组件实例初始化完成【数据观测完成，但
        <code>
         DOM
        </code>
        未生成】
       </td>
      </tr>
      <tr>
       <td align="center">
        <code>
         beforeMount
        </code>
       </td>
       <td align="center">
        组件挂载到
        <code>
         DOM
        </code>
        前
       </td>
      </tr>
      <tr>
       <td align="center">
        <code>
         mounted
        </code>
       </td>
       <td align="center">
        组件挂载到
        <code>
         DOM
        </code>
        后【可访问
        <code>
         DOM
        </code>
        元素】
       </td>
      </tr>
      <tr>
       <td align="center">
        <code>
         beforeUpdate
        </code>
       </td>
       <td align="center">
        响应式数据变化，
        <code>
         DOM
        </code>
        重新渲染前
       </td>
      </tr>
      <tr>
       <td align="center">
        <code>
         updated
        </code>
       </td>
       <td align="center">
        响应式数据变化，
        <code>
         DOM
        </code>
        重新渲染后
       </td>
      </tr>
      <tr>
       <td align="center">
        <code>
         beforeUnmount
        </code>
       </td>
       <td align="center">
        组件卸载前【替代 Vue 2 的
        <code>
         beforeDestroy
        </code>
        】
       </td>
      </tr>
      <tr>
       <td align="center">
        <code>
         unmounted
        </code>
       </td>
       <td align="center">
        组件卸载后【替代 Vue 2 的
        <code>
         destroyed
        </code>
        】
       </td>
      </tr>
      <tr>
       <td align="center">
        <code>
         errorCaptured
        </code>
       </td>
       <td align="center">
        捕获子孙组件错误时触发
       </td>
      </tr>
      <tr>
       <td align="center">
        <code>
         renderTracked
        </code>
       </td>
       <td align="center">
        渲染函数依赖的响应式数据被追踪时触发【开发模式调试用】
       </td>
      </tr>
      <tr>
       <td align="center">
        <code>
         renderTriggered
        </code>
       </td>
       <td align="center">
        渲染函数依赖的响应式数据触发重新渲染时【开发模式调试用】
       </td>
      </tr>
     </tbody>
    </table>
    <p>
     上述钩子使用配置项，符合
     <code>
      Vue2
     </code>
     风格，在
     <code>
      Vue3
     </code>
     中，推荐使用
     <code>
      Composition API
     </code>
     ，如下：：
    </p>
    <table>
     <thead>
      <tr>
       <th align="center">
        钩子函数
       </th>
       <th align="center">
        对应 Options API 钩子
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td align="center">
        <code>
         onBeforeMount
        </code>
       </td>
       <td align="center">
        <code>
         beforeMount
        </code>
       </td>
      </tr>
      <tr>
       <td align="center">
        <code>
         onMounted
        </code>
       </td>
       <td align="center">
        <code>
         mounted
        </code>
       </td>
      </tr>
      <tr>
       <td align="center">
        <code>
         onBeforeUpdate
        </code>
       </td>
       <td align="center">
        <code>
         beforeUpdate
        </code>
       </td>
      </tr>
      <tr>
       <td align="center">
        <code>
         onUpdated
        </code>
       </td>
       <td align="center">
        <code>
         updated
        </code>
       </td>
      </tr>
      <tr>
       <td align="center">
        <code>
         onBeforeUnmount
        </code>
       </td>
       <td align="center">
        <code>
         beforeUnmount
        </code>
       </td>
      </tr>
      <tr>
       <td align="center">
        <code>
         onUnmounted
        </code>
       </td>
       <td align="center">
        <code>
         unmounted
        </code>
       </td>
      </tr>
      <tr>
       <td align="center">
        <code>
         onErrorCaptured
        </code>
       </td>
       <td align="center">
        <code>
         errorCaptured
        </code>
       </td>
      </tr>
      <tr>
       <td align="center">
        <code>
         onRenderTracked
        </code>
       </td>
       <td align="center">
        <code>
         renderTracked
        </code>
       </td>
      </tr>
      <tr>
       <td align="center">
        <code>
         onRenderTriggered
        </code>
       </td>
       <td align="center">
        <code>
         renderTriggered
        </code>
       </td>
      </tr>
     </tbody>
    </table>
    <p>
     生命周期执行流程图如下：同时使用
     <code>
      Option API
     </code>
     钩子和
     <code>
      Composition API
     </code>
     优先使用
     <code>
      Composition API
     </code>
     。
    </p>
    <pre><code class="prism language-text">父组件 setup → 父组件 beforeCreate → 父组件 created → 父组件 beforeMount
  ↓
子组件 setup → 子组件 beforeCreate → 子组件 created → 子组件 beforeMount → 子组件 mounted
  ↓
父组件 mounted → 父组件 beforeUpdate → 子组件 beforeUpdate → 子组件 updated → 父组件 updated
  ↓
父组件 beforeUnmount → 子组件 beforeUnmount → 子组件 unmounted → 父组件 unmounted
</code></pre>
    <p>
     在
     <code>
      setup()
     </code>
     函数中，通过
     <code>
      onXxx
     </code>
     函数注册生命周期钩子，如下：
    </p>
    <pre><code class="prism language-js"><span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span> onMounted<span class="token punctuation">,</span> onUpdated <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{<!-- --></span>
  <span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 挂载后操作</span>
    <span class="token function">onMounted</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
      <span class="token comment">// 异步请求推荐位置</span>
      <span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">'https://api.example.com/data'</span><span class="token punctuation">)</span>
      data<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token keyword">await</span> response<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        
      timer<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
      	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'定时器运行中...'</span><span class="token punctuation">)</span>
    	<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token comment">// 更新后操作</span>
    <span class="token function">onUpdated</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
      <span class="token function">clearInterval</span><span class="token punctuation">(</span>timer<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <h3>
     <a id="38_hook_664">
     </a>
     3.8 自定义
     <code>
      hook
     </code>
    </h3>
    <p>
     组合式函数是一个普通
     <code>
      JavaScript
     </code>
     函数，内部使用
     <code>
      Vue
     </code>
     的
     <code>
      Composition API
     </code>
     ，如
     <code>
      ref
     </code>
     ,
     <code>
      reactive
     </code>
     ，
     <code>
      watch
     </code>
     等的封装逻辑。命名通常以
     <code>
      use
     </code>
     开头，如
     <code>
      useFetch
     </code>
     ,
     <code>
      useMouse
     </code>
     ，以便代码可读性。与
     <code>
      Mixins
     </code>
     对比如下：
    </p>
    <table>
     <thead>
      <tr>
       <th align="center">
        <strong>
         特性
        </strong>
       </th>
       <th align="center">
        <strong>
         组合式函数
        </strong>
       </th>
       <th align="center">
        <strong>
         <code>
          Mixins
         </code>
        </strong>
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td align="center">
        逻辑复用方式
       </td>
       <td align="center">
        函数调用，显式暴露状态和方法
       </td>
       <td align="center">
        隐式合并到组件选项对象中
       </td>
      </tr>
      <tr>
       <td align="center">
        命名冲突
       </td>
       <td align="center">
        无【通过解构命名控制】
       </td>
       <td align="center">
        容易发生【需手动处理】
       </td>
      </tr>
      <tr>
       <td align="center">
        类型支持
       </td>
       <td align="center">
        天然支持
        <code>
         TypeScript
        </code>
       </td>
       <td align="center">
        类型推断困难
       </td>
      </tr>
      <tr>
       <td align="center">
        代码组织
       </td>
       <td align="center">
        按功能组织，代码集中
       </td>
       <td align="center">
        分散在多个选项中
       </td>
      </tr>
     </tbody>
    </table>
    <p>
     从上述介绍不难看出，自定义
     <code>
      hook
     </code>
     就是将
     <code>
      setup
     </code>
     中的
     <code>
      Composition API
     </code>
     进行了封装，以提高代码复用率。通常建立一个
     <code>
      hooks
     </code>
     文件夹，在里面存放自己的
     <code>
      hook
     </code>
     。如下面封装一个获取鼠标位置的
     <code>
      hook
     </code>
     ：
    </p>
    <pre><code class="prism language-js"><span class="token comment">// hooks/useMouse.js</span>
<span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span> ref<span class="token punctuation">,</span> onMounted<span class="token punctuation">,</span> onUnmounted <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">useMouse</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">const</span> x <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> y <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>

  <span class="token keyword">const</span> <span class="token function-variable function">update</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    x<span class="token punctuation">.</span>value <span class="token operator">=</span> event<span class="token punctuation">.</span>pageX
    y<span class="token punctuation">.</span>value <span class="token operator">=</span> event<span class="token punctuation">.</span>pageY
  <span class="token punctuation">}</span>

  <span class="token function">onMounted</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'mousemove'</span><span class="token punctuation">,</span> update<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token function">onUnmounted</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> window<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span><span class="token string">'mousemove'</span><span class="token punctuation">,</span> update<span class="token punctuation">)</span><span class="token punctuation">)</span>

  <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span> x<span class="token punctuation">,</span> y <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <pre><code class="prism language-js"><span class="token comment">// 在组件中使用</span>
<span class="token operator">&lt;</span>script setup<span class="token operator">&gt;</span>
<span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span> useMouse <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./useMouse'</span>

<span class="token comment">// 调用组合式函数，解构响应式状态</span>
<span class="token keyword">const</span> <span class="token punctuation">{<!-- --></span> x<span class="token punctuation">,</span> y <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useMouse</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>鼠标位置：<span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span> x <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span> y <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
</code></pre>
    <h3>
     <a id="39_toReftoRefs_715">
     </a>
     3.9
     <code>
      toRef
     </code>
     与
     <code>
      toRefs
     </code>
    </h3>
    <p>
     在
     <code>
      Vue 3
     </code>
     中，
     <code>
      toRef
     </code>
     和
     <code>
      toRefs
     </code>
     是用于处理响应式对象属性的工具函数，它们的主要作用是将响应式对象的属性转换为
     <code>
      ref
     </code>
     对象，以保持响应性。它们的核心区别如下：
    </p>
    <table>
     <thead>
      <tr>
       <th align="center">
        <strong>
         特性
        </strong>
       </th>
       <th align="center">
        <strong>
         <code>
          toRef
         </code>
        </strong>
       </th>
       <th align="center">
        <strong>
         <code>
          toRefs
         </code>
        </strong>
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td align="center">
        作用对象
       </td>
       <td align="center">
        响应式对象的
        <strong>
         单个属性
        </strong>
       </td>
       <td align="center">
        响应式对象的
        <strong>
         所有属性
        </strong>
       </td>
      </tr>
      <tr>
       <td align="center">
        返回值
       </td>
       <td align="center">
        单个
        <code>
         ref
        </code>
        对象
       </td>
       <td align="center">
        包含所有属性的
        <code>
         ref
        </code>
        对象的普通对象
       </td>
      </tr>
      <tr>
       <td align="center">
        适用场景
       </td>
       <td align="center">
        需要保留对某个属性的响应式引用
       </td>
       <td align="center">
        结构整个响应式对象，保持所有属性的响应性
       </td>
      </tr>
      <tr>
       <td align="center">
        是否处理不存在属性
       </td>
       <td align="center">
        可为不存在的属性创建
        <code>
         ref
        </code>
        【需谨慎】
       </td>
       <td align="center">
        仅处理对象已存在的属性
       </td>
      </tr>
     </tbody>
    </table>
    <ul>
     <li>
      <p>
       <code>
        toRef
       </code>
       的使用：将响应式对象的某个属性转换为
       <code>
        ref
       </code>
       。
      </p>
      <pre><code class="prism language-js"><span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span> reactive<span class="token punctuation">,</span> toRef <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>

<span class="token keyword">const</span> state <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Alice'</span><span class="token punctuation">,</span> <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">30</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> nameRef <span class="token operator">=</span> <span class="token function">toRef</span><span class="token punctuation">(</span>state<span class="token punctuation">,</span> <span class="token string">'name'</span><span class="token punctuation">)</span>

<span class="token comment">// 修改 ref 会同步到原对象</span>
nameRef<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token string">'Bob'</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>state<span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token comment">// 输出: 'Bob'</span>
</code></pre>
      <pre><code class="prism language-js"><span class="token comment">// 处理不存在的属性：若属性不存在，toRef 会创建一个可写的 ref，但不会自动添加到原对象</span>

<span class="token keyword">const</span> state <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Alice'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> ageRef <span class="token operator">=</span> <span class="token function">toRef</span><span class="token punctuation">(</span>state<span class="token punctuation">,</span> <span class="token string">'age'</span><span class="token punctuation">)</span> <span class="token comment">// 原对象无 age 属性</span>

<span class="token comment">// 修改 ref 的 value</span>
ageRef<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token number">30</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>state<span class="token punctuation">.</span>age<span class="token punctuation">)</span> <span class="token comment">// 输出: undefined 原对象未添加该属性</span>
</code></pre>
     </li>
     <li>
      <p>
       <code>
        toRefs
       </code>
       的使用：将响应式对象的所有属性转换为
       <code>
        ref
       </code>
       。
      </p>
      <pre><code class="prism language-js"><span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span> reactive<span class="token punctuation">,</span> toRefs <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>

<span class="token keyword">const</span> state <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Alice'</span><span class="token punctuation">,</span> <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">30</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> stateRefs <span class="token operator">=</span> <span class="token function">toRefs</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span>

<span class="token comment">// 结构后仍保持响应性</span>
<span class="token keyword">const</span> <span class="token punctuation">{<!-- --></span> name<span class="token punctuation">,</span> age <span class="token punctuation">}</span> <span class="token operator">=</span> stateRefs
name<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token string">'Bob'</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>state<span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token comment">// 输出: 'Bob'</span>
</code></pre>
      <pre><code class="prism language-js"><span class="token comment">// 处理嵌套对象</span>
<span class="token keyword">const</span> state <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> <span class="token literal-property property">info</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span> <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">30</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> stateRefs <span class="token operator">=</span> <span class="token function">toRefs</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span>

<span class="token comment">// stateRefs.info 是 ref，其 value 是响应式对象</span>
stateRefs<span class="token punctuation">.</span>info<span class="token punctuation">.</span>value<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">31</span> <span class="token comment">// 响应式更新</span>
</code></pre>
     </li>
    </ul>
    <p>
     那么什么时候使用
     <code>
      toRef
     </code>
     ，什么时候使用
     <code>
      toRefs
     </code>
     呢？
    </p>
    <ul>
     <li>
      单属性引用 →
      <code>
       toRef
      </code>
     </li>
     <li>
      多属性结构 →
      <code>
       toRefs
      </code>
     </li>
    </ul>
    <h2>
     <a id="4_Composition_API_784">
     </a>
     4. 其它
     <code>
      Composition API
     </code>
    </h2>
    <h3>
     <a id="41_shallowReactiveshallowRef_786">
     </a>
     4.1
     <code>
      shallowReactive
     </code>
     与
     <code>
      shallowRef
     </code>
    </h3>
    <p>
     在
     <code>
      Vue
     </code>
     3 中，
     <code>
      shallowReactive
     </code>
     和
     <code>
      shallowRef
     </code>
     是用于浅层响应式处理的 API，适用于需要优化性能的场景。它们与标准
     <code>
      reactive
     </code>
     和
     <code>
      ref
     </code>
     的关键区别在于仅对顶层数据做响应式处理，不递归追踪深层对象的变化。
    </p>
    <ul>
     <li>
      <p>
       <code>
        shallowReactive
       </code>
       ：只对对象的第一层属性进行响应式处理，嵌套对象保持原始类型。当使用数据量大的对象，且仅需监听顶层字段变化的场景如配置对象、表单控件集合时使用。若需要响应嵌套对象的变化，需手动替换整个嵌套对象。
      </p>
      <pre><code class="prism language-js"><span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span> shallowReactive<span class="token punctuation">,</span> watchEffect <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>

<span class="token keyword">const</span> state <span class="token operator">=</span> <span class="token function">shallowReactive</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Alice'</span><span class="token punctuation">,</span>      <span class="token comment">// 响应式（顶层属性）</span>
  <span class="token literal-property property">profile</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>          <span class="token comment">// ❌ 非响应式（嵌套对象）</span>
    <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">25</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 监听顶层属性变化</span>
<span class="token function">watchEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'名字变化:'</span><span class="token punctuation">,</span> state<span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token comment">// ✅ 触发</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 监听嵌套属性变化</span>
<span class="token function">watchEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'年龄变化:'</span><span class="token punctuation">,</span> state<span class="token punctuation">.</span>profile<span class="token punctuation">.</span>age<span class="token punctuation">)</span> <span class="token comment">// ❌ 不触发</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 修改顶层属性 → 触发响应</span>
state<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'Bob'</span>

<span class="token comment">// 修改嵌套属性 → 不触发响应</span>
state<span class="token punctuation">.</span>profile<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">30</span>
</code></pre>
     </li>
     <li>
      <p>
       <code>
        shallowRef
       </code>
       ：只处理基本数据类型的响应式，不进行对象的响应式处理。适合场景为存储大型对象，如
       <code>
        DOM
       </code>
       元素、复杂数据结构，避免深度响应式开销
       <code>
        ||
       </code>
       需要整体替换值的场景，如分页数据更新。
      </p>
      <pre><code class="prism language-js"><span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span> shallowRef<span class="token punctuation">,</span> watchEffect <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>

<span class="token comment">// 存储一个对象</span>
<span class="token keyword">const</span> userRef <span class="token operator">=</span> <span class="token function">shallowRef</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Alice'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">profile</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span> <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">25</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 监听整个 .value 变化</span>
<span class="token function">watchEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'用户变化:'</span><span class="token punctuation">,</span> userRef<span class="token punctuation">.</span>value<span class="token punctuation">)</span> <span class="token comment">// ✅ 触发（当 userRef.value 被替换时）</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 监听嵌套属性变化</span>
<span class="token function">watchEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'年龄变化:'</span><span class="token punctuation">,</span> userRef<span class="token punctuation">.</span>value<span class="token punctuation">.</span>profile<span class="token punctuation">.</span>age<span class="token punctuation">)</span> <span class="token comment">// ❌ 不触发</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 修改嵌套属性 → 不触发响应</span>
userRef<span class="token punctuation">.</span>value<span class="token punctuation">.</span>profile<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">30</span>

<span class="token comment">// 替换整个值 → 触发响应</span>
userRef<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Bob'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">profile</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span> <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">30</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
     </li>
    </ul>
    <h3>
     <a id="42_readonlyshallowReadonly_852">
     </a>
     4.2
     <code>
      readonly
     </code>
     和
     <code>
      shallowReadonly
     </code>
    </h3>
    <p>
     在
     <code>
      Vue 3
     </code>
     中，
     <code>
      readonly
     </code>
     和
     <code>
      shallowReadonly
     </code>
     是用于创建
     <strong>
      只读响应式对象
     </strong>
     的工具，适用于需要保护数据不被意外修改的场景，如传递
     <code>
      props
     </code>
     、状态管理等。以下是它们的详细用法和区别：
    </p>
    <ul>
     <li>
      <p>
       <code>
        readonly
       </code>
       ：递归地将整个对象及其嵌套属性变为只读。依然是响应式对象，但不可修改。
      </p>
      <pre><code class="prism language-js"><span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span> reactive<span class="token punctuation">,</span> readonly<span class="token punctuation">,</span> watchEffect <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>

<span class="token keyword">const</span> original <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> 
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Alice'</span><span class="token punctuation">,</span> 
  <span class="token literal-property property">profile</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span> <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">25</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> readOnlyObj <span class="token operator">=</span> <span class="token function">readonly</span><span class="token punctuation">(</span>original<span class="token punctuation">)</span>

<span class="token comment">// 尝试修改会触发警告（开发环境下）且操作无效</span>
readOnlyObj<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'Bob'</span>          <span class="token comment">// ❌ 失败</span>
readOnlyObj<span class="token punctuation">.</span>profile<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">30</span>      <span class="token comment">// ❌ 失败</span>

<span class="token comment">// 监听只读对象变化（仍会响应原始对象的修改）</span>
<span class="token function">watchEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'只读对象的值:'</span><span class="token punctuation">,</span> readOnlyObj<span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token comment">// 原始对象修改时触发</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 修改原始对象 → 只读对象同步更新</span>
original<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'Bob'</span>             <span class="token comment">// ✅ watchEffect 会触发</span>
</code></pre>
     </li>
     <li>
      <p>
       <code>
        shallowReadonly
       </code>
       ：仅将对象的
       <strong>
        顶层属性
       </strong>
       变为只读，嵌套对象仍可变。顶层属性不可修改，但嵌套对象保持原始响应性。
      </p>
      <pre><code class="prism language-js"><span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span> reactive<span class="token punctuation">,</span> shallowReadonly <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>

<span class="token keyword">const</span> original <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> 
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Alice'</span><span class="token punctuation">,</span> 
  <span class="token literal-property property">profile</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span> <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">25</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> shallowReadOnlyObj <span class="token operator">=</span> <span class="token function">shallowReadonly</span><span class="token punctuation">(</span>original<span class="token punctuation">)</span>

<span class="token comment">// 修改顶层属性 → 失败</span>
shallowReadOnlyObj<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'Bob'</span>   <span class="token comment">// ❌ 失败</span>

<span class="token comment">// 修改嵌套属性 → 成功</span>
shallowReadOnlyObj<span class="token punctuation">.</span>profile<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">30</span> <span class="token comment">// ✅ 成功</span>
</code></pre>
     </li>
    </ul>
    <h3>
     <a id="43_toRawmarkRaw_904">
     </a>
     4.3
     <code>
      toRaw
     </code>
     和
     <code>
      markRaw
     </code>
    </h3>
    <p>
     在
     <code>
      Vue 3
     </code>
     中，
     <code>
      toRaw
     </code>
     和
     <code>
      markRaw
     </code>
     是用于处理响应式对象和原始对象的工具函数，适用于需要绕过响应式系统或优化性能的场景。以下是它们的详细用法和核心区别：
    </p>
    <ul>
     <li>
      <p>
       <code>
        toRaw
       </code>
       ：返回由
       <code>
        reactive
       </code>
       、
       <code>
        readonly
       </code>
       等
       <code>
        API
       </code>
       创建的响应式对象的原始非响应式对象。用于直接操作原始对象，避免响应式追踪的开销，如一次性批量修改数据。
      </p>
      <pre><code class="prism language-js"><span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span> reactive<span class="token punctuation">,</span> toRaw <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>

<span class="token keyword">const</span> reactiveObj <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Alice'</span><span class="token punctuation">,</span> <span class="token literal-property property">profile</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span> <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">25</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> rawObj <span class="token operator">=</span> <span class="token function">toRaw</span><span class="token punctuation">(</span>reactiveObj<span class="token punctuation">)</span>

<span class="token comment">// 修改原始对象 → 不会触发响应式更新</span>
rawObj<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'Bob'</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>reactiveObj<span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token comment">// 输出: 'Bob'（数据已改，但不会触发视图更新）</span>

<span class="token comment">// 响应式对象仍可触发更新</span>
reactiveObj<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'Charlie'</span> <span class="token comment">// ✅ 触发响应式更新</span>
</code></pre>
      <pre><code class="prism language-js"><span class="token keyword">const</span> rawData <span class="token operator">=</span> <span class="token function">toRaw</span><span class="token punctuation">(</span>reactiveData<span class="token punctuation">)</span>
rawData<span class="token punctuation">.</span>items<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token operator">...</span>newItems<span class="token punctuation">)</span> <span class="token comment">// 避免多次触发更新</span>
<span class="token comment">// 手动触发更新（如强制重新渲染）</span>
<span class="token function">triggerRef</span><span class="token punctuation">(</span>reactiveData<span class="token punctuation">)</span>
</code></pre>
     </li>
     <li>
      <p>
       <code>
        makeRaw
       </code>
       ：标记一个对象，使其永远不会被转换为响应式对象。避免
       <code>
        Vue
       </code>
       对大型对象或第三方实例进行不必要的响应式处理。
      </p>
      <pre><code class="prism language-js"><span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span> reactive<span class="token punctuation">,</span> markRaw <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>

<span class="token comment">// 标记对象为原始</span>
<span class="token keyword">const</span> staticData <span class="token operator">=</span> <span class="token function">markRaw</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> 
  <span class="token literal-property property">config</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span> <span class="token literal-property property">theme</span><span class="token operator">:</span> <span class="token string">'dark'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> 
  <span class="token literal-property property">methods</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span> <span class="token comment">/* 复杂方法 */</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 即使被包裹在响应式对象中，staticData 仍保持原始</span>
<span class="token keyword">const</span> state <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
  staticData<span class="token punctuation">,</span> <span class="token comment">// ❌ 不会被代理</span>
  <span class="token literal-property property">dynamicData</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span> <span class="token literal-property property">count</span><span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span> <span class="token comment">// ✅ 会被代理</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 修改 staticData 的嵌套属性 → 不会触发响应式</span>
state<span class="token punctuation">.</span>staticData<span class="token punctuation">.</span>config<span class="token punctuation">.</span>theme <span class="token operator">=</span> <span class="token string">'light'</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>state<span class="token punctuation">.</span>staticData<span class="token punctuation">.</span>config<span class="token punctuation">.</span>theme<span class="token punctuation">)</span> <span class="token comment">// 'light'（数据已改，但无响应式）</span>
</code></pre>
     </li>
    </ul>
    <table>
     <thead>
      <tr>
       <th align="center">
        <strong>
         特性
        </strong>
       </th>
       <th align="center">
        <strong>
         <code>
          toRaw
         </code>
        </strong>
       </th>
       <th align="center">
        <strong>
         <code>
          markRaw
         </code>
        </strong>
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td align="center">
        作用对象
       </td>
       <td align="center">
        响应式对象，如
        <code>
         reactive
        </code>
        、
        <code>
         ref
        </code>
       </td>
       <td align="center">
        任何对象
       </td>
      </tr>
      <tr>
       <td align="center">
        返回值
       </td>
       <td align="center">
        原始对象
       </td>
       <td align="center">
        被标记的原始对象
       </td>
      </tr>
      <tr>
       <td align="center">
        修改原始对象的影响
       </td>
       <td align="center">
        响应式对象数据同步更新，但
        <strong>
         不触发响应式追踪
        </strong>
       </td>
       <td align="center">
        对象永远不会被 Vue 代理
       </td>
      </tr>
      <tr>
       <td align="center">
        适用场景
       </td>
       <td align="center">
        临时操作原始数据
       </td>
       <td align="center">
        永久禁止对象被响应式处理
       </td>
      </tr>
     </tbody>
    </table>
    <h3>
     <a id="44_customRef_964">
     </a>
     4.4
     <code>
      customRef
     </code>
    </h3>
    <p>
     在
     <code>
      Vue 3
     </code>
     中，
     <code>
      customRef
     </code>
     允许开发者创建自定义的响应式引用
     <code>
      ref
     </code>
     ，通过手动控制依赖追踪
     <code>
      track
     </code>
     和更新触发
     <code>
      trigger
     </code>
     ，适用于需要精细控制响应式行为的场景，如防抖、异步操作等。
     <code>
      customRef
     </code>
     接收一个工厂函数，该函数需返回包含
     <code>
      get
     </code>
     和
     <code>
      set
     </code>
     方法的对象：
    </p>
    <ul>
     <li>
      <p>
       <strong>
        <code>
         get()
        </code>
       </strong>
       ：在访问值时调用，需手动调用
       <code>
        track()
       </code>
       追踪依赖。
      </p>
     </li>
     <li>
      <p>
       <strong>
        <code>
         set(newValue)
        </code>
       </strong>
       ：在修改值时调用，需手动调用
       <code>
        trigger()
       </code>
       触发更新。
      </p>
      <pre><code class="prism language-js"><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>input v<span class="token operator">-</span>model<span class="token operator">=</span><span class="token string">"text"</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>Debounced Value<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span> text <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script setup<span class="token operator">&gt;</span>
<span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span> customRef <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>

<span class="token keyword">function</span> <span class="token function">debouncedRef</span><span class="token punctuation">(</span><span class="token parameter">value<span class="token punctuation">,</span> delay <span class="token operator">=</span> <span class="token number">200</span></span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">let</span> timeout
  <span class="token keyword">return</span> <span class="token function">customRef</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">track<span class="token punctuation">,</span> trigger</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
    <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token function">track</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token keyword">return</span> value
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">set</span><span class="token punctuation">(</span>newValue<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token function">clearTimeout</span><span class="token punctuation">(</span>timeout<span class="token punctuation">)</span>
      timeout <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        value <span class="token operator">=</span> newValue
        <span class="token function">trigger</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span> delay<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> text <span class="token operator">=</span> <span class="token function">debouncedRef</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre>
     </li>
    </ul>
    <p>
     在实际开发中，有以下使用场景：
    </p>
    <ul>
     <li>
      <p>
       防抖
       <code>
        Ref
       </code>
       ：创建一个防抖 Ref，延迟触发更新。
      </p>
      <pre><code class="prism language-js"><span class="token keyword">function</span> <span class="token function">debouncedRef</span><span class="token punctuation">(</span><span class="token parameter">initialValue<span class="token punctuation">,</span> delay <span class="token operator">=</span> <span class="token number">200</span></span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">let</span> timeout
  <span class="token keyword">return</span> <span class="token function">customRef</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">track<span class="token punctuation">,</span> trigger</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span>
      <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token function">track</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> initialValue
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token function">set</span><span class="token punctuation">(</span>newValue<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token function">clearTimeout</span><span class="token punctuation">(</span>timeout<span class="token punctuation">)</span>
        timeout <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
          initialValue <span class="token operator">=</span> newValue
          <span class="token function">trigger</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 延迟触发更新</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> delay<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 使用</span>
<span class="token keyword">const</span> text <span class="token operator">=</span> <span class="token function">debouncedRef</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span>
</code></pre>
     </li>
     <li>
      <p>
       异步数据
       <code>
        Ref
       </code>
       ：在设置值时执行异步操作，完成后触发更新。
      </p>
      <pre><code class="prism language-js"><span class="token keyword">function</span> <span class="token function">asyncRef</span><span class="token punctuation">(</span><span class="token parameter">initialValue</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">return</span> <span class="token function">customRef</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">track<span class="token punctuation">,</span> trigger</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">let</span> value <span class="token operator">=</span> initialValue
    <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span>
      <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token function">track</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> value
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token keyword">async</span> <span class="token function">set</span><span class="token punctuation">(</span>newValue<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
          <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetchData</span><span class="token punctuation">(</span>newValue<span class="token punctuation">)</span> <span class="token comment">// 假设异步请求</span>
          value <span class="token operator">=</span> result
          <span class="token function">trigger</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
          console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'请求失败:'</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 使用</span>
<span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token function">asyncRef</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span>
</code></pre>
     </li>
    </ul>
    <p>
     <code>
      customRef
     </code>
     适用于需要手动控制响应式行为的场景，如防抖、异步更新、集成第三方库等。
    </p>
    <h3>
     <a id="45_provideinject_1070">
     </a>
     4.5
     <code>
      provide
     </code>
     与
     <code>
      inject
     </code>
    </h3>
    <p>
     在
     <code>
      Vue 3
     </code>
     中，
     <code>
      provide
     </code>
     和
     <code>
      inject
     </code>
     用于实现跨组件层级的数据传递，尤其适合祖先组件与深层嵌套的后代组件之间的通信。以下是详细的使用指南和最佳实践：
    </p>
    <ul>
     <li>
      <p>
       <code>
        provide
       </code>
       ：父组件提供数据，在祖先组件的
       <code>
        setup
       </code>
       函数中，使用
       <code>
        provide
       </code>
       提供数据。
      </p>
      <pre><code class="prism language-js"><span class="token comment">// ParentComponent.vue</span>
<span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span> provide<span class="token punctuation">,</span> ref <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{<!-- --></span>
  <span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">const</span> message <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token string">'Hello from parent'</span><span class="token punctuation">)</span>
    <span class="token function">provide</span><span class="token punctuation">(</span><span class="token string">'message'</span><span class="token punctuation">,</span> message<span class="token punctuation">)</span> <span class="token comment">// 提供响应式数据</span>
    <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span> message <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
     </li>
     <li>
      <p>
       <code>
        inject
       </code>
       ：子组件注入数据，在后代组件的
       <code>
        setup
       </code>
       函数中，使用
       <code>
        inject
       </code>
       获取数据。
      </p>
      <pre><code class="prism language-js"><span class="token comment">// ChildComponent.vue</span>
<span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span> inject <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{<!-- --></span>
  <span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">const</span> message <span class="token operator">=</span> <span class="token function">inject</span><span class="token punctuation">(</span><span class="token string">'message'</span><span class="token punctuation">,</span> <span class="token string">'默认值'</span><span class="token punctuation">)</span> <span class="token comment">// 注入数据，可设置默认值</span>
    <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span> message <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
     </li>
    </ul>
    <p>
     当然，也可以实现响应式数据传递，如下：：
    </p>
    <ul>
     <li>
      <p>
       提供响应式数据：确保提供的数据是响应式【
       <code>
        ref
       </code>
       或
       <code>
        reactive
       </code>
       】，以便子组件能检测到变化。
      </p>
      <pre><code class="prism language-js"><span class="token comment">// ParentComponent.vue</span>
<span class="token keyword">const</span> count <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token function">provide</span><span class="token punctuation">(</span><span class="token string">'count'</span><span class="token punctuation">,</span> count<span class="token punctuation">)</span>
</code></pre>
     </li>
     <li>
      <p>
       在子组件中修改数据：若需子组件修改数据，可在父组件中提供方法。
      </p>
      <pre><code class="prism language-js"><span class="token comment">// ParentComponent.vue</span>
<span class="token keyword">const</span> <span class="token function-variable function">increment</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> count<span class="token punctuation">.</span>value<span class="token operator">++</span>
<span class="token function">provide</span><span class="token punctuation">(</span><span class="token string">'count'</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span> count<span class="token punctuation">,</span> increment <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
      <pre><code class="prism language-js"><span class="token comment">// ChildComponent.vue</span>
<span class="token keyword">const</span> <span class="token punctuation">{<!-- --></span> count<span class="token punctuation">,</span> increment <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">inject</span><span class="token punctuation">(</span><span class="token string">'count'</span><span class="token punctuation">)</span>
</code></pre>
     </li>
    </ul>
    <p>
     对于上述两个
     <code>
      API
     </code>
     的使用，需要注意以下问题：
    </p>
    <ul>
     <li>
      <p>
       响应式数据必须显式提供：若提供非响应式数据，子组件无法检测变化。
      </p>
      <pre><code class="prism language-js"><span class="token function">provide</span><span class="token punctuation">(</span><span class="token string">'staticData'</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span> <span class="token literal-property property">key</span><span class="token operator">:</span> <span class="token string">'value'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment">// ❌ 非响应式</span>
<span class="token function">provide</span><span class="token punctuation">(</span><span class="token string">'dynamicData'</span><span class="token punctuation">,</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> <span class="token literal-property property">key</span><span class="token operator">:</span> <span class="token string">'value'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// ✅ 响应式</span>
</code></pre>
     </li>
     <li>
      <p>
       单向数据流：避免子组件直接修改注入的响应式数据，除非父组件明确允许。
      </p>
      <pre><code class="prism language-js"><span class="token comment">// ParentComponent.vue</span>
<span class="token function">provide</span><span class="token punctuation">(</span><span class="token string">'data'</span><span class="token punctuation">,</span> <span class="token function">readonly</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 使用 readonly 保护数据</span>
</code></pre>
     </li>
    </ul>
    <h3>
     <a id="46__1148">
     </a>
     4.6 响应式数据的判断
    </h3>
    <ul>
     <li>
      <code>
       isRef
      </code>
      ：检查一个值是否为一个
      <code>
       Ref
      </code>
      对象。
     </li>
     <li>
      <code>
       isReactive
      </code>
      ：检查一个值是否由
      <code>
       reactive
      </code>
      创建的响应式代理。
     </li>
     <li>
      <code>
       isReadonly
      </code>
      ：检查一个对象是否由
      <code>
       readonly
      </code>
      创建的只读代理。
     </li>
     <li>
      <code>
       isProxy
      </code>
      ：检查一个对象是否由
      <code>
       reactive
      </code>
      或
      <code>
       readonly
      </code>
      方法创建的代理。
     </li>
    </ul>
    <h2>
     <a id="5_Fragment_1157">
     </a>
     5.
     <code>
      Fragment
     </code>
     组件
    </h2>
    <p>
     在
     <code>
      Vue 3
     </code>
     中，
     <code>
      Fragment
     </code>
     片段是一项重要的新特性，允许组件模板包含多个根节点而无需包裹在一个父容器中。
    </p>
    <pre><code class="prism language-js"><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 合法模板（Vue <span class="token number">3</span>） <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>h1<span class="token operator">&gt;</span>标题<span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>p<span class="token operator">&gt;</span>内容<span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>button<span class="token operator">&gt;</span>按钮<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
</code></pre>
    <h2>
     <a id="6_Teleport_1172">
     </a>
     6.
     <code>
      Teleport
     </code>
     组件
    </h2>
    <p>
     在
     <code>
      Vue 3
     </code>
     中，
     <code>
      &lt;Teleport&gt;
     </code>
     组件用于将模板内容渲染到
     <code>
      DOM
     </code>
     中的指定位置，常用于解决组件层级导致的样式或布局问题，如模态框、全局通知等。基础用法用法如下：
    </p>
    <ul>
     <li>
      <p>
       定义目标容器：在
       <code>
        HTML
       </code>
       中添加目标容器，通常位于根节点附近。
      </p>
      <pre><code class="prism language-js"><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> <span class="token keyword">public</span><span class="token operator">/</span>index<span class="token punctuation">.</span>html <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>body<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>div id<span class="token operator">=</span><span class="token string">"app"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>div id<span class="token operator">=</span><span class="token string">"modal-container"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span> <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> Teleport 目标容器 <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>body<span class="token operator">&gt;</span>
</code></pre>
     </li>
     <li>
      <p>
       在组件中使用
       <code>
        &lt;Teleport&gt;
       </code>
       。
      </p>
      <pre><code class="prism language-js"><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> MyComponent<span class="token punctuation">.</span>vue <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>button @click<span class="token operator">=</span><span class="token string">"showModal = true"</span><span class="token operator">&gt;</span>打开模态框<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>

  <span class="token operator">&lt;</span>Teleport to<span class="token operator">=</span><span class="token string">"#modal-container"</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>div v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">"showModal"</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"modal"</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>h2<span class="token operator">&gt;</span>标题<span class="token operator">&lt;</span><span class="token operator">/</span>h2<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>p<span class="token operator">&gt;</span>内容<span class="token operator">...</span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>button @click<span class="token operator">=</span><span class="token string">"showModal = false"</span><span class="token operator">&gt;</span>关闭<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>Teleport<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script setup<span class="token operator">&gt;</span>
<span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span> ref <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">const</span> showModal <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre>
     </li>
    </ul>
    <p>
     动态目标与禁用撞状态：
    </p>
    <ul>
     <li>
      <p>
       动态切换目标容器
      </p>
      <pre><code class="prism language-js"><span class="token operator">&lt;</span>Teleport <span class="token operator">:</span>to<span class="token operator">=</span><span class="token string">"isMobile ? '#mobile-modal' : '#desktop-modal'"</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 内容 <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>Teleport<span class="token operator">&gt;</span>
</code></pre>
     </li>
     <li>
      <p>
       禁用
       <code>
        Teleport
       </code>
       ：通过
       <code>
        :disabled
       </code>
       控制内容是否保留在原位置。
      </p>
      <pre><code class="prism language-js"><span class="token operator">&lt;</span>Teleport to<span class="token operator">=</span><span class="token string">"#modal-container"</span> <span class="token operator">:</span>disabled<span class="token operator">=</span><span class="token string">"forceInline"</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 当 forceInline 为 <span class="token boolean">true</span> 时，内容不传送 <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>Teleport<span class="token operator">&gt;</span>
</code></pre>
     </li>
    </ul>
    <p>
     与
     <code>
      Transition
     </code>
     组件结合使用：
    </p>
    <pre><code class="prism language-js"><span class="token operator">&lt;</span>Teleport to<span class="token operator">=</span><span class="token string">"#modal-container"</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>Transition name<span class="token operator">=</span><span class="token string">"fade"</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>div v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">"showModal"</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"modal"</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 内容 <span class="token operator">--</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>Transition<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>Teleport<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>style<span class="token operator">&gt;</span>
<span class="token punctuation">.</span>fade<span class="token operator">-</span>enter<span class="token operator">-</span>active<span class="token punctuation">,</span> <span class="token punctuation">.</span>fade<span class="token operator">-</span>leave<span class="token operator">-</span>active <span class="token punctuation">{<!-- --></span>
  <span class="token literal-property property">transition</span><span class="token operator">:</span> opacity <span class="token number">0</span><span class="token punctuation">.</span>3s<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>fade<span class="token operator">-</span>enter<span class="token operator">-</span>from<span class="token punctuation">,</span> <span class="token punctuation">.</span>fade<span class="token operator">-</span>leave<span class="token operator">-</span>to <span class="token punctuation">{<!-- --></span>
  <span class="token literal-property property">opacity</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span>
</code></pre>
    <p>
     多内容传送与顺序：多个 Teleport 内容按代码顺序渲染到目标容器。
    </p>
    <pre><code class="prism language-js"><span class="token operator">&lt;</span>Teleport to<span class="token operator">=</span><span class="token string">"#notifications"</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"notification"</span><span class="token operator">&gt;</span>通知 <span class="token number">1</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>Teleport<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>Teleport to<span class="token operator">=</span><span class="token string">"#notifications"</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"notification"</span><span class="token operator">&gt;</span>通知 <span class="token number">2</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>Teleport<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 目标容器显示顺序：通知 <span class="token number">1</span> → 通知 <span class="token number">2</span> <span class="token operator">--</span><span class="token operator">&gt;</span>
</code></pre>
    <h2>
     <a id="7_Suspense_1269">
     </a>
     7.
     <code>
      Suspense
     </code>
     组件
    </h2>
    <p>
     在
     <code>
      Vue 3
     </code>
     中，
     <code>
      &lt;Suspense&gt;
     </code>
     组件用于优雅地处理异步组件或异步数据的加载状态，允许开发者定义加载中和加载完成后的展示内容。以下是其详细使用指南和常见场景示例：
    </p>
    <ul>
     <li>
      <p>
       基础用法：当加载异步组件时，展示加载状态。
      </p>
      <pre><code class="prism language-js"><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>Suspense<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 默认插槽：异步组件 <span class="token operator">--</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>template #<span class="token keyword">default</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>AsyncComponent <span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 加载中状态 <span class="token operator">--</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>template #fallback<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>加载中<span class="token operator">...</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>Suspense<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script setup<span class="token operator">&gt;</span>
<span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span> defineAsyncComponent <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>

<span class="token comment">// 定义异步组件（返回 Promise）</span>
<span class="token keyword">const</span> AsyncComponent <span class="token operator">=</span> <span class="token function">defineAsyncComponent</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
  <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'./AsyncComponent.vue'</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre>
     </li>
     <li>
      <p>
       处理异步数据：在组件
       <code>
        setup
       </code>
       中使用
       <code>
        async
       </code>
       函数处理异步数据。
      </p>
      <pre><code class="prism language-js"><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>Suspense<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>template #<span class="token keyword">default</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>UserProfile <span class="token operator">:</span>user<span class="token operator">=</span><span class="token string">"userData"</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>template #fallback<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>加载用户数据<span class="token operator">...</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>Suspense<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script setup<span class="token operator">&gt;</span>
<span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span> ref <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>

<span class="token keyword">const</span> userData <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span>

<span class="token comment">// 异步获取数据（setup 函数支持 async）</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">fetchUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">'/api/user'</span><span class="token punctuation">)</span>
  userData<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token keyword">await</span> response<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">await</span> <span class="token function">fetchUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 等待数据加载完成</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre>
     </li>
     <li>
      <p>
       错误处理
      </p>
      <ul>
       <li>
        <p>
         捕获异步错误：使用
         <code>
          onErrorCaptured
         </code>
         钩子捕获错误并显示友好提示。
        </p>
        <pre><code class="prism language-js"><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>div v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">"error"</span><span class="token operator">&gt;</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span> error<span class="token punctuation">.</span>message <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>Suspense v<span class="token operator">-</span><span class="token keyword">else</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>template #<span class="token keyword">default</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>AsyncComponent <span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>template #fallback<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>加载中<span class="token operator">...</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>Suspense<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script setup<span class="token operator">&gt;</span>
<span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span> ref<span class="token punctuation">,</span> onErrorCaptured <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>

<span class="token keyword">const</span> error <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span>

<span class="token function">onErrorCaptured</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
  error<span class="token punctuation">.</span>value <span class="token operator">=</span> err
  <span class="token keyword">return</span> <span class="token boolean">false</span> <span class="token comment">// 阻止错误继续向上传播</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre>
       </li>
       <li>
        <p>
         重试机制：允许用户点击重试加载。
        </p>
        <pre><code class="prism language-js"><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>div v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">"error"</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>p<span class="token operator">&gt;</span>加载失败：<span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span> error<span class="token punctuation">.</span>message <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>button @click<span class="token operator">=</span><span class="token string">"retry"</span><span class="token operator">&gt;</span>重试<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>Suspense v<span class="token operator">-</span><span class="token keyword">else</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> <span class="token operator">...</span> <span class="token operator">--</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>Suspense<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script setup<span class="token operator">&gt;</span>
<span class="token keyword">const</span> error <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token function-variable function">retry</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
  error<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token keyword">null</span>
  <span class="token comment">// 重新执行异步操作（如重新加载组件或数据）</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre>
       </li>
       <li>
        <p>
         动态切换异步组件：结合动态组件
         <code>
          &lt;component :is="..."&gt;
         </code>
         实现按需加载。
        </p>
        <pre><code class="prism language-js"><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>button @click<span class="token operator">=</span><span class="token string">"toggleComponent"</span><span class="token operator">&gt;</span>切换组件<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>Suspense<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>template #<span class="token keyword">default</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>component <span class="token operator">:</span>is<span class="token operator">=</span><span class="token string">"currentComponent"</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>template #fallback<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>加载组件中<span class="token operator">...</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>Suspense<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script setup<span class="token operator">&gt;</span>
<span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span> ref<span class="token punctuation">,</span> defineAsyncComponent <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>

<span class="token keyword">const</span> components <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
  <span class="token constant">A</span><span class="token operator">:</span> <span class="token function">defineAsyncComponent</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'./ComponentA.vue'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token constant">B</span><span class="token operator">:</span> <span class="token function">defineAsyncComponent</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'./ComponentB.vue'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> currentComponent <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token string">'A'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token function-variable function">toggleComponent</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
  currentComponent<span class="token punctuation">.</span>value <span class="token operator">=</span> currentComponent<span class="token punctuation">.</span>value <span class="token operator">===</span> <span class="token string">'A'</span> <span class="token operator">?</span> <span class="token string">'B'</span> <span class="token operator">:</span> <span class="token string">'A'</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre>
       </li>
      </ul>
     </li>
    </ul>
    <h2>
     <a id="8_Vue3_1412">
     </a>
     8.
     <code>
      Vue3
     </code>
     中的其它变化
    </h2>
    <p>
     在
     <code>
      Vue3
     </code>
     中，因为
     <code>
      Vue
     </code>
     不能使用，将原来的全局
     <code>
      API
     </code>
     转移到了应用实例
     <code>
      app
     </code>
     上，如下：
    </p>
    <table>
     <thead>
      <tr>
       <th align="center">
        2.X全局API
       </th>
       <th align="center">
        3.X全局API
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td align="center">
        <code>
         Vue.config.xxx
        </code>
       </td>
       <td align="center">
        <code>
         app.config.xxx
        </code>
       </td>
      </tr>
      <tr>
       <td align="center">
        <code>
         Vue.config.productionTip
        </code>
       </td>
       <td align="center">
        移除
       </td>
      </tr>
      <tr>
       <td align="center">
        <code>
         Vue.component
        </code>
       </td>
       <td align="center">
        <code>
         app.component
        </code>
       </td>
      </tr>
      <tr>
       <td align="center">
        <code>
         Vue.directive
        </code>
       </td>
       <td align="center">
        <code>
         app.directive
        </code>
       </td>
      </tr>
      <tr>
       <td align="center">
        <code>
         Vue.mixin
        </code>
       </td>
       <td align="center">
        <code>
         app.mixin
        </code>
       </td>
      </tr>
      <tr>
       <td align="center">
        <code>
         Vue.use
        </code>
       </td>
       <td align="center">
        <code>
         app.use
        </code>
       </td>
      </tr>
      <tr>
       <td align="center">
        <code>
         Vue.prototype
        </code>
       </td>
       <td align="center">
        <code>
         app.config.globalProperties
        </code>
       </td>
      </tr>
     </tbody>
    </table>
    <p>
     除了上述全局
     <code>
      API
     </code>
     的转移，还有以下改变：
    </p>
    <ul>
     <li>
      <p>
       <code>
        data
       </code>
       选项始终被声明为一个函数。
      </p>
     </li>
     <li>
      <p>
       过度类名的更改
      </p>
      <table>
       <thead>
        <tr>
         <th align="center">
          Vue 2 类名
         </th>
         <th align="center">
          Vue 3 类名
         </th>
         <th align="center">
          说明
         </th>
        </tr>
       </thead>
       <tbody>
        <tr>
         <td align="center">
          <code>
           .v-enter
          </code>
         </td>
         <td align="center">
          <code>
           .v-enter-from
          </code>
         </td>
         <td align="center">
          进入动画的初始状态
         </td>
        </tr>
        <tr>
         <td align="center">
          <code>
           .v-leave
          </code>
         </td>
         <td align="center">
          <code>
           .v-leave-from
          </code>
         </td>
         <td align="center">
          离开动画的初始状态
         </td>
        </tr>
        <tr>
         <td align="center">
          <code>
           .v-enter-to
          </code>
         </td>
         <td align="center">
          <strong>
           无变化
          </strong>
         </td>
         <td align="center">
          进入动画的结束状态
         </td>
        </tr>
        <tr>
         <td align="center">
          <code>
           .v-leave-to
          </code>
         </td>
         <td align="center">
          <strong>
           无变化
          </strong>
         </td>
         <td align="center">
          离开动画的结束状态
         </td>
        </tr>
        <tr>
         <td align="center">
          <code>
           .v-enter-active
          </code>
         </td>
         <td align="center">
          <strong>
           无变化
          </strong>
         </td>
         <td align="center">
          进入动画的激活状态（过渡属性）
         </td>
        </tr>
        <tr>
         <td align="center">
          <code>
           .v-leave-active
          </code>
         </td>
         <td align="center">
          <strong>
           无变化
          </strong>
         </td>
         <td align="center">
          离开动画的激活状态
         </td>
        </tr>
       </tbody>
      </table>
     </li>
     <li>
      <p>
       移除
       <code>
        keyCode
       </code>
       作为
       <code>
        v-on
       </code>
       的修饰符，同时也不再支持
       <code>
        config.keyCodes
       </code>
       。
      </p>
     </li>
     <li>
      <p>
       移除
       <code>
        v-on.native
       </code>
       修饰符。
      </p>
     </li>
     <li>
      <p>
       移除过滤器
       <code>
        filter
       </code>
      </p>
     </li>
     <li>
      <p>
       <code>
        ......
       </code>
      </p>
     </li>
    </ul>
   </div>
   <link href="./../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="./../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f672e:6373646e2e6e65742f77656978696e5f37343039303737312f:61727469636c652f64657461696c732f313436313836353730" class_="artid" style="display:none">
 </p>
</div>


