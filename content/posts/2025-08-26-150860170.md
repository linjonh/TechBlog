---
layout: post
title: "2-5-倍性能提升,30-成本降低,阿里云-SelectDB-存算分离架构助力波司登集团实现降本增效"
date: 2025-08-26T18:10:29+0800
description: "波司登集团作为全球领先的羽绒服公司，每年的销售旺季集中在四个月间，需高效把握业务机遇以实现高营收。为满足集团销售旺季的实时数据分析需求，同时降低淡季数据分析成本，波司登决定升级大数据架构，"
keywords: "2-5 倍性能提升，30% 成本降低，阿里云 SelectDB 存算分离架构助力波司登集团实现降本增效"
categories: ['未分类']
tags: ['波司登', '数据库', '数据分析', '实时数仓', '存算分离']
artid: "150860170"
arturl: "https://blog.csdn.net/SelectDB_Fly/article/details/150860170"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=150860170
    alt: "2-5-倍性能提升,30-成本降低,阿里云-SelectDB-存算分离架构助力波司登集团实现降本增效"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=150860170
featuredImagePreview: https://bing.ee123.net/img/rand?artid=150860170
cover: https://bing.ee123.net/img/rand?artid=150860170
image: https://bing.ee123.net/img/rand?artid=150860170
img: https://bing.ee123.net/img/rand?artid=150860170
---



# 2-5 倍性能提升，30% 成本降低，阿里云 SelectDB 存算分离架构助力波司登集团实现降本增效

波司登集团作为全球领先的羽绒服公司，每年的销售旺季集中在四个月间，需高效把握业务机遇以实现高营收。为满足集团销售旺季的实时数据分析需求，同时降低淡季数据分析成本，波司登决定升级大数据架构，**采用阿里云数据库 SelectDB 版升级数仓，基于阿里云 SelectDB 云原生存算分离架构，实现了资源隔离与弹性扩缩容，并取得了查询性能提升 2-5 倍、总体成本降低 30% 以上、效率提升 30% 的可观收益。**

### 业务需求

波司登集团自 1976 年创立以来，专注羽绒服制造领域已有 48 年，产品畅销全球 72 个国家。2021 年，波司登羽绒服销售规模达到全球领先，并且在 2023 年实现全年营收 232.14 亿元，同比增长 38.4%。近年来，波司登集团通过数据驱动的精细化运营，成功从 “羽绒服专家” 转型为 “多品类功能性服饰巨头”，**其数据分析业务覆盖门店运营、电商平台、用户运营等多个环节。**

* 门店运营：波司登门店规模目前已超过 3500 家，运营注重精细化及高效化 **。门店数据分析服务须具备高并发与低延迟能力 **，以应对节假日、新品发布、促销及寒潮期间的销售高峰期，实时监控库存与销售数据，快速调整销售策略与促销活动，基于单门店坪效和区域消费偏好，优化商品陈列及库存分配；
* 电商平台：波司登电商平台覆盖天猫、京东、抖音等主流平台，粉丝总量超 5000 万。由于线上促销活动频繁（如季节上新、节日大促），电商平台流量波动显著高于线下门店，数据分析服务需在具备高并发与低延迟能力的同时，**具备弹性扩展能力，根据流量高峰与低谷灵活配置不同规模计算资源，以支持实时调整活动策略与管理库存；**
* 用户运营：波司登用户运营聚焦精准化与个性化，**数据分析服务需支持人群圈选，通过用户年龄、消费频次、偏好等标签划分细分市场。** 结合 CRM 系统和大数据分析，实现会员生命周期管理（如休眠用户唤醒、高价值用户专属权益），并针对不同群体设计差异化活动（如向年轻用户推送联名款，向高净值客户推荐高端系列）。

为满足上述业务场景并驱动集团发展，**波司登将数据分析需求分为以下四类：**

1. **实时报表：** 建立上百张实时报表，覆盖线下门店库存管理、电商平台数据监控、供应链生产需求管理及物流配送优化等核心业务场景，确保业务部门能够实时掌握关键数据，快速响应市场变化；
2. **离线报表：** 离线报表为业务部门提供线下门店、线上各渠道基础运营分析，涵盖销售、库存、营销等维度的周报、月报和年报，帮助业务部门了解业务表现并制定长期策略；
3. **人群圈选：** 通过用户年龄、消费频次、偏好等多维度标签，精确划分市场。并针对不同群体设计差异化活动，帮助实现精准营销；
4. **即席查询：** 为内部专业的数据分析师提供自助式数据获取能力。支持对门店、物流、工厂等数据进行长周期的关联分析及深度下钻，挖掘业务洞察，辅助决策优化。

### 早期架构痛点

* 波司登集团原数据架构

  ![波司登集团原数据架构.png](https://i-blog.csdnimg.cn/img_convert/7069d082dbdb1f7f6fb6b700d0dd1dcd.png)

为支撑上述数据分析需求，研发与数据管理部门分别部署了 Apache Doris、PostgreSQL、StarRocks 等多个分析引擎。其中 Apache Doris 主要用于复杂业务逻辑的实时分析查询，PostgreSQL 主要用于简单业务逻辑的实时分析查询，StarRocks 则用于离线数据的 BI 报表分析和人群圈选业务。

**该架构存在以下问题：**

* 架构复杂、冗余存储：多分析引擎会存储多份数据，造成存储与计算资源冗余；
* 稳定性不足、性能受限：为满足时效需求，复杂报表有时直接在业务库中查询以提高数据时效性，但会为在线业务系统带来风险，影响其他重要业务稳定性。此外，复杂查询占用大量机器资源，性能受限，且因多个业务查询负载不同，需多独立计算组隔离资源，数据共享需多次跨计算组流转查询，导致效率较低；
* 不支持弹性扩缩容：存算一体模式在弹性扩容方面存在不足，导致扩缩容代价高昂，难以适应业务高峰和低谷期的差异。

为解决以上问题，波司登决定全面升级现有架构，统一分析引擎，引入存算分离新架构，完成新一代大数据平台和数仓升级建设。**基于实际业务场景，波司登明确了以下升级需求：**

* 新架构需支持高并发点查询，在海量并发读写实时报表场景下响应稳定，平均 RT 要求毫秒级别，以满足人群圈选业务与 VIP 报表查询需求，为业务高效运转提供支撑；
* 新架构需支持复杂 SQL 查询，在满足 10 并发的情况下秒级返回，以满足实时和离线报表高并发查询需求；
* 新架构需支持业务之间资源隔离，避免业务间相互影响。并需要拥有集群快速扩缩容能力，确保在高并发或大数据量处理时灵活配置资源，保持高性能和稳定性；

经过多款产品测试对比，波司登发现阿里云 SelectDB 能够支撑高并发点查询，实现秒级查询响应，并具备资源隔离能力，完全满足业务需求。利用阿里云 SelectDB 存算分离架构及快速弹性扩缩容特性，可实现按需付费，有效降低成本。最终，波司登决定基于阿里云 SelectDB 升级 OLAP 分析平台。

### 基于阿里云 SelectDB 升级 OLAP 平台

* 波司登集团基于阿里云 SelectDB 升级后的数据架构

  ![ 波司登集团基于阿里云 SelectDB 升级后的数据架构.png](https://i-blog.csdnimg.cn/img_convert/eda3bdb0e8f5d29a63c6fd2e410be18b.png)

波司登将原架构查询引擎与计算引擎统一升级为阿里云 SelectDB，替换原先架构中 Apache Doris、Starrocks、PostgreSQL 等其他技术栈，**并将原有的存算一体架构升级为存算分离架构。**

* 阿里云 SelectDB 技术架构图

  ![基于阿里云 SelectDB 升级 OLAP 平台-2.png](https://i-blog.csdnimg.cn/img_convert/2ef4059c9262536f7d3407484acf2f60.png)

波司登集团升级后的数据架构基于阿里云运行，无需自行搭建并维护复杂的数据平台，而是由阿里云负责底层基础设施管理与维护，在运维方面降低了成本。

阿里云 SelectDB 存算分离架构能够根据波司登淡季、旺季不同规模的业务需求，灵活配置计算资源规模，迅速适应业务变化。同时，该架构支持不同业务在共享数据时，实现计算资源的有效隔离，兼具稳定性与高效率。

充分利用云上多样化存储介质，阿里云 SelectDB 将数据直接存储到成本较低的 OSS 对象存储中，在降低资源成本的同时，显著增强的数据的高可用性。此外，针对热数据，也会将其缓存至成本相对较高的 SSD 存储中，确保热数据查询的极速响应。

此外，作为阿里云生态系统的一员，阿里云 SelectDB 能够无缝集成阿里云其他产品与服务，这不仅简化了波司登的数据管理和分析的流程，同时提升了业务处理的效率。

#### 数据流转方案

在基于阿里云 SelectDB 的新架构中，波司登数据链路分为实时与离线两条链路。

* 实时数据链路分为两条路径：
  + 大规模实时报表场景主要采用 Debezium 采集源端数据，它能同时捕获上百张表。作为 Kafka Connector Source，Debezium 将业务数据写入至 Kafka。随后，Doris Kafka Connector 作为 Sink Connector，将数据从 Kafka 写入 SelectDB，此过程支持上百张表同时产生和消费数据， 并支持多 Topic 并行，实现了数据链路的统一管理和统一监控；
  + 中小规模实时场景主要采用 Flink SQL 采集源端数据，后通过 Doris Flink Connector 消费数据写入到 SelectDB，Doris Flink Connector 支持攒批与 Checkpoint 模式，实现快速开发、数据实时入库与分析查询。
* 离线数据链路则专注于 T+N 数据处理，处理后的数据存储于 MaxCompute 中， Dataphin 以全量或增量方式通过 Stream Load 将数据写入阿里云 SelectDB 。在数据导入期间通过配置血缘关系，在合适的时机触发异步物化视图刷新，用于提升查询性能。

#### 如何实现资源隔离？

假设下午 6 点，波司登全国门店正在盘点当日库存与营业额，与此同时，数据分析师正在进行一项任务：分析近一年销量及购买人群数据。该任务涉及海量历史与实时数据，直接占用了数据库 80% 资源。**由于该大规模数据分析任务与门店的日常运营查询需要查询同一张营销记录表，共享同一数据库资源，** 导致该数据库资源紧张，全国门店查询请求变慢堆积，最终造成数据库崩溃，长时间无法服务。

通过上述场景可知，同一份业务数据会被多场景分析业务调用，各业务数据存在交叉，为避免业务之间互相影响，确保业务独立、稳定运行，实现资源隔离至关重要。

**阿里云 SelectDB 存算分离架构帮助波司登实现了灵活且有效的资源隔离。** 数据存储于具有高可用机制和强 LSA 能力的阿里云 OSS 中，确保数据可靠性。计算节点仅负责缓存区数据存储，并通过标签机制将查询和导入划分到不同的计算组中。具体来说，每个计算节点均会被打上标签，具有相同标签的计算节点会被归入同一组。通过该机制，不同业务可以隔离运行在不同组中，从而实现资源的硬隔离。

**波司登通过阿里云控制台，一键购买部署数据仓库，并设计了涵盖四个物理隔离的计算组的资源隔离方案：**

* 实时报表计算组：该计算组主要提供全国门店和各部门实时营销数据分析，对查询和导入的时效性要求极高，所以单独划分计算组使用；
* BI 计算组：波司登将大部分离线加工作业和异步物化视图刷新作业运行在单个较大的计算组中，该计算组称为 BI 计算组，避免过多拆分造成资源浪费。该计算组主要用于夜间离线 T+N 数据导入、异步物化视图计算、人群圈选计算、BI 报表分析。该方案既保障了夜间数据加工资源充足，又避免了工作时间占用资源最多的 BI 报表分析影响其他报表稳定性；
* 离线报表计算组：该计算组较小，用于直接查询 BI 计算组加工后的数据，避免多份存储造成冗余浪费；
* 人群圈选计算组：由于圈选计算运行在资源较多的 BI 计算组中，该计算组仅用于查询结果，因此，该计算组同样较小。该种运行方式既可提高人群圈选计算的效率，又不影响圈选业务日常查询。

波司登资源隔离方案通过四个大小不一的物理隔离计算组，合理配置资源，有效提升查询性能，确保各业务场景高效、稳定运行。

#### 如何实现快速扩缩容？

阿里云 SelectDB 支持计算资源的弹性伸缩，可以根据工作负载的高低峰运行时段、作业执行规律，灵活配置不同规模的计算资源。

* 阿里云 SelectDB 计算资源弹性伸缩

  ![ 阿里云 SelectDB 计算资源弹性伸缩.png](https://i-blog.csdnimg.cn/img_convert/d69244b1906c56890fb16d4dd475266e.png)

阿里云 SelectDB 计算节点与数据之间并未强一致绑定，当波司登业务进入旺季需要扩容，或进入淡季需要缩容时，系统仅需通过 FE 的元数据动态映射即可完成扩缩容。扩缩容时间主要取决于计算节点启动时间，**借助阿里云 SelectDB 产品与阿里云瑶池平台资源池能力，能够实现快速分配资源，快速启动计算节点，从而实现分钟级别业务无感知高效扩缩容，确保在高并发或大数据量处理时灵活配置资源，保持高性能和稳定性，满足了波司登对于集群快速扩缩容能力的需求，实现按需付费，从而带来了数据分析成本的降低。**

### 迁移方案

* 波司登基于阿里云 SelectDB 的实时数仓迁移方案

  ![ 波司登基于阿里云 SelectDB 的实时数仓迁移方案.png](https://i-blog.csdnimg.cn/img_convert/bd25c89b3a40b12b2fe56aa57407f161.png)

波司登数据迁移采用 Kafka 与 Flink 进行实时同步，采用阿里 Dataphin 与 MaxCompute 进行离线跑批，最终数据汇入阿里云 SelectDB 。针对原 AP 库存量迁移工作，波司登采用 X2Doris、Catalog、Dataphin、DTS 等工具完成。

**[X2Doris 是一款功能强大的数据迁移工具](https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fdocs.selectdb.com%2Fdocs%2Fecosystem%2Fx2doris%2Fx2doris-deployment-guide "X2Doris 是一款功能强大的数据迁移工具")，专为将数据便捷地迁移到 Apache Doris 和 SelectDB 而设计。**集自动建表和数据迁移为一体，性能优异，简单易用，显著简化了波司登将数据从 Apache Doris 和 Starrocks 迁移至阿里云 SelectDB 的工作量。

**迁移过程中，波司登采用以下策略确保迁移工作高效进行：**

* 迁移前期，波司登采用 X2Doris 进行库表结构全量同步。将 Apache Doris 和 Starrocks 中的主键表默认选择从 Merge On Read 模式调整为 Merge On Write 模式，以提高查询性能。库表结构同步完成后，调通 Kafka Doris Connector 和 SelectDB 的数据链路。
* 数据迁移时，波司登暂停 Kafka Doris Connector，通过 X2Doris 和 Catalog 完成数据全量同步，随后重启 Kafka Doris Connector，确保数据完整的同时，高效推进迁移进程。
* 离线跑批迁移分为调度任务迁移和数据迁移。历史数据迁移借助 Catalog，可轻松迁移多种数据库。完成历史数据初始化后，波司登着手进行调度任务迁移，将数据源的目标库统一更换为阿里云 SelectDB，在此过程中，波司登合并了同一张表的多个任务，以优化迁移效率。

在数据迁移过程中，由于历史数据冗余，单表常分散存储，波司登面临表合并的挑战。合并时，出现了字段和类型冲突。为此，波司登与阿里云、飞轮科技合作，在应对表存储在多个源库的情况时，通过设计一张报表，每日校对多个源库和阿里云 SelectDB 的表数据量差异，根据差异清单，检查每张表对应的数据流任务，逐步消灭掉所有数据量不一致的情况，最终成功完成了升级。

### 应用收益

波司登集团完成基于阿里云 SelectDB OLAP 分析平台的优化升级后，取得了以下关键收益：

* 性能提升 2-5 倍：中小查询、大查询、拖拉拽、下载性能均大幅提升；
  + 中小查询：2000 QPS 小查询，阿里云 SelectDB 平均响应时间低于 20 ms。142 QPS 中等查询，平均响应时间为 8 ms。相较原数据架构，性能提升 2-5 倍；
  + 大查询：在数千行复杂 SQL 报表查询场景中，原架构单并发执行需数分钟甚至失败。替换阿里云 SelectDB 后，性能大幅提升，单并发降至毫秒级，10 并发秒级完成；
  + 拖拉拽：在即席查询场景中，分析师通过拖拉拽方式自由关联各系统数据。由于该场景资源消耗较大，阿里云 SelectDB 部署了配置较高的集群，实现 21 并发多资源组稳定秒级响应；
  + 下载：在实时报表和离线报表场景中，针对 2 GB 文件的导出耗时优化至 43.8 s；
* 总体成本降低 30% 以上：数据库、存储成本均大幅降低；
  + 数据库成本降低 30%：阿里云 SelectDB 作为 SaaS 产品，凭借云原生存算分离、弹性伸缩等特性，使波司登实现按需付费，业务旺季资源消耗大时费用高，而淡季消耗小则费用低。此外，阿里云 SelectDB 统一了分析引擎，总体为波司登节省了 30% 数据库成本；
  + 存储成本降低 61%：阿里云 SelectDB 采用单副本存储，相比传统数据库三副本存储，资源存储成本更低。存储成本理论降低 2/3，实测节省 61%；
* 效率提升 30% 以上：数据流完成简化，运维人员排班需求减少，效率提升；
  + 数据流完成简化：统一表结构与单数据源策略，调度任务数量削减 30%；
  + 运维效率提升 36%：多分析引擎需要多名工程师进行维护，原先旺季需要多名工程师通宵支持。升级后，波司登完成了集群 SaaS 化，具备了高可用特性，减少了集群维护、升级停服的时间，降低了业务风险。目前旺季仅需 1-2 人值守，晚上 9 点 30 左右即可结束工作，大幅削减了通宵排班需求，运维效率显著提升。

**展望未来，波司登将深入推进阿里云 SelectDB 在集团内部的使用**，替换自建 Doris 可观测平台底座，继续降低运维成本，推进架构统一。波司登也将借助 Arrow Flight SQL 等功能，将更智能化的自助分析功能提供至业务部分，使业务部门能够独立完成部分经营分析与报表工作，进一步提高交付与运营效率。



