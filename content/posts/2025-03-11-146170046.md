---
layout: post
title: "java之uniapp实现门店地图"
date: 2025-03-11 10:27:24 +0800
description: "用java、mysql、高德、uni-app实现客户地图"
keywords: "java之uniapp实现门店地图"
categories: ['未分类']
tags: ['开发语言', 'Java', 'App']
artid: "146170046"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146170046
    alt: "java之uniapp实现门店地图"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146170046
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146170046
cover: https://bing.ee123.net/img/rand?artid=146170046
image: https://bing.ee123.net/img/rand?artid=146170046
img: https://bing.ee123.net/img/rand?artid=146170046
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     java之uniapp实现门店地图
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-light" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <blockquote>
     <p>
      提示：文章写完后，目录可以自动生成，如何生成可参考右边的帮助文档
     </p>
    </blockquote>
    <p>
    </p>
    <p>
    </p>
    <hr/>
    <h2>
     <a id="_7">
     </a>
     前言
    </h2>
    <p>
     实现查询门店地址的功能，可以按照距离排序。使用技术：java+mysql+uniapp百度地图+高德获取经纬度
    </p>
    <p>
     <img alt="---" src="https://i-blog.csdnimg.cn/direct/f8ae319f92f84b1092bc0da10acbf619.png"/>
    </p>
    <p>
     <code>
      提示：以下是本篇文章正文内容，下面案例可供参考
     </code>
    </p>
    <h2>
     <a id="_15">
     </a>
     一、后台实现
    </h2>
    <h3>
     <a id="1__16">
     </a>
     1. 获取门店的经纬度
    </h3>
    <p>
     可以通过高德或者百度的api接口传入地址获取经纬度。
     <br/>
     这里我使用的是高德，
     <a href="https://lbs.amap.com/api/webservice/guide/api/georegeo" rel="nofollow">
      高德api文档地址
     </a>
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/eff608876ed14c87b33c2df3ac52a8e4.png">
      <br/>
      将拉取过来的经纬度存入到数据库中
     </img>
    </p>
    <pre><code class="prism language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token identifier"><span class="token punctuation">`</span>ums_member_company_coordinate<span class="token punctuation">`</span></span> <span class="token punctuation">(</span>
  <span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span> <span class="token keyword">bigint</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">COMMENT</span> <span class="token string">'主键'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>company_name<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>address_detail<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'详细地址\n'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>address_province<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'地址-省'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>address_city<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'地址-市'</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>address_county<span class="token punctuation">`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'地址-县(区、市）'</span><span class="token punctuation">,</span>
	<span class="token identifier"><span class="token punctuation">`</span>location<span class="token punctuation">`</span></span> <span class="token keyword">point</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">'经纬度'</span><span class="token punctuation">,</span>
  <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token keyword">BTREE</span><span class="token punctuation">,</span>
  SPATIAL <span class="token keyword">KEY</span> <span class="token identifier"><span class="token punctuation">`</span>spatial_index_location<span class="token punctuation">`</span></span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>location<span class="token punctuation">`</span></span><span class="token punctuation">)</span>
<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span><span class="token operator">=</span><span class="token keyword">InnoDB</span>  <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARSET</span><span class="token operator">=</span>utf8mb4 <span class="token keyword">COMMENT</span><span class="token operator">=</span><span class="token string">'客户门店高德坐标'</span><span class="token punctuation">;</span>

</code></pre>
    <p>
     示例数据：
    </p>
    <pre><code class="prism language-sql"><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token identifier"><span class="token punctuation">`</span><span class="token punctuation">`</span></span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>company_name<span class="token punctuation">`</span></span><span class="token punctuation">,</span> <span class="token identifier"><span class="token punctuation">`</span>address_detail<span class="token punctuation">`</span></span><span class="token punctuation">,</span> <span class="token identifier"><span class="token punctuation">`</span>address_province<span class="token punctuation">`</span></span><span class="token punctuation">,</span> <span class="token identifier"><span class="token punctuation">`</span>address_city<span class="token punctuation">`</span></span><span class="token punctuation">,</span> <span class="token identifier"><span class="token punctuation">`</span>address_county<span class="token punctuation">`</span></span><span class="token punctuation">,</span> <span class="token identifier"><span class="token punctuation">`</span>location<span class="token punctuation">`</span></span><span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">'南昌市龙盛大药房有限公司'</span><span class="token punctuation">,</span> <span class="token string">'江西省南昌市西湖区建设西路1285号龙盛建设佳园4号楼商用楼104室'</span><span class="token punctuation">,</span> <span class="token string">'江西省'</span><span class="token punctuation">,</span> <span class="token string">'南昌市'</span><span class="token punctuation">,</span> <span class="token string">'西湖区'</span><span class="token punctuation">,</span> ST_GeomFromText<span class="token punctuation">(</span><span class="token string">'POINT(115.877543 28.649779)'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token identifier"><span class="token punctuation">`</span><span class="token punctuation">`</span></span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>company_name<span class="token punctuation">`</span></span><span class="token punctuation">,</span> <span class="token identifier"><span class="token punctuation">`</span>address_detail<span class="token punctuation">`</span></span><span class="token punctuation">,</span> <span class="token identifier"><span class="token punctuation">`</span>address_province<span class="token punctuation">`</span></span><span class="token punctuation">,</span> <span class="token identifier"><span class="token punctuation">`</span>address_city<span class="token punctuation">`</span></span><span class="token punctuation">,</span> <span class="token identifier"><span class="token punctuation">`</span>address_county<span class="token punctuation">`</span></span><span class="token punctuation">,</span> <span class="token identifier"><span class="token punctuation">`</span>location<span class="token punctuation">`</span></span><span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">'江西益康大药房有限公司'</span><span class="token punctuation">,</span> <span class="token string">'江西省南昌市西湖区云锦路436号中海朝阳郡铂宫2号楼1层商业111室（011室）'</span><span class="token punctuation">,</span> <span class="token string">'江西省'</span><span class="token punctuation">,</span> <span class="token string">'南昌市'</span><span class="token punctuation">,</span> <span class="token string">'西湖区'</span><span class="token punctuation">,</span> ST_GeomFromText<span class="token punctuation">(</span><span class="token string">'POINT(115.875458 28.624109)'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre>
    <p>
     <code>
      注意location 字段为point 类型，所以我们在新增或者修改数据的时候需要做处理
     </code>
    </p>
    <pre><code class="prism language-sql"><span class="token keyword">UPDATE</span> <span class="token keyword">set</span> location <span class="token operator">=</span> <span class="token keyword">POINT</span><span class="token punctuation">(</span>CAST<span class="token punctuation">(</span><span class="token comment">#{longitude} as DECIMAL(12,6)),CAST(#{latitude} as DECIMAL(12,6))) WHERE company_name = '南昌市龙盛大药房有限公司'</span>
</code></pre>
    <h3>
     <a id="2apisql_55">
     </a>
     2.api查询对应的sql
    </h3>
    <p>
     下面传入的115.867543 和28.649779 为当前查询人的经纬度，最终的结果distance 就是距离的公里数
    </p>
    <pre><code class="prism language-sql"><span class="token keyword">SELECT</span>
	company_name<span class="token punctuation">,</span>
	address_detail<span class="token punctuation">,</span>
	address_province<span class="token punctuation">,</span>
	address_city<span class="token punctuation">,</span>
	address_county<span class="token punctuation">,</span>
	location<span class="token punctuation">,</span>
	ifnull<span class="token punctuation">(</span>
		<span class="token function">ROUND</span><span class="token punctuation">(</span>
			ST_DISTANCE_SPHERE <span class="token punctuation">(</span> location<span class="token punctuation">,</span> <span class="token keyword">POINT</span> <span class="token punctuation">(</span> CAST<span class="token punctuation">(</span> <span class="token number">115.867543</span> <span class="token keyword">AS</span> <span class="token keyword">DECIMAL</span> <span class="token punctuation">(</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">6</span> <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> CAST<span class="token punctuation">(</span> <span class="token number">28.649779</span> <span class="token keyword">AS</span> <span class="token keyword">DECIMAL</span> <span class="token punctuation">(</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">6</span> <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token operator">/</span> <span class="token number">1000</span><span class="token punctuation">,</span>
			<span class="token number">2</span> 
		<span class="token punctuation">)</span><span class="token punctuation">,</span>
		<span class="token number">999999999999</span> 
	<span class="token punctuation">)</span> <span class="token keyword">AS</span> distance 
<span class="token keyword">FROM</span>
	ums_member_company_coordinate 

<span class="token keyword">order</span> <span class="token keyword">by</span> distance  <span class="token keyword">asc</span> 
</code></pre>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/85d8965c94924e67a77e49819de5d198.png"/>
    </p>
    <h2>
     <a id="__80">
     </a>
     二 、小程序实现
    </h2>
    <p>
     小程序需要获取到当前手机的经纬度，就是上面传入的15.867543 和28.649779，然后调用后台接口后台把结果渲染在页面上。
    </p>
    <p>
     <a href="https://uniapp.dcloud.net.cn/component/map.html" rel="nofollow">
      uniapp地图文档入口
     </a>
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/ff3680165b584610adca5622d321df1b.png"/>
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f71715f32363734393437332f:61727469636c652f64657461696c732f313436313730303436" class_="artid" style="display:none">
 </p>
</div>


