---
layout: post
title: "深度学习篇-Opencv中的Haar级联分类器"
date: 2025-03-13 10:08:52 +0800
description: "通过理解配置文件的结构和使用方法，可以更好地应用 Haar 级联分类器进行目标检测。"
keywords: "深度学习篇---Opencv中的Haar级联分类器"
categories: ['程序代码篇', '深度学习篇', '图像处理篇']
tags: ['深度学习', '人工智能', 'Python', 'Opencv', 'Haar']
artid: "146223367"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146223367
    alt: "深度学习篇-Opencv中的Haar级联分类器"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146223367
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146223367
cover: https://bing.ee123.net/img/rand?artid=146223367
image: https://bing.ee123.net/img/rand?artid=146223367
img: https://bing.ee123.net/img/rand?artid=146223367
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     深度学习篇---Opencv中的Haar级联分类器
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <hr/>
    <p>
    </p>
    <p>
    </p>
    <hr/>
    <p>
     OpenCV 中的
     <strong>
      Haar 级联分类器
     </strong>
     是一种基于
     <strong>
      Haar 特征的目标检测方法
     </strong>
     ，广泛应用于
     <strong>
      人脸检测、眼睛检测、行人检测
     </strong>
     等任务。Haar 级联分类器的核心是使用预先训练好的分类器模型，这些模型通常以 XML 文件的形式提供。OpenCV 自带了一些常用的
     <strong>
      Haar 级联分类器配置文件
     </strong>
     ，用户也可以根据需要训练自己的分类器。
    </p>
    <hr/>
    <h2>
     <a id="1Haar__18">
     </a>
     1.Haar 级联分类器配置文件的结构
    </h2>
    <p>
     Haar 级联分类器的
     <strong>
      配置文件
     </strong>
     是一个
     <strong>
      XML 文件
     </strong>
     ，包含了
     <strong>
      分类器的结构、特征、阈值
     </strong>
     等信息。以下是配置文件的主要组成部分：
    </p>
    <pre><code>&lt;cascade&gt; 标签：

    这是 XML 文件的根标签，包含了整个级联分类器的信息。

&lt;stageType&gt; 标签：

    指定级联分类器的类型，通常是 "BOOST"（基于 AdaBoost 算法）。

&lt;featureType&gt; 标签：

    指定特征类型，通常是 "HAAR"（Haar 特征）。

&lt;height&gt; 和 &lt;width&gt; 标签：

    指定检测窗口的大小（以像素为单位），通常是 24x24。

&lt;stageParams&gt; 标签：

    包含级联分类器的参数，如弱分类器的数量、最大误检率等。

&lt;featureParams&gt; 标签：

    包含特征参数，如 Haar 特征的最大数量等。

&lt;stages&gt; 标签：

    包含所有级联阶段的列表。每个阶段都是一个 &lt;_&gt; 标签，包含该阶段的弱分类器和其他参数。

&lt;trees&gt; 标签：

    包含该阶段的决策树（弱分类器）。每个决策树是一个 &lt;_&gt; 标签，包含多个节点。

&lt;feature&gt; 标签：

    指定 Haar 特征的矩形区域及其权重。

&lt;threshold&gt; 标签：

    指定分类器的阈值，用于判断是否通过该阶段的分类。
</code></pre>
    <h2>
     <a id="2OpenCV__Haar__62">
     </a>
     2.OpenCV 自带的 Haar 级联分类器配置文件
    </h2>
    <p>
     OpenCV 提供了一些常用的
     <strong>
      Haar 级联分类器配置文件
     </strong>
     ，这些文件通常位于
     <strong>
      OpenCV 安装目录的 data/haarcascades/ 目录下
     </strong>
     。以下是一些常见的配置文件：
    </p>
    <h3>
     <a id="21_66">
     </a>
     2.1人脸检测
    </h3>
    <h4>
     <a id="211haarcascade_frontalface_defaultxml_67">
     </a>
     2.1.1haarcascade_frontalface_default.xml
    </h4>
    <pre><code>    haarcascade_frontalface_default.xml：用于检测正面人脸。
</code></pre>
    <h4>
     <a id="212haarcascade_frontalface_altxml_70">
     </a>
     2.1.2haarcascade_frontalface_alt.xml
    </h4>
    <pre><code>    haarcascade_frontalface_alt.xml：另一种正面人脸检测模型。
</code></pre>
    <h4>
     <a id="213haarcascade_frontalface_alt2xml_74">
     </a>
     2.1.3haarcascade_frontalface_alt2.xml
    </h4>
    <pre><code>    haarcascade_frontalface_alt2.xml：改进的正面人脸检测模型。
</code></pre>
    <h4>
     <a id="214haarcascade_frontalface_alt_treexml_78">
     </a>
     2.1.4haarcascade_frontalface_alt_tree.xml
    </h4>
    <pre><code>    haarcascade_frontalface_alt_tree.xml：基于树结构的正面人脸检测模型。
</code></pre>
    <h3>
     <a id="22_82">
     </a>
     2.2眼睛检测
    </h3>
    <h4>
     <a id="221haarcascade_eyexml_83">
     </a>
     2.2.1haarcascade_eye.xml
    </h4>
    <pre><code>    haarcascade_eye.xml：用于检测眼睛。
</code></pre>
    <h4>
     <a id="222haarcascade_eye_tree_eyeglassesxml_87">
     </a>
     2.2.2haarcascade_eye_tree_eyeglasses.xml
    </h4>
    <pre><code>    haarcascade_eye_tree_eyeglasses.xml：用于检测戴眼镜的眼睛。
</code></pre>
    <h3>
     <a id="23_92">
     </a>
     2.3微笑检测
    </h3>
    <h4>
     <a id="231haarcascade_smilexml_94">
     </a>
     2.3.1haarcascade_smile.xml
    </h4>
    <pre><code>    haarcascade_smile.xml：用于检测微笑。
</code></pre>
    <h3>
     <a id="24_98">
     </a>
     2.4全身检测
    </h3>
    <h4>
     <a id="241haarcascade_fullbodyxml_99">
     </a>
     2.4.1haarcascade_fullbody.xml
    </h4>
    <pre><code>    haarcascade_fullbody.xml：用于检测全身。
</code></pre>
    <h3>
     <a id="25_103">
     </a>
     2.5上半身检测
    </h3>
    <h4>
     <a id="251haarcascade_upperbodyxml_105">
     </a>
     2.5.1haarcascade_upperbody.xml
    </h4>
    <pre><code>    haarcascade_upperbody.xml：用于检测上半身。
</code></pre>
    <h3>
     <a id="26_109">
     </a>
     2.6下半身检测
    </h3>
    <h4>
     <a id="261haarcascade_lowerbodyxml_112">
     </a>
     2.6.1haarcascade_lowerbody.xml
    </h4>
    <pre><code>    haarcascade_lowerbody.xml：用于检测下半身。
</code></pre>
    <h3>
     <a id="27_116">
     </a>
     2.7行人检测
    </h3>
    <h4>
     <a id="271haarcascade_pedestrianxml_117">
     </a>
     2.7.1haarcascade_pedestrian.xml
    </h4>
    <pre><code>    haarcascade_pedestrian.xml：用于检测行人。
</code></pre>
    <h2>
     <a id="3_Haar__121">
     </a>
     3.使用 Haar 级联分类器配置文件
    </h2>
    <p>
     在 OpenCV 中使用 Haar 级联分类器配置文件非常简单。以下是一个使用 haarcascade_frontalface_default.xml 进行人脸检测的示例代码：
    </p>
    <pre><code class="prism language-python"><span class="token keyword">import</span> cv2

<span class="token comment">#加载 Haar 级联分类器</span>
face_cascade <span class="token operator">=</span> cv2<span class="token punctuation">.</span>CascadeClassifier<span class="token punctuation">(</span>cv2<span class="token punctuation">.</span>data<span class="token punctuation">.</span>haarcascades <span class="token operator">+</span> <span class="token string">'haarcascade_frontalface_default.xml'</span><span class="token punctuation">)</span>

<span class="token comment">#读取图像</span>
img <span class="token operator">=</span> cv2<span class="token punctuation">.</span>imread<span class="token punctuation">(</span><span class="token string">'test.jpg'</span><span class="token punctuation">)</span>

<span class="token comment">#转换为灰度图像</span>
gray <span class="token operator">=</span> cv2<span class="token punctuation">.</span>cvtColor<span class="token punctuation">(</span>img<span class="token punctuation">,</span> cv2<span class="token punctuation">.</span>COLOR_BGR2GRAY<span class="token punctuation">)</span>

<span class="token comment">#检测人脸</span>
faces <span class="token operator">=</span> face_cascade<span class="token punctuation">.</span>detectMultiScale<span class="token punctuation">(</span>gray<span class="token punctuation">,</span> scaleFactor<span class="token operator">=</span><span class="token number">1.1</span><span class="token punctuation">,</span> minNeighbors<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span> minSize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">#绘制检测到的人脸</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> w<span class="token punctuation">,</span> h<span class="token punctuation">)</span> <span class="token keyword">in</span> faces<span class="token punctuation">:</span>
    cv2<span class="token punctuation">.</span>rectangle<span class="token punctuation">(</span>img<span class="token punctuation">,</span> <span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>x<span class="token operator">+</span>w<span class="token punctuation">,</span> y<span class="token operator">+</span>h<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>

<span class="token comment">#显示结果</span>
cv2<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span><span class="token string">'Detected Faces'</span><span class="token punctuation">,</span> img<span class="token punctuation">)</span>
cv2<span class="token punctuation">.</span>waitKey<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
cv2<span class="token punctuation">.</span>destroyAllWindows<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
    <p>
     Haar 级联分类器是
     <strong>
      OpenCV 中一种强大的目标检测工具
     </strong>
     ，适用于多种检测任务。OpenCV 提供了多种
     <strong>
      预训练的 Haar 级联分类器配置文件
     </strong>
     ，用户也可以根据需要训练
     <strong>
      自定义的分类器
     </strong>
     。通过理解配置文件的结构和使用方法，可以更好地应用 Haar 级联分类器进行目标检测。
    </p>
    <hr/>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f:672e6373646e2e6e65742f323330315f37393535363430322f:61727469636c652f64657461696c732f313436323233333637" class_="artid" style="display:none">
 </p>
</div>


