---
layout: post
title: "WangEditor快速实现版"
date: 2025-03-09 16:06:15 +0800
description: "效果。"
keywords: "WangEditor快速实现版"
categories: ['未分类']
tags: ['Node', 'Mybatis']
artid: "146133774"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146133774
    alt: "WangEditor快速实现版"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146133774
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146133774
cover: https://bing.ee123.net/img/rand?artid=146133774
image: https://bing.ee123.net/img/rand?artid=146133774
img: https://bing.ee123.net/img/rand?artid=146133774
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     WangEditor快速实现版
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h2>
     <a id="WangEditor_0">
     </a>
     WangEditor快速实现版
    </h2>
    <p>
     效果
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/aa341fa2549e4107a89d77da33343a5f.png"/>
    </p>
    <h4>
     <a id="_4">
     </a>
     案例代码
    </h4>
    <blockquote>
     <p>
      后端
     </p>
    </blockquote>
    <pre><code class="prism language-Java">package com.diy.springboot.controller;

import cn.hutool.core.util.IdUtil;
import io.swagger.annotations.Api;
import io.swagger.annotations.ApiOperation;
import io.swagger.annotations.ApiImplicitParam;
import org.springframework.beans.factory.annotation.Value;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.bind.annotation.RestController;
import org.springframework.web.multipart.MultipartFile;

import java.io.File;
import java.io.IOException;
import java.util.Collections;
import java.util.HashMap;
import java.util.Map;

@Api(tags = "富文本编辑器文件上传接口")
@RestController
@RequestMapping("/editor")
public class WangEditorUploadController {

    @Value("${files.upload.path}")
    private String fileUploadPath;

    @ApiOperation(value = "上传图片或视频", notes = "支持图片(jpg,jpeg,png,gif,bmp)和视频(mp4,avi,mkv,mov)格式")
    @ApiImplicitParam(name = "file", value = "文件", required = true, dataType = "MultipartFile")
    @PostMapping("/upload")
    public ResponseEntity&lt;Map&lt;String, Object&gt;&gt; upload(@RequestParam MultipartFile file) {
        if (file.isEmpty()) {
            return ResponseEntity.badRequest().body(createErrorResponse());
        }

        String originalFilename = file.getOriginalFilename();
        String fileType = getFileType(originalFilename);
        if ("other".equals(fileType)) {
            return ResponseEntity.badRequest().body(createErrorResponse());
        }

        try {
            String fileUUID = IdUtil.fastSimpleUUID() + originalFilename.substring(originalFilename.lastIndexOf("."));
            File uploadFile = new File(fileUploadPath + fileUUID);

            File parentFile = uploadFile.getParentFile();
            if (!parentFile.exists()) {
                parentFile.mkdirs();
            }

            file.transferTo(uploadFile);
            return ResponseEntity.ok(createImageResponse(fileUUID));
        } catch (IOException e) {
            return ResponseEntity.badRequest().body(createErrorResponse());
        }
    }

    @ApiOperation(value = "获取文件类型", hidden = true)
    private String getFileType(String filename) {
        String ext = filename.substring(filename.lastIndexOf(".")).toLowerCase();
        switch (ext) {
            case ".jpg":
            case ".jpeg":
            case ".png":
            case ".gif":
            case ".bmp":
                return "image";
            case ".mp4":
            case ".avi":
            case ".mkv":
            case ".mov":
                return "video";
            default:
                return "other";
        }
    }

    @ApiOperation(value = "创建错误响应", hidden = true)
    private Map&lt;String, Object&gt; createErrorResponse() {
        Map&lt;String, Object&gt; response = new HashMap&lt;&gt;();
        response.put("errno", 1);
        response.put("data", Collections.emptyMap());
        return response;
    }

    @ApiOperation(value = "创建图片响应", hidden = true)
    private Map&lt;String, Object&gt; createImageResponse(String filename) {
        Map&lt;String, Object&gt; response = new HashMap&lt;&gt;();
        response.put("errno", 0);

        Map&lt;String, String&gt; imageData = new HashMap&lt;&gt;();
        imageData.put("url", "http://localhost:9090/file/" + filename);
        response.put("data", imageData);

        return response;
    }
}
</code></pre>
    <blockquote>
     <p>
      前端
     </p>
    </blockquote>
    <pre><code class="prism language-vue">&lt;template&gt;
  &lt;div id="app"&gt;
    &lt;h1&gt;富文本编辑器与HTML渲染&lt;/h1&gt;
    &lt;el-row&gt;
      &lt;el-button type="primary" @click="logEditorContent"&gt;输出编辑器内容&lt;/el-button&gt;
      &lt;el-button type="success" @click="loadSampleContent"&gt;回显内容&lt;/el-button&gt;
      &lt;el-button type="warning" @click="renderUnsafeHtml"&gt;渲染HTML（XSS演示）&lt;/el-button&gt;
    &lt;/el-row&gt;
    &lt;el-divider&gt;&lt;/el-divider&gt;
    &lt;div ref="editorContainer" style="border: 1px solid #ccc;"&gt;&lt;/div&gt;
    &lt;el-divider&gt;&lt;/el-divider&gt;
    &lt;h2&gt;渲染的HTML内容：&lt;/h2&gt;
    &lt;div v-html="renderedContent"&gt;&lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script&gt;
import E from 'wangeditor'

export default {
  name: 'App',
  data() {
    return {
      editor: null,
      renderedContent: '',
    }
  },
  mounted() {
    this.$nextTick(() =&gt; {
      this.editor = new E(this.$refs.editorContainer)

      // 配置图片上传的服务器接口
      this.editor.config.uploadImgServer = 'http://localhost:9090/editor/upload';
      this.editor.config.uploadFileName = 'file';

      // 配置视频上传的服务器接口
      this.editor.config.uploadVideoServer = 'http://localhost:9090/editor/upload';
      this.editor.config.uploadVideoName = 'file';

      this.editor.highlight = window.hljs;

      // 修改图片上传的回调处理逻辑，适配后端返回的数据结构
      this.editor.config.uploadImgHooks = {
        customInsert: (insertImgFn, result) =&gt; {
          if (result.errno === 0 &amp;&amp; result.data &amp;&amp; result.data.url) {
            // 直接使用data.url，不再假设data是数组
            insertImgFn(result.data.url);
          } else {
            console.error('图片上传失败', result);
          }
        },
      };

      // 视频上传的回调处理逻辑
      this.editor.config.uploadVideoHooks = {
        customInsert: (insertVideoFn, result) =&gt; {
          if (result.errno === 0 &amp;&amp; result.data &amp;&amp; result.data.url) {
            insertVideoFn(result.data.url);
          } else {
            console.error('视频上传失败', result);
          }
        },
      };

      this.editor.create()
    })
  },
  beforeDestroy() {
    if (this.editor) {
      this.editor.destroy()
    }
  },
  methods: {
    logEditorContent() {
      if (this.editor) {
        const content = this.editor.txt.html()
        console.log("编辑器内容:", content)
        this.renderedContent = content
      }
    },
    loadSampleContent() {
      if (this.editor) {
        const sampleContent = `
          &lt;h2&gt;欢迎使用 WangEditor&lt;/h2&gt;
          &lt;p&gt;这是一个&lt;strong&gt;富文本编辑器&lt;/strong&gt;示例。&lt;/p&gt;
          &lt;ul&gt;
            &lt;li&gt;支持多种格式&lt;/li&gt;
            &lt;li&gt;易于使用&lt;/li&gt;
            &lt;li&gt;功能强大&lt;/li&gt;
          &lt;/ul&gt;
          &lt;p&gt;你可以在这里添加&lt;span style="color: blue;"&gt;各种样式&lt;/span&gt;的文本。&lt;/p&gt;
          &lt;blockquote&gt;这是一个引用示例。&lt;/blockquote&gt;
        `
        this.editor.txt.html(sampleContent)
        this.renderedContent = sampleContent
      }
    },
    renderUnsafeHtml() {
      const unsafeHtml = '&lt;img src="x" onerror="alert(\'XSS 攻击演示\')"&gt;'
      this.editor.txt.html(unsafeHtml)
      this.renderedContent = unsafeHtml
    }
  },
}
&lt;/script&gt;

&lt;style&gt;
#app {
  width: 80%;
  margin: 20px auto;
}

.w-e-text-container {
  height: 300px !important;
}
&lt;/style&gt;
</code></pre>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f672e:6373646e2e6e65742f77656978696e5f35323233363538362f:61727469636c652f64657461696c732f313436313333373734" class_="artid" style="display:none">
 </p>
</div>


