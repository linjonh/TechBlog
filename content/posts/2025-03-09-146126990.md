---
layout: post
title: "GPT入门第11课-FunctionCall调用本地代码入门"
date: 2025-03-09 07:27:16 +0800
description: "为了了解，funcationCall底层，手写一个functionCall多方法，并调用，体验。2.让大模型自动识别用户问题，解释参数，获取调用方法id、方法名称、方法参数。3.把第二步的结果，给大模型，让大模型调用函数，并返回结果。任务：让openai调用sum方法，对加法进行求和。1.定义sum方法，给openAi接口。"
keywords: "【GPT入门】第11课 FunctionCall调用本地代码入门"
categories: ['大模型']
tags: ['Openai', 'Java', 'Gpt']
artid: "146126990"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146126990
    alt: "GPT入门第11课-FunctionCall调用本地代码入门"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146126990
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146126990
cover: https://bing.ee123.net/img/rand?artid=146126990
image: https://bing.ee123.net/img/rand?artid=146126990
img: https://bing.ee123.net/img/rand?artid=146126990
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     【GPT入门】第11课 FunctionCall调用本地代码入门
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
    </p>
    <p>
    </p>
    <h2>
     <a id="1_FunctionCall_1">
     </a>
     1. 手撕FunctionCall
    </h2>
    <p>
     为了了解，funcationCall底层，手写一个functionCall多方法，并调用，体验
    </p>
    <p>
     思路：
     <br/>
     任务：让openai调用sum方法，对加法进行求和
     <br/>
     1.定义sum方法，给openAi接口
     <br/>
     2.让大模型自动识别用户问题，解释参数，获取调用方法id、方法名称、方法参数
     <br/>
     3.把第二步的结果，给大模型，让大模型调用函数，并返回结果
    </p>
    <h2>
     <a id="2_10">
     </a>
     2.代码
    </h2>
    <pre><code class="prism language-c">from openai import OpenAI
from dotenv import load_dotenv<span class="token punctuation">,</span> find_dotenv
import json

_ <span class="token operator">=</span> <span class="token function">load_dotenv</span><span class="token punctuation">(</span><span class="token function">find_dotenv</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

client <span class="token operator">=</span> <span class="token function">OpenAI</span><span class="token punctuation">(</span><span class="token punctuation">)</span>


def <span class="token function">print_json</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token operator">:</span>
    <span class="token string">""</span>"
    打印参数。如果参数是有结构的（如字典或列表），则以格式化的 JSON 形式打印；
    否则，直接打印该值。
    <span class="token string">""</span>"
    <span class="token keyword">if</span> <span class="token function">hasattr</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token char">'model_dump_json'</span><span class="token punctuation">)</span><span class="token operator">:</span>
        data <span class="token operator">=</span> json<span class="token punctuation">.</span><span class="token function">loads</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span><span class="token function">model_dump_json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isinstance</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token punctuation">(</span>list<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">:</span>
        <span class="token keyword">for</span> item in data<span class="token operator">:</span>
            <span class="token function">print_json</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span>
    <span class="token function">elif</span> <span class="token punctuation">(</span><span class="token function">isinstance</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token punctuation">(</span>dict<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">:</span>
        <span class="token function">print</span><span class="token punctuation">(</span>json<span class="token punctuation">.</span><span class="token function">dumps</span><span class="token punctuation">(</span>
            data<span class="token punctuation">,</span>
            indent<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span>
            ensure_ascii<span class="token operator">=</span>False
        <span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token operator">:</span>
        <span class="token function">print</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>


def <span class="token function">get_completion</span><span class="token punctuation">(</span>messages<span class="token punctuation">,</span> model<span class="token operator">=</span><span class="token string">"gpt-4o-mini"</span><span class="token punctuation">)</span><span class="token operator">:</span>
    response <span class="token operator">=</span> client<span class="token punctuation">.</span>chat<span class="token punctuation">.</span>completions<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>
        model<span class="token operator">=</span>model<span class="token punctuation">,</span>
        messages<span class="token operator">=</span>messages<span class="token punctuation">,</span>
        temperature<span class="token operator">=</span><span class="token number">0.7</span><span class="token punctuation">,</span>
        tools<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">{<!-- --></span>  # 用 JSON 描述函数。可以定义多个。由大模型决定调用谁。也可能都不调用
            <span class="token string">"type"</span><span class="token operator">:</span> <span class="token string">"function"</span><span class="token punctuation">,</span>
            <span class="token string">"function"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                <span class="token string">"name"</span><span class="token operator">:</span> <span class="token string">"sum"</span><span class="token punctuation">,</span>
                <span class="token string">"description"</span><span class="token operator">:</span> <span class="token string">"加法器，计算一组数的和"</span><span class="token punctuation">,</span>
                <span class="token string">"parameters"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token string">"type"</span><span class="token operator">:</span> <span class="token string">"object"</span><span class="token punctuation">,</span>
                    <span class="token string">"properties"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token string">"numbers"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                            <span class="token string">"type"</span><span class="token operator">:</span> <span class="token string">"array"</span><span class="token punctuation">,</span>
                            <span class="token string">"items"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                                <span class="token string">"type"</span><span class="token operator">:</span> <span class="token string">"number"</span>
                            <span class="token punctuation">}</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"response:"</span><span class="token punctuation">)</span>
    <span class="token function">print</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span>
    <span class="token keyword">return</span> response<span class="token punctuation">.</span>choices<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>message

from math import <span class="token operator">*</span>

prompt <span class="token operator">=</span> <span class="token string">"Tell me the sum of 1,2,3,4,5,6,7,8,9,10"</span>


messages <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{<!-- --></span><span class="token string">"role"</span><span class="token operator">:</span> <span class="token string">"system"</span><span class="token punctuation">,</span> <span class="token string">"content"</span><span class="token operator">:</span> <span class="token string">"你是一个数学家"</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{<!-- --></span><span class="token string">"role"</span><span class="token operator">:</span> <span class="token string">"user"</span><span class="token punctuation">,</span> <span class="token string">"content"</span><span class="token operator">:</span> prompt<span class="token punctuation">}</span>
<span class="token punctuation">]</span>



response <span class="token operator">=</span> <span class="token function">get_completion</span><span class="token punctuation">(</span>messages<span class="token punctuation">)</span>

# 把大模型的回复加入到对话历史中。必须有
messages<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"------function call-----"</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span>response<span class="token punctuation">.</span>tool_calls is not None<span class="token punctuation">)</span><span class="token operator">:</span>
    # 是否要调用 sum
    tool_call <span class="token operator">=</span> response<span class="token punctuation">.</span>tool_calls<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>tool_call<span class="token punctuation">.</span>function<span class="token punctuation">.</span>name <span class="token operator">==</span> <span class="token char">'sum'</span><span class="token punctuation">)</span><span class="token operator">:</span>
        args <span class="token operator">=</span> json<span class="token punctuation">.</span><span class="token function">loads</span><span class="token punctuation">(</span>tool_call<span class="token punctuation">.</span>function<span class="token punctuation">.</span>arguments<span class="token punctuation">)</span>
        result <span class="token operator">=</span> <span class="token function">sum</span><span class="token punctuation">(</span>args<span class="token punctuation">[</span><span class="token string">"numbers"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

        #把函数调用结果加入到对话历史中
        messages<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token string">"tool_call_id"</span><span class="token operator">:</span>tool_call<span class="token punctuation">.</span>id<span class="token punctuation">,</span> #用于表示函数调用Id
                <span class="token string">"role"</span><span class="token operator">:</span><span class="token string">"tool"</span><span class="token punctuation">,</span>
                <span class="token string">"name"</span><span class="token operator">:</span><span class="token string">"sum"</span><span class="token punctuation">,</span>
                <span class="token string">"content"</span><span class="token operator">:</span><span class="token function">str</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span> #数值 result 必须转为字符串
             <span class="token punctuation">}</span>
        <span class="token punctuation">)</span>

        #再次调用大模型
        response <span class="token operator">=</span> <span class="token function">get_completion</span><span class="token punctuation">(</span>messages<span class="token punctuation">)</span>
        messages<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span>
        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"-------最终 GPT 回复-------"</span><span class="token punctuation">)</span>
        <span class="token function">print</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>content<span class="token punctuation">)</span>

<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"---------对话历史----------"</span><span class="token punctuation">)</span>
<span class="token function">print_json</span><span class="token punctuation">(</span>messages<span class="token punctuation">)</span>
</code></pre>
    <h2>
     <a id="3functionCall_116">
     </a>
     3.functionCall的结果
    </h2>
    <pre><code class="prism language-c">C<span class="token operator">:</span>\ProgramData\anaconda3\envs\gptLearning\python<span class="token punctuation">.</span>exe E<span class="token operator">:</span>\workspace\gptLearning\gptLearning\les03\Lesson01_functionCalling<span class="token punctuation">.</span>py 
response<span class="token operator">:</span>
<span class="token function">ChatCompletion</span><span class="token punctuation">(</span>id<span class="token operator">=</span>'chatcmpl<span class="token operator">-</span>B8xbekE9Xfke8t1AkftFpEzpcdtho<span class="token char">', choices=[Choice(finish_reason='</span>tool_calls'<span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> logprobs<span class="token operator">=</span>None<span class="token punctuation">,</span> message<span class="token operator">=</span><span class="token function">ChatCompletionMessage</span><span class="token punctuation">(</span>content<span class="token operator">=</span>None<span class="token punctuation">,</span> refusal<span class="token operator">=</span>None<span class="token punctuation">,</span> role<span class="token operator">=</span><span class="token char">'assistant'</span><span class="token punctuation">,</span> audio<span class="token operator">=</span>None<span class="token punctuation">,</span> function_call<span class="token operator">=</span>None<span class="token punctuation">,</span> tool_calls<span class="token operator">=</span><span class="token punctuation">[</span><span class="token function">ChatCompletionMessageToolCall</span><span class="token punctuation">(</span>id<span class="token operator">=</span><span class="token char">'call_CcEYaIPwl1Ru63XmMm6qSGFD'</span><span class="token punctuation">,</span> function<span class="token operator">=</span><span class="token function">Function</span><span class="token punctuation">(</span>arguments<span class="token operator">=</span>'<span class="token punctuation">{<!-- --></span><span class="token string">"numbers"</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token char">', name='</span>sum<span class="token char">'), type='</span>function'<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> content_filter_results<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> created<span class="token operator">=</span><span class="token number">1741475450</span><span class="token punctuation">,</span> model<span class="token operator">=</span><span class="token char">'gpt-4o-mini-2024-07-18'</span><span class="token punctuation">,</span> object<span class="token operator">=</span><span class="token char">'chat.completion'</span><span class="token punctuation">,</span> service_tier<span class="token operator">=</span>None<span class="token punctuation">,</span> system_fingerprint<span class="token operator">=</span><span class="token char">'fp_b705f0c291'</span><span class="token punctuation">,</span> usage<span class="token operator">=</span><span class="token function">CompletionUsage</span><span class="token punctuation">(</span>completion_tokens<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">,</span> prompt_tokens<span class="token operator">=</span><span class="token number">79</span><span class="token punctuation">,</span> total_tokens<span class="token operator">=</span><span class="token number">111</span><span class="token punctuation">,</span> completion_tokens_details<span class="token operator">=</span><span class="token function">CompletionTokensDetails</span><span class="token punctuation">(</span>accepted_prediction_tokens<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> audio_tokens<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> reasoning_tokens<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> rejected_prediction_tokens<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> prompt_tokens_details<span class="token operator">=</span><span class="token function">PromptTokensDetails</span><span class="token punctuation">(</span>audio_tokens<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> cached_tokens<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> prompt_filter_results<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">{<!-- --></span><span class="token char">'prompt_index'</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token char">'content_filter_results'</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span><span class="token char">'hate'</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span><span class="token char">'filtered'</span><span class="token operator">:</span> False<span class="token punctuation">,</span> <span class="token char">'severity'</span><span class="token operator">:</span> <span class="token char">'safe'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token char">'jailbreak'</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span><span class="token char">'filtered'</span><span class="token operator">:</span> False<span class="token punctuation">,</span> <span class="token char">'detected'</span><span class="token operator">:</span> False<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token char">'self_harm'</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span><span class="token char">'filtered'</span><span class="token operator">:</span> False<span class="token punctuation">,</span> <span class="token char">'severity'</span><span class="token operator">:</span> <span class="token char">'safe'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token char">'sexual'</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span><span class="token char">'filtered'</span><span class="token operator">:</span> False<span class="token punctuation">,</span> <span class="token char">'severity'</span><span class="token operator">:</span> <span class="token char">'safe'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token char">'violence'</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span><span class="token char">'filtered'</span><span class="token operator">:</span> False<span class="token punctuation">,</span> <span class="token char">'severity'</span><span class="token operator">:</span> <span class="token char">'safe'</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>function call<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
<span class="token function">ChatCompletionMessage</span><span class="token punctuation">(</span>content<span class="token operator">=</span>None<span class="token punctuation">,</span> refusal<span class="token operator">=</span>None<span class="token punctuation">,</span> role<span class="token operator">=</span><span class="token char">'assistant'</span><span class="token punctuation">,</span> audio<span class="token operator">=</span>None<span class="token punctuation">,</span> function_call<span class="token operator">=</span>None<span class="token punctuation">,</span> tool_calls<span class="token operator">=</span><span class="token punctuation">[</span><span class="token function">ChatCompletionMessageToolCall</span><span class="token punctuation">(</span>id<span class="token operator">=</span><span class="token char">'call_CcEYaIPwl1Ru63XmMm6qSGFD'</span><span class="token punctuation">,</span> function<span class="token operator">=</span><span class="token function">Function</span><span class="token punctuation">(</span>arguments<span class="token operator">=</span>'<span class="token punctuation">{<!-- --></span><span class="token string">"numbers"</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token char">', name='</span>sum<span class="token char">'), type='</span>function'<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
response<span class="token operator">:</span>
<span class="token function">ChatCompletion</span><span class="token punctuation">(</span>id<span class="token operator">=</span>'chatcmpl<span class="token operator">-</span>B8xbfvdhavJ9RTAVxfAk3SmkIjVOT<span class="token char">', choices=[Choice(finish_reason='</span>stop'<span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> logprobs<span class="token operator">=</span>None<span class="token punctuation">,</span> message<span class="token operator">=</span><span class="token function">ChatCompletionMessage</span><span class="token punctuation">(</span>content<span class="token operator">=</span>'The sum of the numbers <span class="token number">1</span> through <span class="token number">10</span> is <span class="token number">55.</span><span class="token char">', refusal=None, role='</span>assistant'<span class="token punctuation">,</span> audio<span class="token operator">=</span>None<span class="token punctuation">,</span> function_call<span class="token operator">=</span>None<span class="token punctuation">,</span> tool_calls<span class="token operator">=</span>None<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> created<span class="token operator">=</span><span class="token number">1741475451</span><span class="token punctuation">,</span> model<span class="token operator">=</span><span class="token char">'gpt-4o-mini-2024-07-18'</span><span class="token punctuation">,</span> object<span class="token operator">=</span><span class="token char">'chat.completion'</span><span class="token punctuation">,</span> service_tier<span class="token operator">=</span><span class="token char">'default'</span><span class="token punctuation">,</span> system_fingerprint<span class="token operator">=</span><span class="token char">'fp_06737a9306'</span><span class="token punctuation">,</span> usage<span class="token operator">=</span><span class="token function">CompletionUsage</span><span class="token punctuation">(</span>completion_tokens<span class="token operator">=</span><span class="token number">16</span><span class="token punctuation">,</span> prompt_tokens<span class="token operator">=</span><span class="token number">118</span><span class="token punctuation">,</span> total_tokens<span class="token operator">=</span><span class="token number">134</span><span class="token punctuation">,</span> completion_tokens_details<span class="token operator">=</span><span class="token function">CompletionTokensDetails</span><span class="token punctuation">(</span>accepted_prediction_tokens<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> audio_tokens<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> reasoning_tokens<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> rejected_prediction_tokens<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> prompt_tokens_details<span class="token operator">=</span><span class="token function">PromptTokensDetails</span><span class="token punctuation">(</span>audio_tokens<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> cached_tokens<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>最终 GPT 回复<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>
The sum of the numbers <span class="token number">1</span> through <span class="token number">10</span> is <span class="token number">55.</span>
<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>对话历史<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token string">"role"</span><span class="token operator">:</span> <span class="token string">"system"</span><span class="token punctuation">,</span>
    <span class="token string">"content"</span><span class="token operator">:</span> <span class="token string">"你是一个数学家"</span>
<span class="token punctuation">}</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token string">"role"</span><span class="token operator">:</span> <span class="token string">"user"</span><span class="token punctuation">,</span>
    <span class="token string">"content"</span><span class="token operator">:</span> <span class="token string">"Tell me the sum of 1,2,3,4,5,6,7,8,9,10"</span>
<span class="token punctuation">}</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token string">"content"</span><span class="token operator">:</span> null<span class="token punctuation">,</span>
    <span class="token string">"refusal"</span><span class="token operator">:</span> null<span class="token punctuation">,</span>
    <span class="token string">"role"</span><span class="token operator">:</span> <span class="token string">"assistant"</span><span class="token punctuation">,</span>
    <span class="token string">"audio"</span><span class="token operator">:</span> null<span class="token punctuation">,</span>
    <span class="token string">"function_call"</span><span class="token operator">:</span> null<span class="token punctuation">,</span>
    <span class="token string">"tool_calls"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token string">"id"</span><span class="token operator">:</span> <span class="token string">"call_CcEYaIPwl1Ru63XmMm6qSGFD"</span><span class="token punctuation">,</span>
            <span class="token string">"function"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                <span class="token string">"arguments"</span><span class="token operator">:</span> <span class="token string">"{\"numbers\":[1,2,3,4,5,6,7,8,9,10]}"</span><span class="token punctuation">,</span>
                <span class="token string">"name"</span><span class="token operator">:</span> <span class="token string">"sum"</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token string">"type"</span><span class="token operator">:</span> <span class="token string">"function"</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token string">"tool_call_id"</span><span class="token operator">:</span> <span class="token string">"call_CcEYaIPwl1Ru63XmMm6qSGFD"</span><span class="token punctuation">,</span>
    <span class="token string">"role"</span><span class="token operator">:</span> <span class="token string">"tool"</span><span class="token punctuation">,</span>
    <span class="token string">"name"</span><span class="token operator">:</span> <span class="token string">"sum"</span><span class="token punctuation">,</span>
    <span class="token string">"content"</span><span class="token operator">:</span> <span class="token string">"55"</span>
<span class="token punctuation">}</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token string">"content"</span><span class="token operator">:</span> <span class="token string">"The sum of the numbers 1 through 10 is 55."</span><span class="token punctuation">,</span>
    <span class="token string">"refusal"</span><span class="token operator">:</span> null<span class="token punctuation">,</span>
    <span class="token string">"role"</span><span class="token operator">:</span> <span class="token string">"assistant"</span><span class="token punctuation">,</span>
    <span class="token string">"audio"</span><span class="token operator">:</span> null<span class="token punctuation">,</span>
    <span class="token string">"function_call"</span><span class="token operator">:</span> null<span class="token punctuation">,</span>
    <span class="token string">"tool_calls"</span><span class="token operator">:</span> null
<span class="token punctuation">}</span>

Process finished with exit code <span class="token number">0</span>

</code></pre>
    <pre><code></code></pre>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f:2f626c6f672e6373646e2e6e65742f737061726b5f6465762f:61727469636c652f64657461696c732f313436313236393930" class_="artid" style="display:none">
 </p>
</div>


