---
layout: post
title: "Git清理本地残留的但已经在服务器上被删除的分支"
date: 2025-03-06 11:31:39 +0800
description: "筛选出那些远程分支已经被删除的本地分支。‘: gone]’ 是 git branch -vv 输出中表示远程分支已删除的标记。:使用 xargs 将筛选出的分支名称传递给 git branch -d 命令，批量删除这些本地分支。: 从远程仓库获取最新的分支信息，并删除本地已经不存在的远程分支。:列出所有本地分支，并显示每个分支对应的远程分支和最新的提交信息。分支，因为它们对应的远程分支已经被删除。"
keywords: "Git清理本地残留的、但已经在服务器上被删除的分支"
categories: ['未分类']
tags: ['运维', '服务器', 'Git']
artid: "146063930"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146063930
    alt: "Git清理本地残留的但已经在服务器上被删除的分支"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146063930
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146063930
cover: https://bing.ee123.net/img/rand?artid=146063930
image: https://bing.ee123.net/img/rand?artid=146063930
img: https://bing.ee123.net/img/rand?artid=146063930
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     Git清理本地残留的、但已经在服务器上被删除的分支
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h2>
     <a id="_0">
     </a>
     要筛选出已经被服务器删除的本地分支，并在本地删除这些分支，可以按照以下步骤进行操作：
    </h2>
    <p>
     步骤 1: 获取远程分支信息，确保本地的远程分支信息是最新的：
    </p>
    <pre><code>git fetch -p
</code></pre>
    <p>
     步骤 2: 列出本地分支和远程分支：
    </p>
    <pre><code>git branch -vv
</code></pre>
    <p>
     步骤 3: 筛选出已经被服务器删除的本地分支：
    </p>
    <pre><code>git branch -vv | grep ': gone]' | awk '{print $1}'
</code></pre>
    <p>
     步骤 4: 删除已经被服务器删除的本地分支：
    </p>
    <pre><code>git branch -vv | grep ': gone]' | awk '{print $1}' | xargs -r git branch -D
</code></pre>
    <h2>
     <a id="_22">
     </a>
     详细解释
    </h2>
    <p>
     <code>
      git fetch -p
     </code>
     ：从远程仓库获取最新的分支信息，并删除本地已经不存在的远程分支。
    </p>
    <p>
     <code>
      git branch -vv
     </code>
     ：列出所有本地分支，并显示每个分支对应的远程分支和最新的提交信息。
    </p>
    <p>
     <code>
      grep ': gone]'
     </code>
     ：筛选出那些远程分支已经被删除的本地分支。‘: gone]’ 是 git branch -vv 输出中表示远程分支已删除的标记。
    </p>
    <p>
     <code>
      awk '{print $1}'
     </code>
     ：提取分支名称。
    </p>
    <p>
     <code>
      xargs -r git branch -D
     </code>
     ：使用 xargs 将筛选出的分支名称传递给
     <code>
      git branch -D
     </code>
     命令，批量删除这些本地分支。
    </p>
    <h2>
     <a id="_33">
     </a>
     示例
    </h2>
    <p>
     假设执行
     <code>
      git branch -vv
     </code>
     的输出如下：
    </p>
    <pre><code>  feature1 1234567 [origin/feature1: gone] Some commit message
  feature2 89abcdef [origin/feature2] Another commit message
  feature3 fedcba98 [origin/feature3: gone] Yet another commit message
</code></pre>
    <p>
     然后执行删除命令：
    </p>
    <pre><code>git branch -vv | grep ': gone]' | awk '{print $1}' | xargs -r git branch -D
</code></pre>
    <p>
     将会删除本地的
     <code>
      feature1
     </code>
     和
     <code>
      feature3
     </code>
     分支，因为它们对应的远程分支已经被删除。
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f:672e6373646e2e6e65742f596f756e67486f6e67313939322f:61727469636c652f64657461696c732f313436303633393330" class_="artid" style="display:none">
 </p>
</div>


