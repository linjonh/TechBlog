---
layout: post
title: "C20中的stdendian深入理解大端小端本地字节序"
date: 2025-03-13 00:00:00 +0800
description: "是一个枚举类，定义在<bit>：表示小端字节序。：表示大端字节序。：表示当前系统的本地字节序。通过比较与或，可以判断当前系统是小端还是大端。为C++开发者提供了一种标准化的方式来处理字节序问题。通过理解和使用，可以编写出更健壮、更可移植的代码，避免因字节序差异导致的错误。希望这篇文章能帮助你更好地理解C++20中的以及字节序的相关知识。"
keywords: "C++20中的`std::endian`：深入理解大端/小端/本地字节序"
categories: ['Ai']
tags: ['C']
artid: "146212887"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146212887
    alt: "C20中的stdendian深入理解大端小端本地字节序"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146212887
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146212887
cover: https://bing.ee123.net/img/rand?artid=146212887
image: https://bing.ee123.net/img/rand?artid=146212887
img: https://bing.ee123.net/img/rand?artid=146212887
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     C++20中的`std::endian`：深入理解大端/小端/本地字节序
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
     <img alt="生成特定比例图片 (8).png" src="https://i-blog.csdnimg.cn/img_convert/414d7e8d9ca6ecfec2e095608a220e24.png"/>
    </p>
    <p>
    </p>
    <br/>
    在C++20中，
    <code>
     std::endian
    </code>
    的引入为开发者提供了一种便捷的方式来处理和判断系统的字节序（Endianness）。字节序是指计算机存储多字节数据时字节的排列顺序，主要分为大端（Big-Endian）和小端（Little-Endian）两种形式。
    <p>
    </p>
    <h5>
     <a id="1__5">
     </a>
     1. 字节序的基本概念
    </h5>
    <ul>
     <li>
      <strong>
       大端（Big-Endian）
      </strong>
      ：将最高有效字节（MSB）存储在最低内存地址处。例如，十六进制数
      <code>
       0x12345678
      </code>
      在大端系统中存储为
      <code>
       0x12
      </code>
      、
      <code>
       0x34
      </code>
      、
      <code>
       0x56
      </code>
      、
      <code>
       0x78
      </code>
      。
     </li>
     <li>
      <strong>
       小端（Little-Endian）
      </strong>
      ：将最低有效字节（LSB）存储在最低内存地址处。同样的十六进制数在小端系统中存储为
      <code>
       0x78
      </code>
      、
      <code>
       0x56
      </code>
      、
      <code>
       0x34
      </code>
      、
      <code>
       0x12
      </code>
      。
     </li>
    </ul>
    <h5>
     <a id="2_stdendian_9">
     </a>
     2.
     <code>
      std::endian
     </code>
     的定义与使用
    </h5>
    <p>
     <code>
      std::endian
     </code>
     是一个枚举类，定义在
     <code>
      &lt;bit&gt;
     </code>
     头文件中，包含三个成员：
    </p>
    <ul>
     <li>
      <code>
       std::endian::little
      </code>
      ：表示小端字节序。
     </li>
     <li>
      <code>
       std::endian::big
      </code>
      ：表示大端字节序。
     </li>
     <li>
      <code>
       std::endian::native
      </code>
      ：表示当前系统的本地字节序。
     </li>
    </ul>
    <p>
     通过比较
     <code>
      std::endian::native
     </code>
     与
     <code>
      std::endian::little
     </code>
     或
     <code>
      std::endian::big
     </code>
     ，可以判断当前系统是小端还是大端。
    </p>
    <h5>
     <a id="3__17">
     </a>
     3. 示例代码
    </h5>
    <p>
     以下是一个简单的示例，展示如何使用
     <code>
      std::endian
     </code>
     来判断系统的字节序：
    </p>
    <pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;bit&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span>endian<span class="token double-colon punctuation">::</span>native <span class="token operator">==</span> std<span class="token double-colon punctuation">::</span>endian<span class="token double-colon punctuation">::</span>little<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"This computer is little-endian!"</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span>endian<span class="token double-colon punctuation">::</span>native <span class="token operator">==</span> std<span class="token double-colon punctuation">::</span>endian<span class="token double-colon punctuation">::</span>big<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"This computer is big-endian!"</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
        std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Can't tell the endianness of this computer."</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <h5>
     <a id="4__35">
     </a>
     4. 字节序的重要性
    </h5>
    <p>
     字节序在跨平台数据交换中至关重要。例如，网络协议通常使用大端字节序（网络字节序），而许多现代计算机（如x86架构）使用小端字节序。了解系统的字节序有助于开发可移植的代码，避免在不同系统间传输数据时出现错误。
    </p>
    <h5>
     <a id="5__38">
     </a>
     5. 字节序转换方法
    </h5>
    <p>
     在需要转换字节序时，可以使用以下方法：
    </p>
    <ul>
     <li>
      <strong>
       位移操作
      </strong>
      ：通过位移和逻辑运算手动交换字节。
     </li>
     <li>
      <strong>
       内置函数
      </strong>
      ：许多编译器提供了内置的字节序转换函数，如
      <code>
       __builtin_bswap32
      </code>
      。
     </li>
     <li>
      <strong>
       网络字节序函数
      </strong>
      ：使用
      <code>
       htons
      </code>
      、
      <code>
       ntohs
      </code>
      等函数进行字节序转换。
     </li>
     <li>
      <strong>
       C++23的
       <code>
        std::byteswap
       </code>
      </strong>
      ：C++23引入了
      <code>
       std::byteswap
      </code>
      ，提供了一种更简洁的字节序转换方式。
     </li>
    </ul>
    <h5>
     <a id="6__45">
     </a>
     6. 实际应用
    </h5>
    <p>
     在实际开发中，建议根据系统的本地字节序动态选择是否进行字节序转换。例如，当读取或写入大端格式的数据时，仅在小端系统上进行字节序转换。
    </p>
    <pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifdef</span> <span class="token expression">IS_BIG_ENDIAN</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">cpuToBE16</span><span class="token expression"><span class="token punctuation">(</span>val<span class="token punctuation">)</span> <span class="token punctuation">(</span>val<span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">beToCPU16</span><span class="token expression"><span class="token punctuation">(</span>val<span class="token punctuation">)</span> <span class="token punctuation">(</span>val<span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">cpuToLE16</span><span class="token expression"><span class="token punctuation">(</span>val<span class="token punctuation">)</span> <span class="token function">swapEndian16</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">leToCPU16</span><span class="token expression"><span class="token punctuation">(</span>val<span class="token punctuation">)</span> <span class="token function">swapEndian16</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">else</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">cpuToBE16</span><span class="token expression"><span class="token punctuation">(</span>val<span class="token punctuation">)</span> <span class="token function">swapEndian16</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">beToCPU16</span><span class="token expression"><span class="token punctuation">(</span>val<span class="token punctuation">)</span> <span class="token function">swapEndian16</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">cpuToLE16</span><span class="token expression"><span class="token punctuation">(</span>val<span class="token punctuation">)</span> <span class="token punctuation">(</span>val<span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">leToCPU16</span><span class="token expression"><span class="token punctuation">(</span>val<span class="token punctuation">)</span> <span class="token punctuation">(</span>val<span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>
</code></pre>
    <h5>
     <a id="7__61">
     </a>
     7. 总结
    </h5>
    <p>
     <code>
      std::endian
     </code>
     为C++开发者提供了一种标准化的方式来处理字节序问题。通过理解和使用
     <code>
      std::endian
     </code>
     ，可以编写出更健壮、更可移植的代码，避免因字节序差异导致的错误。
    </p>
    <p>
     希望这篇文章能帮助你更好地理解C++20中的
     <code>
      std::endian
     </code>
     以及字节序的相关知识。
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
  <div class="blog-extension-box" id="blogExtensionBox" style="width:400px;margin:auto;margin-top:12px">
  </div>
 </article>
 <p alt="68747470733a2f2f:626c6f672e6373646e2e6e65742f5a5f6f696f69686f69692f:61727469636c652f64657461696c732f313436323132383837" class_="artid" style="display:none">
 </p>
</div>


