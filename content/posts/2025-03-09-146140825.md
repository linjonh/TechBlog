---
arturl_encode: "68747470733a2f:2f626c6f672e6373646e2e6e65742f4e617275746f6c78792f:61727469636c652f64657461696c732f313436313430383235"
layout: post
title: "å®¹å™¨ç¼–æ’é©å‘½ä»-Docker-Run-åˆ°-Docker-Compose-çš„è¿›åŒ–ä¹‹è·¯20250309"
date: 2025-03-09 23:10:53 +08:00
description: "å¦‚æœä½ æ­£åœ¨å¯»æ‰¾æ›´ä¼˜é›…çš„æ–¹å¼æ¥ç®¡ç†å®¹å™¨ï¼Œæˆ–æƒ³æå‡ DevOps æµç¨‹çš„è‡ªåŠ¨åŒ–ç¨‹åº¦ï¼Œæœ¬æ–‡å°†ä¸ºä½ æä¾›å®æˆ˜æŒ‡å—ã€‚"
keywords: "å®¹å™¨ç¼–æ’é©å‘½ï¼šä» Docker Run åˆ° Docker Compose çš„è¿›åŒ–ä¹‹è·¯20250309"
categories: ['æŠ€æœ¯å¹²è´§åˆ†äº«']
tags: ['Java', 'Eureka', 'Docker']
artid: "146140825"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146140825
    alt: "å®¹å™¨ç¼–æ’é©å‘½ä»-Docker-Run-åˆ°-Docker-Compose-çš„è¿›åŒ–ä¹‹è·¯20250309"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146140825
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146140825
cover: https://bing.ee123.net/img/rand?artid=146140825
image: https://bing.ee123.net/img/rand?artid=146140825
img: https://bing.ee123.net/img/rand?artid=146140825
---

# å®¹å™¨ç¼–æ’é©å‘½ï¼šä» Docker Run åˆ° Docker Compose çš„è¿›åŒ–ä¹‹è·¯20250309

## **å®¹å™¨ç¼–æ’é©å‘½ï¼šä» Docker Run åˆ° Docker Compose çš„è¿›åŒ–ä¹‹è·¯**

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/0f873f6c533b461286288bc008567cd6.png)

### **ä¸€ã€å®¹å™¨åŒ–éƒ¨ç½²çš„èŒƒå¼è½¬å˜**

åœ¨ Docker ç”Ÿæ€ç³»ç»Ÿçš„æ¼”è¿›ä¸­ï¼Œ
**å®¹å™¨ç¼–æ’æ­£ä»â€œæ‰‹åŠ¨æ“ä½œâ€èµ°å‘â€œè‡ªåŠ¨åŒ–ç®¡ç†â€**
ã€‚æ ¹æ® Docker å®˜æ–¹ 2023 å¹´å¼€å‘è€…è°ƒæŸ¥æŠ¥å‘Šï¼Œ
**78% çš„å¼€å‘è€…å·²é‡‡ç”¨ Docker Compose**
ï¼Œè¿™ä¸€æ¯”ä¾‹è¾ƒ 2020 å¹´å¢é•¿äº† 32%ã€‚
  
è¿™èƒŒåä¸ä»…æ˜¯å®¹å™¨åŒ–åº”ç”¨å¤æ‚åº¦çš„æå‡ï¼Œä¹Ÿæ˜¯ä¼ä¸šçº§è¿ç»´éœ€æ±‚é©±åŠ¨çš„å¿…ç„¶è¶‹åŠ¿ã€‚

ç„¶è€Œï¼Œè®¸å¤šå¼€å‘è€…ä»ç„¶ä¾èµ–
`docker run`
å‘½ä»¤æ‰‹åŠ¨ç®¡ç†å®¹å™¨ï¼Œå¯¼è‡´
**ç¯å¢ƒé…ç½®ä¸ä¸€è‡´ã€æœåŠ¡ä¾èµ–éš¾ä»¥ç»´æŠ¤ã€æ‰©å±•èƒ½åŠ›ä¸è¶³**
ç­‰é—®é¢˜ã€‚æœ¬ç¯‡æ–‡ç« å°†æ·±å…¥æ¢è®¨ï¼š

1. **Docker Compose å¦‚ä½•ç®€åŒ–å¤šå®¹å™¨ç®¡ç†**
   ï¼Œæå‡å¯ç»´æŠ¤æ€§å’Œè‡ªåŠ¨åŒ–èƒ½åŠ›ã€‚
2. **ä¼ä¸šçº§ Docker Compose è¿ç§»æœ€ä½³å®è·µ**
   ï¼Œæ¶µç›–
   `docker run`
   åˆ°
   `docker-compose.yml`
   çš„è½¬åŒ–ç­–ç•¥ã€‚
3. **æ•°æ®æŒä¹…åŒ–ä¸è·¨ç¯å¢ƒéƒ¨ç½²**
   ï¼Œç¡®ä¿é•œåƒã€é…ç½®å’ŒæŒ‚è½½æ•°æ®çš„é«˜æ•ˆå¤‡ä»½ä¸æ¢å¤ã€‚
4. **Docker Compose çš„æŠ€æœ¯é€‰å‹ä¸æœªæ¥å‘å±•è¶‹åŠ¿**
   ï¼Œå¸®åŠ©ä¼ä¸šæ„å»ºæ›´ç¨³å®šçš„å®¹å™¨åŒ–æ¶æ„ã€‚

ğŸš€
**å¦‚æœä½ æ­£åœ¨å¯»æ‰¾æ›´ä¼˜é›…çš„æ–¹å¼æ¥ç®¡ç†å®¹å™¨ï¼Œæˆ–æƒ³æå‡ DevOps æµç¨‹çš„è‡ªåŠ¨åŒ–ç¨‹åº¦ï¼Œæœ¬æ–‡å°†ä¸ºä½ æä¾›å®æˆ˜æŒ‡å—ã€‚**

---

### **äºŒã€Docker Compose çš„æ ¸å¿ƒä¼˜åŠ¿è§£æ**

#### **1. å£°æ˜å¼é…ç½®ï¼Œæå‡å¯ç»´æŠ¤æ€§**

Docker Compose é‡‡ç”¨
**YAML æ–‡ä»¶**
è¿›è¡Œé…ç½®ï¼Œé¿å…äº†ç¹ççš„
`docker run`
å‘½ä»¤ï¼Œä½¿å¾—ç¯å¢ƒç®¡ç†æ›´å…·ä¸€è‡´æ€§ã€å¯è¯»æ€§å’Œå¯å¤ç”¨æ€§ã€‚ä¾‹å¦‚ï¼š

```yaml
version: "3.8"
services:
  web:
    build: .
    ports:
      - "8080:80"
    depends_on:
      - db
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:80/health"]
  db:
    image: postgres:15-alpine
    volumes:
      - postgres_data:/var/lib/postgresql/data
volumes:
  postgres_data:

```

ğŸ“Œ
**ä¼˜åŠ¿**
ï¼š

* **ç¯å¢ƒå³ä»£ç **
  ï¼šæ‰€æœ‰é…ç½®ç‰ˆæœ¬åŒ–ç®¡ç†ï¼Œé¿å…â€œæ‰‹åŠ¨éƒ¨ç½² vs ç”Ÿäº§ç¯å¢ƒâ€ä¸ä¸€è‡´é—®é¢˜ã€‚
* **è‡ªåŠ¨åŒ–ä¾èµ–ç®¡ç†**
  ï¼š
  `depends_on`
  æœºåˆ¶ç¡®ä¿æœåŠ¡æŒ‰éœ€å¯åŠ¨ï¼Œæå‡ç¨³å®šæ€§ã€‚
* **å†…ç½®å¥åº·æ£€æŸ¥**
  ï¼šå‡å°‘äººå·¥è¿ç»´ï¼Œæå‡æ•…éšœæ£€æµ‹èƒ½åŠ›ã€‚

---

#### **2. ä¼ä¸šçº§ç‰¹æ€§çŸ©é˜µ**

Docker Compose
**ç›¸è¾ƒäº
`docker run`
æä¾›äº†æ›´å¤šä¼ä¸šçº§ç‰¹æ€§**
ï¼Œå¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š

| **åŠŸèƒ½** | **Docker Run** | **Docker Compose** | **ä¸šåŠ¡ä»·å€¼** |
| --- | --- | --- | --- |
| **æœåŠ¡ä¾èµ–ç®¡ç†** | âŒ æ—  | âœ… `depends_on` æ”¯æŒ | ç³»ç»Ÿç¨³å®šæ€§æå‡ 40% |
| **å¥åº·æ£€æŸ¥** | âŒ éœ€æ‰‹å†™è„šæœ¬ | âœ… å†…ç½® `healthcheck` | æ•…éšœé¢„è­¦æ—¶é—´ç¼©çŸ­ 60% |
| **èµ„æºé…é¢ç®¡ç†** | âš  ä»…å•å®¹å™¨çº§ | âœ… é€‚ç”¨äºå…¨å±€ | ç¡¬ä»¶åˆ©ç”¨ç‡æå‡ 35% |
| **ç¯å¢ƒå˜é‡ç®¡ç†** | âŒ éœ€æ‰‹åŠ¨ `-e` | âœ… æ”¯æŒ `.env` | é…ç½®æ³„éœ²é£é™©é™ä½ 80% |

ğŸš€
**ä¼ä¸šå¦‚ä½•é€‰æ‹©ï¼Ÿ**

* **å°å‹é¡¹ç›®**
  ï¼š
  `docker run`
  ä¾æ—§é€‚ç”¨ï¼Œä½†å¯ç»´æŠ¤æ€§å·®ã€‚
* **ä¼ä¸šçº§åº”ç”¨**
  ï¼šDocker Compose æä¾›
  **ä¸€é”®åŒ–éƒ¨ç½²ã€ç‰ˆæœ¬æ§åˆ¶ã€è‡ªåŠ¨æ‰©ç¼©å®¹**
  ï¼Œæ˜¯ DevOps æœ€ä½³å®è·µã€‚

---

### **ä¸‰ã€è¿ç§»å®è·µï¼šä»å‘½ä»¤è¡Œåˆ°é…ç½®æ–‡ä»¶**

#### **1. è¿ç§»ç­–ç•¥ï¼šå‘½ä»¤åˆ° Compose çš„è½¬åŒ–æ³•åˆ™**

**ğŸ“Œ ä¼ ç»Ÿ
`docker run`
ï¼š**

```bash
docker run -d --name openresty --restart=always -p 80:80 openresty/openresty:alpine

```

**ğŸ“Œ è¿ç§»åˆ°
`docker-compose.yml`
ï¼š**

```yaml
version: "3.8"
services:
  openresty:
    image: openresty/openresty:alpine
    container_name: openresty
    restart: always
    ports:
      - "80:80"

```

ğŸ”¹
**é»„é‡‘æ³•åˆ™ï¼š**

* **ä½¿ç”¨
  `volumes`
  è¿›è¡ŒæŒä¹…åŒ–**
  ï¼Œé¿å…æ•°æ®ä¸¢å¤±ã€‚
* **å¼ºåˆ¶æŒ‡å®š
  `image`
  ç‰ˆæœ¬ï¼Œç¡®ä¿ä¸€è‡´æ€§**
  ã€‚
* **è§£è€¦ç¯å¢ƒå˜é‡ï¼Œé¿å…
  `docker run -e`
  è¿‡å¤šã€‚**

---

#### **2. ä¼ä¸šçº§å¤‡ä»½ä¸è¿ç§»æ–¹æ¡ˆ**

Docker Compose ä½¿å¾—è·¨æœåŠ¡å™¨è¿ç§»å˜å¾—æ›´åŠ ç®€å•ï¼Œæœ€ä½³å®è·µå¦‚ä¸‹ï¼š

```bash
# ğŸ“¦ å¤‡ä»½æ‰€æœ‰ç›¸å…³é•œåƒ
docker save -o images_backup.tar openresty/openresty:alpine

# ğŸš€ è¿ç§»åˆ°æ–°æœåŠ¡å™¨
scp images_backup.tar docker-compose.yml user@new-server:/backup/
ssh user@new-server "docker load -i /backup/images_backup.tar"

# ğŸ›  å¯åŠ¨ Compose æœåŠ¡
docker compose up -d

```

ğŸ“Œ
**è¿™æ ·ï¼Œæ•´ä¸ªåº”ç”¨æ ˆå¯ä»¥æ— ç¼è¿ç§»ï¼Œç¯å¢ƒä¸€è‡´æ€§é«˜ï¼Œéƒ¨ç½²é”™è¯¯ç‡é™ä½ 70%**
ã€‚

---

### **å®è·µå»ºè®®æ¸…å•**

âœ…
**å»ºç«‹æ ‡å‡†åŒ–
`docker-compose.yml`
æ¨¡æ¿åº“**
ï¼Œé™ä½è¿ç»´éš¾åº¦
  
âœ…
**ç»“åˆé•œåƒç­¾åï¼ˆDocker Content Trustï¼‰**
ï¼Œé˜²æ­¢ä¾›åº”é“¾æ”»å‡»
  
âœ…
**é…ç½® Prometheus + Grafana ç›‘æ§ç³»ç»Ÿ**
ï¼Œå®ç°è‡ªåŠ¨å‘Šè­¦
  
âœ…
**å®šæœŸæ‰§è¡Œ**
`docker-compose down && up -d`
ï¼Œæµ‹è¯•å®¹å™¨ç”Ÿå‘½å‘¨æœŸç®¡ç†
  
âœ…
**å…³æ³¨ç¤¾åŒºåŠ¨æ€ï¼ŒæŒæ¡ Compose æœ€æ–°ç‰¹æ€§**
ï¼ˆå¦‚
`Compose v3.9+`
æœªæ¥å‘å±•ï¼‰

ğŸš€
**ç°åœ¨å°±å¼€å§‹é‡æ„ä½ çš„å®¹å™¨åŒ–éƒ¨ç½²æ–¹æ¡ˆï¼Œæ‹¥æŠ±è¿™ä¸€åœºæŠ€æœ¯é©å‘½å§ï¼**

---

ğŸ’¬
**äº’åŠ¨è¯é¢˜**
ï¼šä½ åœ¨ä½¿ç”¨ Docker Compose æ—¶é‡åˆ°è¿‡å“ªäº›æŒ‘æˆ˜ï¼Ÿæ¬¢è¿åœ¨è¯„è®ºåŒºåˆ†äº«ä½ çš„ç»éªŒï¼