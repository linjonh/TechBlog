---
layout: post
title: "å®¹å™¨ç¼–æ’é©å‘½ä»-Docker-Run-åˆ°-Docker-Compose-çš„è¿›åŒ–ä¹‹è·¯20250309"
date: 2025-03-09 23:10:53 +0800
description: "å¦‚æœä½ æ­£åœ¨å¯»æ‰¾æ›´ä¼˜é›…çš„æ–¹å¼æ¥ç®¡ç†å®¹å™¨ï¼Œæˆ–æƒ³æå‡ DevOps æµç¨‹çš„è‡ªåŠ¨åŒ–ç¨‹åº¦ï¼Œæœ¬æ–‡å°†ä¸ºä½ æä¾›å®æˆ˜æŒ‡å—ã€‚"
keywords: "å®¹å™¨ç¼–æ’é©å‘½ï¼šä» Docker Run åˆ° Docker Compose çš„è¿›åŒ–ä¹‹è·¯20250309"
categories: ['æŠ€æœ¯å¹²è´§åˆ†äº«']
tags: ['Java', 'Eureka', 'Docker']
artid: "146140825"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146140825
    alt: "å®¹å™¨ç¼–æ’é©å‘½ä»-Docker-Run-åˆ°-Docker-Compose-çš„è¿›åŒ–ä¹‹è·¯20250309"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146140825
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146140825
cover: https://bing.ee123.net/img/rand?artid=146140825
image: https://bing.ee123.net/img/rand?artid=146140825
img: https://bing.ee123.net/img/rand?artid=146140825
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     å®¹å™¨ç¼–æ’é©å‘½ï¼šä» Docker Run åˆ° Docker Compose çš„è¿›åŒ–ä¹‹è·¯20250309
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h2>
     <a id="_Docker_Run__Docker_Compose__1">
     </a>
     <strong>
      å®¹å™¨ç¼–æ’é©å‘½ï¼šä» Docker Run åˆ° Docker Compose çš„è¿›åŒ–ä¹‹è·¯
     </strong>
    </h2>
    <p>
     <img alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" src="https://i-blog.csdnimg.cn/direct/0f873f6c533b461286288bc008567cd6.png"/>
    </p>
    <h3>
     <a id="_4">
     </a>
     <strong>
      ä¸€ã€å®¹å™¨åŒ–éƒ¨ç½²çš„èŒƒå¼è½¬å˜
     </strong>
    </h3>
    <p>
     åœ¨ Docker ç”Ÿæ€ç³»ç»Ÿçš„æ¼”è¿›ä¸­ï¼Œ
     <strong>
      å®¹å™¨ç¼–æ’æ­£ä»â€œæ‰‹åŠ¨æ“ä½œâ€èµ°å‘â€œè‡ªåŠ¨åŒ–ç®¡ç†â€
     </strong>
     ã€‚æ ¹æ® Docker å®˜æ–¹ 2023 å¹´å¼€å‘è€…è°ƒæŸ¥æŠ¥å‘Šï¼Œ
     <strong>
      78% çš„å¼€å‘è€…å·²é‡‡ç”¨ Docker Compose
     </strong>
     ï¼Œè¿™ä¸€æ¯”ä¾‹è¾ƒ 2020 å¹´å¢é•¿äº† 32%ã€‚
     <br/>
     è¿™èƒŒåä¸ä»…æ˜¯å®¹å™¨åŒ–åº”ç”¨å¤æ‚åº¦çš„æå‡ï¼Œä¹Ÿæ˜¯ä¼ä¸šçº§è¿ç»´éœ€æ±‚é©±åŠ¨çš„å¿…ç„¶è¶‹åŠ¿ã€‚
    </p>
    <p>
     ç„¶è€Œï¼Œè®¸å¤šå¼€å‘è€…ä»ç„¶ä¾èµ–
     <code>
      docker run
     </code>
     å‘½ä»¤æ‰‹åŠ¨ç®¡ç†å®¹å™¨ï¼Œå¯¼è‡´
     <strong>
      ç¯å¢ƒé…ç½®ä¸ä¸€è‡´ã€æœåŠ¡ä¾èµ–éš¾ä»¥ç»´æŠ¤ã€æ‰©å±•èƒ½åŠ›ä¸è¶³
     </strong>
     ç­‰é—®é¢˜ã€‚æœ¬ç¯‡æ–‡ç« å°†æ·±å…¥æ¢è®¨ï¼š
    </p>
    <ol>
     <li>
      <strong>
       Docker Compose å¦‚ä½•ç®€åŒ–å¤šå®¹å™¨ç®¡ç†
      </strong>
      ï¼Œæå‡å¯ç»´æŠ¤æ€§å’Œè‡ªåŠ¨åŒ–èƒ½åŠ›ã€‚
     </li>
     <li>
      <strong>
       ä¼ä¸šçº§ Docker Compose è¿ç§»æœ€ä½³å®è·µ
      </strong>
      ï¼Œæ¶µç›–
      <code>
       docker run
      </code>
      åˆ°
      <code>
       docker-compose.yml
      </code>
      çš„è½¬åŒ–ç­–ç•¥ã€‚
     </li>
     <li>
      <strong>
       æ•°æ®æŒä¹…åŒ–ä¸è·¨ç¯å¢ƒéƒ¨ç½²
      </strong>
      ï¼Œç¡®ä¿é•œåƒã€é…ç½®å’ŒæŒ‚è½½æ•°æ®çš„é«˜æ•ˆå¤‡ä»½ä¸æ¢å¤ã€‚
     </li>
     <li>
      <strong>
       Docker Compose çš„æŠ€æœ¯é€‰å‹ä¸æœªæ¥å‘å±•è¶‹åŠ¿
      </strong>
      ï¼Œå¸®åŠ©ä¼ä¸šæ„å»ºæ›´ç¨³å®šçš„å®¹å™¨åŒ–æ¶æ„ã€‚
     </li>
    </ol>
    <p>
     ğŸš€
     <strong>
      å¦‚æœä½ æ­£åœ¨å¯»æ‰¾æ›´ä¼˜é›…çš„æ–¹å¼æ¥ç®¡ç†å®¹å™¨ï¼Œæˆ–æƒ³æå‡ DevOps æµç¨‹çš„è‡ªåŠ¨åŒ–ç¨‹åº¦ï¼Œæœ¬æ–‡å°†ä¸ºä½ æä¾›å®æˆ˜æŒ‡å—ã€‚
     </strong>
    </p>
    <hr/>
    <h3>
     <a id="Docker_Compose__18">
     </a>
     <strong>
      äºŒã€Docker Compose çš„æ ¸å¿ƒä¼˜åŠ¿è§£æ
     </strong>
    </h3>
    <h4>
     <a id="1__19">
     </a>
     <strong>
      1. å£°æ˜å¼é…ç½®ï¼Œæå‡å¯ç»´æŠ¤æ€§
     </strong>
    </h4>
    <p>
     Docker Compose é‡‡ç”¨
     <strong>
      YAML æ–‡ä»¶
     </strong>
     è¿›è¡Œé…ç½®ï¼Œé¿å…äº†ç¹ççš„
     <code>
      docker run
     </code>
     å‘½ä»¤ï¼Œä½¿å¾—ç¯å¢ƒç®¡ç†æ›´å…·ä¸€è‡´æ€§ã€å¯è¯»æ€§å’Œå¯å¤ç”¨æ€§ã€‚ä¾‹å¦‚ï¼š
    </p>
    <pre><code class="prism language-yaml"><span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token string">"3.8"</span>
<span class="token key atrule">services</span><span class="token punctuation">:</span>
  <span class="token key atrule">web</span><span class="token punctuation">:</span>
    <span class="token key atrule">build</span><span class="token punctuation">:</span> .
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token string">"8080:80"</span>
    <span class="token key atrule">depends_on</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> db
    <span class="token key atrule">healthcheck</span><span class="token punctuation">:</span>
      <span class="token key atrule">test</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"CMD"</span><span class="token punctuation">,</span> <span class="token string">"curl"</span><span class="token punctuation">,</span> <span class="token string">"-f"</span><span class="token punctuation">,</span> <span class="token string">"http://localhost:80/health"</span><span class="token punctuation">]</span>
  <span class="token key atrule">db</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> postgres<span class="token punctuation">:</span>15<span class="token punctuation">-</span>alpine
    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> postgres_data<span class="token punctuation">:</span>/var/lib/postgresql/data
<span class="token key atrule">volumes</span><span class="token punctuation">:</span>
  <span class="token key atrule">postgres_data</span><span class="token punctuation">:</span>
</code></pre>
    <p>
     ğŸ“Œ
     <strong>
      ä¼˜åŠ¿
     </strong>
     ï¼š
    </p>
    <ul>
     <li>
      <strong>
       ç¯å¢ƒå³ä»£ç 
      </strong>
      ï¼šæ‰€æœ‰é…ç½®ç‰ˆæœ¬åŒ–ç®¡ç†ï¼Œé¿å…â€œæ‰‹åŠ¨éƒ¨ç½² vs ç”Ÿäº§ç¯å¢ƒâ€ä¸ä¸€è‡´é—®é¢˜ã€‚
     </li>
     <li>
      <strong>
       è‡ªåŠ¨åŒ–ä¾èµ–ç®¡ç†
      </strong>
      ï¼š
      <code>
       depends_on
      </code>
      æœºåˆ¶ç¡®ä¿æœåŠ¡æŒ‰éœ€å¯åŠ¨ï¼Œæå‡ç¨³å®šæ€§ã€‚
     </li>
     <li>
      <strong>
       å†…ç½®å¥åº·æ£€æŸ¥
      </strong>
      ï¼šå‡å°‘äººå·¥è¿ç»´ï¼Œæå‡æ•…éšœæ£€æµ‹èƒ½åŠ›ã€‚
     </li>
    </ul>
    <hr/>
    <h4>
     <a id="2__47">
     </a>
     <strong>
      2. ä¼ä¸šçº§ç‰¹æ€§çŸ©é˜µ
     </strong>
    </h4>
    <p>
     Docker Compose
     <strong>
      ç›¸è¾ƒäº
      <code>
       docker run
      </code>
      æä¾›äº†æ›´å¤šä¼ä¸šçº§ç‰¹æ€§
     </strong>
     ï¼Œå¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š
    </p>
    <table>
     <thead>
      <tr>
       <th>
        <strong>
         åŠŸèƒ½
        </strong>
       </th>
       <th>
        <strong>
         Docker Run
        </strong>
       </th>
       <th>
        <strong>
         Docker Compose
        </strong>
       </th>
       <th>
        <strong>
         ä¸šåŠ¡ä»·å€¼
        </strong>
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        <strong>
         æœåŠ¡ä¾èµ–ç®¡ç†
        </strong>
       </td>
       <td>
        âŒ æ— 
       </td>
       <td>
        âœ…
        <code>
         depends_on
        </code>
        æ”¯æŒ
       </td>
       <td>
        ç³»ç»Ÿç¨³å®šæ€§æå‡ 40%
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         å¥åº·æ£€æŸ¥
        </strong>
       </td>
       <td>
        âŒ éœ€æ‰‹å†™è„šæœ¬
       </td>
       <td>
        âœ… å†…ç½®
        <code>
         healthcheck
        </code>
       </td>
       <td>
        æ•…éšœé¢„è­¦æ—¶é—´ç¼©çŸ­ 60%
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         èµ„æºé…é¢ç®¡ç†
        </strong>
       </td>
       <td>
        âš  ä»…å•å®¹å™¨çº§
       </td>
       <td>
        âœ… é€‚ç”¨äºå…¨å±€
       </td>
       <td>
        ç¡¬ä»¶åˆ©ç”¨ç‡æå‡ 35%
       </td>
      </tr>
      <tr>
       <td>
        <strong>
         ç¯å¢ƒå˜é‡ç®¡ç†
        </strong>
       </td>
       <td>
        âŒ éœ€æ‰‹åŠ¨
        <code>
         -e
        </code>
       </td>
       <td>
        âœ… æ”¯æŒ
        <code>
         .env
        </code>
       </td>
       <td>
        é…ç½®æ³„éœ²é£é™©é™ä½ 80%
       </td>
      </tr>
     </tbody>
    </table>
    <p>
     ğŸš€
     <strong>
      ä¼ä¸šå¦‚ä½•é€‰æ‹©ï¼Ÿ
     </strong>
    </p>
    <ul>
     <li>
      <strong>
       å°å‹é¡¹ç›®
      </strong>
      ï¼š
      <code>
       docker run
      </code>
      ä¾æ—§é€‚ç”¨ï¼Œä½†å¯ç»´æŠ¤æ€§å·®ã€‚
     </li>
     <li>
      <strong>
       ä¼ä¸šçº§åº”ç”¨
      </strong>
      ï¼šDocker Compose æä¾›
      <strong>
       ä¸€é”®åŒ–éƒ¨ç½²ã€ç‰ˆæœ¬æ§åˆ¶ã€è‡ªåŠ¨æ‰©ç¼©å®¹
      </strong>
      ï¼Œæ˜¯ DevOps æœ€ä½³å®è·µã€‚
     </li>
    </ul>
    <hr/>
    <h3>
     <a id="_63">
     </a>
     <strong>
      ä¸‰ã€è¿ç§»å®è·µï¼šä»å‘½ä»¤è¡Œåˆ°é…ç½®æ–‡ä»¶
     </strong>
    </h3>
    <h4>
     <a id="1__Compose__64">
     </a>
     <strong>
      1. è¿ç§»ç­–ç•¥ï¼šå‘½ä»¤åˆ° Compose çš„è½¬åŒ–æ³•åˆ™
     </strong>
    </h4>
    <p>
     <strong>
      ğŸ“Œ ä¼ ç»Ÿ
      <code>
       docker run
      </code>
      ï¼š
     </strong>
    </p>
    <pre><code class="prism language-bash"><span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">--name</span> openresty <span class="token parameter variable">--restart</span><span class="token operator">=</span>always <span class="token parameter variable">-p</span> <span class="token number">80</span>:80 openresty/openresty:alpine
</code></pre>
    <p>
     <strong>
      ğŸ“Œ è¿ç§»åˆ°
      <code>
       docker-compose.yml
      </code>
      ï¼š
     </strong>
    </p>
    <pre><code class="prism language-yaml"><span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token string">"3.8"</span>
<span class="token key atrule">services</span><span class="token punctuation">:</span>
  <span class="token key atrule">openresty</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> openresty/openresty<span class="token punctuation">:</span>alpine
    <span class="token key atrule">container_name</span><span class="token punctuation">:</span> openresty
    <span class="token key atrule">restart</span><span class="token punctuation">:</span> always
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token string">"80:80"</span>
</code></pre>
    <p>
     ğŸ”¹
     <strong>
      é»„é‡‘æ³•åˆ™ï¼š
     </strong>
    </p>
    <ul>
     <li>
      <strong>
       ä½¿ç”¨
       <code>
        volumes
       </code>
       è¿›è¡ŒæŒä¹…åŒ–
      </strong>
      ï¼Œé¿å…æ•°æ®ä¸¢å¤±ã€‚
     </li>
     <li>
      <strong>
       å¼ºåˆ¶æŒ‡å®š
       <code>
        image
       </code>
       ç‰ˆæœ¬ï¼Œç¡®ä¿ä¸€è‡´æ€§
      </strong>
      ã€‚
     </li>
     <li>
      <strong>
       è§£è€¦ç¯å¢ƒå˜é‡ï¼Œé¿å…
       <code>
        docker run -e
       </code>
       è¿‡å¤šã€‚
      </strong>
     </li>
    </ul>
    <hr/>
    <h4>
     <a id="2__89">
     </a>
     <strong>
      2. ä¼ä¸šçº§å¤‡ä»½ä¸è¿ç§»æ–¹æ¡ˆ
     </strong>
    </h4>
    <p>
     Docker Compose ä½¿å¾—è·¨æœåŠ¡å™¨è¿ç§»å˜å¾—æ›´åŠ ç®€å•ï¼Œæœ€ä½³å®è·µå¦‚ä¸‹ï¼š
    </p>
    <pre><code class="prism language-bash"><span class="token comment"># ğŸ“¦ å¤‡ä»½æ‰€æœ‰ç›¸å…³é•œåƒ</span>
<span class="token function">docker</span> save <span class="token parameter variable">-o</span> images_backup.tar openresty/openresty:alpine

<span class="token comment"># ğŸš€ è¿ç§»åˆ°æ–°æœåŠ¡å™¨</span>
<span class="token function">scp</span> images_backup.tar docker-compose.yml user@new-server:/backup/
<span class="token function">ssh</span> user@new-server <span class="token string">"docker load -i /backup/images_backup.tar"</span>

<span class="token comment"># ğŸ›  å¯åŠ¨ Compose æœåŠ¡</span>
<span class="token function">docker</span> compose up <span class="token parameter variable">-d</span>
</code></pre>
    <p>
     ğŸ“Œ
     <strong>
      è¿™æ ·ï¼Œæ•´ä¸ªåº”ç”¨æ ˆå¯ä»¥æ— ç¼è¿ç§»ï¼Œç¯å¢ƒä¸€è‡´æ€§é«˜ï¼Œéƒ¨ç½²é”™è¯¯ç‡é™ä½ 70%
     </strong>
     ã€‚
    </p>
    <hr/>
    <h3>
     <a id="_107">
     </a>
     <strong>
      å®è·µå»ºè®®æ¸…å•
     </strong>
    </h3>
    <p>
     âœ…
     <strong>
      å»ºç«‹æ ‡å‡†åŒ–
      <code>
       docker-compose.yml
      </code>
      æ¨¡æ¿åº“
     </strong>
     ï¼Œé™ä½è¿ç»´éš¾åº¦
     <br/>
     âœ…
     <strong>
      ç»“åˆé•œåƒç­¾åï¼ˆDocker Content Trustï¼‰
     </strong>
     ï¼Œé˜²æ­¢ä¾›åº”é“¾æ”»å‡»
     <br/>
     âœ…
     <strong>
      é…ç½® Prometheus + Grafana ç›‘æ§ç³»ç»Ÿ
     </strong>
     ï¼Œå®ç°è‡ªåŠ¨å‘Šè­¦
     <br/>
     âœ…
     <strong>
      å®šæœŸæ‰§è¡Œ
     </strong>
     <code>
      docker-compose down &amp;&amp; up -d
     </code>
     ï¼Œæµ‹è¯•å®¹å™¨ç”Ÿå‘½å‘¨æœŸç®¡ç†
     <br/>
     âœ…
     <strong>
      å…³æ³¨ç¤¾åŒºåŠ¨æ€ï¼ŒæŒæ¡ Compose æœ€æ–°ç‰¹æ€§
     </strong>
     ï¼ˆå¦‚
     <code>
      Compose v3.9+
     </code>
     æœªæ¥å‘å±•ï¼‰
    </p>
    <p>
     ğŸš€
     <strong>
      ç°åœ¨å°±å¼€å§‹é‡æ„ä½ çš„å®¹å™¨åŒ–éƒ¨ç½²æ–¹æ¡ˆï¼Œæ‹¥æŠ±è¿™ä¸€åœºæŠ€æœ¯é©å‘½å§ï¼
     </strong>
    </p>
    <hr/>
    <p>
     ğŸ’¬
     <strong>
      äº’åŠ¨è¯é¢˜
     </strong>
     ï¼šä½ åœ¨ä½¿ç”¨ Docker Compose æ—¶é‡åˆ°è¿‡å“ªäº›æŒ‘æˆ˜ï¼Ÿæ¬¢è¿åœ¨è¯„è®ºåŒºåˆ†äº«ä½ çš„ç»éªŒï¼
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f:2f626c6f672e6373646e2e6e65742f4e617275746f6c78792f:61727469636c652f64657461696c732f313436313430383235" class_="artid" style="display:none">
 </p>
</div>


