---
layout: post
title: "Tsfresh-TA-Lib-LightGBM-A-è‚¡å¸‚åœºé‡åŒ–æŠ•èµ„ç­–ç•¥å®æˆ˜å…¥é—¨"
date: 2025-03-16 20:25:30 +0800
description: "æœ¬æ–‡ä»‹ç»äº†ä¸€ä¸ªé¢å‘Aè‚¡å¸‚åœºçš„é‡åŒ–æŠ•èµ„ç­–ç•¥å®æˆ˜é¡¹ç›®ï¼Œæ¶µç›–æ•°æ®è·å–ã€ç‰¹å¾æå–ã€æ¨¡å‹è®­ç»ƒã€ç­–ç•¥åˆ¶å®šä¸å›æµ‹è¯„ä¼°ç­‰ç¯èŠ‚ï¼Œæ—¨åœ¨ä¸ºé‡åŒ–æŠ€æœ¯åˆå­¦è€…æä¾›ä¸€ä¸ªç³»ç»Ÿçš„å…¥é—¨æŒ‡å—ã€‚"
keywords: "Tsfresh + TA-Lib + LightGBM ï¼šA è‚¡å¸‚åœºé‡åŒ–æŠ•èµ„ç­–ç•¥å®æˆ˜å…¥é—¨"
categories: ['é‡‘èç§‘æŠ€', 'Python']
tags: ['é‡åŒ–æŠ€æœ¯', 'ç­–ç•¥å¼€å‘', 'Tsfresh', 'Python', 'Lightgbm', 'Lib']
artid: "146300781"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146300781
    alt: "Tsfresh-TA-Lib-LightGBM-A-è‚¡å¸‚åœºé‡åŒ–æŠ•èµ„ç­–ç•¥å®æˆ˜å…¥é—¨"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146300781
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146300781
cover: https://bing.ee123.net/img/rand?artid=146300781
image: https://bing.ee123.net/img/rand?artid=146300781
img: https://bing.ee123.net/img/rand?artid=146300781
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     Tsfresh + TA-Lib + LightGBM ï¼šA è‚¡å¸‚åœºé‡åŒ–æŠ•èµ„ç­–ç•¥å®æˆ˜å…¥é—¨
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h2>
     <a id="Tsfresh__TALib__LightGBM_A__0">
     </a>
     Tsfresh + TA-Lib + LightGBM ï¼šA è‚¡å¸‚åœºé‡åŒ–æŠ•èµ„ç­–ç•¥å®æˆ˜å…¥é—¨
    </h2>
    <blockquote>
     <p>
      æœ¬é¡¹ç›®ä»¥ A è‚¡å¸‚åœºä¸ºç ”ç©¶å¯¹è±¡ï¼Œé€šè¿‡é‡åŒ–æŠ€æœ¯å¯¹å¸‚åœºæ•°æ®è¿›è¡Œåˆ†æï¼Œæ„å»ºé‡åŒ–æŠ•èµ„ç­–ç•¥ï¼Œå¹¶åˆ©ç”¨å†å²æ•°æ®å›æµ‹éªŒè¯ç­–ç•¥çš„æœ‰æ•ˆæ€§ã€‚é¡¹ç›®æ—¨åœ¨ä¸ºé‡åŒ–æŠ€æœ¯åˆå­¦è€…æä¾›ä¸€ä¸ªç³»ç»Ÿçš„å­¦ä¹ æ¡†æ¶ï¼Œå¸®åŠ©è¯»è€…æŒæ¡ä»æ•°æ®è·å–åˆ°ç­–ç•¥è¯„ä¼°çš„å…¨æµç¨‹æ“ä½œã€‚
      <br/>
      <em>
       æ–‡ä¸­å†…å®¹ä»…é™æŠ€æœ¯å­¦ä¹ ä¸ä»£ç å®è·µå‚è€ƒï¼Œå¸‚åœºå­˜åœ¨ä¸ç¡®å®šæ€§ï¼ŒæŠ€æœ¯åˆ†æéœ€è°¨æ…éªŒè¯ï¼Œä¸æ„æˆä»»ä½•æŠ•èµ„å»ºè®®ã€‚é€‚åˆé‡åŒ–æ–°æ‰‹å»ºç«‹ç³»ç»Ÿè®¤çŸ¥ï¼Œä¸ºç­–ç•¥å¼€å‘æ‰“ä¸‹åŸºç¡€ã€‚
      </em>
     </p>
    </blockquote>
    <p>
     â€¼ï¸ å­¦ä¹ åŸºç¡€çŸ¥è¯†æ¨èé˜…è¯»
     <a href="https://blog.csdn.net/weixin_47339916/category_12907174.html">
      Python é‡‘èç§‘æŠ€ æŠ€æœ¯ä¸“æ  ğŸš€
     </a>
     ï¼š
    </p>
    <ul>
     <li>
      <a href="https://stock.blog.csdn.net/article/details/146287009" rel="nofollow">
       tsfreshï¼šæ—¶é—´åºåˆ—ç‰¹å¾è‡ªåŠ¨æå–ä¸åº”ç”¨ ğŸ”¥
      </a>
     </li>
     <li>
      <a href="https://stock.blog.csdn.net/article/details/146275433" rel="nofollow">
       æ·±å…¥TA-Libï¼šé‡åŒ–æŠ€æœ¯æŒ‡æ ‡è¯¦è§£ ğŸ”¥
      </a>
     </li>
     <li>
      <a href="https://stock.blog.csdn.net/article/details/146050258" rel="nofollow">
       Pandas+PyArrowï¼šè‚¡ç¥¨æ•°æ®å­˜å‚¨ Parquet å…¥é—¨æŒ‡å¼• ğŸ”¥
      </a>
     </li>
     <li>
      <a href="https://stock.blog.csdn.net/article/details/146264849" rel="nofollow">
       Daskï¼šPythoné«˜æ•ˆå¹¶è¡Œè®¡ç®—åˆ©å™¨ ğŸ”¥
      </a>
     </li>
    </ul>
    <h3>
     <a id="1__12">
     </a>
     1. é¡¹ç›®æ¦‚è¿°
    </h3>
    <h4>
     <a id="11__14">
     </a>
     1.1 é¡¹ç›®ç›®æ ‡
    </h4>
    <ol>
     <li>
      <p>
       <strong>
        æ•°æ®è·å–ä¸å­˜å‚¨
       </strong>
       <br/>
       ä½¿ç”¨ tushare å·¥å…·è·å– A è‚¡è‚¡ç¥¨çš„å†å²æ—¥çº¿æ•°æ®ï¼Œç¡®ä¿æ•°æ®çš„å‡†ç¡®æ€§å’Œå®Œæ•´æ€§ã€‚å€ŸåŠ© Dask å’Œ Parquet æŠ€æœ¯è¿›è¡Œæ•°æ®å­˜å‚¨ï¼Œä¼˜åŒ–æ•°æ®è¯»å†™æ•ˆç‡ï¼Œä¸ºåç»­åˆ†ææä¾›æ”¯æŒã€‚
      </p>
     </li>
     <li>
      <p>
       <strong>
        ç‰¹å¾æå–ä¸ç­›é€‰
       </strong>
       <br/>
       åˆ©ç”¨ tsfresh æå–æ—¶é—´åºåˆ—ç‰¹å¾ï¼Œä»å†å²æ•°æ®ä¸­æŒ–æ˜ä¸è‚¡ç¥¨æœªæ¥æ”¶ç›Šç‡ç›¸å…³çš„ç‰¹å¾ã€‚é€šè¿‡ç›¸å…³æ€§åˆ†æå’Œç‰¹å¾ç­›é€‰ï¼Œç¡®å®šå¯¹é¢„æµ‹ç›®æ ‡å…·æœ‰æ˜¾è‘—å½±å“çš„ç‰¹å¾é›†åˆã€‚
      </p>
     </li>
     <li>
      <p>
       <strong>
        æ¨¡å‹è®­ç»ƒä¸ä¼˜åŒ–
       </strong>
       <br/>
       åŸºäºç­›é€‰åçš„ç‰¹å¾ï¼Œä½¿ç”¨ LightGBM æœºå™¨å­¦ä¹ ç®—æ³•è¿›è¡Œæ¨¡å‹è®­ç»ƒï¼Œå¹¶é€šè¿‡ Optuna è¿›è¡Œè¶…å‚æ•°ä¼˜åŒ–ã€‚ç›®æ ‡æ˜¯æ„å»ºä¸€ä¸ªèƒ½å¤Ÿæœ‰æ•ˆé¢„æµ‹è‚¡ç¥¨æœªæ¥æ”¶ç›Šç‡çš„æ¨¡å‹ã€‚
      </p>
     </li>
     <li>
      <p>
       <strong>
        äº¤æ˜“ç­–ç•¥åˆ¶å®šä¸å›æµ‹è¯„ä¼°
       </strong>
       <br/>
       æ ¹æ®æ¨¡å‹é¢„æµ‹ç»“æœï¼Œè®¾è®¡é‡åŒ–äº¤æ˜“ç­–ç•¥ï¼Œå¹¶é€šè¿‡å†å²æ•°æ®å›æµ‹éªŒè¯ç­–ç•¥æ€§èƒ½ã€‚ä¼˜åŒ–ç­–ç•¥çš„ä¿¡å·ç”Ÿæˆå’Œä¹°å–æ—¶æœºï¼Œè®¡ç®—ç­–ç•¥è¯„ä»·æŒ‡æ ‡ï¼ˆå¦‚å¤æ™®æ¯”ç‡ã€æœ€å¤§å›æ’¤ç­‰ï¼‰ï¼Œå¹¶ç»˜åˆ¶ç­–ç•¥è¡¨ç°æ›²çº¿ã€‚
      </p>
     </li>
     <li>
      <p>
       <strong>
        é£é™©æ”¶ç›Šåˆ†æä¸ç­–ç•¥ä¼˜åŒ–
       </strong>
       <br/>
       åˆ†æç­–ç•¥çš„é£é™©æ”¶ç›Šç‰¹å¾ï¼Œç»“åˆå›æµ‹ç»“æœä¼˜åŒ–ç­–ç•¥å‚æ•°ã€‚é€šè¿‡è¯¦ç»†è§£è¯»ç­–ç•¥è¡¨ç°ï¼Œå¸®åŠ©è¯»è€…ç†è§£ç­–ç•¥çš„ä¼˜åŠ¿ä¸ä¸è¶³ï¼Œä¸ºè¿›ä¸€æ­¥ä¼˜åŒ–æä¾›æ–¹å‘ã€‚
      </p>
     </li>
    </ol>
    <h4>
     <a id="12__31">
     </a>
     1.2 é¡¹ç›®æ„ä¹‰
    </h4>
    <p>
     æœ¬é¡¹ç›®æ—¨åœ¨ä¸ºé‡åŒ–æŠ€æœ¯åˆå­¦è€…æä¾›ä¸€ä¸ªå®Œæ•´çš„å®æˆ˜æ¡ˆä¾‹ï¼Œæ¶µç›–æ•°æ®å¤„ç†ã€ç‰¹å¾å·¥ç¨‹ã€æ¨¡å‹è®­ç»ƒã€ç­–ç•¥å›æµ‹å’Œé£é™©åˆ†æç­‰å…³é”®ç¯èŠ‚ã€‚é€šè¿‡ç³»ç»Ÿçš„å­¦ä¹ å’Œå®è·µï¼Œè¯»è€…å¯ä»¥æŒæ¡é‡åŒ–æŠ€æœ¯çš„åŸºæœ¬æ–¹æ³•ï¼Œç†è§£é‡åŒ–ç­–ç•¥çš„æ„å»ºè¿‡ç¨‹ï¼Œå¹¶ä¸ºè¿›ä¸€æ­¥æ·±å…¥ç ”ç©¶æ‰“ä¸‹åšå®åŸºç¡€ã€‚
    </p>
    <h3>
     <a id="2__35">
     </a>
     2. æŠ€æœ¯ä»‹ç»
    </h3>
    <h4>
     <a id="21_Tushare_37">
     </a>
     2.1 Tushare
    </h4>
    <p>
     <strong>
      <code>
       Tushare
      </code>
     </strong>
     æ˜¯ä¸€ä¸ªå…è´¹ä¸”å¼€æºçš„é‡‘èæ•°æ®æ¥å£åº“ï¼Œå®ƒä¸»è¦æœåŠ¡äºPythonå¼€å‘è€…ã€‚é€šè¿‡Tushareï¼Œç”¨æˆ·å¯ä»¥è½»æ¾è·å–è‚¡ç¥¨ã€æœŸè´§ã€å¤–æ±‡ç­‰å¤šç§ç±»å‹çš„é‡‘èå¸‚åœºæ•°æ®ã€‚å…¶ç‰¹ç‚¹åŒ…æ‹¬ï¼š
    </p>
    <ul>
     <li>
      <strong>
       ä¸°å¯Œçš„æ•°æ®æº
      </strong>
      ï¼šæ”¯æŒä»Aè‚¡åˆ°ç¾è‚¡ã€æ¸¯è‚¡ç­‰å…¨çƒå¤šä¸ªå¸‚åœºçš„æ•°æ®ã€‚
     </li>
     <li>
      <strong>
       æ˜“äºä½¿ç”¨
      </strong>
      ï¼šæä¾›äº†ç®€æ´çš„APIæ¥å£ï¼Œæ–¹ä¾¿ç”¨æˆ·å¿«é€Ÿä¸Šæ‰‹ã€‚
     </li>
     <li>
      <strong>
       ç¤¾åŒºæ´»è·ƒ
      </strong>
      ï¼šæ‹¥æœ‰åºå¤§çš„ç”¨æˆ·ç¾¤ä½“å’Œæ´»è·ƒçš„ç¤¾åŒºæ”¯æŒï¼Œä¸æ–­æ›´æ–°ç»´æŠ¤ã€‚
     </li>
     <li>
      <strong>
       æ–‡æ¡£è¯¦å°½
      </strong>
      ï¼šå®˜æ–¹æä¾›äº†è¯¦ç»†çš„æ–‡æ¡£æ•™ç¨‹ï¼Œå¸®åŠ©æ–°æ‰‹å…¥é—¨ã€‚
     </li>
    </ul>
    <h4>
     <a id="22_Tsfresh_46">
     </a>
     2.2 Tsfresh
    </h4>
    <p>
     <strong>
      <code>
       Tsfresh (Time Series Feature extraction based on scalable hypothesis tests)
      </code>
     </strong>
     æ˜¯ä¸€ä¸ªå¼ºå¤§çš„æ—¶é—´åºåˆ—ç‰¹å¾æå–å·¥å…·ï¼Œæ—¨åœ¨è‡ªåŠ¨è¯†åˆ«å‡ºå¯¹äºé¢„æµ‹ä»»åŠ¡æœ‰ç”¨çš„ç‰¹å¾ã€‚å®ƒçš„ä¼˜åŠ¿åœ¨äºï¼š
    </p>
    <ul>
     <li>
      <strong>
       è‡ªåŠ¨åŒ–
      </strong>
      ï¼šèƒ½å¤Ÿè‡ªåŠ¨ç”Ÿæˆæ•°ç™¾ç§å¯èƒ½å¯¹æ¨¡å‹æœ‰ç”¨çš„ç‰¹å¾ï¼Œå‡å°‘äº†æ‰‹åŠ¨é€‰æ‹©ç‰¹å¾çš„å·¥ä½œé‡ã€‚
     </li>
     <li>
      <strong>
       é«˜æ•ˆæ€§
      </strong>
      ï¼šåˆ©ç”¨å¹¶è¡Œå¤„ç†æŠ€æœ¯æé«˜ç‰¹å¾æå–çš„é€Ÿåº¦ã€‚
     </li>
     <li>
      <strong>
       çµæ´»æ€§
      </strong>
      ï¼šä¸ä»…é™äºç‰¹å®šç±»å‹çš„æ—¶é—´åºåˆ—æ•°æ®ï¼Œé€‚ç”¨äºå¤šç§åœºæ™¯ä¸‹çš„æ•°æ®åˆ†æã€‚
     </li>
     <li>
      <strong>
       é›†æˆå‹å¥½
      </strong>
      ï¼šä¸Scikit-learnç­‰æµè¡Œæœºå™¨å­¦ä¹ åº“è‰¯å¥½å…¼å®¹ã€‚
     </li>
    </ul>
    <h4>
     <a id="23_Dask_55">
     </a>
     2.3 Dask
    </h4>
    <p>
     <strong>
      <code>
       Dask
      </code>
     </strong>
     æ˜¯ä¸€ç§çµæ´»çš„å¹¶è¡Œè®¡ç®—åº“ï¼Œç‰¹åˆ«é€‚åˆå¤„ç†è¶…å‡ºå†…å­˜é™åˆ¶çš„å¤§è§„æ¨¡æ•°æ®é›†ã€‚å®ƒçš„ç‰¹æ€§æœ‰ï¼š
    </p>
    <ul>
     <li>
      <strong>
       æ‰©å±•æ€§å¼º
      </strong>
      ï¼šæ—¢å¯ä»¥åœ¨å•æœºä¸Šè¿è¡Œä¹Ÿå¯ä»¥éƒ¨ç½²åœ¨åˆ†å¸ƒå¼é›†ç¾¤ä¸­ã€‚
     </li>
     <li>
      <strong>
       åŠ¨æ€è°ƒåº¦
      </strong>
      ï¼šæ ¹æ®ä»»åŠ¡éœ€æ±‚æ™ºèƒ½è°ƒæ•´èµ„æºåˆ†é…ã€‚
     </li>
     <li>
      <strong>
       æ¥å£ç†Ÿæ‚‰
      </strong>
      ï¼šè®¾è®¡é£æ ¼ç±»ä¼¼äºPandaså’ŒNumPyï¼Œé™ä½äº†å­¦ä¹ æˆæœ¬ã€‚
     </li>
     <li>
      <strong>
       ç”Ÿæ€ç³»ç»Ÿä¸°å¯Œ
      </strong>
      ï¼šæ”¯æŒå¤šç§å­˜å‚¨æ ¼å¼å¦‚HDF5ã€Parquetç­‰ï¼Œå¹¶ä¸å…¶ä»–å¤§æ•°æ®æ¡†æ¶ï¼ˆå¦‚Sparkï¼‰å…·æœ‰è‰¯å¥½çš„äº’æ“ä½œæ€§ã€‚
     </li>
    </ul>
    <h4>
     <a id="24_Parquet_64">
     </a>
     2.4 Parquet
    </h4>
    <p>
     <strong>
      <code>
       Parquet
      </code>
     </strong>
     æ˜¯ä¸€ç§åˆ—å¼å­˜å‚¨æ ¼å¼ï¼Œå¹¿æ³›åº”ç”¨äºå¤§æ•°æ®é¢†åŸŸã€‚ç›¸æ¯”äºä¼ ç»Ÿçš„è¡Œå¼å­˜å‚¨ï¼ŒParquetçš„ä¼˜åŠ¿åœ¨äºï¼š
    </p>
    <ul>
     <li>
      <strong>
       å‹ç¼©æ•ˆç‡é«˜
      </strong>
      ï¼šé‡‡ç”¨åˆ—å¼å­˜å‚¨å¯ä»¥æ›´æœ‰æ•ˆåœ°å‹ç¼©ç›¸åŒç±»å‹çš„æ•°æ®ã€‚
     </li>
     <li>
      <strong>
       æŸ¥è¯¢é€Ÿåº¦å¿«
      </strong>
      ï¼šä»…è¯»å–éœ€è¦åˆ†æçš„åˆ—ï¼Œé¿å…äº†ä¸å¿…è¦çš„I/Oå¼€é”€ã€‚
     </li>
     <li>
      <strong>
       è·¨å¹³å°å…¼å®¹
      </strong>
      ï¼šè¢«è®¸å¤šä¸»æµçš„å¤§æ•°æ®å¤„ç†ç³»ç»Ÿæ”¯æŒï¼Œå¦‚Apache Spark, Apache Hadoopç­‰ã€‚
     </li>
     <li>
      <strong>
       å…ƒæ•°æ®ä¸°å¯Œ
      </strong>
      ï¼šæ–‡ä»¶å†…åµŒå…¥äº†è¯¦ç»†çš„ç»Ÿè®¡ä¿¡æ¯ï¼Œä¾¿äºè¿›è¡Œé¢„å¤„ç†ä¼˜åŒ–ã€‚
     </li>
    </ul>
    <h4>
     <a id="25_LightGBM_73">
     </a>
     2.5 LightGBM
    </h4>
    <p>
     <strong>
      <code>
       LightGBM
      </code>
     </strong>
     æ˜¯ç”±å¾®è½¯å¼€å‘çš„ä¸€ç§åŸºäºæ¢¯åº¦æå‡å†³ç­–æ ‘ç®—æ³•çš„æœºå™¨å­¦ä¹ æ¡†æ¶ï¼Œä»¥å…¶å®ç°é€Ÿåº¦å’Œå‡†ç¡®æ€§è‘—ç§°ã€‚ä¸»è¦ä¼˜ç‚¹å¦‚ä¸‹ï¼š
    </p>
    <ul>
     <li>
      <strong>
       é«˜æ•ˆæ€§
      </strong>
      ï¼šé‡‡ç”¨äº†GOSS (Gradient-based One-Side Sampling) å’Œ EFB (Exclusive Feature Bundling) ç­‰åˆ›æ–°æŠ€æœ¯æ¥åŠ é€Ÿè®­ç»ƒè¿‡ç¨‹ã€‚
     </li>
     <li>
      <strong>
       å†…å­˜å ç”¨å°
      </strong>
      ï¼šç›¸è¾ƒäºå…¶ä»–åŒç±»ç®—æ³•ï¼Œåœ¨å¤„ç†å¤§è§„æ¨¡æ•°æ®æ—¶æ›´åŠ èŠ‚çœå†…å­˜ã€‚
     </li>
     <li>
      <strong>
       æ˜“äºä½¿ç”¨
      </strong>
      ï¼šæä¾›äº†Pythonã€Rç­‰å¤šä¸ªè¯­è¨€ç‰ˆæœ¬çš„æ”¯æŒï¼Œå¹¶ä¸”é…ç½®é€‰é¡¹ä¸°å¯Œã€‚
     </li>
     <li>
      <strong>
       æ€§èƒ½ä¼˜è¶Š
      </strong>
      ï¼šåœ¨å¤šé¡¹åŸºå‡†æµ‹è¯•ä¸­è¡¨ç°å‡ºè‰²ï¼Œç‰¹åˆ«æ˜¯åœ¨åˆ†ç±»é—®é¢˜ä¸Šã€‚
     </li>
    </ul>
    <h4>
     <a id="26_Optuna_82">
     </a>
     2.6 Optuna
    </h4>
    <p>
     <strong>
      <code>
       Optuna
      </code>
     </strong>
     æ˜¯ä¸€æ¬¾ä¸“ä¸ºè¶…å‚æ•°ä¼˜åŒ–è®¾è®¡çš„å¼€æºè½¯ä»¶åº“ï¼Œå¯ä»¥å¸®åŠ©ç ”ç©¶äººå‘˜æˆ–å·¥ç¨‹å¸ˆæ›´å¿«åœ°æ‰¾åˆ°æœ€ä¼˜çš„æ¨¡å‹é…ç½®ã€‚ç‰¹è‰²åŠŸèƒ½åŒ…æ‹¬ï¼š
    </p>
    <ul>
     <li>
      <strong>
       ç®€å•æ˜“ç”¨
      </strong>
      ï¼šåªéœ€å‡ è¡Œä»£ç å³å¯å¯åŠ¨æœç´¢è¿‡ç¨‹ã€‚
     </li>
     <li>
      <strong>
       çµæ´»æ€§é«˜
      </strong>
      ï¼šæ”¯æŒå®šä¹‰å¤æ‚çš„æœç´¢ç©ºé—´ä»¥åŠè‡ªå®šä¹‰ç›®æ ‡å‡½æ•°ã€‚
     </li>
     <li>
      <strong>
       å¯è§†åŒ–å¥½
      </strong>
      ï¼šå†…ç½®äº†ä¸°å¯Œçš„å›¾è¡¨ç»˜åˆ¶åŠŸèƒ½ï¼Œä¾¿äºè§‚å¯Ÿä¼˜åŒ–è¿‡ç¨‹ã€‚
     </li>
     <li>
      <strong>
       å¤šåç«¯æ”¯æŒ
      </strong>
      ï¼šæ—¢å¯ä»¥å•ç‹¬è¿è¡Œä¹Ÿå¯ä»¥é›†æˆåˆ°ç°æœ‰çš„æœºå™¨å­¦ä¹ æµæ°´çº¿ä¸­ã€‚
     </li>
    </ul>
    <h4>
     <a id="27_TALib_91">
     </a>
     2.7 TA-Lib
    </h4>
    <p>
     <strong>
      <code>
       TA-Lib (Technical Analysis Library)
      </code>
     </strong>
     æ˜¯ä¸€ä¸ªå¹¿æ³›ä½¿ç”¨çš„å¼€æºæŠ€æœ¯åˆ†æåº“ï¼Œä¸»è¦ç”¨äºé‡‘èå¸‚åœºçš„æŠ€æœ¯æŒ‡æ ‡è®¡ç®—ã€‚å…¶ç‰¹ç‚¹åŒ…æ‹¬ï¼š
    </p>
    <ul>
     <li>
      <strong>
       å…¨é¢çš„æŠ€æœ¯æŒ‡æ ‡
      </strong>
      ï¼šæä¾›äº†è¶…è¿‡150ç§å¸¸ç”¨çš„æŠ€æœ¯åˆ†ææŒ‡æ ‡ï¼Œå¦‚ç§»åŠ¨å¹³å‡çº¿ã€MACDã€RSIç­‰ã€‚
     </li>
     <li>
      <strong>
       é«˜æ€§èƒ½
      </strong>
      ï¼šåº•å±‚å®ç°æ˜¯ç”¨Cè¯­è¨€ç¼–å†™çš„ï¼Œç¡®ä¿äº†è®¡ç®—é€Ÿåº¦ã€‚
     </li>
     <li>
      <strong>
       å¤šè¯­è¨€æ”¯æŒ
      </strong>
      ï¼šé™¤äº†åŸç”Ÿçš„Cè¯­è¨€å¤–ï¼Œè¿˜æä¾›äº†Pythonã€Javaã€C#ç­‰å¤šç§è¯­è¨€çš„ç»‘å®šã€‚
     </li>
     <li>
      <strong>
       æ˜“äºé›†æˆ
      </strong>
      ï¼šå¯ä»¥å¾ˆå®¹æ˜“åœ°ä¸Pandasç­‰æ•°æ®å¤„ç†åº“ç»“åˆä½¿ç”¨ï¼Œé€‚ç”¨äºå„ç§é‡‘èåˆ†æå’Œäº¤æ˜“ç­–ç•¥å¼€å‘ã€‚
     </li>
     <li>
      <strong>
       ç¤¾åŒºæ´»è·ƒ
      </strong>
      ï¼šæ‹¥æœ‰æ´»è·ƒçš„ç”¨æˆ·ç¤¾åŒºå’Œä¸°å¯Œçš„æ–‡æ¡£èµ„æºï¼Œä¾¿äºå­¦ä¹ å’Œä½¿ç”¨ã€‚
     </li>
    </ul>
    <h3>
     <a id="3__101">
     </a>
     3. é¡¹ç›®ç»“æ„
    </h3>
    <pre><code class="prism language-text">project_root/
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ raw_data.parquet
â”‚   â”œâ”€â”€ selected_features.parquet
â”‚   â””â”€â”€ target.parquet
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ data_loader.py
â”‚   â”œâ”€â”€ feature_engineering.py
â”‚   â”œâ”€â”€ final_model.txt
â”‚   â”œâ”€â”€ model_training.py
â”‚   â”œâ”€â”€ strategy_backtesting.py
â”‚   â””â”€â”€ utils.py
â”œâ”€â”€ README.md
â””â”€â”€ requirements.txt
</code></pre>
    <h4>
     <a id="_120">
     </a>
     è¯¦ç»†è¯´æ˜
    </h4>
    <ul>
     <li>
      <p>
       <strong>
        <code>
         data/
        </code>
       </strong>
       ï¼šå­˜æ”¾æ•°æ®æ–‡ä»¶çš„ç›®å½•ã€‚
      </p>
      <ul>
       <li>
        <code>
         raw_data.parquet
        </code>
        ï¼šä» Tushare è·å–çš„åŸå§‹è‚¡ç¥¨å†å²æ—¥çº¿æ•°æ®ã€‚
       </li>
       <li>
        <code>
         selected_features.parquet
        </code>
        ï¼šç»è¿‡ç‰¹å¾å·¥ç¨‹å¤„ç†åé€‰æ‹©çš„ç‰¹å¾æ•°æ®ã€‚
       </li>
       <li>
        <code>
         target.parquet
        </code>
        ï¼šç›®æ ‡å˜é‡æ•°æ®ï¼ˆæœªæ¥æ”¶ç›Šç‡ï¼‰ã€‚
       </li>
      </ul>
     </li>
     <li>
      <p>
       <strong>
        <code>
         src/
        </code>
       </strong>
       ï¼šå­˜æ”¾æºä»£ç æ–‡ä»¶çš„ç›®å½•ã€‚
      </p>
      <ul>
       <li>
        <code>
         data_loader.py
        </code>
        ï¼šç”¨äºä» Tushare è·å–è‚¡ç¥¨å†å²æ—¥çº¿æ•°æ®å¹¶ä¿å­˜ä¸º Parquet æ–‡ä»¶ã€‚
       </li>
       <li>
        <code>
         feature_engineering.py
        </code>
        ï¼šç”¨äºæå–æ—¶é—´åºåˆ—ç‰¹å¾å¹¶é€‰æ‹©ä¸ç›®æ ‡å˜é‡ç›¸å…³çš„ç‰¹å¾ã€‚
       </li>
       <li>
        <code>
         final_model.txt
        </code>
        ï¼šè®­ç»ƒå¥½çš„ LightGBM æ¨¡å‹æ–‡ä»¶ã€‚
       </li>
       <li>
        <code>
         model_training.py
        </code>
        ï¼šç”¨äºè®­ç»ƒæœºå™¨å­¦ä¹ æ¨¡å‹ï¼Œå¹¶ä½¿ç”¨ Optuna è¿›è¡Œè¶…å‚æ•°ä¼˜åŒ–ã€‚
       </li>
       <li>
        <code>
         strategy_backtesting.py
        </code>
        ï¼šç”¨äºå›æµ‹ç­–ç•¥å¹¶è¯„ä¼°ç­–ç•¥æ€§èƒ½ã€‚
       </li>
       <li>
        <code>
         utils.py
        </code>
        ï¼šåŒ…å«ä¸€äº›è¾…åŠ©å‡½æ•°ï¼Œå¦‚è®¡ç®—æœªæ¥æ”¶ç›Šç‡ã€æŠ€æœ¯æŒ‡æ ‡ç­‰ã€‚
       </li>
      </ul>
     </li>
     <li>
      <p>
       <strong>
        <code>
         README.md
        </code>
       </strong>
       ï¼šé¡¹ç›®è¯´æ˜æ–‡æ¡£ï¼ŒåŒ…å«é¡¹ç›®æ¦‚è¿°ã€å®‰è£…æ­¥éª¤ã€ä½¿ç”¨æ–¹æ³•ç­‰ä¿¡æ¯ã€‚
      </p>
      <pre><code class="prism language-bash"><span class="token comment"># å®‰è£…é¡¹ç›®ä¾èµ–ï¼š</span>
pip <span class="token function">install</span> <span class="token parameter variable">-r</span> requirements.txt
<span class="token builtin class-name">cd</span> src
<span class="token comment"># æ•°æ®è·å–</span>
python data_loader.py
<span class="token comment"># ç‰¹å¾å·¥ç¨‹</span>
python feature_engineering.py
<span class="token comment"># æ¨¡å‹è®­ç»ƒ</span>
python model_training.py
<span class="token comment"># ç­–ç•¥å›æµ‹</span>
python strategy_backtesting.py
</code></pre>
     </li>
     <li>
      <p>
       <strong>
        <code>
         requirements.txt
        </code>
       </strong>
       ï¼šé¡¹ç›®ä¾èµ–åº“åˆ—è¡¨ï¼Œç”¨äºå®‰è£…æ‰€éœ€çš„ Python åŒ…ã€‚
      </p>
      <pre><code class="prism language-text">tushare
tsfresh
lightgbm
optuna
pandas
numpy
scikit-learn
ta-lib
pyarrow
matplotlib
</code></pre>
     </li>
    </ul>
    <h3>
     <a id="3__166">
     </a>
     3. ä»£ç å®ç°
    </h3>
    <h4>
     <a id="31__data_loaderpy_168">
     </a>
     3.1 æ•°æ®åŠ è½½ (
     <code>
      data_loader.py
     </code>
     )
    </h4>
    <pre><code class="prism language-python"><span class="token comment"># src/data_loader.py</span>
<span class="token keyword">import</span> tushare <span class="token keyword">as</span> ts

<span class="token keyword">def</span> <span class="token function">load_stock_data</span><span class="token punctuation">(</span>stock_code<span class="token punctuation">,</span> start_date<span class="token punctuation">,</span> end_date<span class="token punctuation">,</span> save_path<span class="token operator">=</span><span class="token string">"../data/raw_data.parquet"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    ä»Tushare APIä¸‹è½½è‚¡ç¥¨å†å²æ—¥çº¿æ•°æ®å¹¶ä¿å­˜ã€‚

    :param stock_code: è‚¡ç¥¨ä»£ç 
    :param start_date: å¼€å§‹æ—¥æœŸ
    :param end_date: ç»“æŸæ—¥æœŸ
    :param save_path: ä¿å­˜è·¯å¾„
    """</span>
    <span class="token comment"># Tushare Pro API token</span>
    ts<span class="token punctuation">.</span>set_token<span class="token punctuation">(</span><span class="token string">"your_token"</span><span class="token punctuation">)</span>  <span class="token comment"># è®¾ç½® Tushare API çš„è®¿é—®ä»¤ç‰Œ</span>
    pro <span class="token operator">=</span> ts<span class="token punctuation">.</span>pro_api<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># åˆå§‹åŒ– Tushare Pro API å®¢æˆ·ç«¯</span>

    df <span class="token operator">=</span> pro<span class="token punctuation">.</span>daily<span class="token punctuation">(</span>ts_code<span class="token operator">=</span>stock_code<span class="token punctuation">,</span> start_date<span class="token operator">=</span>start_date<span class="token punctuation">,</span> end_date<span class="token operator">=</span>end_date<span class="token punctuation">)</span>  <span class="token comment"># è·å–æŒ‡å®šè‚¡ç¥¨åœ¨æŒ‡å®šæ—¥æœŸèŒƒå›´å†…çš„æ—¥çº¿æ•°æ®</span>
    df<span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span>by<span class="token operator">=</span><span class="token string">"trade_date"</span><span class="token punctuation">,</span> inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>  <span class="token comment"># æŒ‰äº¤æ˜“æ—¥æœŸæ’åº</span>

    df<span class="token punctuation">.</span>to_parquet<span class="token punctuation">(</span>
        path<span class="token operator">=</span>save_path<span class="token punctuation">,</span>
        engine<span class="token operator">=</span><span class="token string">"pyarrow"</span><span class="token punctuation">,</span>
        compression<span class="token operator">=</span><span class="token string">"snappy"</span><span class="token punctuation">,</span>
        index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span>  <span class="token comment"># å°†æ•°æ®ä¿å­˜ä¸º Parquet æ–‡ä»¶ï¼Œä½¿ç”¨ Snappy å‹ç¼©</span>

    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Data saved to </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>save_path<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>  <span class="token comment"># æ‰“å°ä¿å­˜è·¯å¾„</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    load_stock_data<span class="token punctuation">(</span><span class="token string">"600519.SH"</span><span class="token punctuation">,</span> <span class="token string">"20200101"</span><span class="token punctuation">,</span> <span class="token string">"20240101"</span><span class="token punctuation">)</span>  <span class="token comment"># è´µå·èŒ…å°ï¼ˆ600519ï¼‰</span>
</code></pre>
    <h4>
     <a id="32__feature_engineeringpy_203">
     </a>
     3.2 ç‰¹å¾å·¥ç¨‹ (
     <code>
      feature_engineering.py
     </code>
     )
    </h4>
    <pre><code class="prism language-python"><span class="token comment"># src/feature_engineering.py</span>
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> talib
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>ensemble <span class="token keyword">import</span> RandomForestRegressor
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>feature_selection <span class="token keyword">import</span> RFE<span class="token punctuation">,</span> SelectFromModel<span class="token punctuation">,</span> SelectKBest<span class="token punctuation">,</span> f_regression<span class="token punctuation">,</span> mutual_info_regression
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>linear_model <span class="token keyword">import</span> Lasso
<span class="token keyword">from</span> tsfresh <span class="token keyword">import</span> extract_features
<span class="token keyword">from</span> tsfresh<span class="token punctuation">.</span>utilities<span class="token punctuation">.</span>dataframe_functions <span class="token keyword">import</span> impute

<span class="token keyword">from</span> utils <span class="token keyword">import</span> calculate_compound_returns<span class="token punctuation">,</span> calculate_future_return_class<span class="token punctuation">,</span> calculate_future_returns<span class="token punctuation">,</span> calculate_technical_indicator_changes

<span class="token keyword">def</span> <span class="token function">select_features_with_rfe</span><span class="token punctuation">(</span>features<span class="token punctuation">,</span> target<span class="token punctuation">,</span> n_features_to_select<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    ä½¿ç”¨é€’å½’ç‰¹å¾æ¶ˆé™¤é€‰æ‹©ç‰¹å¾
    """</span>
    estimator <span class="token operator">=</span> RandomForestRegressor<span class="token punctuation">(</span>n_estimators<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">42</span><span class="token punctuation">)</span>  <span class="token comment"># åˆå§‹åŒ–éšæœºæ£®æ—å›å½’å™¨</span>
    selector <span class="token operator">=</span> RFE<span class="token punctuation">(</span>estimator<span class="token punctuation">,</span> n_features_to_select<span class="token operator">=</span>n_features_to_select<span class="token punctuation">)</span>  <span class="token comment"># åˆå§‹åŒ– RFE é€‰æ‹©å™¨</span>
    selector <span class="token operator">=</span> selector<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>features<span class="token punctuation">,</span> target<span class="token punctuation">)</span>  <span class="token comment"># è®­ç»ƒ RFE é€‰æ‹©å™¨</span>
    selected_features <span class="token operator">=</span> features<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> selector<span class="token punctuation">.</span>support_<span class="token punctuation">]</span>  <span class="token comment"># é€‰æ‹©ç‰¹å¾</span>
    <span class="token keyword">return</span> selected_features

<span class="token keyword">def</span> <span class="token function">select_features_with_lasso</span><span class="token punctuation">(</span>features<span class="token punctuation">,</span> target<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    ä½¿ç”¨LASSOå›å½’é€‰æ‹©ç‰¹å¾
    """</span>
    lasso <span class="token operator">=</span> Lasso<span class="token punctuation">(</span>alpha<span class="token operator">=</span><span class="token number">0.1</span><span class="token punctuation">)</span>  <span class="token comment"># åˆå§‹åŒ– LASSO å›å½’</span>
    lasso<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>features<span class="token punctuation">,</span> target<span class="token punctuation">)</span>  <span class="token comment"># è®­ç»ƒ LASSO å›å½’</span>
    model <span class="token operator">=</span> SelectFromModel<span class="token punctuation">(</span>lasso<span class="token punctuation">,</span> prefit<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>  <span class="token comment"># åˆå§‹åŒ–ç‰¹å¾é€‰æ‹©å™¨</span>
    selected_features <span class="token operator">=</span> model<span class="token punctuation">.</span>transform<span class="token punctuation">(</span>features<span class="token punctuation">)</span>  <span class="token comment"># é€‰æ‹©ç‰¹å¾</span>
    <span class="token keyword">return</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>selected_features<span class="token punctuation">,</span> columns<span class="token operator">=</span>features<span class="token punctuation">.</span>columns<span class="token punctuation">[</span>model<span class="token punctuation">.</span>get_support<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">add_technical_indicators</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    æ·»åŠ æŠ€æœ¯æŒ‡æ ‡
    """</span>
    df<span class="token punctuation">[</span><span class="token string">"SMA_5"</span><span class="token punctuation">]</span> <span class="token operator">=</span> talib<span class="token punctuation">.</span>SMA<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">"close"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> timeperiod<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span>  <span class="token comment"># 5æ—¥ç®€å•ç§»åŠ¨å¹³å‡</span>
    df<span class="token punctuation">[</span><span class="token string">"SMA_10"</span><span class="token punctuation">]</span> <span class="token operator">=</span> talib<span class="token punctuation">.</span>SMA<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">"close"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> timeperiod<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span>  <span class="token comment"># 10æ—¥ç®€å•ç§»åŠ¨å¹³å‡</span>
    df<span class="token punctuation">[</span><span class="token string">"RSI"</span><span class="token punctuation">]</span> <span class="token operator">=</span> talib<span class="token punctuation">.</span>RSI<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">"close"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> timeperiod<span class="token operator">=</span><span class="token number">14</span><span class="token punctuation">)</span>  <span class="token comment"># 14æ—¥ç›¸å¯¹å¼ºå¼±æŒ‡æ•°</span>
    df<span class="token punctuation">[</span><span class="token string">"MACD"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> df<span class="token punctuation">[</span><span class="token string">"MACD_signal"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> _ <span class="token operator">=</span> talib<span class="token punctuation">.</span>MACD<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">"close"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> fastperiod<span class="token operator">=</span><span class="token number">12</span><span class="token punctuation">,</span> slowperiod<span class="token operator">=</span><span class="token number">26</span><span class="token punctuation">,</span> signalperiod<span class="token operator">=</span><span class="token number">9</span><span class="token punctuation">)</span>  <span class="token comment"># MACD æŒ‡æ ‡</span>
    df<span class="token punctuation">[</span><span class="token string">"EMA_12"</span><span class="token punctuation">]</span> <span class="token operator">=</span> talib<span class="token punctuation">.</span>EMA<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">"close"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> timeperiod<span class="token operator">=</span><span class="token number">12</span><span class="token punctuation">)</span>  <span class="token comment"># 12æ—¥æŒ‡æ•°ç§»åŠ¨å¹³å‡</span>
    df<span class="token punctuation">[</span><span class="token string">"EMA_26"</span><span class="token punctuation">]</span> <span class="token operator">=</span> talib<span class="token punctuation">.</span>EMA<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">"close"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> timeperiod<span class="token operator">=</span><span class="token number">26</span><span class="token punctuation">)</span>  <span class="token comment"># 26æ—¥æŒ‡æ•°ç§»åŠ¨å¹³å‡</span>
    df<span class="token punctuation">[</span><span class="token string">"ATR"</span><span class="token punctuation">]</span> <span class="token operator">=</span> talib<span class="token punctuation">.</span>ATR<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">"high"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> df<span class="token punctuation">[</span><span class="token string">"low"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> df<span class="token punctuation">[</span><span class="token string">"close"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> timeperiod<span class="token operator">=</span><span class="token number">14</span><span class="token punctuation">)</span>  <span class="token comment"># 14æ—¥å¹³å‡çœŸå®æ³¢åŠ¨å¹…åº¦</span>
    df<span class="token punctuation">[</span><span class="token string">"ADX"</span><span class="token punctuation">]</span> <span class="token operator">=</span> talib<span class="token punctuation">.</span>ADX<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">"high"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> df<span class="token punctuation">[</span><span class="token string">"low"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> df<span class="token punctuation">[</span><span class="token string">"close"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> timeperiod<span class="token operator">=</span><span class="token number">14</span><span class="token punctuation">)</span>  <span class="token comment"># 14æ—¥å¹³å‡è¶‹å‘æŒ‡æ•°</span>
    <span class="token keyword">return</span> df

<span class="token keyword">def</span> <span class="token function">add_time_window_features</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    æ·»åŠ æ—¶é—´çª—å£ç‰¹å¾
    """</span>
    df<span class="token punctuation">[</span><span class="token string">"close_mean_5d"</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">"close"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>rolling<span class="token punctuation">(</span>window<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 5æ—¥æ”¶ç›˜ä»·å‡å€¼</span>
    df<span class="token punctuation">[</span><span class="token string">"close_std_5d"</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">"close"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>rolling<span class="token punctuation">(</span>window<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">.</span>std<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 5æ—¥æ”¶ç›˜ä»·æ ‡å‡†å·®</span>
    df<span class="token punctuation">[</span><span class="token string">"close_mean_10d"</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">"close"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>rolling<span class="token punctuation">(</span>window<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 10æ—¥æ”¶ç›˜ä»·å‡å€¼</span>
    df<span class="token punctuation">[</span><span class="token string">"close_std_10d"</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">"close"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>rolling<span class="token punctuation">(</span>window<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">.</span>std<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 10æ—¥æ”¶ç›˜ä»·æ ‡å‡†å·®</span>
    <span class="token keyword">return</span> df

<span class="token keyword">def</span> <span class="token function">add_manual_features</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    æ·»åŠ æ‰‹å·¥ç‰¹å¾
    """</span>
    df<span class="token punctuation">[</span><span class="token string">"volume_change"</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">"vol"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>pct_change<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># æˆäº¤é‡å˜åŒ–ç‡</span>
    df<span class="token punctuation">[</span><span class="token string">"price_volatility"</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">"close"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>rolling<span class="token punctuation">(</span>window<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">.</span>std<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 5æ—¥ä»·æ ¼æ³¢åŠ¨ç‡</span>
    df<span class="token punctuation">[</span><span class="token string">"price_momentum"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">"close"</span><span class="token punctuation">]</span> <span class="token operator">-</span> df<span class="token punctuation">[</span><span class="token string">"close"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>shift<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> df<span class="token punctuation">[</span><span class="token string">"close"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>shift<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>  <span class="token comment"># 5æ—¥ä»·æ ¼åŠ¨é‡</span>
    <span class="token keyword">return</span> df

<span class="token keyword">def</span> <span class="token function">extract_and_select_features</span><span class="token punctuation">(</span>data_path<span class="token punctuation">,</span> target_variable<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    æå–æ—¶é—´åºåˆ—ç‰¹å¾å¹¶é€‰æ‹©ä¸ç›®æ ‡å˜é‡ç›¸å…³çš„ç‰¹å¾ã€‚
    """</span>
    df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_parquet<span class="token punctuation">(</span>data_path<span class="token punctuation">)</span>  <span class="token comment"># è¯»å– Parquet æ–‡ä»¶</span>
    df<span class="token punctuation">[</span><span class="token string">"date"</span><span class="token punctuation">]</span> <span class="token operator">=</span> pd<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">"trade_date"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token builtin">format</span><span class="token operator">=</span><span class="token string">"%Y%m%d"</span><span class="token punctuation">)</span>  <span class="token comment"># å°†äº¤æ˜“æ—¥æœŸè½¬æ¢ä¸º datetime æ ¼å¼</span>
    df<span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span>by<span class="token operator">=</span><span class="token string">"date"</span><span class="token punctuation">,</span> inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>  <span class="token comment"># æŒ‰æ—¥æœŸæ’åº</span>

    df <span class="token operator">=</span> calculate_future_returns<span class="token punctuation">(</span>df<span class="token punctuation">,</span> days_list<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># è®¡ç®—å¤šä¸ªæ—¶é—´çª—å£çš„æœªæ¥æ”¶ç›Šç‡</span>
    df <span class="token operator">=</span> calculate_compound_returns<span class="token punctuation">(</span>df<span class="token punctuation">,</span> days<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span>  <span class="token comment"># è®¡ç®—å¤åˆæ”¶ç›Šç‡</span>
    df <span class="token operator">=</span> calculate_future_return_class<span class="token punctuation">(</span>df<span class="token punctuation">,</span> days<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span>  <span class="token comment"># è®¡ç®—åˆ†ç±»ç›®æ ‡</span>
    df <span class="token operator">=</span> calculate_technical_indicator_changes<span class="token punctuation">(</span>df<span class="token punctuation">,</span> indicator<span class="token operator">=</span><span class="token string">"RSI"</span><span class="token punctuation">,</span> period<span class="token operator">=</span><span class="token number">14</span><span class="token punctuation">,</span> days<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span>  <span class="token comment"># è®¡ç®—æŠ€æœ¯æŒ‡æ ‡å˜åŒ–</span>
    df <span class="token operator">=</span> add_technical_indicators<span class="token punctuation">(</span>df<span class="token punctuation">)</span>  <span class="token comment"># æ·»åŠ æŠ€æœ¯æŒ‡æ ‡</span>
    df <span class="token operator">=</span> add_time_window_features<span class="token punctuation">(</span>df<span class="token punctuation">)</span>  <span class="token comment"># æ·»åŠ æ—¶é—´çª—å£ç‰¹å¾</span>
    df <span class="token operator">=</span> add_manual_features<span class="token punctuation">(</span>df<span class="token punctuation">)</span>  <span class="token comment"># æ·»åŠ æ‰‹å·¥ç‰¹å¾</span>

    df<span class="token punctuation">.</span>dropna<span class="token punctuation">(</span>inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>  <span class="token comment"># åˆ é™¤åŒ…å« NaN å€¼çš„è¡Œ</span>
    df<span class="token punctuation">[</span><span class="token string">"id"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># æ·»åŠ  id åˆ—</span>
    df<span class="token punctuation">.</span>set_index<span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">,</span> inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>  <span class="token comment"># è®¾ç½® id ä¸ºç´¢å¼•</span>
    df<span class="token punctuation">.</span>reset_index<span class="token punctuation">(</span>inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>  <span class="token comment"># é‡ç½®ç´¢å¼•</span>

    target <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>df<span class="token punctuation">[</span>target_variable<span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># æå–ç›®æ ‡å˜é‡</span>

    extracted_features <span class="token operator">=</span> extract_features<span class="token punctuation">(</span>df<span class="token punctuation">,</span> column_id<span class="token operator">=</span><span class="token string">"id"</span><span class="token punctuation">,</span> column_sort<span class="token operator">=</span><span class="token string">"date"</span><span class="token punctuation">,</span> column_value<span class="token operator">=</span><span class="token string">"close"</span><span class="token punctuation">)</span>  <span class="token comment"># æå–æ—¶é—´åºåˆ—ç‰¹å¾</span>
    impute<span class="token punctuation">(</span>extracted_features<span class="token punctuation">)</span>  <span class="token comment"># å¡«å……ç¼ºå¤±å€¼</span>

    selected_features <span class="token operator">=</span> select_features_with_lasso<span class="token punctuation">(</span>extracted_features<span class="token punctuation">,</span> target<span class="token punctuation">)</span>  <span class="token comment"># é€‰æ‹©ç‰¹å¾</span>

    <span class="token keyword">return</span> selected_features<span class="token punctuation">,</span> target

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    features<span class="token punctuation">,</span> target <span class="token operator">=</span> extract_and_select_features<span class="token punctuation">(</span><span class="token string">"../data/raw_data.parquet"</span><span class="token punctuation">,</span> <span class="token string">"future_return_5d"</span><span class="token punctuation">)</span>  <span class="token comment"># æå–å’Œé€‰æ‹©ç‰¹å¾</span>
    features<span class="token punctuation">.</span>to_parquet<span class="token punctuation">(</span><span class="token string">"../data/selected_features.parquet"</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>  <span class="token comment"># ä¿å­˜ç‰¹å¾</span>
    target<span class="token punctuation">.</span>to_parquet<span class="token punctuation">(</span><span class="token string">"../data/target.parquet"</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>  <span class="token comment"># ä¿å­˜ç›®æ ‡å˜é‡</span>
</code></pre>
    <h4>
     <a id="33__model_trainingpy_306">
     </a>
     3.3 æ¨¡å‹è®­ç»ƒ (
     <code>
      model_training.py
     </code>
     )
    </h4>
    <pre><code class="prism language-python"><span class="token comment"># src/model_training.py</span>
<span class="token keyword">import</span> re
<span class="token keyword">import</span> lightgbm <span class="token keyword">as</span> lgb
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> optuna
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> mean_squared_error
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> KFold<span class="token punctuation">,</span> train_test_split
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>preprocessing <span class="token keyword">import</span> StandardScaler

<span class="token keyword">def</span> <span class="token function">clean_feature_names</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span><span class="token punctuation">:</span>
    df<span class="token punctuation">.</span>columns <span class="token operator">=</span> <span class="token punctuation">[</span>re<span class="token punctuation">.</span>sub<span class="token punctuation">(</span><span class="token string">r"[^a-zA-Z0-9_]"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> col<span class="token punctuation">)</span> <span class="token keyword">for</span> col <span class="token keyword">in</span> df<span class="token punctuation">.</span>columns<span class="token punctuation">]</span>  <span class="token comment"># æ¸…ç†ç‰¹å¾åç§°ï¼Œå»é™¤ç‰¹æ®Šå­—ç¬¦</span>
    <span class="token keyword">return</span> df

<span class="token keyword">def</span> <span class="token function">preprocess_data</span><span class="token punctuation">(</span>features<span class="token punctuation">,</span> target<span class="token punctuation">)</span><span class="token punctuation">:</span>
    features <span class="token operator">=</span> features<span class="token punctuation">.</span>interpolate<span class="token punctuation">(</span>method<span class="token operator">=</span><span class="token string">"linear"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>fillna<span class="token punctuation">(</span>features<span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># æ’å€¼å¡«å……ç¼ºå¤±å€¼</span>
    scaler <span class="token operator">=</span> StandardScaler<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># åˆå§‹åŒ–æ ‡å‡†åŒ–å™¨</span>
    features <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>scaler<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>features<span class="token punctuation">)</span><span class="token punctuation">,</span> columns<span class="token operator">=</span>features<span class="token punctuation">.</span>columns<span class="token punctuation">)</span>  <span class="token comment"># æ ‡å‡†åŒ–ç‰¹å¾</span>
    <span class="token keyword">return</span> features<span class="token punctuation">,</span> target

<span class="token keyword">def</span> <span class="token function">objective</span><span class="token punctuation">(</span>trial<span class="token punctuation">,</span> X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> X_val<span class="token punctuation">,</span> y_val<span class="token punctuation">)</span><span class="token punctuation">:</span>
    params <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
        <span class="token string">"objective"</span><span class="token punctuation">:</span> <span class="token string">"regression"</span><span class="token punctuation">,</span>  <span class="token comment"># ç›®æ ‡å‡½æ•°</span>
        <span class="token string">"metric"</span><span class="token punctuation">:</span> <span class="token string">"mse"</span><span class="token punctuation">,</span>  <span class="token comment"># è¯„ä»·æŒ‡æ ‡</span>
        <span class="token string">"boosting_type"</span><span class="token punctuation">:</span> <span class="token string">"gbdt"</span><span class="token punctuation">,</span>  <span class="token comment"># æå‡ç±»å‹</span>
        <span class="token string">"num_leaves"</span><span class="token punctuation">:</span> trial<span class="token punctuation">.</span>suggest_int<span class="token punctuation">(</span><span class="token string">"num_leaves"</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># å¶å­èŠ‚ç‚¹æ•°</span>
        <span class="token string">"learning_rate"</span><span class="token punctuation">:</span> trial<span class="token punctuation">.</span>suggest_loguniform<span class="token punctuation">(</span><span class="token string">"learning_rate"</span><span class="token punctuation">,</span> <span class="token number">1e-5</span><span class="token punctuation">,</span> <span class="token number">1e-1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># å­¦ä¹ ç‡</span>
        <span class="token string">"max_depth"</span><span class="token punctuation">:</span> trial<span class="token punctuation">.</span>suggest_int<span class="token punctuation">(</span><span class="token string">"max_depth"</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># æœ€å¤§æ·±åº¦</span>
        <span class="token string">"min_child_samples"</span><span class="token punctuation">:</span> trial<span class="token punctuation">.</span>suggest_int<span class="token punctuation">(</span><span class="token string">"min_child_samples"</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># æœ€å°æ ·æœ¬æ•°</span>
        <span class="token string">"subsample"</span><span class="token punctuation">:</span> trial<span class="token punctuation">.</span>suggest_uniform<span class="token punctuation">(</span><span class="token string">"subsample"</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># å­é‡‡æ ·æ¯”ä¾‹</span>
        <span class="token string">"colsample_bytree"</span><span class="token punctuation">:</span> trial<span class="token punctuation">.</span>suggest_uniform<span class="token punctuation">(</span><span class="token string">"colsample_bytree"</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># åˆ—é‡‡æ ·æ¯”ä¾‹</span>
        <span class="token string">"reg_alpha"</span><span class="token punctuation">:</span> trial<span class="token punctuation">.</span>suggest_loguniform<span class="token punctuation">(</span><span class="token string">"reg_alpha"</span><span class="token punctuation">,</span> <span class="token number">1e-5</span><span class="token punctuation">,</span> <span class="token number">1e2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># L1 æ­£åˆ™åŒ–é¡¹</span>
        <span class="token string">"reg_lambda"</span><span class="token punctuation">:</span> trial<span class="token punctuation">.</span>suggest_loguniform<span class="token punctuation">(</span><span class="token string">"reg_lambda"</span><span class="token punctuation">,</span> <span class="token number">1e-5</span><span class="token punctuation">,</span> <span class="token number">1e2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># L2 æ­£åˆ™åŒ–é¡¹</span>
    <span class="token punctuation">}</span>

    dtrain <span class="token operator">=</span> lgb<span class="token punctuation">.</span>Dataset<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> label<span class="token operator">=</span>y_train<span class="token punctuation">)</span>  <span class="token comment"># åˆ›å»ºè®­ç»ƒæ•°æ®é›†</span>
    dval <span class="token operator">=</span> lgb<span class="token punctuation">.</span>Dataset<span class="token punctuation">(</span>X_val<span class="token punctuation">,</span> label<span class="token operator">=</span>y_val<span class="token punctuation">)</span>  <span class="token comment"># åˆ›å»ºéªŒè¯æ•°æ®é›†</span>

    callbacks <span class="token operator">=</span> <span class="token punctuation">[</span>
        lgb<span class="token punctuation">.</span>early_stopping<span class="token punctuation">(</span>stopping_rounds<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">,</span> first_metric_only<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> verbose<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># æ—©åœå›è°ƒ</span>
        lgb<span class="token punctuation">.</span>log_evaluation<span class="token punctuation">(</span>period<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># ç¦ç”¨æ—¥å¿—è¾“å‡º</span>
    <span class="token punctuation">]</span>

    model <span class="token operator">=</span> lgb<span class="token punctuation">.</span>train<span class="token punctuation">(</span>params<span class="token punctuation">,</span> dtrain<span class="token punctuation">,</span> valid_sets<span class="token operator">=</span><span class="token punctuation">[</span>dtrain<span class="token punctuation">,</span> dval<span class="token punctuation">]</span><span class="token punctuation">,</span> valid_names<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"train"</span><span class="token punctuation">,</span> <span class="token string">"val"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> num_boost_round<span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">,</span> callbacks<span class="token operator">=</span>callbacks<span class="token punctuation">)</span>  <span class="token comment"># è®­ç»ƒæ¨¡å‹</span>

    y_pred <span class="token operator">=</span> model<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X_val<span class="token punctuation">)</span>  <span class="token comment"># é¢„æµ‹éªŒè¯é›†</span>
    mse <span class="token operator">=</span> mean_squared_error<span class="token punctuation">(</span>y_val<span class="token punctuation">,</span> y_pred<span class="token punctuation">)</span>  <span class="token comment"># è®¡ç®—å‡æ–¹è¯¯å·®</span>

    <span class="token keyword">return</span> mse

<span class="token keyword">def</span> <span class="token function">train_model</span><span class="token punctuation">(</span>features_path<span class="token punctuation">,</span> target_path<span class="token punctuation">,</span> n_trials<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    features <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_parquet<span class="token punctuation">(</span>features_path<span class="token punctuation">)</span>  <span class="token comment"># è¯»å–ç‰¹å¾</span>
    target <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_parquet<span class="token punctuation">(</span>target_path<span class="token punctuation">)</span>  <span class="token comment"># è¯»å–ç›®æ ‡å˜é‡</span>

    features <span class="token operator">=</span> clean_feature_names<span class="token punctuation">(</span>features<span class="token punctuation">)</span>  <span class="token comment"># æ¸…ç†ç‰¹å¾åç§°</span>
    features<span class="token punctuation">,</span> target <span class="token operator">=</span> preprocess_data<span class="token punctuation">(</span>features<span class="token punctuation">,</span> target<span class="token punctuation">)</span>  <span class="token comment"># é¢„å¤„ç†æ•°æ®</span>

    X_train<span class="token punctuation">,</span> X_val<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> y_val <span class="token operator">=</span> train_test_split<span class="token punctuation">(</span>features<span class="token punctuation">,</span> target<span class="token punctuation">,</span> test_size<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">42</span><span class="token punctuation">)</span>  <span class="token comment"># åˆ’åˆ†è®­ç»ƒé›†å’ŒéªŒè¯é›†</span>

    study <span class="token operator">=</span> optuna<span class="token punctuation">.</span>create_study<span class="token punctuation">(</span>direction<span class="token operator">=</span><span class="token string">"minimize"</span><span class="token punctuation">)</span>  <span class="token comment"># åˆ›å»º Optuna ç ”ç©¶</span>
    study<span class="token punctuation">.</span>optimize<span class="token punctuation">(</span><span class="token keyword">lambda</span> trial<span class="token punctuation">:</span> objective<span class="token punctuation">(</span>trial<span class="token punctuation">,</span> X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> X_val<span class="token punctuation">,</span> y_val<span class="token punctuation">)</span><span class="token punctuation">,</span> n_trials<span class="token operator">=</span>n_trials<span class="token punctuation">)</span>  <span class="token comment"># ä¼˜åŒ–è¶…å‚æ•°</span>

    best_params <span class="token operator">=</span> study<span class="token punctuation">.</span>best_params  <span class="token comment"># è·å–æœ€ä¼˜å‚æ•°</span>
    best_mse <span class="token operator">=</span> study<span class="token punctuation">.</span>best_value  <span class="token comment"># è·å–æœ€ä¼˜ MSE</span>

    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Best MSE: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>best_mse<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>  <span class="token comment"># æ‰“å°æœ€ä¼˜ MSE</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Best Parameters: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>best_params<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>  <span class="token comment"># æ‰“å°æœ€ä¼˜å‚æ•°</span>

    <span class="token keyword">return</span> best_params

<span class="token keyword">def</span> <span class="token function">train_final_model</span><span class="token punctuation">(</span>best_params<span class="token punctuation">,</span> features<span class="token punctuation">,</span> target<span class="token punctuation">)</span><span class="token punctuation">:</span>
    features<span class="token punctuation">,</span> target <span class="token operator">=</span> preprocess_data<span class="token punctuation">(</span>features<span class="token punctuation">,</span> target<span class="token punctuation">)</span>  <span class="token comment"># é¢„å¤„ç†æ•°æ®</span>
    kf <span class="token operator">=</span> KFold<span class="token punctuation">(</span>n_splits<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span> shuffle<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">42</span><span class="token punctuation">)</span>  <span class="token comment"># åˆå§‹åŒ– K-Fold äº¤å‰éªŒè¯</span>
    mse_scores <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> train_index<span class="token punctuation">,</span> val_index <span class="token keyword">in</span> kf<span class="token punctuation">.</span>split<span class="token punctuation">(</span>features<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># è¿›è¡Œäº¤å‰éªŒè¯</span>
        X_train<span class="token punctuation">,</span> X_val <span class="token operator">=</span> features<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span>train_index<span class="token punctuation">]</span><span class="token punctuation">,</span> features<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span>val_index<span class="token punctuation">]</span>
        y_train<span class="token punctuation">,</span> y_val <span class="token operator">=</span> target<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span>train_index<span class="token punctuation">]</span><span class="token punctuation">,</span> target<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span>val_index<span class="token punctuation">]</span>
        dtrain <span class="token operator">=</span> lgb<span class="token punctuation">.</span>Dataset<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> label<span class="token operator">=</span>y_train<span class="token punctuation">)</span>  <span class="token comment"># åˆ›å»ºè®­ç»ƒæ•°æ®é›†</span>
        dval <span class="token operator">=</span> lgb<span class="token punctuation">.</span>Dataset<span class="token punctuation">(</span>X_val<span class="token punctuation">,</span> label<span class="token operator">=</span>y_val<span class="token punctuation">)</span>  <span class="token comment"># åˆ›å»ºéªŒè¯æ•°æ®é›†</span>
        callbacks <span class="token operator">=</span> <span class="token punctuation">[</span>
            lgb<span class="token punctuation">.</span>early_stopping<span class="token punctuation">(</span>stopping_rounds<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">,</span> first_metric_only<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> verbose<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># æ—©åœå›è°ƒ</span>
            lgb<span class="token punctuation">.</span>log_evaluation<span class="token punctuation">(</span>period<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># ç¦ç”¨æ—¥å¿—è¾“å‡º</span>
        <span class="token punctuation">]</span>
        model <span class="token operator">=</span> lgb<span class="token punctuation">.</span>train<span class="token punctuation">(</span>best_params<span class="token punctuation">,</span> dtrain<span class="token punctuation">,</span> valid_sets<span class="token operator">=</span><span class="token punctuation">[</span>dtrain<span class="token punctuation">,</span> dval<span class="token punctuation">]</span><span class="token punctuation">,</span> valid_names<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"train"</span><span class="token punctuation">,</span> <span class="token string">"val"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> num_boost_round<span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">,</span> callbacks<span class="token operator">=</span>callbacks<span class="token punctuation">)</span>  <span class="token comment"># è®­ç»ƒæ¨¡å‹</span>
        y_pred <span class="token operator">=</span> model<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X_val<span class="token punctuation">)</span>  <span class="token comment"># é¢„æµ‹éªŒè¯é›†</span>
        mse <span class="token operator">=</span> mean_squared_error<span class="token punctuation">(</span>y_val<span class="token punctuation">,</span> y_pred<span class="token punctuation">)</span>  <span class="token comment"># è®¡ç®—å‡æ–¹è¯¯å·®</span>
        mse_scores<span class="token punctuation">.</span>append<span class="token punctuation">(</span>mse<span class="token punctuation">)</span>
    avg_mse <span class="token operator">=</span> np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>mse_scores<span class="token punctuation">)</span>  <span class="token comment"># è®¡ç®—å¹³å‡ MSE</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Final Model Average MSE: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>avg_mse<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>  <span class="token comment"># æ‰“å°å¹³å‡ MSE</span>
    <span class="token keyword">return</span> model

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    features_path <span class="token operator">=</span> <span class="token string">"../data/selected_features.parquet"</span>
    target_path <span class="token operator">=</span> <span class="token string">"../data/target.parquet"</span>

    best_params <span class="token operator">=</span> train_model<span class="token punctuation">(</span>features_path<span class="token punctuation">,</span> target_path<span class="token punctuation">,</span> n_trials<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">)</span>  <span class="token comment"># è®­ç»ƒæ¨¡å‹å¹¶ä¼˜åŒ–è¶…å‚æ•°</span>

    features <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_parquet<span class="token punctuation">(</span>features_path<span class="token punctuation">)</span>  <span class="token comment"># è¯»å–ç‰¹å¾</span>
    target <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_parquet<span class="token punctuation">(</span>target_path<span class="token punctuation">)</span>  <span class="token comment"># è¯»å–ç›®æ ‡å˜é‡</span>

    features <span class="token operator">=</span> clean_feature_names<span class="token punctuation">(</span>features<span class="token punctuation">)</span>  <span class="token comment"># æ¸…ç†ç‰¹å¾åç§°</span>

    final_model <span class="token operator">=</span> train_final_model<span class="token punctuation">(</span>best_params<span class="token punctuation">,</span> features<span class="token punctuation">,</span> target<span class="token punctuation">)</span>  <span class="token comment"># è®­ç»ƒæœ€ç»ˆæ¨¡å‹</span>

    final_model<span class="token punctuation">.</span>save_model<span class="token punctuation">(</span><span class="token string">"final_model.txt"</span><span class="token punctuation">)</span>  <span class="token comment"># ä¿å­˜æ¨¡å‹</span>
</code></pre>
    <h4>
     <a id="34__strategy_backtestingpy_416">
     </a>
     3.4 ç­–ç•¥å›æµ‹ (
     <code>
      strategy_backtesting.py
     </code>
     )
    </h4>
    <pre><code class="prism language-python"><span class="token comment"># strategy_backtesting.py</span>
<span class="token keyword">import</span> re
<span class="token keyword">import</span> lightgbm <span class="token keyword">as</span> lgb
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> mean_absolute_error<span class="token punctuation">,</span> mean_squared_error<span class="token punctuation">,</span> r2_score
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>preprocessing <span class="token keyword">import</span> StandardScaler

<span class="token keyword">def</span> <span class="token function">clean_feature_names</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span><span class="token punctuation">:</span>
    df<span class="token punctuation">.</span>columns <span class="token operator">=</span> <span class="token punctuation">[</span>re<span class="token punctuation">.</span>sub<span class="token punctuation">(</span><span class="token string">r"[^a-zA-Z0-9_]"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> col<span class="token punctuation">)</span> <span class="token keyword">for</span> col <span class="token keyword">in</span> df<span class="token punctuation">.</span>columns<span class="token punctuation">]</span>  <span class="token comment"># æ¸…ç†ç‰¹å¾åç§°ï¼Œå»é™¤ç‰¹æ®Šå­—ç¬¦</span>
    <span class="token keyword">return</span> df

<span class="token keyword">def</span> <span class="token function">preprocess_data</span><span class="token punctuation">(</span>features<span class="token punctuation">,</span> target<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    features <span class="token operator">=</span> features<span class="token punctuation">.</span>fillna<span class="token punctuation">(</span>features<span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># å¡«å……ç¼ºå¤±å€¼</span>
    scaler <span class="token operator">=</span> StandardScaler<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># åˆå§‹åŒ–æ ‡å‡†åŒ–å™¨</span>
    features <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>scaler<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>features<span class="token punctuation">)</span><span class="token punctuation">,</span> columns<span class="token operator">=</span>features<span class="token punctuation">.</span>columns<span class="token punctuation">)</span>  <span class="token comment"># æ ‡å‡†åŒ–ç‰¹å¾</span>

    <span class="token keyword">if</span> target <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> features<span class="token punctuation">,</span> target
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> features

<span class="token keyword">def</span> <span class="token function">load_model</span><span class="token punctuation">(</span>model_path<span class="token punctuation">)</span><span class="token punctuation">:</span>
    model <span class="token operator">=</span> lgb<span class="token punctuation">.</span>Booster<span class="token punctuation">(</span>model_file<span class="token operator">=</span>model_path<span class="token punctuation">)</span>  <span class="token comment"># åŠ è½½ LightGBM æ¨¡å‹</span>
    <span class="token keyword">return</span> model

<span class="token keyword">def</span> <span class="token function">backtest_strategy</span><span class="token punctuation">(</span>features<span class="token punctuation">,</span> target<span class="token punctuation">,</span> model<span class="token punctuation">,</span> threshold<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    features <span class="token operator">=</span> preprocess_data<span class="token punctuation">(</span>features<span class="token punctuation">)</span>  <span class="token comment"># é¢„å¤„ç†ç‰¹å¾</span>

    predictions <span class="token operator">=</span> model<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>features<span class="token punctuation">)</span>  <span class="token comment"># é¢„æµ‹</span>

    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Predictions: Min=</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>predictions<span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">, Max=</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>predictions<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">, Mean=</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>predictions<span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>  <span class="token comment"># æ‰“å°é¢„æµ‹å€¼ç»Ÿè®¡ä¿¡æ¯</span>

    mse <span class="token operator">=</span> mean_squared_error<span class="token punctuation">(</span>target<span class="token punctuation">,</span> predictions<span class="token punctuation">)</span>  <span class="token comment"># è®¡ç®—å‡æ–¹è¯¯å·®</span>
    mae <span class="token operator">=</span> mean_absolute_error<span class="token punctuation">(</span>target<span class="token punctuation">,</span> predictions<span class="token punctuation">)</span>  <span class="token comment"># è®¡ç®—å¹³å‡ç»å¯¹è¯¯å·®</span>
    r2 <span class="token operator">=</span> r2_score<span class="token punctuation">(</span>target<span class="token punctuation">,</span> predictions<span class="token punctuation">)</span>  <span class="token comment"># è®¡ç®— RÂ² åˆ†æ•°</span>

    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Mean Squared Error (MSE): </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>mse<span class="token punctuation">:</span><span class="token format-spec">.6f</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>  <span class="token comment"># æ‰“å°å‡æ–¹è¯¯å·®</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Mean Absolute Error (MAE): </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>mae<span class="token punctuation">:</span><span class="token format-spec">.6f</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>  <span class="token comment"># æ‰“å°å¹³å‡ç»å¯¹è¯¯å·®</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"RÂ² Score: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>r2<span class="token punctuation">:</span><span class="token format-spec">.4f</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>  <span class="token comment"># æ‰“å° RÂ² åˆ†æ•°</span>

    signals <span class="token operator">=</span> <span class="token punctuation">(</span>predictions <span class="token operator">&gt;</span> threshold<span class="token punctuation">)</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">)</span>  <span class="token comment"># ç”Ÿæˆäº¤æ˜“ä¿¡å·</span>

    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Signals: Sum=</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>signals<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">, Count=</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token builtin">len</span><span class="token punctuation">(</span>signals<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">, Non-zero count=</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token punctuation">(</span>signals <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>  <span class="token comment"># æ‰“å°ä¿¡å·ç»Ÿè®¡ä¿¡æ¯</span>

    daily_returns <span class="token operator">=</span> target <span class="token operator">*</span> signals  <span class="token comment"># è®¡ç®—æ¯æ—¥æ”¶ç›Š</span>

    daily_returns_series <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span>daily_returns<span class="token punctuation">)</span>  <span class="token comment"># å°†æ¯æ—¥æ”¶ç›Šè½¬æ¢ä¸º Pandas Series</span>

    cumulative_returns <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">+</span> daily_returns_series<span class="token punctuation">)</span><span class="token punctuation">.</span>cumprod<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span>  <span class="token comment"># è®¡ç®—ç´¯ç§¯æ”¶ç›Š</span>

    total_return <span class="token operator">=</span> cumulative_returns<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>  <span class="token comment"># è®¡ç®—æ€»æ”¶ç›Š</span>

    sharpe_ratio <span class="token operator">=</span> np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span><span class="token number">252</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>daily_returns_series<span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">/</span> daily_returns_series<span class="token punctuation">.</span>std<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># è®¡ç®—å¤æ™®æ¯”ç‡</span>

    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Total Return: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>total_return<span class="token punctuation">:</span><span class="token format-spec">.4f</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>  <span class="token comment"># æ‰“å°æ€»æ”¶ç›Š</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Sharpe Ratio: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>sharpe_ratio<span class="token punctuation">:</span><span class="token format-spec">.4f</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>  <span class="token comment"># æ‰“å°å¤æ™®æ¯”ç‡</span>

    <span class="token keyword">return</span> cumulative_returns<span class="token punctuation">,</span> total_return<span class="token punctuation">,</span> sharpe_ratio

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    features_path <span class="token operator">=</span> <span class="token string">"../data/selected_features.parquet"</span>
    target_path <span class="token operator">=</span> <span class="token string">"../data/target.parquet"</span>

    features <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_parquet<span class="token punctuation">(</span>features_path<span class="token punctuation">)</span>  <span class="token comment"># è¯»å–ç‰¹å¾</span>
    target <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_parquet<span class="token punctuation">(</span>target_path<span class="token punctuation">)</span><span class="token punctuation">.</span>values<span class="token punctuation">.</span>flatten<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># è¯»å–ç›®æ ‡å˜é‡</span>

    features <span class="token operator">=</span> clean_feature_names<span class="token punctuation">(</span>features<span class="token punctuation">)</span>  <span class="token comment"># æ¸…ç†ç‰¹å¾åç§°</span>

    model_path <span class="token operator">=</span> <span class="token string">"final_model.txt"</span>
    model <span class="token operator">=</span> load_model<span class="token punctuation">(</span>model_path<span class="token punctuation">)</span>  <span class="token comment"># åŠ è½½æ¨¡å‹</span>

    cumulative_returns<span class="token punctuation">,</span> total_return<span class="token punctuation">,</span> sharpe_ratio <span class="token operator">=</span> backtest_strategy<span class="token punctuation">(</span>features<span class="token punctuation">,</span> target<span class="token punctuation">,</span> model<span class="token punctuation">,</span> threshold<span class="token operator">=</span><span class="token number">0.001</span><span class="token punctuation">)</span>  <span class="token comment"># å›æµ‹ç­–ç•¥</span>

    <span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt

    plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>cumulative_returns<span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">"Cumulative Returns"</span><span class="token punctuation">)</span>  <span class="token comment"># ç»˜åˆ¶ç´¯ç§¯æ”¶ç›Šæ›²çº¿</span>
    plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">"Cumulative Returns Over Time"</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">"Time"</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">"Cumulative Returns"</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
    <h4>
     <a id="35__utilspy_504">
     </a>
     3.5 è¾…åŠ©å‡½æ•° (
     <code>
      utils.py
     </code>
     )
    </h4>
    <pre><code class="prism language-python"><span class="token comment"># src/utils.py</span>
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> talib


<span class="token keyword">def</span> <span class="token function">calculate_future_returns</span><span class="token punctuation">(</span>df<span class="token punctuation">,</span> days_list<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    è®¡ç®—å¤šä¸ªæ—¶é—´çª—å£çš„æœªæ¥æ”¶ç›Šç‡ã€‚

    :param df: åŒ…å«æ”¶ç›˜ä»·çš„æ—¶é—´åºåˆ—æ•°æ®
    :param days_list: æœªæ¥å¤©æ•°åˆ—è¡¨
    :return: åŒ…å«æœªæ¥æ”¶ç›Šç‡çš„DataFrame
    """</span>
    <span class="token keyword">for</span> days <span class="token keyword">in</span> days_list<span class="token punctuation">:</span>
        target_variable <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"future_return_</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>days<span class="token punctuation">}</span></span><span class="token string">d"</span></span>
        df<span class="token punctuation">[</span>target_variable<span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">"close"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>pct_change<span class="token punctuation">(</span>periods<span class="token operator">=</span><span class="token operator">-</span>days<span class="token punctuation">)</span><span class="token punctuation">.</span>shift<span class="token punctuation">(</span>days<span class="token punctuation">)</span>
    
    df<span class="token punctuation">.</span>dropna<span class="token punctuation">(</span>inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> df


<span class="token keyword">def</span> <span class="token function">calculate_compound_returns</span><span class="token punctuation">(</span>df<span class="token punctuation">,</span> days<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    è®¡ç®—å¤åˆæ”¶ç›Šç‡ã€‚
    :param df: åŒ…å«æ”¶ç›˜ä»·çš„æ—¶é—´åºåˆ—æ•°æ®
    :param days: æœªæ¥å¤©æ•°
    :return: åŒ…å«å¤åˆæ”¶ç›Šç‡çš„DataFrame
    """</span>
    target_variable <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"compound_return_</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>days<span class="token punctuation">}</span></span><span class="token string">d"</span></span>
    df<span class="token punctuation">[</span>target_variable<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">"close"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>shift<span class="token punctuation">(</span><span class="token operator">-</span>days<span class="token punctuation">)</span> <span class="token operator">/</span> df<span class="token punctuation">[</span><span class="token string">"close"</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span>
    df<span class="token punctuation">.</span>dropna<span class="token punctuation">(</span>subset<span class="token operator">=</span><span class="token punctuation">[</span>target_variable<span class="token punctuation">]</span><span class="token punctuation">,</span> inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> df


<span class="token keyword">def</span> <span class="token function">calculate_future_return_class</span><span class="token punctuation">(</span>df<span class="token punctuation">,</span> days<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    è®¡ç®—æœªæ¥æ”¶ç›Šç‡å¹¶å°†å…¶è½¬æ¢ä¸ºåˆ†ç±»ç›®æ ‡ã€‚
    :param df: åŒ…å«æ”¶ç›˜ä»·çš„æ—¶é—´åºåˆ—æ•°æ®
    :param days: æœªæ¥å¤©æ•°
    :return: åŒ…å«åˆ†ç±»ç›®æ ‡çš„DataFrame
    """</span>
    target_variable <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"future_return_</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>days<span class="token punctuation">}</span></span><span class="token string">d"</span></span>
    df<span class="token punctuation">[</span>target_variable<span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">"close"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>pct_change<span class="token punctuation">(</span>periods<span class="token operator">=</span><span class="token operator">-</span>days<span class="token punctuation">)</span><span class="token punctuation">.</span>shift<span class="token punctuation">(</span>days<span class="token punctuation">)</span>

    <span class="token comment"># å°†æ”¶ç›Šç‡è½¬æ¢ä¸ºåˆ†ç±»ç›®æ ‡</span>
    df<span class="token punctuation">[</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>target_variable<span class="token punctuation">}</span></span><span class="token string">_class"</span></span><span class="token punctuation">]</span> <span class="token operator">=</span> pd<span class="token punctuation">.</span>cut<span class="token punctuation">(</span>
        df<span class="token punctuation">[</span>target_variable<span class="token punctuation">]</span><span class="token punctuation">,</span>
        bins<span class="token operator">=</span><span class="token punctuation">[</span><span class="token operator">-</span>np<span class="token punctuation">.</span>inf<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.01</span><span class="token punctuation">,</span> <span class="token number">0.01</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>inf<span class="token punctuation">]</span><span class="token punctuation">,</span>
        labels<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"down"</span><span class="token punctuation">,</span> <span class="token string">"flat"</span><span class="token punctuation">,</span> <span class="token string">"up"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span>

    df<span class="token punctuation">.</span>dropna<span class="token punctuation">(</span>subset<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>target_variable<span class="token punctuation">}</span></span><span class="token string">_class"</span></span><span class="token punctuation">]</span><span class="token punctuation">,</span> inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> df


<span class="token keyword">def</span> <span class="token function">calculate_technical_indicator_changes</span><span class="token punctuation">(</span>df<span class="token punctuation">,</span> indicator<span class="token operator">=</span><span class="token string">"RSI"</span><span class="token punctuation">,</span> period<span class="token operator">=</span><span class="token number">14</span><span class="token punctuation">,</span> days<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    è®¡ç®—æŠ€æœ¯æŒ‡æ ‡çš„å˜åŒ–ã€‚
    :param df: åŒ…å«æ”¶ç›˜ä»·çš„æ—¶é—´åºåˆ—æ•°æ®
    :param indicator: æŠ€æœ¯æŒ‡æ ‡åç§°
    :param period: æŠ€æœ¯æŒ‡æ ‡çš„æ—¶é—´å‘¨æœŸ
    :param days: æœªæ¥å¤©æ•°
    :return: åŒ…å«æŠ€æœ¯æŒ‡æ ‡å˜åŒ–çš„DataFrame
    """</span>
    <span class="token keyword">if</span> indicator <span class="token operator">==</span> <span class="token string">"RSI"</span><span class="token punctuation">:</span>
        df<span class="token punctuation">[</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>indicator<span class="token punctuation">}</span></span><span class="token string">_</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>period<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">]</span> <span class="token operator">=</span> talib<span class="token punctuation">.</span>RSI<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">"close"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> timeperiod<span class="token operator">=</span>period<span class="token punctuation">)</span>
    <span class="token keyword">elif</span> indicator <span class="token operator">==</span> <span class="token string">"MACD"</span><span class="token punctuation">:</span>
        macd<span class="token punctuation">,</span> signal<span class="token punctuation">,</span> _ <span class="token operator">=</span> talib<span class="token punctuation">.</span>MACD<span class="token punctuation">(</span>
            df<span class="token punctuation">[</span><span class="token string">"close"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> fastperiod<span class="token operator">=</span><span class="token number">12</span><span class="token punctuation">,</span> slowperiod<span class="token operator">=</span><span class="token number">26</span><span class="token punctuation">,</span> signalperiod<span class="token operator">=</span><span class="token number">9</span>
        <span class="token punctuation">)</span>
        df<span class="token punctuation">[</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>indicator<span class="token punctuation">}</span></span><span class="token string">_</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>period<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">]</span> <span class="token operator">=</span> macd <span class="token operator">-</span> signal
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">raise</span> ValueError<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Unsupported indicator: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>indicator<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>

    target_variable <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>indicator<span class="token punctuation">}</span></span><span class="token string">_change_</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>days<span class="token punctuation">}</span></span><span class="token string">d"</span></span>
    df<span class="token punctuation">[</span>target_variable<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>
        df<span class="token punctuation">[</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>indicator<span class="token punctuation">}</span></span><span class="token string">_</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>period<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">]</span><span class="token punctuation">.</span>pct_change<span class="token punctuation">(</span>periods<span class="token operator">=</span><span class="token operator">-</span>days<span class="token punctuation">)</span><span class="token punctuation">.</span>shift<span class="token punctuation">(</span>days<span class="token punctuation">)</span>
    <span class="token punctuation">)</span>

    df<span class="token punctuation">.</span>dropna<span class="token punctuation">(</span>subset<span class="token operator">=</span><span class="token punctuation">[</span>target_variable<span class="token punctuation">]</span><span class="token punctuation">,</span> inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> df
</code></pre>
    <h3>
     <a id="4__590">
     </a>
     4. å…³é”®æŠ€æœ¯å‚æ•°è¯´æ˜
    </h3>
    <table>
     <thead>
      <tr>
       <th>
        å‚æ•°
       </th>
       <th>
        è¯´æ˜
       </th>
       <th>
        è®¾ç½®å€¼
       </th>
       <th>
        æ³¨æ„äº‹é¡¹
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        <code>
         num_leaves
        </code>
       </td>
       <td>
        å¶å­èŠ‚ç‚¹æ•°
       </td>
       <td>
        é€šå¸¸è®¾ç½®åœ¨ 32 åˆ° 256 ä¹‹é—´
       </td>
       <td>
        è¿‡å¤šä¼šå¯¼è‡´è¿‡æ‹Ÿåˆï¼Œè¿‡å°‘ä¼šå¯¼è‡´æ¬ æ‹Ÿåˆ
       </td>
      </tr>
      <tr>
       <td>
        <code>
         learning_rate
        </code>
       </td>
       <td>
        å­¦ä¹ ç‡
       </td>
       <td>
        é€šå¸¸è®¾ç½®åœ¨ 0.01 åˆ° 0.3 ä¹‹é—´
       </td>
       <td>
        è¾ƒå°çš„å­¦ä¹ ç‡éœ€è¦æ›´å¤šçš„è¿­ä»£æ¬¡æ•°ï¼Œè¾ƒå¤§çš„å­¦ä¹ ç‡å¯èƒ½å¯¼è‡´ä¸æ”¶æ•›
       </td>
      </tr>
      <tr>
       <td>
        <code>
         max_depth
        </code>
       </td>
       <td>
        æœ€å¤§æ·±åº¦
       </td>
       <td>
        é€šå¸¸è®¾ç½®åœ¨ 3 åˆ° 15 ä¹‹é—´
       </td>
       <td>
        è¿‡æ·±ä¼šå¯¼è‡´è¿‡æ‹Ÿåˆï¼Œè¿‡æµ…ä¼šå¯¼è‡´æ¬ æ‹Ÿåˆ
       </td>
      </tr>
      <tr>
       <td>
        <code>
         min_child_samples
        </code>
       </td>
       <td>
        æœ€å°æ ·æœ¬æ•°
       </td>
       <td>
        é€šå¸¸è®¾ç½®åœ¨ 5 åˆ° 100 ä¹‹é—´
       </td>
       <td>
        è¿‡å°ä¼šå¯¼è‡´è¿‡æ‹Ÿåˆï¼Œè¿‡å¤§å¯èƒ½å¯¼è‡´æ¬ æ‹Ÿåˆ
       </td>
      </tr>
      <tr>
       <td>
        <code>
         subsample
        </code>
       </td>
       <td>
        å­é‡‡æ ·æ¯”ä¾‹
       </td>
       <td>
        é€šå¸¸è®¾ç½®åœ¨ 0.5 åˆ° 1.0 ä¹‹é—´
       </td>
       <td>
        è¾ƒå°çš„æ¯”ä¾‹å¯ä»¥å‡å°‘è¿‡æ‹Ÿåˆï¼Œä½†ä¼šå¢åŠ è®­ç»ƒæ—¶é—´
       </td>
      </tr>
      <tr>
       <td>
        <code>
         colsample_bytree
        </code>
       </td>
       <td>
        åˆ—é‡‡æ ·æ¯”ä¾‹
       </td>
       <td>
        é€šå¸¸è®¾ç½®åœ¨ 0.5 åˆ° 1.0 ä¹‹é—´
       </td>
       <td>
        è¾ƒå°çš„æ¯”ä¾‹å¯ä»¥å‡å°‘è¿‡æ‹Ÿåˆï¼Œä½†ä¼šå¢åŠ è®­ç»ƒæ—¶é—´
       </td>
      </tr>
      <tr>
       <td>
        <code>
         reg_alpha
        </code>
       </td>
       <td>
        L1 æ­£åˆ™åŒ–é¡¹
       </td>
       <td>
        é€šå¸¸è®¾ç½®åœ¨ 0.0 åˆ° 1.0 ä¹‹é—´
       </td>
       <td>
        è¾ƒå¤§çš„å€¼å¯ä»¥å‡å°‘è¿‡æ‹Ÿåˆï¼Œä½†å¯èƒ½é™ä½æ¨¡å‹æ€§èƒ½
       </td>
      </tr>
      <tr>
       <td>
        <code>
         reg_lambda
        </code>
       </td>
       <td>
        L2 æ­£åˆ™åŒ–é¡¹
       </td>
       <td>
        é€šå¸¸è®¾ç½®åœ¨ 0.0 åˆ° 1.0 ä¹‹é—´
       </td>
       <td>
        è¾ƒå¤§çš„å€¼å¯ä»¥å‡å°‘è¿‡æ‹Ÿåˆï¼Œä½†å¯èƒ½é™ä½æ¨¡å‹æ€§èƒ½
       </td>
      </tr>
     </tbody>
    </table>
    <h3>
     <a id="5__603">
     </a>
     5. ç­–ç•¥è¯„ä»·æŒ‡æ ‡
    </h3>
    <p>
     åœ¨é‡åŒ–æŠ•èµ„ç­–ç•¥çš„è¯„ä¼°ä¸­ï¼Œè¯„ä»·æŒ‡æ ‡æ˜¯è¡¡é‡ç­–ç•¥æ€§èƒ½çš„å…³é”®å·¥å…·ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸ç”¨çš„è¯„ä»·æŒ‡æ ‡åŠå…¶æ„ä¹‰ï¼š
    </p>
    <h4>
     <a id="51__607">
     </a>
     5.1 é¢„æµ‹å‡†ç¡®æ€§æŒ‡æ ‡
    </h4>
    <ul>
     <li>
      <p>
       <strong>
        å‡æ–¹è¯¯å·® (MSE)
       </strong>
       ï¼šè¡¡é‡é¢„æµ‹å€¼ä¸å®é™…å€¼ä¹‹é—´çš„å·®å¼‚ã€‚è¾ƒä½çš„ MSE è¡¨ç¤ºæ¨¡å‹é¢„æµ‹æ›´å‡†ç¡®ã€‚è®¡ç®—å…¬å¼ä¸ºï¼š
      </p>
      <p>
       <span class="katex--display">
        <span class="katex-display">
         <span class="katex">
          <span class="katex-mathml">
           MSE 
           
          
            = 
           
           
           
             1 
            
           
             n 
            
           
           
           
             âˆ‘ 
            
            
            
              i 
             
            
              = 
             
            
              1 
             
            
           
             n 
            
           
          
            ( 
           
           
           
             y 
            
           
             i 
            
           
          
            âˆ’ 
           
           
            
            
              y 
             
            
              ^ 
             
            
           
             i 
            
           
           
           
             ) 
            
           
             2 
            
           
          
         
           \text{MSE} = \frac{1}{n}\sum_{i=1}^{n}(y_i - \hat{y}_i)^2
          </span>
          <span class="katex-html">
           <span class="base">
            <span class="strut" style="height: 0.6833em;">
            </span>
            <span class="mord text">
             <span class="mord">
              MSE
             </span>
            </span>
            <span class="mspace" style="margin-right: 0.2778em;">
            </span>
            <span class="mrel">
             =
            </span>
            <span class="mspace" style="margin-right: 0.2778em;">
            </span>
           </span>
           <span class="base">
            <span class="strut" style="height: 2.9291em; vertical-align: -1.2777em;">
            </span>
            <span class="mord">
             <span class="mopen nulldelimiter">
             </span>
             <span class="mfrac">
              <span class="vlist-t vlist-t2">
               <span class="vlist-r">
                <span class="vlist" style="height: 1.3214em;">
                 <span class="" style="top: -2.314em;">
                  <span class="pstrut" style="height: 3em;">
                  </span>
                  <span class="mord">
                   <span class="mord mathnormal">
                    n
                   </span>
                  </span>
                 </span>
                 <span class="" style="top: -3.23em;">
                  <span class="pstrut" style="height: 3em;">
                  </span>
                  <span class="frac-line" style="border-bottom-width: 0.04em;">
                  </span>
                 </span>
                 <span class="" style="top: -3.677em;">
                  <span class="pstrut" style="height: 3em;">
                  </span>
                  <span class="mord">
                   <span class="mord">
                    1
                   </span>
                  </span>
                 </span>
                </span>
                <span class="vlist-s">
                 â€‹
                </span>
               </span>
               <span class="vlist-r">
                <span class="vlist" style="height: 0.686em;">
                 <span class="">
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="mclose nulldelimiter">
             </span>
            </span>
            <span class="mspace" style="margin-right: 0.1667em;">
            </span>
            <span class="mop op-limits">
             <span class="vlist-t vlist-t2">
              <span class="vlist-r">
               <span class="vlist" style="height: 1.6514em;">
                <span class="" style="top: -1.8723em; margin-left: 0em;">
                 <span class="pstrut" style="height: 3.05em;">
                 </span>
                 <span class="sizing reset-size6 size3 mtight">
                  <span class="mord mtight">
                   <span class="mord mathnormal mtight">
                    i
                   </span>
                   <span class="mrel mtight">
                    =
                   </span>
                   <span class="mord mtight">
                    1
                   </span>
                  </span>
                 </span>
                </span>
                <span class="" style="top: -3.05em;">
                 <span class="pstrut" style="height: 3.05em;">
                 </span>
                 <span class="">
                  <span class="mop op-symbol large-op">
                   âˆ‘
                  </span>
                 </span>
                </span>
                <span class="" style="top: -4.3em; margin-left: 0em;">
                 <span class="pstrut" style="height: 3.05em;">
                 </span>
                 <span class="sizing reset-size6 size3 mtight">
                  <span class="mord mtight">
                   <span class="mord mathnormal mtight">
                    n
                   </span>
                  </span>
                 </span>
                </span>
               </span>
               <span class="vlist-s">
                â€‹
               </span>
              </span>
              <span class="vlist-r">
               <span class="vlist" style="height: 1.2777em;">
                <span class="">
                </span>
               </span>
              </span>
             </span>
            </span>
            <span class="mopen">
             (
            </span>
            <span class="mord">
             <span class="mord mathnormal" style="margin-right: 0.0359em;">
              y
             </span>
             <span class="msupsub">
              <span class="vlist-t vlist-t2">
               <span class="vlist-r">
                <span class="vlist" style="height: 0.3117em;">
                 <span class="" style="top: -2.55em; margin-left: -0.0359em; margin-right: 0.05em;">
                  <span class="pstrut" style="height: 2.7em;">
                  </span>
                  <span class="sizing reset-size6 size3 mtight">
                   <span class="mord mathnormal mtight">
                    i
                   </span>
                  </span>
                 </span>
                </span>
                <span class="vlist-s">
                 â€‹
                </span>
               </span>
               <span class="vlist-r">
                <span class="vlist" style="height: 0.15em;">
                 <span class="">
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
            <span class="mspace" style="margin-right: 0.2222em;">
            </span>
            <span class="mbin">
             âˆ’
            </span>
            <span class="mspace" style="margin-right: 0.2222em;">
            </span>
           </span>
           <span class="base">
            <span class="strut" style="height: 1.1141em; vertical-align: -0.25em;">
            </span>
            <span class="mord">
             <span class="mord accent">
              <span class="vlist-t vlist-t2">
               <span class="vlist-r">
                <span class="vlist" style="height: 0.6944em;">
                 <span class="" style="top: -3em;">
                  <span class="pstrut" style="height: 3em;">
                  </span>
                  <span class="mord mathnormal" style="margin-right: 0.0359em;">
                   y
                  </span>
                 </span>
                 <span class="" style="top: -3em;">
                  <span class="pstrut" style="height: 3em;">
                  </span>
                  <span class="accent-body" style="left: -0.1944em;">
                   <span class="mord">
                    ^
                   </span>
                  </span>
                 </span>
                </span>
                <span class="vlist-s">
                 â€‹
                </span>
               </span>
               <span class="vlist-r">
                <span class="vlist" style="height: 0.1944em;">
                 <span class="">
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="msupsub">
              <span class="vlist-t vlist-t2">
               <span class="vlist-r">
                <span class="vlist" style="height: 0.3117em;">
                 <span class="" style="top: -2.55em; margin-left: -0.0359em; margin-right: 0.05em;">
                  <span class="pstrut" style="height: 2.7em;">
                  </span>
                  <span class="sizing reset-size6 size3 mtight">
                   <span class="mord mathnormal mtight">
                    i
                   </span>
                  </span>
                 </span>
                </span>
                <span class="vlist-s">
                 â€‹
                </span>
               </span>
               <span class="vlist-r">
                <span class="vlist" style="height: 0.15em;">
                 <span class="">
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
            <span class="mclose">
             <span class="mclose">
              )
             </span>
             <span class="msupsub">
              <span class="vlist-t">
               <span class="vlist-r">
                <span class="vlist" style="height: 0.8641em;">
                 <span class="" style="top: -3.113em; margin-right: 0.05em;">
                  <span class="pstrut" style="height: 2.7em;">
                  </span>
                  <span class="sizing reset-size6 size3 mtight">
                   <span class="mord mtight">
                    2
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
       <br/>
       å…¶ä¸­ï¼Œ
       <span class="katex--inline">
        <span class="katex">
         <span class="katex-mathml">
          y 
           
          
            i 
           
          
         
        
          y_i
         </span>
         <span class="katex-html">
          <span class="base">
           <span class="strut" style="height: 0.625em; vertical-align: -0.1944em;">
           </span>
           <span class="mord">
            <span class="mord mathnormal" style="margin-right: 0.0359em;">
             y
            </span>
            <span class="msupsub">
             <span class="vlist-t vlist-t2">
              <span class="vlist-r">
               <span class="vlist" style="height: 0.3117em;">
                <span class="" style="top: -2.55em; margin-left: -0.0359em; margin-right: 0.05em;">
                 <span class="pstrut" style="height: 2.7em;">
                 </span>
                 <span class="sizing reset-size6 size3 mtight">
                  <span class="mord mathnormal mtight">
                   i
                  </span>
                 </span>
                </span>
               </span>
               <span class="vlist-s">
                â€‹
               </span>
              </span>
              <span class="vlist-r">
               <span class="vlist" style="height: 0.15em;">
                <span class="">
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
       æ˜¯å®é™…å€¼ï¼Œ
       <span class="katex--inline">
        <span class="katex">
         <span class="katex-mathml">
          y 
            
           
             ^ 
            
           
          
            i 
           
          
         
        
          \hat{y}_i
         </span>
         <span class="katex-html">
          <span class="base">
           <span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;">
           </span>
           <span class="mord">
            <span class="mord accent">
             <span class="vlist-t vlist-t2">
              <span class="vlist-r">
               <span class="vlist" style="height: 0.6944em;">
                <span class="" style="top: -3em;">
                 <span class="pstrut" style="height: 3em;">
                 </span>
                 <span class="mord mathnormal" style="margin-right: 0.0359em;">
                  y
                 </span>
                </span>
                <span class="" style="top: -3em;">
                 <span class="pstrut" style="height: 3em;">
                 </span>
                 <span class="accent-body" style="left: -0.1944em;">
                  <span class="mord">
                   ^
                  </span>
                 </span>
                </span>
               </span>
               <span class="vlist-s">
                â€‹
               </span>
              </span>
              <span class="vlist-r">
               <span class="vlist" style="height: 0.1944em;">
                <span class="">
                </span>
               </span>
              </span>
             </span>
            </span>
            <span class="msupsub">
             <span class="vlist-t vlist-t2">
              <span class="vlist-r">
               <span class="vlist" style="height: 0.3117em;">
                <span class="" style="top: -2.55em; margin-left: -0.0359em; margin-right: 0.05em;">
                 <span class="pstrut" style="height: 2.7em;">
                 </span>
                 <span class="sizing reset-size6 size3 mtight">
                  <span class="mord mathnormal mtight">
                   i
                  </span>
                 </span>
                </span>
               </span>
               <span class="vlist-s">
                â€‹
               </span>
              </span>
              <span class="vlist-r">
               <span class="vlist" style="height: 0.15em;">
                <span class="">
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
       æ˜¯é¢„æµ‹å€¼ï¼Œ
       <span class="katex--inline">
        <span class="katex">
         <span class="katex-mathml">
          n 
          
         
        
          n
         </span>
         <span class="katex-html">
          <span class="base">
           <span class="strut" style="height: 0.4306em;">
           </span>
           <span class="mord mathnormal">
            n
           </span>
          </span>
         </span>
        </span>
       </span>
       æ˜¯æ ·æœ¬æ•°é‡ã€‚
      </p>
     </li>
     <li>
      <p>
       <strong>
        å¹³å‡ç»å¯¹è¯¯å·® (MAE)
       </strong>
       ï¼šè¡¡é‡é¢„æµ‹å€¼ä¸å®é™…å€¼ä¹‹é—´çš„ç»å¯¹å·®å¼‚ã€‚è¾ƒä½çš„ MAE è¡¨ç¤ºæ¨¡å‹é¢„æµ‹æ›´å‡†ç¡®ã€‚è®¡ç®—å…¬å¼ä¸ºï¼š
      </p>
      <p>
       <span class="katex--display">
        <span class="katex-display">
         <span class="katex">
          <span class="katex-mathml">
           MAE 
           
          
            = 
           
           
           
             1 
            
           
             n 
            
           
           
           
             âˆ‘ 
            
            
            
              i 
             
            
              = 
             
            
              1 
             
            
           
             n 
            
           
          
            âˆ£ 
           
           
           
             y 
            
           
             i 
            
           
          
            âˆ’ 
           
           
            
            
              y 
             
            
              ^ 
             
            
           
             i 
            
           
          
            âˆ£ 
           
          
         
           \text{MAE} = \frac{1}{n}\sum_{i=1}^{n}|y_i - \hat{y}_i|
          </span>
          <span class="katex-html">
           <span class="base">
            <span class="strut" style="height: 0.6833em;">
            </span>
            <span class="mord text">
             <span class="mord">
              MAE
             </span>
            </span>
            <span class="mspace" style="margin-right: 0.2778em;">
            </span>
            <span class="mrel">
             =
            </span>
            <span class="mspace" style="margin-right: 0.2778em;">
            </span>
           </span>
           <span class="base">
            <span class="strut" style="height: 2.9291em; vertical-align: -1.2777em;">
            </span>
            <span class="mord">
             <span class="mopen nulldelimiter">
             </span>
             <span class="mfrac">
              <span class="vlist-t vlist-t2">
               <span class="vlist-r">
                <span class="vlist" style="height: 1.3214em;">
                 <span class="" style="top: -2.314em;">
                  <span class="pstrut" style="height: 3em;">
                  </span>
                  <span class="mord">
                   <span class="mord mathnormal">
                    n
                   </span>
                  </span>
                 </span>
                 <span class="" style="top: -3.23em;">
                  <span class="pstrut" style="height: 3em;">
                  </span>
                  <span class="frac-line" style="border-bottom-width: 0.04em;">
                  </span>
                 </span>
                 <span class="" style="top: -3.677em;">
                  <span class="pstrut" style="height: 3em;">
                  </span>
                  <span class="mord">
                   <span class="mord">
                    1
                   </span>
                  </span>
                 </span>
                </span>
                <span class="vlist-s">
                 â€‹
                </span>
               </span>
               <span class="vlist-r">
                <span class="vlist" style="height: 0.686em;">
                 <span class="">
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="mclose nulldelimiter">
             </span>
            </span>
            <span class="mspace" style="margin-right: 0.1667em;">
            </span>
            <span class="mop op-limits">
             <span class="vlist-t vlist-t2">
              <span class="vlist-r">
               <span class="vlist" style="height: 1.6514em;">
                <span class="" style="top: -1.8723em; margin-left: 0em;">
                 <span class="pstrut" style="height: 3.05em;">
                 </span>
                 <span class="sizing reset-size6 size3 mtight">
                  <span class="mord mtight">
                   <span class="mord mathnormal mtight">
                    i
                   </span>
                   <span class="mrel mtight">
                    =
                   </span>
                   <span class="mord mtight">
                    1
                   </span>
                  </span>
                 </span>
                </span>
                <span class="" style="top: -3.05em;">
                 <span class="pstrut" style="height: 3.05em;">
                 </span>
                 <span class="">
                  <span class="mop op-symbol large-op">
                   âˆ‘
                  </span>
                 </span>
                </span>
                <span class="" style="top: -4.3em; margin-left: 0em;">
                 <span class="pstrut" style="height: 3.05em;">
                 </span>
                 <span class="sizing reset-size6 size3 mtight">
                  <span class="mord mtight">
                   <span class="mord mathnormal mtight">
                    n
                   </span>
                  </span>
                 </span>
                </span>
               </span>
               <span class="vlist-s">
                â€‹
               </span>
              </span>
              <span class="vlist-r">
               <span class="vlist" style="height: 1.2777em;">
                <span class="">
                </span>
               </span>
              </span>
             </span>
            </span>
            <span class="mspace" style="margin-right: 0.1667em;">
            </span>
            <span class="mord">
             âˆ£
            </span>
            <span class="mord">
             <span class="mord mathnormal" style="margin-right: 0.0359em;">
              y
             </span>
             <span class="msupsub">
              <span class="vlist-t vlist-t2">
               <span class="vlist-r">
                <span class="vlist" style="height: 0.3117em;">
                 <span class="" style="top: -2.55em; margin-left: -0.0359em; margin-right: 0.05em;">
                  <span class="pstrut" style="height: 2.7em;">
                  </span>
                  <span class="sizing reset-size6 size3 mtight">
                   <span class="mord mathnormal mtight">
                    i
                   </span>
                  </span>
                 </span>
                </span>
                <span class="vlist-s">
                 â€‹
                </span>
               </span>
               <span class="vlist-r">
                <span class="vlist" style="height: 0.15em;">
                 <span class="">
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
            <span class="mspace" style="margin-right: 0.2222em;">
            </span>
            <span class="mbin">
             âˆ’
            </span>
            <span class="mspace" style="margin-right: 0.2222em;">
            </span>
           </span>
           <span class="base">
            <span class="strut" style="height: 1em; vertical-align: -0.25em;">
            </span>
            <span class="mord">
             <span class="mord accent">
              <span class="vlist-t vlist-t2">
               <span class="vlist-r">
                <span class="vlist" style="height: 0.6944em;">
                 <span class="" style="top: -3em;">
                  <span class="pstrut" style="height: 3em;">
                  </span>
                  <span class="mord mathnormal" style="margin-right: 0.0359em;">
                   y
                  </span>
                 </span>
                 <span class="" style="top: -3em;">
                  <span class="pstrut" style="height: 3em;">
                  </span>
                  <span class="accent-body" style="left: -0.1944em;">
                   <span class="mord">
                    ^
                   </span>
                  </span>
                 </span>
                </span>
                <span class="vlist-s">
                 â€‹
                </span>
               </span>
               <span class="vlist-r">
                <span class="vlist" style="height: 0.1944em;">
                 <span class="">
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="msupsub">
              <span class="vlist-t vlist-t2">
               <span class="vlist-r">
                <span class="vlist" style="height: 0.3117em;">
                 <span class="" style="top: -2.55em; margin-left: -0.0359em; margin-right: 0.05em;">
                  <span class="pstrut" style="height: 2.7em;">
                  </span>
                  <span class="sizing reset-size6 size3 mtight">
                   <span class="mord mathnormal mtight">
                    i
                   </span>
                  </span>
                 </span>
                </span>
                <span class="vlist-s">
                 â€‹
                </span>
               </span>
               <span class="vlist-r">
                <span class="vlist" style="height: 0.15em;">
                 <span class="">
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
            <span class="mord">
             âˆ£
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
       <br/>
       å…¶ä¸­ï¼Œ
       <span class="katex--inline">
        <span class="katex">
         <span class="katex-mathml">
          y 
           
          
            i 
           
          
         
        
          y_i
         </span>
         <span class="katex-html">
          <span class="base">
           <span class="strut" style="height: 0.625em; vertical-align: -0.1944em;">
           </span>
           <span class="mord">
            <span class="mord mathnormal" style="margin-right: 0.0359em;">
             y
            </span>
            <span class="msupsub">
             <span class="vlist-t vlist-t2">
              <span class="vlist-r">
               <span class="vlist" style="height: 0.3117em;">
                <span class="" style="top: -2.55em; margin-left: -0.0359em; margin-right: 0.05em;">
                 <span class="pstrut" style="height: 2.7em;">
                 </span>
                 <span class="sizing reset-size6 size3 mtight">
                  <span class="mord mathnormal mtight">
                   i
                  </span>
                 </span>
                </span>
               </span>
               <span class="vlist-s">
                â€‹
               </span>
              </span>
              <span class="vlist-r">
               <span class="vlist" style="height: 0.15em;">
                <span class="">
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
       æ˜¯å®é™…å€¼ï¼Œ
       <span class="katex--inline">
        <span class="katex">
         <span class="katex-mathml">
          y 
            
           
             ^ 
            
           
          
            i 
           
          
         
        
          \hat{y}_i
         </span>
         <span class="katex-html">
          <span class="base">
           <span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;">
           </span>
           <span class="mord">
            <span class="mord accent">
             <span class="vlist-t vlist-t2">
              <span class="vlist-r">
               <span class="vlist" style="height: 0.6944em;">
                <span class="" style="top: -3em;">
                 <span class="pstrut" style="height: 3em;">
                 </span>
                 <span class="mord mathnormal" style="margin-right: 0.0359em;">
                  y
                 </span>
                </span>
                <span class="" style="top: -3em;">
                 <span class="pstrut" style="height: 3em;">
                 </span>
                 <span class="accent-body" style="left: -0.1944em;">
                  <span class="mord">
                   ^
                  </span>
                 </span>
                </span>
               </span>
               <span class="vlist-s">
                â€‹
               </span>
              </span>
              <span class="vlist-r">
               <span class="vlist" style="height: 0.1944em;">
                <span class="">
                </span>
               </span>
              </span>
             </span>
            </span>
            <span class="msupsub">
             <span class="vlist-t vlist-t2">
              <span class="vlist-r">
               <span class="vlist" style="height: 0.3117em;">
                <span class="" style="top: -2.55em; margin-left: -0.0359em; margin-right: 0.05em;">
                 <span class="pstrut" style="height: 2.7em;">
                 </span>
                 <span class="sizing reset-size6 size3 mtight">
                  <span class="mord mathnormal mtight">
                   i
                  </span>
                 </span>
                </span>
               </span>
               <span class="vlist-s">
                â€‹
               </span>
              </span>
              <span class="vlist-r">
               <span class="vlist" style="height: 0.15em;">
                <span class="">
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
       æ˜¯é¢„æµ‹å€¼ï¼Œ
       <span class="katex--inline">
        <span class="katex">
         <span class="katex-mathml">
          n 
          
         
        
          n
         </span>
         <span class="katex-html">
          <span class="base">
           <span class="strut" style="height: 0.4306em;">
           </span>
           <span class="mord mathnormal">
            n
           </span>
          </span>
         </span>
        </span>
       </span>
       æ˜¯æ ·æœ¬æ•°é‡ã€‚
      </p>
     </li>
     <li>
      <p>
       <strong>
        RÂ² åˆ†æ•°
       </strong>
       ï¼šè¡¡é‡æ¨¡å‹è§£é‡Šæ•°æ®å˜å¼‚æ€§çš„èƒ½åŠ›ã€‚è¾ƒé«˜çš„ RÂ² åˆ†æ•°è¡¨ç¤ºæ¨¡å‹è§£é‡Šèƒ½åŠ›å¼ºã€‚RÂ² çš„å–å€¼èŒƒå›´ä¸º [0, 1]ï¼Œå€¼è¶Šæ¥è¿‘ 1 è¡¨ç¤ºæ¨¡å‹æ‹Ÿåˆæ•ˆæœè¶Šå¥½ã€‚è®¡ç®—å…¬å¼ä¸ºï¼š
      </p>
      <p>
       <span class="katex--display">
        <span class="katex-display">
         <span class="katex">
          <span class="katex-mathml">
           R 
            
           
             2 
            
           
          
            = 
           
          
            1 
           
          
            âˆ’ 
           
           
            
             
             
               âˆ‘ 
              
              
              
                i 
               
              
                = 
               
              
                1 
               
              
             
               n 
              
             
            
              ( 
             
             
             
               y 
              
             
               i 
              
             
            
              âˆ’ 
             
             
              
              
                y 
               
              
                ^ 
               
              
             
               i 
              
             
             
             
               ) 
              
             
               2 
              
             
            
            
             
             
               âˆ‘ 
              
              
              
                i 
               
              
                = 
               
              
                1 
               
              
             
               n 
              
             
            
              ( 
             
             
             
               y 
              
             
               i 
              
             
            
              âˆ’ 
             
             
             
               y 
              
             
               Ë‰ 
              
             
             
             
               ) 
              
             
               2 
              
             
            
           
          
         
           R^2 = 1 - \frac{\sum_{i=1}^{n}(y_i - \hat{y}_i)^2}{\sum_{i=1}^{n}(y_i - \bar{y})^2}
          </span>
          <span class="katex-html">
           <span class="base">
            <span class="strut" style="height: 0.8641em;">
            </span>
            <span class="mord">
             <span class="mord mathnormal" style="margin-right: 0.0077em;">
              R
             </span>
             <span class="msupsub">
              <span class="vlist-t">
               <span class="vlist-r">
                <span class="vlist" style="height: 0.8641em;">
                 <span class="" style="top: -3.113em; margin-right: 0.05em;">
                  <span class="pstrut" style="height: 2.7em;">
                  </span>
                  <span class="sizing reset-size6 size3 mtight">
                   <span class="mord mtight">
                    2
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
            <span class="mspace" style="margin-right: 0.2778em;">
            </span>
            <span class="mrel">
             =
            </span>
            <span class="mspace" style="margin-right: 0.2778em;">
            </span>
           </span>
           <span class="base">
            <span class="strut" style="height: 0.7278em; vertical-align: -0.0833em;">
            </span>
            <span class="mord">
             1
            </span>
            <span class="mspace" style="margin-right: 0.2222em;">
            </span>
            <span class="mbin">
             âˆ’
            </span>
            <span class="mspace" style="margin-right: 0.2222em;">
            </span>
           </span>
           <span class="base">
            <span class="strut" style="height: 2.4978em; vertical-align: -0.994em;">
            </span>
            <span class="mord">
             <span class="mopen nulldelimiter">
             </span>
             <span class="mfrac">
              <span class="vlist-t vlist-t2">
               <span class="vlist-r">
                <span class="vlist" style="height: 1.5038em;">
                 <span class="" style="top: -2.3057em;">
                  <span class="pstrut" style="height: 3em;">
                  </span>
                  <span class="mord">
                   <span class="mop">
                    <span class="mop op-symbol small-op" style="position: relative; top: 0em;">
                     âˆ‘
                    </span>
                    <span class="msupsub">
                     <span class="vlist-t vlist-t2">
                      <span class="vlist-r">
                       <span class="vlist" style="height: 0.8043em;">
                        <span class="" style="top: -2.4003em; margin-left: 0em; margin-right: 0.05em;">
                         <span class="pstrut" style="height: 2.7em;">
                         </span>
                         <span class="sizing reset-size6 size3 mtight">
                          <span class="mord mtight">
                           <span class="mord mathnormal mtight">
                            i
                           </span>
                           <span class="mrel mtight">
                            =
                           </span>
                           <span class="mord mtight">
                            1
                           </span>
                          </span>
                         </span>
                        </span>
                        <span class="" style="top: -3.2029em; margin-right: 0.05em;">
                         <span class="pstrut" style="height: 2.7em;">
                         </span>
                         <span class="sizing reset-size6 size3 mtight">
                          <span class="mord mtight">
                           <span class="mord mathnormal mtight">
                            n
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                       <span class="vlist-s">
                        â€‹
                       </span>
                      </span>
                      <span class="vlist-r">
                       <span class="vlist" style="height: 0.2997em;">
                        <span class="">
                        </span>
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                   <span class="mopen">
                    (
                   </span>
                   <span class="mord">
                    <span class="mord mathnormal" style="margin-right: 0.0359em;">
                     y
                    </span>
                    <span class="msupsub">
                     <span class="vlist-t vlist-t2">
                      <span class="vlist-r">
                       <span class="vlist" style="height: 0.3117em;">
                        <span class="" style="top: -2.55em; margin-left: -0.0359em; margin-right: 0.05em;">
                         <span class="pstrut" style="height: 2.7em;">
                         </span>
                         <span class="sizing reset-size6 size3 mtight">
                          <span class="mord mathnormal mtight">
                           i
                          </span>
                         </span>
                        </span>
                       </span>
                       <span class="vlist-s">
                        â€‹
                       </span>
                      </span>
                      <span class="vlist-r">
                       <span class="vlist" style="height: 0.15em;">
                        <span class="">
                        </span>
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                   <span class="mspace" style="margin-right: 0.2222em;">
                   </span>
                   <span class="mbin">
                    âˆ’
                   </span>
                   <span class="mspace" style="margin-right: 0.2222em;">
                   </span>
                   <span class="mord accent">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.5678em;">
                       <span class="" style="top: -3em;">
                        <span class="pstrut" style="height: 3em;">
                        </span>
                        <span class="mord mathnormal" style="margin-right: 0.0359em;">
                         y
                        </span>
                       </span>
                       <span class="" style="top: -3em;">
                        <span class="pstrut" style="height: 3em;">
                        </span>
                        <span class="accent-body" style="left: -0.1944em;">
                         <span class="mord">
                          Ë‰
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       â€‹
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.1944em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                   <span class="mclose">
                    <span class="mclose">
                     )
                    </span>
                    <span class="msupsub">
                     <span class="vlist-t">
                      <span class="vlist-r">
                       <span class="vlist" style="height: 0.7401em;">
                        <span class="" style="top: -2.989em; margin-right: 0.05em;">
                         <span class="pstrut" style="height: 2.7em;">
                         </span>
                         <span class="sizing reset-size6 size3 mtight">
                          <span class="mord mtight">
                           2
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                 <span class="" style="top: -3.23em;">
                  <span class="pstrut" style="height: 3em;">
                  </span>
                  <span class="frac-line" style="border-bottom-width: 0.04em;">
                  </span>
                 </span>
                 <span class="" style="top: -3.6897em;">
                  <span class="pstrut" style="height: 3em;">
                  </span>
                  <span class="mord">
                   <span class="mop">
                    <span class="mop op-symbol small-op" style="position: relative; top: 0em;">
                     âˆ‘
                    </span>
                    <span class="msupsub">
                     <span class="vlist-t vlist-t2">
                      <span class="vlist-r">
                       <span class="vlist" style="height: 0.8043em;">
                        <span class="" style="top: -2.4003em; margin-left: 0em; margin-right: 0.05em;">
                         <span class="pstrut" style="height: 2.7em;">
                         </span>
                         <span class="sizing reset-size6 size3 mtight">
                          <span class="mord mtight">
                           <span class="mord mathnormal mtight">
                            i
                           </span>
                           <span class="mrel mtight">
                            =
                           </span>
                           <span class="mord mtight">
                            1
                           </span>
                          </span>
                         </span>
                        </span>
                        <span class="" style="top: -3.2029em; margin-right: 0.05em;">
                         <span class="pstrut" style="height: 2.7em;">
                         </span>
                         <span class="sizing reset-size6 size3 mtight">
                          <span class="mord mtight">
                           <span class="mord mathnormal mtight">
                            n
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                       <span class="vlist-s">
                        â€‹
                       </span>
                      </span>
                      <span class="vlist-r">
                       <span class="vlist" style="height: 0.2997em;">
                        <span class="">
                        </span>
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                   <span class="mopen">
                    (
                   </span>
                   <span class="mord">
                    <span class="mord mathnormal" style="margin-right: 0.0359em;">
                     y
                    </span>
                    <span class="msupsub">
                     <span class="vlist-t vlist-t2">
                      <span class="vlist-r">
                       <span class="vlist" style="height: 0.3117em;">
                        <span class="" style="top: -2.55em; margin-left: -0.0359em; margin-right: 0.05em;">
                         <span class="pstrut" style="height: 2.7em;">
                         </span>
                         <span class="sizing reset-size6 size3 mtight">
                          <span class="mord mathnormal mtight">
                           i
                          </span>
                         </span>
                        </span>
                       </span>
                       <span class="vlist-s">
                        â€‹
                       </span>
                      </span>
                      <span class="vlist-r">
                       <span class="vlist" style="height: 0.15em;">
                        <span class="">
                        </span>
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                   <span class="mspace" style="margin-right: 0.2222em;">
                   </span>
                   <span class="mbin">
                    âˆ’
                   </span>
                   <span class="mspace" style="margin-right: 0.2222em;">
                   </span>
                   <span class="mord">
                    <span class="mord accent">
                     <span class="vlist-t vlist-t2">
                      <span class="vlist-r">
                       <span class="vlist" style="height: 0.6944em;">
                        <span class="" style="top: -3em;">
                         <span class="pstrut" style="height: 3em;">
                         </span>
                         <span class="mord mathnormal" style="margin-right: 0.0359em;">
                          y
                         </span>
                        </span>
                        <span class="" style="top: -3em;">
                         <span class="pstrut" style="height: 3em;">
                         </span>
                         <span class="accent-body" style="left: -0.1944em;">
                          <span class="mord">
                           ^
                          </span>
                         </span>
                        </span>
                       </span>
                       <span class="vlist-s">
                        â€‹
                       </span>
                      </span>
                      <span class="vlist-r">
                       <span class="vlist" style="height: 0.1944em;">
                        <span class="">
                        </span>
                       </span>
                      </span>
                     </span>
                    </span>
                    <span class="msupsub">
                     <span class="vlist-t vlist-t2">
                      <span class="vlist-r">
                       <span class="vlist" style="height: 0.3117em;">
                        <span class="" style="top: -2.55em; margin-left: -0.0359em; margin-right: 0.05em;">
                         <span class="pstrut" style="height: 2.7em;">
                         </span>
                         <span class="sizing reset-size6 size3 mtight">
                          <span class="mord mathnormal mtight">
                           i
                          </span>
                         </span>
                        </span>
                       </span>
                       <span class="vlist-s">
                        â€‹
                       </span>
                      </span>
                      <span class="vlist-r">
                       <span class="vlist" style="height: 0.15em;">
                        <span class="">
                        </span>
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                   <span class="mclose">
                    <span class="mclose">
                     )
                    </span>
                    <span class="msupsub">
                     <span class="vlist-t">
                      <span class="vlist-r">
                       <span class="vlist" style="height: 0.8141em;">
                        <span class="" style="top: -3.063em; margin-right: 0.05em;">
                         <span class="pstrut" style="height: 2.7em;">
                         </span>
                         <span class="sizing reset-size6 size3 mtight">
                          <span class="mord mtight">
                           2
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
                <span class="vlist-s">
                 â€‹
                </span>
               </span>
               <span class="vlist-r">
                <span class="vlist" style="height: 0.994em;">
                 <span class="">
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="mclose nulldelimiter">
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
       <br/>
       å…¶ä¸­ï¼Œ
       <span class="katex--inline">
        <span class="katex">
         <span class="katex-mathml">
          y 
           
          
            i 
           
          
         
        
          y_i
         </span>
         <span class="katex-html">
          <span class="base">
           <span class="strut" style="height: 0.625em; vertical-align: -0.1944em;">
           </span>
           <span class="mord">
            <span class="mord mathnormal" style="margin-right: 0.0359em;">
             y
            </span>
            <span class="msupsub">
             <span class="vlist-t vlist-t2">
              <span class="vlist-r">
               <span class="vlist" style="height: 0.3117em;">
                <span class="" style="top: -2.55em; margin-left: -0.0359em; margin-right: 0.05em;">
                 <span class="pstrut" style="height: 2.7em;">
                 </span>
                 <span class="sizing reset-size6 size3 mtight">
                  <span class="mord mathnormal mtight">
                   i
                  </span>
                 </span>
                </span>
               </span>
               <span class="vlist-s">
                â€‹
               </span>
              </span>
              <span class="vlist-r">
               <span class="vlist" style="height: 0.15em;">
                <span class="">
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
       æ˜¯å®é™…å€¼ï¼Œ
       <span class="katex--inline">
        <span class="katex">
         <span class="katex-mathml">
          y 
            
           
             ^ 
            
           
          
            i 
           
          
         
        
          \hat{y}_i
         </span>
         <span class="katex-html">
          <span class="base">
           <span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;">
           </span>
           <span class="mord">
            <span class="mord accent">
             <span class="vlist-t vlist-t2">
              <span class="vlist-r">
               <span class="vlist" style="height: 0.6944em;">
                <span class="" style="top: -3em;">
                 <span class="pstrut" style="height: 3em;">
                 </span>
                 <span class="mord mathnormal" style="margin-right: 0.0359em;">
                  y
                 </span>
                </span>
                <span class="" style="top: -3em;">
                 <span class="pstrut" style="height: 3em;">
                 </span>
                 <span class="accent-body" style="left: -0.1944em;">
                  <span class="mord">
                   ^
                  </span>
                 </span>
                </span>
               </span>
               <span class="vlist-s">
                â€‹
               </span>
              </span>
              <span class="vlist-r">
               <span class="vlist" style="height: 0.1944em;">
                <span class="">
                </span>
               </span>
              </span>
             </span>
            </span>
            <span class="msupsub">
             <span class="vlist-t vlist-t2">
              <span class="vlist-r">
               <span class="vlist" style="height: 0.3117em;">
                <span class="" style="top: -2.55em; margin-left: -0.0359em; margin-right: 0.05em;">
                 <span class="pstrut" style="height: 2.7em;">
                 </span>
                 <span class="sizing reset-size6 size3 mtight">
                  <span class="mord mathnormal mtight">
                   i
                  </span>
                 </span>
                </span>
               </span>
               <span class="vlist-s">
                â€‹
               </span>
              </span>
              <span class="vlist-r">
               <span class="vlist" style="height: 0.15em;">
                <span class="">
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
       æ˜¯æ¨¡å‹çš„é¢„æµ‹å€¼ï¼Œ
       <span class="katex--inline">
        <span class="katex">
         <span class="katex-mathml">
          y 
           
          
            Ë‰ 
           
          
         
        
          \bar{y}
         </span>
         <span class="katex-html">
          <span class="base">
           <span class="strut" style="height: 0.7622em; vertical-align: -0.1944em;">
           </span>
           <span class="mord accent">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.5678em;">
               <span class="" style="top: -3em;">
                <span class="pstrut" style="height: 3em;">
                </span>
                <span class="mord mathnormal" style="margin-right: 0.0359em;">
                 y
                </span>
               </span>
               <span class="" style="top: -3em;">
                <span class="pstrut" style="height: 3em;">
                </span>
                <span class="accent-body" style="left: -0.1944em;">
                 <span class="mord">
                  Ë‰
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               â€‹
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.1944em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
       æ˜¯å®é™…å€¼çš„å‡å€¼ï¼Œ
       <span class="katex--inline">
        <span class="katex">
         <span class="katex-mathml">
          n 
          
         
        
          n
         </span>
         <span class="katex-html">
          <span class="base">
           <span class="strut" style="height: 0.4306em;">
           </span>
           <span class="mord mathnormal">
            n
           </span>
          </span>
         </span>
        </span>
       </span>
       æ˜¯æ ·æœ¬æ•°é‡ã€‚
      </p>
     </li>
    </ul>
    <h4>
     <a id="52__630">
     </a>
     5.2 é£é™©ä¸æ”¶ç›ŠæŒ‡æ ‡
    </h4>
    <ul>
     <li>
      <p>
       <strong>
        å¤æ™®æ¯”ç‡
       </strong>
       ï¼šè¡¡é‡å•ä½é£é™©çš„è¶…é¢å›æŠ¥ï¼Œè¶Šé«˜è¶Šå¥½ã€‚è®¡ç®—å…¬å¼ä¸ºï¼š
      </p>
      <p>
       <span class="katex--display">
        <span class="katex-display">
         <span class="katex">
          <span class="katex-mathml">
           å¤æ™®æ¯”ç‡ 
           
          
            = 
           
           
            
             
             
               R 
              
             
               p 
              
             
            
              âˆ’ 
             
             
             
               R 
              
             
               f 
              
             
            
            
            
              Ïƒ 
             
            
              p 
             
            
           
          
         
           \text{å¤æ™®æ¯”ç‡} = \frac{R_p - R_f}{\sigma_p}
          </span>
          <span class="katex-html">
           <span class="base">
            <span class="strut" style="height: 0.6833em;">
            </span>
            <span class="mord text">
             <span class="mord cjk_fallback">
              å¤æ™®æ¯”ç‡
             </span>
            </span>
            <span class="mspace" style="margin-right: 0.2778em;">
            </span>
            <span class="mrel">
             =
            </span>
            <span class="mspace" style="margin-right: 0.2778em;">
            </span>
           </span>
           <span class="base">
            <span class="strut" style="height: 2.3324em; vertical-align: -0.9721em;">
            </span>
            <span class="mord">
             <span class="mopen nulldelimiter">
             </span>
             <span class="mfrac">
              <span class="vlist-t vlist-t2">
               <span class="vlist-r">
                <span class="vlist" style="height: 1.3603em;">
                 <span class="" style="top: -2.314em;">
                  <span class="pstrut" style="height: 3em;">
                  </span>
                  <span class="mord">
                   <span class="mord">
                    <span class="mord mathnormal" style="margin-right: 0.0359em;">
                     Ïƒ
                    </span>
                    <span class="msupsub">
                     <span class="vlist-t vlist-t2">
                      <span class="vlist-r">
                       <span class="vlist" style="height: 0.1514em;">
                        <span class="" style="top: -2.55em; margin-left: -0.0359em; margin-right: 0.05em;">
                         <span class="pstrut" style="height: 2.7em;">
                         </span>
                         <span class="sizing reset-size6 size3 mtight">
                          <span class="mord mathnormal mtight">
                           p
                          </span>
                         </span>
                        </span>
                       </span>
                       <span class="vlist-s">
                        â€‹
                       </span>
                      </span>
                      <span class="vlist-r">
                       <span class="vlist" style="height: 0.2861em;">
                        <span class="">
                        </span>
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                 <span class="" style="top: -3.23em;">
                  <span class="pstrut" style="height: 3em;">
                  </span>
                  <span class="frac-line" style="border-bottom-width: 0.04em;">
                  </span>
                 </span>
                 <span class="" style="top: -3.677em;">
                  <span class="pstrut" style="height: 3em;">
                  </span>
                  <span class="mord">
                   <span class="mord">
                    <span class="mord mathnormal" style="margin-right: 0.0077em;">
                     R
                    </span>
                    <span class="msupsub">
                     <span class="vlist-t vlist-t2">
                      <span class="vlist-r">
                       <span class="vlist" style="height: 0.1514em;">
                        <span class="" style="top: -2.55em; margin-left: -0.0077em; margin-right: 0.05em;">
                         <span class="pstrut" style="height: 2.7em;">
                         </span>
                         <span class="sizing reset-size6 size3 mtight">
                          <span class="mord mathnormal mtight">
                           p
                          </span>
                         </span>
                        </span>
                       </span>
                       <span class="vlist-s">
                        â€‹
                       </span>
                      </span>
                      <span class="vlist-r">
                       <span class="vlist" style="height: 0.2861em;">
                        <span class="">
                        </span>
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                   <span class="mspace" style="margin-right: 0.2222em;">
                   </span>
                   <span class="mbin">
                    âˆ’
                   </span>
                   <span class="mspace" style="margin-right: 0.2222em;">
                   </span>
                   <span class="mord">
                    <span class="mord mathnormal" style="margin-right: 0.0077em;">
                     R
                    </span>
                    <span class="msupsub">
                     <span class="vlist-t vlist-t2">
                      <span class="vlist-r">
                       <span class="vlist" style="height: 0.3361em;">
                        <span class="" style="top: -2.55em; margin-left: -0.0077em; margin-right: 0.05em;">
                         <span class="pstrut" style="height: 2.7em;">
                         </span>
                         <span class="sizing reset-size6 size3 mtight">
                          <span class="mord mathnormal mtight" style="margin-right: 0.1076em;">
                           f
                          </span>
                         </span>
                        </span>
                       </span>
                       <span class="vlist-s">
                        â€‹
                       </span>
                      </span>
                      <span class="vlist-r">
                       <span class="vlist" style="height: 0.2861em;">
                        <span class="">
                        </span>
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
                <span class="vlist-s">
                 â€‹
                </span>
               </span>
               <span class="vlist-r">
                <span class="vlist" style="height: 0.9721em;">
                 <span class="">
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="mclose nulldelimiter">
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
       <br/>
       å…¶ä¸­ï¼Œ
       <span class="katex--inline">
        <span class="katex">
         <span class="katex-mathml">
          R 
           
          
            p 
           
          
         
        
          R_p
         </span>
         <span class="katex-html">
          <span class="base">
           <span class="strut" style="height: 0.9694em; vertical-align: -0.2861em;">
           </span>
           <span class="mord">
            <span class="mord mathnormal" style="margin-right: 0.0077em;">
             R
            </span>
            <span class="msupsub">
             <span class="vlist-t vlist-t2">
              <span class="vlist-r">
               <span class="vlist" style="height: 0.1514em;">
                <span class="" style="top: -2.55em; margin-left: -0.0077em; margin-right: 0.05em;">
                 <span class="pstrut" style="height: 2.7em;">
                 </span>
                 <span class="sizing reset-size6 size3 mtight">
                  <span class="mord mathnormal mtight">
                   p
                  </span>
                 </span>
                </span>
               </span>
               <span class="vlist-s">
                â€‹
               </span>
              </span>
              <span class="vlist-r">
               <span class="vlist" style="height: 0.2861em;">
                <span class="">
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
       æ˜¯ç­–ç•¥çš„é¢„æœŸæ”¶ç›Šç‡ï¼Œ
       <span class="katex--inline">
        <span class="katex">
         <span class="katex-mathml">
          R 
           
          
            f 
           
          
         
        
          R_f
         </span>
         <span class="katex-html">
          <span class="base">
           <span class="strut" style="height: 0.9694em; vertical-align: -0.2861em;">
           </span>
           <span class="mord">
            <span class="mord mathnormal" style="margin-right: 0.0077em;">
             R
            </span>
            <span class="msupsub">
             <span class="vlist-t vlist-t2">
              <span class="vlist-r">
               <span class="vlist" style="height: 0.3361em;">
                <span class="" style="top: -2.55em; margin-left: -0.0077em; margin-right: 0.05em;">
                 <span class="pstrut" style="height: 2.7em;">
                 </span>
                 <span class="sizing reset-size6 size3 mtight">
                  <span class="mord mathnormal mtight" style="margin-right: 0.1076em;">
                   f
                  </span>
                 </span>
                </span>
               </span>
               <span class="vlist-s">
                â€‹
               </span>
              </span>
              <span class="vlist-r">
               <span class="vlist" style="height: 0.2861em;">
                <span class="">
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
       æ˜¯æ— é£é™©åˆ©ç‡ï¼Œ
       <span class="katex--inline">
        <span class="katex">
         <span class="katex-mathml">
          Ïƒ 
           
          
            p 
           
          
         
        
          \sigma_p
         </span>
         <span class="katex-html">
          <span class="base">
           <span class="strut" style="height: 0.7167em; vertical-align: -0.2861em;">
           </span>
           <span class="mord">
            <span class="mord mathnormal" style="margin-right: 0.0359em;">
             Ïƒ
            </span>
            <span class="msupsub">
             <span class="vlist-t vlist-t2">
              <span class="vlist-r">
               <span class="vlist" style="height: 0.1514em;">
                <span class="" style="top: -2.55em; margin-left: -0.0359em; margin-right: 0.05em;">
                 <span class="pstrut" style="height: 2.7em;">
                 </span>
                 <span class="sizing reset-size6 size3 mtight">
                  <span class="mord mathnormal mtight">
                   p
                  </span>
                 </span>
                </span>
               </span>
               <span class="vlist-s">
                â€‹
               </span>
              </span>
              <span class="vlist-r">
               <span class="vlist" style="height: 0.2861em;">
                <span class="">
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
       æ˜¯ç­–ç•¥æ”¶ç›Šç‡çš„æ ‡å‡†å·®ã€‚è¾ƒé«˜çš„å¤æ™®æ¯”ç‡è¡¨ç¤ºç­–ç•¥åœ¨æ‰¿æ‹…ç›¸åŒé£é™©çš„æƒ…å†µä¸‹è·å¾—äº†æ›´é«˜çš„å›æŠ¥ã€‚
      </p>
     </li>
     <li>
      <p>
       <strong>
        ç´¯ç§¯æ”¶ç›Š
       </strong>
       ï¼šåæ˜ ç­–ç•¥çš„æ•´ä½“è¡¨ç°ã€‚é€šè¿‡è®¡ç®—ç­–ç•¥åœ¨æ¯ä¸ªæ—¶é—´ç‚¹çš„å‡€å€¼å˜åŒ–ï¼Œç»˜åˆ¶ç´¯ç§¯æ”¶ç›Šæ›²çº¿ã€‚å¹³æ»‘ä¸Šå‡çš„ç´¯ç§¯æ”¶ç›Šæ›²çº¿è¡¨ç¤ºç­–ç•¥è¡¨ç°è‰¯å¥½ï¼Œä¸”æ³¢åŠ¨è¾ƒå°ã€‚
      </p>
     </li>
     <li>
      <p>
       <strong>
        æ€»æ”¶ç›Š
       </strong>
       ï¼šåæ˜ ç­–ç•¥çš„æ€»ä½“ç›ˆåˆ©èƒ½åŠ›ï¼Œè®¡ç®—å…¬å¼ä¸ºï¼š
      </p>
      <p>
       <span class="katex--display">
        <span class="katex-display">
         <span class="katex">
          <span class="katex-mathml">
           æ€»æ”¶ç›Š 
           
          
            = 
           
           
            
            
              æœ€ç»ˆèµ„äº§ä»·å€¼ 
             
            
              âˆ’ 
             
            
              åˆå§‹èµ„äº§ä»·å€¼ 
             
            
           
             åˆå§‹èµ„äº§ä»·å€¼ 
            
           
          
            Ã— 
           
          
            100 
           
          
            % 
           
          
         
           \text{æ€»æ”¶ç›Š} = \frac{\text{æœ€ç»ˆèµ„äº§ä»·å€¼} - \text{åˆå§‹èµ„äº§ä»·å€¼}}{\text{åˆå§‹èµ„äº§ä»·å€¼}} \times 100\%
          </span>
          <span class="katex-html">
           <span class="base">
            <span class="strut" style="height: 0.6833em;">
            </span>
            <span class="mord text">
             <span class="mord cjk_fallback">
              æ€»æ”¶ç›Š
             </span>
            </span>
            <span class="mspace" style="margin-right: 0.2778em;">
            </span>
            <span class="mrel">
             =
            </span>
            <span class="mspace" style="margin-right: 0.2778em;">
            </span>
           </span>
           <span class="base">
            <span class="strut" style="height: 2.0463em; vertical-align: -0.686em;">
            </span>
            <span class="mord">
             <span class="mopen nulldelimiter">
             </span>
             <span class="mfrac">
              <span class="vlist-t vlist-t2">
               <span class="vlist-r">
                <span class="vlist" style="height: 1.3603em;">
                 <span class="" style="top: -2.314em;">
                  <span class="pstrut" style="height: 3em;">
                  </span>
                  <span class="mord">
                   <span class="mord text">
                    <span class="mord cjk_fallback">
                     åˆå§‹èµ„äº§ä»·å€¼
                    </span>
                   </span>
                  </span>
                 </span>
                 <span class="" style="top: -3.23em;">
                  <span class="pstrut" style="height: 3em;">
                  </span>
                  <span class="frac-line" style="border-bottom-width: 0.04em;">
                  </span>
                 </span>
                 <span class="" style="top: -3.677em;">
                  <span class="pstrut" style="height: 3em;">
                  </span>
                  <span class="mord">
                   <span class="mord text">
                    <span class="mord cjk_fallback">
                     æœ€ç»ˆèµ„äº§ä»·å€¼
                    </span>
                   </span>
                   <span class="mspace" style="margin-right: 0.2222em;">
                   </span>
                   <span class="mbin">
                    âˆ’
                   </span>
                   <span class="mspace" style="margin-right: 0.2222em;">
                   </span>
                   <span class="mord text">
                    <span class="mord cjk_fallback">
                     åˆå§‹èµ„äº§ä»·å€¼
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
                <span class="vlist-s">
                 â€‹
                </span>
               </span>
               <span class="vlist-r">
                <span class="vlist" style="height: 0.686em;">
                 <span class="">
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="mclose nulldelimiter">
             </span>
            </span>
            <span class="mspace" style="margin-right: 0.2222em;">
            </span>
            <span class="mbin">
             Ã—
            </span>
            <span class="mspace" style="margin-right: 0.2222em;">
            </span>
           </span>
           <span class="base">
            <span class="strut" style="height: 0.8056em; vertical-align: -0.0556em;">
            </span>
            <span class="mord">
             100%
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
       <br/>
       è¾ƒé«˜çš„æ€»æ”¶ç›Šè¡¨ç¤ºç­–ç•¥ç›ˆåˆ©èƒ½åŠ›å¼ºã€‚
      </p>
     </li>
     <li>
      <p>
       <strong>
        æœ€å¤§å›æ’¤ (MDD)
       </strong>
       ï¼šè¡¡é‡ç­–ç•¥åœ¨é€‰å®šå‘¨æœŸå†…å¯èƒ½å‡ºç°çš„æœ€å¤§æŸå¤±ã€‚è®¡ç®—å…¬å¼ä¸ºï¼š
      </p>
      <p>
       <span class="katex--display">
        <span class="katex-display">
         <span class="katex">
          <span class="katex-mathml">
           MDD 
           
          
            = 
           
          
            max 
           
          
            â¡ 
           
           
           
             ( 
            
            
             
             
               é«˜ç‚¹å‡€å€¼ 
              
             
               âˆ’ 
              
             
               ä½ç‚¹å‡€å€¼ 
              
             
            
              é«˜ç‚¹å‡€å€¼ 
             
            
           
             ) 
            
           
          
         
           \text{MDD} = \max\left(\frac{\text{é«˜ç‚¹å‡€å€¼} - \text{ä½ç‚¹å‡€å€¼}}{\text{é«˜ç‚¹å‡€å€¼}}\right)
          </span>
          <span class="katex-html">
           <span class="base">
            <span class="strut" style="height: 0.6833em;">
            </span>
            <span class="mord text">
             <span class="mord">
              MDD
             </span>
            </span>
            <span class="mspace" style="margin-right: 0.2778em;">
            </span>
            <span class="mrel">
             =
            </span>
            <span class="mspace" style="margin-right: 0.2778em;">
            </span>
           </span>
           <span class="base">
            <span class="strut" style="height: 2.4em; vertical-align: -0.95em;">
            </span>
            <span class="mop">
             max
            </span>
            <span class="mspace" style="margin-right: 0.1667em;">
            </span>
            <span class="minner">
             <span class="mopen delimcenter" style="top: 0em;">
              <span class="delimsizing size3">
               (
              </span>
             </span>
             <span class="mord">
              <span class="mopen nulldelimiter">
              </span>
              <span class="mfrac">
               <span class="vlist-t vlist-t2">
                <span class="vlist-r">
                 <span class="vlist" style="height: 1.3603em;">
                  <span class="" style="top: -2.314em;">
                   <span class="pstrut" style="height: 3em;">
                   </span>
                   <span class="mord">
                    <span class="mord text">
                     <span class="mord cjk_fallback">
                      é«˜ç‚¹å‡€å€¼
                     </span>
                    </span>
                   </span>
                  </span>
                  <span class="" style="top: -3.23em;">
                   <span class="pstrut" style="height: 3em;">
                   </span>
                   <span class="frac-line" style="border-bottom-width: 0.04em;">
                   </span>
                  </span>
                  <span class="" style="top: -3.677em;">
                   <span class="pstrut" style="height: 3em;">
                   </span>
                   <span class="mord">
                    <span class="mord text">
                     <span class="mord cjk_fallback">
                      é«˜ç‚¹å‡€å€¼
                     </span>
                    </span>
                    <span class="mspace" style="margin-right: 0.2222em;">
                    </span>
                    <span class="mbin">
                     âˆ’
                    </span>
                    <span class="mspace" style="margin-right: 0.2222em;">
                    </span>
                    <span class="mord text">
                     <span class="mord cjk_fallback">
                      ä½ç‚¹å‡€å€¼
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                 <span class="vlist-s">
                  â€‹
                 </span>
                </span>
                <span class="vlist-r">
                 <span class="vlist" style="height: 0.686em;">
                  <span class="">
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="mclose nulldelimiter">
              </span>
             </span>
             <span class="mclose delimcenter" style="top: 0em;">
              <span class="delimsizing size3">
               )
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
       <br/>
       è¾ƒä½çš„æœ€å¤§å›æ’¤è¡¨ç¤ºç­–ç•¥æŠ—é£é™©èƒ½åŠ›è¾ƒå¼ºã€‚
      </p>
     </li>
     <li>
      <p>
       <strong>
        å¡ç›æ¯”ç‡ (Calmar Ratio)
       </strong>
       ï¼šè¡¡é‡å•ä½æœ€å¤§å›æ’¤çš„å¤åˆå¹´åŒ–æ”¶ç›Šç‡ï¼Œè¶Šé«˜è¶Šå¥½ã€‚è®¡ç®—å…¬å¼ä¸ºï¼š
      </p>
      <p>
       <span class="katex--display">
        <span class="katex-display">
         <span class="katex">
          <span class="katex-mathml">
           å¡ç›æ¯”ç‡ 
           
          
            = 
           
           
           
             å¤åˆå¹´åŒ–æ”¶ç›Šç‡ 
            
           
             æœ€å¤§å›æ’¤ 
            
           
          
         
           \text{å¡ç›æ¯”ç‡} = \frac{\text{å¤åˆå¹´åŒ–æ”¶ç›Šç‡}}{\text{æœ€å¤§å›æ’¤}}
          </span>
          <span class="katex-html">
           <span class="base">
            <span class="strut" style="height: 0.6833em;">
            </span>
            <span class="mord text">
             <span class="mord cjk_fallback">
              å¡ç›æ¯”ç‡
             </span>
            </span>
            <span class="mspace" style="margin-right: 0.2778em;">
            </span>
            <span class="mrel">
             =
            </span>
            <span class="mspace" style="margin-right: 0.2778em;">
            </span>
           </span>
           <span class="base">
            <span class="strut" style="height: 2.0463em; vertical-align: -0.686em;">
            </span>
            <span class="mord">
             <span class="mopen nulldelimiter">
             </span>
             <span class="mfrac">
              <span class="vlist-t vlist-t2">
               <span class="vlist-r">
                <span class="vlist" style="height: 1.3603em;">
                 <span class="" style="top: -2.314em;">
                  <span class="pstrut" style="height: 3em;">
                  </span>
                  <span class="mord">
                   <span class="mord text">
                    <span class="mord cjk_fallback">
                     æœ€å¤§å›æ’¤
                    </span>
                   </span>
                  </span>
                 </span>
                 <span class="" style="top: -3.23em;">
                  <span class="pstrut" style="height: 3em;">
                  </span>
                  <span class="frac-line" style="border-bottom-width: 0.04em;">
                  </span>
                 </span>
                 <span class="" style="top: -3.677em;">
                  <span class="pstrut" style="height: 3em;">
                  </span>
                  <span class="mord">
                   <span class="mord text">
                    <span class="mord cjk_fallback">
                     å¤åˆå¹´åŒ–æ”¶ç›Šç‡
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
                <span class="vlist-s">
                 â€‹
                </span>
               </span>
               <span class="vlist-r">
                <span class="vlist" style="height: 0.686em;">
                 <span class="">
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="mclose nulldelimiter">
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </p>
     </li>
     <li>
      <p>
       <strong>
        èƒœç‡
       </strong>
       ï¼šè¡¡é‡ç­–ç•¥åœ¨äº¤æ˜“ä¸­ç›ˆåˆ©çš„é¢‘ç‡ï¼Œè®¡ç®—å…¬å¼ä¸ºï¼š
      </p>
      <p>
       <span class="katex--display">
        <span class="katex-display">
         <span class="katex">
          <span class="katex-mathml">
           èƒœç‡ 
           
          
            = 
           
           
           
             ç›ˆåˆ©äº¤æ˜“æ¬¡æ•° 
            
           
             æ€»äº¤æ˜“æ¬¡æ•° 
            
           
          
            Ã— 
           
          
            100 
           
          
            % 
           
          
         
           \text{èƒœç‡} = \frac{\text{ç›ˆåˆ©äº¤æ˜“æ¬¡æ•°}}{\text{æ€»äº¤æ˜“æ¬¡æ•°}} \times 100\%
          </span>
          <span class="katex-html">
           <span class="base">
            <span class="strut" style="height: 0.6833em;">
            </span>
            <span class="mord text">
             <span class="mord cjk_fallback">
              èƒœç‡
             </span>
            </span>
            <span class="mspace" style="margin-right: 0.2778em;">
            </span>
            <span class="mrel">
             =
            </span>
            <span class="mspace" style="margin-right: 0.2778em;">
            </span>
           </span>
           <span class="base">
            <span class="strut" style="height: 2.0463em; vertical-align: -0.686em;">
            </span>
            <span class="mord">
             <span class="mopen nulldelimiter">
             </span>
             <span class="mfrac">
              <span class="vlist-t vlist-t2">
               <span class="vlist-r">
                <span class="vlist" style="height: 1.3603em;">
                 <span class="" style="top: -2.314em;">
                  <span class="pstrut" style="height: 3em;">
                  </span>
                  <span class="mord">
                   <span class="mord text">
                    <span class="mord cjk_fallback">
                     æ€»äº¤æ˜“æ¬¡æ•°
                    </span>
                   </span>
                  </span>
                 </span>
                 <span class="" style="top: -3.23em;">
                  <span class="pstrut" style="height: 3em;">
                  </span>
                  <span class="frac-line" style="border-bottom-width: 0.04em;">
                  </span>
                 </span>
                 <span class="" style="top: -3.677em;">
                  <span class="pstrut" style="height: 3em;">
                  </span>
                  <span class="mord">
                   <span class="mord text">
                    <span class="mord cjk_fallback">
                     ç›ˆåˆ©äº¤æ˜“æ¬¡æ•°
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
                <span class="vlist-s">
                 â€‹
                </span>
               </span>
               <span class="vlist-r">
                <span class="vlist" style="height: 0.686em;">
                 <span class="">
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="mclose nulldelimiter">
             </span>
            </span>
            <span class="mspace" style="margin-right: 0.2222em;">
            </span>
            <span class="mbin">
             Ã—
            </span>
            <span class="mspace" style="margin-right: 0.2222em;">
            </span>
           </span>
           <span class="base">
            <span class="strut" style="height: 0.8056em; vertical-align: -0.0556em;">
            </span>
            <span class="mord">
             100%
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
       <br/>
       è¾ƒé«˜çš„èƒœç‡è¡¨ç¤ºç­–ç•¥åœ¨å¤šæ•°äº¤æ˜“ä¸­èƒ½å¤Ÿè·åˆ©ã€‚
      </p>
     </li>
    </ul>
    <h4>
     <a id="53__668">
     </a>
     5.3 å¦‚ä½•åˆ¤æ–­æ˜¯å¦è¾¾åˆ°äº†é¢„æœŸ
    </h4>
    <ul>
     <li>
      <strong>
       MSE å’Œ MAE
      </strong>
      ï¼šå¦‚æœè¿™ä¸¤ä¸ªæŒ‡æ ‡ä½äºé¢„æœŸé˜ˆå€¼ï¼ˆå¦‚ MSE &lt; 0.05ï¼ŒMAE &lt; 0.1ï¼‰ï¼Œåˆ™è®¤ä¸ºæ¨¡å‹é¢„æµ‹å‡†ç¡®ã€‚
     </li>
     <li>
      <strong>
       RÂ² åˆ†æ•°
      </strong>
      ï¼šå¦‚æœ RÂ² åˆ†æ•°é«˜äºé¢„æœŸé˜ˆå€¼ï¼ˆå¦‚ 0.8 æˆ–æ›´é«˜ï¼‰ï¼Œåˆ™è®¤ä¸ºæ¨¡å‹è§£é‡Šèƒ½åŠ›å¼ºã€‚
     </li>
     <li>
      <strong>
       å¤æ™®æ¯”ç‡
      </strong>
      ï¼šå¦‚æœå¤æ™®æ¯”ç‡é«˜äºé¢„æœŸé˜ˆå€¼ï¼ˆå¦‚ 1.0 æˆ–æ›´é«˜ï¼‰ï¼Œåˆ™è®¤ä¸ºç­–ç•¥åœ¨æ‰¿æ‹…ç›¸åŒé£é™©çš„æƒ…å†µä¸‹è·å¾—äº†æ›´é«˜çš„å›æŠ¥ã€‚
     </li>
     <li>
      <strong>
       ç´¯ç§¯æ”¶ç›Š
      </strong>
      ï¼šå¦‚æœç´¯ç§¯æ”¶ç›Šæ›²çº¿å¹³æ»‘ä¸Šå‡ä¸”æ²¡æœ‰å¤§å¹…æ³¢åŠ¨ï¼Œåˆ™è®¤ä¸ºç­–ç•¥è¡¨ç°ç¨³å®šã€‚
     </li>
     <li>
      <strong>
       æ€»æ”¶ç›Š
      </strong>
      ï¼šå¦‚æœæ€»æ”¶ç›Šé«˜äºé¢„æœŸé˜ˆå€¼ï¼ˆå¦‚ 10% æˆ–æ›´é«˜ï¼‰ï¼Œåˆ™è®¤ä¸ºç­–ç•¥ç›ˆåˆ©èƒ½åŠ›å¼ºã€‚
     </li>
     <li>
      <strong>
       æœ€å¤§å›æ’¤
      </strong>
      ï¼šå¦‚æœæœ€å¤§å›æ’¤ä½äºé¢„æœŸé˜ˆå€¼ï¼ˆå¦‚ 10% æˆ–æ›´ä½ï¼‰ï¼Œåˆ™è®¤ä¸ºç­–ç•¥æŠ—é£é™©èƒ½åŠ›è¾ƒå¼ºã€‚
     </li>
     <li>
      <strong>
       å¡ç›æ¯”ç‡
      </strong>
      ï¼šå¦‚æœå¡ç›æ¯”ç‡é«˜äºé¢„æœŸé˜ˆå€¼ï¼ˆå¦‚ 1.0 æˆ–æ›´é«˜ï¼‰ï¼Œåˆ™è®¤ä¸ºç­–ç•¥åœ¨æ§åˆ¶å›æ’¤æ–¹é¢è¡¨ç°è‰¯å¥½ã€‚
     </li>
     <li>
      <strong>
       èƒœç‡
      </strong>
      ï¼šå¦‚æœèƒœç‡é«˜äºé¢„æœŸé˜ˆå€¼ï¼ˆå¦‚ 50% æˆ–æ›´é«˜ï¼‰ï¼Œåˆ™è®¤ä¸ºç­–ç•¥åœ¨å¤šæ•°äº¤æ˜“ä¸­èƒ½å¤Ÿè·åˆ©ã€‚
     </li>
    </ul>
    <blockquote>
     <p>
      <strong>
       é£é™©æç¤ºä¸å…è´£å£°æ˜
      </strong>
      <br/>
      æœ¬æ–‡å†…å®¹åŸºäºå…¬å¼€ä¿¡æ¯ç ”ç©¶æ•´ç†ï¼Œä¸æ„æˆä»»ä½•å½¢å¼çš„æŠ•èµ„å»ºè®®ã€‚å†å²è¡¨ç°ä¸åº”ä½œä¸ºæœªæ¥æ”¶ç›Šä¿è¯ï¼Œå¸‚åœºå­˜åœ¨ä¸å¯é¢„è§çš„æ³¢åŠ¨é£é™©ã€‚æŠ•èµ„è€…éœ€ç»“åˆè‡ªèº«è´¢åŠ¡çŠ¶å†µåŠé£é™©æ‰¿å—èƒ½åŠ›ç‹¬ç«‹å†³ç­–ï¼Œå¹¶è‡ªè¡Œæ‰¿æ‹…äº¤æ˜“ç»“æœã€‚ä½œè€…åŠå‘å¸ƒæ–¹ä¸å¯¹ä»»ä½•ä¾æ®æœ¬æ–‡æ“ä½œå¯¼è‡´çš„æŸå¤±æ‰¿æ‹…æ³•å¾‹è´£ä»»ã€‚å¸‚åœºæœ‰é£é™©ï¼ŒæŠ•èµ„é¡»è°¨æ…ã€‚
     </p>
    </blockquote>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f672e:6373646e2e6e65742f77656978696e5f34373333393931362f:61727469636c652f64657461696c732f313436333030373831" class_="artid" style="display:none">
 </p>
</div>


