---
layout: post
title: "iOS插件,Theos环境搭建与XM文件开发指南完善版本"
date: 2025-03-09 00:04:23 +0800
description: "Theos是一个跨平台的iOS越狱开发工具链，它简化了越狱插件（Tweaks）的开发过程。Theos提供了一套完整的工具，使开发者能够轻松地创建、编译和部署越狱插件，而无需使用Xcode或其他复杂的IDE。Logos是一种预处理器语法，专为iOS越狱开发设计，它大大简化了方法钩子的编写。XM文件中的Logos代码会被预处理器转换为标准的Objective-C代码。"
keywords: "iOS插件，Theos环境搭建与XM文件开发指南（完善版本）"
categories: ['未分类']
tags: ['Ios']
artid: "146125486"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146125486
    alt: "iOS插件,Theos环境搭建与XM文件开发指南完善版本"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146125486
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146125486
cover: https://bing.ee123.net/img/rand?artid=146125486
image: https://bing.ee123.net/img/rand?artid=146125486
img: https://bing.ee123.net/img/rand?artid=146125486
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     iOS插件，Theos环境搭建与XM文件开发指南（完善版本）
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h2>
     <a id="TheosXM_1">
     </a>
     Theos环境搭建与XM文件开发指南
    </h2>
    <p>
    </p>
    <p>
    </p>
    <h3>
     <a id="Theos_5">
     </a>
     什么是Theos？
    </h3>
    <p>
     Theos是一个跨平台的iOS越狱开发工具链，它简化了越狱插件（Tweaks）的开发过程。Theos提供了一套完整的工具，使开发者能够轻松地创建、编译和部署越狱插件，而无需使用Xcode或其他复杂的IDE。
    </p>
    <h4>
     <a id="Theos_9">
     </a>
     Theos的主要特点
    </h4>
    <ul>
     <li>
      <strong>
       跨平台支持
      </strong>
      ：可在macOS、Linux、Windows（通过WSL）上运行
     </li>
     <li>
      <strong>
       简单易用
      </strong>
      ：提供简洁的命令行工具
     </li>
     <li>
      <strong>
       模块化设计
      </strong>
      ：支持多种项目类型（插件、应用程序等）
     </li>
     <li>
      <strong>
       远程部署
      </strong>
      ：可直接将编译好的插件部署到越狱设备上
     </li>
     <li>
     </li>
    </ul>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/9cc74b5e215b41d6a0160d6d4d585fc3.jpeg"/>
    </p>
    <h3>
     <a id="Theos_19">
     </a>
     Theos环境搭建
    </h3>
    <h4>
     <a id="macOSTheos_21">
     </a>
     在macOS上安装Theos
    </h4>
    <ol>
     <li>
      <strong>
       安装依赖
      </strong>
     </li>
    </ol>
    <pre><code class="prism language-bash">brew <span class="token function">install</span> ldid xz
</code></pre>
    <ol start="2">
     <li>
      <strong>
       克隆Theos仓库
      </strong>
     </li>
    </ol>
    <pre><code class="prism language-bash"><span class="token function">mkdir</span> <span class="token parameter variable">-p</span> ~/theos
<span class="token function">git</span> clone <span class="token parameter variable">--recursive</span> https://github.com/theos/theos.git ~/theos
</code></pre>
    <ol start="3">
     <li>
      <strong>
       设置环境变量
      </strong>
     </li>
    </ol>
    <p>
     将以下内容添加到
     <code>
      ~/.bash_profile
     </code>
     或
     <code>
      ~/.zshrc
     </code>
     文件中：
    </p>
    <pre><code class="prism language-bash"><span class="token builtin class-name">export</span> <span class="token assign-left variable">THEOS</span><span class="token operator">=~</span>/theos
<span class="token builtin class-name">export</span> <span class="token assign-left variable"><span class="token environment constant">PATH</span></span><span class="token operator">=</span><span class="token variable">$THEOS</span>/bin:<span class="token environment constant">$PATH</span>
</code></pre>
    <p>
     然后执行：
    </p>
    <pre><code class="prism language-bash"><span class="token builtin class-name">source</span> ~/.bash_profile  <span class="token comment"># 或 source ~/.zshrc</span>
</code></pre>
    <h4>
     <a id="WindowsTheos_WSL_51">
     </a>
     在Windows上安装Theos (通过WSL)
    </h4>
    <ol>
     <li>
      <strong>
       安装WSL
      </strong>
     </li>
    </ol>
    <p>
     按照Microsoft官方指南安装WSL2和Ubuntu发行版。
    </p>
    <ol start="2">
     <li>
      <strong>
       在WSL中安装依赖
      </strong>
     </li>
    </ol>
    <pre><code class="prism language-bash"><span class="token function">sudo</span> <span class="token function">apt</span> update
<span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> <span class="token function">git</span> build-essential fakeroot
<span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> clang libclang-dev libxml2-dev libssl-dev
</code></pre>
    <ol start="3">
     <li>
      <strong>
       克隆Theos仓库
      </strong>
     </li>
    </ol>
    <pre><code class="prism language-bash"><span class="token function">mkdir</span> <span class="token parameter variable">-p</span> ~/theos
<span class="token function">git</span> clone <span class="token parameter variable">--recursive</span> https://github.com/theos/theos.git ~/theos
</code></pre>
    <ol start="4">
     <li>
      <strong>
       设置环境变量
      </strong>
     </li>
    </ol>
    <pre><code class="prism language-bash"><span class="token builtin class-name">echo</span> <span class="token string">"export THEOS=~/theos"</span> <span class="token operator">&gt;&gt;</span> ~/.bashrc
<span class="token builtin class-name">echo</span> <span class="token string">"export PATH=<span class="token variable">$THEOS</span>/bin:<span class="token environment constant">$PATH</span>"</span> <span class="token operator">&gt;&gt;</span> ~/.bashrc
<span class="token builtin class-name">source</span> ~/.bashrc
</code></pre>
    <h3>
     <a id="XM_80">
     </a>
     XM文件详解
    </h3>
    <p>
     XM文件是Theos开发中最核心的文件类型，它使用Logos语法来简化Objective-C的方法钩子（Method Hooking）过程。
    </p>
    <h4>
     <a id="Logos_84">
     </a>
     什么是Logos语法？
    </h4>
    <p>
     Logos是一种预处理器语法，专为iOS越狱开发设计，它大大简化了方法钩子的编写。XM文件中的Logos代码会被预处理器转换为标准的Objective-C代码。
    </p>
    <h4>
     <a id="XM_88">
     </a>
     XM文件基本结构
    </h4>
    <p>
     一个典型的XM文件结构如下：
    </p>
    <pre><code class="prism language-objc"><span class="token comment">// 导入必要的头文件</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">import</span> <span class="token expression"><span class="token operator">&lt;</span>UIKit<span class="token operator">/</span>UIKit<span class="token punctuation">.</span>h<span class="token operator">&gt;</span></span></span>

<span class="token comment">// 声明要钩子的类</span>
<span class="token operator">%</span>hook ClassName

<span class="token comment">// 重写方法</span>
<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>methodName <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 在原方法执行前添加代码</span>
    
    <span class="token comment">// 调用原方法</span>
    <span class="token operator">%</span>orig<span class="token punctuation">;</span>
    
    <span class="token comment">// 在原方法执行后添加代码</span>
<span class="token punctuation">}</span>

<span class="token comment">// 重写另一个方法并修改返回值</span>
<span class="token operator">-</span> <span class="token punctuation">(</span>BOOL<span class="token punctuation">)</span>anotherMethod<span class="token punctuation">:</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>arg <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 完全替换原方法，不调用原实现</span>
    <span class="token keyword">return</span> YES<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 重写方法并修改参数</span>
<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>methodWithArgs<span class="token punctuation">:</span><span class="token punctuation">(</span>NSString <span class="token operator">*</span><span class="token punctuation">)</span>arg <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 使用修改后的参数调用原方法</span>
    <span class="token operator">%</span><span class="token function">orig</span><span class="token punctuation">(</span><span class="token string">@"修改后的参数"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token operator">%</span>end

<span class="token comment">// 可以钩子多个类</span>
<span class="token operator">%</span>hook AnotherClass
<span class="token comment">// ...</span>
<span class="token operator">%</span>end

<span class="token comment">// 初始化代码</span>
<span class="token operator">%</span>ctor <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 这里的代码会在插件加载时执行</span>
    <span class="token function">NSLog</span><span class="token punctuation">(</span><span class="token string">@"插件已加载"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 清理代码</span>
<span class="token operator">%</span>dtor <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 这里的代码会在插件卸载时执行</span>
<span class="token punctuation">}</span>
</code></pre>
    <h4>
     <a id="XM_140">
     </a>
     XM文件打包配置
    </h4>
    <p>
     在Theos开发中，XM文件需要与几个关键文件配合才能成功编译和打包成可安装的插件。以下是这些必要的文件：
    </p>
    <h5>
     <a id="1__144">
     </a>
     1. 核心文件组成
    </h5>
    <h6>
     <a id="TweakxmTweakx__146">
     </a>
     Tweak.xm/Tweak.x 文件
    </h6>
    <p>
     这是插件的核心代码文件，包含使用Logos语法编写的钩子代码。这个文件定义了您要修改的类和方法。
    </p>
    <h6>
     <a id="Makefile_150">
     </a>
     Makefile
    </h6>
    <p>
     Makefile是编译配置文件，指定了项目的编译规则和参数。一个基本的Makefile通常包含：
    </p>
    <pre><code class="prism language-makefile">INSTALL_TARGET_PROCESSES = SpringBoard
ARCHS = arm64 arm64e

include $(THEOS)/makefiles/common.mk

TWEAK_NAME = 您的插件名称
您的插件名称_FILES = Tweak.xm
您的插件名称_CFLAGS = -fobjc-arc

include $(THEOS_MAKE_PATH)/tweak.mk
</code></pre>
    <h6>
     <a id="control__167">
     </a>
     control 文件
    </h6>
    <p>
     这是Debian包信息文件，包含插件的元数据，如名称、版本、描述等：
    </p>
    <pre><code>Package: com.yourname.tweakname
Name: 插件显示名称
Version: 0.0.1
Architecture: iphoneos-arm
Description: 插件描述
Maintainer: 您的名字
Author: 您的名字
Section: Tweaks
Depends: mobilesubstrate (&gt;= 0.9.5000)
</code></pre>
    <h6>
     <a id="Tweakplist_183">
     </a>
     Tweak.plist
    </h6>
    <p>
     这个文件指定了插件要钩子的应用和进程，告诉系统在哪些应用中加载您的插件：
    </p>
    <pre><code class="prism language-xml">{ 
  Filter = { 
    Bundles = ( 
      "目标应用的Bundle ID" 
    ); 
  }; 
}
</code></pre>
    <h5>
     <a id="2__197">
     </a>
     2. 可选但常用的文件
    </h5>
    <h6>
     <a id="_Resources__199">
     </a>
     资源文件 (Resources 目录)
    </h6>
    <p>
     如果您的插件需要图片、声音或其他资源，可以放在Resources目录中：
    </p>
    <pre><code>YourTweak/
├── Resources/
│   ├── icon.png
│   └── Settings.plist
</code></pre>
    <h6>
     <a id="_210">
     </a>
     偏好设置文件
    </h6>
    <p>
     如果您的插件需要设置界面，通常需要以下文件：
    </p>
    <ul>
     <li>
      <strong>
       XXXRootListController.h/m
      </strong>
      ：设置控制器头文件和实现
     </li>
     <li>
      <strong>
       XXXPreferences.plist
      </strong>
      ：设置项定义
     </li>
     <li>
      <strong>
       entry.plist
      </strong>
      ：设置入口定义
     </li>
    </ul>
    <h6>
     <a id="_layout__218">
     </a>
     布局文件 (layout 目录)
    </h6>
    <p>
     如果您需要在特定位置安装额外的文件，可以使用layout目录：
    </p>
    <pre><code>YourTweak/
├── layout/
│   ├── Library/
│   │   └── Application Support/
│   │       └── YourTweak/
│   │           └── data.plist
</code></pre>
    <h5>
     <a id="3__231">
     </a>
     3. 完整项目结构示例
    </h5>
    <p>
     一个完整的Theos项目目录结构通常如下：
    </p>
    <pre><code>YourTweak/
├── Makefile
├── Tweak.xm
├── Tweak.plist
├── control
├── Resources/
│   └── ...
└── layout/
    └── ...
</code></pre>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/0c0a574820b8473d986af3a9441edfb3.png"/>
    </p>
    <h5>
     <a id="4__248">
     </a>
     4. 打包过程
    </h5>
    <p>
     完整的打包过程需要这些文件协同工作：
    </p>
    <ol>
     <li>
      <strong>
       编译阶段
      </strong>
      ：Makefile指导编译器处理Tweak.xm文件
     </li>
     <li>
      <strong>
       打包阶段
      </strong>
      ：使用control文件创建Debian包
     </li>
     <li>
      <strong>
       安装阶段
      </strong>
      ：根据Tweak.plist确定插件加载位置
     </li>
    </ol>
    <h5>
     <a id="5__256">
     </a>
     5. 注意事项
    </h5>
    <ol>
     <li>
      <strong>
       文件名大小写敏感
      </strong>
      ：确保文件名大小写正确
     </li>
     <li>
      <strong>
       路径问题
      </strong>
      ：确保所有引用的路径正确
     </li>
     <li>
      <strong>
       依赖关系
      </strong>
      ：在control文件中正确声明依赖
     </li>
     <li>
      <strong>
       权限设置
      </strong>
      ：确保生成的文件有正确的权限
     </li>
    </ol>
    <h4>
     <a id="Logos_263">
     </a>
     Logos指令详解
    </h4>
    <ol>
     <li>
      <strong>
       %hook
      </strong>
      ：指定要钩子的类
     </li>
     <li>
      <strong>
       %end
      </strong>
      ：结束当前钩子
     </li>
     <li>
      <strong>
       %orig
      </strong>
      ：调用原始方法
     </li>
     <li>
      <strong>
       %ctor
      </strong>
      ：构造函数，插件加载时执行
     </li>
     <li>
      <strong>
       %dtor
      </strong>
      ：析构函数，插件卸载时执行
     </li>
     <li>
      <strong>
       %new
      </strong>
      ：为类添加新方法
     </li>
     <li>
      <strong>
       %group
      </strong>
      ：定义一个钩子组
     </li>
     <li>
      <strong>
       %init
      </strong>
      ：初始化钩子组
     </li>
     <li>
      <strong>
       %subclass
      </strong>
      ：创建一个新的子类
     </li>
    </ol>
    <h4>
     <a id="XM_275">
     </a>
     XM文件实战示例
    </h4>
    <p>
     下面是一个简单的示例，展示如何创建一个修改iOS计算器应用的插件：
    </p>
    <pre><code class="prism language-objc"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">import</span> <span class="token expression"><span class="token operator">&lt;</span>UIKit<span class="token operator">/</span>UIKit<span class="token punctuation">.</span>h<span class="token operator">&gt;</span></span></span>

<span class="token operator">%</span>hook CalculatorViewController

<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>viewDidLoad <span class="token punctuation">{<!-- --></span>
    <span class="token operator">%</span>orig<span class="token punctuation">;</span> <span class="token comment">// 调用原始方法</span>
    
    <span class="token comment">// 修改标题</span>
    <span class="token keyword">self</span><span class="token punctuation">.</span>title <span class="token operator">=</span> <span class="token string">@"增强版计算器"</span><span class="token punctuation">;</span>
    
    <span class="token comment">// 添加自定义UI元素</span>
    UIButton <span class="token operator">*</span>customButton <span class="token operator">=</span> <span class="token punctuation">[</span>UIButton buttonWithType<span class="token punctuation">:</span>UIButtonTypeSystem<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">[</span>customButton setTitle<span class="token punctuation">:</span><span class="token string">@"特殊功能"</span> forState<span class="token punctuation">:</span>UIControlStateNormal<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">[</span>customButton addTarget<span class="token punctuation">:</span><span class="token keyword">self</span> action<span class="token punctuation">:</span><span class="token keyword">@selector</span><span class="token punctuation">(</span>customFunction<span class="token punctuation">)</span> forControlEvents<span class="token punctuation">:</span>UIControlEventTouchUpInside<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">[</span><span class="token keyword">self</span><span class="token punctuation">.</span>view addSubview<span class="token punctuation">:</span>customButton<span class="token punctuation">]</span><span class="token punctuation">;</span>
    
    <span class="token comment">// 设置按钮位置</span>
    customButton<span class="token punctuation">.</span>frame <span class="token operator">=</span> <span class="token function">CGRectMake</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 添加新方法</span>
<span class="token operator">%</span>new
<span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>customFunction <span class="token punctuation">{<!-- --></span>
    UIAlertController <span class="token operator">*</span>alert <span class="token operator">=</span> <span class="token punctuation">[</span>UIAlertController alertControllerWithTitle<span class="token punctuation">:</span><span class="token string">@"提示"</span>
                                                                   message<span class="token punctuation">:</span><span class="token string">@"这是一个自定义功能"</span>
                                                            preferredStyle<span class="token punctuation">:</span>UIAlertControllerStyleAlert<span class="token punctuation">]</span><span class="token punctuation">;</span>
    
    <span class="token punctuation">[</span>alert addAction<span class="token punctuation">:</span><span class="token punctuation">[</span>UIAlertAction actionWithTitle<span class="token punctuation">:</span><span class="token string">@"确定"</span> style<span class="token punctuation">:</span>UIAlertActionStyleDefault handler<span class="token punctuation">:</span>nil<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">[</span><span class="token keyword">self</span> presentViewController<span class="token punctuation">:</span>alert animated<span class="token punctuation">:</span>YES completion<span class="token punctuation">:</span>nil<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token operator">%</span>end

<span class="token operator">%</span>ctor <span class="token punctuation">{<!-- --></span>
    <span class="token function">NSLog</span><span class="token punctuation">(</span><span class="token string">@"计算器增强插件已加载"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <h3>
     <a id="Theos_318">
     </a>
     Theos项目创建与编译
    </h3>
    <h4>
     <a id="_320">
     </a>
     创建新项目
    </h4>
    <p>
     使用
     <code>
      nic.pl
     </code>
     命令创建新项目：
    </p>
    <pre><code class="prism language-bash"><span class="token variable">$THEOS</span>/bin/nic.pl
</code></pre>
    <p>
     按照提示选择项目类型（通常选择"tweak"），并填写项目名称、包标识符等信息。
    </p>
    <h4>
     <a id="_330">
     </a>
     项目文件结构
    </h4>
    <p>
     一个典型的Theos项目包含以下文件：
    </p>
    <ul>
     <li>
      <strong>
       Tweak.x/Tweak.xm
      </strong>
      ：主要的钩子代码文件
     </li>
     <li>
      <strong>
       Makefile
      </strong>
      ：编译配置文件
     </li>
     <li>
      <strong>
       control
      </strong>
      ：Debian包信息文件
     </li>
     <li>
      <strong>
       Tweak.plist
      </strong>
      ：指定要钩子的应用和进程
     </li>
    </ul>
    <h4>
     <a id="_339">
     </a>
     编译项目
    </h4>
    <p>
     在项目目录下执行：
    </p>
    <pre><code class="prism language-bash"><span class="token function">make</span>
</code></pre>
    <h4>
     <a id="_347">
     </a>
     安装到设备
    </h4>
    <p>
     确保设备已越狱并安装了OpenSSH，然后执行：
    </p>
    <pre><code class="prism language-bash"><span class="token function">make</span> package <span class="token function">install</span>
</code></pre>
    <h3>
     <a id="_355">
     </a>
     调试技巧
    </h3>
    <ol>
     <li>
      <strong>
       使用NSLog
      </strong>
      ：在XM文件中添加NSLog语句输出调试信息
     </li>
     <li>
      <strong>
       查看设备日志
      </strong>
      ：使用工具如iConsole或通过SSH连接设备查看系统日志
     </li>
     <li>
      <strong>
       使用FLEX
      </strong>
      ：集成FLEX框架进行运行时UI检查
     </li>
     <li>
      <strong>
       断点调试
      </strong>
      ：结合Frida等工具进行高级调试
     </li>
    </ol>
    <h3>
     <a id="_362">
     </a>
     常见问题与解决方案
    </h3>
    <ol>
     <li>
      <strong>
       编译错误
      </strong>
      ：检查语法、确保导入了正确的头文件
     </li>
     <li>
      <strong>
       插件不加载
      </strong>
      ：检查Tweak.plist中的Bundle ID是否正确
     </li>
     <li>
      <strong>
       找不到类或方法
      </strong>
      ：使用class-dump工具导出应用的头文件
     </li>
     <li>
      <strong>
       插件崩溃
      </strong>
      ：添加异常处理，避免直接修改关键方法
     </li>
    </ol>
    <h3>
     <a id="_369">
     </a>
     学习资源
    </h3>
    <ul>
     <li>
      <a href="https://theos.dev/" rel="nofollow">
       Theos官方文档
      </a>
     </li>
     <li>
      <a href="https://theos.dev/docs/logos-syntax" rel="nofollow">
       Logos语法参考
      </a>
     </li>
     <li>
      <a href="https://iphonedevwiki.net/" rel="nofollow">
       iOS越狱开发论坛
      </a>
     </li>
     <li>
      <a href="https://github.com/topics/ios-tweak">
       GitHub上的开源Tweak项目
      </a>
     </li>
     <li>
      源码地址：
      <br/>
      https://pan.baidu.com/s/1hnLbs16NmOAFugN1bFdU5Q
      <br/>
      提取码: 6666
     </li>
    </ul>
    <h3>
     <a id="Theos_379">
     </a>
     在越狱设备上安装Theos
    </h3>
    <p>
     除了在电脑上安装Theos外，您也可以直接在越狱的iOS设备上安装和使用Theos，这样可以直接在设备上开发和测试插件，非常方便。
    </p>
    <h4>
     <a id="_383">
     </a>
     前提条件
    </h4>
    <ol>
     <li>
      <strong>
       已越狱的iOS设备
      </strong>
     </li>
     <li>
      <strong>
       必要的软件包
      </strong>
      ：
      <ul>
       <li>
        OpenSSH (用于远程连接)
       </li>
       <li>
        Terminal应用 (如NewTerm或MTerminal)
       </li>
       <li>
        包管理器 (如Cydia、Sileo或Zebra)
       </li>
      </ul>
     </li>
    </ol>
    <h4>
     <a id="_391">
     </a>
     安装步骤
    </h4>
    <h5>
     <a id="1__393">
     </a>
     1. 安装必要的依赖
    </h5>
    <p>
     在Cydia/Sileo/Zebra中搜索并安装以下软件包：
    </p>
    <ul>
     <li>
      <strong>
       Darwin CC Tools
      </strong>
      (提供编译工具)
     </li>
     <li>
      <strong>
       LLVM+Clang
      </strong>
      (编译器)
     </li>
     <li>
      <strong>
       ldid
      </strong>
      (用于签名)
     </li>
     <li>
      <strong>
       Make
      </strong>
      (构建工具)
     </li>
     <li>
      <strong>
       Git
      </strong>
      (版本控制)
     </li>
     <li>
      <strong>
       Perl
      </strong>
      (Theos脚本需要)
     </li>
     <li>
      <strong>
       coreutils
      </strong>
      (核心工具)
     </li>
    </ul>
    <h5>
     <a id="2__404">
     </a>
     2. 打开终端应用
    </h5>
    <p>
     启动NewTerm或MTerminal应用。
    </p>
    <h5>
     <a id="3_Theos_408">
     </a>
     3. 创建Theos目录并克隆仓库
    </h5>
    <pre><code class="prism language-bash"><span class="token function">mkdir</span> <span class="token parameter variable">-p</span> /var/theos
<span class="token builtin class-name">cd</span> /var
<span class="token function">git</span> clone <span class="token parameter variable">--recursive</span> https://github.com/theos/theos.git
</code></pre>
    <h5>
     <a id="4__416">
     </a>
     4. 设置环境变量
    </h5>
    <p>
     编辑
     <code>
      .profile
     </code>
     文件：
    </p>
    <pre><code class="prism language-bash"><span class="token builtin class-name">echo</span> <span class="token string">'export THEOS=/var/theos'</span> <span class="token operator">&gt;&gt;</span> ~/.profile
<span class="token builtin class-name">echo</span> <span class="token string">'export PATH=$THEOS/bin:$PATH'</span> <span class="token operator">&gt;&gt;</span> ~/.profile
<span class="token builtin class-name">source</span> ~/.profile
</code></pre>
    <h5>
     <a id="5_SDK_426">
     </a>
     5. 设置SDK
    </h5>
    <p>
     Theos需要iOS SDK才能正常工作。在设备上，您可以使用设备自带的SDK：
    </p>
    <pre><code class="prism language-bash"><span class="token function">mkdir</span> <span class="token parameter variable">-p</span> <span class="token variable">$THEOS</span>/sdks
<span class="token function">ln</span> <span class="token parameter variable">-s</span> /usr/lib/sdk <span class="token variable">$THEOS</span>/sdks/iPhoneOS.sdk
</code></pre>
    <h5>
     <a id="6__435">
     </a>
     6. 验证安装
    </h5>
    <pre><code class="prism language-bash"><span class="token variable">$THEOS</span>/bin/nic.pl
</code></pre>
    <p>
     如果显示项目模板列表，则表示安装成功。
    </p>
    <h4>
     <a id="_443">
     </a>
     在设备上创建和编译项目
    </h4>
    <h5>
     <a id="_445">
     </a>
     创建新项目
    </h5>
    <pre><code class="prism language-bash"><span class="token builtin class-name">cd</span> /var/mobile/Documents  <span class="token comment"># 或其他您有写入权限的目录</span>
<span class="token variable">$THEOS</span>/bin/nic.pl
</code></pre>
    <p>
     按照提示选择项目类型并填写信息。
    </p>
    <h5>
     <a id="_454">
     </a>
     编译项目
    </h5>
    <pre><code class="prism language-bash"><span class="token builtin class-name">cd</span> 您的项目目录
<span class="token function">make</span>
</code></pre>
    <h5>
     <a id="_461">
     </a>
     安装到设备
    </h5>
    <p>
     由于您已经在设备上，可以直接安装：
    </p>
    <pre><code class="prism language-bash"><span class="token function">make</span> package <span class="token function">install</span>
``<span class="token variable"><span class="token variable">`</span><span class="token operator">!</span><span class="token punctuation">[</span>在这里插入图片描述<span class="token punctuation">]</span><span class="token punctuation">(</span>https://i-blog.csdnimg.cn/direct/4d4c711dc2e2409cb8faa78aa698d08f.png<span class="token punctuation">)</span>


<span class="token comment">### 注意事项</span>

<span class="token number">1</span>. **存储空间**：确保设备有足够的存储空间，Theos及其依赖可能占用数百MB。
<span class="token number">2</span>. **性能限制**：在设备上编译可能比在电脑上慢得多，特别是复杂项目。
<span class="token number">3</span>. **权限问题**：某些目录可能需要root权限，使用<span class="token variable">`</span></span>su`命令切换到root用户。
<span class="token number">4</span>. **电池消耗**：在设备上编译会消耗大量电池电量，建议连接电源。
<span class="token number">5</span>. **备选方案**：如果设备性能有限，考虑在电脑上安装Theos，然后通过SSH部署到设备。



<span class="token comment">## 结语</span>

Theos和XM文件为iOS越狱开发提供了强大而灵活的工具。通过本指南，您应该已经了解了基本的环境搭建和开发流程。随着经验的积累，您将能够开发出更加复杂和实用的越狱插件。

希望本指南对您有所帮助
</code></pre>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f71715f34333132393837382f:61727469636c652f64657461696c732f313436313235343836" class_="artid" style="display:none">
 </p>
</div>


