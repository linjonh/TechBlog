---
layout: post
title: "CPE命名规范"
date: 2023-03-04 21:16:51 +0800
description: "参考链接：通用平台枚举 （CPE） |Nmap 网络扫描简介通用平台枚举 （CPE） 是命名软件应用"
keywords: "cpe字段"
categories: ['网络安全']
tags: ['网络安全']
artid: "123829611"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=123829611
    alt: "CPE命名规范"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=123829611
featuredImagePreview: https://bing.ee123.net/img/rand?artid=123829611
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     CPE命名规范
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="./../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="./../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-dracula" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
     参考链接：
     <a href="https://nmap.org/book/output-formats-cpe.html" rel="nofollow">
      通用平台枚举 （CPE） |Nmap 网络扫描
     </a>
    </p>
    <h4>
     <a id="_2">
     </a>
     简介
    </h4>
    <p>
     <a href="http://cpe.mitre.org/" rel="nofollow">
      通用平台枚举
     </a>
     （CPE） 是命名软件应用程序、操作系统和硬件平台的标准化方法，是NMAP对识别出来的软件、操作系统和硬件的一种命名方式。
    </p>
    <h4>
     <a id="CPE__6">
     </a>
     CPE 名称结构
    </h4>
    <p>
     CPE 名称是对七个有序字段进行编码的 URL：
    </p>
    <p>
     <code>
      cpe:/&lt;part&gt;:&lt;vendor&gt;:&lt;product&gt;:&lt;version&gt;:&lt;update&gt;:&lt;edition&gt;:&lt;language&gt;
     </code>
    </p>
    <p>
     七个字段不一定都有，一般至少会写到
     <code>
      product
     </code>
     。
    </p>
    <h5>
     <a id="_14">
     </a>
     参数详解
    </h5>
    <table>
     <thead>
      <tr>
       <th align="center">
        参数字段
       </th>
       <th align="left">
        含义
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td align="center">
        &lt;part&gt;
       </td>
       <td align="left">
        a:对于应用
        <br/>
        h:对于硬件平台
        <br/>
        o:对于操作系统
       </td>
      </tr>
      <tr>
       <td align="center">
        &lt;vendor&gt;
       </td>
       <td align="left">
        厂商
       </td>
      </tr>
      <tr>
       <td align="center">
        &lt;product&gt;
       </td>
       <td align="left">
        产品名称
       </td>
      </tr>
      <tr>
       <td align="center">
        &lt;version&gt;
       </td>
       <td align="left">
        版本号
       </td>
      </tr>
      <tr>
       <td align="center">
        &lt;update&gt;
       </td>
       <td align="left">
        更新包
       </td>
      </tr>
      <tr>
       <td align="center">
        &lt;edition&gt;
       </td>
       <td align="left">
        版本
       </td>
      </tr>
      <tr>
       <td align="center">
        &lt;language&gt;
       </td>
       <td align="left">
        语言
       </td>
      </tr>
     </tbody>
    </table>
    <h5>
     <a id="_26">
     </a>
     举例说明
    </h5>
    <p>
     ​见到的场景很多，对于威胁情报：
     <code>
      Storm Cloud 组织使用新变体攻击 MacOS
     </code>
     ，恶意软件 GIMMICK 通过木马后门攻击了 macos，攻击目标记为
     <code>
      cpe:/o:apple:macos:
     </code>
     。
     <code>
      part
     </code>
     为
     <code>
      o
     </code>
     ，表示操作系统；
     <code>
      vendor
     </code>
     是
     <code>
      apple
     </code>
     公司；
     <code>
      product
     </code>
     是
     <code>
      macos
     </code>
     。
    </p>
    <p>
     代码是提取几个字段用的，方便自己做实验。按需观看。
    </p>
    <pre><code class="prism language-python"><span class="token keyword">import</span> re

<span class="token builtin">str</span> <span class="token operator">=</span> <span class="token string">'cpe:/o:apple:macos:'</span>
match_obj <span class="token operator">=</span> re<span class="token punctuation">.</span>search<span class="token punctuation">(</span><span class="token string">r'((?&lt;=cpe:/).):(.*?):(.*?):$'</span><span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">,</span> re<span class="token punctuation">.</span>M <span class="token operator">|</span> re<span class="token punctuation">.</span>I<span class="token punctuation">)</span>

part <span class="token operator">=</span> match_obj<span class="token punctuation">.</span>group<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
vendor <span class="token operator">=</span> match_obj<span class="token punctuation">.</span>group<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
product <span class="token operator">=</span> match_obj<span class="token punctuation">.</span>group<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> part <span class="token operator">==</span> <span class="token string">'a'</span><span class="token punctuation">:</span>
    str1 <span class="token operator">=</span> <span class="token string">'应用'</span>
<span class="token keyword">elif</span> part <span class="token operator">==</span> <span class="token string">'h'</span><span class="token punctuation">:</span>
    str1 <span class="token operator">=</span> <span class="token string">'硬件平台'</span>
<span class="token keyword">elif</span> part <span class="token operator">==</span> <span class="token string">'o'</span><span class="token punctuation">:</span>
    str1 <span class="token operator">=</span> <span class="token string">'操作系统'</span>
<span class="token keyword">else</span><span class="token punctuation">:</span>
    <span class="token keyword">pass</span>
str_aptAim <span class="token operator">=</span> <span class="token string">'攻击目标为'</span> <span class="token operator">+</span> vendor <span class="token operator">+</span> <span class="token string">'公司的'</span> <span class="token operator">+</span> product <span class="token operator">+</span> str1
</code></pre>
   </div>
   <link href="./../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="./../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="6874747073:3a2f2f626c6f672e6373646e2e6e65742f67777275696b692f:61727469636c652f64657461696c732f313233383239363131" class_="artid" style="display:none">
 </p>
</div>


