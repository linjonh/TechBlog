---
layout: post
title: "ExcelVBA江西省预算一体化工资表一键处理"
date: 2025-03-08 16:16:32 +0800
description: "一键处理预算一体化导出的工资表，调整格式、统计数据"
keywords: "Excel·VBA江西省预算一体化工资表一键处理"
categories: ['Vba', 'Office', 'Excel']
tags: ['Vba', 'Excel']
artid: "146117277"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146117277
    alt: "ExcelVBA江西省预算一体化工资表一键处理"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146117277
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146117277
cover: https://bing.ee123.net/img/rand?artid=146117277
image: https://bing.ee123.net/img/rand?artid=146117277
img: https://bing.ee123.net/img/rand?artid=146117277
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     Excel·VBA江西省预算一体化工资表一键处理
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atelier-sulphurpool-light" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
     每月制作工资表导出为Excel后都需要调整格式，删除0数据的列、对工资表项目进行排序、打印设置等等，有些单位还分有“行政”、“事业”2个工资表就需要操作2次。显然，这种重复操作的问题，可以使用VBA代码解决
    </p>
    <p>
    </p>
    <p>
    </p>
    <h3>
     <a id="_3">
     </a>
     代码使用说明
    </h3>
    <ul>
     <li>
      <font color="red" size="4">
       代码作用范围
      </font>
      ：以下代码作用于活动工作簿/工作表，无需将待处理的工资表保存在启用宏的工作簿中（xlsm格式），只要待处理的工资表处于活动状态即可运行代码。同时，也不建议把数据保存在xlsm文件中，vba代码运行结果是无法撤销的
      <br/>
      <code>
       活动工作簿
      </code>
      ：如果打开多个工作簿，显示在最前面的就是活动工作簿
      <br/>
      <code>
       活动工作表
      </code>
      ：活动工作簿当前显示的工作表
     </li>
    </ul>
    <h3>
     <a id="1_8">
     </a>
     1，工资表格式处理
    </h3>
    <h4>
     <a id="_9">
     </a>
     涉及功能
    </h4>
    <ul>
     <li>
      <font color="red" size="4">
       数据调整
      </font>
      ：工资表各项目按指定顺序排序，添加合计数行，删除合计数为0的列，删除无意义项目列（应发合计、扣款合计），添加工资表所属月份，添加个税所属月份，添加制表人及时间
      <br/>
      参数
      <code>
       bt
      </code>
      可指定工资表各项目的顺序，如果工资表中存在某项不在参数
      <code>
       bt
      </code>
      内，且合计数不为0的，则该列排序在最后一列
     </li>
     <li>
      <font color="red" size="4">
       格式设置
      </font>
      ：行高、自适应列宽、文字居中、自动换行、隐藏指定列、所有框线
      <br/>
      存在部分列设置自适应列宽，但效果不佳的，可以在代码运行后手工调整
     </li>
     <li>
      <font color="red" size="4">
       打印设置
      </font>
      ：横向打印、页边距、打印标题、打印页脚、冻结表格
     </li>
    </ul>
    <pre><code class="prism language-vbnet"><span class="token keyword">Sub</span> 工资表格式处理<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment">'将每月2张工资表放在同一工作簿中，分别命名“行政、事业”，运行本代码</span>
    <span class="token keyword">Dim</span> title_row<span class="token punctuation">,</span> title_h<span class="token punctuation">,</span> row_h<span class="token punctuation">,</span> bt<span class="token punctuation">,</span> brr<span class="token punctuation">,</span> ws<span class="token punctuation">,</span> start_col<span class="token operator">&amp;</span><span class="token punctuation">,</span> b<span class="token punctuation">,</span> i<span class="token operator">&amp;</span><span class="token punctuation">,</span> j<span class="token operator">&amp;</span><span class="token punctuation">,</span> gs<span class="token operator">&amp;</span>
    title_row <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">:</span> title_h <span class="token operator">=</span> <span class="token number">13.2</span><span class="token punctuation">:</span> row_h <span class="token operator">=</span> <span class="token number">24</span>  <span class="token comment">'表头行数，前2行行高，其他行高</span>
    zbr_name <span class="token operator">=</span> <span class="token string">"制表人：薛定谔  "</span> <span class="token operator">&amp;</span> Format<span class="token punctuation">(</span><span class="token keyword">Date</span><span class="token punctuation">,</span> <span class="token string">"yyyy.mm.dd"</span><span class="token punctuation">)</span>
    bt <span class="token operator">=</span> <span class="token string">"职务工资,级别工资,岗位工资,薪级（技术）工资,教师（10%）,"</span> _
    <span class="token operator">&amp;</span> <span class="token string">"绩效奖金,生活补助,工作津贴,岗位津贴,降温取暖费,公车改革补贴,"</span> _
    <span class="token operator">&amp;</span> <span class="token string">"补发工资（停发）,应发工资,养老保险,职业年金,医疗保险,失业保险,"</span> _
    <span class="token operator">&amp;</span> <span class="token string">"住房公积金,代扣个税,单位代扣小计,代扣其它,实发合计"</span>  <span class="token comment">'表头及顺序</span>
    brr <span class="token operator">=</span> Split<span class="token punctuation">(</span>bt<span class="token punctuation">,</span> <span class="token string">","</span><span class="token punctuation">)</span>
    <span class="token keyword">For Each</span> ws <span class="token keyword">In</span> ActiveWorkbook.Worksheets
        <span class="token keyword">With</span> ws
            <span class="token comment">'格式设置：行高、居中、自动换行、合并单元格、隐藏D-E列</span>
            .Rows.RowHeight <span class="token operator">=</span> row_h<span class="token punctuation">:</span> .Rows<span class="token punctuation">(</span><span class="token string">"1:2"</span><span class="token punctuation">)</span>.RowHeight <span class="token operator">=</span> title_h
            .Rows<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>.RowHeight <span class="token operator">=</span> <span class="token number">25.2</span>    <span class="token comment">'第3行行高</span>
            .Cells.HorizontalAlignment <span class="token operator">=</span> xlCenter  <span class="token comment">'全表居中</span>
            .Cells.VerticalAlignment <span class="token operator">=</span> xlCenter
            .Rows<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>.WrapText <span class="token operator">=</span> <span class="token keyword">True</span>     <span class="token comment">'第3行自动换行</span>
            .Columns<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>.WrapText <span class="token operator">=</span> <span class="token keyword">True</span>  <span class="token comment">'第2列自动换行，单位名称</span>
            .Cells<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>.UnMerge    <span class="token comment">'取消合并单元格，方便调整列排序</span>
            .Columns<span class="token punctuation">(</span><span class="token string">"d:e"</span><span class="token punctuation">)</span>.Hidden <span class="token operator">=</span> <span class="token keyword">True</span>
            <span class="token comment">'添加合计行，删除合计数为零的列，删除“应发合计,扣款合计”列</span>
            hb_row <span class="token operator">=</span> .UsedRange.Rows.count <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">:</span> .Cells<span class="token punctuation">(</span>hb_row<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token string">"合计"</span>
            <span class="token keyword">For</span> j <span class="token operator">=</span> <span class="token number">6</span> <span class="token keyword">To</span> .UsedRange.Columns.count
                .Cells<span class="token punctuation">(</span>hb_row<span class="token punctuation">,</span> j<span class="token punctuation">)</span>.FormulaR1C1 <span class="token operator">=</span> <span class="token string">"=SUM(R["</span> <span class="token operator">&amp;</span> <span class="token number">4</span> <span class="token operator">-</span> hb_row <span class="token operator">&amp;</span> <span class="token string">"]C[0]:R[-1]C[0])"</span>
            <span class="token keyword">Next</span>
            <span class="token keyword">For</span> j <span class="token operator">=</span> .UsedRange.Columns.count <span class="token keyword">To</span> <span class="token number">6</span> <span class="token keyword">Step</span> <span class="token operator">-</span><span class="token number">1</span>
                <span class="token keyword">If</span> .Cells<span class="token punctuation">(</span>hb_row<span class="token punctuation">,</span> j<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span> <span class="token keyword">Or</span> .Cells<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> j<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token string">"应发合计"</span> _
                <span class="token keyword">Or</span> .Cells<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> j<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token string">"扣款合计"</span> <span class="token keyword">Then</span> .Columns<span class="token punctuation">(</span>j<span class="token punctuation">)</span>.<span class="token function">Delete</span>
            <span class="token keyword">Next</span>
            <span class="token comment">'调整列排序，剪切列、插入列</span>
            start_col <span class="token operator">=</span> <span class="token number">6</span>  <span class="token comment">'开始列号</span>
            <span class="token keyword">For Each</span> b <span class="token keyword">In</span> brr
                <span class="token keyword">For</span> j <span class="token operator">=</span> <span class="token number">6</span> <span class="token keyword">To</span> .UsedRange.Columns.count
                    <span class="token keyword">If</span> .Cells<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> j<span class="token punctuation">)</span> <span class="token operator">=</span> b <span class="token keyword">Then</span>
                        <span class="token keyword">If</span> j <span class="token operator">&lt;&gt;</span> start_col <span class="token keyword">Then</span>
                            .Columns<span class="token punctuation">(</span>j<span class="token punctuation">)</span>.Cut
                            .Columns<span class="token punctuation">(</span>start_col<span class="token punctuation">)</span>.Insert
                        <span class="token keyword">End</span> <span class="token keyword">If</span>
                        start_col <span class="token operator">=</span> start_col <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">:</span> <span class="token keyword">Exit</span> <span class="token keyword">For</span>  <span class="token comment">'递增、跳出</span>
                    <span class="token keyword">End</span> <span class="token keyword">If</span>
                <span class="token keyword">Next</span>
            <span class="token keyword">Next</span>
            <span class="token keyword">If</span> Month<span class="token punctuation">(</span><span class="token keyword">Date</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">Then</span> gs <span class="token operator">=</span> <span class="token number">12</span> <span class="token keyword">Else</span> gs <span class="token operator">=</span> Month<span class="token punctuation">(</span><span class="token keyword">Date</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span>  <span class="token comment">'个税所属月份</span>
            <span class="token keyword">For</span> j <span class="token operator">=</span> .UsedRange.Columns.count <span class="token keyword">To</span> <span class="token number">6</span> <span class="token keyword">Step</span> <span class="token operator">-</span><span class="token number">1</span>
                <span class="token keyword">If</span> .Cells<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> j<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token string">"代扣个税"</span> <span class="token keyword">Then</span> .Cells<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> j<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token string">"代扣"</span> <span class="token operator">&amp;</span> gs <span class="token operator">&amp;</span> <span class="token string">"月个税"</span><span class="token punctuation">:</span> <span class="token keyword">Exit</span> <span class="token keyword">For</span>
            <span class="token keyword">Next</span>
            <span class="token comment">'增加第1列序号列，表头合并单元格，所有框线，列宽自适应</span>
            .Columns<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>.Insert<span class="token punctuation">:</span> .Cells<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token string">"序号"</span>
            <span class="token keyword">For</span> i <span class="token operator">=</span> <span class="token number">4</span> <span class="token keyword">To</span> .UsedRange.Rows.count <span class="token operator">-</span> <span class="token number">1</span>
                .Cells<span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> i <span class="token operator">-</span> <span class="token number">3</span>
            <span class="token keyword">Next</span>
            .Cells<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">=</span> Replace<span class="token punctuation">(</span>.Cells<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>.Value<span class="token punctuation">,</span> <span class="token string">"局"</span><span class="token punctuation">,</span> <span class="token string">"局"</span> <span class="token operator">&amp;</span> Month<span class="token punctuation">(</span><span class="token keyword">Date</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token string">"月"</span><span class="token punctuation">)</span>
            .Cells<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>.Resize<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> .UsedRange.Columns.count<span class="token punctuation">)</span>.Merge
            .UsedRange.Borders.LineStyle <span class="token operator">=</span> xlContinuous
            Range<span class="token punctuation">(</span>.Columns<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">,</span> .Columns<span class="token punctuation">(</span>.UsedRange.Columns.count<span class="token punctuation">)</span><span class="token punctuation">)</span>.ColumnWidth <span class="token operator">=</span> <span class="token number">4</span>
            Range<span class="token punctuation">(</span>.Columns<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">,</span> .Columns<span class="token punctuation">(</span>.UsedRange.Columns.count<span class="token punctuation">)</span><span class="token punctuation">)</span>.AutoFit
            Range<span class="token punctuation">(</span>.Columns<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> .Columns<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>.AutoFit<span class="token punctuation">:</span> .Columns<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>.AutoFit
            .Cells<span class="token punctuation">(</span>.UsedRange.Rows.count <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> .UsedRange.Columns.count <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">=</span> zbr_name
            <span class="token comment">'设置工作表横向打印、页边距、打印标题、打印页脚、冻结表格</span>
            <span class="token keyword">With</span> .PageSetup
                .Orientation <span class="token operator">=</span> xlLandscape  <span class="token comment">'横向打印</span>
                .PrintTitleRows <span class="token operator">=</span> <span class="token string">"$1:$3"</span>   <span class="token comment">'打印标题</span>
                .TopMargin <span class="token operator">=</span> Application.InchesToPoints<span class="token punctuation">(</span><span class="token number">0.787</span><span class="token punctuation">)</span>     <span class="token comment">'上边距2厘米</span>
                .BottomMargin <span class="token operator">=</span> Application.InchesToPoints<span class="token punctuation">(</span><span class="token number">0.787</span><span class="token punctuation">)</span>  <span class="token comment">'下边距2厘米</span>
                .CenterFooter <span class="token operator">=</span> <span class="token string">"第 &amp;P 页，共 &amp;N 页"</span>  <span class="token comment">'打印页脚</span>
            <span class="token keyword">End</span> <span class="token keyword">With</span>
        <span class="token keyword">End</span> <span class="token keyword">With</span>
    <span class="token keyword">Next</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre>
    <h4>
     <a id="_88">
     </a>
     举例
    </h4>
    <p>
     系统导出工资表，保存至同一个工作簿的不同工作表（部分截图）
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/eac4c4a8c413458e91b61261c384ba05.jpeg#pic_center">
      <br/>
      <a id="page_jump">
      </a>
      代码处理后工资表
      <br/>
      <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/01f13e4561af4bc99c40cd11de405aac.jpeg#pic_center">
       <br/>
       <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/2a26865a8e734b258570ee3f78b6d156.jpeg#pic_center"/>
      </img>
     </img>
    </p>
    <h3>
     <a id="2_95">
     </a>
     2，工资表数据统计
    </h3>
    <p>
     为便于账务处理以及数据核对，对以上经过代码处理的工资表进行数据统计
     <br/>
     工资收入部分分别计入：基本工资、津贴补贴、绩效奖金
    </p>
    <pre><code class="prism language-vbnet"><span class="token keyword">Sub</span> 工资表数据统计<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment">'仅适用于统计经过以上代码处理的工资表</span>
    <span class="token keyword">Dim</span> dict1 <span class="token keyword">As</span> <span class="token keyword">Object</span><span class="token punctuation">,</span> dict2 <span class="token keyword">As</span> <span class="token keyword">Object</span><span class="token punctuation">,</span> jb$<span class="token punctuation">,</span> jbt$<span class="token punctuation">,</span> arr<span class="token punctuation">,</span> brr<span class="token punctuation">,</span> ws<span class="token punctuation">,</span> res<span class="token punctuation">,</span> i<span class="token operator">&amp;</span><span class="token punctuation">,</span> j<span class="token operator">&amp;</span><span class="token punctuation">,</span> gzxm$
    jb <span class="token operator">=</span> <span class="token string">"职务工资,级别工资,岗位工资,薪级（技术）工资,教师（10%）"</span>  <span class="token comment">'基本工资</span>
    jbt <span class="token operator">=</span> <span class="token string">"生活补助,工作津贴,岗位津贴,降温取暖费,公车改革补贴"</span>      <span class="token comment">'津贴补贴</span>
    title_row <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">:</span> start_col <span class="token operator">=</span> <span class="token number">7</span>  <span class="token comment">'表头行号，开始列号</span>
    <span class="token keyword">Set</span> dict1 <span class="token operator">=</span> CreateObject<span class="token punctuation">(</span><span class="token string">"scripting.dictionary"</span><span class="token punctuation">)</span>
    brr <span class="token operator">=</span> Split<span class="token punctuation">(</span>jb<span class="token punctuation">,</span> <span class="token string">","</span><span class="token punctuation">)</span>
    <span class="token keyword">For Each</span> b <span class="token keyword">In</span> brr
        dict1<span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token string">"基本工资"</span>
    <span class="token keyword">Next</span>
    brr <span class="token operator">=</span> Split<span class="token punctuation">(</span>jbt<span class="token punctuation">,</span> <span class="token string">","</span><span class="token punctuation">)</span>
    <span class="token keyword">For Each</span> b <span class="token keyword">In</span> brr
        dict1<span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token string">"津贴补贴"</span>
    <span class="token keyword">Next</span>
    <span class="token keyword">Set</span> dict2 <span class="token operator">=</span> CreateObject<span class="token punctuation">(</span><span class="token string">"scripting.dictionary"</span><span class="token punctuation">)</span>
    <span class="token keyword">Set</span> dict2<span class="token punctuation">(</span><span class="token string">"基本工资"</span><span class="token punctuation">)</span> <span class="token operator">=</span> CreateObject<span class="token punctuation">(</span><span class="token string">"scripting.dictionary"</span><span class="token punctuation">)</span>  <span class="token comment">'字典嵌套</span>
    <span class="token keyword">Set</span> dict2<span class="token punctuation">(</span><span class="token string">"津贴补贴"</span><span class="token punctuation">)</span> <span class="token operator">=</span> CreateObject<span class="token punctuation">(</span><span class="token string">"scripting.dictionary"</span><span class="token punctuation">)</span>
    <span class="token keyword">For Each</span> ws <span class="token keyword">In</span> ActiveWorkbook.Worksheets
        arr <span class="token operator">=</span> ws.UsedRange.Value<span class="token punctuation">:</span> ws_name <span class="token operator">=</span> ws.<span class="token keyword">Name</span><span class="token punctuation">:</span> s <span class="token operator">=</span> s <span class="token operator">+</span> <span class="token string">","</span> <span class="token operator">+</span> ws_name
        total_row <span class="token operator">=</span> ws.UsedRange.Rows.count <span class="token operator">-</span> <span class="token number">1</span>  <span class="token comment">'合计行号</span>
        <span class="token keyword">For</span> j <span class="token operator">=</span> start_col <span class="token keyword">To</span> <span class="token function">UBound</span><span class="token punctuation">(</span>arr<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
            gzxm <span class="token operator">=</span> arr<span class="token punctuation">(</span>title_row<span class="token punctuation">,</span> j<span class="token punctuation">)</span>  <span class="token comment">'工资项目</span>
            <span class="token keyword">If</span> <span class="token keyword">Not</span> dict1.Exists<span class="token punctuation">(</span>gzxm<span class="token punctuation">)</span> <span class="token keyword">And</span> <span class="token keyword">Not</span> dict2.Exists<span class="token punctuation">(</span>gzxm<span class="token punctuation">)</span> <span class="token keyword">Then</span>  <span class="token comment">'不属于基本工资、津贴补贴</span>
                <span class="token keyword">Set</span> dict2<span class="token punctuation">(</span>gzxm<span class="token punctuation">)</span> <span class="token operator">=</span> CreateObject<span class="token punctuation">(</span><span class="token string">"scripting.dictionary"</span><span class="token punctuation">)</span>
            <span class="token keyword">ElseIf</span> dict1.Exists<span class="token punctuation">(</span>gzxm<span class="token punctuation">)</span> <span class="token keyword">Then</span>
                gzxm <span class="token operator">=</span> dict1<span class="token punctuation">(</span>gzxm<span class="token punctuation">)</span>    <span class="token comment">'属于基本工资、津贴补贴，则转换</span>
            <span class="token keyword">End</span> <span class="token keyword">If</span>
            dict2<span class="token punctuation">(</span>gzxm<span class="token punctuation">)</span><span class="token punctuation">(</span>ws_name<span class="token punctuation">)</span> <span class="token operator">=</span> dict2<span class="token punctuation">(</span>gzxm<span class="token punctuation">)</span><span class="token punctuation">(</span>ws_name<span class="token punctuation">)</span> <span class="token operator">+</span> arr<span class="token punctuation">(</span>total_row<span class="token punctuation">,</span> j<span class="token punctuation">)</span>
        <span class="token keyword">Next</span>
    <span class="token keyword">Next</span>
    k2 <span class="token operator">=</span> dict2.keys<span class="token punctuation">:</span> brr <span class="token operator">=</span> Split<span class="token punctuation">(</span>s<span class="token punctuation">,</span> <span class="token string">","</span><span class="token punctuation">)</span>  <span class="token comment">'字典dict2所有键转为数组，拆分字符串s</span>
    <span class="token keyword">ReDim</span> res<span class="token punctuation">(</span><span class="token number">1</span> <span class="token keyword">To</span> dict2.count <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token keyword">To</span> <span class="token function">UBound</span><span class="token punctuation">(</span>brr<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span>  <span class="token comment">'统计结果数组</span>
    <span class="token comment">'横纵条件赋值到数组</span>
    <span class="token keyword">For</span> i <span class="token operator">=</span> <span class="token number">2</span> <span class="token keyword">To</span> <span class="token function">UBound</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>  <span class="token comment">'纵向</span>
        res<span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> k2<span class="token punctuation">(</span>i <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">)</span>
    <span class="token keyword">Next</span>
    <span class="token keyword">For</span> j <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">To</span> <span class="token function">UBound</span><span class="token punctuation">(</span>brr<span class="token punctuation">)</span>  <span class="token comment">'横向</span>
        res<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> j <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> brr<span class="token punctuation">(</span>j<span class="token punctuation">)</span>
    <span class="token keyword">Next</span>
    res<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token function">UBound</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token string">"合计"</span>
    <span class="token comment">'数组结果赋值到res数组</span>
    <span class="token keyword">For</span> i <span class="token operator">=</span> <span class="token number">2</span> <span class="token keyword">To</span> <span class="token function">UBound</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>  <span class="token comment">'纵向</span>
        <span class="token keyword">For</span> j <span class="token operator">=</span> <span class="token number">2</span> <span class="token keyword">To</span> <span class="token function">UBound</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span>  <span class="token comment">'横向</span>
            <span class="token keyword">If</span> dict2<span class="token punctuation">(</span>res<span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>.Exists<span class="token punctuation">(</span>res<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> j<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">Then</span>
                res<span class="token punctuation">(</span>i<span class="token punctuation">,</span> j<span class="token punctuation">)</span> <span class="token operator">=</span> dict2<span class="token punctuation">(</span>res<span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">(</span>res<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> j<span class="token punctuation">)</span><span class="token punctuation">)</span>
                res<span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token function">UBound</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=</span> res<span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token function">UBound</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> res<span class="token punctuation">(</span>i<span class="token punctuation">,</span> j<span class="token punctuation">)</span>
            <span class="token keyword">End</span> <span class="token keyword">If</span>
        <span class="token keyword">Next</span>
    <span class="token keyword">Next</span>
    Worksheets.Add<span class="token punctuation">(</span>After<span class="token punctuation">:</span><span class="token operator">=</span>Sheets<span class="token punctuation">(</span>Sheets.count<span class="token punctuation">)</span><span class="token punctuation">)</span>.<span class="token keyword">Name</span> <span class="token operator">=</span> <span class="token string">"统计"</span>  <span class="token comment">'添加工作表并命名</span>
    Worksheets<span class="token punctuation">(</span><span class="token string">"统计"</span><span class="token punctuation">)</span>.[a1].Resize<span class="token punctuation">(</span><span class="token function">UBound</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">UBound</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=</span> res
    <span class="token keyword">With</span> Worksheets<span class="token punctuation">(</span><span class="token string">"统计"</span><span class="token punctuation">)</span>  <span class="token comment">'格式设置</span>
        .Cells.Font.<span class="token keyword">Name</span> <span class="token operator">=</span> <span class="token string">"宋体"</span><span class="token punctuation">:</span> .Cells.Font.<span class="token function">Size</span> <span class="token operator">=</span> <span class="token number">12</span><span class="token punctuation">:</span> .Rows.RowHeight <span class="token operator">=</span> <span class="token number">20</span>
        .Cells.HorizontalAlignment <span class="token operator">=</span> xlCenter  <span class="token comment">'全表居中</span>
        .Cells.VerticalAlignment <span class="token operator">=</span> xlCenter
        Range<span class="token punctuation">(</span>.Columns<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> .Columns<span class="token punctuation">(</span>.UsedRange.Columns.count<span class="token punctuation">)</span><span class="token punctuation">)</span>.AutoFit
    <span class="token keyword">End</span> <span class="token keyword">With</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre>
    <h4>
     <a id="_159">
     </a>
     举例
    </h4>
    <p>
     对
     <a href="#page_jump" rel="nofollow">
      1-举例
     </a>
     处理结果进行统计：
     <br/>
     部分统计结果的顺序可能需要手工调整，如失业保险
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/19ece09e16b745f3b8f9f818e18b1027.jpeg#pic_center"/>
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a:2f2f626c6f672e6373646e2e6e65742f68686868685f35312f:61727469636c652f64657461696c732f313436313137323737" class_="artid" style="display:none">
 </p>
</div>


