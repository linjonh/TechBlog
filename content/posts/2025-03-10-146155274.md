---
arturl_encode: "68747470733a2f:2f626c6f672e6373646e2e6e65742f50485f6d6f646573742f:61727469636c652f64657461696c732f313436313535323734"
layout: post
title: "Linuxè·¬æ­¥ç§¯ç´¯-ç½‘ç»œç¼–ç¨‹å¥—æ¥å­—"
date: 2025-03-10 15:19:21 +08:00
description: "ä¸»è¦å†…å®¹ï¼šç†è§£IPåœ°å€å’ŒMACåœ°å€ã€è®¤è¯†TCPåè®®å’ŒUDPåè®®ã€socketç¼–ç¨‹æ¥å£ã€ç®€å•çš„UDPç½‘ç»œç¨‹åºã€ç®€å•çš„UDPå›å£°ç¨‹åº"
keywords: "ã€Linuxè·¬æ­¥ç§¯ç´¯ã€‘â€”â€” ç½‘ç»œç¼–ç¨‹å¥—æ¥å­—"
categories: ['Linux']
tags: ['è¿ç»´', 'ç½‘ç»œ', 'Linux']
artid: "146155274"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=146155274
    alt: "Linuxè·¬æ­¥ç§¯ç´¯-ç½‘ç»œç¼–ç¨‹å¥—æ¥å­—"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=146155274
featuredImagePreview: https://bing.ee123.net/img/rand?artid=146155274
cover: https://bing.ee123.net/img/rand?artid=146155274
image: https://bing.ee123.net/img/rand?artid=146155274
img: https://bing.ee123.net/img/rand?artid=146155274
---

# ã€Linuxè·¬æ­¥ç§¯ç´¯ã€‘â€”â€” ç½‘ç»œç¼–ç¨‹å¥—æ¥å­—

> ğŸŒåšå®¢ä¸»é¡µï¼š
> [**PH_modestçš„åšå®¢ä¸»é¡µ**](https://blog.csdn.net/PH_modest?spm=1011.2415.3001.5343)
>   
> ğŸš©å½“å‰ä¸“æ ï¼š
> [**Linuxè·¬æ­¥ç§¯ç´¯**](https://blog.csdn.net/ph_modest/category_12647071.html)
>   
> ğŸ’Œå…¶ä»–ä¸“æ ï¼š
>   
> ğŸ”´
> [**æ¯æ—¥ä¸€é¢˜**](https://blog.csdn.net/ph_modest/category_12161861.html?spm=1001.2014.3001.5482)
>   
> ğŸŸ¡
> [**C++è·¬æ­¥ç§¯ç´¯**](https://blog.csdn.net/ph_modest/category_12281260.html)
>   
> ğŸŸ¢
> [**Cè¯­è¨€è·¬æ­¥ç§¯ç´¯**](https://blog.csdn.net/ph_modest/category_11939180.html?spm=1001.2014.3001.5482)
>   
> ğŸŒˆåº§å³é“­ï¼š
> **å¹¿ç§¯ç²®ï¼Œç¼“ç§°ç‹ï¼**

---

## ä¸€ã€é¢„å¤‡çŸ¥è¯†

### ç†è§£æºIPåœ°å€å’Œç›®çš„IPåœ°å€

æ¯å°ä¸»æœºéƒ½æœ‰è‡ªå·±çš„IPåœ°å€ï¼Œå¦‚æœä¸€ä¸ªå°ä¸»æœºæƒ³è¦å¯¹å¦å¤–ä¸€å°ä¸»æœºå‘é€æ•°æ®ï¼Œé‚£ä¹ˆè¯¥ä¸»æœºå°±éœ€è¦çŸ¥é“å¯¹ç«¯ä¸»æœºçš„IPåœ°å€ï¼Œä¹Ÿå°±æ˜¯ç›®çš„IPåœ°å€ã€‚ä½†æ˜¯ä»…ä»…çŸ¥é“ç›®çš„IPåœ°å€æ˜¯ä¸å¤Ÿçš„ï¼Œå¯¹ç«¯ä¸»æœºæ”¶åˆ°æ•°æ®ä¹‹åï¼Œéœ€è¦å¯¹å…¶ä½œå‡ºå“åº”ï¼Œéœ€è¦çŸ¥é“æ˜¯è°ç»™ä»–å‘é€çš„æ•°æ®ï¼Œå› æ­¤æˆ‘ä»¬è¿˜éœ€è¦çŸ¥é“å‘é€æ–¹çš„IPåœ°å€ï¼Œä¹Ÿå°±æ˜¯æºIPåœ°å€ã€‚å› æ­¤ä¸€ä¸ªä¼ è¾“çš„æ•°æ®å½“ä¸­åº”è¯¥åŒ…å«æºIPåœ°å€å’Œç›®çš„IPåœ°å€ï¼ŒæºIPåœ°å€è¡¨ç¤ºæ˜¯è°å‘é€çš„æ•°æ®ï¼Œç›®çš„IPåœ°å€è¡¨ç¤ºå‘é€ç»™è°ã€‚

åœ¨æ•°æ®ä¼ è¾“ä¹‹å‰ï¼Œä¼šå…ˆè‡ªé¡¶å‘ä¸‹è´¯ç©¿ç½‘ç»œåè®®æ ˆå®Œæˆæ•°æ®çš„å°è£…ï¼Œå…¶ä¸­åœ¨ç½‘ç»œå±‚å°è£…çš„æŠ¥å¤´ä¸­å°±åŒ…å«äº†æºIPåœ°å€å’Œç›®çš„IPåœ°å€ã€‚

---

### ç†è§£æºMACåœ°å€å’Œç›®çš„MACåœ°å€

å¤§éƒ¨åˆ†æ•°æ®ä¼ è¾“éƒ½æ˜¯è·¨å±€åŸŸç½‘çš„ï¼Œæ•°æ®ä¼ è¾“è¿‡ç¨‹ä¸­ä¼šç»è¿‡å¾ˆå¤šè·¯ç”±å™¨ï¼Œæœ€ç»ˆæ‰èƒ½åˆ°è¾¾å¯¹ç«¯ä¸»æœºã€‚

æºMACåœ°å€å’Œç›®çš„MACåœ°å€æ˜¯åœ¨æ•°æ®é“¾è·¯å±‚è¢«å°è£…åœ¨æŠ¥å¤´ä¸­çš„ï¼ŒMACåœ°å€åªåœ¨å½“å‰å±€åŸŸç½‘å†…æœ‰æ•ˆï¼Œå› ä¸ºæ¯ç»è¿‡ä¸€ä¸ªè·¯ç”±å™¨ï¼Œå°±ä¼šå°†é“¾è·¯å±‚çš„æŠ¥å¤´å»æ‰ï¼Œç„¶åé‡æ–°å°è£…ä¸€ä¸ªæŠ¥å¤´ï¼Œæ­¤æ—¶çš„æºMACåœ°å€å’Œç›®çš„MACåœ°å€å°±å‘ç”Ÿäº†å˜åŒ–ã€‚

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/63adac4077a54abeb3b01fe3052f59e0.png)

ä¸Šå›¾ä¸­ä¸»æœº1å‘ä¸»æœº2å‘é€æ•°æ®è¿‡ç¨‹ä¸­ï¼ŒæºMACåœ°å€å’Œç›®çš„MACåœ°å€çš„å˜åŒ–è¿‡ç¨‹ã€‚

| æ—¶é—´è½´ | æºMACåœ°å€ | ç›®çš„MACåœ°å€ |
| --- | --- | --- |
| åˆšå¼€å§‹ | ä¸»æœº1çš„MACåœ°å€ | è·¯ç”±å™¨Açš„MACåœ°å€ |
| ç»è¿‡è·¯ç”±å™¨Aå | è·¯ç”±å™¨Açš„MACåœ°å€ | è·¯ç”±å™¨Bçš„MACåœ°å€ |
| ç»è¿‡è·¯ç”±å™¨Bå | è·¯ç”±å™¨Bçš„MACåœ°å€ | è·¯ç”±å™¨Cçš„MACåœ°å€ |
| ç»è¿‡è·¯ç”±å™¨Cå | è·¯ç”±å™¨Cçš„MACåœ°å€ | ä¸»æœº2çš„MACåœ°å€ |

---

### å°ç»“

æ•°æ®ä¼ è¾“çš„è¿‡ç¨‹ä¸­æ˜¯æœ‰ä¸¤å¥—åœ°å€çš„ï¼š

* æºIPåœ°å€å’Œç›®çš„IPåœ°å€ï¼Œç”¨æ¥ç¡®å®šå‘é€æ–¹çš„ä¸»æœºä»¥åŠæ¥å—æ–¹çš„ä¸»æœºï¼Œè¿™ä¸¤ä¸ªåœ°å€ä¸€èˆ¬æ˜¯ä¸ä¼šå˜çš„ï¼›
* æºMACåœ°å€å’Œç›®çš„MACåœ°å€ï¼Œè¿™ä¸¤ä¸ªåœ°å€æ˜¯ä¸€ç›´å˜åŒ–çš„ï¼Œå› ä¸ºç»è¿‡è·¯ç”±å™¨ä¹‹åä¼šè¿›è¡Œè§£åŒ…å’Œé‡æ–°å°è£…ï¼›

---

### ç«¯å£å·

ç«¯å£å·(port)æ˜¯ä¼ è¾“å±‚åè®®çš„å†…å®¹ï¼š

* ç«¯å£å·æ˜¯ä¸€ä¸ª2å­—èŠ‚16ä½çš„æ•´æ•°ï¼›
* ç«¯å£å·ç”¨æ¥æ ‡è¯†ä¸€ä¸ªè¿›ç¨‹ï¼Œå‘Šè¯‰æ“ä½œç³»ç»Ÿï¼Œå½“å‰çš„è¿™ä¸ªæ•°æ®è¦äº¤ç»™å“ªä¸€ä¸ªè¿›ç¨‹æ¥å¤„ç†ï¼›
* IPåœ°å€ + ç«¯å£å·èƒ½å¤Ÿè¡¨ç¤ºç½‘ç»œä¸ŠæŸä¸€å°ä¸»æœºçš„æŸä¸€ä¸ªè¿›ç¨‹ï¼›
* ä¸€ä¸ªç«¯å£å·åªèƒ½è¢«ä¸€ä¸ªè¿›ç¨‹å ç”¨ï¼›
* æ•°æ®åœ¨ä¼ è¾“å±‚è¿›è¡Œå°è£…æ—¶ï¼Œå°±ä¼šæ·»åŠ ä¸Šå¯¹åº”çš„æºç«¯å£å·å’Œç›®çš„ç«¯å£å·ã€‚

IPåœ°å€å¯ä»¥æ ‡è¯†å”¯ä¸€çš„ä¸€å°ä¸»æœºï¼Œç«¯å£å·(port)å¯ä»¥è¡¨ç¤ºä¸€å°ä¸»æœºä¸Šå”¯ä¸€çš„ä¸€ä¸ªè¿›ç¨‹ï¼Œå› æ­¤IP + port = ç½‘ç»œä¸ŠæŸä¸€å°ä¸»æœºçš„æŸä¸€ä¸ªè¿›ç¨‹ã€‚

---

### ç†è§£æºç«¯å£å·å’Œç›®çš„ç«¯å£å·

ä¸¤å°ä¸»æœºè¿›è¡Œé€šä¿¡çš„ç›®çš„ä¸ä»…ä»…æ˜¯å°†æ•°æ®å‘é€ç»™å¯¹ç«¯ä¸»æœºï¼Œè€Œæ˜¯ä¸ºäº†è®¿é—®å¯¹ç«¯ä¸»æœºä¸Šçš„æŸä¸ªæœåŠ¡ã€‚

å½“æˆ‘ä»¬çŸ¥é“äº†IPåœ°å€å’ŒMACåœ°å€ï¼Œå°±å¯ä»¥å°†æ•°æ®å‘é€ç»™å¯¹ç«¯ä¸»æœºï¼Œä½†æ˜¯å¦‚ä½•å†å°†æ•°æ®å‘é€ç»™å¯¹ç«¯ä¸»æœºä¸Šçš„æŸä¸ªè¿›ç¨‹å‘¢ï¼Ÿé‚£ä¹ˆæˆ‘ä»¬è¿˜éœ€è¦çŸ¥é“ç«¯å£å·ï¼Œå½“æˆ‘ä»¬çŸ¥é“æºç«¯å£å·å’Œç›®çš„ç«¯å£å·ä¹‹åï¼Œå°±å¯ä»¥çŸ¥é“æ˜¯å“ªå°ä¸»æœºçš„å“ªä¸ªè¿›ç¨‹å‘é€çš„æ•°æ®ï¼Œä»¥åŠå‘ç»™å“ªå°ä¸»æœºçš„å“ªä¸ªè¿›ç¨‹ã€‚è¿™æ ·å°±å¯ä»¥å®ç°è·¨ç½‘ç»œçš„è¿›ç¨‹é—´é€šä¿¡äº†ã€‚

---

### ç†è§£â€œç«¯å£å·â€å’Œâ€œè¿›ç¨‹IDâ€

è¿›ç¨‹ID(PID)æ˜¯ç”¨æ¥æ ‡è¯†ç³»ç»Ÿå†…æ‰€æœ‰è¿›ç¨‹çš„å”¯ä¸€æ€§ï¼Œå®ƒå±äºç³»ç»Ÿçº§åˆ«çš„æ¦‚å¿µï¼›è€Œç«¯å£å·(port)æ˜¯ç”¨æ¥æ ‡è¯†éœ€è¦å¯¹å¤–è¿›è¡Œç½‘ç»œæ•°æ®è¯·æ±‚çš„è¿›ç¨‹çš„å”¯ä¸€æ€§ï¼Œå®ƒæ˜¯å±äºç½‘ç»œçº§åˆ«çš„æ¦‚å¿µã€‚è¿™æ ·è®¾è®¡å°±æ˜¯ä¸ºäº†é¿å…å°†ç³»ç»ŸåŠŸèƒ½å’Œç½‘ç»œåŠŸèƒ½ç›´æ¥è¿›è¡Œå¼ºè€¦åˆï¼Œé¿å…ä¸€ä¸ªæ¨¡å—æ”¹å˜åå½±å“å¦ä¸€ä¸ªæ¨¡å—ã€‚

æ¯”å¦‚æˆ‘ä»¬æ¯ä¸ªäººéƒ½æœ‰è‡ªå·±çš„èº«ä»½è¯å·ç ï¼Œèº«ä»½è¯å·ç å°±å¯ä»¥æ ‡è¯†æˆ‘ä»¬çš„å”¯ä¸€æ€§äº†ï¼Œé‚£ä¹ˆä¸ºä»€ä¹ˆåœ¨å­¦æ ¡è¿˜è¦æœ‰å­¦å·ï¼Œåœ¨å…¬å¸è¿˜è¦æœ‰å·¥å·å‘¢ï¼Ÿ

å› ä¸ºä¸æ˜¯æ¯ä¸ªäººéƒ½æ˜¯å­¦ç”Ÿï¼Œä¹Ÿä¸æ˜¯æ¯ä¸ªäººéƒ½åœ¨åŒä¸€å®¶å…¬å¸ï¼Œæ‰€ä»¥éœ€è¦åœ¨ä¸åŒåœºæ™¯ä¸‹åœ¨è®¾å®šå¯¹åº”çš„ç¼–å·æ¥è¡¨ç¤ºå”¯ä¸€æ€§ã€‚

æ‰€ä»¥æ¯ä¸€ä¸ªè¿›ç¨‹éƒ½æœ‰pidï¼Œä½†ä¸æ˜¯æ¯ä¸ªè¿›ç¨‹éƒ½æœ‰portã€‚

---

### socketé€šä¿¡çš„æœ¬è´¨

1. æˆ‘ä»¬ä¸Šç½‘æ— éå°±ä¸¤ç§åŠ¨ä½œï¼š

   * æŠŠè¿œç«¯æ•°æ®æ‹‰å–åˆ°æœ¬åœ°ï¼ˆIï¼‰
   * æŠŠæœ¬åœ°æ•°æ®å‘é€åˆ°è¿œç«¯ï¼ˆOï¼‰
2. å¤§éƒ¨åˆ†çš„ç½‘ç»œé€šä¿¡è¡Œä¸ºéƒ½æ˜¯ç”¨æˆ·è§¦å‘çš„ï¼Œåœ¨è®¡ç®—æœºä¸­ï¼Œè°è¡¨ç¤ºç”¨æˆ·å‘¢ï¼Ÿè¿›ç¨‹ï¼ï¼ï¼
3. æˆ‘ä»¬å°†æ•°æ®å‘é€åˆ°ç›®æ ‡ä¸»æœºï¼Œè¿™ä¸æ˜¯ç›®çš„ï¼Œè€Œæ˜¯æ‰‹æ®µã€‚çœŸæ­£çš„ç›®çš„æ˜¯æŠŠæ•°æ®äº¤ç»™è¿™ä¸ªä¸»æœºä¸Šçš„æŸä¸ªæœåŠ¡ï¼ˆè¿›ç¨‹ï¼‰ã€‚
4. â€‹ æœåŠ¡ç«¯ä¸å®¢æˆ·ç«¯è¿›è¡Œé€šä¿¡

   ==>æœåŠ¡ç«¯è¿›ç¨‹å’Œå®¢æˆ·ç«¯è¿›ç¨‹è¿›è¡Œé€šä¿¡

   ==>æœåŠ¡ç«¯è¿›ç¨‹ = æœåŠ¡ç«¯IP + æœåŠ¡ç«¯port

   â€‹ å®¢æˆ·ç«¯è¿›ç¨‹ = å®¢æˆ·ç«¯IP + å®¢æˆ·ç«¯port

   ==>æœåŠ¡ç«¯æ˜¯äº’è”ç½‘ä¸­å”¯ä¸€çš„ä¸€ä¸ªè¿›ç¨‹

   â€‹ å®¢æˆ·ç«¯æ˜¯äº’è”ç½‘ä¸­å”¯ä¸€çš„ä¸€ä¸ªè¿›ç¨‹

   ==>å”¯ä¸€çš„æ‰¾åˆ°å½¼æ­¤
5. æ‰€ä»¥ç½‘ç»œé€šä¿¡çš„æœ¬è´¨ï¼Œå…¶å®å°±æ˜¯è¿›ç¨‹é—´é€šä¿¡ï¼ä¸¤ä¸ªè¿›ç¨‹é—´éœ€è¦é€šä¿¡ï¼Œå‰ææ¡ä»¶å°±æ˜¯è¦æ‰¾åˆ°å…¬å…±èµ„æºï¼Œè¿™ä¸ªå…¬å…±èµ„æºå°±æ˜¯ç½‘ç»œï¼

æˆ‘ä»¬ä¹‹åè¦å†™çš„æœåŠ¡å™¨å°±æ˜¯åº”ç”¨å±‚çš„ä»£ç ï¼Œç„¶åè°ƒç”¨ä¼ è¾“å±‚æä¾›çš„ç³»ç»Ÿè°ƒç”¨ï¼Œå³æ“ä½œç³»ç»Ÿæä¾›çš„ç½‘ç»œç³»ç»Ÿè°ƒç”¨ã€‚

---

### è®¤è¯†TCPåè®®å’ŒUDPåè®®

#### TCPåè®®

TCPåè®®å«åšä¼ è¾“æ§åˆ¶åè®®ï¼ˆTransmission Control Protocolï¼‰ï¼ŒTCPåè®®æ˜¯ä¸€ç§é¢å‘è¿æ¥çš„ã€å¯é çš„ã€åŸºäºå­—èŠ‚æµçš„ä¼ è¾“å±‚é€šä¿¡åè®®ã€‚

TCPåè®®æ˜¯é¢å‘è¿æ¥çš„ï¼Œå¦‚æœä¸¤å°ä¸»æœºæƒ³è¦è¿›è¡Œé€šä¿¡ï¼Œå°±å¿…é¡»å…ˆå»ºç«‹è¿æ¥ï¼Œå½“è¿æ¥å»ºç«‹ä¹‹åæ‰èƒ½è¿›è¡Œæ•°æ®ä¼ è¾“ã€‚TCPåè®®æ˜¯ä¿è¯å¯é æ€§çš„åè®®ï¼Œå½“ä¼ è¾“è¿‡ç¨‹ä¸­å¦‚æœå‘ç”Ÿäº†ä¸¢åŒ…ã€ä¹±åºç­‰æƒ…å†µï¼ŒTCPåè®®éƒ½æœ‰å¯¹åº”çš„è§£å†³åŠæ³•ã€‚

#### UDPåè®®

UDPåè®®å«åšç”¨æˆ·æ•°æ®æŠ¥åè®®ï¼ˆUser Datagram Protocolï¼‰ï¼ŒUDPåè®®æ˜¯ä¸€ç§æ— åºå»ºç«‹è¿æ¥çš„ã€ä¸å¯é çš„ã€é¢å‘æ•°æ®æŠ¥çš„ä¼ è¾“å±‚é€šä¿¡åè®®ã€‚

UDPåè®®è¿›è¡Œé€šä¿¡æ—¶æ— éœ€å»ºç«‹è¿æ¥ï¼Œä¸¤å°ä¸»æœºå¦‚æœæƒ³è¦è¿›è¡Œæ•°æ®ä¼ è¾“ï¼Œç›´æ¥å°†æ•°æ®å‘é€ç»™å¯¹ç«¯ä¸»æœºå³å¯ï¼Œä½†è¿™æ„å‘³ç€UDPåè®®æ˜¯ä¸å¯é çš„ï¼Œå¦‚æœä¼ è¾“è¿‡ç¨‹ä¸­å‘ç”Ÿäº†ä¸¢åŒ…ã€ä¹±åºç­‰æƒ…å†µï¼ŒUDPåè®®æ˜¯ä¸çŸ¥é“çš„ï¼Œæ— æ³•è§£å†³ã€‚

#### ä¸ºä»€ä¹ˆUDPåè®®ä¸å¯é è¿˜ä¼šä¸€ç›´å­˜åœ¨ï¼Ÿ

TCPåè®®å¯é ï¼Œé‚£ä¹ˆä¹Ÿå°±æ„å‘³ç€åº•å±‚çš„å®ç°æ›´åŠ å¤æ‚ï¼Œæ¥å£ä¼šæ›´åŠ å¤šä¸€ç‚¹ï¼Œä½¿ç”¨æˆæœ¬æ¯”è¾ƒé«˜ï¼›è€ŒUDPè™½ç„¶ä¸å¯é ï¼Œä½†ä¸€å®šæ›´åŠ ç®€å•ï¼Œä½¿ç”¨èµ·æ¥æ›´åŠ æ–¹ä¾¿ã€‚

æ‰€ä»¥é‡‡ç”¨TCPåè®®è¿˜æ˜¯UDPåè®®å–å†³äºä¸Šå±‚çš„åº”ç”¨åœºæ™¯ã€‚å¦‚æœåº”ç”¨åœºæ™¯ä¸¥æ ¼è¦æ±‚æ•°æ®åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­çš„å¯é æ€§ï¼Œæ­¤æ—¶æˆ‘ä»¬å°±å¿…é¡»é‡‡å–TCPï¼›å¦‚æœåº”ç”¨åœºæ™¯å…è®¸å‡ºç°å°‘é‡çš„ä¸¢åŒ…ï¼Œé‚£ä¹ˆä¼˜å…ˆä½¿ç”¨UDPï¼Œå› ä¸ºè¶³å¤Ÿç®€å•ã€‚

---

### ç½‘ç»œå­—èŠ‚åº

è®¡ç®—æœºåœ¨å­˜å‚¨æ•°æ®æ—¶ï¼Œæ˜¯æœ‰å¤§å°ç«¯çš„æ¦‚å¿µçš„ï¼š

* å¤§ç«¯å­˜å‚¨ï¼šæ•°æ®çš„
  **ä½å­—èŠ‚**
  å†…å®¹å­˜å‚¨åœ¨
  **é«˜åœ°å€**
  å¤„ï¼Œæ•°æ®çš„
  **é«˜å­—èŠ‚**
  å†…å®¹å­˜å‚¨åœ¨
  **ä½åœ°å€**
  å¤„ã€‚
* å°ç«¯å­˜å‚¨ï¼šæ•°æ®çš„
  **ä½å­—èŠ‚**
  å†…å­˜å­˜å‚¨åœ¨
  **ä½åœ°å€**
  å¤„ï¼Œæ•°æ®çš„
  **é«˜å­—èŠ‚**
  å†…å®¹å­˜å‚¨åœ¨
  **é«˜åœ°å€**
  å¤„ã€‚

ä¸ºäº†ä¿è¯æ•°æ®èƒ½å¤Ÿæ­£å¸¸è¢«è·å–ï¼Œç½‘ç»œå­—èŠ‚åºåˆ—ç»Ÿä¸€
**ä»¥å¤§ç«¯ä¸ºä¸»**
ã€‚

ä¸ºäº†ä½¿ç½‘ç»œç¨‹åºå…·æœ‰å¯ç§»æ¤æ€§ï¼Œä½¿ç”¨æ ·çš„Cä»£ç åœ¨å¤§ç«¯å’Œå°ç«¯æœºå™¨ä¸Šç¼–è¯‘åéƒ½èƒ½æ­£å¸¸è¿è¡Œï¼Œå¯ä»¥è°ƒç”¨ä»¥ä¸‹åº“å‡½æ•°åšç½‘ç»œå­—èŠ‚åºå’Œä¸»æœºå­—èŠ‚åºçš„è½¬æ¢ã€‚

```cpp
#include<arpa/inet.h>

uint32_t htonl(uint32_t hostlong);
uint16_t htons(uint16_t hostshort);
uint32_t ntohl(uint32_t netlong);
uint16_t ntohs(uint16_t netshort);

```

* è¿™äº›å‡½æ•°åå¾ˆå¥½è®°ï¼Œhè¡¨ç¤ºhostï¼Œnè¡¨ç¤ºnetworkï¼Œlè¡¨ç¤º32ä½é•¿æ•´æ•°ï¼Œsè¡¨ç¤º16ä½çŸ­æ•´æ•°ï¼›
* ä¾‹å¦‚htonlè¡¨ç¤ºå°†32ä½çš„é•¿æ•´æ•°ä»ä¸»æœºå­—èŠ‚åºè½¬æ¢æˆç½‘ç»œå­—èŠ‚åºï¼Œä¾‹å¦‚å°†IPåœ°å€è½¬æ¢åå‡†å¤‡å‘é€ï¼›
* å¦‚æœä¸»æœºæ˜¯å°ç«¯å­—èŠ‚åºï¼Œè¿™äº›å‡½æ•°å°†å‚æ•°åšç›¸åº”çš„å¤§å°ç«¯è½¬æ¢ç„¶åè¿”å›ï¼›
* å¦‚æœä¸»æœºæ˜¯å¤§ç«¯å­—èŠ‚åºï¼Œè¿™äº›å‡½æ•°ä¸åšè½¬æ¢ï¼Œå°†å‚æ•°åŸå°ä¸åŠ¨åœ°è¿”å›ï¼›

## äºŒã€socketç¼–ç¨‹æ¥å£

### socketå¸¸è§API

```cpp
//åˆ›å»ºsocketæ–‡ä»¶æè¿°ç¬¦ï¼ˆTCP/UDPï¼Œå®¢æˆ·ç«¯ + æœåŠ¡å™¨ï¼‰
int socket(int domain,int type,int protocol);

//ç»‘å®šç«¯å£å·ï¼ˆTCP/UDPï¼ŒæœåŠ¡å™¨ï¼‰
int bind(int socket,const struct sockaddr *address,socklen_t address_len);

//å¼€å§‹ç›‘å¬socketï¼ˆTCPï¼ŒæœåŠ¡å™¨ï¼‰
int listen(int socket,int backlog);

//æ¥æ”¶è¯·æ±‚ï¼ˆTCP,æœåŠ¡å™¨ï¼‰
int accept(int socket,struct sockaddr* address,socklen_t* address_len);

//å»ºç«‹è¿æ¥ï¼ˆTCPï¼Œå®¢æˆ·ç«¯ï¼‰
int connect(int sockfd,const struct sockaddr *addr,socklen_t addrlen);

```

---

### sockaddrç»“æ„

socketç¼–ç¨‹ï¼Œæ˜¯æœ‰ä¸åŒç§ç±»çš„ï¼Œæœ‰çš„æ˜¯ä¸“é—¨ç”¨æ¥è¿›è¡Œæœ¬åœ°é€šä¿¡çš„ï¼ˆUnix socketï¼‰ï¼Œæœ‰çš„æ˜¯ç”¨æ¥ä¸“é—¨è¿›è¡Œè·¨ç½‘ç»œé€šä¿¡çš„ï¼ˆinet socketï¼‰ï¼Œæœ‰çš„æ˜¯ç”¨æ¥è¿›è¡Œç½‘ç»œç®¡ç†çš„ï¼ˆraw socketï¼‰ã€‚ä¸ºäº†èƒ½è®©ç”¨æˆ·å‡å°‘ä½¿ç”¨çš„æˆæœ¬ï¼Œæˆ‘ä»¬å°±éœ€è¦æŠŠæ‰€æœ‰çš„æ¥å£è¿›è¡Œç»Ÿä¸€ï¼Œäºæ˜¯å°±ä½¿ç”¨Cè¯­è¨€è¿›è¡Œç¼–å†™ï¼Œè¦ç»Ÿä¸€è¿™ä¸ªæ¥å£è¿˜éœ€è¦ç»Ÿä¸€æ•°æ®ç±»å‹ï¼Œäºæ˜¯å°±æœ‰äº†
`struct sockaddr`
ã€‚

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/4942335deebc4d179bb95a8404db37e2.png)

é€šè¿‡
`struct sockaddr`
æ¥ç®¡ç†
`struct sockaddr_in`
å’Œ
`struct sockaddr_un`
,
`struct sockaddr_in`
ç»“æ„ä½“æ˜¯ç”¨æ¥è·¨ç½‘ç»œé€šä¿¡çš„ï¼Œè€Œ
`struct sockaddr_un`
ç»“æ„ä½“æ˜¯ç”¨æ¥æœ¬åœ°é€šä¿¡çš„ã€‚

ä¸ºäº†è®©ç½‘ç»œé€šä¿¡å’Œæœ¬åœ°é€šä¿¡èƒ½å¤Ÿä½¿ç”¨åŒä¸€å¥—å‡½æ•°æ¥å£ï¼Œäºæ˜¯å°±å‡ºç°äº†
`sockaddr`
ç»“æ„ä½“ï¼Œè¿™ä¸‰ä¸ªç»“æ„ä½“éƒ½ä¸ç›¸åŒï¼Œä½†æ˜¯è¿™ä¸‰ä¸ªç»“æ„ä½“çš„å¤´éƒ¨å­—æ®µéƒ½æ˜¯16ä½åœ°å€ç±»å‹ï¼Œå½“æˆ‘ä»¬æƒ³è¿›è¡Œç½‘ç»œé€šä¿¡æ—¶ï¼Œå°±ä¼ é€’
`AF_INET`
ï¼Œæƒ³è¿›è¡Œæœ¬åœ°é€šä¿¡ï¼Œå°±ä¼ é€’
`AF_UNIX`
ã€‚è¿™æ ·å°±å¯ä»¥é€šè¿‡
`sockaddr`
æ¥ç®¡ç†ç½‘ç»œé€šä¿¡å’Œæœ¬åœ°é€šä¿¡äº†ã€‚

## ä¸‰ã€ç®€å•çš„UDPç½‘ç»œç¨‹åº

### socketå‡½æ•°

```cpp
#include <sys/types.h>          /* See NOTES */
#include <sys/socket.h>

int socket(int domain, int type, int protocol);

```

åŠŸèƒ½ï¼š

* åˆ›å»ºå¥—æ¥å­—çš„é€šä¿¡ã€‚

å‚æ•°ï¼š

* domainï¼šé€‰æ‹©åè®®çš„ç±»å‹ï¼Œå¦‚æœæ˜¯æœ¬åœ°é€šä¿¡å°±æ˜¯
  `AF_UNIX`
  ï¼›ç½‘ç»œé€šä¿¡å°±æ˜¯
  `AF_INET`
  ã€‚
* typeï¼šåˆ›å»ºå¥—æ¥å­—æ—¶çš„æœåŠ¡ç±»å‹ã€‚å¦‚æœæ˜¯UDPï¼Œæˆ‘ä»¬é‡‡ç”¨
  `SOCK_DGRAM`
  ï¼Œå«åšç”¨æˆ·æ•°æ®æŠ¥æœåŠ¡ï¼›å¦‚æœæ˜¯TCPï¼Œæˆ‘ä»¬é‡‡ç”¨
  `SOCK_STREAM`
  ï¼Œå«åšæµå¼å¥—æ¥å­—ï¼Œæä¾›çš„æ˜¯æµå¼æœåŠ¡ã€‚
* protocolï¼šå¥—æ¥å­—çš„åè®®ç±»åˆ«ï¼Œå¯ä»¥æŒ‡æ˜ä¸ºTCPæˆ–è€…UDPï¼Œä¸€èˆ¬è®¾ç½®ä¸º0å³å¯ã€‚

è¿”å›å€¼ï¼š

* åˆ›å»ºæˆåŠŸè¿”å›ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦ï¼Œæ‰€ä»¥å½“æˆ‘ä»¬ä½¿ç”¨socketåˆ›å»ºå¥—æ¥å­—æˆåŠŸæ—¶ï¼Œå°±ç›¸å½“äºæˆ‘ä»¬æ‰“å¼€äº†ç½‘å¡ï¼ˆç½‘ç»œæ–‡ä»¶ï¼‰ã€‚
* åˆ›å»ºå¤±è´¥è¿”å›-1ï¼ŒåŒæ—¶é”™è¯¯ç ä¼šè¢«è®¾ç½®ã€‚

ä½¿ç”¨ç¤ºä¾‹ï¼š

```cpp
int sockfd = socket(AF_INET,SOCK_DGRAM,0);

```

---

### bindå‡½æ•°

```cpp
 #include <sys/types.h>          /* See NOTES */
 #include <sys/socket.h>

int bind(int sockfd, const struct sockaddr *addr,socklen_t addrlen);

```

åŠŸèƒ½ï¼š

* å°†æ–‡ä»¶å’Œç½‘ç»œå…³è”èµ·æ¥ã€‚

å‚æ•°ï¼š

* sockfdï¼šæ–‡ä»¶æè¿°ç¬¦ã€‚
* addrï¼šç½‘ç»œç›¸å…³çš„å±æ€§ä¿¡æ¯ï¼Œç±»ä¼¼äºä¸€ä¸ªç»“æ„ä½“ï¼Œé‡Œé¢åŒ…å«äº†ï¼šåè®®å®¶æ—ã€IPåœ°å€ã€ç«¯å£å·ã€‚
* addrlenï¼šç»“æ„ä½“addrçš„é•¿åº¦

è¿”å›å€¼ï¼š

* æˆåŠŸè¿”å›0ã€‚
* å¤±è´¥è¿”å›-1ï¼Œè®¾ç½®é”™è¯¯ç ã€‚

ä½¿ç”¨ç¤ºä¾‹ï¼š

```cpp
int n = bind(_sockfd,(struct sockaddr*)&local,sizeof(local));

```

---

### bzeroå‡½æ•°

```cpp
#include <strings.h>

void bzero(void *s, size_t n);

```

åŠŸèƒ½ï¼š

* ç”¨äºå°†ä¸€å—å†…å­˜ç©ºé—´æ¸…é›¶ï¼Œé€šå¸¸ç”¨äºåˆå§‹åŒ–å†…å­˜ã€‚

å‚æ•°ï¼š

* sï¼šæŒ‡å‘è¦æ¸…é›¶çš„å†…å­˜åŒºåŸŸçš„æŒ‡é’ˆã€‚
* nï¼šè¦æ¸…é›¶çš„å­—èŠ‚æ•°ã€‚

è¿”å›å€¼ï¼šç©ºã€‚

ä½¿ç”¨ç¤ºä¾‹ï¼š

```cpp
struct sockaddr_in local;
bzero(&local,sizeof(local));

```

---

### inet_addrå‡½æ•°

```cpp
#include <sys/socket.h>
#include <netinet/in.h>
#include <arpa/inet.h>

in_addr_t inet_addr(const char *cp);

```

åŠŸèƒ½ï¼š

* å°†å­—ç¬¦ä¸²é£æ ¼çš„ç‚¹åˆ†åè¿›åˆ¶çš„IPåœ°å€è½¬æˆ4å­—èŠ‚IP
* å°†ä¸»æœºåºåˆ—è½¬æˆç½‘ç»œåºåˆ—

å‚æ•°ï¼š

* ç›®æ ‡å­—ç¬¦ä¸²ï¼Œä¹Ÿå°±æ˜¯å­—ç¬¦ä¸²ç±»å‹çš„IPåœ°å€

è¿”å›å€¼ï¼š

* in_addr_tç±»å‹

ä½¿ç”¨ç¤ºä¾‹ï¼š

```cpp
local.sin_addr.s_addr = inet_addr(_ip.c_str());

```

---

### ä»£ç åˆæ­¥æ¼”ç¤º

#### `UdpServer.hpp`

```cpp
#pragma once
#include<iostream>
#include<cstdlib>
#include<strings.h>
#include<string>
#include<unistd.h>
#include<sys/types.h>
#include<sys/socket.h>
#include <netinet/in.h>
#include<arpa/inet.h>
//echo server -> client -> server
enum
{
    SOCKET_ERROR = 1,
    BIND_ERROR,
    USAGE_ERROR,
};

const static int defaultfd = -1;

class UdpServer
{
public:
    UdpServer(const std::string &ip,uint16_t port):_sockfd(defaultfd),_ip(ip),_port(port),_isrunning(false)
    {}
    void InitServer()
    {
        //1. åˆ›å»ºudp socket å¥—æ¥å­— â€”â€” å¿…é¡»è¦åšçš„ â€”â€” å¯ä»¥ç†è§£æˆå°†ç½‘å¡æ‰“å¼€äº†
        _sockfd = socket(AF_INET,SOCK_DGRAM,0);
        if(_sockfd < 0)
        {
            std::cerr<<"socket failed!\n";
            exit(SOCKET_ERROR);
        }
        std::cout<<"socket create success,sockfd:"<<_sockfd<<std::endl;
        
        //2.0 å¡«å……sockaddr_inç»“æ„
        struct sockaddr_in local;//struct sockaddr_inç³»ç»Ÿæä¾›çš„æ•°æ®ç±»å‹ã€‚localæ˜¯å˜é‡ï¼Œåœ¨ç”¨æˆ·æ ˆä¸Šå¼€è¾Ÿç©ºé—´ã€‚int a = 100;
        bzero(&local,sizeof(local));
        local.sin_family = AF_INET;
        local.sin_port = htons(_port);//portè¦ç»è¿‡ç½‘ç»œä¼ è¾“ç»™å¯¹é¢ï¼Œä¹Ÿå°±æ˜¯è¯´éœ€è¦å…ˆåˆ°ç½‘ç»œï¼Œ_port:ä¸»æœºåºåˆ—->ä¸»æœºåºåˆ—éœ€è¦è½¬æ¢æˆç½‘ç»œåºåˆ—
        //a. å­—ç¬¦ä¸²ç±»å‹çš„ç‚¹åˆ†åè¿›åˆ¶IPåœ°å€è½¬æˆ4å­—èŠ‚IP
        //b. ä¸»æœºåºåˆ—ï¼Œè½¬æˆç½‘ç»œåºåˆ—
        local.sin_addr.s_addr = inet_addr(_ip.c_str());//"192.168.3.1"->å­—ç¬¦ä¸²é£æ ¼çš„ç‚¹åˆ†åè¿›åˆ¶çš„IPåœ°å€-> 4å­—èŠ‚IP
        
        //2.1 bind sockfdå’Œç½‘ç»œä¿¡æ¯(IP(?) + Port)
        int n = bind(_sockfd,(struct sockaddr*)&local,sizeof(local));
        if(n < 0)
        {
            std::cerr<<"bind failed!\n";
            exit(BIND_ERROR);
        }
        std::cout<<"socket bind success\n";
    }
    void Start()
    {
        //ä¸€ç›´è¿è¡Œï¼ŒçŸ¥é“ç®¡ç†è€…ä¸æƒ³è¿è¡Œäº†,æœåŠ¡å™¨éƒ½æ˜¯æ­»å¾ªç¯
        _isrunning = true;
        while(true)
        {
            sleep(1);
            std::cout<<"server is running...\n";
        }
        _isrunning = false;
    }
    ~UdpServer()
    {}
private:
    int _sockfd;//æ–‡ä»¶æè¿°ç¬¦
    std::string _ip;//æš‚æ—¶è¿™æ ·å†™ï¼Œè¿™ä¸ªåœ°æ–¹ä¸æ˜¯å¿…é¡»çš„
    uint16_t _port;//æœåŠ¡å™¨æ‰€ç”¨çš„ç«¯å£å·
    bool _isrunning;//æ˜¯å¦å¯åŠ¨
};

```

#### `Main.cc`

```cpp
#include<iostream>
#include<memory>
#include"UdpServer.hpp"

void Usage(std::string proc)
{
    std::cout<<"Usage:\n\t"<<proc<<"local_ip local_port\n"<<std::endl;
}

//udpserver ip port
int main(int argc,char* argv[])
{
    if(argc != 3)
    {
        Usage(argv[0]);
        exit(USAGE_ERROR);
    }
    std::string ip = argv[1];
    uint16_t port = std::stoi(argv[2]);
    std::unique_ptr<UdpServer> usvr = std::make_unique<UdpServer>(ip,port);//C++14
    usvr->InitServer();
    usvr->Start();
    return 0;
}

```

#### è¿è¡Œæ¼”ç¤º

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/bafe245fdba44da7b0ef02471898107d.gif)

---

#### é‡è¦çŸ¥è¯†

##### æœ¬åœ°ç¯å›åœ°å€

æˆ‘ä»¬ä¸Šé¢è¿è¡Œä»£ç æ—¶ï¼Œ127.0.0.1å«åšæœ¬åœ°ç¯å›ï¼Œä½¿ç”¨è¿™ä¸ªipåœ°å€ä¹‹åï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯éƒ½å¯ä»¥åœ¨ä¸€å°æœºå™¨ä¸Šã€‚

æœ¬åœ°ç¯å›çš„ä½œç”¨å°±æ˜¯å¯ä»¥å®ç°æœ¬åœ°é€šä¿¡ï¼Œå¸¸ç”¨äºè¿›è¡Œä»£ç æµ‹è¯•ã€‚

##### netstatæŒ‡ä»¤

å½“æˆ‘ä»¬æƒ³æŸ¥çœ‹ç½‘ç»œå½“ä¸­å¯åŠ¨çš„æœåŠ¡æ—¶ï¼Œå¯ä»¥ä½¿ç”¨
`netstat`
æŒ‡ä»¤

* -aï¼šallï¼Œæ˜¾ç¤ºæ‰€æœ‰ç»ˆç«¯ä¸‹çš„ç½‘ç»œæœåŠ¡
* -uï¼šudpï¼Œæ˜¾ç¤ºudpåè®®çš„ç½‘ç»œæœåŠ¡
* -nï¼šnumberï¼Œå°†èƒ½æ˜¾ç¤ºæˆæ•°å­—çš„æ˜¾ç¤ºæˆæ•°å­—
* -pï¼šprocessï¼Œè¿›ç¨‹

---

### recvfromå‡½æ•°

```cpp
#include <sys/types.h>
#include <sys/socket.h>

ssize_t recvfrom(int sockfd, void *buf, size_t len,int flags,struct sockaddr *src_addr, socklen_t *addrlen);

```

åŠŸèƒ½ï¼šè¯»å–å…¶ä»–ä¸»æœºå‘é€è¿‡æ¥çš„æ•°æ®ã€‚

å‚æ•°ï¼š

* sockfdï¼šå¯¹åº”æ“ä½œçš„æ–‡ä»¶æè¿°ç¬¦ã€‚è¡¨ç¤ºä»è¯¥æ–‡ä»¶æè¿°ç¬¦ç´¢å¼•çš„æ–‡ä»¶å½“ä¸­è¯»å–æ•°æ®ã€‚
* bufï¼šè¯»å–æ•°æ®çš„å­˜æ”¾ä½ç½®ã€‚è¾“å‡ºå‹å‚æ•°çš„ç¼“å†²åŒºã€‚
* lenï¼šæœŸæœ›è¯»å–æ•°æ®çš„å­—èŠ‚æ•°ã€‚
* flagsï¼šè¯»å–æ–¹å¼ã€‚ä¸€èˆ¬è®¾ç½®ä¸º0ï¼Œè¡¨ç¤ºé˜»å¡è¯»å–ã€‚
* src_addrï¼šå¯¹ç«¯ç½‘ç»œç›¸å…³çš„å±æ€§ä¿¡æ¯ï¼ŒåŒ…æ‹¬åè®®å®¶æ—ã€IPåœ°å€ã€ç«¯å£å·ç­‰ã€‚ä¸€èˆ¬æ˜¯åˆ›å»ºä¸€ä¸ªstruct sockaddr _in peer;å°†peerä¼ é€è¿‡å»ã€‚
* addrlenï¼šè°ƒç”¨æ—¶ä¼ å…¥æœŸæœ›è¯»å–çš„src_addrç»“æ„ä½“çš„é•¿åº¦ï¼Œè¿”å›æ˜¯ä»£è¡¨å®é™…è¯»å–åˆ°çš„src_addrç»“æ„ä½“çš„é•¿åº¦ã€‚è¿™æ˜¯ä¸€ä¸ªè¾“å…¥è¾“å‡ºå‹å‚æ•°ã€‚

è¿”å›å€¼ï¼š

* è¯»å–æˆåŠŸè¿”å›å®é™…è¯»å–åˆ°çš„å­—èŠ‚æ•°ã€‚
* è¯»å–å¤±è´¥è¿”å›-1ï¼ŒåŒæ—¶é”™è¯¯ç ä¼šè¢«è®¾ç½®ã€‚

ä½¿ç”¨ç¤ºä¾‹ï¼š

```cpp
char buffer[1024];
struct sockaddr_in peer;
socklen_t len = sizeof(peer);//å¿…é¡»åˆå§‹åŒ–æˆä¸ºsizeof(peer)
int n = recvfrom(_sockfd,buffer,sizeof(buffer)-1,0,(struct sockaddr*)&peer,&len);

```

---

### sendtoå‡½æ•°

```cpp
#include <sys/types.h>
#include <sys/socket.h>

ssize_t sendto(int sockfd, const void *buf, size_t len, int flags,const struct sockaddr *dest_addr,socklen_t addrlen);

```

åŠŸèƒ½ï¼š

* UDPå®¢æˆ·ç«¯å‘é€æ•°æ®

å‚æ•°ï¼š

* sockfdï¼šå¯¹åº”æ“ä½œçš„æ–‡ä»¶æè¿°ç¬¦ã€‚è¡¨ç¤ºå°†æ•°æ®å†™å…¥è¯¥æ–‡ä»¶æè¿°ç¬¦ç´¢å¼•çš„æ–‡ä»¶å½“ä¸­ã€‚
* bufï¼šå¾…å†™å…¥æ•°æ®çš„å­˜æ”¾ä½ç½®ã€‚
* lenï¼šæœŸæœ›å†™å…¥æ•°æ®çš„å­—èŠ‚æ•°ã€‚
* flagsï¼šå†™å…¥çš„æ–¹å¼ã€‚ä¸€èˆ¬è®¾ç½®ä¸º0ï¼Œè¡¨ç¤ºé˜»å¡å†™å…¥ã€‚
* dest_addrï¼šå¯¹ç«¯ç½‘ç»œç›¸å…³çš„å±æ€§ä¿¡æ¯ï¼ŒåŒ…æ‹¬åè®®å®¶æ—ã€IPåœ°å€ã€ç«¯å£å·ç­‰ã€‚
* addrlenï¼šdest_addrç»“æ„ä½“çš„é•¿åº¦ã€‚

è¿”å›å€¼ï¼š

* å†™å…¥æˆåŠŸè¿”å›å®é™…å†™å…¥çš„å­—èŠ‚æ•°ã€‚
* å†™å…¥å¤±è´¥è¿”å›-1ï¼ŒåŒæ—¶é”™è¯¯ç ä¼šè¢«è®¾ç½®ã€‚

ä½¿ç”¨ç¤ºä¾‹ï¼š

```cpp
sendto(_sockfd,buffer,sizeof(buffer),0,(struct sockaddr*)&peer,len);

```

---

### æœ¬åœ°æœåŠ¡å™¨é€šä¿¡ä»£ç æ¼”ç¤º

#### `UdpServer.hpp`

```cpp
#pragma once
#include<iostream>
#include<cstdlib>
#include<strings.h>
#include<string>
#include<unistd.h>
#include<sys/types.h>
#include<sys/socket.h>
#include <netinet/in.h>
#include<arpa/inet.h>
//echo server -> client -> server
enum
{
    SOCKET_ERROR = 1,
    BIND_ERROR,
    USAGE_ERROR,
};

const static int defaultfd = -1;

class UdpServer
{
public:
    UdpServer(const std::string &ip,uint16_t port):_sockfd(defaultfd),_ip(ip),_port(port),_isrunning(false)
    {}
    void InitServer()
    {
        //1. åˆ›å»ºudp socket å¥—æ¥å­— â€”â€” å¿…é¡»è¦åšçš„ â€”â€” å¯ä»¥ç†è§£æˆå°†ç½‘å¡æ‰“å¼€äº†
        _sockfd = socket(AF_INET,SOCK_DGRAM,0);
        if(_sockfd < 0)
        {
            std::cerr<<"socket failed!\n";
            exit(SOCKET_ERROR);
        }
        std::cout<<"socket create success,sockfd:"<<_sockfd<<std::endl;
        
        //2.0 å¡«å……sockaddr_inç»“æ„
        struct sockaddr_in local;//struct sockaddr_inç³»ç»Ÿæä¾›çš„æ•°æ®ç±»å‹ã€‚localæ˜¯å˜é‡ï¼Œåœ¨ç”¨æˆ·æ ˆä¸Šå¼€è¾Ÿç©ºé—´ã€‚int a = 100;
        bzero(&local,sizeof(local));
        local.sin_family = AF_INET;
        local.sin_port = htons(_port);//portè¦ç»è¿‡ç½‘ç»œä¼ è¾“ç»™å¯¹é¢ï¼Œä¹Ÿå°±æ˜¯è¯´éœ€è¦å…ˆåˆ°ç½‘ç»œï¼Œ_port:ä¸»æœºåºåˆ—->ä¸»æœºåºåˆ—éœ€è¦è½¬æ¢æˆç½‘ç»œåºåˆ—
        //a. å­—ç¬¦ä¸²ç±»å‹çš„ç‚¹åˆ†åè¿›åˆ¶IPåœ°å€è½¬æˆ4å­—èŠ‚IP
        //b. ä¸»æœºåºåˆ—ï¼Œè½¬æˆç½‘ç»œåºåˆ—
        local.sin_addr.s_addr = inet_addr(_ip.c_str());//"192.168.3.1"->å­—ç¬¦ä¸²é£æ ¼çš„ç‚¹åˆ†åè¿›åˆ¶çš„IPåœ°å€-> 4å­—èŠ‚IP
        
        //2.1 bind sockfdå’Œç½‘ç»œä¿¡æ¯(IP(?) + Port)
        int n = bind(_sockfd,(struct sockaddr*)&local,sizeof(local));
        if(n < 0)
        {
            std::cerr<<"bind failed!\n";
            exit(BIND_ERROR);
        }
        std::cout<<"socket bind success\n";
    }
    void Start()
    {
        //ä¸€ç›´è¿è¡Œï¼ŒçŸ¥é“ç®¡ç†è€…ä¸æƒ³è¿è¡Œäº†,æœåŠ¡å™¨éƒ½æ˜¯æ­»å¾ªç¯
        _isrunning = true;
        while(true)
        {
            char buffer[1024];
            struct sockaddr_in peer;
            socklen_t len = sizeof(peer);//å¿…é¡»åˆå§‹åŒ–æˆä¸ºsizeof(peer)
            //1. æˆ‘ä»¬è¦è®©serverå…ˆæ”¶æ•°æ®
            int n = recvfrom(_sockfd,buffer,sizeof(buffer)-1,0,(struct sockaddr*)&peer,&len);
            if(n > 0)
            {
                buffer[n] = 0;
                std::cout<<"get message:"<<buffer<<std::endl;
                //2. æˆ‘ä»¬è¦å°†serveræ”¶åˆ°çš„æ•°æ®ï¼Œå‘å›ç»™å¯¹æ–¹
                sendto(_sockfd,buffer,sizeof(buffer),0,(struct sockaddr*)&peer,len);
            }
        }
        _isrunning = false;
    }
    ~UdpServer()
    {}
private:
    int _sockfd;//æ–‡ä»¶æè¿°ç¬¦
    std::string _ip;//æš‚æ—¶è¿™æ ·å†™ï¼Œè¿™ä¸ªåœ°æ–¹ä¸æ˜¯å¿…é¡»çš„
    uint16_t _port;//æœåŠ¡å™¨æ‰€ç”¨çš„ç«¯å£å·
    bool _isrunning;//æ˜¯å¦å¯åŠ¨
};

```

#### `UdpClient.cc`

```cpp
#include<iostream>
#include<cstring>
#include<sys/types.h>
#include<sys/socket.h>
#include<netinet/in.h>
#include<arpa/inet.h>

void Usage(std::string proc)
{
    std::cout<<"Usage:\n\t"<<proc<<" local_ip local_port\n";
}

int main(int argc,char* argv[])
{
    if(argc < 3)
    {
        Usage(argv[0]);
        exit(1);
    }
    std::string serverip = argv[1];
    uint16_t serverport = std::stoi(argv[2]);
    //1. åˆ›å»ºsocket
    int sockfd = socket(AF_INET,SOCK_DGRAM,0);
    if(sockfd < 0)
    {
        std::cerr<<"socket error"<<std::endl;
    }
    //clientè¦ä¸è¦bindï¼Ÿè¦ã€‚clientä¹Ÿè¦æœ‰è‡ªå·±çš„ipå’Œportï¼Œä½†æ˜¯ä¸éœ€è¦æ˜¾å¼çš„bind
    //a. å¦‚ä½•bindï¼Ÿudp clienté¦–æ¬¡å‘é€æ•°æ®çš„æ—¶å€™ï¼Œosä¼šè‡ªå·±è‡ªåŠ¨éšæœºçš„ç»™clientè¿›è¡Œbind â€”â€” ä¸ºä»€ä¹ˆï¼Ÿ é˜²æ­¢client portå†²çªã€‚ è¦bindï¼Œå¿…ç„¶è¦å–portå…³è”èµ·æ¥
    //b. ä»€ä¹ˆæ—¶å€™bindå‘¢ï¼Ÿé¦–æ¬¡å‘é€æ•°æ®çš„æ—¶å€™

    //æ„å»ºç›®æ ‡ä¸»æœºçš„socketä¿¡æ¯
    struct sockaddr_in server;
    memset(&server,0,sizeof(server));
    server.sin_family = AF_INET;
    server.sin_port = htons(serverport);
    server.sin_addr.s_addr = inet_addr(serverip.c_str());

    std::string message;
    //2. ç›´æ¥é€šä¿¡å³å¯
    while(true)
    {
        std::cout<<"Place Enter# ";
        std::getline(std::cin,message);
        sendto(sockfd,message.c_str(),message.size(),0,(struct sockaddr*)&server,sizeof(server));

        // ä¸ä¸€å®šå‘ä¸€å°UDPæœåŠ¡å™¨å‘æ¶ˆæ¯ï¼Œå¯èƒ½æƒ³å¤šå°æœåŠ¡å™¨å‘æ¶ˆæ¯ï¼Œè¿™æ—¶å®ƒæ”¶åˆ°çš„æŠ¥æ–‡å¯èƒ½æ¥è‡ªä¸åŒçš„æœåŠ¡å™¨çš„åº”ç­”
        struct sockaddr_in peer;
        socklen_t len = sizeof(peer);
        char buffer[1024];
        ssize_t n = recvfrom(sockfd,buffer,sizeof(buffer)-1,0,(struct sockaddr*)&peer,&len);
        if(n > 0)
        {
            buffer[n] = 0;
            std::cout<<"server echo# "<<buffer<<std::endl;
        }
    }
}

```

#### `Main.cc`

```cpp
#include<iostream>
#include<memory>
#include"UdpServer.hpp"

void Usage(std::string proc)
{
    std::cout<<"Usage:\n\t"<<proc<<" local_ip local_port\n"<<std::endl;
}

//udpserver ip port
int main(int argc,char* argv[])
{
    if(argc != 3)
    {
        Usage(argv[0]);
        exit(USAGE_ERROR);
    }
    std::string ip = argv[1];
    uint16_t port = std::stoi(argv[2]);
    std::unique_ptr<UdpServer> usvr = std::make_unique<UdpServer>(ip,port);//C++14
    usvr->InitServer();
    usvr->Start();
    return 0;
}

```

#### è¿è¡Œæ¼”ç¤º

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/3e4ad5e0e60b40aaa40d122fde31b422.gif)

---

#### é‡è¦çŸ¥è¯†ç‚¹

##### è¿›è¡ŒUDPé€šä¿¡çš„ä¸»è¦æµç¨‹

1. åˆ›å»ºUDP socketå¥—æ¥å­—

```cpp
int sockfd = socket(AF_INET,SOCK_DGRAM,0);

```

2. å¡«å……sockaddr_inç»“æ„

```cpp
struct sockaddr_in local;
bzero(&local,sizeof(local));
local.sin_family = AF_INET;
local.sin_port = htons(port);
local.sin_addr.s_addr = inet_addr(ip.c_str());

```

* portéœ€è¦ç»è¿‡ç½‘ç»œä¼ è¾“ç»™å¯¹é¢ï¼Œæ‰€ä»¥éœ€è¦å°†ä¸»æœºåºåˆ—è½¬åŒ–æˆç½‘ç»œåºåˆ—ï¼šä½¿ç”¨htons;
* æˆ‘ä»¬è¾“å…¥çš„ipåœ°å€æ˜¯ç‚¹åˆ†åè¿›åˆ¶çš„ï¼Œéœ€è¦å°†ç‚¹åˆ†åè¿›åˆ¶çš„ipåœ°å€ï¼Œè½¬åŒ–æˆ4å­—èŠ‚ipï¼šä½¿ç”¨inet_addr;

3. å‘é€æ•°æ®

```cpp
//æ„å»ºç›®æ ‡ä¸»æœºçš„socketä¿¡æ¯
struct sockaddr_in server;
memset(&server,0,sizeof(server));
server.sin_family = AF_INET;
server.sin_port = htons(serverport);
server.sin_addr.s_addr = inet_addr(serverip.c_str());

std::string message;

std::cout<<"Place Enter# ";
std::getline(std::cin,message);
sendto(sockfd,message.c_str(),message.size(),0,(struct sockaddr*)&server,sizeof(server));

```

4. æ¥æ”¶æ•°æ®

```cpp
struct sockaddr_in peer;
socklen_t len = sizeof(peer);//å¿…é¡»åˆå§‹åŒ–æˆä¸ºsizeof(peer)
char buffer[1024];
ssize_t n = recvfrom(sockfd,buffer,sizeof(buffer)-1,0,(struct sockaddr*)&peer,&len);

```

* æ¥æ”¶æ•°æ®æ—¶ï¼šåœ¨æœåŠ¡ç«¯ä¸­ï¼Œæ¥æ”¶çš„ä¸»æœºä¿¡æ¯éœ€è¦æˆ‘ä»¬ä½¿ç”¨ä¹‹å‰åˆ›å»ºä¸€ä¸ªpeerï¼Œç”¨æ¥å­˜å‚¨å‘é€æ–¹çš„ç›¸å…³ä¿¡æ¯ï¼›åœ¨å®¢æˆ·ç«¯ä¸­ï¼Œæˆ‘ä»¬ä¹Ÿéœ€è¦åˆ›å»ºä¸€ä¸ªpeeræ¥æ¥å—ä¸åŒä¸»æœºå‘é€çš„æ•°æ®ã€‚
* å‘é€æ•°æ®æ—¶ï¼šåœ¨æœåŠ¡ç«¯ä¸­ï¼Œå‘é€çš„ä¸»æœºä¿¡æ¯åªéœ€è¦æˆ‘ä»¬ä½¿ç”¨ä¹‹å‰åˆ›å»ºçš„peerï¼Œå› ä¸ºpeerä¸­å°±å­˜æ”¾äº†å‘é€æ–¹çš„ç›¸å…³ä¿¡æ¯ï¼›è€Œå®¢æˆ·ç«¯åˆ™ä¸éœ€è¦ã€‚å› ä¸ºåœ¨æœåŠ¡ç«¯ï¼Œä¼šç»™å¾ˆå¤šä¸åŒçš„å®¢æˆ·ç«¯ä¸»æœºå‘é€æ•°æ®ï¼Œè€Œå®¢æˆ·ç«¯å°±æ˜¯å¯¹æŒ‡å®šçš„æœåŠ¡ç«¯ä¸»æœºå‘é€æ•°æ®ã€‚æ‰€ä»¥å®¢æˆ·ç«¯ä½¿ç”¨sendtoçš„æ—¶å€™ç›´æ¥å¡«å†™æœåŠ¡ç«¯çš„socketä¿¡æ¯å°±å¥½ã€‚
* æ€»ç»“ï¼šæ¥æ”¶æ•°æ®éœ€è¦åˆ›å»ºä¸´æ—¶çš„peeræ¥å­˜å‚¨å‘é€æ–¹çš„IPåœ°å€å’Œç«¯å£å·ç­‰ä¿¡æ¯ï¼›å‘é€æ—¶ç›´æ¥æŒ‡æ˜å³å¯ã€‚

---

### INADDR_ANY

ä¸Šé¢çš„ä»£ç æ˜¯åœ¨æœ¬åœ°ä¸Šè¿›è¡Œçš„ï¼Œé‚£å¦‚æœæˆ‘ä»¬ç»‘å®šè‡ªå·±çš„äº‘æœåŠ¡å™¨ipåœ°å€ï¼Œé‚£æ˜¯ä¸æ˜¯å°±å¯ä»¥è¿›è¡Œè·¨ç½‘ç»œé€šä¿¡äº†å‘¢ï¼Ÿ

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/e762cbecb7a94d84a5286d64df1db557.png)

ä¼šæ˜¾ç¤ºç»‘å®šé”™è¯¯ï¼

è¿™æ˜¯å› ä¸ºæœåŠ¡å™¨ä¸Šçš„IPåœ°å€æ˜¯å‚å•†æä¾›çš„ï¼Œä¸ä¸€å®šæ˜¯çœŸæ­£çš„å…¬ç½‘IPï¼Œå³ä½¿å¯ä»¥ç»‘å®šä¹Ÿä¸å»ºè®®è¿™æ ·åšï¼Œå› ä¸ºæœ‰äº›æœåŠ¡ç«¯ä¸æ­¢ä¸€ä¸ªIPåœ°å€ï¼Œå¯èƒ½æœ‰å¤šä¸ªï¼Œå¦‚æœä½ ç»‘å®šäº†å…¶ä¸­ä¸€ä¸ªï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¹‹åå°±åªèƒ½é€šè¿‡è¿™ä¸ªIPåœ°å€æ¥è®¿é—®æœåŠ¡ç«¯ï¼Œå†…éƒ¨å…¶ä»–çš„IPåœ°å€å°±è®¿é—®ä¸äº†äº†ã€‚

ä¾‹å¦‚ä¸‹å›¾ï¼Œå¦‚æœæˆ‘ä»¬ç»‘å®šäº†111.222.333.444è¿™ä¸ªIPåœ°å€ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±æ— æ³•é€šè¿‡100.200.300.400è¿™ä¸ªIPåœ°å€æ¥è¿›è¡Œè®¿é—®äº†ã€‚

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/9cc24b240dec4298b5b8b8ef223b385b.png)

æ‰€ä»¥æˆ‘ä»¬ä¸€èˆ¬å°†æœåŠ¡ç«¯çš„IPåœ°å€ç»‘å®š
`INADDR_ANY`
,è¿™ä¸ªå°±æ˜¯ä¸€ä¸ªå®ï¼Œå¯¹åº”çš„å€¼ä¸º0ã€‚

### ç®€å•çš„UDPå›å£°ç¨‹åº

#### `UdpServer.hpp`

```cpp
#pragma once
#include<iostream>
#include<cstdlib>
#include<cerrno>
#include<cstring>
#include<cstdio>
#include<strings.h>
#include<string>
#include<unistd.h>
#include<sys/types.h>
#include<sys/socket.h>
#include <netinet/in.h>
#include<arpa/inet.h>
#include"InetAddr.hpp"
//echo server -> client -> server
enum
{
    SOCKET_ERROR = 1,
    BIND_ERROR,
    USAGE_ERROR
};

const static int defaultfd = -1;

class UdpServer
{
public:
    UdpServer(uint16_t port):_sockfd(defaultfd),_port(port),_isrunning(false)
    {}
    void InitServer()
    {
        //1. åˆ›å»ºudp socket å¥—æ¥å­— â€”â€” å¿…é¡»è¦åšçš„ â€”â€” å¯ä»¥ç†è§£æˆå°†ç½‘å¡æ‰“å¼€äº†
        _sockfd = socket(AF_INET,SOCK_DGRAM,0);
        if(_sockfd < 0)
        {
            std::cerr<<"socket failed!\n";
            exit(SOCKET_ERROR);
        }
        std::cout<<"socket create success,sockfd:"<<_sockfd<<std::endl;
        
        //2.0 å¡«å……sockaddr_inç»“æ„
        struct sockaddr_in local;//struct sockaddr_inç³»ç»Ÿæä¾›çš„æ•°æ®ç±»å‹ã€‚localæ˜¯å˜é‡ï¼Œåœ¨ç”¨æˆ·æ ˆä¸Šå¼€è¾Ÿç©ºé—´ã€‚int a = 100;
        bzero(&local,sizeof(local));
        local.sin_family = AF_INET;
        local.sin_port = htons(_port);//portè¦ç»è¿‡ç½‘ç»œä¼ è¾“ç»™å¯¹é¢ï¼Œä¹Ÿå°±æ˜¯è¯´éœ€è¦å…ˆåˆ°ç½‘ç»œï¼Œ_port:ä¸»æœºåºåˆ—->ä¸»æœºåºåˆ—éœ€è¦è½¬æ¢æˆç½‘ç»œåºåˆ—
        //a. å­—ç¬¦ä¸²ç±»å‹çš„ç‚¹åˆ†åè¿›åˆ¶IPåœ°å€è½¬æˆ4å­—èŠ‚IP
        //b. ä¸»æœºåºåˆ—ï¼Œè½¬æˆç½‘ç»œåºåˆ—
        //local.sin_addr.s_addr = inet_addr(_ip.c_str());//"192.168.3.1"->å­—ç¬¦ä¸²é£æ ¼çš„ç‚¹åˆ†åè¿›åˆ¶çš„IPåœ°å€-> 4å­—èŠ‚IP
        local.sin_addr.s_addr = INADDR_ANY;

        //2.1 bind sockfdå’Œç½‘ç»œä¿¡æ¯(IP(?) + Port)
        int n = bind(_sockfd,(struct sockaddr*)&local,sizeof(local));
        if(n < 0)
        {
            std::cerr<<"bind failed!\n";
            exit(BIND_ERROR);
        }
        std::cout<<"socket bind success\n";
    }
    void Start()
    {
        //ä¸€ç›´è¿è¡Œ,æœåŠ¡å™¨éƒ½æ˜¯æ­»å¾ªç¯
        _isrunning = true;
        while(true)
        {
            char buffer[1024];
            struct sockaddr_in peer;
            socklen_t len = sizeof(peer);//å¿…é¡»åˆå§‹åŒ–æˆä¸ºsizeof(peer)
            //1. æˆ‘ä»¬è¦è®©serverå…ˆæ”¶æ•°æ®
            ssize_t n = recvfrom(_sockfd,buffer,sizeof(buffer)-1,0,(struct sockaddr*)&peer,&len);
            if(n > 0)
            {
                buffer[n] = 0;
                InetAddr addr(peer);
                printf("get message from:[%s:%d]:%s\n",addr.IP().c_str(),addr.Port(),buffer);
                //2. æˆ‘ä»¬è¦å°†serveræ”¶åˆ°çš„æ•°æ®ï¼Œå‘å›ç»™å¯¹æ–¹
                sendto(_sockfd,buffer,sizeof(buffer),0,(struct sockaddr*)&peer,len);
            }
        }
        _isrunning = false;
    }
    ~UdpServer()
    {}
private:
    int _sockfd;//æ–‡ä»¶æè¿°ç¬¦
    //std::string _ip;//æš‚æ—¶è¿™æ ·å†™ï¼Œè¿™ä¸ªåœ°æ–¹ä¸æ˜¯å¿…é¡»çš„
    uint16_t _port;//æœåŠ¡å™¨æ‰€ç”¨çš„ç«¯å£å·
    bool _isrunning;//æ˜¯å¦å¯åŠ¨
};

```

#### `Main.cc`

```cpp
#include<iostream>
#include<memory>
#include"UdpServer.hpp"

void Usage(std::string proc)
{
    std::cout<<"Usage:\n\t"<<proc<<" local_port\n"<<std::endl;
}

//./udpserver port
int main(int argc,char* argv[])
{
    if(argc != 2)
    {
        Usage(argv[0]);
        exit(USAGE_ERROR);
    }
    uint16_t port = std::stoi(argv[1]);
    std::unique_ptr<UdpServer> usvr = std::make_unique<UdpServer>(port);//C++14
    usvr->InitServer();
    usvr->Start();
    return 0;
}

```

#### `UdpClient.cc`

```cpp
#include<iostream>
#include<string>
#include<cstdlib>
#include<cstring>
#include<sys/types.h>
#include<sys/socket.h>
#include<netinet/in.h>
#include<arpa/inet.h>

void Usage(std::string proc)
{
    std::cout<<"Usage:\n\t"<<proc<<" local_ip local_port\n";
}

int main(int argc,char* argv[])
{
    if(argc < 3)
    {
        Usage(argv[0]);
        exit(1);
    }
    std::string serverip = argv[1];
    uint16_t serverport = std::stoi(argv[2]);
    
    //1. åˆ›å»ºsocket
    int sockfd = socket(AF_INET,SOCK_DGRAM,0);
    if(sockfd < 0)
    {
        std::cerr<<"socket error"<<std::endl;
    }
    //clientè¦ä¸è¦bindï¼Ÿè¦ã€‚clientä¹Ÿè¦æœ‰è‡ªå·±çš„ipå’Œportï¼Œä½†æ˜¯ä¸éœ€è¦æ˜¾å¼çš„bind
    //a. å¦‚ä½•bindï¼Ÿudp clienté¦–æ¬¡å‘é€æ•°æ®çš„æ—¶å€™ï¼Œosä¼šè‡ªå·±è‡ªåŠ¨éšæœºçš„ç»™clientè¿›è¡Œbind â€”â€” ä¸ºä»€ä¹ˆï¼Ÿ é˜²æ­¢client portå†²çªã€‚ è¦bindï¼Œå¿…ç„¶è¦å’Œportå…³è”èµ·æ¥
    //b. ä»€ä¹ˆæ—¶å€™bindå‘¢ï¼Ÿé¦–æ¬¡å‘é€æ•°æ®çš„æ—¶å€™

    //æ„å»ºç›®æ ‡ä¸»æœºçš„socketä¿¡æ¯
    struct sockaddr_in server;
    memset(&server,0,sizeof(server));
    server.sin_family = AF_INET;
    server.sin_port = htons(serverport);
    server.sin_addr.s_addr = inet_addr(serverip.c_str());

    std::string message;
    //2. ç›´æ¥é€šä¿¡å³å¯
    while(true)
    {
        std::cout<<"Place Enter# ";
        std::getline(std::cin,message);
        sendto(sockfd,message.c_str(),message.size(),0,(struct sockaddr*)&server,sizeof(server));

        // ä¸ä¸€å®šå‘ä¸€å°UDPæœåŠ¡å™¨å‘æ¶ˆæ¯ï¼Œå¯èƒ½æƒ³å¤šå°æœåŠ¡å™¨å‘æ¶ˆæ¯ï¼Œè¿™æ—¶å®ƒæ”¶åˆ°çš„æŠ¥æ–‡å¯èƒ½æ¥è‡ªä¸åŒçš„æœåŠ¡å™¨çš„åº”ç­”
        struct sockaddr_in peer;
        socklen_t len = sizeof(peer);
        char buffer[1024];
        ssize_t n = recvfrom(sockfd,buffer,sizeof(buffer)-1,0,(struct sockaddr*)&peer,&len);
        if(n > 0)
        {
            buffer[n] = 0;
            std::cout<<"server echo# "<<buffer<<std::endl;
        }
    }
    return 0;
}

```

#### è¿è¡Œæ¼”ç¤º

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/350c87a61ea8472782472af497b00867.gif)

#### é‡è¦çŸ¥è¯†ç‚¹

* æœåŠ¡ç«¯ä¸­IPåœ°å€ä¸è¦ç»‘å®šå…·ä½“çš„æŸä¸€ä¸ªï¼Œä½¿ç”¨0å³å¯ã€‚æ‰€ä»¥åœ¨æœåŠ¡ç«¯ï¼ŒIPåœ°å€ä¸æ˜¯å¿…é¡»çš„ï¼Œåªéœ€è¦çŸ¥é“ç«¯å£å·å³å¯ï¼ŒIPåœ°å€ç»Ÿä¸€ç»‘å®š0ã€‚
* å®¢æˆ·ç«¯ä¸­ä¸éœ€è¦æ˜¾å¼çš„ç»‘å®šipå’Œportï¼Œé¿å…å®¢æˆ·ç«¯portå†²çªã€‚åœ¨é¦–æ¬¡å‘é€æ•°æ®æ—¶ï¼ŒOSä¼šè‡ªåŠ¨éšæœºçš„bindã€‚å› ä¸ºå½“æˆ‘ä»¬è‡ªå·±ç»‘å®šä¸€ä¸ªç¡®å®šçš„portä¹‹åï¼Œå¯èƒ½ä¼šå’Œå…¶ä»–çš„å®¢æˆ·ç«¯portå†²çªï¼Œæ¯”å¦‚äº¬ä¸œå®¢æˆ·ç«¯ç»‘å®šçš„æ˜¯8100ï¼Œå¦‚æœæ·˜å®å®¢æˆ·ç«¯æ˜¾å¼çš„ç»‘å®š8100ï¼Œé‚£ä¹ˆä½ æ‰“å¼€äº¬ä¸œçš„æ—¶å€™å°±æ‰“å¼€ä¸äº†æ·˜å®ã€‚æ‰€ä»¥ä¸ºäº†é¿å…è¿™ç§æƒ…å†µï¼ŒOSä¼šå¸®æˆ‘ä»¬ç»‘å®šä¸€ä¸ªæœªä½¿ç”¨çš„portã€‚