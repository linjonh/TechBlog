---
layout: post
title: SQLé¢è¯•é¢˜åº“-No_18-æ¸¸æˆç©æ³•åˆ†æ-III
date: 2024-08-25 16:58:09 +0800
categories: ['Sql']
tags: ['Sql']
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=129787773
    alt: SQLé¢è¯•é¢˜åº“-No_18-æ¸¸æˆç©æ³•åˆ†æ-III
artid: 129787773
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=129787773
featuredImagePreview: https://bing.ee123.net/img/rand?artid=129787773
---

# ã€ŒSQLé¢è¯•é¢˜åº“ã€ No\_18 æ¸¸æˆç©æ³•åˆ†æ III

### ğŸ… 1ã€ä¸“æ ä»‹ç»

ã€ŒSQLé¢è¯•é¢˜åº“ã€æ˜¯ç”±
[ä¸æ˜¯è¥¿çº¢æŸ¿](https://app.yinxiang.com/fx/13ce6bbd-f36f-4e92-be53-92dd381ed729)
å‘èµ·ï¼Œå…¨å‘˜å…è´¹å‚ä¸çš„SQLå­¦ä¹ æ´»åŠ¨ã€‚æˆ‘æ¯å¤©å‘å¸ƒ1é“SQLé¢è¯•çœŸé¢˜ï¼Œä»ç®€å•åˆ°å›°éš¾ï¼Œæ¶µç›–æ‰€æœ‰SQLçŸ¥è¯†ç‚¹ï¼Œæˆ‘æ•¢ä¿è¯åªè¦åšå®Œè¿™100é“é¢˜ï¼Œä¸ä»…èƒ½è½»æ¾æå®šé¢è¯•ï¼Œä»£ç èƒ½åŠ›å’Œå·¥ä½œæ•ˆç‡ä¹Ÿä¼šæœ‰æ˜æ˜¾æå‡ã€‚

#### 1.1 æ´»åŠ¨æµç¨‹

1. **æ•´ç†é¢˜ç›®**
   ï¼šè¥¿çº¢æŸ¿æ¯å¤©æ— è®ºåˆ®é£ä¸‹é›¨ï¼Œä¿è¯åœ¨8am å‰ï¼Œæ›´æ–°ä¸€é“æ–°é²œSQLé¢è¯•çœŸé¢˜ã€‚
2. **ç²‰ä¸æ‰“å¡**
   ï¼šç²‰ä¸ä»¬å¯åœ¨è¯„è®ºåŒºå†™ä¸Šè§£é¢˜æ€è·¯ï¼Œæˆ–è€…ç›´æ¥å®ŒæˆSQLä»£ç ï¼Œæœ‰å›°éš¾çš„å°ä¼™ä¼´ä¸è¦ç€æ€¥ï¼Œå…ˆçœ‹åˆ«äººæ˜¯æ€ä¹ˆè§£é¢˜çš„ï¼Œè¾¹çœ‹è¾¹å­¦ï¼Œä¸æ‡‚å°±é—®æˆ‘ã€‚
3. **äº¤æµè®¨è®º**
   ï¼šä¸ºäº†æ–¹ä¾¿äº¤æµè®¨è®ºï¼Œå¯è¿›å…¥
   [æ•°æ®ä»“åº“](https://app.yinxiang.com/fx/13ce6bbd-f36f-4e92-be53-92dd381ed729)
   ã€‚
4. **æ´»åŠ¨å¥–åŠ±**
   ï¼šæˆ‘æ¯å¤©éƒ½ä¼šçœ‹è¯„è®ºåŒºå’Œç¾¤é‡Œçš„å†…å®¹ï¼Œå¯¹äºç§¯æå­¦ä¹ å’Œçƒ­å¿ƒè§£ç­”é—®é¢˜çš„å°ä¼™ä¼´ï¼Œçº¢åŒ…é¼“åŠ±ï¼Œä»¥è¥é€ æ›´å¥½çš„å­¦ä¹ æ°›å›´ã€‚

#### 1.2 ä½ çš„æ”¶è·

1. **å¢å¼ºè‡ªä¿¡ï¼Œæå®šé¢è¯•**
   ï¼šåœ¨æ±‚èŒä¸­ï¼ŒSQLæ˜¯ç»å¸¸é‡åˆ°çš„æŠ€èƒ½ç‚¹ï¼Œè€Œè¿™äº›é¢˜ç›®ä¹Ÿå¤šæ•°æ˜¯çœŸå®çš„é¢è¯•é¢˜ï¼Œåˆ·é¢˜å¯ä»¥è®©æˆ‘ä»¬æ›´å¥½åœ°å¤‡æˆ˜é¢è¯•ï¼Œå¢å¼ºè‡ªä¿¡ï¼Œæå‡è‡ªå·±çš„æ ¸å¿ƒç«äº‰åŠ›ã€‚
2. **å·©å›ºSQLè¯­æ³•ï¼Œé«˜æ•ˆæå®šå·¥ä½œ**
   ï¼šé€šè¿‡ä¸æ–­ç»ƒä¹ ï¼Œèƒ½å¤Ÿç†Ÿæ‚‰SQLçš„è¯­æ³•å’Œå¸¸ç”¨å‡½æ•°ï¼ŒæŒæ¡SQLæ ¸å¿ƒçŸ¥è¯†ç‚¹ï¼Œæé«˜SQLç¼–å†™èƒ½åŠ›ã€‚ä»£ç èƒ½åŠ›æå‡äº†ï¼Œå·¥ä½œæ•ˆç‡è‡ªç„¶é«˜äº†ã€‚
3. **æé«˜æ•°æ®å¤„ç†èƒ½åŠ›ã€é”»ç‚¼æ€ç»´èƒ½åŠ›**
   ï¼šSQLæ˜¯æ•°æ®å¤„ç†çš„æ ¸å¿ƒå·¥å…·ï¼Œé€šè¿‡åˆ·é¢˜å¯ä»¥è®©æˆ‘ä»¬æ›´å¥½åœ°ç†è§£æ•°æ®å¤„ç†çš„è¿‡ç¨‹ï¼Œæé«˜æ•°æ®åˆ†æçš„æ•ˆç‡ã€‚SQLé¢˜ç›®çš„éš¾åº¦ä¸ä¸€ï¼Œéœ€è¦åœ¨ä¸€å®šæ—¶é—´å†…è§£å†³é—®é¢˜ï¼ŒåŸ¹å…»äº†æˆ‘ä»¬å¯¹é—®é¢˜çš„æ€è€ƒèƒ½åŠ›ã€è§£å†³é—®é¢˜çš„èƒ½åŠ›å’Œå¯¹æ—¶é—´çš„æŠŠæ§èƒ½åŠ›ç­‰ã€‚

### ğŸ… 2ã€ä»Šæ—¥çœŸé¢˜

é¢˜ç›®ä»‹ç»ï¼š æ¸¸æˆç©æ³•åˆ†æ III game-play-analysis-iii

éš¾åº¦ä¸­ç­‰20æ”¶è—åˆ†äº«åˆ‡æ¢ä¸ºè‹±æ–‡å…³æ³¨åé¦ˆ

SQLæ¶æ„

Table:

```latex
Activity

```

```latex
+--------------+---------+
| Column Name  | Type    |
+--------------+---------+
| player_id    | int     |
| device_id    | int     |
| event_date   | date    |
| games_played | int     |
+--------------+---------+
ï¼ˆplayer_idï¼Œevent_dateï¼‰æ˜¯æ­¤è¡¨çš„ä¸»é”®ã€‚
è¿™å¼ è¡¨æ˜¾ç¤ºäº†æŸäº›æ¸¸æˆçš„ç©å®¶çš„æ´»åŠ¨æƒ…å†µã€‚
æ¯ä¸€è¡Œæ˜¯ä¸€ä¸ªç©å®¶çš„è®°å½•ï¼Œä»–åœ¨æŸä¸€å¤©ä½¿ç”¨æŸä¸ªè®¾å¤‡æ³¨é”€ä¹‹å‰ç™»å½•å¹¶ç©äº†å¾ˆå¤šæ¸¸æˆï¼ˆå¯èƒ½æ˜¯ 0 ï¼‰ã€‚

```

ç¼–å†™ä¸€ä¸ª SQL æŸ¥è¯¢ï¼ŒåŒæ—¶æŠ¥å‘Šæ¯ç»„ç©å®¶å’Œæ—¥æœŸï¼Œä»¥åŠç©å®¶åˆ°ç›®å‰ä¸ºæ­¢ç©äº†å¤šå°‘æ¸¸æˆã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨æ­¤æ—¥æœŸä¹‹å‰ç©å®¶æ‰€ç©çš„æ¸¸æˆæ€»æ•°ã€‚è¯¦ç»†æƒ…å†µè¯·æŸ¥çœ‹ç¤ºä¾‹ã€‚

æŸ¥è¯¢ç»“æœæ ¼å¼å¦‚ä¸‹æ‰€ç¤ºï¼š

``` Activity table: +-----------+-----------+------------+--------------+ | player\_id | device\_id | event\_date | games\_played | +-----------+-----------+------------+--------------+ | 1 | 2 | 2016-03-01 | 5 | | 1 | 2 | 2016-05-02 | 6 | | 1 | 3 | 2017-06-25 | 1 | | 3 | 1 | 2016-03-02 | 0 | | 3 | 4 | 2018-07-03 | 5 | +-----------+-----------+------------+--------------+

Result table: +-----------+------------+---------------------+ | player\_id | event\_date | games\_played\_so\_far | +-----------+------------+---------------------+ | 1 | 2016-03-01 | 5 | | 1 | 2016-05-02 | 11 | | 1 | 2017-06-25 | 12 | | 3 | 2016-03-02 | 0 | | 3 | 2018-07-03 | 5 | +-----------+------------+---------------------+ å¯¹äº ID ä¸º 1 çš„ç©å®¶ï¼Œ2016-05-02 å…±ç©äº† 5+6=11 ä¸ªæ¸¸æˆï¼Œ2017-06-25 å…±ç©äº† 5+6+1=12 ä¸ªæ¸¸æˆã€‚ å¯¹äº ID ä¸º 3 çš„ç©å®¶ï¼Œ2018-07-03 å…±ç©äº† 0+5=5 ä¸ªæ¸¸æˆã€‚ è¯·æ³¨æ„ï¼Œå¯¹äºæ¯ä¸ªç©å®¶ï¼Œæˆ‘ä»¬åªå…³å¿ƒç©å®¶çš„ç™»å½•æ—¥æœŸã€‚ ```

å¼€çª—

```latex
sql
select player_id,event_date ,
sum(games_played) over(partition by player_id order by  event_date )games_played_so_far
from Activity

```

è‡ªè¿æ¥

```latex
sql
select 
    a1.player_id,
    a1.event_date,
    sum(a2.games_played) games_played_so_far
from Activity a1,Activity a2
where a1.player_id=a2.player_id and 
      a1.event_date>=a2.event_date
group by 1,2;

```

* å·²ç»æœ‰çµæ„Ÿäº†ï¼Ÿåœ¨è¯„è®ºåŒºå†™ä¸‹ä½ çš„æ€è·¯å§ï¼