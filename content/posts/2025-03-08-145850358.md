---
layout: post
title: "MybatisPlus"
date: 2025-03-08 16:00:09 +0800
description: "用Sevice就可以做到对数据库的操作，非常的厉害，他的底层就是去调了userMapper的接口5.代码生成在使用MybatisPlus以后，基础的MapperServicePO代码相对固定，重复编写也比较麻烦。因此MybatisPlus官方提供了代码生成器根据数据库表结构生成POMapperService等相关代码。只不过代码生成器同样要编码使用，也很麻烦。这里推荐大家使用一款的插件，它可以基于图形化界面完成的代码生成，非常简单。3.1.1.安装插件在Idea的plugins市场中搜索并安装。"
keywords: "MybatisPlus"
categories: ['未分类']
tags: ['服务器', '前端', 'Java']
artid: "145850358"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=145850358
    alt: "MybatisPlus"
render_with_liquid: false
featuredImage: https://bing.ee123.net/img/rand?artid=145850358
featuredImagePreview: https://bing.ee123.net/img/rand?artid=145850358
cover: https://bing.ee123.net/img/rand?artid=145850358
image: https://bing.ee123.net/img/rand?artid=145850358
img: https://bing.ee123.net/img/rand?artid=145850358
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     MybatisPlus
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <h2>
     1.增删改查入门案例：
    </h2>
    <p>
     首先导入依赖：
    </p>
    <pre><code class="language-java">        &lt;dependency&gt;
            &lt;groupId&gt;com.baomidou&lt;/groupId&gt;
            &lt;artifactId&gt;mybatis-plus-boot-starter&lt;/artifactId&gt;
            &lt;version&gt;3.5.3.1&lt;/version&gt;
        &lt;/dependency&gt;</code></pre>
    <p>
     然后这些增删改查的方法就可以删掉了 （注意这里只能是单表查询，多表查询不适用）
    </p>
    <p>
     Mapper层：
    </p>
    <p>
     <img alt="" height="349" src="https://i-blog.csdnimg.cn/direct/5c7f6d7a197c481ea3ea1a2e58c2c9d7.png" width="566"/>
    </p>
    <p>
     xml文件：
    </p>
    <p>
     <img alt="" height="937" src="https://i-blog.csdnimg.cn/direct/9596cf4424cf430184a6edc87a273a03.png" width="1271"/>
    </p>
    <p>
     删完之后，在测试方法中找到提示词提示的方法进行填充就好了
    </p>
    <p>
     比如这个查询方法
    </p>
    <p>
     <img alt="" height="486" src="https://i-blog.csdnimg.cn/direct/ee3511610adb45998c227c0e3cc059eb.png" width="1020"/>
    </p>
    <p>
     运行一下方法：
    </p>
    <p>
     <img alt="" height="228" src="https://i-blog.csdnimg.cn/direct/dead2e22bb584e86ab5f7d52cec12c3c.png" width="1327"/>
    </p>
    <h3>
     1.2：常用注解：
    </h3>
    <p>
     <img alt="" height="1080" src="https://i-blog.csdnimg.cn/direct/cda05bb6116044e5aef80698dd438c9a.jpeg" width="1728"/>
    </p>
    <h4>
    </h4>
    <p>
     MybatisPlus 中比较常用的几个注解如下：
    </p>
    <blockquote>
     <ul>
      <li>
       @TableName：用来指定表名
      </li>
      <li>
       @TableId：用来指定表中的主键字段信息
      </li>
      <li>
       @TableField：用来指定表中的普通字段信息
      </li>
     </ul>
    </blockquote>
    <h4>
     IdType 枚举：
    </h4>
    <blockquote>
     <ul>
      <li>
       AUTO：数据库自增长
      </li>
      <li>
       INPUT：通过 set 方法自行输入
      </li>
      <li>
       ASSIGN_ID：分配 ID，按 IdentifierGenerator 的方法 nextId 来生成 id，默认实现类为 DefaultIdentifierGenerator 雪花算法
      </li>
     </ul>
    </blockquote>
    <h4>
     使用 @TableField 的常见场景：
    </h4>
    <blockquote>
     <ul>
      <li>
       成员变量名与数据库字段名不一致
      </li>
      <li>
       成员变量名以 is 开头，且是布尔值
      </li>
      <li>
       成员变量名与数据库关键字冲突
      </li>
      <li>
       成员变量不是数据库字段
      </li>
     </ul>
    </blockquote>
    <p>
     代码示例：
    </p>
    <pre><code class="language-java">@TableName("tb_user")
public class User {
    @TableId(value = "id", type = IdType.AUTO)
    private Long id;
    @TableField("username")
    private String name;
    @TableField("is_married")
    private Boolean isMarried;
    @TableField("order")
    private Integer order;
    @TableField(exist = false)
    private String address;
}
</code></pre>
    <p>
     表结构信息：
    </p>
    <table>
     <thead>
      <tr>
       <th>
        名称
       </th>
       <th>
        数据类型
       </th>
       <th>
        注释
       </th>
       <th>
        默认值
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        id
       </td>
       <td>
        BIGINT
       </td>
       <td>
        用户 id
       </td>
       <td>
        AUTO_INCREMENT
       </td>
      </tr>
      <tr>
       <td>
        username
       </td>
       <td>
        VARCHAR
       </td>
       <td>
        用户名
       </td>
       <td>
        无默认值
       </td>
      </tr>
      <tr>
       <td>
        is_married
       </td>
       <td>
        BIT
       </td>
       <td>
        密码
       </td>
       <td>
        0
       </td>
      </tr>
      <tr>
       <td>
        order
       </td>
       <td>
        TINYINT
       </td>
       <td>
        序号
       </td>
       <td>
        NULL
       </td>
      </tr>
     </tbody>
    </table>
    <h2>
    </h2>
    <h2>
     2.条件构造器
    </h2>
    <p>
     <img alt="" height="407" src="https://i-blog.csdnimg.cn/direct/1361336b46fc4cd5b17b9c6fed9017c3.png" width="1091"/>
    </p>
    <h4>
     QueryWrapper和UpdateWrapper的用法
    </h4>
    <p>
     这是原来的mybatis查询语句：
    </p>
    <p>
     <img alt="" height="731" src="https://i-blog.csdnimg.cn/direct/7dd63185137543fbb0a24bd2abf5acdd.png" width="1284"/>
    </p>
    <p>
     这是mybatis-plus的查询语句：
    </p>
    <p>
     <img alt="" height="308" src="https://i-blog.csdnimg.cn/direct/36019978243a4820b1cf63d2f19bc5f0.png" width="761"/>
    </p>
    <p>
     查询结果：
    </p>
    <p>
     <img alt="" height="112" src="https://i-blog.csdnimg.cn/direct/932bf10f0cab416e97d39b8723ee18d5.png" width="1355"/>
     <img alt="" height="306" src="https://i-blog.csdnimg.cn/direct/33c7d3500ea04eadb1c3d1b14e0aa7cc.png" width="600"/>
    </p>
    <p>
     查询结果：
    </p>
    <p>
     <img alt="" height="160" src="https://i-blog.csdnimg.cn/direct/8d2c62e4f0924d5eb8e0ff3bbadbc9ac.png" width="1290"/>
    </p>
    <p>
    </p>
    <p>
     <strong>
      问题：可是刚才的更新操作是把更新的值给写死了，碰到下面的问题那我们就要用一种新的方法
     </strong>
    </p>
    <p>
     <img alt="" height="194" src="https://i-blog.csdnimg.cn/direct/256504fb7a594a1a80af7b6cb122f135.png" width="514"/>
    </p>
    <p>
     <img alt="" height="315" src="https://i-blog.csdnimg.cn/direct/bdb3f0510c5e4f4bbedab7d03cdab357.png" width="651"/>
    </p>
    <p>
    </p>
    <p>
     <strong>
      问题：上面的那些其实都是把字段写死的硬编码，我们就用到了lambdaQueryWeapper
     </strong>
    </p>
    <p>
     <img alt="" height="312" src="https://i-blog.csdnimg.cn/direct/cbd56f7f74a04e21955e93731904c1ae.png" width="927"/>
    </p>
    <p>
     <img alt="" height="112" src="https://i-blog.csdnimg.cn/direct/2c13fad95b0c490492c8654679585373.png" width="927"/>
    </p>
    <h2>
     3.自定义Sql
    </h2>
    <p>
     <img alt="" height="907" src="https://i-blog.csdnimg.cn/direct/d45a6a6e50304085a10b9c6f7282eeac.png" width="1783"/>
    </p>
    <p>
     <img alt="" height="927" src="https://i-blog.csdnimg.cn/direct/850cf80f9cd44e92b86498971a0199ca.png" width="1696"/>
    </p>
    <h2>
    </h2>
    <h2>
     4.Service接口
    </h2>
    <h4>
     service接口的继承关系
    </h4>
    <p>
     <img alt="" height="840" src="https://i-blog.csdnimg.cn/direct/d3f51fe65a6548869e779f5d6f16f49b.png" width="1676"/>
    </p>
    <p>
     <img alt="" height="717" src="https://i-blog.csdnimg.cn/direct/ddca112e41df4992bf144d286b9b18b3.png" width="1103"/>
     <img alt="" height="471" src="https://i-blog.csdnimg.cn/direct/2be6bc0a903f4f7fb0435ee17b03ca28.png" width="1008"/>
    </p>
    <p>
     用Sevice就可以做到对数据库的操作，非常的厉害，他的底层就是去调了userMapper的接口
    </p>
    <p>
    </p>
    <h3>
     <strong>
      5.代码生成
     </strong>
    </h3>
    <p>
     在使用MybatisPlus以后，基础的
     <code>
      Mapper
     </code>
     、
     <code>
      Service
     </code>
     、
     <code>
      PO
     </code>
     代码相对固定，重复编写也比较麻烦。因此MybatisPlus官方提供了代码生成器根据数据库表结构生成
     <code>
      PO
     </code>
     、
     <code>
      Mapper
     </code>
     、
     <code>
      Service
     </code>
     等相关代码。只不过代码生成器同样要编码使用，也很麻烦。
    </p>
    <p>
     这里推荐大家使用一款
     <code>
      MybatisPlus
     </code>
     的插件，它可以基于图形化界面完成
     <code>
      MybatisPlus
     </code>
     的代码生成，非常简单。
    </p>
    <h4>
     <strong>
      3.1.1.安装插件
     </strong>
    </h4>
    <p>
     在
     <code>
      Idea
     </code>
     的plugins市场中搜索并安装
     <code>
      MyBatisPlus
     </code>
     插件：
    </p>
    <h4>
     <strong>
      3.1.2.使用
     </strong>
    </h4>
    <p>
     刚好数据库中还有一张address表尚未生成对应的实体和mapper等基础代码。我们利用插件生成一下。 首先需要配置数据库地址，在Idea顶部菜单中，找到
     <code>
      other
     </code>
     ，选择
     <code>
      Config Database
     </code>
     ：
    </p>
    <p>
     <img alt="" height="752" src="https://i-blog.csdnimg.cn/direct/c18e93a49e4447acaca645ae69e231f8.png" width="1046"/>
    </p>
    <h3 style="background-color:transparent">
     <strong>
      3.3.
     </strong>
     <strong>
      逻辑删除
     </strong>
    </h3>
    <p>
     对于一些比较重要的数据，我们往往会采用逻辑删除的方案，即：
    </p>
    <ul>
     <li>
      <p>
       在表中添加一个字段标记数据是否被删除
      </p>
     </li>
     <li>
      <p>
       当删除数据时把标记置为true
      </p>
     </li>
     <li>
      <p>
       查询时过滤掉标记为true的数据
      </p>
     </li>
    </ul>
    <p>
     一旦采用了逻辑删除，所有的查询和删除逻辑都要跟着变化，非常麻烦。
    </p>
    <p>
     为了解决这个问题，MybatisPlus就添加了对逻辑删除的支持。
    </p>
    <p>
     <strong>
      注意
     </strong>
     ，只有MybatisPlus生成的SQL语句才支持自动的逻辑删除，自定义SQL需要自己手动处理逻辑删除。
    </p>
    <p>
     例如，我们给
     <code>
      address
     </code>
     表添加一个逻辑删除字段：
    </p>
    <pre><code class="language-sql">alter table address add deleted bit default b'0' null comment '逻辑删除';</code></pre>
    <p>
     然后给
     <code>
      Address
     </code>
     实体添加
     <code>
      deleted
     </code>
     字段：
    </p>
    <p>
     <img alt="" height="565" src="https://i-blog.csdnimg.cn/direct/ccf9c1bf5a584c7895d38e5ef8b3aa2d.png" width="1016"/>
    </p>
    <p>
     接下来，我们要在
     <code>
      application.yml
     </code>
     中配置逻辑删除字段：
    </p>
    <pre><code class="language-XML">mybatis-plus:
  global-config:
    db-config:
      logic-delete-field: deleted # 全局逻辑删除的实体字段名(since 3.3.0,配置后可以忽略不配置步骤2)
      logic-delete-value: 1 # 逻辑已删除值(默认为 1)
      logic-not-delete-value: 0 # 逻辑未删除值(默认为 0)</code></pre>
    <p>
     测试： 首先，我们执行一个删除操作：
    </p>
    <pre><code class="language-java">@Test
void testDeleteByLogic() {
    // 删除方法与以前没有区别
    addressService.removeById(59L);
}</code></pre>
    <p>
     方法与普通删除一模一样，但是底层的SQL逻辑变了：
    </p>
    <p>
     <img alt="" height="743" src="https://i-blog.csdnimg.cn/direct/8c4411a6e38c4c4e8e9d88178b39173a.png" width="1034"/>
    </p>
    <p>
     综上， 开启了逻辑删除功能以后，我们就可以像普通删除一样做CRUD，基本不用考虑代码逻辑问题。还是非常方便的。
    </p>
    <p>
     <strong>
      注意
     </strong>
     ： 逻辑删除本身也有自己的问题，比如：
    </p>
    <ul>
     <li>
      <p>
       会导致数据库表垃圾数据越来越多，从而影响查询效率
      </p>
     </li>
     <li>
      <p>
       SQL中全都需要对逻辑删除字段做判断，影响查询效率
      </p>
     </li>
    </ul>
    <p>
     因此，我不太推荐采用逻辑删除功能，如果数据不能删除，可以采用把数据迁移到其它表的办法。
    </p>
    <p>
    </p>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f:672e6373646e2e6e65742f323330315f37383530363138302f:61727469636c652f64657461696c732f313435383530333538" class_="artid" style="display:none">
 </p>
</div>


