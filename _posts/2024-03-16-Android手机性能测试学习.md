---
layout: post
title: 2024-03-16-Android手机性能测试学习
date: 2024-03-16 19:15:00 +0800
categories: []
tags: [智能手机,学习]
image:
  path: https://api.vvhan.com/api/bing?rand=sj&artid=136761979
  alt: Android手机性能测试学习
artid: 136761979
render_with_liquid: false
---
<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     Android手机性能测试学习
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <p>
     手机性能测试会涉及如下方面
    </p>
    <ol>
     <li>
      <p>
       <strong>
        CPU性能
       </strong>
       ：测试手机的处理器性能，包括单核和多核性能。这可以通过运行CPU密集型任务或基准测试应用程序来评估。
      </p>
     </li>
     <li>
      <p>
       <strong>
        内存性能
       </strong>
       ：测试手机的内存管理和性能，包括内存读写速度、内存占用情况和内存泄漏检测等。
      </p>
     </li>
     <li>
      <p>
       <strong>
        存储性能
       </strong>
       ：测试手机的存储设备，包括读写速度、文件传输速度和存储容量等。
      </p>
     </li>
     <li>
      <p>
       <strong>
        图形性能
       </strong>
       ：测试手机的GPU性能，包括图形渲染速度、游戏性能和视频播放性能等。
      </p>
     </li>
     <li>
      <p>
       <strong>
        网络性能
       </strong>
       ：测试手机的网络连接性能，包括Wi-Fi连接速度、移动网络速度和网络稳定性等。
      </p>
     </li>
     <li>
      <p>
       <strong>
        电池性能
       </strong>
       ：测试手机的电池续航能力和充电速度，包括待机时间、使用时间和充电时间等。
      </p>
     </li>
     <li>
      <p>
       <strong>
        传感器性能
       </strong>
       ：测试手机的各种传感器性能，如加速度计、陀螺仪、光传感器等，以确保它们的准确性和响应性。
      </p>
     </li>
     <li>
      <p>
       <strong>
        应用性能
       </strong>
       ：测试手机在运行各种应用程序时的性能表现，包括启动速度、响应时间和多任务处理能力等。
      </p>
     </li>
    </ol>
    <p>
     这些方面的性能测试可以通过使用专门的性能测试工具、基准测试应用程序或自定义测试脚本来进行。通过全面测试手机的性能，可以评估其在各方面的表现，为用户提供更好的使用体验。
    </p>
    <p>
     同时转载了一部分内容：
     <a href="https://www.cnblogs.com/lc-blogs/p/17152724.html" rel="nofollow" title="https://www.cnblogs.com/lc-blogs/p/17152724.html">
      https://www.cnblogs.com/lc-blogs/p/17152724.html
     </a>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       <strong>
        本文围绕以下性能指标介绍测试Android端的测试方法：
       </strong>
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       启动时间：启动APP所需时间
       <br/>
       流畅度：也称为帧率FPS，指画面每秒传输帧数；帧率越大，页面越流畅。
       <br/>
       过渡绘制：过度绘制描述的是屏幕上的某个像素在同一帧的时间内被绘制了多次。
       <br/>
       内存：占用系统内存的大小
       <br/>
       CPU：对系统CPU的占用率
       <br/>
       流量：流量消耗
       <br/>
       电量：电量消耗
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       <strong>
        性能标准及Android如何获取数据
       </strong>
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       <strong>
        1. CPU
       </strong>
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       CPU测试，主要关注的是cpu的占用率。很多时候，我们玩手机时，会出现发热发烫，那是因为CPU使用率过高，CPU过于繁忙，会使整个手机无法响应用户，整体性能降低，用户体验就会很差，也容易引起ANR（application not responding, 主线程(UI线程)如果在规定时内没有处理完相应工作，就会出现ANR）等等一系列问题。
      </span>
     </span>
    </p>
    <ul style="margin-left:20px;">
     <li>
      静态不超过5%，后台静默不超过1%，一般运行状态不超过30%，高负荷运行不超过75%，峰值不超过90%；
     </li>
    </ul>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       <strong>
        1.1 数据获取
       </strong>
      </span>
     </span>
    </p>
    <ul style="margin-left:20px;">
     <li>
      每隔1s获取对应app的cpu占用
     </li>
     <li>
      <code>
       adb shell "top –d 1 | grep &lt;pakagename | pid&gt;"
      </code>
      <br/>
      top cpu 参数：
      <br/>
      -m 显示最大数
      <br/>
      -s 按指定行排序
      <br/>
      -t 显示进程名称
      <br/>
      -n 在退出前刷新几次
      <br/>
      -d 刷新间隔
     </li>
    </ul>
    <p style="margin-left:auto;text-align:left;">
    </p>
    <p class="img-center">
     <a href="https://img2023.cnblogs.com/blog/3066827/202302/3066827-20230227111224538-75434051.png" rel="nofollow">
      <img alt="" height="320" src="https://i-blog.csdnimg.cn/blog_migrate/d98170ee4767e7b223092033db91458d.png" width="619"/>
     </a>
    </p>
    <ul style="margin-left:20px;">
     <li>
      <code>
       adb shell "dumpsys cpuinfo | grep &lt;pakagename | pid&gt;"
      </code>
     </li>
    </ul>
    <p style="margin-left:auto;text-align:left;">
    </p>
    <p class="img-center">
     <a href="https://img2023.cnblogs.com/blog/3066827/202302/3066827-20230227111328342-192502851.png" rel="nofollow">
      <img alt="" height="46" src="https://i-blog.csdnimg.cn/blog_migrate/97f00c03f43b6850a646c5d772a51114.png" width="646"/>
     </a>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       美团app占用总cpu的51%，在用户（user）中花32%的时间，并在内核空间（kernel）花费18%的时间
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       <span style="color:#ff0000;">
        注：两种方法直接区别在于，top是持续监控状态，而dumpsys cpuinfo获取的实时CPU占用率数据
       </span>
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       <strong>
        1.2 cpu检测的几种情况
       </strong>
      </span>
     </span>
    </p>
    <ol style="margin-left:0;">
     <li>
      空闲状态下的应用CPU消耗情况（程序运行后按home键挂后台）
     </li>
     <li>
      中等规格状态下的应用CPU消耗情况（程序执行普通操作时的cpu占用）
     </li>
     <li>
      中等规格状态下长时间的应用CPU消耗情况
     </li>
     <li>
      满规格状态下的应用CPU消耗情况
     </li>
     <li>
      针对性的场景测试
     </li>
    </ol>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       例如对软件使用较多的场景进行测试
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       <strong>
        1.3 测试点：
       </strong>
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       1）在空闲时间(切换至后台)的消耗，基本没大应用使用cpu
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       2）在运行一些应用的情况下，cpu已占50%的情况下，观察应用程序占用cpu的情况
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       3）在高负荷的情况下看CPU的表现（cpu占用应是在80%以上）
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       <strong>
        1.4 具体场景：
       </strong>
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       1、应用空闲状态运行监测CPU占用率
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       空闲状态：应用按Home键退到后台，不再占用系统的状态（通常是灭屏半分钟后）
       <br/>
       CPU占用率=0%
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       2、应用中等规格运行监测CPU占用率
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       中等规格：模拟用户最常见的使用场景
       <br/>
       CPU占用率≤30%
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       3、应用满规格长时间正常运行监测CPU占用率
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       Monkey测试
       <br/>
       CPU占用率≤30%
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       4、应用正常运行期间监测CPU占用率峰值
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       应用正常运行：打开应用进行基本操作
       <br/>
       CPU占用率≤50%
      </span>
     </span>
    </p>
    <p>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       <strong>
        2. 内存
       </strong>
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       在Android系统中，每个APP进程除了同其他进程共享内存(shared dirty)外，还独用私有内存(private dirty)，通常我们使用PSS(私有内存+比例分配共享内存)来衡量一个APP的内存开销。由于一个移动设备的内存是固定的，如果内存消耗过大就会造成应用卡顿或者闪退，需要对内存进行测试。正常情况下，应用不应占用过多的内存资源，且能够及时释放内存，保证整个应用内的稳定性和流畅性。
      </span>
     </span>
    </p>
    <ul style="margin-left:20px;">
     <li>
      操作单次申请pss内存超过50M需查看是否合理，java堆内存单次操作申请内存不超过20M；
     </li>
     <li>
      不存在内存抖动问题，频繁GC；
     </li>
     <li>
      不存在内存持续增长问题，内存泄漏；
     </li>
     <li>
      不存在一段时间内存持续增长后无法释放问题，如位图未释放或重复缓存；
     </li>
     <li>
      返回mainActivity后不存在其他Activity实例；
     </li>
     <li>
      hprof（内存快照），只可分析java层泄漏
     </li>
    </ul>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       <strong>
        内存说明
       </strong>
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       VSS - Virtual Set Size 虚拟耗用内存（包含共享库占用的内存）
       <br/>
       RSS - Resident Set Size 实际使用物理内存（包含共享库占用的内存）
       <br/>
       PSS - Proportional Set Size 实际使用的物理内存（比例分配共享库占用的内存）
       <br/>
       USS - Unique Set Size 进程独自占用的物理内存（不包含共享库占用的内存）
       <br/>
       一般来说内存占用大小有如下规律：VSS &gt;= RSS &gt;= PSS &gt;= USS
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       <strong>
        adb 查看单个内存占用量
       </strong>
      </span>
     </span>
    </p>
    <ol style="margin-left:0;">
     <li>
      单个应用的最大内存限制
     </li>
    </ol>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       <code>
        adb shell "getprop | grep heapgrowthlimit"
       </code>
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
    </p>
    <p class="img-center">
     <a href="https://img2023.cnblogs.com/blog/3066827/202302/3066827-20230227110738141-702176026.png" rel="nofollow">
      <img alt="" height="46" src="https://i-blog.csdnimg.cn/blog_migrate/2d54a346a8a9e7790be98e9e8a53b19e.png" width="531"/>
     </a>
    </p>
    <ol style="margin-left:0;">
     <li>
      应用启动后分配的初始内存
     </li>
    </ol>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       <code>
        adb shell "getprop | grep dalvik.vm.heapstartsize"
       </code>
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
    </p>
    <p class="img-center">
     <a href="https://img2023.cnblogs.com/blog/3066827/202303/3066827-20230301112442087-979440063.png" rel="nofollow">
      <img alt="" height="47" src="https://i-blog.csdnimg.cn/blog_migrate/a8c7ffd1e9280a467ed166adcd1c5d07.png" width="592"/>
     </a>
    </p>
    <ol style="margin-left:0;">
     <li>
      单个java虚拟机的最大内存限制
     </li>
    </ol>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       <code>
        adb shell "getprop | grep dalvik.vm.heapsize"
       </code>
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
    </p>
    <p class="img-center">
     <a href="https://img2023.cnblogs.com/blog/3066827/202303/3066827-20230301112313237-1768843179.png" rel="nofollow">
      <img alt="" height="46" src="https://i-blog.csdnimg.cn/blog_migrate/fe7951f3627db02ea49b072f9b860bbf.png" width="561"/>
     </a>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       <strong>
        2.1 数据获取
       </strong>
       <br/>
       获取对应app的内存占用（packagename【包名】或pid【进程id】两个参数二选一）
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       <code>
        adb shell "dumpsys meminfo &lt;pakagename | pid&gt;"
       </code>
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       输出结果分以下4部分:
      </span>
     </span>
    </p>
    <ol style="margin-left:0;">
     <li>
      process 以进程的PSS从大到小依次排序显示，每行显示一个进程；
     </li>
     <li>
      OOM adjustment 分别显示每类的进程情况
     </li>
     <li>
      category 以Dalvik/Native/.art mmap/.dex map等划分的各类进程的总PSS情况
     </li>
     <li>
      total 总内存、剩余内存、可用内存、其他内存
     </li>
    </ol>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       执行结果如下图，重点取该应用的 TOTAL 对应的内存占用大小（KB）
      </span>
     </span>
    </p>
    <p class="img-center">
     <a href="https://img2023.cnblogs.com/blog/3066827/202302/3066827-20230227150307712-1116969228.png" rel="nofollow">
      <img alt="" height="790" src="https://i-blog.csdnimg.cn/blog_migrate/902aee6a3a70e5dab39295b93ea0072f.png" width="955"/>
     </a>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       <strong>
        2.2 内存检测的几种情况
       </strong>
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       (1) 空闲状态下的应用内存消耗情况（程序运行后按home键挂后台）
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       (2) 中等规格状态下的应用内存消耗情况（注意查看是否申请的内存过大）
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       (3) 满规格状态下的应用内存消耗情况
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       (4) 针对性的场景测试
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       较容易出现内存泄漏的部分场景：
      </span>
     </span>
    </p>
    <ul style="margin-left:20px;">
     <li>
      <p style="margin-left:auto;">
       activity间的切换，只要非静态的匿名类对象没有被回收，MainActivity就不会被回收，MainActivity所关联的资源和视图都不会被回收，发生比较严重的内存泄漏。
      </p>
     </li>
     <li>
      <p style="margin-left:auto;">
       连续查看和发送大图片，不断反复观看返回继续观看等操作，都有可能因为和之前的内存资源没释放而导致内存不断增长。
      </p>
     </li>
     <li>
      <p style="margin-left:auto;">
       有执行异步线程的场景后如果未给线程进行结束，会引起内存泄漏，因为activity的结束销毁不会把正在运行的thraead也结束回收掉。比如后台下载或加载东西时关闭activity。
      </p>
     </li>
     <li>
      <p style="margin-left:auto;">
       在activity关闭时Handler还没结束，会到导致内存泄漏。例如一些界面UI还在刷新时关闭activity。
      </p>
     </li>
     <li>
      <p style="margin-left:auto;">
       从登录界面登录账号后，登录界面的activity只是退到后台或是被登录后的activity覆盖，像这种过渡界面的acticity容易出现未去摧毁而出现内存泄漏。
      </p>
     </li>
    </ul>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       对内存泄漏测试后期可预研使用LeakCanary，结合jenkins，定时取版本源码接入LeakCanary后执行monkey测试，查看是否能检查到内存泄露信息（此方法需要提供源码）。
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       <strong>
        2.3 测试标准
       </strong>
       <br/>
       测试场景中内存不会出现持续上升或短时间内出现内存抖动情况和无故申请过大内存的情况
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       <strong>
        2.4 测试点
       </strong>
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       1、空闲状态：切换至后台或者启动后不做任何操作，消耗内存最少。
       <br/>
       2、中强度状态：时间偏长的操作应用。
       <br/>
       3、高强度状态：高强度使用应用，可以跑monkey来测试（通常用来测试内存泄漏）。
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       <strong>
        2.5 测试关注点
       </strong>
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       1、Native heap alloc
       <br/>
       2、Dalvik heap alloc
       <br/>
       3、PSS
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       <strong>
        2.6 关注点
       </strong>
       <br/>
       1、退出某个页面后，内存是否有回落。
       <br/>
       如果没有及时回落，且程序自动GC或者手动GC，那便可确认有问题。
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       GC即（Gabarage Collector，垃圾回收器）是指将废弃的内存重新回收再次使用的过程。
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       2、进行某个操作后，内存是否增长过快。
       <br/>
       如果增长过快，也有可能存在风险，需重复操作确认。
      </span>
     </span>
    </p>
    <p>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       <strong>
        3.启动时间（native）
       </strong>
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       软件的响应时间和响应速度直接影响到用户的体验度，如果一个软件，迟迟加载不出来，会直接影响到软件的日活、留存。因此对于一个软件，对响应速度测试是必不可少的。
      </span>
     </span>
    </p>
    <ul style="margin-left:20px;">
     <li>
      应用冷启动&lt;=600ms为优秀，&lt;=800ms为良好，&lt;=1000ms为可接受；
     </li>
     <li>
      应用热启动&lt;=200ms为优秀，&lt;=400ms为良好，&lt;=600ms为可接受；
     </li>
    </ul>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       <strong>
        3.1 数据获取
       </strong>
       <br/>
       获取activity的方法：
       <br/>
       1）日志打印：获取运行中的activity，同时存在耗时的+457ms，总计耗时896ms
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       <code>
        adb logcat ActivityManager:I *:s
       </code>
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
    </p>
    <p class="img-center">
     <a href="https://img2023.cnblogs.com/blog/3066827/202302/3066827-20230227141434958-1543303127.png" rel="nofollow">
      <img alt="" height="25" src="https://i-blog.csdnimg.cn/blog_migrate/81196ea214e690f8077fe6ae3b731999.png" width="823"/>
     </a>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       2）获取当前页面的activity
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       <code>
        adb shell "dumpsys activity | grep mFocusedActivity"
       </code>
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
    </p>
    <p class="img-center">
     <a href="https://img2023.cnblogs.com/blog/3066827/202302/3066827-20230227142240016-394504405.png" rel="nofollow">
      <img alt="" height="46" src="https://i-blog.csdnimg.cn/blog_migrate/15ec5412b7aa07073f64e53dd185d9d9.png" width="749"/>
     </a>
    </p>
    <ul style="margin-left:20px;">
     <li>
      通过adb shell am start -W –S –n 获取应用首次启动时间
     </li>
    </ul>
    <p style="margin-left:auto;text-align:left;">
    </p>
    <p class="img-center">
     <a href="https://img2023.cnblogs.com/blog/3066827/202302/3066827-20230227142806335-2057073875.png" rel="nofollow">
      <img alt="" height="151" src="https://i-blog.csdnimg.cn/blog_migrate/fb9945f6a2e0b288d82444a26ea0e629.png" width="778"/>
     </a>
    </p>
    <ul style="margin-left:20px;">
     <li>
      通过adb shell am start –W –n 获取应用二次启动时间
     </li>
    </ul>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       <strong>
        ① WaitTime
       </strong>
       就是总的耗时，包括前一个应用 Activity pause 的时间和新应用启动的时间；TotalTime+系统资源启动时间；
       <br/>
       <strong>
        ② ThisTime
       </strong>
       表示一连串启动 Activity 的最后一个 Activity 的启动耗时；该Activity的启动耗时；
       <br/>
       <strong>
        ③ TotalTime
       </strong>
       表示新应用启动的耗时，包括新进程的启动和 Activity 的启动，但不包括前一个应用 Activity pause 的耗时。也就是说，开发者一般只要关心 TotalTime 即可，这个时间才是自己应用真正启动的耗时。
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       使用am命令获取的时间只是apk从onCreate到onResume的时间，但不包含UI界面呈现出来的时间，所以考虑计算从am命令执行到logcat中有displayed出现的时候，视为app已经启动并展现，作为结束时间。此方法并不能完全计算出启动时间，有一定的误差。
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       <strong>
        3.2 App启动时间检测的几种情况
       </strong>
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       1、冷启动：首次启动app的时间间隔（只是启动时间，不包括页面加载）
       <br/>
       2、热启动：非首次启动app的时间间隔（只是启动时间，不包括页面加载）
       <br/>
       3、完全启动：从启动到首页完全加载出来的时间间隔
       <br/>
       4、有网启动：从发起跳转，到页面完全加载出来的时间间隔
       <br/>
       5、无网启动：从发起跳转，到页面完全加载出来的时间间隔
       <br/>
       （在项目中，主要测试关注点是冷启动，热启动）
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       <strong>
        3.3 测试标准
       </strong>
       <br/>
       首次启动时间&lt;=600ms为优秀，&lt;=800ms为良好，&lt;=1000ms为可接受
       <br/>
       二次启动时间&lt;=200ms为优秀，&lt;=400ms为良好，&lt;=600ms为可接受
       <br/>
       横向对比（与竞品对比）和纵向对比（与以往版本对比）
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       测试标准：冷启动时间不超过1.5s，热启动不超过1s
      </span>
     </span>
    </p>
    <p>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       <strong>
        4.响应时间（native）
       </strong>
       <br/>
       Activity切换时间&lt;=100ms为优秀，&lt;=200ms为良好，&lt;=500ms为可接受；
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       <strong>
        4.1 数据获取
       </strong>
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       硬件：通过高速相机
       <br/>
       软件：通过logcat日志的Displayed关键字
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       <code>
        adb logcat | findstr Displayed
       </code>
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
    </p>
    <p class="img-center">
     <a href="https://img2023.cnblogs.com/blog/3066827/202302/3066827-20230227150923779-192999361.png" rel="nofollow">
      <img alt="" height="122" src="https://i-blog.csdnimg.cn/blog_migrate/fd2aa2ed063c7363ff11f71bf9794364.png" width="857"/>
     </a>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       每切换一个页面会自动计算出消耗时间
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       <strong>
        4.2 Activity切换时间检测的几种情况
       </strong>
      </span>
     </span>
    </p>
    <ol style="margin-left:0;">
     <li>
      各主要场景页面的切换
     </li>
     <li>
      关注一些一进入就需要进行加载的activity
     </li>
     <li>
      针对性的场景测试
     </li>
    </ol>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       例如其他一些需要关注的页面切换等
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       <strong>
        4.3 测试标准
       </strong>
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       Activity切换时间&lt;=100ms为优秀，&lt;=200ms为良好，&lt;=500ms为可接受
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       横向对比（与竞品对比）和纵向对比（与以往版本对比）
      </span>
     </span>
    </p>
    <p>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       <strong>
        5.流畅度(FPS)
       </strong>
      </span>
     </span>
    </p>
    <ul style="margin-left:20px;">
     <li>
      帧率&lt;=50需优化，&gt;=55为良好，&gt;=57为优秀；
     </li>
     <li>
      不出现连续丢帧情况；
     </li>
    </ul>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       <strong>
        5.1 数据获取
       </strong>
       <br/>
       <strong>
        1、方式一：adb命令
       </strong>
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       1）手机开启开发者模式，开启“GPU呈现模式分析(profile GPU rendering)”，选择“在adb shell dumpsys gfxinfo中”
       <br/>
       2）获取数据计算滑动帧率和掉帧数
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       <code>
        adb shell "dumpsys gfxinfo &lt;pakagename&gt;"
       </code>
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
    </p>
    <p class="img-center">
     <a href="https://img2023.cnblogs.com/blog/3066827/202302/3066827-20230227162229050-988960864.png" rel="nofollow">
      <img alt="" height="559" src="https://i-blog.csdnimg.cn/blog_migrate/74556416c310fd5251149ca3d454aa32.png" width="269"/>
     </a>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       如上图信息表示了每一帧在安卓系统中的四个阶段：
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       Draw：表示在Java中创建显示列表部分中，OnDraw()方法占用的时间
       <br/>
       Prepare：准备时间
       <br/>
       Process：表示渲染引擎执行显示列表所花的时间，view越多，时间就越长
       <br/>
       Execute：表示把一帧数据发送到屏幕上排版显示实际花费的时间，其实是实际显示帧数据的后台缓存区与前台缓冲区交换后并将前台缓冲区的内容显示到屏幕上的时间
       <br/>
       将上面的四个时间加起来就是绘制一帧所需要的时间，如果超过了16.67就表示掉帧了
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       计算帧率：FPS=1000/(Draw+Prepare+Process+Execute)
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       <span style="color:#ff0000;">
        <strong>
         说明
        </strong>
       </span>
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       Android定义了流畅度的数据标准，以60FPS为标准(FPS为每秒绘制的帧数)，帧数过小就会出现卡顿感；
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       每一帧在安卓系统中分4个阶段，4个阶段的总和超过16.67(1秒60帧，算下来平均1帧的间隔就约是16.67ms)就认为丢帧；
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       这个定义在Android6.0以前是一定的，但是现在已经没有固定的标准了，因为目前安卓系统有3层缓存机制，加上硬件上的进步，即使超过16.67，也不一定会出现卡顿感。所以这个数据在测试时作为一种对比和相对衡量标准，也可根据需求自定义标准。
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       <strong>
        2、方式二：开发者选项自带的图表
       </strong>
       <br/>
       1）打开手机：开发者选项-&gt;GPU渲染模式分析(GPU呈现模式分析) -&gt;在屏幕上显示为条形图
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
    </p>
    <p class="img-center">
     <a href="https://img2023.cnblogs.com/blog/3066827/202302/3066827-20230227163925698-888645254.png" rel="nofollow">
      <img alt="" height="654" src="https://i-blog.csdnimg.cn/blog_migrate/b736e13273ed25cd5a105745e9db2ead.png" width="380"/>
     </a>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       <strong>
        5.2 滑动帧率检测的几种情况
       </strong>
      </span>
     </span>
    </p>
    <ol style="margin-left:0;">
     <li>
      ListView界面的帧率
     </li>
     <li>
      可滑动界面帧率，如长的textview或可滑动的长图等
     </li>
     <li>
      动画较多的页面操作帧率
     </li>
     <li>
      针对性的场景测试
     </li>
    </ol>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       可能引起掉帧的原因：
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       1.手机性能差，CPU + GPU工作效率低下
       <br/>
       2.横竖屏切换，需要用savedInstanceState保存的view信息进行重画
       <br/>
       3.动画效果太多
       <br/>
       4.GC太多
       <br/>
       5.UI线程阻塞
       <br/>
       6.界面试图结构过于复杂（可以通过Hierachy View查看）
       <br/>
       7.过度绘制
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       注意：如果只掉了一帧，但是这帧所占时间较长，比如占了几个垂直同步信号的时间，虽然总体的FPS值还不错，但依然能肉眼感知到这帧的卡顿，所以这种情况也需注意。
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       <strong>
        5.3 测试标准
       </strong>
       <br/>
       应结合手机硬件性能决定性能标准，但建议最低也要大于50
       <br/>
       横向对比（与竞品对比）和纵向对比（与以往版本对比）
      </span>
     </span>
    </p>
    <p>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       <strong>
        6.过渡绘制（卡顿、慢）
       </strong>
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       GPU渲染是指在一个像素点上绘制多次（超过一次）：显示一个什么都没有做的activity界面算作画了1层，给activity加一个背景是第2层，在上面放了一个Text View（有背景的Text View）是第3层，Text View显示文本就是第4层仅仅只是为了显示一个文本，却在同一个像素点绘制了四次，这是一定要优化的。过度绘制对动画性能的影响是极其严重的，如果你想要流畅的动画效果，那么一定不能忽视过度绘制。
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       <strong>
        6.1 数据获取
       </strong>
       <br/>
       进入开发者选项-&gt;调试GPU过度绘制-&gt;显示过度绘制区域
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       <strong>
        6.2 GPU过渡绘制检测的几种情况
       </strong>
       <br/>
       各/主要页面
       <br/>
       针对性的场景测试
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       <strong>
        6.3 GPU过渡渲染不同的颜色代表不同的绘制程度
       </strong>
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       1）原色：无过渡绘制
       <br/>
       2）蓝色：绘制一次 （理想状态）
       <br/>
       3）绿色：绘制二次
       <br/>
       4）浅红：绘制三次 （可以优化）
       <br/>
       5）深红：绘制四次 （必须优化）
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       <strong>
        6.4 测试标准
       </strong>
      </span>
     </span>
    </p>
    <ol style="margin-left:0;">
     <li>
      不允许出现黑色像素
     </li>
     <li>
      不允许存在4X过渡绘制
     </li>
     <li>
      不允许存在面积超过屏幕1/4区域的3X过渡绘制
     </li>
     <li>
      动态页面、可滑动/滚动列表，还可参考CPU的数据
     </li>
    </ol>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       一些静态页面，一般是无法修改的
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       横向对比（与竞品对比）和纵向对比（与以往版本对比）
      </span>
     </span>
    </p>
    <p>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       <strong>
        7.流量
       </strong>
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       <strong>
        7.1 数据获取
       </strong>
       <br/>
       <strong>
        1、方式一
       </strong>
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       <span style="color:#ff0000;">
        注：&lt;内容&gt;替换成对应的数据
       </span>
       <br/>
       1）获取应用的进程id(PID)
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       <code>
        adb shell "ps | grep &lt;包名&gt;"
       </code>
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
    </p>
    <p class="img-center">
     <a href="https://img2023.cnblogs.com/blog/3066827/202302/3066827-20230228152709814-99257874.png" rel="nofollow">
      <img alt="" height="49" src="https://i-blog.csdnimg.cn/blog_migrate/4faea809deb8d201bdf82befbebc982f.png" width="655"/>
     </a>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       2）根据PID获取app的Uid(Uid是每个app安装时候分配的唯一编号用于识别该app)
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       <code>
        adb shell "cat /proc/&lt;pid&gt;/status | grep Uid"
       </code>
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
    </p>
    <p class="img-center">
     <a href="https://img2023.cnblogs.com/blog/3066827/202302/3066827-20230228153756487-1480291594.png" rel="nofollow">
      <img alt="" height="48" src="https://i-blog.csdnimg.cn/blog_migrate/6f4de6497470494986c4b1d55d7fa8fa.png" width="549"/>
     </a>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       3）读取tcp_rcv获取应用接收流量信息（设备重启后清零）
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       <code>
        adb shell cat /proc/uid_stat/&lt;Uid&gt;/tcp_rcv
       </code>
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       4）读取tcp_snd获取应用发送流量信息（设备重启后清零）
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       <code>
        adb shell cat /proc/uid_stat/&lt;Uid&gt;/tcp_snd
       </code>
      </span>
     </span>
    </p>
    <p>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       计算流量消耗步骤：
      </span>
     </span>
    </p>
    <ol style="margin-left:0;">
     <li>
      执行一次这两条命令，获取到应用的开始接收及发送的流量
     </li>
     <li>
      然后我们再操作应用，执行一段时间测试
     </li>
     <li>
      再次执行上述 2 条命令可以获取到应用结束时候的接收及发送的流量，通过相减及得到应用的整体流量消耗
     </li>
    </ol>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       <strong>
        2、方式二
       </strong>
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       1）获取应用的进程id(PID)
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       <code>
        adb shell "ps | grep &lt;包名&gt;"
       </code>
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
    </p>
    <p class="img-center">
     <a href="https://img2023.cnblogs.com/blog/3066827/202302/3066827-20230228152709814-99257874.png" rel="nofollow">
      <img alt="" height="49" src="https://i-blog.csdnimg.cn/blog_migrate/4faea809deb8d201bdf82befbebc982f.png" width="655"/>
     </a>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       2）根据PID获取app的Uid(Uid是每个app安装时候分配的唯一编号用于识别该app)
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       <code>
        adb shell "cat /proc/&lt;pid&gt;/status | grep Uid"
       </code>
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
    </p>
    <p class="img-center">
     <a href="https://img2023.cnblogs.com/blog/3066827/202302/3066827-20230228153756487-1480291594.png" rel="nofollow">
      <img alt="" height="48" src="https://i-blog.csdnimg.cn/blog_migrate/6f4de6497470494986c4b1d55d7fa8fa.png" width="549"/>
     </a>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       3）执行命令
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       <code>
        adb shell cat /proc/net/xt_qtaguid/stats | grep &lt;Uid&gt;
       </code>
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       其中第6列代表rx_bytes接收的字节数，第8列为tx_bytes发送的字节数
       <br/>
       一个uid可能对应多个进程，把数据累加就行
       <br/>
       两个时间片中间应用流量的消耗，就计算接收字节数的差值就行
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       <span style="color:#ff0000;">
        <strong>
         说明
        </strong>
       </span>
      </span>
     </span>
    </p>
    <ul style="margin-left:20px;">
     <li>
      <p style="margin-left:auto;">
       android4.0以上版本可以用/proc/uid_stat/Uid/tcp_rcv和/proc/uid_stat/Uid/tcp_snd来获取某个程序的上下行流量；
      </p>
     </li>
     <li>
      <p style="margin-left:auto;">
       4.0以下版本要用cat/proc/Pid/net/dev来查看上下行流量。uid和pid的关系，可以从/data/system/packages.list这个文件中获取，但是/proc/uid_stat/Uid这种方式，在Android&gt;/tcp_rcv和/proc/uid_stat/Uid/tcp_snd来获取某个程序的上下行流量；而4.0以下版本要用cat/proc/Pid/net/dev来查看上下行流量。
      </p>
     </li>
    </ul>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       Uid和Pid的关系，可以从/data/system/packages.list这个文件中获取，但是/proc/uid_stat/uid这种方式，在Android 6.0系统中部分厂商可能是做了某些修改，在proc目录下没有显示uid_stat文件夹。
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       获取Android（Linux）流量信息：
       <br/>
       在Linux系统有3个地方保存流量统计文件，对于Android系统同样也适用：
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       （1）在/proc/net/dev下可以查看各个网络接口的收发流量 (等同adb shell cat /proc/pid/net/dev，adb shell cat /sys/class/net/wlan0/statistics/rx_bytes);
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       （2）在/sys/class/net/下可以找到相关类别(如wlan0)的目录.在其子目录statistics下游rxbytes和txbytes记录收发流量;
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       （3）在/proc/uid_stat/Uid/tcp_rcv记录该uid应用下载流量字节,/proc/uid_stat/Uid/tcp_snd有该Uid应用上传流量字节;
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       <strong>
        7.2 流量检测的几种情况
       </strong>
       <br/>
       (1) 应用首次启动流量
       <br/>
       (2) 应用后台长时间运行后的流量值
       <br/>
       (3) 针对性的场景测试
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       例如发送接收图片，发送接收视频，刷新列表等操作
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       <strong>
        7.3 测试标准
       </strong>
      </span>
     </span>
    </p>
    <ul style="margin-left:20px;">
     <li>
      不存在重复请求；
     </li>
     <li>
      页面静默时或处于后台不应有流量增加；
     </li>
     <li>
      缓存机制的逻辑合理；
     </li>
     <li>
      在移动网络下不应自动下载素材等数据；
     </li>
     <li>
      小缩略图小于5KB
     </li>
     <li>
      中缩略图小于25KB
     </li>
     <li>
      大缩略图小于50KB
     </li>
    </ul>
    <p>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       <strong>
        8.电量
       </strong>
       <br/>
       要通过adb命令来监控手机的耗电量，所以建议通过wifi的方式来连接手机，而不是用usb线来连接手机设备。usb方式连接手机会自动给手机充电，这样会影响对耗电量的统计的准确性。
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       <strong>
        8.1 连接手机
       </strong>
      </span>
     </span>
    </p>
    <pre class="has" style="margin-left:0;"><code class="language-code-pre-line">&lt;span style="background-color:#282c34"&gt;&lt;span style="color:#abb2bf"&gt;&lt;span style="color:#61aeee"&gt;# 将 Android 设备与要运行 adb 的电脑连接到同一个局域网，比如连到同一个 WiFi&lt;/span&gt;
&lt;span style="color:#61aeee"&gt;# 先使用原装数据线把电脑与手机连接，手机在开发者选项中开启USB调试&lt;/span&gt;
&lt;span style="color:#61aeee"&gt;# 使用adb devices命令查看是否与设备连接&lt;/span&gt;

$ adb devices
List of devices attached
&lt;span style="color:#d19a66"&gt;10.1&lt;/span&gt;&lt;span style="color:#d19a66"&gt;.217&lt;/span&gt;&lt;span style="color:#d19a66"&gt;.238&lt;/span&gt;:&lt;span style="color:#d19a66"&gt;5555&lt;/span&gt;       device
&lt;span style="color:#d19a66"&gt;04&lt;/span&gt;c5a5af52197902        device

&lt;span style="color:#61aeee"&gt;# 显示device表示连接成功&lt;/span&gt;

&lt;span style="color:#61aeee"&gt;# 断开数据线&lt;/span&gt;
$ adb connect &lt;span style="color:#d19a66"&gt;10.1&lt;/span&gt;&lt;span style="color:#d19a66"&gt;.217&lt;/span&gt;&lt;span style="color:#d19a66"&gt;.238&lt;/span&gt;
unable to connect to &lt;span style="color:#d19a66"&gt;10.1&lt;/span&gt;&lt;span style="color:#d19a66"&gt;.217&lt;/span&gt;&lt;span style="color:#d19a66"&gt;.238&lt;/span&gt;:&lt;span style="color:#d19a66"&gt;5555&lt;/span&gt;: Connection refused

&lt;span style="color:#61aeee"&gt;# 输入 adb tcpip 5555命令&lt;/span&gt;
&lt;span style="color:#61aeee"&gt;# 打印 “restarting in TCP mode port: 5555”表示启动成功&lt;/span&gt;

&lt;span style="color:#61aeee"&gt;# 找到手机的 IP 地址&lt;/span&gt;
&lt;span style="color:#61aeee"&gt;# 进入手机的WIFI连接，进入连接属性，查看手机的 IP&lt;/span&gt;
&lt;span style="color:#61aeee"&gt;# 也可在「设置」-「关于手机」-「状态信息」-「IP地址」找到&lt;/span&gt;

&lt;span style="color:#61aeee"&gt;# 输入adb connect '手机ip地址'&lt;/span&gt;
&lt;span style="color:#61aeee"&gt;# 出现 connected to ip:5555 表示连接成功&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;</code></pre>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       <strong>
        8.2 获取手机电池信息
       </strong>
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       adb命令：
       <code>
        adb shell dumpsys battery
       </code>
       <br/>
       得到信息如下：
      </span>
     </span>
    </p>
    <pre class="has" style="margin-left:0;"><code class="language-code-pre-line">&lt;span style="background-color:#282c34"&gt;&lt;span style="color:#abb2bf"&gt;&lt;span style="color:#d19a66"&gt;AC powered:&lt;/span&gt; &lt;span style="color:#56b6c2"&gt;false&lt;/span&gt;
&lt;span style="color:#d19a66"&gt;USB powered:&lt;/span&gt; &lt;span style="color:#56b6c2"&gt;true&lt;/span&gt;
&lt;span style="color:#d19a66"&gt;Wireless powered:&lt;/span&gt; &lt;span style="color:#56b6c2"&gt;false&lt;/span&gt;
&lt;span style="color:#d19a66"&gt;status:&lt;/span&gt; &lt;span style="color:#d19a66"&gt;1&lt;/span&gt;            &lt;span style="color:#b18eb1"&gt;&lt;em&gt;# 电池状态：2：充电状态 ，其他数字为非充电状态&lt;/em&gt;&lt;/span&gt;
&lt;span style="color:#d19a66"&gt;health:&lt;/span&gt; &lt;span style="color:#d19a66"&gt;2&lt;/span&gt;            &lt;span style="color:#b18eb1"&gt;&lt;em&gt;# 电池健康状态：只有数字2表示good&lt;/em&gt;&lt;/span&gt;
&lt;span style="color:#d19a66"&gt;present:&lt;/span&gt; &lt;span style="color:#56b6c2"&gt;true&lt;/span&gt;        &lt;span style="color:#b18eb1"&gt;&lt;em&gt;# 电池是否安装在机身&lt;/em&gt;&lt;/span&gt;
&lt;span style="color:#d19a66"&gt;level:&lt;/span&gt; &lt;span style="color:#d19a66"&gt;55&lt;/span&gt;            &lt;span style="color:#b18eb1"&gt;&lt;em&gt;# 电量: 百分比&lt;/em&gt;&lt;/span&gt;
&lt;span style="color:#d19a66"&gt;scale:&lt;/span&gt; &lt;span style="color:#d19a66"&gt;100&lt;/span&gt;
&lt;span style="color:#d19a66"&gt;voltage:&lt;/span&gt; &lt;span style="color:#d19a66"&gt;3977&lt;/span&gt;          &lt;span style="color:#b18eb1"&gt;&lt;em&gt;# 电池电压&lt;/em&gt;&lt;/span&gt;
&lt;span style="color:#d19a66"&gt;current now:&lt;/span&gt; &lt;span style="color:#d19a66"&gt;-335232&lt;/span&gt;   &lt;span style="color:#b18eb1"&gt;&lt;em&gt;# 电流值，负数表示正在充电&lt;/em&gt;&lt;/span&gt;
&lt;span style="color:#d19a66"&gt;temperature:&lt;/span&gt; &lt;span style="color:#d19a66"&gt;335&lt;/span&gt;       &lt;span style="color:#b18eb1"&gt;&lt;em&gt;# 电池温度，单位是0.1摄氏度&lt;/em&gt;&lt;/span&gt;
&lt;span style="color:#d19a66"&gt;technology:&lt;/span&gt; &lt;span style="color:#98c379"&gt;Li-poly&lt;/span&gt;    &lt;span style="color:#b18eb1"&gt;&lt;em&gt;# 电池种类&lt;/em&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;</code></pre>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       <strong>
        8.3 获取APP的uid
       </strong>
       <br/>
       使用
       <code>
        adb shell COLUMNS=512 top
       </code>
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
    </p>
    <p class="img-center">
     <a href="https://img2023.cnblogs.com/blog/3066827/202303/3066827-20230301110034871-1113181157.png" rel="nofollow">
      <img alt="" height="261" src="https://i-blog.csdnimg.cn/blog_migrate/30a6926b607f9be465606c82b69877ed.png" width="963"/>
     </a>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       或者
       <code>
        adb shell ps | findstr &lt;包名&gt;
       </code>
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
    </p>
    <p class="img-center">
     <a href="https://img2023.cnblogs.com/blog/3066827/202302/3066827-20230228173802062-305443715.png" rel="nofollow">
      <img alt="" height="52" src="https://i-blog.csdnimg.cn/blog_migrate/cff8443a59c92bc3a8e8f6dddc34dcdb.png" width="634"/>
     </a>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       <strong>
        8.4 重置电池数据收集数据
       </strong>
      </span>
     </span>
    </p>
    <ul style="margin-left:20px;">
     <li>
      清除已有的耗电量数据
     </li>
    </ul>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       <code>
        adb shell dumpsys batterystats --enable full-wake-history
       </code>
      </span>
     </span>
    </p>
    <ul style="margin-left:20px;">
     <li>
      重置设备耗电量数据
     </li>
    </ul>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       <code>
        adb shell dumpsys batterystats --reset
       </code>
      </span>
     </span>
    </p>
    <ul style="margin-left:20px;">
     <li>
      然后执行业务场景，测试完成之后再执行以下命令取出APP电量消耗日志(把数据重定向到本地)
     </li>
    </ul>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       <code>
        adb shell dumpsys batterystats &gt; D://batterystats.txt
       </code>
      </span>
     </span>
    </p>
    <p>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       在文件中搜索
       <span style="color:#0000ff;">
        Estimated power use (mAh):
       </span>
       即可跳转到App电量消耗位置。
      </span>
     </span>
    </p>
    <p style="margin-left:auto;text-align:left;">
    </p>
    <p class="img-center">
     <a href="https://img2023.cnblogs.com/blog/3066827/202302/3066827-20230228174331240-1065633297.png" rel="nofollow">
      <img alt="" height="159" src="https://i-blog.csdnimg.cn/blog_migrate/e6079ecd22d8137ea12192608be25971.png" width="998"/>
     </a>
    </p>
    <p style="margin-left:auto;text-align:left;">
     <span style="color:#23263b;">
      <span style="background-color:rgba(255,255,255,.9);">
       之前获取的Uid值
       <span style="color:#0000ff;">
        u0_a487
       </span>
       需要将下划线
       <span style="color:#0000ff;">
        _
       </span>
       去掉变成
       <span style="color:#0000ff;">
        u0a487
       </span>
       ，然后通过该Uid在日志文件中查找则可搜索到该APP对应的耗电量。
       <br/>
       其中，
       <span style="color:#0000ff;">
        Uid u0a487：121
       </span>
       中的
       <span style="color:#0000ff;">
        121
       </span>
       为该APP在测试期间消耗的总电量，单位为
       <span style="color:#0000ff;">
        mAh
       </span>
       ，圆括号中详细说明了电量消耗的详细信息
      </span>
     </span>
    </p>
    <h2 id="sbTitle">
     性能测试之PerfDog _
     <a href="https://www.cnblogs.com/lc-blogs/p/17148382.html" rel="nofollow" title="https://www.cnblogs.com/lc-blogs/p/17148382.html">
      https://www.cnblogs.com/lc-blogs/p/17148382.html
     </a>
    </h2>
    <p>
     <a href="https://blog.csdn.net/suchengbin3433/article/details/134140047?ops_request_misc=&amp;request_id=&amp;biz_id=102&amp;utm_term=%E6%89%8B%E6%9C%BA%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-4-134140047.nonecase&amp;spm=1018.2226.3001.4187" title="安卓手机性能测试_android 手机性能测试-CSDN博客">
      安卓手机性能测试_android 手机性能测试-CSDN博客
     </a>
    </p>
    <p>
     <a href="https://blog.csdn.net/m0_60166861/article/details/138506460?ops_request_misc=&amp;request_id=&amp;biz_id=102&amp;utm_term=%E6%89%8B%E6%9C%BA%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-2-138506460.nonecase&amp;spm=1018.2226.3001.4187" title="（Android）安卓性能测试详解！_手机性能压力测试-CSDN博客">
      （Android）安卓性能测试详解！_手机性能压力测试-CSDN博客
     </a>
    </p>
    <p>
     <a href="https://blog.csdn.net/weixin_39810558/article/details/130156374?ops_request_misc=&amp;request_id=&amp;biz_id=102&amp;utm_term=%E6%89%8B%E6%9C%BA%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-3-130156374.nonecase&amp;spm=1018.2226.3001.4187" title="Android性能测试总结_android 手机性能测试指标-CSDN博客">
      Android性能测试总结_android 手机性能测试指标-CSDN博客
     </a>
    </p>
    <p>
     adb常用命令：
    </p>
    <p>
     <a href="https://www.jianshu.com/p/6c0cfc25b038" rel="nofollow" title="Android性能测试（内存、cpu、fps、流量、GPU、电量）——adb篇 - 简书">
      Android性能测试（内存、cpu、fps、流量、GPU、电量）——adb篇 - 简书
     </a>
     <a href="https://blog.csdn.net/adazone/article/details/88825454" title="App测试方法总结_app功能测试技巧-CSDN博客">
      App测试方法总结_app功能测试技巧-CSDN博客
     </a>
    </p>
   </div>
  </div>
 </article>
</div>


<p class="artid" style="display:none">68747470733a2f2f626c6f:672e6373646e2e6e65742f4a69616e796f6e675f7a68616f2f:61727469636c652f64657461696c732f313336373631393739</p>
