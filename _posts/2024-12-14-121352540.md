---
layout: post
title: "ant上传组件upload,前端读取文件创建文件"
date: 2024-12-14 10:59:24 +0800
description: "该博客介绍了如何实现用户上传并修改JSON文件后保存修改内容的前端功能。通过使用React的antd"
keywords: "前端读取upload上传的json文件"
categories: ['']
tags: ['前端', 'Upload', 'Javascript', 'Ant']
artid: "121352540"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=121352540
    alt: "ant上传组件upload,前端读取文件创建文件"
render_with_liquid: false
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     ant上传组件upload,前端读取文件、创建文件
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <p>
     业务需求是用户上传文件后，还能修改文件内容,最后保存修改后的文件
    </p>
    <p>
     实现方式：
    </p>
    <p>
     1.前端读取文件内容后显示在代码编辑器中  方便用户修改
    </p>
    <p>
     2.点保存按钮时，拿到改变的文件内容后，创建新的文件流 ， 提交给后端
    </p>
    <p>
     ----------------------------------------------------------
    </p>
    <p>
     这里演示的是JSON文件数据
    </p>
    <p>
     选择文件
    </p>
    <p>
     <img alt="" height="140" src="https://i-blog.csdnimg.cn/blog_migrate/a2b3d90c85509071e329706c50ecccac.png" width="806"/>
    </p>
    <p>
     1.拿到文件的JSON数据后，在代码编辑中显示
    </p>
    <p>
     <img alt="" height="409" src="https://i-blog.csdnimg.cn/blog_migrate/2c533793ecde1a65da00d56cef457d84.png" width="656"/>
    </p>
    <p>
    </p>
    <p>
     js代码：react引入antd的Upload组件
    </p>
    <pre><code class="language-javascript">  
  onImportExcel = (file) =&gt; {
      // 创建FileReader 对象读取
      const reader = new FileReader();
      reader.readAsText(file);
      reader.onload = () =&gt; {
        // 获取文件内容存进tempFile
        this.setState({ tempFile: reader.result});
      };
  };

    
    const uploadProps = {
      name: 'file',
      action: '',
      showUploadList: false,
      fileList,
      onChange: this.handleChange,
      beforeUpload: (file, fileList) =&gt; {
        this.onImportExcel(file);
      },
    };


&lt;Upload {...uploadProps} accept=".JSON"&gt;
    &lt;Button type="primary" ghost className="mr-md"&gt;
        导入JSON文件
     &lt;/Button&gt;
&lt;/Upload&gt;</code></pre>
    <p>
     2 拿到改变的文件内容后，创建新的文件流 ， 提交给后端
    </p>
    <pre><code class="language-javascript">   handleSave = () =&gt; {
        const fileConent = 'test'; // fileConent其实时代码编辑器用户修改的内容
        const formData = new FormData();
        // 将得到的文件流添加到FormData对象
        const uuid = createUuid();
        const newFile = new Blob([fileConent], { type: 'application/json' });
        // tempFile.name是文件名
        formData.append('file', newFile, tempFile.name);
        formData.append('uuid', uuid);
        axios.post(`/api/upload`, formData).then(res =&gt; {
          if (res.status === 200) {
            console.log('上传成功', res.data);
          } 
        });
      }</code></pre>
    <p>
    </p>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f672e:6373646e2e6e65742f77656978696e5f35373232393731352f:61727469636c652f64657461696c732f313231333532353430" class_="artid" style="display:none">
 </p>
</div>


