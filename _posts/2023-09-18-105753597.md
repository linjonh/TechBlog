---
layout: post
title: "H3C-WA4320H-ACN-无线AP硬改支持集客256M内存启动"
date: 2023-09-18 14:21:26 +0800
description: "写在前面的话硬改16M spi flash以后，可以刷入集客固件，但目前集客固件在WA4320H-A"
keywords: "WA4320H-ACN,16Mspiflash,集客固件"
categories: ['']
tags: ['无标签']
artid: "105753597"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=105753597
    alt: "H3C-WA4320H-ACN-无线AP硬改支持集客256M内存启动"
render_with_liquid: false
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     H3C WA4320H-ACN 无线AP硬改支持集客256M内存启动
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-light" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h6>
     <a id="_0">
     </a>
     写在前面的话
    </h6>
    <blockquote>
     <p>
      硬改16M spi flash以后，可以刷入集客固件，但目前集客固件在WA4320H-ACN上只能支持128M内存，不支持全部256M内存，很多网友刷入了大麦的breed，无法启动集客固件，很多人不知道问题出在哪里，不过的确是breed的问题，我们最终使用breed-qca9558-dw33d.bin作为breed，配合集客固件可以完美支持全部256M内存，双无线正常工作。
     </p>
    </blockquote>
    <ul>
     <li>
      <p>
       鉴于有的人可能需要编程器固件，这里给出
       <a href="https://pan.baidu.com/s/1nsU5WLTHIlFn0C_4EKzSKg" rel="nofollow">
        某云的地址链接
       </a>
       ，提取码：z9rm ，注意自己要在breed里面改MAC地址，不然都一样在一个局域网下会冲突无法正常工作的。
      </p>
     </li>
     <li>
      <p>
       另外，编程器固件默认的ART信号不是很好，默认只能到20dbm，这里给出可以支持的ART连接，可以在breed里面刷入
       <a href="https://github.com/bkil/calibrated-art-collection/raw/master/QCA9558-QCA9880/qca9558-qca9880.hackpascal.bin">
        QCA 9558 ART
       </a>
       ，刷入后信号明显增强。
      </p>
     </li>
     <li>
      <p>
       为什么会出现无法自动启动呢？原因是在大麦的breed里面，gpio 17脚作为reset输入了，而且启动的时候breed里面检测到是pressed状态(低电平)，误认为用户按下了reset键，所以直接阻止了系统自动启动，所以每次上电不会自动启动系统。
      </p>
     </li>
     <li>
      <p>
       解决方法似乎两个，一个是改breed源代码，另一个是将gpio 17脚接个上拉电阻，因为QCA9557的GPIO默认是input模式而且使能内部下拉电阻。
       <strong>
        由于没有breed的源代码，人家又不开源又不会给你单独改个版本
       </strong>
       ，那我们只能选择第二套方案了。
      </p>
     </li>
    </ul>
    <h6>
     <a id="_11">
     </a>
     硬改步骤
    </h6>
    <ul>
     <li>
      <p>
       经过分析，发现gpio 17控制的是电源红色指示灯(电源同一个指示灯两种颜色，一个绿色，一个红色，共阳极连接2.5V)，解决办法断开R1216，然后直接上拉到2.5V，
       <em>
        经过测试，发现内部下拉太强了，外部1K的上拉电阻似乎不能上拉到2.5V，只能拉到0.8V
       </em>
       ，尝试了直接接到2.5V，发现这样会导致breed里面更新固件速度异常缓慢而且失败，可能是CPU运行出了问题，最后接了一个220Ω 0402封装的上拉电阻到2.5V，电压能拉到1.5V左右，breed里面检测到gpio 17为高，就可以了，反正内部软件再控制电源红色指示灯不会起效果罢了，不影响使用。
      </p>
     </li>
     <li>
      <p>
       以笔者目前的板子硬件版本，去掉R1216电阻（这个电阻是gpio 17控制电源红色指示灯串联的1k电阻），以后红色电源指示灯废了，反正用不到就一直绿色呗。
       <br/>
       <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/b6413abb6a885a479b05becd97cdda14.png"/>
      </p>
     </li>
     <li>
      <p>
       <s>
        飞线连接到电源的供电引脚，目前工作电压是2.5V
       </s>
       <strong>
        这里更正一下，必须接一个220Ω的上拉电阻，不能直接接到2.5V
       </strong>
       ，图仅供参考。
       <br/>
       <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/555a659e9355483d134680f78cc6911b.jpeg"/>
      </p>
     </li>
     <li>
      <p>
       不懂技术朋友，不用担心这样硬改的可靠性，一个指示灯不会有什么影响的，注意最左侧的LED指示灯旁边，有一根漆包线连接到上图位置。
       <br/>
       <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/148f67d05bbc6f7c144320fc15cdc30f.jpeg"/>
      </p>
     </li>
     <li>
      <p>
       完美支持全部256M内存
       <br/>
       <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/0f44de6bdbf75152593a51f14b94d78a.png"/>
      </p>
     </li>
     <li>
      <p>
       另外，48V供电的电源不太好找，有需要改成12V供电的朋友，这样不仅可以48V也可以12V供电，参考
       <a href="https://blog.csdn.net/code_style/article/details/105431574">
        WA4320H-ACN 无线AP改成12V DC供电
       </a>
      </p>
     </li>
    </ul>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f:626c6f672e6373646e2e6e65742f636f64655f7374796c652f:61727469636c652f64657461696c732f313035373533353937" class_="artid" style="display:none">
 </p>
</div>


