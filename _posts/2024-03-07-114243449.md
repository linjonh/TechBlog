---
layout: post
title: "java复制sheet_Java对excel中的sheet进行拷贝"
date: 2024-03-07 09:32:04 +0800
description: "近段时间做一个excel的导出功能，在网上查询了很多方法，发现都很难解决我目前的困难，偶尔查询到PO"
keywords: "java clonesheet"
categories: ['']
tags: ['Java']
artid: "114243449"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=114243449
    alt: "java复制sheet_Java对excel中的sheet进行拷贝"
render_with_liquid: false
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     java复制sheet_Java对excel中的sheet进行拷贝
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <div style="font-size:16px;">
     <p>
      近段时间做一个excel的导出功能，在网上查询了很多方法，发现都很难解决我目前的困难，偶尔查询到POI修改sheetname这个问题，有了解决方法
     </p>
     <p>
      以下为参考链接及本人部分代码
     </p>
     <p>
      如有侵权，请联络删除，谢谢
     </p>
     <p>
      部分代码及注释：
     </p>
     <p>
      //因为有excel模板，但又不想直接在模板上进行操作，所以先获取文件流信息，模板为xlsx，请自行修改
     </p>
     <p>
      //使用文件路径读入文件流，因为我的是模板，我是知道路径的
     </p>
     <p>
      FileInputStream fis = new FileInputStream("src/main/resources/template/ScheduleModel.xlsx");
     </p>
     <p>
      //创建一个新的excel并读入文件流，读取之后记得关闭流
     </p>
     <p>
      XSSFWorkbook wk = new XSSFWorkbook(fis);
     </p>
     <p>
      fis.close();
     </p>
     <p>
      // 模板内容已经写入了新建的excel，第一个sheet为模板sheet
     </p>
     <p>
      XSSFSheet fromsheet = wk.getSheetAt(0);
     </p>
     <p>
      // 新表创建sheet
     </p>
     <p>
      XSSFSheet sheet = null;
     </p>
     <p>
      XSSFRow row = null;
     </p>
     <p>
      //之后就是新文件之内的sheet操作了，要根据模板sheet创建新sheet，直接克隆就可以了
     </p>
     <p>
      int sheetNum = 1;
     </p>
     <p>
      sheet = wk.cloneSheet(0);//克隆第一个sheet，因为我后续要对克隆的sheet直接进行操作，所以就直接这样写了
     </p>
     <p>
      sheetNum++;//获取sheet页数量，也可以使用原生方法int sheetNum = wk.getNumberOfSheets();
     </p>
     <p>
      wk.setSheetName(sheetNum-1, sheetname);//修改新生成的sheet页名称
     </p>
     <p>
      以上就是代码部分了，可以自行追加逻辑来确认是否克隆新的sheet，
     </p>
     <p>
      这个方法比起字节流一行一行读方便很多，唯一的问题是没办法对内容进行筛选。
     </p>
     <p>
      但如果仅是对模板进行操作，这种方法是我找到的最方便的了，如果有其他方案，可以发给我，谢谢。
     </p>
    </div>
   </div>
  </div>
  <div id="recommendDown">
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f672e:6373646e2e6e65742f77656978696e5f33393532353235352f:61727469636c652f64657461696c732f313134323433343439" class_="artid" style="display:none">
 </p>
</div>


