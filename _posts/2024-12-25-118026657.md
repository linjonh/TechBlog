---
layout: post
title: "前端必备,从零开始完成一个node命令行工具"
date: 2024-12-25 20:13:00 +0800
description: "这篇博客介绍了如何使用Node.js创建命令行工具。首先，通过创建文件、初始化项目和设置`packa"
keywords: "前端 如何写node脚本"
categories: ['Node']
tags: ['Node']
artid: "118026657"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=118026657
    alt: "前端必备,从零开始完成一个node命令行工具"
render_with_liquid: false
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     前端必备，从零开始完成一个node命令行工具
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h2>
     <a id="_1">
     </a>
     前言
    </h2>
    <p>
     node.js 作为一种服务器语言，其拥有很多底层操作的api，比如文件写入，http服务器等模块。同时其语法和js几乎一直，所以作为前端的我们，可以运用这些东西帮助解决一些开发中的实际问题。
    </p>
    <h2>
     <a id="_5">
     </a>
     前置知识
    </h2>
    <ul>
     <li>
      每当shell新开启一个会话时，shell都会生成environment即环境变量，environment里都是些定义系统属性的变量。命令行输入 env即可查看环境变量
     </li>
    </ul>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/7a78d5e9be8b25adddcd16fb13c3eaa6.png"/>
    </p>
    <ul>
     <li>
      <p>
       很多程序都会用到这里的变量，比如nvm会用这里的NVM_NODEJS_ORG_MIRROR=https://nodejs.org/dist
       <br/>
       作为代理服务器地址，去镜像的源下载node来安装，提高速度
      </p>
     </li>
     <li>
      <p>
       查看全局包安装在哪里
       <code>
        npm root -g
       </code>
      </p>
     </li>
     <li>
      <p>
       当我们shell里执行
       <code>
        node x.js --args
       </code>
       ，args可以通过
       <strong>
        process.argv
       </strong>
       来访问，process.argv[0]固定是node本身路径，process.argv[1]是文件路径，process.argv.slice(2)才是我们输入的参数
      </p>
     </li>
    </ul>
    <h2>
     <a id="node_17">
     </a>
     node工具如何创建
    </h2>
    <ol>
     <li>
      首先创建一个文件
      <code>
       mkdir test
      </code>
     </li>
     <li>
      <code>
       cd test
      </code>
      进入文件夹
     </li>
     <li>
      初始化我们的项目
      <code>
       npm init
      </code>
      ，一路回车就好，此时应该有一个
      <strong>
       package.json
      </strong>
      的文件
     </li>
     <li>
      用一款你喜欢的开发工具打开test文件夹
      <br/>
      此时你看到的应该是这样
      <br/>
      <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/b3bff3b5f343371fa80ca46b5711686a.png">
       <br/>
       到这里就算项目创建好啦～
      </img>
     </li>
    </ol>
    <h2>
     <a id="_27">
     </a>
     如何配置命令
    </h2>
    <p>
     对 node 项目而言，模块导出入口文件由 package.json 的
     <strong>
      main
     </strong>
     字段指定
     <br/>
     而如果是要安装到命令行的工具，则是由 package.json 的
     <strong>
      bin
     </strong>
     字段指定。
    </p>
    <p>
     首次创建的package.json文件应该长成这样（如果你是一路按回车键的话）
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/92d745efa92291dda82cca3f65b5fcbf.png"/>
    </p>
    <p>
     然后我们应该给它配置一个bin字段，如下所示
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/7445cc7f60dcccc90ea81af6e2860241.png"/>
    </p>
    <p>
     这个的意思是，我们创建了一个
     <code>
      test-abc
     </code>
     命令，当你输入这个命令的时候，执行同级目录下的
     <code>
      index.js
     </code>
     文件。
    </p>
    <p>
     所以我们现在就需要在index.js文件下写我们需要的代码逻辑
    </p>
    <h2>
     <a id="_42">
     </a>
     正式开发工具
    </h2>
    <p>
     创建index.js文件。现在的文件结构应该是：
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/1babd3639a91de7b9907f00552172178.png"/>
    </p>
    <p>
     在index.js中写下：
    </p>
    <pre><code class="prism language-javascript">#<span class="token operator">!</span><span class="token operator">/</span>usr<span class="token operator">/</span>bin<span class="token operator">/</span>env node
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"test-abc"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
    <p>
     第一行是脚本声明文件。任何以
     <strong>
      shebang line(#!)
     </strong>
     <br/>
     开头的文件即是可执行的脚本，其中shebang line指定了用什么（解释器）来解释执行脚本
    </p>
    <p>
     比如常见的
     <strong>
      python
     </strong>
     脚本，你可以看到第一行是这样的：
     <br/>
     <code>
      #!/usr/bin/env python
     </code>
    </p>
    <p>
     对
     <strong>
      node.js
     </strong>
     来说，shebang line通常这么写：
     <br/>
     <code>
      #!/usr/bin/env node
     </code>
    </p>
    <p>
     Shebang是为了指定脚本的解释程序，可是不同用户或者不同的脚本解释器有可能安装在不同的目录下，系统如何知道要去哪里找你的解释程序呢？
     <strong>
      /usr/bin/env
     </strong>
     就是告诉系统可以在PATH目录（即
     <strong>
      /usr/bin/env
     </strong>
     ）中查找。所以配置#!/usr/bin/env node, 就是解决了不同的用户node路径不同的问题，可以让系统动态的去查找node来执行你的脚本文件。
    </p>
    <h2>
     <a id="node_65">
     </a>
     如何执行node命令
    </h2>
    <p>
     直接命令行输入我们定义的命令名称就好啦。这里我们定义的test-abc ,所以直接输入test-abc就好啦～
    </p>
    <p>
     然后我们测试一下,在终端中输入 kid，会提示:
    </p>
    <pre><code class="prism language-javascript">zsh<span class="token operator">:</span> command not found<span class="token operator">:</span> kid
</code></pre>
    <p>
     为什么会这样呢？回想一下，通常我们在使用一个 cli 工具时，都需要先安装它，比如 vue-cli，使用前需要全局安装:
    </p>
    <pre><code class="prism language-javascript">npm i vue<span class="token operator">-</span>cli <span class="token operator">-</span>g
</code></pre>
    <p>
     而我们的 kid-cli 并没有发布到 npm 上，当然也没有安装过了，所以终端现在还不认识这个命令。通常我们想本地测试一个 npm 包，可以使用：npm link 这个命令，本地安装这个包，我们执行一下：
    </p>
    <pre><code class="prism language-javascript">npm link
</code></pre>
    <p>
     然后再执行
    </p>
    <pre><code class="prism language-javascript">test<span class="token operator">-</span>abc
</code></pre>
    <p>
     就会看输出 ‘test-abc‘ 啦
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/e5e1a7b868b1e1775246dd614d418aa6.png"/>
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f71715f34313430323830392f:61727469636c652f64657461696c732f313138303236363537" class_="artid" style="display:none">
 </p>
</div>


