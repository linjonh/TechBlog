---
layout: post
title: 数据库连接池的几种配置方法
date: 2025-01-16 19:50:57 +0800
categories: [java]
tags: []
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=51398011
    alt: 数据库连接池的几种配置方法
artid: 51398011
render_with_liquid: false
---
<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     数据库连接池的几种配置方法
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <p style="margin-top:22px; margin-bottom:22px; text-indent:2em; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,Arial,sans-serif; font-size:14px; line-height:28px">
     <a href="http://www.cr173.com/k/sql/" rel="nofollow noopener noreferrer" style="color:rgb(0,82,157); outline:none medium" target="_blank">
      数据库
     </a>
     连接是一种关键的有限的昂贵的资源,这在多用户网页应用程序中体现的尤为突出.对数据库连接的管理能显著影响到整个应用程序的伸缩性和健壮性,影响到程序的性能指标,数据库连接池正是针对这个问题提出的.
    </p>
    <p style="margin-top:22px; margin-bottom:22px; text-indent:2em; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,Arial,sans-serif; font-size:14px; line-height:28px">
     数据库连接池负责分配,管理和释放数据库连接,它允许应用程序重复使用一个现有的数据库连接,而不是再重新建立一个;释放空闲时间超过最大空闲时间的数据库连接来避免因为没有释放数据库连接而引起的数据库连接遗漏,这样可以明显提高对数据库操作的性能.
    </p>
    <p style="margin-top:22px; margin-bottom:22px; text-indent:2em; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,Arial,sans-serif; font-size:14px; line-height:28px">
     数据库连接池在初始化的时将创建一定数量的数据库连接放到连接池中,这些数据库连接的数量是又最小数据库连接数来设定的,无论这些数据库连接是否被使用,连接池都将一直保证至少拥有这么多的连接数,当应用程序向连接池请求的连接数超过最大连接数量时,这些请求将被加入到等待队列中.
    </p>
    <p style="margin-top:22px; margin-bottom:22px; text-indent:2em; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,Arial,sans-serif; font-size:14px; line-height:28px">
     <span style="">
      数据库连接池的最小连接数和最大连接数的设置
     </span>
     要考虑到下列几个因素:
    </p>
    <p style="margin-top:22px; margin-bottom:22px; text-indent:2em; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,Arial,sans-serif; font-size:14px; line-height:28px">
     1.最小连接数是连接池一直保持的数据库连接,所以如果应用程序对数据库连接的使用量不大,将会有大量的数据库连接资源被浪费.
    </p>
    <p style="margin-top:22px; margin-bottom:22px; text-indent:2em; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,Arial,sans-serif; font-size:14px; line-height:28px">
     2.最大连接数是连接池申请的最大连接数,如果数据库连接请求超过次数,后面的数据库连接请求将被加入到等待对了中,这回影响之后的数据库操作
    </p>
    <p style="margin-top:22px; margin-bottom:22px; text-indent:2em; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,Arial,sans-serif; font-size:14px; line-height:28px">
     如果最小连接数与最大连接数相差太大,那么最先的连接请求将会获利,之后超过最小连接数量的连接请求等价于建立一个新的数据库连接,不过,这些小于最小连接数的数据库连接在使用完不会马上被释放,它将被放到连接池中等待重复使用或是空闲超时被释放.
    </p>
    <p style="margin-top:22px; margin-bottom:22px; text-indent:2em; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,Arial,sans-serif; font-size:14px; line-height:28px">
     实例使用的Tomcat版本为6.0
    </p>
    <p style="margin-top:22px; margin-bottom:22px; text-indent:2em; font-family:'Helvetica Neue',Helvetica,Arial,sans-serif; font-size:14px; line-height:28px">
     <span style="color:#ff0000">
      方法一: 在Tomcat的conf/context.xml中配置
     </span>
     <br style=""/>
     <span style="color:#333333">
      在Tomcat\apache-tomcat-6.0.33\conf目录下的context.xml文件中配置默认值如下:
     </span>
    </p>
    <pre style="padding:9.5px; font-family:Monaco,Menlo,Consolas,'Courier New',monospace; font-size:13px; color:rgb(51,51,51); margin-top:0px; margin-bottom:10px; line-height:20px; word-break:break-all; word-wrap:break-word; white-space:pre-wrap; background-color:rgb(245,245,245)">&lt;?xml version='1.0' enc<a href="http://www.cr173.com/k/odin/" rel="nofollow noopener noreferrer" style="color:rgb(0,82,157); outline:none medium" target="_blank">odin</a>g='utf-8'?&gt;
&lt;Context&gt;
    &lt;WatchedResource&gt;WEB-INF/web.xml&lt;/WatchedResource&gt;
&lt;/Context&gt;</pre>
    <p style="margin-top:22px; margin-bottom:22px; text-indent:2em; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,Arial,sans-serif; font-size:14px; line-height:28px">
     <span style="">
      配置连接池：
     </span>
    </p>
    <p style="margin-top:22px; margin-bottom:22px; text-indent:2em; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,Arial,sans-serif; font-size:14px; line-height:28px">
     &lt;?xml version='1.0' encoding='utf-8'?&gt;
     <br style=""/>
    </p>
    <pre style="padding:9.5px; font-family:Monaco,Menlo,Consolas,'Courier New',monospace; font-size:13px; color:rgb(51,51,51); margin-top:0px; margin-bottom:10px; line-height:20px; word-break:break-all; word-wrap:break-word; white-space:pre-wrap; background-color:rgb(245,245,245)">&lt;Context&gt;
    &lt;WatchedResource&gt;WEB-INF/web.xml&lt;/WatchedResource&gt;

    &lt;!--配置oracle数据库的连接池--&gt;
    &lt;Resource name="jdbc/oracleds"
        author="Container"
        type="javax.sql.DataSource"
        maxActive="100"
        maxIdle="30"
        maxWait="10000"
        username="scott"
        password="tiger"
        driverClassName="oracle.jdbc.dirver.OracleDriver"
        url="jdbc:oracle:thin:@127.0.0.1:1521:ora9" /&gt;

    &lt;!--配置<a href="http://www.cr173.com/k/mysql/" rel="nofollow noopener noreferrer" style="color:rgb(0,82,157); outline:none medium" target="_blank">mysql数据库</a>的连接池, 
        需要做的额外步骤是将mysql的Java驱动类放到tomcat的lib目录下        
        maxIdle 连接池中最多可空闲maxIdle个连接 
        minIdle 连接池中最少空闲maxIdle个连接 
        initialSize 初始化连接数目 
        maxWait 连接池中连接用完时,新的请求等待时间,毫秒 
        username 数据库用户名
        password 数据库密码
        --&gt;
    &lt;Resource name="jdbc/mysqlds" 
        auth="Container" 
        type="javax.sql.DataSource" 
        username="root" 
        password="root" 
        maxIdle="30" 
        maxWait="10000" 
        maxActive="100"
        driverClassName="com.mysql.jdbc.Driver"
        url="jdbc:mysql://127.0.0.1:3306/db_blog" /&gt;

&lt;/Context&gt;</pre>
    <p style="margin-top:22px; margin-bottom:22px; text-indent:2em; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,Arial,sans-serif; font-size:14px; line-height:28px">
     配置好后需要注意的
     <span style="">
      两个步骤
     </span>
     <br style=""/>
    </p>
    <p style="margin-top:22px; margin-bottom:22px; text-indent:2em; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,Arial,sans-serif; font-size:14px; line-height:28px">
     1.将对应数据库的驱动类放到tomcat的lib目录西安
    </p>
    <p style="margin-top:22px; margin-bottom:22px; text-indent:2em; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,Arial,sans-serif; font-size:14px; line-height:28px">
     2.重新启动tomcat服务器,让配置生效
    </p>
    <p style="margin-top:22px; margin-bottom:22px; text-indent:2em; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,Arial,sans-serif; font-size:14px; line-height:28px">
     在web应用程序的web.xml中设置数据源参考,如下：
    </p>
    <p style="margin-top:22px; margin-bottom:22px; text-indent:2em; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,Arial,sans-serif; font-size:14px; line-height:28px">
     在&lt;web-app&gt;&lt;/web-app&gt;节点中加入下面内容
    </p>
    <p style="margin-top:22px; margin-bottom:22px; text-indent:2em; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,Arial,sans-serif; font-size:14px; line-height:28px">
     &lt;resource-ref&gt;
     <br style=""/>
    </p>
    <pre style="padding:9.5px; font-family:Monaco,Menlo,Consolas,'Courier New',monospace; font-size:13px; color:rgb(51,51,51); margin-top:0px; margin-bottom:10px; line-height:20px; word-break:break-all; word-wrap:break-word; white-space:pre-wrap; background-color:rgb(245,245,245)">      &lt;description&gt;mysql数据库连接池&lt;/description&gt;
      &lt;!-- 参考数据源名字,同Tomcat中配置的Resource节点中name属性值"jdbc/mysqlds"一致 --&gt;
      &lt;res-ref-name&gt;jdbc/mysqlds&lt;/res-ref-name&gt;
      &lt;!-- 资源类型 --&gt;
      &lt;res-type&gt;javax.sql.DataSource&lt;/res-type&gt;
      &lt;res-auth&gt;Container&lt;/res-auth&gt;
      &lt;res-sharing-scope&gt;Shareable&lt;/res-sharing-scope&gt;
&lt;/resource-ref&gt;</pre>
    <p style="margin-top:22px; margin-bottom:22px; text-indent:2em; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,Arial,sans-serif; font-size:14px; line-height:28px">
     <span style="">
      错误解决：
     </span>
     <br style=""/>
    </p>
    <p style="margin-top:22px; margin-bottom:22px; text-indent:2em; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,Arial,sans-serif; font-size:14px; line-height:28px">
     javax.naming.NoInitialContextException: Need to specify class name in environment or system property, or as an applet parameter, or in an application resource file: java.naming.factory.initial
     <br style=""/>
    </p>
    <pre style="padding:9.5px; font-family:Monaco,Menlo,Consolas,'Courier New',monospace; font-size:13px; color:rgb(51,51,51); margin-top:0px; margin-bottom:10px; line-height:20px; word-break:break-all; word-wrap:break-word; white-space:pre-wrap; background-color:rgb(245,245,245)">    at javax.naming.spi.NamingManager.getInitialContext(NamingManager.java:645)
    at javax.naming.InitialContext.getDefaultInitCtx(InitialContext.java:288)
    at javax.naming.InitialContext.getURLOrDefaultInitCtx(InitialContext.java:325)
    at javax.naming.InitialContext.lookup(InitialContext.java:392)
    at com.iblog.util.DBPoolUtil.&lt;clinit&gt;(DBPoolUtil.java:34)</pre>
    <p style="margin-top:22px; margin-bottom:22px; text-indent:2em; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,Arial,sans-serif; font-size:14px; line-height:28px">
     <span style="">
      解决方案:
     </span>
     <br style=""/>
    </p>
    <p style="margin-top:22px; margin-bottom:22px; text-indent:2em; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,Arial,sans-serif; font-size:14px; line-height:28px">
     上面的异常信息是配置文件中JNDI没有初始化造成的
    </p>
    <p style="margin-top:22px; margin-bottom:22px; text-indent:2em; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,Arial,sans-serif; font-size:14px; line-height:28px">
     如果下面的问题都不存在
    </p>
    <p style="margin-top:22px; margin-bottom:22px; text-indent:2em; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,Arial,sans-serif; font-size:14px; line-height:28px">
     1.要去检查下配置文件中连接数据库的URL参数是否正确2.以及是否导入了正常的包3.检查在Tomcat中conf/server.xml文件，检查是否设置useNaming="false"，如果是，去掉
    </p>
    <p style="margin-top:22px; margin-bottom:22px; text-indent:2em; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,Arial,sans-serif; font-size:14px; line-height:28px">
     2.那就是通过main方法测试的,这个数据源不支持这样的测试方法,程序要运行在Tomcat中才能找到相应的数据源.[我在测试时犯这样的错导致上面错误出现]
    </p>
    <p style="margin-top:22px; margin-bottom:22px; text-indent:2em; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,Arial,sans-serif; font-size:14px; line-height:28px">
     &lt;%@ page language="java" pageEncoding="UTF-8" contentType="text/html; charset=UTF-8"%&gt;
     <br style=""/>
    </p>
    <pre style="padding:9.5px; font-family:Monaco,Menlo,Consolas,'Courier New',monospace; font-size:13px; color:rgb(51,51,51); margin-top:0px; margin-bottom:10px; line-height:20px; word-break:break-all; word-wrap:break-word; white-space:pre-wrap; background-color:rgb(245,245,245)">&lt;%@ page import="java.sql.*" %&gt;     
&lt;%@ page import="javax.naming.*" %&gt;     
&lt;%@ page import="javax.sql.DataSource" %&gt;</pre>
    <pre style="padding:9.5px; font-family:Monaco,Menlo,Consolas,'Courier New',monospace; font-size:13px; color:rgb(51,51,51); margin-top:0px; margin-bottom:10px; line-height:20px; word-break:break-all; word-wrap:break-word; white-space:pre-wrap; background-color:rgb(245,245,245)"><span style="color:rgb(165,137,16); font-family:宋体; font-size:14px; line-height:26px">import="java.sql.*, javax.sql.*, javax.naming.*</span>
&lt;html&gt;     
&lt;head&gt;     
&lt;title&gt;Tomcat6.0 JNDI!&lt;/title&gt;    
&lt;/head&gt;    
  &lt;body&gt;      
   Tomcat连接池测试,获取数据源 &lt;br&gt;     
    &lt;%     
        try {      
            //初始化查找命名空间
            Context ctx = new InitialContext();  
            //参数java:/comp/env为固定路径   
            Context envContext = (Context)ctx.lookup("java:/comp/env"); 
            //参数jdbc/mysqlds为数据源和JNDI绑定的名字
            DataSource ds = (DataSource)envContext.lookup("jdbc/mysqlds"); 
            Connection conn = ds.getConnection();     
            conn.close();     
            out.println("&lt;span style='color:red;'&gt;JNDI测试成功&lt;span&gt;");     
        } catch (NamingException e) {     
            e.printStackTrace();     
        } catch (SQLException e) {     
            e.printStackTrace();     
        }     
    %&gt;     
  &lt;/body&gt;     
&lt;/html&gt;   </pre>
    <p style="margin-top:22px; margin-bottom:22px; text-indent:2em; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,Arial,sans-serif; font-size:14px; line-height:28px">
     <span style="">
      运行效果:
     </span>
     <br style=""/>
    </p>
    <p align="center" style="margin-top:22px; margin-bottom:22px; text-indent:2em; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,Arial,sans-serif; font-size:14px; line-height:28px">
     <img alt="" src="https://i-blog.csdnimg.cn/blog_migrate/c3c32e12799e855a02b7def92a0c084b.png" style="height:auto; max-width:700px; vertical-align:middle; border:0px"/>
    </p>
    <p style="margin-top:22px; margin-bottom:22px; text-indent:2em; font-family:'Helvetica Neue',Helvetica,Arial,sans-serif; font-size:14px; line-height:28px">
     <span style="color:#ff0000">
      方法二:在Tomcat的conf/server.xml中配置
     </span>
    </p>
    <p style="margin-top:22px; margin-bottom:22px; text-indent:2em; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,Arial,sans-serif; font-size:14px; line-height:28px">
     打开tomcat的conf/server.xml文件,找到&lt;GlobalNamingResources&gt;&lt;/GlobalNamingResources&gt;节点,默认的内容如下
    </p>
    <p style="margin-top:22px; margin-bottom:22px; text-indent:2em; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,Arial,sans-serif; font-size:14px; line-height:28px">
     &lt;GlobalNamingResources&gt;
     <br style=""/>
    </p>
    <pre style="padding:9.5px; font-family:Monaco,Menlo,Consolas,'Courier New',monospace; font-size:13px; color:rgb(51,51,51); margin-top:0px; margin-bottom:10px; line-height:20px; word-break:break-all; word-wrap:break-word; white-space:pre-wrap; background-color:rgb(245,245,245)">    &lt;Resource name="UserDatabase" auth="Container"
              type="org.apache.catalina.UserDatabase"
              description="User database that can be updated and saved"
              factory="org.apache.catalina.users.MemoryUserDatabaseFactory"
              pathname="conf/tomcat-users.xml" /&gt;
&lt;/GlobalNamingResources&gt;</pre>
    <p style="margin-top:22px; margin-bottom:22px; text-indent:2em; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,Arial,sans-serif; font-size:14px; line-height:28px">
     在该节点中加入相关的池配置信息,如下
     <br style=""/>
    </p>
    <p style="margin-top:22px; margin-bottom:22px; text-indent:2em; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,Arial,sans-serif; font-size:14px; line-height:28px">
     &lt;GlobalNamingResources&gt;
     <br style=""/>
    </p>
    <pre style="padding:9.5px; font-family:Monaco,Menlo,Consolas,'Courier New',monospace; font-size:13px; color:rgb(51,51,51); margin-top:0px; margin-bottom:10px; line-height:20px; word-break:break-all; word-wrap:break-word; white-space:pre-wrap; background-color:rgb(245,245,245)">             &lt;Resource name="UserDatabase" auth="Container"
              type="org.apache.catalina.UserDatabase"
              description="User database that can be updated and saved"
              factory="org.apache.catalina.users.MemoryUserDatabaseFactory"
              pathname="conf/tomcat-users.xml" /&gt;

             &lt;!--配置mysql数据库的连接池, 
                需要做的额外步骤是将mysql的Java驱动类放到tomcat的lib目录下        
               --&gt;
             &lt;Resource name="jdbc/mysqlds" 
              auth="Container" 
              type="javax.sql.DataSource" 
              username="root" 
              password="root" 
              maxIdle="30" 
              maxWait="10000" 
              maxActive="100"
              driverClassName="com.mysql.jdbc.Driver"
              url="jdbc:mysql://127.0.0.1:3306/db_blog" /&gt;
  &lt;/GlobalNamingResources&gt;</pre>
    <p style="margin-top:22px; margin-bottom:22px; text-indent:2em; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,Arial,sans-serif; font-size:14px; line-height:28px">
     在tomcat的conf/context.xml文件中的&lt;Context&gt;&lt;/Context&gt;节点中加入如下内容
     <br style=""/>
    </p>
    <pre style="padding:9.5px; font-family:Monaco,Menlo,Consolas,'Courier New',monospace; font-size:13px; color:rgb(51,51,51); margin-top:0px; margin-bottom:10px; line-height:20px; word-break:break-all; word-wrap:break-word; white-space:pre-wrap; background-color:rgb(245,245,245)">&lt;ResourceLink name="jdbc/mysqlds" global="jdbc/mysqlds" type="javax.sql.DataSource"/&gt;</pre>
    <p style="margin-top:22px; margin-bottom:22px; text-indent:2em; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,Arial,sans-serif; font-size:14px; line-height:28px">
     然后在web项目中的WEB-INF目录下的web.xml中配置
    </p>
    <p style="margin-top:22px; margin-bottom:22px; text-indent:2em; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,Arial,sans-serif; font-size:14px; line-height:28px">
     &lt;resource-ref&gt;
     <br style=""/>
    </p>
    <pre style="padding:9.5px; font-family:Monaco,Menlo,Consolas,'Courier New',monospace; font-size:13px; color:rgb(51,51,51); margin-top:0px; margin-bottom:10px; line-height:20px; word-break:break-all; word-wrap:break-word; white-space:pre-wrap; background-color:rgb(245,245,245)">      &lt;description&gt;mysql数据库连接池&lt;/description&gt;
      &lt;!-- 参考数据源名字,同Tomcat中配置的Resource节点中name属性值"jdbc/mysqlds"一致 --&gt;
      &lt;res-ref-name&gt;jdbc/mysqlds&lt;/res-ref-name&gt;
      &lt;!-- 资源类型 --&gt;
      &lt;res-type&gt;javax.sql.DataSource&lt;/res-type&gt;
      &lt;res-auth&gt;Container&lt;/res-auth&gt;
      &lt;res-sharing-scope&gt;Shareable&lt;/res-sharing-scope&gt;
&lt;/resource-ref&gt;</pre>
    <p style="margin-top:22px; margin-bottom:22px; text-indent:2em; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,Arial,sans-serif; font-size:14px; line-height:28px">
     同样配置好后,需要重新启动服务器,让配置生效.
     <br style=""/>
    </p>
    <p style="margin-top:22px; margin-bottom:22px; text-indent:2em; font-family:'Helvetica Neue',Helvetica,Arial,sans-serif; font-size:14px; line-height:28px">
     <span style="color:#ff0000">
      方法三:在Tomcat的conf/server.xml中配置虚拟目录时配置
     </span>
    </p>
    <p style="margin-top:22px; margin-bottom:22px; text-indent:2em; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,Arial,sans-serif; font-size:14px; line-height:28px">
     在配置虚拟目录时，也就是在配置conf下面的server.xml时,在context标签内添加池配置.
    </p>
    <p style="margin-top:22px; margin-bottom:22px; text-indent:2em; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,Arial,sans-serif; font-size:14px; line-height:28px">
     在说该方法之前,先说一下,如何用tomcat配置虚拟目录
    </p>
    <p style="margin-top:22px; margin-bottom:22px; text-indent:2em; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,Arial,sans-serif; font-size:14px; line-height:28px">
     在tomcat\conf下server.xml中找到
    </p>
    <pre style="padding:9.5px; font-family:Monaco,Menlo,Consolas,'Courier New',monospace; font-size:13px; color:rgb(51,51,51); margin-top:0px; margin-bottom:10px; line-height:20px; word-break:break-all; word-wrap:break-word; white-space:pre-wrap; background-color:rgb(245,245,245)">&lt;Host name="localhost"  appBase="webap<a href="http://www.cr173.com/k/photoshopcs5/" rel="nofollow noopener noreferrer" style="color:rgb(0,82,157); outline:none medium" target="_blank">PS</a>"
            unpackWARs="true" autoDeploy="true"
            xmlValidation="false" xmlNamespaceAware="false"&gt;
&lt;/Host&gt;</pre>
    <p style="margin-top:22px; margin-bottom:22px; text-indent:2em; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,Arial,sans-serif; font-size:14px; line-height:28px">
     在其中添加：
    </p>
    <pre style="padding:9.5px; font-family:Monaco,Menlo,Consolas,'Courier New',monospace; font-size:13px; color:rgb(51,51,51); margin-top:0px; margin-bottom:10px; line-height:20px; word-break:break-all; word-wrap:break-word; white-space:pre-wrap; background-color:rgb(245,245,245)">&lt;Context path="/website" docBase="F:/myweb" reloadable="true"&gt;&lt;/Context&gt;</pre>
    <p style="margin-top:22px; margin-bottom:22px; text-indent:2em; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,Arial,sans-serif; font-size:14px; line-height:28px">
     注意:
    </p>
    <p style="margin-top:22px; margin-bottom:22px; text-indent:2em; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,Arial,sans-serif; font-size:14px; line-height:28px">
     docBase要改成你的项目目录。
    </p>
    <p style="margin-top:22px; margin-bottom:22px; text-indent:2em; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,Arial,sans-serif; font-size:14px; line-height:28px">
     path为虚拟路径,访问时的路径，注意:一定要加“/” debug建议设置为0
    </p>
    <p style="margin-top:22px; margin-bottom:22px; text-indent:2em; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,Arial,sans-serif; font-size:14px; line-height:28px">
     reloadable设置为true。
    </p>
    <p style="margin-top:22px; margin-bottom:22px; text-indent:2em; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,Arial,sans-serif; font-size:14px; line-height:28px">
     这样重新启动tomcat
    </p>
    <p style="margin-top:22px; margin-bottom:22px; text-indent:2em; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,Arial,sans-serif; font-size:14px; line-height:28px">
     实例中如下配置
    </p>
    <pre style="padding:9.5px; font-family:Monaco,Menlo,Consolas,'Courier New',monospace; font-size:13px; color:rgb(51,51,51); margin-top:0px; margin-bottom:10px; line-height:20px; word-break:break-all; word-wrap:break-word; white-space:pre-wrap; background-color:rgb(245,245,245)">&lt;Context path="/website" docBase="D:/program files/Tomcat/apache-tomcat-6.0.33/weba<a href="http://www.cr173.com/k/pps/" rel="nofollow noopener noreferrer" style="color:rgb(0,82,157); outline:none medium" target="_blank">pps</a>/iblog.war" reloadable="true"&gt;
&lt;/Context&gt;</pre>
    <p style="margin-top:22px; margin-bottom:22px; text-indent:2em; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,Arial,sans-serif; font-size:14px; line-height:28px">
     接下来添加池配置,如下
    </p>
    <p style="margin-top:22px; margin-bottom:22px; text-indent:2em; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,Arial,sans-serif; font-size:14px; line-height:28px">
     &lt;!--配置虚拟目录--&gt;
     <br style=""/>
    </p>
    <pre style="padding:9.5px; font-family:Monaco,Menlo,Consolas,'Courier New',monospace; font-size:13px; color:rgb(51,51,51); margin-top:0px; margin-bottom:10px; line-height:20px; word-break:break-all; word-wrap:break-word; white-space:pre-wrap; background-color:rgb(245,245,245)">&lt;Context path="/website" docBase="D:/program files/Tomcat/apache-tomcat-6.0.33/webapps/iblog.war" reloadable="true"&gt;
            &lt;Resource name="jdbc/mysqlds" 
            auth="Container" 
            type="javax.sql.DataSource" 
            username="root" 
            password="root" 
            maxIdle="30" 
            maxWait="10000" 
            maxActive="100"
            driverClassName="com.mysql.jdbc.Driver"
            url="jdbc:mysql://127.0.0.1:3306/db_blog"
            /&gt;
&lt;/Context&gt;</pre>
    <p style="margin-top:22px; margin-bottom:22px; text-indent:2em; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,Arial,sans-serif; font-size:14px; line-height:28px">
     <span style="">
      启动服务器
     </span>
     ,测试,注意因为我们配置了path值为”/website”,所以访问的路径应该为website.如下图：
     <br style=""/>
    </p>
    <p align="center" style="margin-top:22px; margin-bottom:22px; text-indent:2em; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,Arial,sans-serif; font-size:14px; line-height:28px">
     <img alt="" src="https://i-blog.csdnimg.cn/blog_migrate/1a481bb4732dff73e0ead38965977e9f.png" style="height:auto; max-width:700px; vertical-align:middle; border:0px"/>
    </p>
    <p style="margin-top:22px; margin-bottom:22px; text-indent:2em; font-family:'Helvetica Neue',Helvetica,Arial,sans-serif; font-size:14px; line-height:28px">
     <span style="color:#ff0000">
      方法四:在Web项目中的META-INF目录下
     </span>
     <span style="color:#33ccff; background-color:rgb(0,0,153)">
      新建一个文件context.xml,
     </span>
     <span style="color:#ff0000">
      写入配置
     </span>
    </p>
    <p style="margin-top:22px; margin-bottom:22px; text-indent:2em; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,Arial,sans-serif; font-size:14px; line-height:28px">
     注意:是META-INF目录下,不是WEB-INF目录下新建
    </p>
    <p style="margin-top:22px; margin-bottom:22px; text-indent:2em; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,Arial,sans-serif; font-size:14px; line-height:28px">
     &lt;?xml version='1.0' encoding='utf-8'?&gt;
     <br style=""/>
    </p>
    <pre style="padding:9.5px; font-family:Monaco,Menlo,Consolas,'Courier New',monospace; font-size:13px; color:rgb(51,51,51); margin-top:0px; margin-bottom:10px; line-height:20px; word-break:break-all; word-wrap:break-word; white-space:pre-wrap; background-color:rgb(245,245,245)">&lt;Context&gt;
    &lt;Resource name="jdbc/mysqlds" 
        auth="Container" 
        type="javax.sql.DataSource" 
        username="root" 
        password="root" 
        maxIdle="30" 
        maxWait="10000" 
        maxActive="100"
        driverClassName="com.mysql.jdbc.Driver"
        url="jdbc:mysql://127.0.0.1:3306/db_blog"
        logAbandoned="true" /&gt;
&lt;/Context&gt;</pre>
    <pre style="padding:9.5px; margin-top:0px; margin-bottom:10px; word-break:break-all; word-wrap:break-word"><p style="color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px; line-height:25.2px; white-space:pre-wrap; margin-top:10px; margin-bottom:10px; background-color:rgb(245,245,245)"><span style="line-height:25.2px; font-family:宋体"><span style="line-height:25.2px; color:rgb(0,23,5)">然后在WEB-INF</span>中新建web.xml文件，然后将下面内容复制，保存</span></p><p style="color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px; line-height:25.2px; white-space:pre-wrap; margin-top:10px; margin-bottom:10px; background-color:rgb(245,245,245)"><span style="line-height:25.2px; font-family:宋体"><span style="line-height:25.2px; color:rgb(0,23,5)">   </span><span style="line-height:25.2px; color:rgb(165,137,16)"> &lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span></p><p style="color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px; line-height:25.2px; white-space:pre-wrap; margin-top:10px; margin-bottom:10px; background-color:rgb(245,245,245)"><span style="line-height:25.2px; color:rgb(165,137,16)"><span style="line-height:25.2px; font-family:宋体">&lt;web-app xmlns="http://java.sun.com/xml/ns/javaee"</span></span></p><p style="color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px; line-height:25.2px; white-space:pre-wrap; margin-top:10px; margin-bottom:10px; background-color:rgb(245,245,245)"><span style="line-height:25.2px; color:rgb(165,137,16)"><span style="line-height:25.2px; font-family:宋体">  </span></span>xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"</p><p style="color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px; line-height:25.2px; white-space:pre-wrap; margin-top:10px; margin-bottom:10px; background-color:rgb(245,245,245)"><span style="line-height:25.2px; color:rgb(165,137,16)"><span style="line-height:25.2px; font-family:宋体">  </span></span>xsi:schemaLocation="http://java.sun.com/xml/ns/javaee</p><p style="color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px; line-height:25.2px; white-space:pre-wrap; margin-top:10px; margin-bottom:10px; background-color:rgb(245,245,245)"><span style="line-height:25.2px; color:rgb(165,137,16)"><span style="line-height:25.2px; font-family:宋体">                     </span></span>http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd"</p><p style="color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px; line-height:25.2px; white-space:pre-wrap; margin-top:10px; margin-bottom:10px; background-color:rgb(245,245,245)"><span style="line-height:25.2px; color:rgb(165,137,16)"><span style="line-height:25.2px; font-family:宋体">  </span></span>version="3.0"</p><p style="color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px; line-height:25.2px; white-space:pre-wrap; margin-top:10px; margin-bottom:10px; background-color:rgb(245,245,245)"><span style="line-height:25.2px; color:rgb(165,137,16)"><span style="line-height:25.2px; font-family:宋体">  </span></span>metadata-complete="true"&gt;</p><p style="color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px; line-height:25.2px; white-space:pre-wrap; margin-top:10px; margin-bottom:10px; background-color:rgb(245,245,245)"><span style="line-height:25.2px; color:rgb(165,137,16)"><span style="line-height:25.2px; font-family:宋体"> </span></span></p><p style="color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px; line-height:25.2px; white-space:pre-wrap; margin-top:10px; margin-bottom:10px; background-color:rgb(245,245,245)"><span style="line-height:25.2px; color:rgb(165,137,16)"><span style="line-height:25.2px; font-family:宋体">  </span></span>&lt;display-name&gt;test&lt;/display-name&gt;</p><p style="color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px; line-height:25.2px; white-space:pre-wrap; margin-top:10px; margin-bottom:10px; background-color:rgb(245,245,245)"><span style="line-height:25.2px; color:rgb(165,137,16)"><span style="line-height:25.2px; font-family:宋体">  </span></span>&lt;welcome-file-list&gt;</p><p style="color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px; line-height:25.2px; white-space:pre-wrap; margin-top:10px; margin-bottom:10px; background-color:rgb(245,245,245)"><span style="line-height:25.2px; color:rgb(165,137,16)"><span style="line-height:25.2px; font-family:宋体">    </span></span>&lt;welcome-file&gt;test.jsp&lt;/welcome-file&gt;</p><p style="color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px; line-height:25.2px; white-space:pre-wrap; margin-top:10px; margin-bottom:10px; background-color:rgb(245,245,245)"><span style="line-height:25.2px; color:rgb(165,137,16)"><span style="line-height:25.2px; font-family:宋体">  </span></span>&lt;/welcome-file-list&gt;</p><p style="color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px; line-height:25.2px; white-space:pre-wrap; margin-top:10px; margin-bottom:10px; background-color:rgb(245,245,245)"><span style="line-height:25.2px; color:rgb(165,137,16)"><span style="line-height:25.2px; font-family:宋体">  </span></span>&lt;resource-ref&gt;</p><p style="color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px; line-height:25.2px; white-space:pre-wrap; margin-top:10px; margin-bottom:10px; background-color:rgb(245,245,245)"><span style="line-height:25.2px; color:rgb(165,137,16)"><span style="line-height:25.2px; font-family:宋体">  </span></span>&lt;description&gt;DB Connection&lt;/description&gt;</p><p style="color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px; line-height:25.2px; white-space:pre-wrap; margin-top:10px; margin-bottom:10px; background-color:rgb(245,245,245)"><span style="line-height:25.2px; color:rgb(165,137,16)"><span style="line-height:25.2px; font-family:宋体">  </span></span>&lt;res-ref-name&gt;<span style="color:rgb(51,51,51); font-family:Monaco,Menlo,Consolas,'Courier New',monospace; font-size:13px; line-height:20px">jdbc/mysqlds</span><span style="line-height:25.2px">&lt;/res-ref-name&gt;</span></p><p style="color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px; line-height:25.2px; white-space:pre-wrap; margin-top:10px; margin-bottom:10px; background-color:rgb(245,245,245)"><span style="line-height:25.2px; color:rgb(165,137,16)"><span style="line-height:25.2px; font-family:宋体">  </span></span>&lt;res-type&gt;javax.sql.DataSource&lt;/res-type&gt;</p><p style="color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px; line-height:25.2px; white-space:pre-wrap; margin-top:10px; margin-bottom:10px; background-color:rgb(245,245,245)"><span style="line-height:25.2px; color:rgb(165,137,16)"><span style="line-height:25.2px; font-family:宋体">  </span></span>&lt;res-auth&gt;Container&lt;/res-auth&gt;</p><p style="color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px; line-height:25.2px; white-space:pre-wrap; margin-top:10px; margin-bottom:10px; background-color:rgb(245,245,245)"><span style="line-height:25.2px; color:rgb(165,137,16)"><span style="line-height:25.2px; font-family:宋体">  </span></span>&lt;/resource-ref&gt;</p><p style="color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px; line-height:25.2px; white-space:pre-wrap; margin-top:10px; margin-bottom:10px; background-color:rgb(245,245,245)"><span style="line-height:25.2px; color:rgb(165,137,16)"><span style="line-height:25.2px; font-family:宋体"> </span></span></p><p style="color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px; line-height:25.2px; white-space:pre-wrap; margin-top:10px; margin-bottom:10px; background-color:rgb(245,245,245)"><span style="line-height:25.2px; color:rgb(165,137,16)"><span style="line-height:25.2px; font-family:宋体">&lt;/web-app&gt;</span></span></p><p style="color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px; line-height:25.2px; white-space:pre-wrap; margin-top:10px; margin-bottom:10px; background-color:rgb(245,245,245)"><span style="line-height:25.2px; color:rgb(165,137,16)"><span style="line-height:25.2px; font-family:宋体">

import javax.naming.Context;
import javax.naming.InitialContext;
import javax.sql.DataSource;




 


</span></span></p><p style="color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px; line-height:25.2px; white-space:pre-wrap; margin-top:10px; margin-bottom:10px; background-color:rgb(245,245,245)"><span style="line-height:25.2px; font-family:宋体"><span style="line-height:25.2px; color:rgb(73,73,73)"> 4.</span><span style="line-height:25.2px; color:rgb(73,73,73)">完成后，重启tomcat</span>服务器。</span></p><p style="color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px; line-height:25.2px; white-space:pre-wrap; margin-top:10px; margin-bottom:10px"><span style="line-height:25.2px; color:rgb(73,73,73)"><span style="line-height:25.2px; font-family:宋体"><span style="background-color:rgb(245,245,245)"> 

</span><span style="background-color:rgb(255,0,0)">方法五 
</span></span></span></p><p style="color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px; line-height:25.2px; white-space:pre-wrap; margin-top:10px; margin-bottom:10px"><span style="line-height:25.2px; color:rgb(73,73,73)"><span style="line-height:25.2px; font-family:宋体"></span></span></p><h2 id="articleTitle" style="margin:0px; font-size:24px; font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-weight:500; line-height:1.1; color:rgb(51,51,51)"><span style="background-color:rgb(255,0,0)">Tomcat7 新的数据库连接池Tomcat jdbc pool介绍和配置</span></h2><span style="color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px; line-height:25.2px; background-color:rgb(245,245,245)">1.Tomcat 中直接使用的方法：全局的连接池 </span><span style="background-color:rgb(245,245,245)"><br style="line-height:10px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"/></span><span style="color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px; line-height:25.2px; background-color:rgb(245,245,245)">在conf/server.xml下的&lt;GlobalNamingResources&gt;节点里配置resource，例如：</span><span style="background-color:rgb(245,245,245)">
</span><p></p><p style="font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; line-height:25.2px; white-space:pre-wrap; margin-top:10px; margin-bottom:10px"><span style="line-height:25.2px"><span style="line-height:25.2px; font-family:宋体"><span style="font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; line-height:25.2px"></span></span></span></p><pre class="brush:xml; toolbar: true; auto-links: false;" style="color:rgb(51,51,51); font-size:12px; overflow:auto; font-family:Menlo,Monaco,Consolas,'Courier New',monospace; padding:6px; margin-top:0px; margin-bottom:10px; line-height:1.45; word-break:break-all; word-wrap:break-word; border:none; background-color:rgb(246,246,246)">&lt;Resource name="jdbc/ens"
      auth="Container"
      type="javax.sql.DataSource"
      factory="org.apache.tomcat.jdbc.pool.DataSourceFactory"
      testWhileIdle="true"
      testOnBorrow="true"
      testOnReturn="false"
      validationInterval="30000"
      timeBetweenEvictionRunsMillis="30000"
      maxActive="100"
      minIdle="10"
      maxWait="10000"
      initialSize="10"
      removeAbandonedTimeout="60"
      removeAbandoned="true"
      logAbandoned="true"
      minEvictableIdleTimeMillis="30000"
      jmxEnabled="true"
      jdbcInterceptors=
"org.apache.tomcat.jdbc.pool.interceptor.ConnectionState;org.apache.tomcat.jdbc.pool.interceptor.StatementFinalizer"
      username="root"
      password="123"
      driverClassName="com.mysql.jdbc.Driver"
      url="jdbc:mysql://localhost:3306/ens"/&gt;</pre><p></p><p style="color:rgb(64,64,64); font-size:14px; margin-top:10px; margin-bottom:10px; line-height:25.2px; font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; background-color:rgb(245,245,245)"><br style="line-height:10px"/></p><p style="color:rgb(64,64,64); font-size:14px; margin-top:10px; margin-bottom:10px; line-height:25.2px; font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; background-color:rgb(245,245,245)"><span style="line-height:25.2px">然后，在context.xml文件的&lt;Context&gt;&lt;/Context&gt;节点中添加如下配置：</span></p><pre class="brush:xml; toolbar: true; auto-links: false;" style="color:rgb(51,51,51); font-size:12px; overflow:auto; font-family:Menlo,Monaco,Consolas,'Courier New',monospace; padding:6px; margin-top:0px; margin-bottom:10px; line-height:1.45; word-break:break-all; word-wrap:break-word; border:none; background-color:rgb(246,246,246)">&lt;ResourceLink global="jdbc/ens" name="jdbc/ens" type="javax.sql.DataSource"/&gt;</pre><p style="color:rgb(64,64,64); font-size:14px; margin-top:10px; margin-bottom:10px; line-height:25.2px; font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; background-color:rgb(245,245,245)"><br style="line-height:10px"/></p><p style="color:rgb(64,64,64); font-size:14px; margin-top:10px; margin-bottom:10px; line-height:25.2px; font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; background-color:rgb(245,245,245)"><span style="line-height:25.2px">global="jdbc/ens" 中的参数值("jdbc/ens")必须和上一段&lt;Resource &gt;配置中的name属性的值保持一样。name="jdbc/ens" 这个可以随便取,但是在程序中调用的时候,就应该与name的值保持一致。到这里,连接池已经配置好啦。</span></p><p style="color:rgb(64,64,64); font-size:14px; margin-top:10px; margin-bottom:10px; line-height:25.2px; font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; background-color:rgb(245,245,245)"><span style="line-height:25.2px">用JSP测试一下：</span></p><p style="color:rgb(64,64,64); font-size:14px; margin-top:10px; margin-bottom:10px; line-height:25.2px; font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; background-color:rgb(245,245,245)"></p><pre><code class="language-java">&lt;%@ page language="java" pageEncoding="gbk"%&gt;
&lt;%@page import="java.sql.Connection"%&gt;
&lt;%@page import="javax.naming.Context"%&gt;
&lt;%@page import="javax.naming.InitialContext"%&gt;
&lt;%@page import="javax.sql.DataSource"%&gt;
&lt;%@page import="java.sql.Statement"%&gt;
&lt;%@page import="java.sql.ResultSet"%&gt;
&lt;%
   //连接池的获取
    Connection conn = null;
    DataSource ds = null;
    ResultSet rs  =null;
    Statement stmt = null;
    Context initCtx = new InitialContext();
    ds =(DataSource)initCtx.lookup("java:comp/env/jdbc/ens");
   if(ds!=null){
        out.println("已经获得DataSource!"); 
        out.println("&lt;br&gt;");
        conn = ds.getConnection();
       try{
        stmt = conn.createStatement();
        String sql ="select * from ens_area";
        rs = stmt.executeQuery(sql);
        out.println("以下是从数据库中读取出来的数据:&lt;br&gt;");
            while(rs.next()){
                out.println("&lt;br&gt;");
                out.println(rs.getString("area_name"));
            }
       }catch(Exception ex){
         ex.printStackTrace();
       }finally{
          conn.close();
          rs.close();
          stmt.close();
       }
   }
%&gt;</code></pre><span style="color:rgb(64,64,64); font-size:14px; background-color:rgb(51,204,0)">方法六</span><h2 id="articleTitle" style="color:rgb(51,51,51); font-size:24px; white-space:pre-wrap; margin:0px; font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-weight:500; line-height:1.1"><span style="background-color:rgb(51,204,0)">Tomcat7 新的数据库连接池Tomcat jdbc pool</span></h2>
 
 <div>
  
  <span style="background-color:rgb(51,204,0)"><span style="color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px; line-height:25.2px">Tomcat 在 7.0 以前的版本都是使用commons-dbcp做为连接池的实现，但是 dbcp存在一些问题： </span><br style="line-height:10px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"/><span style="color:#ffffff"><span style="font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px; line-height:25.2px">（1）dbcp 是单线程的，为了保证线程安全会锁整个连接池 </span><br style="line-height:10px; font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"/><span style="font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px; line-height:25.2px">（2）dbcp 性能不佳 </span><br style="line-height:10px; font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"/><span style="font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px; line-height:25.2px">（3）dbcp 太复杂，超过 60 个类，发展滞后。 </span><br style="line-height:10px; font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"/><span style="font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px; line-height:25.2px">因此，通常J2EE中还会使用其它的高性能连接池，如 </span><a href="http://sourceforge.net/projects/c3p0/" rel="nofollow noopener noreferrer" style="text-decoration:none; font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px; line-height:25.2px" target="_blank">C3P0</a><span style="font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px; line-height:25.2px">，还有阿里系的 </span><a href="http://code.alibabatech.com/wiki/display/Druid/Home" rel="nofollow noopener noreferrer" style="text-decoration:none; font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px; line-height:25.2px" target="_blank">druid</a><span style="font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px; line-height:25.2px"> 等。为此，Tomcat 从 7.0 开始引入一个新的模块： </span><a href="https://tomcat.apache.org/tomcat-7.0-doc/jdbc-pool.html" rel="nofollow noopener noreferrer" style="text-decoration:none; font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px; line-height:25.2px" target="_blank">Tomcat jdbc pool</a><span style="font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px; line-height:25.2px"> </span><br style="line-height:10px; font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"/><span style="font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px; line-height:25.2px">tomcat jdbc pool 近乎兼容 dbcp ，性能更高 </span><br style="line-height:10px; font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"/><span style="font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px; line-height:25.2px">异步方式获取连接 </span><br style="line-height:10px; font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"/><span style="font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px; line-height:25.2px">tomcat jdbc pool 是 tomcat 的一个模块，基于 tomcat JULI，使用 Tomcat 的日志框架 </span><br style="line-height:10px; font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"/><span style="font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px; line-height:25.2px">使用 javax.sql.PooledConnection 接口获取连接 </span><br style="line-height:10px; font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"/><span style="font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px; line-height:25.2px">支持高并发应用环境 </span><br style="line-height:10px; font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"/><span style="font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px; line-height:25.2px">超简单，核心文件只有8个，比 c3p0 还少 </span><br style="line-height:10px; font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"/><span style="font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px; line-height:25.2px">更好的空闲连接处理机制 </span><br style="line-height:10px; font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"/><span style="font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px; line-height:25.2px">支持 JMX </span><br style="line-height:10px; font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"/><span style="font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px; line-height:25.2px">支持 XA Connection。 </span><br style="line-height:10px; font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"/><span style="font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px; line-height:25.2px">tomcat jdbc pool 可在 Tomcat 中直接使用，也可以在独立的应用中使用。 </span></span><br style="line-height:10px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"/><span style="color:#404040"><br/></span></span>
 
 </div>
 
 <div style="color:rgb(64,64,64)">
  
  <span style="font-size:14px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; line-height:25.2px; background-color:rgb(51,204,0)">1.web项目中中直接使用的方法： </span>
  
  <span style="font-size:14px; background-color:rgb(51,204,0)"><br style="line-height:10px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"/></span>
  
  <span style="font-size:14px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; line-height:25.2px; background-color:rgb(51,204,0)">在META-INF/context.xml下的<span style="color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px; line-height:25.2px; white-space:pre-wrap; background-color:rgb(51,204,0)">&lt;Context&gt;&lt;/Context&gt;</span>节点里配置resource，例如：</span>
  
  <p style="font-size:14px; margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; background-color:rgb(51,204,0)"></p>
  
  <pre class="brush:xml; toolbar: true; auto-links: false;" style="font-size:12px; overflow:auto; font-family:Menlo,Monaco,Consolas,'Courier New',monospace; padding:6px; margin-top:0px; margin-bottom:10px; line-height:1.45; color:rgb(51,51,51); word-break:break-all; word-wrap:break-word; border:none; background-color:rgb(246,246,246)">&lt;Resource name="j<span style="font-size:12px; line-height:1.45; white-space:pre-wrap">dbc/TestDB</span>"
      auth="Container"
      type="javax.sql.DataSource"
      factory="org.apache.tomcat.jdbc.pool.DataSourceFactory"
      testWhileIdle="true"
      testOnBorrow="true"
      testOnReturn="false"
      validationInterval="30000"
      timeBetweenEvictionRunsMillis="30000"
      maxActive="100"
      minIdle="10"
      maxWait="10000"
      initialSize="10"
      removeAbandonedTimeout="60"
      removeAbandoned="true"
      logAbandoned="true"
      minEvictableIdleTimeMillis="30000"
      jmxEnabled="true"
      jdbcInterceptors=
"org.apache.tomcat.jdbc.pool.interceptor.ConnectionState;org.apache.tomcat.jdbc.pool.interceptor.StatementFinalizer"
      username="root"
      password="123"
      driverClassName="com.mysql.jdbc.Driver"
      url="jdbc:mysql://localhost:3306/ens"/&gt;</pre>
  
  <p style="font-size:14px; margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; background-color:rgb(51,204,0)"><br style="line-height:10px"/></p>
  
  <p style="font-size:14px; margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; background-color:rgb(51,204,0)"><span style="line-height:25.2px">然后，在WEB-INF/web.xml文件的节点中添加如下配置：</span></p>
  
  <pre class="brush:xml; toolbar: true; auto-links: false;" style="font-size:12px; overflow:auto; font-family:Menlo,Monaco,Consolas,'Courier New',monospace; padding:6px; margin-top:0px; margin-bottom:10px; line-height:1.45; color:rgb(51,51,51); word-break:break-all; word-wrap:break-word; border:none; background-color:rgb(246,246,246)">&lt;/resource-ref&gt;
    &lt;resource-ref&gt;
    &lt;description&gt;DB_Connection&lt;/description&gt;
    &lt;res-ref-name&gt;jdbc/TestDB&lt;/res-ref-name&gt;
    &lt;res-type&gt;javax.sql.DataSource&lt;/res-type&gt;
    &lt;res-auth&gt;Container&lt;/res-auth&gt;
  &lt;/resource-ref&gt;</pre>
  
  <p style="font-size:14px; margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; background-color:rgb(51,204,0)"><span style="line-height:25.2px">这个可以随便取,但是在程序中调用的时候,就应该与name的值保持一致。到这里,连接池已经配置好啦。</span></p>
  
  <p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun"><span style="line-height:25.2px; background-color:rgb(255,153,102)"><span style="font-size:48px"><br/></span></span></p>
  
  <p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun"><span style="line-height:25.2px; background-color:rgb(255,153,102)"><span style="font-size:48px"><br/></span></span></p>
  
  <p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun"><span style="line-height:25.2px; background-color:rgb(255,153,102)"><span style="font-size:48px">方法七为单个web项目配置数据池</span></span></p>
  
  <p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun"><span style="line-height:25.2px; background-color:rgb(255,153,102)"><span style="font-size:48px"><br/></span></span></p>
  
  <p style="font-size:14px; margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; background-color:rgb(51,204,0)"><span style="line-height:25.2px"></span></p>
  
  <p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Arial; font-size:14px; line-height:26px"><span style="font-size:18px">1 配置连接池</span></p>
  
  <p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Arial; font-size:14px; line-height:26px"><span style="font-size:18px">   将以下内容保存为context.xml，放在web项目下的META-INF文件夹下：</span></p>
  
  <p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Arial; font-size:14px; line-height:26px"><span style="font-size:18px">   </span></p>
  
  <div class="dp-highlighter bg_html" style="font-family:Consolas,'Courier New',Courier,mono,serif; font-size:12px; width:936.925px; overflow:auto; padding-top:1px; line-height:26px; margin:18px 0px!important; background-color:rgb(231,229,220)">
   
   <div class="bar" style="padding-left:45px">
    
    <div class="tools" style="padding:3px 8px 10px 10px; font-size:9px; line-height:normal; font-family:Verdana,Geneva,Arial,Helvetica,sans-serif; color:silver; border-left-width:3px; border-left-style:solid; border-left-color:rgb(108,226,108); background-color:rgb(248,248,248)">
     
     <strong>[html]</strong> 
     
     <a class="ViewSource" href="http://blog.csdn.net/dliyuedong/article/details/23332567#" rel="noopener noreferrer" style="color:rgb(160,160,160); text-decoration:none; border:none; padding:1px; margin:0px 10px 0px 0px; font-size:9px; display:inline-block; width:16px; height:16px; text-indent:-2000px; background-color:inherit" target="_blank" title="view plain">view plain</a>
     
      <a class="CopyToClipboard" href="http://blog.csdn.net/dliyuedong/article/details/23332567#" rel="noopener noreferrer" style="color:rgb(160,160,160); text-decoration:none; border:none; padding:1px; margin:0px 10px 0px 0px; font-size:9px; display:inline-block; width:16px; height:16px; text-indent:-2000px; background-color:inherit" target="_blank" title="copy">copy</a>
     
     <div style="position:absolute; left:390px; top:648px; width:18px; height:18px; z-index:99"></div>
     
      
     
     <span class="tracking-ad"><a href="https://code.csdn.net/snippets/284204" rel="nofollow noopener noreferrer" style="color:rgb(160,160,160); text-decoration:none; border:none; padding:1px; margin:0px 10px 0px 0px; font-size:9px; display:inline-block; width:16px; height:16px; background-color:inherit" target="_blank" title="在CODE上查看代码片"><img alt="在CODE上查看代码片" height="12" src="https://code.csdn.net/assets/CODE_ico.png" style="border:none; max-width:100%; position:relative; top:1px; left:2px" width="12"/></a></span>
     
     <span class="tracking-ad"><a href="https://code.csdn.net/snippets/284204/fork" rel="nofollow noopener noreferrer" style="color:rgb(160,160,160); text-decoration:none; border:none; padding:1px; margin:0px 10px 0px 0px; font-size:9px; display:inline-block; width:16px; height:16px; background-color:inherit" target="_blank" title="派生到我的代码片"><img alt="派生到我的代码片" height="12" src="https://code.csdn.net/assets/ico_fork.svg" style="border:none; max-width:100%; position:relative; top:2px; left:2px" width="12"/></a></span>
    
    </div>
   
   </div>
   
   <ol class="dp-xml" start="1" style="padding:0px; border:none; color:rgb(92,92,92); margin:0px 0px 1px 45px!important; background-color:rgb(255,255,255)"><li class="alt" style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; color:inherit; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"><span class="tag" style="margin:0px; padding:0px; border:none; color:rgb(153,51,0); font-weight:bold; background-color:inherit">&lt;?</span><span class="tag-name" style="margin:0px; padding:0px; border:none; color:rgb(153,51,0); font-weight:bold; background-color:inherit">xml</span><span style="margin:0px; padding:0px; border:none; background-color:inherit"> </span><span class="attribute" style="margin:0px; padding:0px; border:none; color:red; background-color:inherit">version</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">=</span><span class="attribute-value" style="margin:0px; padding:0px; border:none; color:blue; background-color:inherit">"1.0"</span><span style="margin:0px; padding:0px; border:none; background-color:inherit"> </span><span class="attribute" style="margin:0px; padding:0px; border:none; color:red; background-color:inherit">encoding</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">=</span><span class="attribute-value" style="margin:0px; padding:0px; border:none; color:blue; background-color:inherit">"UTF-8"</span><span class="tag" style="margin:0px; padding:0px; border:none; color:rgb(153,51,0); font-weight:bold; background-color:inherit">?&gt;</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">  </span></span></li><li style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important; background-color:rgb(248,248,248)"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&lt;!DOCTYPE xml<span class="tag" style="margin:0px; padding:0px; border:none; color:rgb(153,51,0); font-weight:bold; background-color:inherit">&gt;</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">  </span></span></li><li class="alt" style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; color:inherit; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"><span class="tag" style="margin:0px; padding:0px; border:none; color:rgb(153,51,0); font-weight:bold; background-color:inherit">&lt;</span><span class="tag-name" style="margin:0px; padding:0px; border:none; color:rgb(153,51,0); font-weight:bold; background-color:inherit">Context</span><span class="tag" style="margin:0px; padding:0px; border:none; color:rgb(153,51,0); font-weight:bold; background-color:inherit">&gt;</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">  </span></span></li><li style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important; background-color:rgb(248,248,248)"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">    <span class="tag" style="margin:0px; padding:0px; border:none; color:rgb(153,51,0); font-weight:bold; background-color:inherit">&lt;</span><span class="tag-name" style="margin:0px; padding:0px; border:none; color:rgb(153,51,0); font-weight:bold; background-color:inherit">Resource</span><span style="margin:0px; padding:0px; border:none; background-color:inherit"> </span><span class="attribute" style="margin:0px; padding:0px; border:none; color:red; background-color:inherit">name</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">=</span><span class="attribute-value" style="margin:0px; padding:0px; border:none; color:blue; background-color:inherit">"jdbc/test"</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">   </span></span></li><li class="alt" style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; color:inherit; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">        <span class="attribute" style="margin:0px; padding:0px; border:none; color:red; background-color:inherit">auth</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">=</span><span class="attribute-value" style="margin:0px; padding:0px; border:none; color:blue; background-color:inherit">"Container"</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">   </span></span></li><li style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important; background-color:rgb(248,248,248)"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">        <span class="attribute" style="margin:0px; padding:0px; border:none; color:red; background-color:inherit">type</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">=</span><span class="attribute-value" style="margin:0px; padding:0px; border:none; color:blue; background-color:inherit">"javax.sql.DataSource"</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">  </span></span></li><li class="alt" style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; color:inherit; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">        <span class="attribute" style="margin:0px; padding:0px; border:none; color:red; background-color:inherit">factory</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">=</span><span class="attribute-value" style="margin:0px; padding:0px; border:none; color:blue; background-color:inherit">"org.apache.tomcat.jdbc.pool.DataSourceFactory"</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">   </span></span></li><li style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important; background-color:rgb(248,248,248)"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">        <span class="attribute" style="margin:0px; padding:0px; border:none; color:red; background-color:inherit">maxActive</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">=</span><span class="attribute-value" style="margin:0px; padding:0px; border:none; color:blue; background-color:inherit">"100"</span><span style="margin:0px; padding:0px; border:none; background-color:inherit"> //最大激活连接  </span></span></li><li class="alt" style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; color:inherit; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">        <span class="attribute" style="margin:0px; padding:0px; border:none; color:red; background-color:inherit">maxIdle</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">=</span><span class="attribute-value" style="margin:0px; padding:0px; border:none; color:blue; background-color:inherit">"30"</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">   //最大空闲连接  </span></span></li><li style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important; background-color:rgb(248,248,248)"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">        <span class="attribute" style="margin:0px; padding:0px; border:none; color:red; background-color:inherit">maxWait</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">=</span><span class="attribute-value" style="margin:0px; padding:0px; border:none; color:blue; background-color:inherit">"1000"</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">  //最大等待数  </span></span></li><li class="alt" style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; color:inherit; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">        <span class="attribute" style="margin:0px; padding:0px; border:none; color:red; background-color:inherit">username</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">=</span><span class="attribute-value" style="margin:0px; padding:0px; border:none; color:blue; background-color:inherit">"test"</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">  //数据库用户名  </span></span></li><li style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important; background-color:rgb(248,248,248)"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">        <span class="attribute" style="margin:0px; padding:0px; border:none; color:red; background-color:inherit">password</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">=</span><span class="attribute-value" style="margin:0px; padding:0px; border:none; color:blue; background-color:inherit">"testtest"</span><span style="margin:0px; padding:0px; border:none; background-color:inherit"> //数据库密码  </span></span></li><li class="alt" style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; color:inherit; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">        <span class="attribute" style="margin:0px; padding:0px; border:none; color:red; background-color:inherit">driverClassName</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">=</span><span class="attribute-value" style="margin:0px; padding:0px; border:none; color:blue; background-color:inherit">"com.mysql.jdbc.Driver"</span><span style="margin:0px; padding:0px; border:none; background-color:inherit"> //此处使用mysql数据库，请自行修改驱动  </span></span></li><li style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important; background-color:rgb(248,248,248)"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">        <span class="attribute" style="margin:0px; padding:0px; border:none; color:red; background-color:inherit">url</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">=</span><span class="attribute-value" style="margin:0px; padding:0px; border:none; color:blue; background-color:inherit">"jdbc:mysql://localhost:3306/test?characterEncoding=UTF-8"</span><span style="margin:0px; padding:0px; border:none; background-color:inherit"> </span><span class="tag" style="margin:0px; padding:0px; border:none; color:rgb(153,51,0); font-weight:bold; background-color:inherit">/&gt;</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">   //test为数据库名，编码为UTF-8  </span></span></li><li class="alt" style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; color:inherit; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"><span class="tag" style="margin:0px; padding:0px; border:none; color:rgb(153,51,0); font-weight:bold; background-color:inherit">&lt;/</span><span class="tag-name" style="margin:0px; padding:0px; border:none; color:rgb(153,51,0); font-weight:bold; background-color:inherit">Context</span><span class="tag" style="margin:0px; padding:0px; border:none; color:rgb(153,51,0); font-weight:bold; background-color:inherit">&gt;</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">  </span></span></li></ol>
  
  </div>
  
  <p style="font-size:14px; margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; background-color:rgb(51,204,0)"><span style="line-height:25.2px">2.项目中web.xml中引用连接池</span></p>
  
  <p style="font-size:14px; margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; background-color:rgb(51,204,0)"><span style="line-height:25.2px"> &lt;description&gt;DB_Connection&lt;/description&gt;<br/>    &lt;res-ref-name&gt;jdbc/TestDB&lt;/res-ref-name&gt;<br/>    &lt;res-type&gt;javax.sql.DataSource&lt;/res-type&gt;<br/>    &lt;res-auth&gt;Container&lt;/res-auth&gt;<br/>  &lt;/resource-ref&gt; <br/></span></p>
  
  <br style="font-family:Arial; font-size:14px; line-height:26px"/>
  
  <p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Arial; font-size:14px; line-height:26px"></p>
  
  <p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Arial; font-size:14px; line-height:26px"><span style="font-size:18px"> 3 代码中引用连接池 </span></p>
  
  <p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Arial; font-size:14px; line-height:26px"><span style="font-size:18px"></span></p>
  
  <div class="dp-highlighter bg_java" style="font-family:Consolas,'Courier New',Courier,mono,serif; font-size:12px; width:936.925px; overflow:auto; padding-top:1px; line-height:26px; margin:18px 0px!important; background-color:rgb(231,229,220)">
   
   <div class="bar" style="padding-left:45px">
    
    <div class="tools" style="padding:3px 8px 10px 10px; font-size:9px; line-height:normal; font-family:Verdana,Geneva,Arial,Helvetica,sans-serif; color:silver; border-left-width:3px; border-left-style:solid; border-left-color:rgb(108,226,108); background-color:rgb(248,248,248)">
     
     <strong>[java]</strong> 
     
     <a class="ViewSource" href="http://blog.csdn.net/dliyuedong/article/details/23332567#" rel="noopener noreferrer" style="color:rgb(160,160,160); text-decoration:none; border:none; padding:1px; margin:0px 10px 0px 0px; font-size:9px; display:inline-block; width:16px; height:16px; text-indent:-2000px; background-color:inherit" target="_blank" title="view plain">view plain</a>
     
      <a class="CopyToClipboard" href="http://blog.csdn.net/dliyuedong/article/details/23332567#" rel="noopener noreferrer" style="color:rgb(160,160,160); text-decoration:none; border:none; padding:1px; margin:0px 10px 0px 0px; font-size:9px; display:inline-block; width:16px; height:16px; text-indent:-2000px; background-color:inherit" target="_blank" title="copy">copy</a>
     
     <div style="position:absolute; left:390px; top:1034px; width:18px; height:18px; z-index:99"></div>
     
      
     
     <span class="tracking-ad"><a href="https://code.csdn.net/snippets/284204" rel="nofollow noopener noreferrer" style="color:rgb(160,160,160); text-decoration:none; border:none; padding:1px; margin:0px 10px 0px 0px; font-size:9px; display:inline-block; width:16px; height:16px; background-color:inherit" target="_blank" title="在CODE上查看代码片"><img alt="在CODE上查看代码片" height="12" src="https://code.csdn.net/assets/CODE_ico.png" style="border:none; max-width:100%; position:relative; top:1px; left:2px" width="12"/></a></span>
     
     <span class="tracking-ad"><a href="https://code.csdn.net/snippets/284204/fork" rel="nofollow noopener noreferrer" style="color:rgb(160,160,160); text-decoration:none; border:none; padding:1px; margin:0px 10px 0px 0px; font-size:9px; display:inline-block; width:16px; height:16px; background-color:inherit" target="_blank" title="派生到我的代码片"><img alt="派生到我的代码片" height="12" src="https://code.csdn.net/assets/ico_fork.svg" style="border:none; max-width:100%; position:relative; top:2px; left:2px" width="12"/></a></span>
    
    </div>
   
   </div>
   
   <ol class="dp-j" start="1" style="padding:0px; border:none; color:rgb(92,92,92); margin:0px 0px 1px 45px!important; background-color:rgb(255,255,255)"><li class="alt" style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; color:inherit; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"><span class="keyword" style="margin:0px; padding:0px; border:none; color:rgb(0,102,153); font-weight:bold; background-color:inherit">package</span><span style="margin:0px; padding:0px; border:none; background-color:inherit"> com.hrb2c.servlet;  </span></span></li><li style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important; background-color:rgb(248,248,248)"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">  </span></li><li class="alt" style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; color:inherit; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"><span class="keyword" style="margin:0px; padding:0px; border:none; color:rgb(0,102,153); font-weight:bold; background-color:inherit">import</span><span style="margin:0px; padding:0px; border:none; background-color:inherit"> java.io.IOException;  </span></span></li><li style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important; background-color:rgb(248,248,248)"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"><span class="keyword" style="margin:0px; padding:0px; border:none; color:rgb(0,102,153); font-weight:bold; background-color:inherit">import</span><span style="margin:0px; padding:0px; border:none; background-color:inherit"> java.io.PrintWriter;  </span></span></li><li class="alt" style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; color:inherit; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"><span class="keyword" style="margin:0px; padding:0px; border:none; color:rgb(0,102,153); font-weight:bold; background-color:inherit">import</span><span style="margin:0px; padding:0px; border:none; background-color:inherit"> java.sql.Connection;  </span></span></li><li style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important; background-color:rgb(248,248,248)"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"><span class="keyword" style="margin:0px; padding:0px; border:none; color:rgb(0,102,153); font-weight:bold; background-color:inherit">import</span><span style="margin:0px; padding:0px; border:none; background-color:inherit"> java.sql.ResultSet;  </span></span></li><li class="alt" style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; color:inherit; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"><span class="keyword" style="margin:0px; padding:0px; border:none; color:rgb(0,102,153); font-weight:bold; background-color:inherit">import</span><span style="margin:0px; padding:0px; border:none; background-color:inherit"> java.sql.SQLException;  </span></span></li><li style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important; background-color:rgb(248,248,248)"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"><span class="keyword" style="margin:0px; padding:0px; border:none; color:rgb(0,102,153); font-weight:bold; background-color:inherit">import</span><span style="margin:0px; padding:0px; border:none; background-color:inherit"> java.sql.Statement;  </span></span></li><li class="alt" style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; color:inherit; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"><span class="keyword" style="margin:0px; padding:0px; border:none; color:rgb(0,102,153); font-weight:bold; background-color:inherit">import</span><span style="margin:0px; padding:0px; border:none; background-color:inherit"> java.util.concurrent.Future;  </span></span></li><li style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important; background-color:rgb(248,248,248)"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">  </span></li><li class="alt" style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; color:inherit; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"><span class="keyword" style="margin:0px; padding:0px; border:none; color:rgb(0,102,153); font-weight:bold; background-color:inherit">import</span><span style="margin:0px; padding:0px; border:none; background-color:inherit"> javax.naming.Context;  </span></span></li><li style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important; background-color:rgb(248,248,248)"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"><span class="keyword" style="margin:0px; padding:0px; border:none; color:rgb(0,102,153); font-weight:bold; background-color:inherit">import</span><span style="margin:0px; padding:0px; border:none; background-color:inherit"> javax.naming.InitialContext;  </span></span></li><li class="alt" style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; color:inherit; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"><span class="keyword" style="margin:0px; padding:0px; border:none; color:rgb(0,102,153); font-weight:bold; background-color:inherit">import</span><span style="margin:0px; padding:0px; border:none; background-color:inherit"> javax.naming.NamingException;  </span></span></li><li style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important; background-color:rgb(248,248,248)"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"><span class="keyword" style="margin:0px; padding:0px; border:none; color:rgb(0,102,153); font-weight:bold; background-color:inherit">import</span><span style="margin:0px; padding:0px; border:none; background-color:inherit"> javax.servlet.ServletException;  </span></span></li><li class="alt" style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; color:inherit; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"><span class="keyword" style="margin:0px; padding:0px; border:none; color:rgb(0,102,153); font-weight:bold; background-color:inherit">import</span><span style="margin:0px; padding:0px; border:none; background-color:inherit"> javax.servlet.annotation.WebServlet;  </span></span></li><li style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important; background-color:rgb(248,248,248)"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"><span class="keyword" style="margin:0px; padding:0px; border:none; color:rgb(0,102,153); font-weight:bold; background-color:inherit">import</span><span style="margin:0px; padding:0px; border:none; background-color:inherit"> javax.servlet.http.HttpServlet;  </span></span></li><li class="alt" style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; color:inherit; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"><span class="keyword" style="margin:0px; padding:0px; border:none; color:rgb(0,102,153); font-weight:bold; background-color:inherit">import</span><span style="margin:0px; padding:0px; border:none; background-color:inherit"> javax.servlet.http.HttpServletRequest;  </span></span></li><li style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important; background-color:rgb(248,248,248)"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"><span class="keyword" style="margin:0px; padding:0px; border:none; color:rgb(0,102,153); font-weight:bold; background-color:inherit">import</span><span style="margin:0px; padding:0px; border:none; background-color:inherit"> javax.servlet.http.HttpServletResponse;  </span></span></li><li class="alt" style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; color:inherit; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">  </span></li><li style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important; background-color:rgb(248,248,248)"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"><span class="keyword" style="margin:0px; padding:0px; border:none; color:rgb(0,102,153); font-weight:bold; background-color:inherit">import</span><span style="margin:0px; padding:0px; border:none; background-color:inherit"> org.apache.tomcat.jdbc.pool.DataSource;  </span></span></li><li class="alt" style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; color:inherit; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">  </span></li><li style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important; background-color:rgb(248,248,248)"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"><span class="comment" style="margin:0px; padding:0px; border:none; color:rgb(0,130,0); background-color:inherit">/**</span> </span></li><li class="alt" style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; color:inherit; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"><span class="comment" style="margin:0px; padding:0px; border:none; color:rgb(0,130,0); background-color:inherit"> * 数据库连接池</span> </span></li><li style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important; background-color:rgb(248,248,248)"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"><span class="comment" style="margin:0px; padding:0px; border:none; color:rgb(0,130,0); background-color:inherit"> * </span> </span></li><li class="alt" style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; color:inherit; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"><span class="comment" style="margin:0px; padding:0px; border:none; color:rgb(0,130,0); background-color:inherit"> * @author Yuedong Li</span> </span></li><li style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important; background-color:rgb(248,248,248)"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"><span class="comment" style="margin:0px; padding:0px; border:none; color:rgb(0,130,0); background-color:inherit"> * </span> </span></li><li class="alt" style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; color:inherit; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"><span class="comment" style="margin:0px; padding:0px; border:none; color:rgb(0,130,0); background-color:inherit"> */</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">  </span></span></li><li style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important; background-color:rgb(248,248,248)"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">  </span></li><li class="alt" style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; color:inherit; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"><span class="annotation" style="margin:0px; padding:0px; border:none; color:rgb(100,100,100); background-color:inherit">@WebServlet</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">(</span><span class="string" style="margin:0px; padding:0px; border:none; color:blue; background-color:inherit">"/ConnPoolTest"</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">)  </span></span></li><li style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important; background-color:rgb(248,248,248)"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"><span class="keyword" style="margin:0px; padding:0px; border:none; color:rgb(0,102,153); font-weight:bold; background-color:inherit">public</span><span style="margin:0px; padding:0px; border:none; background-color:inherit"> </span><span class="keyword" style="margin:0px; padding:0px; border:none; color:rgb(0,102,153); font-weight:bold; background-color:inherit">class</span><span style="margin:0px; padding:0px; border:none; background-color:inherit"> ConnPoolTest </span><span class="keyword" style="margin:0px; padding:0px; border:none; color:rgb(0,102,153); font-weight:bold; background-color:inherit">extends</span><span style="margin:0px; padding:0px; border:none; background-color:inherit"> HttpServlet {  </span></span></li><li class="alt" style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; color:inherit; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">    <span class="keyword" style="margin:0px; padding:0px; border:none; color:rgb(0,102,153); font-weight:bold; background-color:inherit">private</span><span style="margin:0px; padding:0px; border:none; background-color:inherit"> </span><span class="keyword" style="margin:0px; padding:0px; border:none; color:rgb(0,102,153); font-weight:bold; background-color:inherit">static</span><span style="margin:0px; padding:0px; border:none; background-color:inherit"> </span><span class="keyword" style="margin:0px; padding:0px; border:none; color:rgb(0,102,153); font-weight:bold; background-color:inherit">final</span><span style="margin:0px; padding:0px; border:none; background-color:inherit"> </span><span class="keyword" style="margin:0px; padding:0px; border:none; color:rgb(0,102,153); font-weight:bold; background-color:inherit">long</span><span style="margin:0px; padding:0px; border:none; background-color:inherit"> serialVersionUID = 1L;  </span></span></li><li style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important; background-color:rgb(248,248,248)"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">    <span class="keyword" style="margin:0px; padding:0px; border:none; color:rgb(0,102,153); font-weight:bold; background-color:inherit">private</span><span style="margin:0px; padding:0px; border:none; background-color:inherit"> Connection con = </span><span class="keyword" style="margin:0px; padding:0px; border:none; color:rgb(0,102,153); font-weight:bold; background-color:inherit">null</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">;  </span></span></li><li class="alt" style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; color:inherit; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">    <span class="keyword" style="margin:0px; padding:0px; border:none; color:rgb(0,102,153); font-weight:bold; background-color:inherit">private</span><span style="margin:0px; padding:0px; border:none; background-color:inherit"> </span><span class="keyword" style="margin:0px; padding:0px; border:none; color:rgb(0,102,153); font-weight:bold; background-color:inherit">static</span><span style="margin:0px; padding:0px; border:none; background-color:inherit"> DataSource datasource;  </span></span></li><li style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important; background-color:rgb(248,248,248)"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">  </span></li><li class="alt" style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; color:inherit; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">    <span class="comment" style="margin:0px; padding:0px; border:none; color:rgb(0,130,0); background-color:inherit">/**</span> </span></li><li style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important; background-color:rgb(248,248,248)"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"><span class="comment" style="margin:0px; padding:0px; border:none; color:rgb(0,130,0); background-color:inherit">     * @see HttpServlet#HttpServlet()</span> </span></li><li class="alt" style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; color:inherit; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"><span class="comment" style="margin:0px; padding:0px; border:none; color:rgb(0,130,0); background-color:inherit">     */</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">  </span></span></li><li style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important; background-color:rgb(248,248,248)"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">    <span class="keyword" style="margin:0px; padding:0px; border:none; color:rgb(0,102,153); font-weight:bold; background-color:inherit">public</span><span style="margin:0px; padding:0px; border:none; background-color:inherit"> ConnPoolTest() {  </span></span></li><li class="alt" style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; color:inherit; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">        <span class="keyword" style="margin:0px; padding:0px; border:none; color:rgb(0,102,153); font-weight:bold; background-color:inherit">super</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">();  </span></span></li><li style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important; background-color:rgb(248,248,248)"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">        <span class="keyword" style="margin:0px; padding:0px; border:none; color:rgb(0,102,153); font-weight:bold; background-color:inherit">try</span><span style="margin:0px; padding:0px; border:none; background-color:inherit"> {  </span></span></li><li class="alt" style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; color:inherit; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">            <span class="comment" style="margin:0px; padding:0px; border:none; color:rgb(0,130,0); background-color:inherit">//获取数据源</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">  </span></span></li><li style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important; background-color:rgb(248,248,248)"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">            datasource = getInstance();  </span></li><li class="alt" style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; color:inherit; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">  </span></li><li style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important; background-color:rgb(248,248,248)"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">            <span class="comment" style="margin:0px; padding:0px; border:none; color:rgb(0,130,0); background-color:inherit">//连接池同步</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">  </span></span></li><li class="alt" style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; color:inherit; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">            Future&lt;Connection&gt; future = datasource.getConnectionAsync();  </span></li><li style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important; background-color:rgb(248,248,248)"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">            <span class="keyword" style="margin:0px; padding:0px; border:none; color:rgb(0,102,153); font-weight:bold; background-color:inherit">while</span><span style="margin:0px; padding:0px; border:none; background-color:inherit"> (!future.isDone()) {  </span></span></li><li class="alt" style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; color:inherit; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">                <span class="comment" style="margin:0px; padding:0px; border:none; color:rgb(0,130,0); background-color:inherit">// 等待连接池同步</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">  </span></span></li><li style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important; background-color:rgb(248,248,248)"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">                Thread.sleep(<span class="number" style="margin:0px; padding:0px; border:none; color:rgb(192,0,0); background-color:inherit">100</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">);  </span></span></li><li class="alt" style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; color:inherit; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">            }  </span></li><li style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important; background-color:rgb(248,248,248)"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">  </span></li><li class="alt" style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; color:inherit; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">            <span class="comment" style="margin:0px; padding:0px; border:none; color:rgb(0,130,0); background-color:inherit">// 获取连接池</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">  </span></span></li><li style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important; background-color:rgb(248,248,248)"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">            con = future.get();  </span></li><li class="alt" style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; color:inherit; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">        } <span class="keyword" style="margin:0px; padding:0px; border:none; color:rgb(0,102,153); font-weight:bold; background-color:inherit">catch</span><span style="margin:0px; padding:0px; border:none; background-color:inherit"> (Exception e) {  </span></span></li><li style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important; background-color:rgb(248,248,248)"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">            e.printStackTrace();  </span></li><li class="alt" style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; color:inherit; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">        }  </span></li><li style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important; background-color:rgb(248,248,248)"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">  </span></li><li class="alt" style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; color:inherit; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">    }  </span></li><li style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important; background-color:rgb(248,248,248)"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">  </span></li><li class="alt" style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; color:inherit; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">    <span class="comment" style="margin:0px; padding:0px; border:none; color:rgb(0,130,0); background-color:inherit">/**</span> </span></li><li style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important; background-color:rgb(248,248,248)"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"><span class="comment" style="margin:0px; padding:0px; border:none; color:rgb(0,130,0); background-color:inherit">     * 单例模式获取数据源</span> </span></li><li class="alt" style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; color:inherit; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"><span class="comment" style="margin:0px; padding:0px; border:none; color:rgb(0,130,0); background-color:inherit">     * @return</span> </span></li><li style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important; background-color:rgb(248,248,248)"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"><span class="comment" style="margin:0px; padding:0px; border:none; color:rgb(0,130,0); background-color:inherit">     * @throws NamingException</span> </span></li><li class="alt" style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; color:inherit; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"><span class="comment" style="margin:0px; padding:0px; border:none; color:rgb(0,130,0); background-color:inherit">     */</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">  </span></span></li><li style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important; background-color:rgb(248,248,248)"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">    <span class="keyword" style="margin:0px; padding:0px; border:none; color:rgb(0,102,153); font-weight:bold; background-color:inherit">private</span><span style="margin:0px; padding:0px; border:none; background-color:inherit"> DataSource getInstance() </span><span class="keyword" style="margin:0px; padding:0px; border:none; color:rgb(0,102,153); font-weight:bold; background-color:inherit">throws</span><span style="margin:0px; padding:0px; border:none; background-color:inherit"> NamingException {  </span></span></li><li class="alt" style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; color:inherit; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">        <span class="keyword" style="margin:0px; padding:0px; border:none; color:rgb(0,102,153); font-weight:bold; background-color:inherit">if</span><span style="margin:0px; padding:0px; border:none; background-color:inherit"> (datasource == </span><span class="keyword" style="margin:0px; padding:0px; border:none; color:rgb(0,102,153); font-weight:bold; background-color:inherit">null</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">) {  </span></span></li><li style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important; background-color:rgb(248,248,248)"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">            Context initContext = <span class="keyword" style="margin:0px; padding:0px; border:none; color:rgb(0,102,153); font-weight:bold; background-color:inherit">new</span><span style="margin:0px; padding:0px; border:none; background-color:inherit"> InitialContext();  </span></span></li><li class="alt" style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; color:inherit; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">            Context envContext = (Context) initContext.lookup(<span class="string" style="margin:0px; padding:0px; border:none; color:blue; background-color:inherit">"java:/comp/env"</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">);  </span></span></li><li style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important; background-color:rgb(248,248,248)"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">            datasource = (DataSource) envContext.lookup(<span class="string" style="margin:0px; padding:0px; border:none; color:blue; background-color:inherit">"jdbc/test"</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">);  </span></span></li><li class="alt" style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; color:inherit; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">        }  </span></li><li style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important; background-color:rgb(248,248,248)"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">        <span class="keyword" style="margin:0px; padding:0px; border:none; color:rgb(0,102,153); font-weight:bold; background-color:inherit">return</span><span style="margin:0px; padding:0px; border:none; background-color:inherit"> datasource;  </span></span></li><li class="alt" style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; color:inherit; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">    }  </span></li><li style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important; background-color:rgb(248,248,248)"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">  </span></li><li class="alt" style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; color:inherit; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">      </span></li><li style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important; background-color:rgb(248,248,248)"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">    <span class="comment" style="margin:0px; padding:0px; border:none; color:rgb(0,130,0); background-color:inherit">/**</span> </span></li><li class="alt" style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; color:inherit; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"><span class="comment" style="margin:0px; padding:0px; border:none; color:rgb(0,130,0); background-color:inherit">     * 处理get方法</span> </span></li><li style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important; background-color:rgb(248,248,248)"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"><span class="comment" style="margin:0px; padding:0px; border:none; color:rgb(0,130,0); background-color:inherit">     */</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">  </span></span></li><li class="alt" style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; color:inherit; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">    <span class="keyword" style="margin:0px; padding:0px; border:none; color:rgb(0,102,153); font-weight:bold; background-color:inherit">protected</span><span style="margin:0px; padding:0px; border:none; background-color:inherit"> </span><span class="keyword" style="margin:0px; padding:0px; border:none; color:rgb(0,102,153); font-weight:bold; background-color:inherit">void</span><span style="margin:0px; padding:0px; border:none; background-color:inherit"> doGet(HttpServletRequest request,  </span></span></li><li style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important; background-color:rgb(248,248,248)"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">            HttpServletResponse response) <span class="keyword" style="margin:0px; padding:0px; border:none; color:rgb(0,102,153); font-weight:bold; background-color:inherit">throws</span><span style="margin:0px; padding:0px; border:none; background-color:inherit"> ServletException, IOException {  </span></span></li><li class="alt" style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; color:inherit; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">        doPost(request, response);  </span></li><li style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important; background-color:rgb(248,248,248)"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">    }  </span></li><li class="alt" style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; color:inherit; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">  </span></li><li style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important; background-color:rgb(248,248,248)"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">    <span class="comment" style="margin:0px; padding:0px; border:none; color:rgb(0,130,0); background-color:inherit">/**</span> </span></li><li class="alt" style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; color:inherit; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"><span class="comment" style="margin:0px; padding:0px; border:none; color:rgb(0,130,0); background-color:inherit">     * 处理post方法</span> </span></li><li style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important; background-color:rgb(248,248,248)"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"><span class="comment" style="margin:0px; padding:0px; border:none; color:rgb(0,130,0); background-color:inherit">     */</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">  </span></span></li><li class="alt" style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; color:inherit; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">    <span class="keyword" style="margin:0px; padding:0px; border:none; color:rgb(0,102,153); font-weight:bold; background-color:inherit">protected</span><span style="margin:0px; padding:0px; border:none; background-color:inherit"> </span><span class="keyword" style="margin:0px; padding:0px; border:none; color:rgb(0,102,153); font-weight:bold; background-color:inherit">void</span><span style="margin:0px; padding:0px; border:none; background-color:inherit"> doPost(HttpServletRequest request,  </span></span></li><li style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important; background-color:rgb(248,248,248)"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">            HttpServletResponse response) <span class="keyword" style="margin:0px; padding:0px; border:none; color:rgb(0,102,153); font-weight:bold; background-color:inherit">throws</span><span style="margin:0px; padding:0px; border:none; background-color:inherit"> ServletException, IOException {  </span></span></li><li class="alt" style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; color:inherit; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">        Statement st;  </span></li><li style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important; background-color:rgb(248,248,248)"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">        StringBuffer buff = <span class="keyword" style="margin:0px; padding:0px; border:none; color:rgb(0,102,153); font-weight:bold; background-color:inherit">new</span><span style="margin:0px; padding:0px; border:none; background-color:inherit"> StringBuffer(</span><span class="string" style="margin:0px; padding:0px; border:none; color:blue; background-color:inherit">"&lt;html&gt;&lt;body&gt;"</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">);  </span></span></li><li class="alt" style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; color:inherit; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">        <span class="keyword" style="margin:0px; padding:0px; border:none; color:rgb(0,102,153); font-weight:bold; background-color:inherit">try</span><span style="margin:0px; padding:0px; border:none; background-color:inherit"> {  </span></span></li><li style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important; background-color:rgb(248,248,248)"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">            <span class="keyword" style="margin:0px; padding:0px; border:none; color:rgb(0,102,153); font-weight:bold; background-color:inherit">if</span><span style="margin:0px; padding:0px; border:none; background-color:inherit"> (con != </span><span class="keyword" style="margin:0px; padding:0px; border:none; color:rgb(0,102,153); font-weight:bold; background-color:inherit">null</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">) {  </span></span></li><li class="alt" style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; color:inherit; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">                <span class="comment" style="margin:0px; padding:0px; border:none; color:rgb(0,130,0); background-color:inherit">//简单查询，test表中有2列，id与name</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">  </span></span></li><li style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important; background-color:rgb(248,248,248)"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">                buff.append(<span class="string" style="margin:0px; padding:0px; border:none; color:blue; background-color:inherit">"id"</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">);  </span></span></li><li class="alt" style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; color:inherit; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">                buff.append(<span class="string" style="margin:0px; padding:0px; border:none; color:blue; background-color:inherit">"  "</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">);  </span></span></li><li style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important; background-color:rgb(248,248,248)"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">                buff.append(<span class="string" style="margin:0px; padding:0px; border:none; color:blue; background-color:inherit">"name"</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">);  </span></span></li><li class="alt" style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; color:inherit; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">                buff.append(<span class="string" style="margin:0px; padding:0px; border:none; color:blue; background-color:inherit">"&lt;br&gt;"</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">);  </span></span></li><li style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important; background-color:rgb(248,248,248)"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">                st = con.createStatement();  </span></li><li class="alt" style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; color:inherit; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">                ResultSet rs = st.executeQuery(<span class="string" style="margin:0px; padding:0px; border:none; color:blue; background-color:inherit">"select * from test"</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">);  </span></span></li><li style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important; background-color:rgb(248,248,248)"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">                <span class="keyword" style="margin:0px; padding:0px; border:none; color:rgb(0,102,153); font-weight:bold; background-color:inherit">while</span><span style="margin:0px; padding:0px; border:none; background-color:inherit"> (rs.next()) {  </span></span></li><li class="alt" style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; color:inherit; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">                    buff.append(rs.getString(<span class="string" style="margin:0px; padding:0px; border:none; color:blue; background-color:inherit">"id"</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">));  </span></span></li><li style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important; background-color:rgb(248,248,248)"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">                    buff.append(<span class="string" style="margin:0px; padding:0px; border:none; color:blue; background-color:inherit">"  "</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">);  </span></span></li><li class="alt" style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; color:inherit; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">                    buff.append(rs.getString(<span class="string" style="margin:0px; padding:0px; border:none; color:blue; background-color:inherit">"name"</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">));  </span></span></li><li style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important; background-color:rgb(248,248,248)"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">                    buff.append(<span class="string" style="margin:0px; padding:0px; border:none; color:blue; background-color:inherit">"&lt;br&gt;"</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">);  </span></span></li><li class="alt" style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; color:inherit; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">                }  </span></li><li style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important; background-color:rgb(248,248,248)"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">            }  </span></li><li class="alt" style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; color:inherit; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">            buff.append(<span class="string" style="margin:0px; padding:0px; border:none; color:blue; background-color:inherit">"&lt;/body&gt;&lt;/html&gt;"</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">);  </span></span></li><li style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important; background-color:rgb(248,248,248)"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">        } <span class="keyword" style="margin:0px; padding:0px; border:none; color:rgb(0,102,153); font-weight:bold; background-color:inherit">catch</span><span style="margin:0px; padding:0px; border:none; background-color:inherit"> (SQLException e) {  </span></span></li><li class="alt" style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; color:inherit; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">            e.printStackTrace();  </span></li><li style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important; background-color:rgb(248,248,248)"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">        }  </span></li><li class="alt" style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; color:inherit; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">        PrintWriter out = response.getWriter();  </span></li><li style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important; background-color:rgb(248,248,248)"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">        out.write(buff.toString());  </span></li><li class="alt" style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; color:inherit; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">    }  </span></li><li style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important; background-color:rgb(248,248,248)"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">  </span></li><li class="alt" style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; color:inherit; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">}  </span></li></ol>
  
  </div>
  
  <br/>
  
  <span style="font-size:14px; background-color:rgb(51,204,0)"><br/></span>
 
 </div><span style="font-family:Arial,Helvetica,sans-serif; background-color:rgb(245,245,245)"><span style="white-space:normal"></span></span></pre>
   </div>
  </div>
 </article>
</div>


