---
layout: post
title: "Zigbee协议栈ZStack构架"
date: 2024-12-13 14:00:18 +0800
description: "﻿﻿协议栈版本信息:ZigBee2006\\ZStack-1.4.3-1.2.11、ZStack协议栈"
keywords: "z-stack协议栈=操作系统抽象层+cc2530主芯片+应用程序框架无线网络应用"
categories: ['Zstack']
tags: ['无标签']
artid: "27353327"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=27353327
    alt: "Zigbee协议栈ZStack构架"
render_with_liquid: false
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     Zigbee协议栈ZStack构架
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <div style="top:0px">
     ﻿﻿
    </div>
    <p style="margin:0cm 0cm 0pt; line-height:16pt">
     <span style="font-size:10.5pt">
      协议栈版本信息
      <span lang="EN-US">
       :
       <a name="OLE_LINK1" target="_blank">
        ZigBee2006
       </a>
       \
       <a name="OLE_LINK2" target="_blank">
        ZStack-1.4.3
       </a>
       -1.2.1
      </span>
     </span>
    </p>
    <p style="margin:0cm 0cm 0pt; line-height:16pt">
     <strong style="">
      <span lang="EN-US" style="font-size:10.5pt">
       1
      </span>
      <span style="font-size:10.5pt">
       、
       <span lang="EN-US">
        ZStack
       </span>
       协议栈构架
      </span>
     </strong>
    </p>
    <p style="margin:0cm 0cm 0pt; line-height:16pt">
     <span style="font-size:10.5pt">
      <wbr/>
      <wbr/>
      Zigbee协议栈就是将各个层定义的协议都集合在一起，以函数的形式实现，并给用户提供一些应用层API,供用户调用。协议栈体系分层架构与协议栈代码文件夹对应表如下：
     </span>
    </p>
    <p style="margin:0cm 0cm 0pt; line-height:16pt">
     <span style="font-size:10.5pt">
      <a href="http://photo.blog.sina.com.cn/showpic.html#blogid=6184e67b01018upb&amp;url=http://s1.sinaimg.cn/orignal/6184e67bxcff08def91a0" rel="nofollow noopener noreferrer" target="_blank">
       <img alt="Zigbee学习第四天-2——Zigbee协议栈ZStack构架" height="245" name="image_operate_3411354532043859" src="https://i-blog.csdnimg.cn/blog_migrate/276b0a7db097fbcd9afbf706272a6666.jpeg" style="width:672px; height:238px" title="Zigbee学习第四天-2——Zigbee协议栈ZStack构架" width="690"/>
      </a>
      <br/>
     </span>
     <span style="text-indent:2em; font-size:10.5pt">
      <span lang="EN-US">
       <wbr/>
       <wbr/>
       <wbr/>
       整个协议栈的构架，如图所示
      </span>
     </span>
    </p>
    <p style="margin:0cm 0cm 0pt; line-height:16pt">
     <span style="text-indent:2em; font-size:10.5pt">
      <span lang="EN-US">
       <a href="http://photo.blog.sina.com.cn/showpic.html#blogid=6184e67b01018upb&amp;url=http://s15.sinaimg.cn/orignal/6184e67bx7b31a81cf7ae" rel="nofollow noopener noreferrer" target="_blank">
        <img alt="Zigbee学习第四天-2——Zigbee协议栈ZStack构架" height="452" src="https://i-blog.csdnimg.cn/blog_migrate/0fcf6d803a698037ffa1813d6b8a5e5b.jpeg" title="Zigbee学习第四天-2——Zigbee协议栈ZStack构架" width="297"/>
       </a>
       <br/>
       APP：应用层目录，这是用户创建各种不同工程的区域，在这个目录中包含了应用层的内容和这个项目的主要内容，在协议栈里面一般是以操作系统的任务实现的。
      </span>
     </span>
    </p>
    <p align="left">
     HAL：硬件层目录，包含有与硬件相关的配置和驱动及操作函数。
    </p>
    <p align="left">
     MAC：MAC 层目录，包含了MAC 层的参数配置文件及其MAC 的LIB 库的函数接口文件。
    </p>
    <p align="left">
     MT： 监控调试层，主要用于调试目的，即实现通过串口调试各层，与各层进行直接交互。
    </p>
    <p align="left">
     NWK：网络层目录，含网络层配置参数文件及网络层库的函数接口文件，APS 层库的函数接口。
    </p>
    <p align="left">
     OSAL：协议栈的操作系统。
    </p>
    <p align="left">
     Profile：AF 层目录，包含AF 层处理函数文件。
    </p>
    <p align="left">
     Security：安全层目录，安全层处理函数接口文件，比如加密函数等。
    </p>
    <p align="left">
     Services：地址处理函数目录，包括着地址模式的定义及地址处理函数。
    </p>
    <p align="left">
     Tools：工程配置目录，包括空间划分及ZStack 相关配置信息。
    </p>
    <p align="left">
     ZDO：ZDO 目录。
    </p>
    <p align="left">
     ZMac： MAC 层目录，包括MAC 层参数配置及MAC 层LIB 库函数回调处理函数。
    </p>
    <p align="left">
     ZMain：主函数目录，包括入口函数main（）及硬件配置文件。
    </p>
    <p align="left">
     Output：输出文件目录，这个EW8051 IDE 自动生成的。
     <wbr/>
    </p>
    <p>
     <strong>
      2、ZigBee2006协议栈源码库结构分析
     </strong>
    </p>
    <p align="left">
     <wbr/>
     <wbr/>
     了解了ZigBee2006协议栈整个构架后，再来看看协议栈源码库结构是什么样的，各层的具体文件是什么，建立不同的项目、添加自己的应用层任务及处理函数需要修改什么文件。
    </p>
    <p align="left">
     <wbr/>
     <wbr/>
     ZigBee2006协议栈ZStack-1.4.2文件目录及说明如下：
    </p>
    <p>
     <wbr/>
     <wbr/>
     <a href="http://photo.blog.sina.com.cn/showpic.html#blogid=6184e67b01018upb&amp;url=http://s1.sinaimg.cn/orignal/6184e67bxcff09286dfa0" rel="nofollow noopener noreferrer" target="_blank">
      <img alt="Zigbee学习第四天-2——Zigbee协议栈ZStack构架" height="426" name="image_operate_20911354532314609" src="https://i-blog.csdnimg.cn/blog_migrate/fc6877cfff7e69f3a88325b027fc233f.jpeg" title="Zigbee学习第四天-2——Zigbee协议栈ZStack构架" width="512"/>
     </a>
     <br/>
     <wbr/>
     <wbr/>
     打开SmapleAPP项目工程
    </p>
    <p align="left">
     <strong>
      先看APP层：
     </strong>
    </p>
    <p align="left">
     <strong>
      <a href="http://photo.blog.sina.com.cn/showpic.html#blogid=6184e67b01018upb&amp;url=http://s7.sinaimg.cn/orignal/6184e67bxcff09b045656" rel="nofollow noopener noreferrer" target="_blank">
       <img alt="Zigbee学习第四天-2——Zigbee协议栈ZStack构架" height="112" name="image_operate_7101354532261187" src="https://i-blog.csdnimg.cn/blog_migrate/d3b0980c62a9ee5f7ce0b0f0db38db02.jpeg" title="Zigbee学习第四天-2——Zigbee协议栈ZStack构架" width="513"/>
      </a>
      <br/>
     </strong>
     <wbr/>
     <wbr/>
     从上图可以看出，对于不同的项目，大部分代码都是相同的，只是在用户应用层，添加了不同的任务及事件处理函数。
     <strong>
      <span style="color:#ed1c24">
       因此一般情况下，用户只需额外添加上图中的三个文件（主文件、头文件、操作系统接口文件）就可以完成一个项目，然后编写自己的任务处理函数就可以了。
      </span>
     </strong>
    </p>
    <p align="left">
     <a name="OLE_LINK4" target="_blank">
     </a>
     <a name="OLE_LINK3" target="_blank">
      <strong>
       HAL
      </strong>
     </a>
     <strong>
      层目录：
     </strong>
    </p>
    <p>
     <a href="http://photo.blog.sina.com.cn/showpic.html#blogid=6184e67b01018upb&amp;url=http://s15.sinaimg.cn/orignal/6184e67bx7b31a935cbde" rel="nofollow noopener noreferrer" target="_blank">
      <img alt="Zigbee学习第四天-2——Zigbee协议栈ZStack构架" height="139" name="image_operate_44731354532313156" src="https://i-blog.csdnimg.cn/blog_migrate/eaaff869ae4e8b62fb3df6a438474b55.jpeg" title="Zigbee学习第四天-2——Zigbee协议栈ZStack构架" width="287"/>
     </a>
     <wbr/>
    </p>
    <p>
     Common目录下的文件是公用文件，基本上与硬件无关，hal_assert.c文件是断言文件，用于调试，hal_drivers.c是驱动文件，抽象出与硬件无关的驱动函数，包含有与硬件相关的配置和驱动及操作函数。Include目录下主要包含各个硬件模块的头文件，Target目录下的文件是跟硬件平台相关的，可以看到有两个平台，其中我们正在用的是CC2430EB平台。
    </p>
    <p align="left">
     <strong>
      MAC层目录：
     </strong>
    </p>
    <p align="left">
     <a href="http://photo.blog.sina.com.cn/showpic.html#blogid=6184e67b01018upb&amp;url=http://s13.sinaimg.cn/orignal/6184e67bxcff09d1a595c" rel="nofollow noopener noreferrer" target="_blank">
      <img alt="Zigbee学习第四天-2——Zigbee协议栈ZStack构架" height="80" name="image_operate_84031354532292937" src="https://i-blog.csdnimg.cn/blog_migrate/2345e5240a3290ab148b388c030e7390.jpeg" title="Zigbee学习第四天-2——Zigbee协议栈ZStack构架" width="266"/>
     </a>
     <br/>
     <wbr/>
     <wbr/>
     <wbr/>
     <wbr/>
     MAC分为高层和低层两层，Include目录下包含了MAC层的参数配置文件及LIB库的函数接口文件。
    </p>
    <p align="left">
     <a href="http://photo.blog.sina.com.cn/showpic.html#blogid=6184e67b01018upb&amp;url=http://s10.sinaimg.cn/orignal/6184e67bxcff09e361ab9" rel="nofollow noopener noreferrer" target="_blank">
      <img alt="Zigbee学习第四天-2——Zigbee协议栈ZStack构架" height="94" name="image_operate_13711354532310406" src="https://i-blog.csdnimg.cn/blog_migrate/70b7d5aa203782af8f4f9a6ce287e58a.jpeg" title="Zigbee学习第四天-2——Zigbee协议栈ZStack构架" width="267"/>
     </a>
     <br/>
     <wbr/>
     <wbr/>
     <wbr/>
     其中
     <a name="OLE_LINK6" target="_blank">
     </a>
     <a name="OLE_LINK5" target="_blank">
      Zmac.c
     </a>
     是ZStack MAC层接口文件，Zmac_cb.c是ZMAC需要调用的网络层函数。
    </p>
    <p align="left">
     <strong>
      ZMain目录：
     </strong>
    </p>
    <p align="left">
     <a href="http://photo.blog.sina.com.cn/showpic.html#blogid=6184e67b01018upb&amp;url=http://s8.sinaimg.cn/orignal/6184e67bxcff09f36a887" rel="nofollow noopener noreferrer" target="_blank">
      <img alt="Zigbee学习第四天-2——Zigbee协议栈ZStack构架" height="125" src="https://i-blog.csdnimg.cn/blog_migrate/6715a826e8d68c53f373910a64b61afe.jpeg" title="Zigbee学习第四天-2——Zigbee协议栈ZStack构架" width="281"/>
     </a>
    </p>
    <p align="left">
     <wbr/>
    </p>
    <p align="left">
     Z-Stack 由main（）函数开始执行，main（）在Zmain.c中，该函数共做了2件事：一是系统初始化，另外一件是开始执行轮转查询式操作系统，OnBoard.c中包含了对硬件开发平台各类外设进行控制的接口函数。
    </p>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f:2f626c6f672e6373646e2e6e65742f75303133323433333134:2f61727469636c652f64657461696c732f3237333533333237" class_="artid" style="display:none">
 </p>
</div>


