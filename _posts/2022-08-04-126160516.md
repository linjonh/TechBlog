---
layout: post
title: "QtQSqlDatabase链接Sqlite数据库"
date: 2022-08-04 16:27:28 +0800
description: "使用QSqlDatabase链接Sqlite数据库_qt sql 可连接的"
keywords: "qt sql 可连接的"
categories: ['Qt']
tags: ['数据库', 'Sqlite']
artid: "126160516"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=126160516
    alt: "QtQSqlDatabase链接Sqlite数据库"
render_with_liquid: false
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     Qt：QSqlDatabase链接Sqlite数据库
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <p>
     一、描述
    </p>
    <p>
     QSqlDatabase提供了一系列的接口用于访问操作数据库，包括连接数据库，输入sql语QSqlDatabase的实例表示着一个对数据库的连接。该连接通过一个受支持的数据库驱动程序（从QSqlDriver派生）提供对数据库的访问。另外，可以从QSqlDriver子类化自己的数据库驱动程序。Qt支持的数据库有很多，这里我就以sqlite为例
    </p>
    <p>
     二、操作使用
    </p>
    <p>
     1、添加头文件、添加配置
    </p>
    <p>
     <img alt="" height="163" src="https://i-blog.csdnimg.cn/blog_migrate/b0509d303f6bc7c078e7582989320ad4.png" width="798"/>
    </p>
    <p>
     在.pro中添加配置
    </p>
    <p>
     <img alt="" height="55" src="https://i-blog.csdnimg.cn/blog_migrate/b394bbb4292c9cc736bb5158bf9cf2c5.png" width="545"/>
    </p>
    <p>
     链接sqlite3前提准备好sqlite3.lib、sqltie.dll，sqltie.dll要跟程序exe同一个目录下
    </p>
    <p>
     2、讲解和代码段
    </p>
    <p>
     （1）首先通过调用addDatabase()来创建一个连接，需要指定连接的驱动类型，也就是上述的Qt支持的数据库驱动。一个数据库可以被多个QSqlDatabase所连接。通过阅读QT文档时发现addDatabase()还有第二个参数，即连接名。当没有设置第二个参数时，会创建默认的连接。
     <br/>
     （2）在连接前需要绑定一系列的信息，包括主机名，数据库名，账号与密码（我这里使用sqlite3绑定数据库名就行）
     <br/>
     （3）连接把各种参数配置设定好后，需要调用open()去打开数据库
     <br/>
     （4）用QSqlQuery进行数据库操作
     <br/>
     （5）当数据库执行完后，通过close()去关闭数据库
    </p>
    <pre><code class="language-cpp">    //通过addDatabase添加数据库类型
    QSqlDatabase db = QSqlDatabase::addDatabase("QSQLITE"); 
    //sqlite3只要设置一个数据库名 
    db.setDatabaseName(QString("./test.db");
    //打开数据库
    if(db.open()){
        QSqlQuery query(db);
        //使用QSqlQuery  query.exec来执行sql语句
        if(!query.exec("select * from test_table")){
            //出现问题，通过打印lastError
            qDebug()&lt;&lt; "error"&lt;&lt;db.lastError().text();
        }
        //通过循环取出想要字段的数据
        while (query.next()) {
            QString getdata;
            //通过value选择字段
            getdata= query.value("zipped_message_proto").toString();
            qDebug()&lt;&lt;getdata;
        }
    }
    //关闭数据库
    db.close();</code></pre>
    <p>
    </p>
    <p>
    </p>
    <p>
    </p>
    <p>
    </p>
    <p>
    </p>
    <p>
    </p>
    <p>
    </p>
    <p>
    </p>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f672e:6373646e2e6e65742f77656978696e5f35343435303936322f:61727469636c652f64657461696c732f313236313630353136" class_="artid" style="display:none">
 </p>
</div>


