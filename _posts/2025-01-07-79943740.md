---
layout: post
title: "python-fire使用指南"
date: 2025-01-07 12:00:08 +0800
description: "文章浏览阅读5.1w次，点赞62次，收藏127次。0x00 简介欢迎来到Python Fire指南！"
keywords: "fire.fire(main)"
categories: ['python']
tags: ['python', 'fire']
artid: "79943740"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=79943740
    alt: "python-fire使用指南"
render_with_liquid: false
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     python fire使用指南
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-tomorrow-night" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h2>
     <a id="0x00__0">
     </a>
     0x00 简介
    </h2>
    <p>
     欢迎来到Python Fire指南！ Python Fire是一个Python库，只需对Fire进行一次调用即可将任何Python组件转变为命令行界面。
    </p>
    <p>
     让我们开始吧！
    </p>
    <h2>
     <a id="0x01__6">
     </a>
     0x01 安装
    </h2>
    <p>
     从
     <code>
      pypi
     </code>
     安装Python Fire，请运行：
    </p>
    <pre><code class="prism language-python">pip install fire
</code></pre>
    <p>
     或者，从源代码安装Python Fire，请下载
     <a href="https://github.com/google/python-fire">
      源代码
     </a>
     并运行：
    </p>
    <pre><code class="prism language-python">python setup<span class="token punctuation">.</span>py install
</code></pre>
    <h2>
     <a id="0x02_Hello_World_20">
     </a>
     0x02 Hello World
    </h2>
    <h5>
     <a id="Version_1_fireFire_22">
     </a>
     Version 1:
     <code>
      fire.Fire()
     </code>
    </h5>
    <p>
     使用Fire最简单的方法是在任何Python程序结束时调用
     <code>
      fire.Fire()
     </code>
     。 这会将程序的全部内容暴露给命令行。
    </p>
    <pre><code class="prism language-python"><span class="token keyword">import</span> fire

<span class="token keyword">def</span> <span class="token function">hello</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">:</span>
  <span class="token keyword">return</span> <span class="token string">'Hello {name}!'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>name<span class="token operator">=</span>name<span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
  fire<span class="token punctuation">.</span>Fire<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
    <p>
     从命令行运行程序：
    </p>
    <pre><code class="prism language-shell">$ python example.py hello World
Hello World<span class="token operator">!</span>
</code></pre>
    <h5>
     <a id="Version_2_fireFirefn_43">
     </a>
     Version 2:
     <code>
      fire.Fire(&lt;fn&gt;)
     </code>
    </h5>
    <p>
     让我们稍微修改我们的程序，只将
     <code>
      hello
     </code>
     函数暴露给命令行。
    </p>
    <pre><code class="prism language-python"><span class="token keyword">import</span> fire

<span class="token keyword">def</span> <span class="token function">hello</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">:</span>
  <span class="token keyword">return</span> <span class="token string">'Hello {name}!'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>name<span class="token operator">=</span>name<span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
  fire<span class="token punctuation">.</span>Fire<span class="token punctuation">(</span>hello<span class="token punctuation">)</span>
</code></pre>
    <p>
     以下是我们如何从命令行运行该命令的方法：
    </p>
    <pre><code class="prism language-shell">$ python example.py World
Hello World<span class="token operator">!</span>
</code></pre>
    <p>
     注意我们不再需要指定
     <code>
      hello
     </code>
     函数，因为我们调用了
     <code>
      fire.Fire(hello)
     </code>
     。
    </p>
    <h5>
     <a id="Version_3_Using_a_main_66">
     </a>
     Version 3: Using a main
    </h5>
    <p>
     我们也可以这样写这个程序：
    </p>
    <pre><code class="prism language-python"><span class="token keyword">import</span> fire

<span class="token keyword">def</span> <span class="token function">hello</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">:</span>
  <span class="token keyword">return</span> <span class="token string">'Hello {name}!'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>name<span class="token operator">=</span>name<span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
  fire<span class="token punctuation">.</span>Fire<span class="token punctuation">(</span>hello<span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
  main<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
    <p>
     或者如果我们使用
     <code>
      entry points
     </code>
     ，那么代码更加简洁：
    </p>
    <pre><code class="prism language-python"><span class="token keyword">import</span> fire

<span class="token keyword">def</span> <span class="token function">hello</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">:</span>
  <span class="token keyword">return</span> <span class="token string">'Hello {name}!'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>name<span class="token operator">=</span>name<span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
  fire<span class="token punctuation">.</span>Fire<span class="token punctuation">(</span>hello<span class="token punctuation">)</span>
</code></pre>
    <h2>
     <a id="0x03_Exposing_Multiple_Commands_95">
     </a>
     0x03 Exposing Multiple Commands
    </h2>
    <p>
     在前面的例子中，我们向命令行暴露了一个函数。 现在我们来看看如何将多个函数暴露给命令行。
    </p>
    <h5>
     <a id="Version_1_fireFire_99">
     </a>
     Version 1:
     <code>
      fire.Fire()
     </code>
    </h5>
    <p>
     暴露多个命令最简单的方法是编写多个函数，然后调用Fire。
    </p>
    <pre><code class="prism language-python"><span class="token keyword">import</span> fire

<span class="token keyword">def</span> <span class="token function">add</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">:</span>
  <span class="token keyword">return</span> x <span class="token operator">+</span> y

<span class="token keyword">def</span> <span class="token function">multiply</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">:</span>
  <span class="token keyword">return</span> x <span class="token operator">*</span> y

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
  fire<span class="token punctuation">.</span>Fire<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
    <p>
     我们可以这样使用它：
    </p>
    <pre><code class="prism language-shell">$ python example.py add 10 20
30
$ python example.py multiply 10 20
200
</code></pre>
    <p>
     你会注意到Fire正确地将
     <code>
      10
     </code>
     和
     <code>
      20
     </code>
     解析为数字，而不是字符串。 可以看
     <strong>
      0X09 参数解析
     </strong>
     。
    </p>
    <h5>
     <a id="Version_2_fireFiredict_127">
     </a>
     Version 2:
     <code>
      fire.Fire(&lt;dict&gt;)
     </code>
    </h5>
    <p>
     在
     <strong>
      Version 1
     </strong>
     中，我们将所有程序的功能暴露给命令行。 通过使用字典，我们可以有选择性地将一些函数暴露给命令行。
    </p>
    <pre><code class="prism language-python"><span class="token keyword">import</span> fire

<span class="token keyword">def</span> <span class="token function">add</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">:</span>
  <span class="token keyword">return</span> x <span class="token operator">+</span> y

<span class="token keyword">def</span> <span class="token function">multiply</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">:</span>
  <span class="token keyword">return</span> x <span class="token operator">*</span> y

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
  fire<span class="token punctuation">.</span>Fire<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
      <span class="token string">'add'</span><span class="token punctuation">:</span> add<span class="token punctuation">,</span>
      <span class="token string">'multiply'</span><span class="token punctuation">:</span> multiply<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
    <p>
     我们可以像以前一样使用它：
    </p>
    <pre><code class="prism language-shell">$ python example.py add 10 20
30
$ python example.py multiply 10 20
200
</code></pre>
    <h5>
     <a id="Version_3_fireFireobject_156">
     </a>
     Version 3:
     <code>
      fire.Fire(&lt;object&gt;)
     </code>
    </h5>
    <p>
     正如在这个变体中一样，Fire 也适用于object。 这是暴露多个命令的一个好的做法。
    </p>
    <pre><code class="prism language-python"><span class="token keyword">import</span> fire

<span class="token keyword">class</span> <span class="token class-name">Calculator</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>

  <span class="token keyword">def</span> <span class="token function">add</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> x <span class="token operator">+</span> y

  <span class="token keyword">def</span> <span class="token function">multiply</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> x <span class="token operator">*</span> y

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
  calculator <span class="token operator">=</span> Calculator<span class="token punctuation">(</span><span class="token punctuation">)</span>
  fire<span class="token punctuation">.</span>Fire<span class="token punctuation">(</span>calculator<span class="token punctuation">)</span>
</code></pre>
    <p>
     我们可以像之前那样使用它：
    </p>
    <pre><code class="prism language-shell">$ python example.py add 10 20
30
$ python example.py multiply 10 20
200
</code></pre>
    <h5>
     <a id="Version_4_fireFireclass_185">
     </a>
     Version 4:
     <code>
      fire.Fire(&lt;class&gt;)
     </code>
    </h5>
    <p>
     Fire也适用于class。 这是暴露多个命令的另一个好的做法。
    </p>
    <pre><code class="prism language-python"><span class="token keyword">import</span> fire

<span class="token keyword">class</span> <span class="token class-name">Calculator</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>

  <span class="token keyword">def</span> <span class="token function">add</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> x <span class="token operator">+</span> y

  <span class="token keyword">def</span> <span class="token function">multiply</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> x <span class="token operator">*</span> y

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
  fire<span class="token punctuation">.</span>Fire<span class="token punctuation">(</span>Calculator<span class="token punctuation">)</span>
</code></pre>
    <p>
     我们可以像之前那样使用它：
    </p>
    <pre><code class="prism language-shell">$ python example.py add 10 20
30
$ python example.py multiply 10 20
200
</code></pre>
    <p>
     为什么我们更喜欢使用class而不是object？ 一个原因是你可以给构造类传递参数，就像这个
     <code>
      BrokenCalculator
     </code>
     例子一样。
    </p>
    <pre><code class="prism language-python"><span class="token keyword">import</span> fire

<span class="token keyword">class</span> <span class="token class-name">BrokenCalculator</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>

  <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> offset<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
      self<span class="token punctuation">.</span>_offset <span class="token operator">=</span> offset

  <span class="token keyword">def</span> <span class="token function">add</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> x <span class="token operator">+</span> y <span class="token operator">+</span> self<span class="token punctuation">.</span>_offset

  <span class="token keyword">def</span> <span class="token function">multiply</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> x <span class="token operator">*</span> y <span class="token operator">+</span> self<span class="token punctuation">.</span>_offset

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
  fire<span class="token punctuation">.</span>Fire<span class="token punctuation">(</span>BrokenCalculator<span class="token punctuation">)</span>
</code></pre>
    <p>
     当你使用
     <code>
      BrokenCalculator
     </code>
     时，你会得到错误的答案：
    </p>
    <pre><code class="prism language-shell">$ python example.py add 10 20
31
$ python example.py multiply 10 20
201
</code></pre>
    <p>
     但你可以这样解决它：
    </p>
    <pre><code class="prism language-shell">$ python example.py add 10 20 --offset<span class="token operator">=</span>0
30
$ python example.py multiply 10 20 --offset<span class="token operator">=</span>0
200
</code></pre>
    <p>
     与调用普通函数不同，它可以通过位置参数和命名参数（
     <code>
      --flag
     </code>
     语法）完成，而
     <code>
      __init__
     </code>
     函数的参数必须以
     <code>
      --flag
     </code>
     语法传递。 请参阅
     <strong>
      0x08 函数调用
     </strong>
     。
    </p>
    <h2>
     <a id="0x04__253">
     </a>
     0x04 分组命令
    </h2>
    <p>
     下面是一个如何使用分组命令创建命令行界面的示例。
    </p>
    <pre><code class="prism language-python"><span class="token keyword">class</span> <span class="token class-name">IngestionStage</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>

  <span class="token keyword">def</span> <span class="token function">run</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token string">'Ingesting! Nom nom nom...'</span>

<span class="token keyword">class</span> <span class="token class-name">DigestionStage</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>

  <span class="token keyword">def</span> <span class="token function">run</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> volume<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token string">' '</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'Burp!'</span><span class="token punctuation">]</span> <span class="token operator">*</span> volume<span class="token punctuation">)</span>

  <span class="token keyword">def</span> <span class="token function">status</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token string">'Satiated.'</span>

<span class="token keyword">class</span> <span class="token class-name">Pipeline</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>

  <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
    self<span class="token punctuation">.</span>ingestion <span class="token operator">=</span> IngestionStage<span class="token punctuation">(</span><span class="token punctuation">)</span>
    self<span class="token punctuation">.</span>digestion <span class="token operator">=</span> DigestionStage<span class="token punctuation">(</span><span class="token punctuation">)</span>

  <span class="token keyword">def</span> <span class="token function">run</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
    self<span class="token punctuation">.</span>ingestion<span class="token punctuation">.</span>run<span class="token punctuation">(</span><span class="token punctuation">)</span>
    self<span class="token punctuation">.</span>digestion<span class="token punctuation">.</span>run<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
  fire<span class="token punctuation">.</span>Fire<span class="token punctuation">(</span>Pipeline<span class="token punctuation">)</span>
</code></pre>
    <p>
     以下是使用方式：
    </p>
    <pre><code class="prism language-shell">$ python example.py run
Ingesting<span class="token operator">!</span> Nom nom nom<span class="token punctuation">..</span>.
Burp<span class="token operator">!</span>
$ python example.py ingestion run
Ingesting<span class="token operator">!</span> Nom nom nom<span class="token punctuation">..</span>.
$ python example.py digestion run
Burp<span class="token operator">!</span>
$ python example.py digestion status
Satiated.
</code></pre>
    <p>
     你可以用任意复杂的方式嵌套你的命令。
    </p>
    <h2>
     <a id="0x05__301">
     </a>
     0x05 属性访问
    </h2>
    <p>
     到目前为止，在所有例子中，我们通过python example.py运行了示例程序的一些功能。 在下面这个例子中，我们只访问一个属性。
    </p>
    <pre><code class="prism language-python"><span class="token keyword">from</span> airports <span class="token keyword">import</span> airports

<span class="token keyword">import</span> fire

<span class="token keyword">class</span> <span class="token class-name">Airport</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>

  <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> code<span class="token punctuation">)</span><span class="token punctuation">:</span>
    self<span class="token punctuation">.</span>code <span class="token operator">=</span> code
    self<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>airports<span class="token punctuation">)</span><span class="token punctuation">.</span>get<span class="token punctuation">(</span>self<span class="token punctuation">.</span>code<span class="token punctuation">)</span>
    self<span class="token punctuation">.</span>city <span class="token operator">=</span> self<span class="token punctuation">.</span>name<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token keyword">if</span> self<span class="token punctuation">.</span>name <span class="token keyword">else</span> <span class="token boolean">None</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
  fire<span class="token punctuation">.</span>Fire<span class="token punctuation">(</span>Airport<span class="token punctuation">)</span>
</code></pre>
    <p>
     现在我们可以使用下面的方式使用
     <code>
      Airport
     </code>
     代码！
    </p>
    <pre><code class="prism language-shell">$ python example.py --code<span class="token operator">=</span>JFK code
JFK
$ python example.py --code<span class="token operator">=</span>SJC name
San Jose-Sunnyvale-Santa Clara, CA - Norman Y. Mineta San Jose International <span class="token punctuation">(</span>SJC<span class="token punctuation">)</span>
$ python example.py --code<span class="token operator">=</span>ALB city
Albany-Schenectady-Troy
</code></pre>
    <p>
     （译者注：注意这里
     <code>
      --code
     </code>
     就是
     <strong>
      0x03 Exposing Multiple Commands
     </strong>
     最后说的，给
     <code>
      __init__
     </code>
     传递参数，必须使用–flag语法）
    </p>
    <h2>
     <a id="0x06__334">
     </a>
     0x06 链式函数调用
    </h2>
    <p>
     当您运行Fire CLI时，您可以对调用Fire的结果采取所有相同的操作。
    </p>
    <p>
     例如，我们可以这样使用之前的Airport例子：
    </p>
    <pre><code class="prism language-shell">$ python example.py --code<span class="token operator">=</span>ALB city upper
ALBANY-SCHENECTADY-TROY
</code></pre>
    <p>
     这是可行的，因为upper是所有字符串的一种方法。
    </p>
    <p>
     所以，如果你想设置你的函数链式调用，你只需要设置方法返回
     <code>
      self
     </code>
     。下面通过一个例子说明：
    </p>
    <pre><code class="prism language-python"><span class="token keyword">import</span> fire

<span class="token keyword">class</span> <span class="token class-name">BinaryCanvas</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
  <span class="token triple-quoted-string string">"""A canvas with which to make binary art, one bit at a time."""</span>

  <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> size<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    self<span class="token punctuation">.</span>pixels <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> size <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>size<span class="token punctuation">)</span><span class="token punctuation">]</span>
    self<span class="token punctuation">.</span>_size <span class="token operator">=</span> size
    self<span class="token punctuation">.</span>_row <span class="token operator">=</span> <span class="token number">0</span>  <span class="token comment"># The row of the cursor.</span>
    self<span class="token punctuation">.</span>_col <span class="token operator">=</span> <span class="token number">0</span>  <span class="token comment"># The column of the cursor.</span>

  <span class="token keyword">def</span> <span class="token function">__str__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token string">'\n'</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>pixel<span class="token punctuation">)</span> <span class="token keyword">for</span> pixel <span class="token keyword">in</span> row<span class="token punctuation">)</span> <span class="token keyword">for</span> row <span class="token keyword">in</span> self<span class="token punctuation">.</span>pixels<span class="token punctuation">)</span>

  <span class="token keyword">def</span> <span class="token function">show</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span>
    <span class="token keyword">return</span> self

  <span class="token keyword">def</span> <span class="token function">move</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> row<span class="token punctuation">,</span> col<span class="token punctuation">)</span><span class="token punctuation">:</span>
    self<span class="token punctuation">.</span>_row <span class="token operator">=</span> row <span class="token operator">%</span> self<span class="token punctuation">.</span>_size
    self<span class="token punctuation">.</span>_col <span class="token operator">=</span> col <span class="token operator">%</span> self<span class="token punctuation">.</span>_size
    <span class="token keyword">return</span> self

  <span class="token keyword">def</span> <span class="token function">on</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> self<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>

  <span class="token keyword">def</span> <span class="token function">off</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> self<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>

  <span class="token keyword">def</span> <span class="token function">set</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">:</span>
    self<span class="token punctuation">.</span>pixels<span class="token punctuation">[</span>self<span class="token punctuation">.</span>_row<span class="token punctuation">]</span><span class="token punctuation">[</span>self<span class="token punctuation">.</span>_col<span class="token punctuation">]</span> <span class="token operator">=</span> value
    <span class="token keyword">return</span> self

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
  fire<span class="token punctuation">.</span>Fire<span class="token punctuation">(</span>BinaryCanvas<span class="token punctuation">)</span>
</code></pre>
    <p>
     现在我们可以绘制东西:)。
    </p>
    <pre><code class="prism language-shell">$ python example.py move 3 3 on move 3 6 on move 6 3 on move 6 6 on move 7 4 on move 7 5 on __str__
0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0
0 0 0 1 0 0 1 0 0 0
0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0
0 0 0 1 0 0 1 0 0 0
0 0 0 0 1 1 0 0 0 0
0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0
</code></pre>
    <p>
     它应该是一个笑脸。
    </p>
    <h2>
     <a id="0x07_Hello_World_405">
     </a>
     0x07 有没有比Hello World更简单的例子?
    </h2>
    <p>
     有，下面这个程序比我们之前的Hello World例子更简单。
    </p>
    <pre><code class="prism language-python"><span class="token keyword">import</span> fire
english <span class="token operator">=</span> <span class="token string">'Hello World'</span>
spanish <span class="token operator">=</span> <span class="token string">'Hola Mundo'</span>
fire<span class="token punctuation">.</span>Fire<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
    <p>
     你可以像这样使用它：
    </p>
    <pre><code class="prism language-shell">$ python example.py english
Hello World
$ python example.py spanish
Hola Mundo
</code></pre>
    <h2>
     <a id="0x08__425">
     </a>
     0x08 函数调用
    </h2>
    <p>
     构造函数的参数可以使用
     <code>
      --flag
     </code>
     语法
     <code>
      --name = value
     </code>
     传递。
    </p>
    <p>
     例如，考虑这个简单的类：
    </p>
    <pre><code class="prism language-python"><span class="token keyword">import</span> fire

<span class="token keyword">class</span> <span class="token class-name">Building</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>

  <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> name<span class="token punctuation">,</span> stories<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    self<span class="token punctuation">.</span>name <span class="token operator">=</span> name
    self<span class="token punctuation">.</span>stories <span class="token operator">=</span> <span class="token number">1</span>

  <span class="token keyword">def</span> <span class="token function">climb_stairs</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> stairs_per_story<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> story <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>stories<span class="token punctuation">)</span><span class="token punctuation">:</span>
      <span class="token keyword">for</span> stair <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> stairs_per_story<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">yield</span> stair
        <span class="token keyword">yield</span> <span class="token string">'Phew!'</span>
    <span class="token keyword">yield</span> <span class="token string">'Done!'</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
  fire<span class="token punctuation">.</span>Fire<span class="token punctuation">(</span>Building<span class="token punctuation">)</span>
</code></pre>
    <p>
     我们可以通过这种方式实例化它：
     <code>
      python example.py --name ="Sherrerd Hall"
     </code>
    </p>
    <p>
     其他函数的参数同样可以使用
     <code>
      --flag
     </code>
     语法来传递。
    </p>
    <p>
     要实例化一个
     <code>
      Building
     </code>
     ，然后运行
     <code>
      climb_stairs
     </code>
     函数，以下命令都是有效的：
    </p>
    <pre><code class="prism language-shell">$ python example.py --name<span class="token operator">=</span><span class="token string">"Sherrerd Hall"</span> --stories<span class="token operator">=</span>3 climb_stairs 10
$ python example.py --name<span class="token operator">=</span><span class="token string">"Sherrerd Hall"</span> climb_stairs --stairs_per_story<span class="token operator">=</span>10
$ python example.py --name<span class="token operator">=</span><span class="token string">"Sherrerd Hall"</span> climb_stairs --stairs-per-story 10
$ python example.py climb-stairs --stairs-per-story 10 --name<span class="token operator">=</span><span class="token string">"Sherrerd Hall"</span>
</code></pre>
    <p>
     你会注意到连字符和下划线（
     <code>
      -
     </code>
     和
     <code>
      _
     </code>
     ）在成员名称和标志名称中是可以互换的。
    </p>
    <p>
     你还会注意到构造函数的参数可以在其他函数的参数之后或函数之前。
    </p>
    <p>
     你还会注意到，标志名称和其值之间的等号是可选的。
    </p>
    <h5>
     <a id="varargs_kwargs_470">
     </a>
     带有*varargs和** kwargs的函数
    </h5>
    <p>
     Fire支持带
     <code>
      *varargs
     </code>
     或
     <code>
      ** kwargs
     </code>
     的函数。 这是一个例子：
    </p>
    <pre><code class="prism language-python"><span class="token keyword">import</span> fire

<span class="token keyword">def</span> <span class="token function">order_by_length</span><span class="token punctuation">(</span><span class="token operator">*</span>items<span class="token punctuation">)</span><span class="token punctuation">:</span>
  <span class="token triple-quoted-string string">"""Orders items by length, breaking ties alphabetically."""</span>
  sorted_items <span class="token operator">=</span> <span class="token builtin">sorted</span><span class="token punctuation">(</span>items<span class="token punctuation">,</span> key<span class="token operator">=</span><span class="token keyword">lambda</span> item<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> <span class="token string">' '</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>sorted_items<span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
  fire<span class="token punctuation">.</span>Fire<span class="token punctuation">(</span>order_by_length<span class="token punctuation">)</span>
</code></pre>
    <p>
     要使用它，我们这样运行：
    </p>
    <pre><code class="prism language-shell">$ python example.py dog <span class="token function">cat</span> elephant
<span class="token function">cat</span> dog elephant
</code></pre>
    <p>
     你可以使用分隔符给函数提供参数。分隔符后的所有参数将用于处理函数的结果，而不是传递给函数本身。 默认分隔符是连字符
     <code>
      -
     </code>
     。
    </p>
    <p>
     以下是我们使用分隔符的示例。
    </p>
    <pre><code class="prism language-shell">$ python example.py dog <span class="token function">cat</span> elephant - upper
CAT DOG ELEPHANT
</code></pre>
    <p>
     如果没有分隔符，upper就会被当作另一个参数。
    </p>
    <pre><code class="prism language-shell">$ python example.py dog <span class="token function">cat</span> elephant upper
<span class="token function">cat</span> dog upper elephant
</code></pre>
    <p>
     你可以使用
     <code>
      --separator
     </code>
     标志更改分隔符。通过
     <code>
      --
     </code>
     将标志与你的Fire指令隔开 。 以下是我们更改分隔符的示例。
    </p>
    <pre><code class="prism language-shell">$ python example.py dog <span class="token function">cat</span> elephant X upper -- --separator<span class="token operator">=</span>X
CAT DOG ELEPHANT
</code></pre>
    <p>
     当函数接受
     <code>
      *varargs
     </code>
     ，
     <code>
      **kwargs
     </code>
     或你不想指定的默认值时，分隔符会很有用。作为参数，更改分隔符也很重要。
    </p>
    <h2>
     <a id="0x09__518">
     </a>
     0x09 参数解析
    </h2>
    <p>
     参数的类型取决于它们的值，而不是使用它们的函数签名。 您可以从命令行传递任何Python文本：数字，字符串，元组，列表，字典（仅在某些版本的Python中支持集合）。只要它们只包含文字，您也可以任意嵌套这些集合。
    </p>
    <p>
     为了演示这个，我们将制作一个小程序，通过这个小程序告诉我们传给它的参数类型：
    </p>
    <pre><code class="prism language-python"><span class="token keyword">import</span> fire
fire<span class="token punctuation">.</span>Fire<span class="token punctuation">(</span><span class="token keyword">lambda</span> obj<span class="token punctuation">:</span> <span class="token builtin">type</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">.</span>__name__<span class="token punctuation">)</span>
</code></pre>
    <p>
     我们会像这样使用它：
    </p>
    <pre><code class="prism language-shell">$ python example.py 10
int
$ python example.py 10.0
float
$ python example.py hello
str
$ python example.py <span class="token string">'(1,2)'</span>
tuple
$ python example.py <span class="token punctuation">[</span>1,2<span class="token punctuation">]</span>
list
$ python example.py True
bool
$ python example.py <span class="token punctuation">{<!-- --></span>name: David<span class="token punctuation">}</span>
dict
</code></pre>
    <p>
     在最后一个例子中，你会注意到裸词会自动替换为字符串。
    </p>
    <p>
     要注意！ 如果你想传递字符串
     <code>
      "10"
     </code>
     而不是
     <code>
      int 10
     </code>
     ，你需要转义或者引用你的引号。 否则，Bash将会把你的引用取消并将一个没有引号的10传递给你的Python程序，在那里Fire将把它解释为一个数字。
    </p>
    <pre><code class="prism language-shell">$ python example.py 10
int
$ python example.py <span class="token string">"10"</span>
int
$ python example.py <span class="token string">'"10"'</span>
str
$ python example.py <span class="token string">"'10'"</span>
str
$ python example.py \"10\"
str
</code></pre>
    <p>
     要注意！ 记住Bash首先处理你的参数，然后Fire解析结果。 如果你想将
     <code>
      dict {"name"："David Bieber"}
     </code>
     传递给你的程序，你可以试试这个：
    </p>
    <pre><code class="prism language-shell">$ python example.py <span class="token string">'{"name": "David Bieber"}'</span>  <span class="token comment"># Good! Do this.</span>
dict
$ python example.py <span class="token punctuation">{<!-- --></span><span class="token string">"name"</span><span class="token keyword">:</span><span class="token string">'"David Bieber"'</span><span class="token punctuation">}</span>  <span class="token comment"># Okay.</span>
dict
$ python example.py <span class="token punctuation">{<!-- --></span><span class="token string">"name"</span><span class="token keyword">:</span><span class="token string">"David Bieber"</span><span class="token punctuation">}</span>  <span class="token comment"># Wrong. This is parsed as a string.</span>
str
$ python example.py <span class="token punctuation">{<!-- --></span><span class="token string">"name"</span><span class="token keyword">:</span> <span class="token string">"David Bieber"</span><span class="token punctuation">}</span>  <span class="token comment"># Wrong. This isn't even treated as a single argument.</span>
<span class="token operator">&lt;</span>error<span class="token operator">&gt;</span>
$ python example.py <span class="token string">'{"name": "Justin Bieber"}'</span>  <span class="token comment"># Wrong. This is not the Bieber you're looking for. (The syntax is fine though :))</span>
dict
</code></pre>
    <h5>
     <a id="bool_580">
     </a>
     bool类型参数
    </h5>
    <p>
     <code>
      True
     </code>
     和
     <code>
      False
     </code>
     被解析为布尔值。
    </p>
    <p>
     你也可以通过
     <code>
      --flag
     </code>
     语法
     <code>
      --name
     </code>
     和
     <code>
      --noname
     </code>
     来指定布尔值，它们分别将名称设置为
     <code>
      True
     </code>
     和
     <code>
      False
     </code>
     。
    </p>
    <p>
     继续前面的例子，我们可以运行以下任何一个：
    </p>
    <pre><code class="prism language-shell">$ python example.py --obj<span class="token operator">=</span>True
bool
$ python example.py --obj<span class="token operator">=</span>False
bool
$ python example.py --obj
bool
$ python example.py --noobj
bool
</code></pre>
    <p>
     要注意！ 如果除另一个标志之外的标志紧跟在应该是布尔值的标志之后，该标志将取代该标志的值而不是布尔值。 您可以解决这个问题：通过在最后一个标志之后放置一个分隔符，明确指出布尔标志的值（如
     <code>
      --obj = True
     </code>
     ），或者确保在布尔标志参数后面有另一个标志。
    </p>
    <h2>
     <a id="0x10_Using_Fire_Flags_601">
     </a>
     0x10 Using Fire Flags
    </h2>
    <p>
     Fire CLI自己也带有一些标志。这些标志应该通过
     <code>
      --
     </code>
     与Fire命令分开。如果至少有一个
     <code>
      --
     </code>
     ，那么在最后一个
     <code>
      --
     </code>
     之后的参数将被视为标志，而在最后一个
     <code>
      --
     </code>
     之前的所有参数都被视为Fire命令的一部分。
    </p>
    <p>
     一个有用的标志是
     <code>
      --interactive
     </code>
     。在任何CLI上使用
     <code>
      --interactive
     </code>
     标志输入一个Python REPL，其中包含已调用Fire的上下文中使用的所有模块和变量。其他有用的变量，例如Fire命令的结果也将可用。像这样使用这个特性：
     <code>
      python example.py -- --interactive
     </code>
     。
    </p>
    <p>
     你可以将帮助标志添加到任何命令中，用来查看帮助和使用信息。 Fire将文档结合到它生成的帮助和使用信息中。即使你省略了
     <code>
      --
     </code>
     ，Fire也会试图提供帮助，它会将标志从Fire命令中分离出来。但并不总是如此，因为help是一个有效的参数名称。像这样使用这个特性：
     <code>
      python example.py -- --help
     </code>
     。
    </p>
    <p>
     下面
     <strong>
      Reference
     </strong>
     部分中显示了完整的可用标志集。
    </p>
    <h4>
     <a id="Reference_611">
     </a>
     Reference
    </h4>
    <table>
     <thead>
      <tr>
       <th>
        Setup
       </th>
       <th>
        Command
       </th>
       <th>
        Notes
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        install
       </td>
       <td>
        <code>
         pip install fire
        </code>
       </td>
       <td>
       </td>
      </tr>
     </tbody>
    </table>
    <h6>
     <a id="Creating_a_CLI_617">
     </a>
     Creating a CLI
    </h6>
    <table>
     <thead>
      <tr>
       <th>
        Creating a CLI
       </th>
       <th>
        Command
       </th>
       <th>
        Notes
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        import
       </td>
       <td>
        <code>
         import fire
        </code>
       </td>
       <td>
       </td>
      </tr>
      <tr>
       <td>
        Call
       </td>
       <td>
        <code>
         fire.Fire()
        </code>
       </td>
       <td>
        Turns the current module into a Fire CLI.
       </td>
      </tr>
      <tr>
       <td>
        Call
       </td>
       <td>
        <code>
         fire.Fire(component)
        </code>
       </td>
       <td>
        Turns
        <code>
         component
        </code>
        into a Fire CLI.
       </td>
      </tr>
     </tbody>
    </table>
    <h6>
     <a id="Flags_625">
     </a>
     Flags
    </h6>
    <table>
     <thead>
      <tr>
       <th>
        Using a CLI
       </th>
       <th>
        Command
       </th>
       <th>
        Notes
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        <a href="https://github.com/google/python-fire/blob/master/docs/using-cli.md#help-flag">
         Help
        </a>
       </td>
       <td>
        <code>
         command -- --help
        </code>
       </td>
       <td>
        Show help and usage information for the command.
       </td>
      </tr>
      <tr>
       <td>
        <a href="https://github.com/google/python-fire/blob/master/docs/using-cli.md#interactive-flag">
         REPL
        </a>
       </td>
       <td>
        <code>
         command -- --interactive
        </code>
       </td>
       <td>
        Enter interactive mode.
       </td>
      </tr>
      <tr>
       <td>
        <a href="https://github.com/google/python-fire/blob/master/docs/using-cli.md#separator-flag">
         Separator
        </a>
       </td>
       <td>
        <code>
         command -- --separator=X
        </code>
       </td>
       <td>
        This sets the separator to
        <code>
         X
        </code>
        . The default separator is
        <code>
         -
        </code>
        .
       </td>
      </tr>
      <tr>
       <td>
        <a href="https://github.com/google/python-fire/blob/master/docs/using-cli.md#completion-flag">
         Completion
        </a>
       </td>
       <td>
        <code>
         command -- --completion
        </code>
       </td>
       <td>
        Generate a completion script for the CLI.
       </td>
      </tr>
      <tr>
       <td>
        <a href="https://github.com/google/python-fire/blob/master/docs/using-cli.md#trace-flag">
         Trace
        </a>
       </td>
       <td>
        <code>
         command -- --trace
        </code>
       </td>
       <td>
        Gets a Fire trace for the command.
       </td>
      </tr>
      <tr>
       <td>
        <a href="https://github.com/google/python-fire/blob/master/docs/using-cli.md#verbose-flag">
         Verbose
        </a>
       </td>
       <td>
        <code>
         command -- --verbose
        </code>
       </td>
       <td>
        Include private members in the output.
       </td>
      </tr>
     </tbody>
    </table>
    <p>
     <em>
      Note that flags are separated from the Fire command by an isolated – arg.
     </em>
    </p>
    <p>
     <a href="https://github.com/google/python-fire/blob/master/docs/guide.md">
      https://github.com/google/python-fire/blob/master/docs/guide.md
     </a>
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f:626c6f672e6373646e2e6e65742f71715f3137353530333739:2f61727469636c652f64657461696c732f3739393433373430" class_="artid" style="display:none">
 </p>
</div>


