---
layout: post
title: "翻译在Mac上将Python-3设置为默认的正确和错误方法"
date: 2024-09-18 00:59:22 +0800
description: "说明弃用：Python 2.7将于2020年1月1日到期，请升级您的Python，因为在此日期后将不"
keywords: "Python3,MacOS,Homebrew"
categories: ['机器学习杂文', '工具类']
tags: ['Python', 'Pyenv', 'Pip', 'Mac', 'Homebrew']
artid: "108380419"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=108380419
    alt: "翻译在Mac上将Python-3设置为默认的正确和错误方法"
render_with_liquid: false
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     翻译：在Mac上将Python 3设置为默认的正确和错误方法
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h2>
     <a id="_1">
     </a>
     说明
    </h2>
    <p>
     弃用：Python 2.7将于2020年1月1日到期，请升级您的Python，因为在此日期后将不再维护Python 2.7。pip的未来版本将不再支持Python 2.7。
    </p>
    <p>
     对于新买的Mac Book Pro来说，默认的安装是 Python 2.7的版本。如何设置默认的版本为Python 3 呢？
    </p>
    <h2>
     <a id="_7">
     </a>
     这有什么难的？
    </h2>
    <p>
     macOS随附的Python版本与Python建议用于开发的版本已经过时。正如
     <a href="https://xkcd.com/1987/" rel="nofollow">
      XKCD指出的那样
     </a>
     ，Python运行时有时也具有可笑的挑战。
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/66a9da40a706d355b55768f5a677ffef.png#pic_center" width="500">
      <br/>
      那有什么计划？我的计算机上已经有数十个Python解释器，而且我不知道如何有效地管理它们。我不想下载最新版本，将其移到我的路径中，然后每天称呼它（或使用brew install python3，它会执行类似的操作）。我认为这会以一种非常令人沮丧的方式导致线路中断，我不知道如何进行故障排除。我认为最好的方法是淘汰并替换我正在运行的任何版本的Python，以明确，明确地切换到最新和最伟大的版本。
     </img>
    </p>
    <h2>
     <a id="_12">
     </a>
     我们可以做（但不应该做）
    </h2>
    <p>
     现在我们知道了不该做的事情，让我们看一下我们可以做的事情。当我们考虑macOS上应用程序的常见安装模式时，有两种选择。
    </p>
    <h3>
     <a id="Python_3macOS_15">
     </a>
     使用Python 3作为macOS默认设置
    </h3>
    <p>
     Python的网站上有一个
     <a href="https://www.python.org/downloads/mac-osx/" rel="nofollow">
      macOS Python 3
     </a>
     安装程序，我们可以下载和使用。如果使用软件包安装，则
     <code>
      /usr/local/bin/
     </code>
     中将提供python3填充。
    </p>
    <p>
     别名是必须的，因为不能更改/ usr / bin /中存储的Python二进制文件。别名的好处是它特定于我们的命令行外壳。由于默认情况下使用zsh，因此将以下内容放入.zshrc文件中：
    </p>
    <pre><code class="prism language-cpp">$ echo <span class="token string">"alias python=/usr/local/bin/python3.7"</span> <span class="token operator">&gt;&gt;</span> <span class="token operator">~</span><span class="token operator">/</span><span class="token punctuation">.</span>zshrc
$ source <span class="token operator">~</span><span class="token operator">/</span><span class="token punctuation">.</span>zshrc
</code></pre>
    <p>
     如果您使用默认的Bash shell，则可以将此相同的文本附加到.bashrc中：
    </p>
    <pre><code class="prism language-cpp">$ echo <span class="token string">"alias python=/usr/local/bin/python3.7"</span> <span class="token operator">&gt;&gt;</span> <span class="token operator">~</span><span class="token operator">/</span><span class="token punctuation">.</span>bashrc
$ source <span class="token operator">~</span><span class="token operator">/</span><span class="token punctuation">.</span>bashrc
</code></pre>
    <p>
     查看 Python版本
    </p>
    <pre><code>$ python --verions
# python 3.7.1
</code></pre>
    <p>
     该策略有效，但是对于将来对Python进行更新并不是理想的选择。这意味着我们必须记住要检查网站并下载新文件，因为Python不包含用于更新的命令行方式。
    </p>
    <h3>
     <a id="HomebrewPython_3_40">
     </a>
     让Homebrew管理Python 3
    </h3>
    <p>
     该Homebrew提供适用于MacOS，许多人依靠免费和开源的包管理器。它赋予Apple用户类似于apt-get或yum的功能。如果您是Homebrew用户，则可能已经安装了Python。要快速检查，请运行：
    </p>
    <pre><code class="prism language-cpp">$ brew list <span class="token operator">|</span> grep python
python
</code></pre>
    <p>
     如果Python在命令下显示，则表明已安装。它是什么版本？让我们检查：
    </p>
    <pre><code class="prism language-cpp">$ brew info python
python<span class="token operator">:</span> stable <span class="token number">3.7</span><span class="token number">.3</span> <span class="token punctuation">(</span>bottled<span class="token punctuation">)</span><span class="token punctuation">,</span> HEAD
Interpreted<span class="token punctuation">,</span> interactive<span class="token punctuation">,</span> object<span class="token operator">-</span>oriented programming language
https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>www<span class="token punctuation">.</span>python<span class="token punctuation">.</span>org<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>Cellar<span class="token operator">/</span>python<span class="token operator">/</span><span class="token number">3.7</span><span class="token number">.2</span>_1 <span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">437</span> files<span class="token punctuation">,</span> <span class="token number">118</span>MB<span class="token punctuation">)</span> <span class="token operator">*</span>
## further output <span class="token operator">not</span> included ##
</code></pre>
    <p>
     好，太棒了！Homebrew维护人员已将默认的Python瓶更新为指向最新版本。由于Homebrew维护者比我们大多数人更依赖于更新发行版，因此我们可以通过以下命令使用Homebrew的Python 3版本：
    </p>
    <pre><code class="prism language-cpp">$ brew update <span class="token operator">&amp;&amp;</span> brew upgrade python
</code></pre>
    <p>
     现在，我们要将别名（从上面）指向Homebrew管理的Python副本：
    </p>
    <pre><code class="prism language-cpp"><span class="token macro property"># If you added the previous alias, use a text editor to update the line to the following</span>
alias python<span class="token operator">=</span><span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>bin<span class="token operator">/</span>python3
</code></pre>
    <p>
     为了确保上面的路径指向Homebrew在我们的环境中安装Python的位置，我们可以运行brew info python并查找路径信息。
    </p>
    <p>
     这种使用Homebrew管理我们的Python环境的方法是一个很好的起点，在当时对我来说是有意义的。
    </p>
    <h3>
     <a id="Python_2_72">
     </a>
     如果我们仍然需要Python 2怎么办？
    </h3>
    <p>
     对于Python的新手来说，从Python 3开始是有意义的。但是，我们仍然需要Python 2的人（例如，为仅在Python 2中可用的Python项目做出贡献）可以继续使用可用的默认macOS Python二进制文件在
     <code>
      /usr/bin/python
     </code>
     中：
    </p>
    <pre><code class="prism language-cpp">$ <span class="token operator">/</span>usr<span class="token operator">/</span>bin<span class="token operator">/</span>python
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"This runtime still works!"</span><span class="token punctuation">)</span>
This runtime still works<span class="token operator">!</span>
</code></pre>
    <p>
     Homebrew非常棒，甚至为Python 2提供了不同的公式：
    </p>
    <pre><code class="prism language-cpp"><span class="token macro property"># If you need Homebrew's Python 2.7 run</span>
$ brew install python@<span class="token number">2</span>
</code></pre>
    <p>
     在任何时候，我们都可以从外壳程序的配置文件中删除别名，以使用系统上的默认Python副本返回。
    </p>
    <h3>
     <a id="pippip3_88">
     </a>
     不要忘记将pip更新为pip3！
    </h3>
    <p>
     该PIP命令是Python包专门默认的包管理器。尽管我们将默认的Python命令更改为版本3，但如果它在以前的版本中，我们必须单独为pip命令添加别名。首先，我们需要检查使用的版本：
    </p>
    <pre><code class="prism language-cpp"><span class="token macro property"># Note that this is a capital V (not lowercase)</span>
$ pip <span class="token operator">-</span>V
pip <span class="token number">19.0</span><span class="token number">.3</span> from <span class="token operator">/</span>Library<span class="token operator">/</span>Python<span class="token operator">/</span><span class="token number">2.7</span><span class="token operator">/</span>site<span class="token operator">-</span>packages<span class="token operator">/</span>pip<span class="token operator">-</span><span class="token number">19.0</span><span class="token number">.3</span><span class="token operator">-</span>py2<span class="token punctuation">.</span><span class="token number">7.</span>egg<span class="token operator">/</span>pip <span class="token punctuation">(</span>python <span class="token number">2.7</span><span class="token punctuation">)</span>
</code></pre>
    <p>
     为确保我们安装的软件包与我们新版本的Python兼容，我们将使用另一个别名来指向pip的兼容版本。由于在这种情况下我们将Homebrew用作软件包管理器，因此我们在安装Python 3时便知道它已安装pip3。默认路径应与Python 3相同，但是我们可以通过要求Shell找到它来确认它：
    </p>
    <pre><code class="prism language-cpp">$ which pip3
<span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>bin<span class="token operator">/</span>pip3
</code></pre>
    <p>
     现在我们知道了位置，我们将像以前一样将其添加到shell配置文件中：
    </p>
    <pre><code class="prism language-cpp">$ echo <span class="token string">"alias pip=/usr/local/bin/pip3"</span> <span class="token operator">&gt;&gt;</span> <span class="token operator">~</span><span class="token operator">/</span><span class="token punctuation">.</span>zshrc 
<span class="token macro property"># or for Bash</span>
$ echo <span class="token string">"alias pip=/usr/local/bin/pip3"</span> <span class="token operator">&gt;&gt;</span> <span class="token operator">~</span><span class="token operator">/</span><span class="token punctuation">.</span>bashrc
</code></pre>
    <p>
     最后，我们可以通过打开新的shell或重置当前的shell并查看指向的内容来确认运行中的pip指向pip3：
    </p>
    <pre><code class="prism language-cpp"><span class="token macro property"># This command reloads the current shell without exiting the session</span>
<span class="token macro property"># Alternatively, exit the shell and start a new one</span>
$ exec $<span class="token number">0</span>
<span class="token macro property"># Now we can look to see where pip points us</span>
$ which pip
pip<span class="token operator">:</span> aliased to <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>bin<span class="token operator">/</span>pip3
</code></pre>
    <p>
     我们可以避免使用Homebrew更新pip，但这需要
     <a href="https://packaging.python.org/tutorials/installing-packages/#id13" rel="nofollow">
      Python文档中更长的教程
     </a>
     。
    </p>
    <h2>
     <a id="_123">
     </a>
     我们应该怎么做
    </h2>
    <p>
     当要求对本文进行技术审查时，
     <a href="https://opensource.com/users/moshez" rel="nofollow">
      Moshe Zadka
     </a>
     向我警告说，我的解决方案可能导致运行哪个Python的想法不可靠，而该想法过于依赖于shell加载别名。我知道Moshe熟悉Python，但我不知道他是许多 Python教程的作者，还是即将出版的有关macOS上Python开发的书。他遵循一项核心原则，帮助40位同事在macOS系统上安全，一致地开发Python：
    </p>
    <blockquote>
     <p>
      “所有Python开发的基本前提是永远不要使用系统Python。您不希望 Mac OS X的’默认Python’是’python3’。您永远不必关心默认的Python。”
     </p>
    </blockquote>
    <p>
     我们如何停止关心默认值？Moshe建议使用
     <a href="https://github.com/pyenv/pyenv">
      pyenv
     </a>
     来管理Python环境（要进一步了解pyenv的配置，
     <a href="https://opensource.com/article/19/6/virtual-environments-python-macos" rel="nofollow">
      请参阅本文
     </a>
     ）。该工具将管理Python的多个版本，并被描述为“简单，易懂且遵循Unix的一站式工具的传统”。
    </p>
    <p>
     尽管提供了其他安装选项，但最简单的入门方法是使用Homebrew：
    </p>
    <pre><code class="prism language-cpp">$ brew install pyenv
🍺  <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>Cellar<span class="token operator">/</span>pyenv<span class="token operator">/</span><span class="token number">1.2</span><span class="token number">.10</span><span class="token operator">:</span> <span class="token number">634</span> files<span class="token punctuation">,</span> <span class="token number">2.4</span>MB
</code></pre>
    <p>
     现在，让我们安装最新的Python版本（截至撰写本文时为3.7.3）：
    </p>
    <pre><code class="prism language-cpp">$ pyenv install <span class="token number">3.7</span><span class="token number">.3</span>
python<span class="token operator">-</span>build<span class="token operator">:</span> use openssl <span class="token number">1.0</span> from homebrew
python<span class="token operator">-</span>build<span class="token operator">:</span> use readline from homebrew
Downloading Python<span class="token operator">-</span><span class="token number">3.7</span><span class="token number">.3</span><span class="token punctuation">.</span>tar<span class="token punctuation">.</span>xz<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token operator">-</span><span class="token operator">&gt;</span> https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>www<span class="token punctuation">.</span>python<span class="token punctuation">.</span>org<span class="token operator">/</span>ftp<span class="token operator">/</span>python<span class="token operator">/</span><span class="token number">3.7</span><span class="token number">.3</span><span class="token operator">/</span>Python<span class="token operator">-</span><span class="token number">3.7</span><span class="token number">.3</span><span class="token punctuation">.</span>tar<span class="token punctuation">.</span>xz
Installing Python<span class="token operator">-</span><span class="token number">3.7</span><span class="token number">.3</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
## further output <span class="token operator">not</span> included ##
</code></pre>
    <p>
     现在已经通过pyenv安装了Python 3，我们希望将其设置为pyenv环境的全局默认版本：
    </p>
    <pre><code class="prism language-cpp">$ pyenv global <span class="token number">3.7</span><span class="token number">.3</span>
<span class="token macro property"># and verify it worked</span>
$ pyenv version
<span class="token number">3.7</span><span class="token number">.3</span> <span class="token punctuation">(</span>set by <span class="token operator">/</span>Users<span class="token operator">/</span>mbbroberg<span class="token operator">/</span><span class="token punctuation">.</span>pyenv<span class="token operator">/</span>version<span class="token punctuation">)</span>
</code></pre>
    <p>
     pyenv的力量来自对外壳路径的控制。为了使其正常工作，我们需要将以下添加到我们的配置文件（
     <code>
      .zshrc
     </code>
     对我来说，可能的
     <code>
      .bash_profile
     </code>
     ）：
    </p>
    <pre><code class="prism language-cpp">$ echo <span class="token operator">-</span>e <span class="token string">'if command -v pyenv 1&gt;/dev/null 2&gt;&amp;1; then\n  eval "$(pyenv init -)"\nfi'</span> <span class="token operator">&gt;&gt;</span> <span class="token operator">~</span><span class="token operator">/</span><span class="token punctuation">.</span>zshrc
</code></pre>
    <p>
     该命令后，我们的dotfile（.zshrc为zsh中或.bash_profile中的Bash的）应该包括这些行：
    </p>
    <pre><code class="prism language-cpp"><span class="token keyword">if</span> command <span class="token operator">-</span>v pyenv <span class="token number">1</span><span class="token operator">&gt;</span><span class="token operator">/</span>dev<span class="token operator">/</span>null <span class="token number">2</span><span class="token operator">&gt;</span><span class="token operator">&amp;</span><span class="token number">1</span><span class="token punctuation">;</span> then
  eval <span class="token string">"$(pyenv init -)"</span>
fi
</code></pre>
    <p>
     我们还需要删除在以上各节中使用的别名， 因为它们会阻止正确使用pyenv。删除它们后，我们可以确认pyenv正在管理我们的Python 3版本：
    </p>
    <h2>
     <a id="I_start_by_resetting_the_current_shell_167">
     </a>
     I start by resetting the current shell
    </h2>
    <h2>
     <a id="Alternatively_start_a_new_terminal_instance_168">
     </a>
     Alternatively, start a new terminal instance
    </h2>
    <pre><code class="prism language-cpp">$ exec $<span class="token number">0</span>
$ which python
<span class="token operator">/</span>Users<span class="token operator">/</span>mbbroberg<span class="token operator">/</span><span class="token punctuation">.</span>pyenv<span class="token operator">/</span>shims<span class="token operator">/</span>python
$ python <span class="token operator">-</span>V
Python <span class="token number">3.7</span><span class="token number">.3</span>
$ pip <span class="token operator">-</span>V
pip <span class="token number">19.0</span><span class="token number">.3</span> from <span class="token operator">/</span>Users<span class="token operator">/</span>mbbroberg<span class="token operator">/</span><span class="token punctuation">.</span>pyenv<span class="token operator">/</span>versions<span class="token operator">/</span><span class="token number">3.7</span><span class="token number">.3</span><span class="token operator">/</span>lib<span class="token operator">/</span>python3<span class="token punctuation">.</span><span class="token number">7</span><span class="token operator">/</span>site<span class="token operator">-</span>packages<span class="token operator">/</span>pip <span class="token punctuation">(</span>python <span class="token number">3.7</span><span class="token punctuation">)</span>
</code></pre>
    <p>
     现在我们可以确定我们正在使用Python 3.7.3，并且pip会与之一起更新，而无需在版本之间进行任何手动别名。使用Moshe的建议来使用版本管理器（pyenv），使我们能够轻松地接受将来的升级，而不必对我们在给定时间运行的Python感到困惑。
    </p>
    <h3>
     <a id="Python_181">
     </a>
     接下来配置Python
    </h3>
    <p>
     熟悉此工作流程后，您可以
     <a href="https://opensource.com/article/20/4/pyenv" rel="nofollow">
      使用pyenv来管理Python的多个版本
     </a>
     。对于依赖关系管理，使用虚拟环境也是必不可少的。我在文章中提到了如何使用内置的
     <a href="https://docs.python.org/3/library/venv.html" rel="nofollow">
      venv
     </a>
     库，Moshe建议使用
     <a href="https://opensource.com/article/19/6/python-virtual-environments-mac" rel="nofollow">
      virtualenvwrapper来管理虚拟环境
     </a>
     。
    </p>
    <h2>
     <a id="_184">
     </a>
     从一开始就做
    </h2>
    <p>
     如果您刚刚开始在macOS上进行Python开发，请进行必要的配置，以确保从一开始就使用正确的Python版本。安装Python 3（带或不带Homebrew）以及使用别名可以让您开始编码，但是从长远来看，这并不是一个好的策略。
     <a href="https://opensource.com/article/19/6/virtual-environments-python-macos" rel="nofollow">
      使用pyenv
     </a>
     作为简单的版本管理解决方案，可以让您顺利开始。
    </p>
    <h2>
     <a id="_187">
     </a>
     参考
    </h2>
    <p>
     https://opensource.com/article/19/5/python-3-default-mac
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="6874747073:3a2f2f626c6f672e6373646e2e6e65742f7a6770656163652f:61727469636c652f64657461696c732f313038333830343139" class_="artid" style="display:none">
 </p>
</div>


