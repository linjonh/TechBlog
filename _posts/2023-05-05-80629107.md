---
layout: post
title: "Android中获取GPS搜索到的卫星颗数并获取每颗卫星的信噪比"
date: 2023-05-05 18:13:41 +0800
description: "信噪比概念  信噪比，英文名称叫做SNR或S/N（SIGNAL-NOISE RATIO)，又称为讯噪"
keywords: "有没有软件可以知道当前卫星数量和载噪比"
categories: ['Android']
tags: ['信噪比', 'Gps']
artid: "80629107"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=80629107
    alt: "Android中获取GPS搜索到的卫星颗数并获取每颗卫星的信噪比"
render_with_liquid: false
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     Android中获取GPS搜索到的卫星颗数、并获取每颗卫星的信噪比
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h4 id="信噪比概念">
     信噪比概念
    </h4>
    <blockquote>
     <p>
      信噪比，英文名称叫做SNR或S/N（SIGNAL-NOISE RATIO)，又称为讯噪比。是指一个电子设备或者电子系统中信号与噪声的比例
      <br/>
      信噪比越大此颗卫星越有效（也就是说可以定位）
     </p>
    </blockquote>
    <ul>
     <li>
      也就是说 设备搜索到的卫星颗数越多 设备定位效果越好，同时每颗卫星的信噪比值也要越高，如果信噪比值都是0的话；那跟没有搜索到一颗卫星效果是一样的。
     </li>
    </ul>
    <h4 id="获取设备搜索到的卫星颗数">
     获取设备搜索到的卫星颗数
    </h4>
    <ul>
     <li>
      首先就是声明权限了大于Android M设备记得动态申请
     </li>
    </ul>
    <pre class="prettyprint"><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-title">uses-permission</span> <span class="hljs-attribute">android:name</span>=<span class="hljs-value">"android.permission.ACCESS_COARSE_LOCATION"</span> /&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">uses-permission</span> <span class="hljs-attribute">android:name</span>=<span class="hljs-value">"android.permission.ACCESS_FINE_LOCATION"</span> /&gt;</span></code></pre>
    <ul>
     <li>
      初始化LocationManager 开启Gps
     </li>
    </ul>
    <pre class="prettyprint"><code class="hljs java"><span class="hljs-comment">//位置管理器</span>
<span class="hljs-keyword">private</span> LocationManager manager;

<span class="hljs-javadoc">/**
 * 初始化定位管理
 */</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">initLocation</span>() {
    manager = (LocationManager) getSystemService(Context.LOCATION_SERVICE);
    <span class="hljs-comment">//判断GPS是否正常启动</span>
    <span class="hljs-keyword">if</span> (!manager.isProviderEnabled(LocationManager.GPS_PROVIDER)) {
        Toast.makeText(<span class="hljs-keyword">this</span>, <span class="hljs-string">"请开启GPS导航"</span>, Toast.LENGTH_SHORT).show();
        <span class="hljs-comment">//返回开启GPS导航设置界面</span>
        Intent intent = <span class="hljs-keyword">new</span> Intent(Settings.ACTION_LOCATION_SOURCE_SETTINGS);
        startActivityForResult(intent, <span class="hljs-number">0</span>);
        <span class="hljs-keyword">return</span>;
    }
    <span class="hljs-comment">//添加卫星状态改变监听</span>
    manager.addGpsStatusListener(gpsStatusListener);
    <span class="hljs-comment">//1000位最小的时间间隔，1为最小位移变化；也就是说每隔1000ms会回调一次位置信息</span>
    manager.requestLocationUpdates(LocationManager.GPS_PROVIDER, <span class="hljs-number">1000</span>, <span class="hljs-number">1</span>, locationListener);
}</code></pre>
    <ul>
     <li>
      这里只关心卫星的一些信息，关于位置、经纬度信息这里就不关心了，所以上面的locationListener就是个空实现；这里重点看下卫星的获取，如下：
     </li>
    </ul>
    <pre class="prettyprint"><code class="hljs cs"><span class="hljs-keyword">private</span> GpsStatus.Listener gpsStatusListener = <span class="hljs-keyword">new</span> GpsStatus.Listener() {
    @Override
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onGpsStatusChanged</span>(<span class="hljs-keyword">int</span> <span class="hljs-keyword">event</span>) {
        <span class="hljs-keyword">switch</span> (<span class="hljs-keyword">event</span>) {
            <span class="hljs-comment">//卫星状态改变</span>
            <span class="hljs-keyword">case</span> GpsStatus.GPS_EVENT_SATELLITE_STATUS:
                <span class="hljs-comment">//获取当前状态</span>
                GpsStatus gpsStatus = manager.getGpsStatus(<span class="hljs-keyword">null</span>);
                <span class="hljs-comment">//获取卫星颗数的默认最大值</span>
                <span class="hljs-keyword">int</span> maxSatellites = gpsStatus.getMaxSatellites();
                <span class="hljs-comment">//获取所有的卫星</span>
                Iterator&lt;GpsSatellite&gt; iters = gpsStatus.getSatellites().iterator();
                <span class="hljs-comment">//卫星颗数统计</span>
                <span class="hljs-keyword">int</span> count = <span class="hljs-number">0</span>;
                StringBuilder sb = <span class="hljs-keyword">new</span> StringBuilder();
                <span class="hljs-keyword">while</span> (iters.hasNext() &amp;&amp; count &lt;= maxSatellites) {
                    count++;
                    GpsSatellite s = iters.next();
                    <span class="hljs-comment">//卫星的信噪比</span>
                    <span class="hljs-keyword">float</span> snr = s.getSnr();
                    sb.append(<span class="hljs-string">"第"</span>).append(count).append(<span class="hljs-string">"颗"</span>).append(<span class="hljs-string">"："</span>).append(snr).append(<span class="hljs-string">"\n"</span>);
                }
                Log.e(<span class="hljs-string">"TAG"</span>, sb.toString());
                <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">default</span>:
                <span class="hljs-keyword">break</span>;
        }
    }
};</code></pre>
    <blockquote>
     <p>
      到这里基本上就大功告成了，数据都是直接从监听中取出来就好了，输出的结果：
     </p>
    </blockquote>
    <ul>
     <li>
      通过遍历gpsStatus.getSatellites()；统计总卫星颗数同时获取每颗卫星的信噪比
     </li>
    </ul>
    <p>
     <img alt="这里写图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/95f002a6129b453e3d7c0bc108266578.png" title=""/>
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="687474:70733a2f2f626c6f672e6373646e2e6e65742f615f7a686f6e:2f61727469636c652f64657461696c732f3830363239313037" class_="artid" style="display:none">
 </p>
</div>


