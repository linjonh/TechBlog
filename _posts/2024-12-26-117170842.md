---
layout: post
title: "前端-excel导入-导出功能"
date: 2024-12-26 14:29:30 +0800
description: "文章浏览阅读8.3k次，点赞14次，1. 导入功能1.1 前端主导(工作大量在前端)上传excel文"
keywords: "前端excel导入导出"
categories: ['Javascript']
tags: ['无标签']
artid: "117170842"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=117170842
    alt: "前端-excel导入-导出功能"
render_with_liquid: false
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     前端 - excel导入 / 导出功能
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h2>
     <a id="1__0">
     </a>
     1. 导入功能
    </h2>
    <h3>
     <a id="11__1">
     </a>
     1.1 前端主导(工作大量在前端)
    </h3>
    <ul>
     <li>
      上传excel文件，把excel文件的内容读出来，还原成最基本的行列结构，按后端的接口要求回传过去。
      <br/>
      <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/31714c0c58de1c62a36de94862dafc1a.png"/>
     </li>
    </ul>
    <blockquote>
     <ul>
      <li>
       前端读excel文件，调接口
      </li>
     </ul>
    </blockquote>
    <h3>
     <a id="12__5">
     </a>
     1.2 后端主导(工作大量在后端)
    </h3>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/a2391440026fb72d92256eb3e97ee23c.png"/>
    </p>
    <blockquote>
     <ul>
      <li>
       前端上传excel文件
      </li>
     </ul>
    </blockquote>
    <h3>
     <a id="13__8">
     </a>
     1.3 实现
    </h3>
    <p>
     <strong>
      1. 安装必要插件
     </strong>
    </p>
    <blockquote>
     <p>
      这个插件叫做
      <code>
       xlsx
      </code>
     </p>
    </blockquote>
    <pre><code class="prism language-js">npm install xlsx <span class="token operator">-</span><span class="token constant">S</span>
<span class="token comment">//或者</span>
yarn add xlsx <span class="token operator">-</span><span class="token constant">S</span>
</code></pre>
    <p>
     <strong>
      2. 引入UploadExcel组件并注册全局
     </strong>
    </p>
    <ul>
     <li>
      UploadExcel组件
      <ul>
       <li>
        <code>
         UploadExcel/index.vue
        </code>
       </li>
      </ul>
     </li>
    </ul>
    <pre><code class="prism language-js"><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>input ref<span class="token operator">=</span><span class="token string">"excel-upload-input"</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"excel-upload-input"</span> type<span class="token operator">=</span><span class="token string">"file"</span> accept<span class="token operator">=</span><span class="token string">".xlsx, .xls"</span> @change<span class="token operator">=</span><span class="token string">"handleClick"</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"drop"</span> @drop<span class="token operator">=</span><span class="token string">"handleDrop"</span> @dragover<span class="token operator">=</span><span class="token string">"handleDragover"</span> @dragenter<span class="token operator">=</span><span class="token string">"handleDragover"</span><span class="token operator">&gt;</span>
      把excel文件拖到这里
      <span class="token operator">&lt;</span>el<span class="token operator">-</span>button <span class="token punctuation">:</span>loading<span class="token operator">=</span><span class="token string">"loading"</span> style<span class="token operator">=</span><span class="token string">"margin-left:16px;"</span> size<span class="token operator">=</span><span class="token string">"mini"</span> type<span class="token operator">=</span><span class="token string">"primary"</span> @click<span class="token operator">=</span><span class="token string">"handleUpload"</span><span class="token operator">&gt;</span>
        浏览
      <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>button<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
<span class="token keyword">import</span> <span class="token constant">XLSX</span> <span class="token keyword">from</span> <span class="token string">'xlsx'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{<!-- --></span>
  props<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
    beforeUpload<span class="token punctuation">:</span> Function<span class="token punctuation">,</span> <span class="token comment">// eslint-disable-line</span>
    onSuccess<span class="token punctuation">:</span> Function<span class="token comment">// eslint-disable-line</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span>
      loading<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
      excelData<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
        header<span class="token punctuation">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
        results<span class="token punctuation">:</span> <span class="token keyword">null</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  methods<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token function">generateData</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> header<span class="token punctuation">,</span> results <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>excelData<span class="token punctuation">.</span>header <span class="token operator">=</span> header
      <span class="token keyword">this</span><span class="token punctuation">.</span>excelData<span class="token punctuation">.</span>results <span class="token operator">=</span> results
      <span class="token keyword">this</span><span class="token punctuation">.</span>onSuccess <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">onSuccess</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>excelData<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">handleDrop</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      e<span class="token punctuation">.</span><span class="token function">stopPropagation</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      e<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>loading<span class="token punctuation">)</span> <span class="token keyword">return</span>
      <span class="token keyword">const</span> files <span class="token operator">=</span> e<span class="token punctuation">.</span>dataTransfer<span class="token punctuation">.</span>files
      <span class="token keyword">if</span> <span class="token punctuation">(</span>files<span class="token punctuation">.</span>length <span class="token operator">!==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>$message<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'Only support uploading one file!'</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">const</span> rawFile <span class="token operator">=</span> files<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token comment">// only use files[0]</span>

      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">isExcel</span><span class="token punctuation">(</span>rawFile<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>$message<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'Only supports upload .xlsx, .xls, .csv suffix files'</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token boolean">false</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">upload</span><span class="token punctuation">(</span>rawFile<span class="token punctuation">)</span>
      e<span class="token punctuation">.</span><span class="token function">stopPropagation</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      e<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">handleDragover</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      e<span class="token punctuation">.</span><span class="token function">stopPropagation</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      e<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      e<span class="token punctuation">.</span>dataTransfer<span class="token punctuation">.</span>dropEffect <span class="token operator">=</span> <span class="token string">'copy'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">handleUpload</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">[</span><span class="token string">'excel-upload-input'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">handleClick</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">const</span> files <span class="token operator">=</span> e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>files
      <span class="token keyword">const</span> rawFile <span class="token operator">=</span> files<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token comment">// only use files[0]</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>rawFile<span class="token punctuation">)</span> <span class="token keyword">return</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">upload</span><span class="token punctuation">(</span>rawFile<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">upload</span><span class="token punctuation">(</span>rawFile<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">[</span><span class="token string">'excel-upload-input'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token keyword">null</span> <span class="token comment">// fix can't select the same excel</span>

      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>beforeUpload<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">readerData</span><span class="token punctuation">(</span>rawFile<span class="token punctuation">)</span>
        <span class="token keyword">return</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">const</span> before <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">beforeUpload</span><span class="token punctuation">(</span>rawFile<span class="token punctuation">)</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>before<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">readerData</span><span class="token punctuation">(</span>rawFile<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">readerData</span><span class="token punctuation">(</span>rawFile<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>loading <span class="token operator">=</span> <span class="token boolean">true</span>
      <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> reject<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">const</span> reader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileReader</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        reader<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> e <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
          <span class="token keyword">const</span> data <span class="token operator">=</span> e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>result
          <span class="token keyword">const</span> workbook <span class="token operator">=</span> <span class="token constant">XLSX</span><span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span> type<span class="token punctuation">:</span> <span class="token string">'array'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
          <span class="token keyword">const</span> firstSheetName <span class="token operator">=</span> workbook<span class="token punctuation">.</span>SheetNames<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
          <span class="token keyword">const</span> worksheet <span class="token operator">=</span> workbook<span class="token punctuation">.</span>Sheets<span class="token punctuation">[</span>firstSheetName<span class="token punctuation">]</span>
          <span class="token keyword">const</span> header <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getHeaderRow</span><span class="token punctuation">(</span>worksheet<span class="token punctuation">)</span>
          <span class="token keyword">const</span> results <span class="token operator">=</span> <span class="token constant">XLSX</span><span class="token punctuation">.</span>utils<span class="token punctuation">.</span><span class="token function">sheet_to_json</span><span class="token punctuation">(</span>worksheet<span class="token punctuation">)</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">generateData</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> header<span class="token punctuation">,</span> results <span class="token punctuation">}</span><span class="token punctuation">)</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span>loading <span class="token operator">=</span> <span class="token boolean">false</span>
          <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        reader<span class="token punctuation">.</span><span class="token function">readAsArrayBuffer</span><span class="token punctuation">(</span>rawFile<span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">getHeaderRow</span><span class="token punctuation">(</span>sheet<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">const</span> headers <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
      <span class="token keyword">const</span> range <span class="token operator">=</span> <span class="token constant">XLSX</span><span class="token punctuation">.</span>utils<span class="token punctuation">.</span><span class="token function">decode_range</span><span class="token punctuation">(</span>sheet<span class="token punctuation">[</span><span class="token string">'!ref'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
      <span class="token keyword">let</span> <span class="token constant">C</span>
      <span class="token keyword">const</span> <span class="token constant">R</span> <span class="token operator">=</span> range<span class="token punctuation">.</span>s<span class="token punctuation">.</span>r
      <span class="token comment">/* start in the first row */</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token constant">C</span> <span class="token operator">=</span> range<span class="token punctuation">.</span>s<span class="token punctuation">.</span>c<span class="token punctuation">;</span> <span class="token constant">C</span> <span class="token operator">&lt;=</span> range<span class="token punctuation">.</span>e<span class="token punctuation">.</span>c<span class="token punctuation">;</span> <span class="token operator">++</span><span class="token constant">C</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token comment">/* walk every column in the range */</span>
        <span class="token keyword">const</span> cell <span class="token operator">=</span> sheet<span class="token punctuation">[</span><span class="token constant">XLSX</span><span class="token punctuation">.</span>utils<span class="token punctuation">.</span><span class="token function">encode_cell</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> c<span class="token punctuation">:</span> <span class="token constant">C</span><span class="token punctuation">,</span> r<span class="token punctuation">:</span> <span class="token constant">R</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
        <span class="token comment">/* find the cell in the first row */</span>
        <span class="token keyword">let</span> hdr <span class="token operator">=</span> <span class="token string">'UNKNOWN '</span> <span class="token operator">+</span> <span class="token constant">C</span> <span class="token comment">// &lt;-- replace with your desired default</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>cell <span class="token operator">&amp;&amp;</span> cell<span class="token punctuation">.</span>t<span class="token punctuation">)</span> hdr <span class="token operator">=</span> <span class="token constant">XLSX</span><span class="token punctuation">.</span>utils<span class="token punctuation">.</span><span class="token function">format_cell</span><span class="token punctuation">(</span>cell<span class="token punctuation">)</span>
        headers<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>hdr<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> headers
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">isExcel</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">return</span> <span class="token operator">/</span>\<span class="token punctuation">.</span><span class="token punctuation">(</span>xlsx<span class="token operator">|</span>xls<span class="token operator">|</span>csv<span class="token punctuation">)</span>$<span class="token operator">/</span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>file<span class="token punctuation">.</span>name<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>style scoped<span class="token operator">&gt;</span>
<span class="token punctuation">.</span>excel<span class="token operator">-</span>upload<span class="token operator">-</span>input<span class="token punctuation">{<!-- --></span>
  display<span class="token punctuation">:</span> none<span class="token punctuation">;</span>
  z<span class="token operator">-</span>index<span class="token punctuation">:</span> <span class="token operator">-</span><span class="token number">9999</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>drop<span class="token punctuation">{<!-- --></span>
  border<span class="token punctuation">:</span> <span class="token number">2</span>px dashed #bbb<span class="token punctuation">;</span>
  width<span class="token punctuation">:</span> <span class="token number">600</span>px<span class="token punctuation">;</span>
  height<span class="token punctuation">:</span> <span class="token number">160</span>px<span class="token punctuation">;</span>
  line<span class="token operator">-</span>height<span class="token punctuation">:</span> <span class="token number">160</span>px<span class="token punctuation">;</span>
  margin<span class="token punctuation">:</span> <span class="token number">0</span> auto<span class="token punctuation">;</span>
  font<span class="token operator">-</span>size<span class="token punctuation">:</span> <span class="token number">24</span>px<span class="token punctuation">;</span>
  border<span class="token operator">-</span>radius<span class="token punctuation">:</span> <span class="token number">5</span>px<span class="token punctuation">;</span>
  text<span class="token operator">-</span>align<span class="token punctuation">:</span> center<span class="token punctuation">;</span>
  color<span class="token punctuation">:</span> #bbb<span class="token punctuation">;</span>
  position<span class="token punctuation">:</span> relative<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span>
</code></pre>
    <p>
     <strong>
      3. 注册
     </strong>
    </p>
    <pre><code class="prism language-js"><span class="token keyword">import</span> UploadExcel <span class="token keyword">from</span> <span class="token string">'./UploadExcel'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{<!-- --></span>
  <span class="token comment">// 插件的初始化, 插件给你提供的全局的功能, 都可以在这里配置</span>
  <span class="token function">install</span><span class="token punctuation">(</span>Vue<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 进行组件的全局注册</span>
    Vue<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span><span class="token string">'UploadExcel'</span><span class="token punctuation">,</span> UploadExcel<span class="token punctuation">)</span> <span class="token comment">// 注册导入excel组件</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     <strong>
      4. 新建一个公共的导入页面
     </strong>
    </p>
    <pre><code class="prism language-js"><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>upload<span class="token operator">-</span>excel <span class="token punctuation">:</span>on<span class="token operator">-</span>success<span class="token operator">=</span><span class="token string">"handleSuccess"</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{<!-- --></span>
  name<span class="token punctuation">:</span> <span class="token string">'Import'</span><span class="token punctuation">,</span>
  methods<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token function">handleSuccess</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> header<span class="token punctuation">,</span> results <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>header<span class="token punctuation">,</span> results<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre>
    <blockquote>
     <ul>
      <li>
       excel导入插件本质：把excel经过分析转换成js能够识别的常规数据，拿到数据我们可以进行任何操作
      </li>
     </ul>
    </blockquote>
    <p>
     <strong>
      数据处理
     </strong>
    </p>
    <ul>
     <li>
      数据格式转换：将excel解析好的数据经过处理后，转成可以传给接口调用的数据
      <br/>
      <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/4d2db70c6e78236b9db37e3c59f41f8c.png"/>
     </li>
    </ul>
    <blockquote>
     <p>
      调用接口进行excel上传的重点其实是数据的处理，我们需要按照接口的要求，把excel表格中经过插件处理好的数据处理成后端接口要求的格式
     </p>
    </blockquote>
    <blockquote>
     <p>
      下面是后端接口要求的示例格式
      <br/>
      <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/b81089552b106bd3a36b143198e63ed4.png"/>
     </p>
    </blockquote>
    <ul>
     <li>
      按接口要求，处理excel导入的数据
     </li>
    </ul>
    <blockquote>
     <p>
      处理内容包含：
     </p>
     <ul>
      <li>
       字段中文转英文。excel中读入的是
       <code>
        姓名
       </code>
       ,而后端需要的是
       <code>
        username
       </code>
      </li>
      <li>
       日期处理。从excel中读入的时间是一个number值，而后端需要的是标准日期。
      </li>
     </ul>
    </blockquote>
    <p>
     <strong>
      5. 我们单独封装一个方法来实现这个转换的功能
     </strong>
    </p>
    <pre><code class="prism language-js"><span class="token comment">/**
     * results excel表格的内容
      //        [ {'姓名'：'小张'， '手机号': '13712345678'}, {.....} ]

      // 目标
      //        [ {'username'：'小张'， 'mobile': '13712345678'}, {.....} ]
     */</span>
    <span class="token function">transExcel</span><span class="token punctuation">(</span>results<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">const</span> userRelations <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
        <span class="token string">'入职日期'</span><span class="token punctuation">:</span> <span class="token string">'timeOfEntry'</span><span class="token punctuation">,</span>
        <span class="token string">'手机号'</span><span class="token punctuation">:</span> <span class="token string">'mobile'</span><span class="token punctuation">,</span>
        <span class="token string">'姓名'</span><span class="token punctuation">:</span> <span class="token string">'username'</span><span class="token punctuation">,</span>
        <span class="token string">'转正日期'</span><span class="token punctuation">:</span> <span class="token string">'correctionTime'</span><span class="token punctuation">,</span>
        <span class="token string">'工号'</span><span class="token punctuation">:</span> <span class="token string">'workNumber'</span><span class="token punctuation">,</span>
        <span class="token string">'部门'</span><span class="token punctuation">:</span> <span class="token string">'departmentName'</span><span class="token punctuation">,</span>
        <span class="token string">'聘用形式'</span><span class="token punctuation">:</span> <span class="token string">'formOfEmployment'</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> results<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>item <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
        <span class="token comment">// 1. 取出这个对象所有的属性名： ['姓名'， ‘手机号’]</span>
        <span class="token comment">// 2. 遍历这个数组，通过 中文名去 userRelations 找对应英文名， 保存值</span>
        <span class="token keyword">const</span> zhKeys <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span>
        zhKeys<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>zhKey <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
          <span class="token keyword">const</span> enKey <span class="token operator">=</span> userRelations<span class="token punctuation">[</span>zhKey<span class="token punctuation">]</span>
          <span class="token comment">// 如果是时间格式，就要做转换</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>enKey <span class="token operator">===</span> <span class="token string">'correctionTime'</span> <span class="token operator">||</span> enKey <span class="token operator">===</span> <span class="token string">'timeOfEntry'</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            obj<span class="token punctuation">[</span>enKey<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token function">formatExcelDate</span><span class="token punctuation">(</span>item<span class="token punctuation">[</span>zhKey<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
          <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
            obj<span class="token punctuation">[</span>enKey<span class="token punctuation">]</span> <span class="token operator">=</span> item<span class="token punctuation">[</span>zhKey<span class="token punctuation">]</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>

        <span class="token keyword">return</span> obj
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

<span class="token function">handleSuccess</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> results<span class="token punctuation">,</span> header <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'从当前excel文件中读出的内容是'</span><span class="token punctuation">,</span> results<span class="token punctuation">)</span>
  <span class="token comment">// results: [{入职日期: 44502, 姓名：xxxx}]</span>
  <span class="token comment">// 目标：</span>
  <span class="token comment">// results: [{timeOfEntry: 44502, username：xxxx}]</span>
  <span class="token comment">// 处理从excel中读入的格式</span>
  <span class="token keyword">const</span> arr <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">transExcel</span><span class="token punctuation">(</span>results<span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'转换之后的格式是'</span><span class="token punctuation">,</span> arr<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
    <p>
     <strong>
      6. 日期处理函数
     </strong>
    </p>
    <pre><code class="prism language-js"><span class="token comment">// 把excel文件中的日期格式的内容转回成标准时间</span>
<span class="token comment">// https://blog.csdn.net/qq_15054679/article/details/107712966</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">formatExcelDate</span><span class="token punctuation">(</span>numb<span class="token punctuation">,</span> format <span class="token operator">=</span> <span class="token string">'/'</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">const</span> time <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">(</span>numb <span class="token operator">-</span> <span class="token number">25567</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">24</span> <span class="token operator">*</span> <span class="token number">3600000</span> <span class="token operator">-</span> <span class="token number">5</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">1000</span> <span class="token operator">-</span> <span class="token number">43</span> <span class="token operator">*</span> <span class="token number">1000</span> <span class="token operator">-</span> <span class="token number">24</span> <span class="token operator">*</span> <span class="token number">3600000</span> <span class="token operator">-</span> <span class="token number">8</span> <span class="token operator">*</span> <span class="token number">3600000</span><span class="token punctuation">)</span>
  time<span class="token punctuation">.</span><span class="token function">setYear</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span><span class="token function">getFullYear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> year <span class="token operator">=</span> time<span class="token punctuation">.</span><span class="token function">getFullYear</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">''</span>
  <span class="token keyword">const</span> month <span class="token operator">=</span> time<span class="token punctuation">.</span><span class="token function">getMonth</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">+</span> <span class="token string">''</span>
  <span class="token keyword">const</span> date <span class="token operator">=</span> time<span class="token punctuation">.</span><span class="token function">getDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">''</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>format <span class="token operator">&amp;&amp;</span> format<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> year <span class="token operator">+</span> format <span class="token operator">+</span> month <span class="token operator">+</span> format <span class="token operator">+</span> date
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> year <span class="token operator">+</span> <span class="token punctuation">(</span>month <span class="token operator">&lt;</span> <span class="token number">10</span> <span class="token operator">?</span> <span class="token string">'0'</span> <span class="token operator">+</span> month <span class="token punctuation">:</span> month<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>date <span class="token operator">&lt;</span> <span class="token number">10</span> <span class="token operator">?</span> <span class="token string">'0'</span> <span class="token operator">+</span> date <span class="token punctuation">:</span> date<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     下面我们就可以调接口了
    </p>
    <ul>
     <li>
      例子
     </li>
     <li>
      <pre><code>  	接口:
</code></pre>
     </li>
    </ul>
    <pre><code class="prism language-js"><span class="token comment">/**
 * @description: 导入excel
 * @param {*} data
 * @return {*}
 */</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">importEmployee</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">return</span> <span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
    url<span class="token punctuation">:</span> <span class="token string">'/sys/user/batch'</span><span class="token punctuation">,</span>
    method<span class="token punctuation">:</span> <span class="token string">'post'</span><span class="token punctuation">,</span>
    data
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre>
    <ul>
     <li>
      <pre><code>  - 在页面中使用
</code></pre>
     </li>
    </ul>
    <pre><code class="prism language-js"><span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span> importEmployee <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@/api/employees'</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{<!-- --></span>
  name<span class="token punctuation">:</span> <span class="token string">'Import'</span><span class="token punctuation">,</span>
  methods<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">async</span> <span class="token function">handleSuccess</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> results<span class="token punctuation">,</span> header <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'从当前excel文件中读出的内容是'</span><span class="token punctuation">,</span> results<span class="token punctuation">)</span>
        <span class="token comment">// results: [{入职日期: 44502, 姓名：xxxx}]</span>
        <span class="token comment">// 目标：</span>
        <span class="token comment">// results: [{timeOfEntry: 44502, username：xxxx}]</span>
        <span class="token keyword">const</span> arr <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">transExcel</span><span class="token punctuation">(</span>results<span class="token punctuation">)</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'转换之后的格式是'</span><span class="token punctuation">,</span> arr<span class="token punctuation">)</span>
        <span class="token comment">// 调用上传的接口，</span>
        <span class="token keyword">const</span> rs <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">importEmployee</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'调用上传的接口'</span><span class="token punctuation">,</span> rs<span class="token punctuation">)</span>
        <span class="token comment">// 上传成功之后，回去刚才的页面</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>$router<span class="token punctuation">.</span><span class="token function">back</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>$message<span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span><span class="token string">'操作成功'</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">err</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>$message<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span>message<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <h2>
     <a id="2__319">
     </a>
     2. 导出功能
    </h2>
    <blockquote>
     <p>
      在表格中查询到了我们需要的数据，希望用他们生成excel文件，保存在本地。
     </p>
    </blockquote>
    <h3>
     <a id="21__321">
     </a>
     2.1 前端主导（工作大量在前端）
    </h3>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/f4e0ce65924b6ada32e6c7fec39b33d2.png"/>
    </p>
    <ul>
     <li>
      取回数据，保存excel文件
     </li>
    </ul>
    <h3>
     <a id="22__325">
     </a>
     2.2 后端主导（工作大量在后端）
    </h3>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/f49356f224984d5696a8f583beabc557.png"/>
    </p>
    <blockquote>
     <p>
      前端调用接口
     </p>
    </blockquote>
    <h3>
     <a id="23__329">
     </a>
     2.3 实现
    </h3>
    <p>
     <strong>
      1. 安装依赖
     </strong>
    </p>
    <pre><code class="prism language-js">npm install file<span class="token operator">-</span>saver script<span class="token operator">-</span>loader <span class="token operator">--</span>save
</code></pre>
    <p>
     <strong>
      2. 导入文件
     </strong>
    </p>
    <ul>
     <li>
      src/vendor/export2Excel.js
     </li>
    </ul>
    <pre><code class="prism language-js"><span class="token comment">/* eslint-disable */</span>
<span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span> saveAs <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'file-saver'</span>
<span class="token keyword">import</span> <span class="token constant">XLSX</span> <span class="token keyword">from</span> <span class="token string">'xlsx'</span>

<span class="token keyword">function</span> <span class="token function">generateArray</span><span class="token punctuation">(</span>table<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">var</span> out <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> rows <span class="token operator">=</span> table<span class="token punctuation">.</span><span class="token function">querySelectorAll</span><span class="token punctuation">(</span><span class="token string">'tr'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> ranges <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> <span class="token constant">R</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token constant">R</span> <span class="token operator">&lt;</span> rows<span class="token punctuation">.</span>length<span class="token punctuation">;</span> <span class="token operator">++</span><span class="token constant">R</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">var</span> outRow <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> row <span class="token operator">=</span> rows<span class="token punctuation">[</span><span class="token constant">R</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> columns <span class="token operator">=</span> row<span class="token punctuation">.</span><span class="token function">querySelectorAll</span><span class="token punctuation">(</span><span class="token string">'td'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> <span class="token constant">C</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token constant">C</span> <span class="token operator">&lt;</span> columns<span class="token punctuation">.</span>length<span class="token punctuation">;</span> <span class="token operator">++</span><span class="token constant">C</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">var</span> cell <span class="token operator">=</span> columns<span class="token punctuation">[</span><span class="token constant">C</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword">var</span> colspan <span class="token operator">=</span> cell<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">'colspan'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">var</span> rowspan <span class="token operator">=</span> cell<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">'rowspan'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">var</span> cellValue <span class="token operator">=</span> cell<span class="token punctuation">.</span>innerText<span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>cellValue <span class="token operator">!==</span> <span class="token string">""</span> <span class="token operator">&amp;&amp;</span> cellValue <span class="token operator">==</span> <span class="token operator">+</span>cellValue<span class="token punctuation">)</span> cellValue <span class="token operator">=</span> <span class="token operator">+</span>cellValue<span class="token punctuation">;</span>

      <span class="token comment">//Skip ranges</span>
      ranges<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span>range<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token constant">R</span> <span class="token operator">&gt;=</span> range<span class="token punctuation">.</span>s<span class="token punctuation">.</span>r <span class="token operator">&amp;&amp;</span> <span class="token constant">R</span> <span class="token operator">&lt;=</span> range<span class="token punctuation">.</span>e<span class="token punctuation">.</span>r <span class="token operator">&amp;&amp;</span> outRow<span class="token punctuation">.</span>length <span class="token operator">&gt;=</span> range<span class="token punctuation">.</span>s<span class="token punctuation">.</span>c <span class="token operator">&amp;&amp;</span> outRow<span class="token punctuation">.</span>length <span class="token operator">&lt;=</span> range<span class="token punctuation">.</span>e<span class="token punctuation">.</span>c<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
          <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> range<span class="token punctuation">.</span>e<span class="token punctuation">.</span>c <span class="token operator">-</span> range<span class="token punctuation">.</span>s<span class="token punctuation">.</span>c<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> outRow<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token comment">//Handle Row Span</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>rowspan <span class="token operator">||</span> colspan<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        rowspan <span class="token operator">=</span> rowspan <span class="token operator">||</span> <span class="token number">1</span><span class="token punctuation">;</span>
        colspan <span class="token operator">=</span> colspan <span class="token operator">||</span> <span class="token number">1</span><span class="token punctuation">;</span>
        ranges<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
          s<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
            r<span class="token punctuation">:</span> <span class="token constant">R</span><span class="token punctuation">,</span>
            c<span class="token punctuation">:</span> outRow<span class="token punctuation">.</span>length
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          e<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
            r<span class="token punctuation">:</span> <span class="token constant">R</span> <span class="token operator">+</span> rowspan <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span>
            c<span class="token punctuation">:</span> outRow<span class="token punctuation">.</span>length <span class="token operator">+</span> colspan <span class="token operator">-</span> <span class="token number">1</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>

      <span class="token comment">//Handle Value</span>
      outRow<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>cellValue <span class="token operator">!==</span> <span class="token string">""</span> <span class="token operator">?</span> cellValue <span class="token punctuation">:</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token comment">//Handle Colspan</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>colspan<span class="token punctuation">)</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> k <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> k <span class="token operator">&lt;</span> colspan <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token operator">++</span>k<span class="token punctuation">)</span> outRow<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    out<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>outRow<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token punctuation">[</span>out<span class="token punctuation">,</span> ranges<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">datenum</span><span class="token punctuation">(</span>v<span class="token punctuation">,</span> date1904<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>date1904<span class="token punctuation">)</span> v <span class="token operator">+=</span> <span class="token number">1462</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> epoch <span class="token operator">=</span> Date<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>epoch <span class="token operator">-</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>Date<span class="token punctuation">.</span><span class="token constant">UTC</span><span class="token punctuation">(</span><span class="token number">1899</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token number">24</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">sheet_from_array_of_arrays</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> opts<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">var</span> ws <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> range <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
    s<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
      c<span class="token punctuation">:</span> <span class="token number">10000000</span><span class="token punctuation">,</span>
      r<span class="token punctuation">:</span> <span class="token number">10000000</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    e<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
      c<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
      r<span class="token punctuation">:</span> <span class="token number">0</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> <span class="token constant">R</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token constant">R</span> <span class="token operator">!=</span> data<span class="token punctuation">.</span>length<span class="token punctuation">;</span> <span class="token operator">++</span><span class="token constant">R</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> <span class="token constant">C</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token constant">C</span> <span class="token operator">!=</span> data<span class="token punctuation">[</span><span class="token constant">R</span><span class="token punctuation">]</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span> <span class="token operator">++</span><span class="token constant">C</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>range<span class="token punctuation">.</span>s<span class="token punctuation">.</span>r <span class="token operator">&gt;</span> <span class="token constant">R</span><span class="token punctuation">)</span> range<span class="token punctuation">.</span>s<span class="token punctuation">.</span>r <span class="token operator">=</span> <span class="token constant">R</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>range<span class="token punctuation">.</span>s<span class="token punctuation">.</span>c <span class="token operator">&gt;</span> <span class="token constant">C</span><span class="token punctuation">)</span> range<span class="token punctuation">.</span>s<span class="token punctuation">.</span>c <span class="token operator">=</span> <span class="token constant">C</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>range<span class="token punctuation">.</span>e<span class="token punctuation">.</span>r <span class="token operator">&lt;</span> <span class="token constant">R</span><span class="token punctuation">)</span> range<span class="token punctuation">.</span>e<span class="token punctuation">.</span>r <span class="token operator">=</span> <span class="token constant">R</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>range<span class="token punctuation">.</span>e<span class="token punctuation">.</span>c <span class="token operator">&lt;</span> <span class="token constant">C</span><span class="token punctuation">)</span> range<span class="token punctuation">.</span>e<span class="token punctuation">.</span>c <span class="token operator">=</span> <span class="token constant">C</span><span class="token punctuation">;</span>
      <span class="token keyword">var</span> cell <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
        v<span class="token punctuation">:</span> data<span class="token punctuation">[</span><span class="token constant">R</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token constant">C</span><span class="token punctuation">]</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>cell<span class="token punctuation">.</span>v <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">continue</span><span class="token punctuation">;</span>
      <span class="token keyword">var</span> cell_ref <span class="token operator">=</span> <span class="token constant">XLSX</span><span class="token punctuation">.</span>utils<span class="token punctuation">.</span><span class="token function">encode_cell</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
        c<span class="token punctuation">:</span> <span class="token constant">C</span><span class="token punctuation">,</span>
        r<span class="token punctuation">:</span> <span class="token constant">R</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> cell<span class="token punctuation">.</span>v <span class="token operator">===</span> <span class="token string">'number'</span><span class="token punctuation">)</span> cell<span class="token punctuation">.</span>t <span class="token operator">=</span> <span class="token string">'n'</span><span class="token punctuation">;</span>
      <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> cell<span class="token punctuation">.</span>v <span class="token operator">===</span> <span class="token string">'boolean'</span><span class="token punctuation">)</span> cell<span class="token punctuation">.</span>t <span class="token operator">=</span> <span class="token string">'b'</span><span class="token punctuation">;</span>
      <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>cell<span class="token punctuation">.</span>v <span class="token keyword">instanceof</span> <span class="token class-name">Date</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        cell<span class="token punctuation">.</span>t <span class="token operator">=</span> <span class="token string">'n'</span><span class="token punctuation">;</span>
        cell<span class="token punctuation">.</span>z <span class="token operator">=</span> <span class="token constant">XLSX</span><span class="token punctuation">.</span><span class="token constant">SSF</span><span class="token punctuation">.</span>_table<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        cell<span class="token punctuation">.</span>v <span class="token operator">=</span> <span class="token function">datenum</span><span class="token punctuation">(</span>cell<span class="token punctuation">.</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> cell<span class="token punctuation">.</span>t <span class="token operator">=</span> <span class="token string">'s'</span><span class="token punctuation">;</span>

      ws<span class="token punctuation">[</span>cell_ref<span class="token punctuation">]</span> <span class="token operator">=</span> cell<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>range<span class="token punctuation">.</span>s<span class="token punctuation">.</span>c <span class="token operator">&lt;</span> <span class="token number">10000000</span><span class="token punctuation">)</span> ws<span class="token punctuation">[</span><span class="token string">'!ref'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token constant">XLSX</span><span class="token punctuation">.</span>utils<span class="token punctuation">.</span><span class="token function">encode_range</span><span class="token punctuation">(</span>range<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> ws<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">Workbook</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token keyword">instanceof</span> <span class="token class-name">Workbook</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Workbook</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>SheetNames <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>Sheets <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">s2ab</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">var</span> buf <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayBuffer</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> view <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Uint8Array</span><span class="token punctuation">(</span>buf<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">!=</span> s<span class="token punctuation">.</span>length<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> view<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> s<span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xFF</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> buf<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">export_table_to_excel</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">var</span> theTable <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> oo <span class="token operator">=</span> <span class="token function">generateArray</span><span class="token punctuation">(</span>theTable<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> ranges <span class="token operator">=</span> oo<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

  <span class="token comment">/* original data */</span>
  <span class="token keyword">var</span> data <span class="token operator">=</span> oo<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> ws_name <span class="token operator">=</span> <span class="token string">"SheetJS"</span><span class="token punctuation">;</span>

  <span class="token keyword">var</span> wb <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Workbook</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    ws <span class="token operator">=</span> <span class="token function">sheet_from_array_of_arrays</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">/* add ranges to worksheet */</span>
  <span class="token comment">// ws['!cols'] = ['apple', 'banan'];</span>
  ws<span class="token punctuation">[</span><span class="token string">'!merges'</span><span class="token punctuation">]</span> <span class="token operator">=</span> ranges<span class="token punctuation">;</span>

  <span class="token comment">/* add worksheet to workbook */</span>
  wb<span class="token punctuation">.</span>SheetNames<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>ws_name<span class="token punctuation">)</span><span class="token punctuation">;</span>
  wb<span class="token punctuation">.</span>Sheets<span class="token punctuation">[</span>ws_name<span class="token punctuation">]</span> <span class="token operator">=</span> ws<span class="token punctuation">;</span>

  <span class="token keyword">var</span> wbout <span class="token operator">=</span> <span class="token constant">XLSX</span><span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>wb<span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span>
    bookType<span class="token punctuation">:</span> <span class="token string">'xlsx'</span><span class="token punctuation">,</span>
    bookSST<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    type<span class="token punctuation">:</span> <span class="token string">'binary'</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">saveAs</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Blob</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token function">s2ab</span><span class="token punctuation">(</span>wbout<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span>
    type<span class="token punctuation">:</span> <span class="token string">"application/octet-stream"</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"test.xlsx"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">export_json_to_excel</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
  multiHeader <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  header<span class="token punctuation">,</span>
  data<span class="token punctuation">,</span>
  filename<span class="token punctuation">,</span>
  merges <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  autoWidth <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  bookType <span class="token operator">=</span> <span class="token string">'xlsx'</span>
<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token comment">/* original data */</span>
  filename <span class="token operator">=</span> filename <span class="token operator">||</span> <span class="token string">'excel-list'</span>
  data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span>data<span class="token punctuation">]</span>
  data<span class="token punctuation">.</span><span class="token function">unshift</span><span class="token punctuation">(</span>header<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> multiHeader<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&gt;</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    data<span class="token punctuation">.</span><span class="token function">unshift</span><span class="token punctuation">(</span>multiHeader<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">var</span> ws_name <span class="token operator">=</span> <span class="token string">"SheetJS"</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> wb <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Workbook</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    ws <span class="token operator">=</span> <span class="token function">sheet_from_array_of_arrays</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>merges<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>ws<span class="token punctuation">[</span><span class="token string">'!merges'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> ws<span class="token punctuation">[</span><span class="token string">'!merges'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    merges<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>item <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
      ws<span class="token punctuation">[</span><span class="token string">'!merges'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token constant">XLSX</span><span class="token punctuation">.</span>utils<span class="token punctuation">.</span><span class="token function">decode_range</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>autoWidth<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">/*设置worksheet每列的最大宽度*/</span>
    <span class="token keyword">const</span> colWidth <span class="token operator">=</span> data<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>row <span class="token operator">=&gt;</span> row<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>val <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
      <span class="token comment">/*先判断是否为null/undefined*/</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>val <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span>
          <span class="token string">'wch'</span><span class="token punctuation">:</span> <span class="token number">10</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token comment">/*再判断是否为中文*/</span>
      <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>val<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">255</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span>
          <span class="token string">'wch'</span><span class="token punctuation">:</span> val<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length <span class="token operator">*</span> <span class="token number">2</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span>
          <span class="token string">'wch'</span><span class="token punctuation">:</span> val<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment">/*以第一行为初始值*/</span>
    <span class="token keyword">let</span> result <span class="token operator">=</span> colWidth<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> colWidth<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> colWidth<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'wch'</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span> colWidth<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'wch'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
          result<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'wch'</span><span class="token punctuation">]</span> <span class="token operator">=</span> colWidth<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'wch'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    ws<span class="token punctuation">[</span><span class="token string">'!cols'</span><span class="token punctuation">]</span> <span class="token operator">=</span> result<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">/* add worksheet to workbook */</span>
  wb<span class="token punctuation">.</span>SheetNames<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>ws_name<span class="token punctuation">)</span><span class="token punctuation">;</span>
  wb<span class="token punctuation">.</span>Sheets<span class="token punctuation">[</span>ws_name<span class="token punctuation">]</span> <span class="token operator">=</span> ws<span class="token punctuation">;</span>

  <span class="token keyword">var</span> wbout <span class="token operator">=</span> <span class="token constant">XLSX</span><span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>wb<span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span>
    bookType<span class="token punctuation">:</span> bookType<span class="token punctuation">,</span>
    bookSST<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    type<span class="token punctuation">:</span> <span class="token string">'binary'</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">saveAs</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Blob</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token function">s2ab</span><span class="token punctuation">(</span>wbout<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span>
    type<span class="token punctuation">:</span> <span class="token string">"application/octet-stream"</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${<!-- --></span>filename<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">.</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${<!-- --></span>bookType<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     <strong>
      3. 给导出按钮添加点击事件
     </strong>
    </p>
    <pre><code class="prism language-js"><span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'@/vendor/Export2Excel'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>excel <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
  <span class="token comment">// excel表示导入的模块对象</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>excel<span class="token punctuation">)</span>
  excel<span class="token punctuation">.</span><span class="token function">export_json_to_excel</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
    header<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'姓名'</span><span class="token punctuation">,</span> <span class="token string">'工资'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// 表头 必填</span>
    data<span class="token punctuation">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">[</span><span class="token string">'刘备'</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">[</span><span class="token string">'关羽'</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">]</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// 具体数据 必填</span>
    filename<span class="token punctuation">:</span> <span class="token string">'excel-list'</span><span class="token punctuation">,</span> <span class="token comment">// 文件名称</span>
    autoWidth<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 宽度是否自适应</span>
    bookType<span class="token punctuation">:</span> <span class="token string">'xlsx'</span> <span class="token comment">// 生成的文件类型</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>


以上代码表示<span class="token punctuation">:</span>

<span class="token number">1.</span> 当我们正式点击导出按钮之后，才去加载vendor文件夹中的Export2Excel模块
<span class="token number">2.</span> <span class="token keyword">import</span>方法执行完毕返回的是一个promise对象，在then方法中我们可以拿到使用的模块对象
<span class="token number">3.</span> 重点关注data的配置部分，我们发现它需要一个严格的二维数组

</code></pre>
    <p>
     <strong>
      Excel导出参数说明
     </strong>
    </p>
    <table>
     <thead>
      <tr>
       <th>
        参数
       </th>
       <th>
        说明
       </th>
       <th>
        类型
       </th>
       <th>
        可选值
       </th>
       <th>
        默认值
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        header
       </td>
       <td>
        导出数据的表头
       </td>
       <td>
        Array
       </td>
       <td>
        /
       </td>
       <td>
        []
       </td>
      </tr>
      <tr>
       <td>
        data
       </td>
       <td>
        导出的具体数据
       </td>
       <td>
        Array
       </td>
       <td>
        /
       </td>
       <td>
        [[]]
       </td>
      </tr>
      <tr>
       <td>
        filename
       </td>
       <td>
        导出文件名
       </td>
       <td>
        String
       </td>
       <td>
        /
       </td>
       <td>
        excel-list
       </td>
      </tr>
      <tr>
       <td>
        autoWidth
       </td>
       <td>
        单元格是否要自适应宽度
       </td>
       <td>
        Boolean
       </td>
       <td>
        true / false
       </td>
       <td>
        true
       </td>
      </tr>
      <tr>
       <td>
        bookType
       </td>
       <td>
        导出文件类型
       </td>
       <td>
        String
       </td>
       <td>
        xlsx, csv, txt,
        <a href="https://github.com/SheetJS/js-xlsx#supported-output-formats">
         more
        </a>
       </td>
       <td>
        xlsx
       </td>
      </tr>
     </tbody>
    </table>
    <p>
     <strong>
      真实数据实现导出功能
     </strong>
    </p>
    <ul>
     <li>
      思路
     </li>
    </ul>
    <blockquote>
     <ol>
      <li>
       从后台重新获取数据（这样才能确保是最新的）
      </li>
      <li>
       对数据的格式进行转换（后端给的数据字段名都是英文的），以用来做导出
      </li>
     </ol>
    </blockquote>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/57b8c569d438dc6fe4655367558b24c6.png"/>
    </p>
    <ul>
     <li>
      <pre><code>  核心在于把后端接口返回的数据转成Export2Excel这个插件需要的格式 
</code></pre>
     </li>
    </ul>
    <p>
     <strong>
      4. 准备表头header数据
     </strong>
    </p>
    <blockquote>
     <p>
      因为接口中返回的数据中的key是英文，而我们期望导出的表头是中文，所以提前准备中文和英文的映射关系
     </p>
    </blockquote>
    <pre><code class="prism language-js"><span class="token keyword">const</span> map <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
  <span class="token string">'id'</span><span class="token punctuation">:</span> <span class="token string">'编号'</span><span class="token punctuation">,</span>
  <span class="token string">'password'</span><span class="token punctuation">:</span> <span class="token string">'密码'</span><span class="token punctuation">,</span>
  <span class="token string">'mobile'</span><span class="token punctuation">:</span> <span class="token string">'手机号'</span><span class="token punctuation">,</span>
  <span class="token string">'username'</span><span class="token punctuation">:</span> <span class="token string">'姓名'</span><span class="token punctuation">,</span>
  <span class="token string">'timeOfEntry'</span><span class="token punctuation">:</span> <span class="token string">'入职日期'</span><span class="token punctuation">,</span>
  <span class="token string">'formOfEmployment'</span><span class="token punctuation">:</span> <span class="token string">'聘用形式'</span><span class="token punctuation">,</span>
  <span class="token string">'correctionTime'</span><span class="token punctuation">:</span> <span class="token string">'转正日期'</span><span class="token punctuation">,</span>
  <span class="token string">'workNumber'</span><span class="token punctuation">:</span> <span class="token string">'工号'</span><span class="token punctuation">,</span>
  <span class="token string">'departmentName'</span><span class="token punctuation">:</span> <span class="token string">'部门'</span><span class="token punctuation">,</span>
  <span class="token string">'staffPhoto'</span><span class="token punctuation">:</span> <span class="token string">'头像地址'</span>
<span class="token punctuation">}</span>
</code></pre>
    <pre><code>具体的表格数据我们需要通过接口从后端获取回来，难点在于如何把后端返回的数据处理成Export2Excel插件需求的二维数组格式。
</code></pre>
    <p>
     下面是一个示例：
    </p>
    <pre><code class="prism language-js"><span class="token keyword">const</span> dataArr <span class="token operator">=</span> 
<span class="token punctuation">[</span>
 <span class="token punctuation">[</span><span class="token string">"13600000001"</span><span class="token punctuation">,</span> <span class="token string">"吕勇锐"</span><span class="token punctuation">,</span> <span class="token string">"1992-08-04"</span><span class="token punctuation">,</span> <span class="token string">"正式"</span><span class="token punctuation">,</span> <span class="token string">"2020-01-01"</span><span class="token punctuation">,</span> <span class="token string">"0001"</span><span class="token punctuation">,</span> <span class="token string">"总裁办"</span><span class="token punctuation">]</span>
 <span class="token punctuation">[</span><span class="token string">"13600000002"</span><span class="token punctuation">,</span> <span class="token string">"袁永安"</span><span class="token punctuation">,</span> <span class="token string">"1993-08-04"</span><span class="token punctuation">,</span> <span class="token string">"正式"</span><span class="token punctuation">,</span> <span class="token string">"2020-01-01"</span><span class="token punctuation">,</span> <span class="token string">"0002"</span><span class="token punctuation">,</span> <span class="token string">"总裁办"</span><span class="token punctuation">]</span>
<span class="token punctuation">]</span>
</code></pre>
    <p>
     <strong>
      5. 补充一个用来处理数据的函数
     </strong>
    </p>
    <pre><code class="prism language-js"><span class="token function">transData</span><span class="token punctuation">(</span>rows<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token comment">// 写代码</span>
      <span class="token keyword">const</span> map <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
        <span class="token string">'id'</span><span class="token punctuation">:</span> <span class="token string">'编号'</span><span class="token punctuation">,</span>
        <span class="token string">'password'</span><span class="token punctuation">:</span> <span class="token string">'密码'</span><span class="token punctuation">,</span>
        <span class="token string">'mobile'</span><span class="token punctuation">:</span> <span class="token string">'手机号'</span><span class="token punctuation">,</span>
        <span class="token string">'username'</span><span class="token punctuation">:</span> <span class="token string">'姓名'</span><span class="token punctuation">,</span>
        <span class="token string">'timeOfEntry'</span><span class="token punctuation">:</span> <span class="token string">'入职日期'</span><span class="token punctuation">,</span>
        <span class="token string">'formOfEmployment'</span><span class="token punctuation">:</span> <span class="token string">'聘用形式'</span><span class="token punctuation">,</span>
        <span class="token string">'correctionTime'</span><span class="token punctuation">:</span> <span class="token string">'转正日期'</span><span class="token punctuation">,</span>
        <span class="token string">'workNumber'</span><span class="token punctuation">:</span> <span class="token string">'工号'</span><span class="token punctuation">,</span>
        <span class="token string">'departmentName'</span><span class="token punctuation">:</span> <span class="token string">'部门'</span><span class="token punctuation">,</span>
        <span class="token string">'staffPhoto'</span><span class="token punctuation">:</span> <span class="token string">'头像地址'</span>
      <span class="token punctuation">}</span>

      <span class="token comment">// 写代码</span>
      <span class="token comment">// header =&gt; ['id', '手机号', '用户名', ... ]</span>
      <span class="token comment">// data =&gt; [</span>
      <span class="token comment">//   ["604f764971f93f3ac8f365c2", "13800000002", "管理员",.... ]</span>
      <span class="token comment">// ]</span>
      <span class="token keyword">const</span> enKeys <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>rows<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
      <span class="token keyword">const</span> header <span class="token operator">=</span> enKeys<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>enKey <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> map<span class="token punctuation">[</span>enKey<span class="token punctuation">]</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
      
      <span class="token keyword">const</span> data <span class="token operator">=</span> rows<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>obj <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> Object<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>

      <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span> header<span class="token punctuation">,</span> data <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre>
    <p>
     <strong>
      最终的代码
     </strong>
    </p>
    <pre><code class="prism language-js"><span class="token comment">// 导出excel</span>
    <span class="token keyword">async</span> <span class="token function">hExportExcel</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token comment">// 1. 获取数据</span>
      <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getEmployeeList</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>pageParams<span class="token punctuation">)</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'有效数据:'</span><span class="token punctuation">,</span> res<span class="token punctuation">.</span>data<span class="token punctuation">.</span>rows<span class="token punctuation">)</span>
      <span class="token comment">// 2. 处理数据</span>
      <span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">transData</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>data<span class="token punctuation">.</span>rows<span class="token punctuation">)</span>
      <span class="token comment">// 3. 导出</span>
      <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'@/vendor/Export2Excel'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>excel <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        excel<span class="token punctuation">.</span><span class="token function">export_json_to_excel</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
          header<span class="token punctuation">:</span> obj<span class="token punctuation">.</span>header<span class="token punctuation">,</span> <span class="token comment">// ['姓名', '工资'], // 表头 必填</span>
          data<span class="token punctuation">:</span> obj<span class="token punctuation">.</span>data<span class="token punctuation">,</span> <span class="token comment">// [</span>
          <span class="token comment">//   ['刘备', 800],</span>
          <span class="token comment">//   ['关羽', 500]</span>
          <span class="token comment">// ], // 具体数据 必填</span>
          filename<span class="token punctuation">:</span> <span class="token string">'employee-list'</span><span class="token punctuation">,</span> <span class="token comment">// 文件名称</span>
          autoWidth<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 宽度是否自适应</span>
          bookType<span class="token punctuation">:</span> <span class="token string">'xlsx'</span> <span class="token comment">// 生成的文件类型</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">transData</span><span class="token punctuation">(</span>rows<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token comment">// 写代码</span>
      <span class="token keyword">const</span> map <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
        <span class="token string">'id'</span><span class="token punctuation">:</span> <span class="token string">'编号'</span><span class="token punctuation">,</span>
        <span class="token string">'password'</span><span class="token punctuation">:</span> <span class="token string">'密码'</span><span class="token punctuation">,</span>
        <span class="token string">'mobile'</span><span class="token punctuation">:</span> <span class="token string">'手机号'</span><span class="token punctuation">,</span>
        <span class="token string">'username'</span><span class="token punctuation">:</span> <span class="token string">'姓名'</span><span class="token punctuation">,</span>
        <span class="token string">'timeOfEntry'</span><span class="token punctuation">:</span> <span class="token string">'入职日期'</span><span class="token punctuation">,</span>
        <span class="token string">'formOfEmployment'</span><span class="token punctuation">:</span> <span class="token string">'聘用形式'</span><span class="token punctuation">,</span>
        <span class="token string">'correctionTime'</span><span class="token punctuation">:</span> <span class="token string">'转正日期'</span><span class="token punctuation">,</span>
        <span class="token string">'workNumber'</span><span class="token punctuation">:</span> <span class="token string">'工号'</span><span class="token punctuation">,</span>
        <span class="token string">'departmentName'</span><span class="token punctuation">:</span> <span class="token string">'部门'</span><span class="token punctuation">,</span>
        <span class="token string">'staffPhoto'</span><span class="token punctuation">:</span> <span class="token string">'头像地址'</span>
      <span class="token punctuation">}</span>

      <span class="token comment">// 写代码</span>
      <span class="token comment">// header =&gt; ['id', '手机号', '用户名', ... ]</span>
      <span class="token comment">// data =&gt; [</span>
      <span class="token comment">//   ["604f764971f93f3ac8f365c2", "13800000002", "管理员",.... ]</span>
      <span class="token comment">// ]</span>
      <span class="token keyword">const</span> enKeys <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>rows<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
      <span class="token keyword">const</span> header <span class="token operator">=</span> enKeys<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>enKey <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> map<span class="token punctuation">[</span>enKey<span class="token punctuation">]</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token keyword">const</span> data <span class="token operator">=</span> rows<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>obj <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> Object<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>

      <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span> header<span class="token punctuation">,</span> data <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f672e:6373646e2e6e65742f77656978696e5f35333733343433362f:61727469636c652f64657461696c732f313137313730383432" class_="artid" style="display:none">
 </p>
</div>


