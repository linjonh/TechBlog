---
layout: post
title: "解密某游戏的数据加密"
date: 2024-06-17 23:12:57 +0800
description: "最近有个兄弟通过我的视频号加我，咨询能否将这个dubo游戏游戏开始前就将数据拿到从而进行押注，于是通"
keywords: "游戏文件解密"
categories: ['笔记', '爬虫专栏', 'Python']
tags: ['解密', '爬虫', '游戏', 'Python']
artid: "138528281"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=138528281
    alt: "解密某游戏的数据加密"
render_with_liquid: false
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     解密某游戏的数据加密
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-kimbie-light" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h2>
     <a id="_0">
     </a>
     前言
    </h2>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/53798c8d8c928f2d26d3c3efd9af4abb.png"/>
    </p>
    <p>
     最近有个兄弟通过我的视频号加我，咨询能否将这个dubo游戏游戏开始前就将数据拿到从而进行押注，于是通过抓包工具测试了下，发现数据有时候是明文，有时候确实密文，大致看了下有这几种加密：Md5aes、Md5，参数加密用md5，数据返回加密用Md5aes，本次记录一下分析过程。
    </p>
    <h2>
     <a id="_5">
     </a>
     登录
    </h2>
    <p>
     通过抓包分析数据，发现数据返回采用Md5aes
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/f24c4fd155fcf0209c90e9b711cbe3c5.png">
      <br/>
      请求参数用了某种加密
      <br/>
      <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/9b5ce19e449a6c472b0ae00bd1f5cb6a.png"/>
     </img>
    </p>
    <h2>
     <a id="_10">
     </a>
     分析
    </h2>
    <p>
     我们通过上面的抓包知道，密码肯定是用了一种加密方式，但具体是啥，还不清楚，我们通过打断点的形式顺藤摸瓜
    </p>
    <p>
     通过观察启动资源，锁定一个index.js
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/95ac55bd1878570341a1878820f2d981.png">
      <br/>
      点击进去，观察发现有表单提交的数据
      <br/>
      <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/8225653c7c5e07771da8c7b17bceef06.png">
       <br/>
       继续往下搜索md5()方法
      </img>
     </img>
    </p>
    <pre><code class="prism language-clike"> t<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>get_md5 <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
 <span class="token keyword">return</span> this<span class="token punctuation">.</span><span class="token function">md5</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span>
 <span class="token punctuation">}</span>
</code></pre>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/d0bfb5b70e7960cc95555b45de003089.png">
      <br/>
      继续搜索md5()方法
     </img>
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/fa98798307fd377a17b83de2a4f96253.png"/>
    </p>
    <blockquote>
     <p>
      cc._RF.push(e, “121674IswNGu77LvNvHfpBi”, “md5”)
     </p>
    </blockquote>
    <p>
     cc._RF.push 和 cc._RF.pop 是 Cocos Creator 引擎用于跟踪脚本加载顺序和依赖关系的工具函数。这些函数在加载脚本时自动生成，用于维护加载堆栈。
    </p>
    <p>
     我们通过对该方法进行数据修改，再次运行观察结果
    </p>
    <h2>
     <a id="_37">
     </a>
     修改
    </h2>
    <p>
     再md5方法下新增代码
    </p>
    <pre><code class="prism language-clike">t<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>md5 <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                var e <span class="token operator">=</span> this<span class="token punctuation">;</span>
                 <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'我被执行了'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">;</span>
                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
                t <span class="token operator">=</span> this<span class="token punctuation">.</span><span class="token function">utf16_to_utf8</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">;</span>
                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'新的密码'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span>var o <span class="token operator">=</span> this<span class="token punctuation">.</span><span class="token function">porcess_message</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">,</span> n <span class="token operator">=</span> Uint32Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token punctuation">[</span>this<span class="token punctuation">.</span>A<span class="token punctuation">,</span> this<span class="token punctuation">.</span>B<span class="token punctuation">,</span> this<span class="token punctuation">.</span>C<span class="token punctuation">,</span> this<span class="token punctuation">.</span>D<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> a <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> i <span class="token operator">=</span> this<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span>Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>o<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span> a <span class="token operator">&lt;</span> i<span class="token punctuation">.</span>length<span class="token punctuation">;</span> a<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">for</span> <span class="token punctuation">(</span>var r <span class="token operator">=</span> i<span class="token punctuation">[</span>a<span class="token punctuation">]</span><span class="token punctuation">,</span> s <span class="token operator">=</span> n<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> c <span class="token operator">=</span> n<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> l <span class="token operator">=</span> n<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> h <span class="token operator">=</span> n<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> u <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> u <span class="token operator">&lt;</span> <span class="token number">64</span><span class="token punctuation">;</span> u<span class="token operator">++</span><span class="token punctuation">)</span>
                        n<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token number">4</span> <span class="token operator">-</span> u <span class="token operator">%</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> this<span class="token punctuation">.</span><span class="token function">fghi_wrapped</span><span class="token punctuation">(</span>u<span class="token punctuation">)</span><span class="token punctuation">(</span>n<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token number">4</span> <span class="token operator">-</span> u <span class="token operator">%</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> n<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token number">4</span> <span class="token operator">-</span> u <span class="token operator">%</span> <span class="token number">4</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> n<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token number">4</span> <span class="token operator">-</span> u <span class="token operator">%</span> <span class="token number">4</span> <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> n<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token number">4</span> <span class="token operator">-</span> u <span class="token operator">%</span> <span class="token number">4</span> <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> r<span class="token punctuation">[</span>this<span class="token punctuation">.</span><span class="token function">x_index</span><span class="token punctuation">(</span>u<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> this<span class="token punctuation">.</span>S<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">,</span> this<span class="token punctuation">.</span><span class="token function">T</span><span class="token punctuation">(</span>u<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    n<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> s <span class="token operator">+</span> n<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                    n<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> c <span class="token operator">+</span> n<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                    n<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> l <span class="token operator">+</span> n<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                    n<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> h <span class="token operator">+</span> n<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">return</span> Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">return</span> e<span class="token punctuation">.</span><span class="token function">little_endian</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
</code></pre>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/ec9c64920f63c30503eea965583720c3.png"/>
    </p>
    <p>
     保存后刷新重新登陆
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/914132d8adaba21d741fce04d50c8879.png">
      <br/>
      可以看到，密码的确是传递过来了
      <br/>
      <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/bca8cb6430cfbce740efc1329ab34cbc.png"/>
     </img>
    </p>
    <h2>
     <a id="_71">
     </a>
     猜测
    </h2>
    <p>
     可能是md5加密
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/1280dc786c27036d0e087550063d98f9.png">
      <br/>
      <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/4d83d8dda81756f663d983c12eec6f0f.png"/>
      <br/>
      发现数据值一样，请求登录只需要将密码进行md5加密即可
     </img>
    </p>
    <pre><code class="prism language-clike">import requests
import hashlib
headers <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">'Accept'</span><span class="token punctuation">:</span> <span class="token string">'*/*'</span><span class="token punctuation">,</span>
    <span class="token string">'Accept-Language'</span><span class="token punctuation">:</span> <span class="token string">'zh,zh-CN;q=0.9'</span><span class="token punctuation">,</span>
    <span class="token string">'Authorization'</span><span class="token punctuation">:</span> <span class="token string">'undefined'</span><span class="token punctuation">,</span>
    <span class="token string">'Cache-Control'</span><span class="token punctuation">:</span> <span class="token string">'no-cache'</span><span class="token punctuation">,</span>
    <span class="token string">'Connection'</span><span class="token punctuation">:</span> <span class="token string">'keep-alive'</span><span class="token punctuation">,</span>
    <span class="token string">'Pragma'</span><span class="token punctuation">:</span> <span class="token string">'no-cache'</span><span class="token punctuation">,</span>
    <span class="token string">'Referer'</span><span class="token punctuation">:</span> <span class="token string">'http://js88.mrlj.cn/js1/'</span><span class="token punctuation">,</span>
    <span class="token string">'User-Agent'</span><span class="token punctuation">:</span> <span class="token string">'Mozilla/5.0 (Linux; Android 6.0; Nexus 5 Build/MRA58N) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/123.0.0.0 Mobile Safari/537.36'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

text1<span class="token operator">=</span><span class="token string">'123456'</span>
<span class="token function">print</span><span class="token punctuation">(</span>text1<span class="token punctuation">)</span>
md<span class="token operator">=</span>hashlib<span class="token punctuation">.</span><span class="token function">md5</span><span class="token punctuation">(</span>text1<span class="token punctuation">.</span><span class="token function">encode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> # 创建md5对象
md5pwd<span class="token operator">=</span>md<span class="token punctuation">.</span><span class="token function">hexdigest</span><span class="token punctuation">(</span><span class="token punctuation">)</span> # md5加密
<span class="token function">print</span><span class="token punctuation">(</span>md5pwd<span class="token punctuation">)</span>

params <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">'loginId'</span><span class="token punctuation">:</span> <span class="token string">'241837'</span><span class="token punctuation">,</span>
    <span class="token string">'loginPwd'</span><span class="token punctuation">:</span> md5pwd<span class="token punctuation">,</span>
<span class="token punctuation">}</span>

response <span class="token operator">=</span> requests<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'http://js88.mrlj.cn/qw/user/weixin/loginByPwd'</span><span class="token punctuation">,</span> params<span class="token operator">=</span>params<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">,</span> verify<span class="token operator">=</span>False<span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
    <p>
     响应
    </p>
    <blockquote>
     <p>
      123456
      <br/>
      e10adc3949ba59abbe56e057f20f883e
      <br/>
      {‘code’: 200, ‘msg’: ‘正常’, ‘data’: ‘md5AES:w3cqakJcff674yZSTLRgOck0lJ4SiaKjhO9Greq3hOdp+irWmG9nB/tPuvl1BYA2f6tHCIlxVRhippuJn/FVcVOrGk88zoscA9tbnx+mPIC2ynMt8KnPWKGQYKIJekukfktcGOg0JR29GkR6NktoboqIDaVIHMpCcain3bd9Ly/enE03bI5BuM9a+Kn86DXbbdSmUyNCWC0WNNi3Onn/KtJ3W6Tb8r/ujfragdTPPbpuvItSCXIB9kpQDlkSNSINsqTF8VaM8VBOQ2YKnv43ORmypGwPjeZrm+j4BmIhSM2xr+hlf0sJp1k1xtu4XUz4AGypWdESGOHbCGfgSFxpGs34UUxkAN2Dg+U/Y3Nv8hjQnt0UceSb2rfsHhWG3uCPqTnFFI0mV64QSQeyOsPEca80zjUEREXpcnPfR7lSQGdn5yoemu7rXWdsDszdHalIi774B38hY/1Cc+9uHjxvvaRP0+G9OUHgOPV2pwgS7nvlDekFH0E+PFHTZSg5UEm09tluDZeowxShc/MYcoGljdLrfT24Vr755gGHs2PgE8UXRglOQJqAsWazyQZJqz6/hULG40kAT3/PkLzREVMIt3yyGERj2RDzcPk+bJK5d12cWjUf6/c1tFfhJeBx+nKzyP+rFIi6JsaNUKObMwgNC1LiwEY0W3+suXQLcR5FbMa6CURmVzPwIxB4LslDD0OEPqnHHowvVE9ZyhE6ts5Am1KTcvKY7rY8MrAcXO30nHbfupwH5rjrrrf2MdpKcA2PUPnITj7V6TVCmqX24wdTB5pcrZVshvv1cV8zOll54S2tOJrC2GjRKRl1clXvVhokU2Ys22NKMDB5OxUP2ajJea6d98owyPlnpH4MVzxeVnewcK8/ed35YrT8f4nn2TFqe0zsQqqsiC9noScvr/uZV/vxBHYi45LRIjaAzTUhBc8l9IlfknJQnUvnmE2kzNBW’, ‘ok’: True}
     </p>
    </blockquote>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/14a4d7486343b6f875998bca76c00bef.png"/>
    </p>
    <h2>
     <a id="_116">
     </a>
     解密
    </h2>
    <pre><code class="prism language-clike">  <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'iv-======='</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">function</span> <span class="token function">t</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                this<span class="token punctuation">.</span>aes_key <span class="token operator">=</span> <span class="token string">"2c4add8f849a7bea"</span><span class="token punctuation">,</span>
                this<span class="token punctuation">.</span>aes_iv <span class="token operator">=</span> <span class="token string">"dc4b73b33e69eaff"</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">return</span> t<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>encrypt <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'iv2-======='</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                var e <span class="token operator">=</span> CryptoJS<span class="token punctuation">.</span>enc<span class="token punctuation">.</span>Utf8<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>this<span class="token punctuation">.</span>aes_key<span class="token punctuation">)</span>
                  <span class="token punctuation">,</span> o <span class="token operator">=</span> CryptoJS<span class="token punctuation">.</span>enc<span class="token punctuation">.</span>Utf8<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>this<span class="token punctuation">.</span>aes_iv<span class="token punctuation">)</span>
                  <span class="token punctuation">,</span> n <span class="token operator">=</span> CryptoJS<span class="token punctuation">.</span>AES<span class="token punctuation">.</span><span class="token function">encrypt</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> e<span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span>
                    iv<span class="token punctuation">:</span> o<span class="token punctuation">,</span>
                    mode<span class="token punctuation">:</span> CryptoJS<span class="token punctuation">.</span>mode<span class="token punctuation">.</span>CBC<span class="token punctuation">,</span>
                    padding<span class="token punctuation">:</span> CryptoJS<span class="token punctuation">.</span>pad<span class="token punctuation">.</span>Pkcs7
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span> CryptoJS<span class="token punctuation">.</span>format<span class="token punctuation">.</span>OpenSSL<span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
            <span class="token punctuation">,</span>
            t<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>decrypt <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                var e <span class="token operator">=</span> <span class="token punctuation">(</span>t <span class="token operator">=</span> CryptoJS<span class="token punctuation">.</span>format<span class="token punctuation">.</span>OpenSSL<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>ciphertext<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                  <span class="token punctuation">,</span> o <span class="token operator">=</span> CryptoJS<span class="token punctuation">.</span>enc<span class="token punctuation">.</span>Hex<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
                  <span class="token punctuation">,</span> n <span class="token operator">=</span> CryptoJS<span class="token punctuation">.</span>enc<span class="token punctuation">.</span>Base64<span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>o<span class="token punctuation">)</span>
                  <span class="token punctuation">,</span> a <span class="token operator">=</span> CryptoJS<span class="token punctuation">.</span>enc<span class="token punctuation">.</span>Utf8<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>this<span class="token punctuation">.</span>aes_key<span class="token punctuation">)</span>
                  <span class="token punctuation">,</span> i <span class="token operator">=</span> CryptoJS<span class="token punctuation">.</span>enc<span class="token punctuation">.</span>Utf8<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>this<span class="token punctuation">.</span>aes_iv<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span> CryptoJS<span class="token punctuation">.</span>AES<span class="token punctuation">.</span><span class="token function">decrypt</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> a<span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span>
                    iv<span class="token punctuation">:</span> i<span class="token punctuation">,</span>
                    mode<span class="token punctuation">:</span> CryptoJS<span class="token punctuation">.</span>mode<span class="token punctuation">.</span>CBC<span class="token punctuation">,</span>
                    padding<span class="token punctuation">:</span> CryptoJS<span class="token punctuation">.</span>pad<span class="token punctuation">.</span>Pkcs7
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span>CryptoJS<span class="token punctuation">.</span>enc<span class="token punctuation">.</span>Utf8<span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
            <span class="token punctuation">,</span>
            <span class="token function">n</span><span class="token punctuation">(</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> t<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
    <p>
     这段代码是一个 JavaScript 函数，它定义了一个名为 t 的构造函数，并将其实例化后作为匿名函数的返回值。在构造函数 t 中，有两个属性 aes_key 和 aes_iv，它们存储了AES加密算法所需的密钥和初始化向量。
    </p>
    <p>
     函数中定义了两个方法 encrypt 和 decrypt，用于加密和解密操作。
    </p>
    <blockquote>
     <p>
      在 encrypt 方法中，首先将密钥和初始化向量转换为 UTF-8 格式，然后使用 CryptoJS 库中的 AES 加密函数对传入的参数
      <br/>
      t 进行加密。加密过程中指定了加密模式为 CBC（Cipher Block Chaining），并使用 PKCS7 填充方式。最后，使用
      <br/>
      OpenSSL 格式将加密结果转换为字符串并返回。
     </p>
    </blockquote>
    <blockquote>
     <p>
      在 decrypt 方法中，首先将传入的密文解析为 OpenSSL 格式，然后将其转换为十六进制格式，并再次转换为 Base64
      <br/>
      字符串。接着，将密钥和初始化向量转换为 UTF-8 格式，使用 CryptoJS 库中的 AES
      <br/>
      解密函数对密文进行解密，解密模式和填充方式与加密时相同。最终将解密结果转换为 UTF-8 格式的字符串并返回。
     </p>
    </blockquote>
    <p>
     将js代码复制下来
    </p>
    <pre><code class="prism language-clike"><span class="token operator">&lt;</span><span class="token operator">!</span>DOCTYPE html<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>html lang<span class="token operator">=</span><span class="token string">"en"</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>head<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>meta charset<span class="token operator">=</span><span class="token string">"UTF-8"</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>meta name<span class="token operator">=</span><span class="token string">"viewport"</span> content<span class="token operator">=</span><span class="token string">"width=device-width, initial-scale=1.0"</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>title<span class="token operator">&gt;</span>Encryption<span class="token operator">/</span>Decryption Example<span class="token operator">&lt;</span><span class="token operator">/</span>title<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">"https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>head<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>body<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
        <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            

            <span class="token keyword">function</span> <span class="token function">t</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                this<span class="token punctuation">.</span>aes_key <span class="token operator">=</span> <span class="token string">"2c4add8f849a7bea"</span><span class="token punctuation">;</span>
                this<span class="token punctuation">.</span>aes_iv <span class="token operator">=</span> <span class="token string">"dc4b73b33e69eaff"</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            t<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>encrypt <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                
                
                var e <span class="token operator">=</span> CryptoJS<span class="token punctuation">.</span>enc<span class="token punctuation">.</span>Utf8<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>this<span class="token punctuation">.</span>aes_key<span class="token punctuation">)</span><span class="token punctuation">,</span>
                    o <span class="token operator">=</span> CryptoJS<span class="token punctuation">.</span>enc<span class="token punctuation">.</span>Utf8<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>this<span class="token punctuation">.</span>aes_iv<span class="token punctuation">)</span><span class="token punctuation">,</span>
                    n <span class="token operator">=</span> CryptoJS<span class="token punctuation">.</span>AES<span class="token punctuation">.</span><span class="token function">encrypt</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> e<span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span>
                        iv<span class="token punctuation">:</span> o<span class="token punctuation">,</span>
                        mode<span class="token punctuation">:</span> CryptoJS<span class="token punctuation">.</span>mode<span class="token punctuation">.</span>CBC<span class="token punctuation">,</span>
                        padding<span class="token punctuation">:</span> CryptoJS<span class="token punctuation">.</span>pad<span class="token punctuation">.</span>Pkcs7
                    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span> CryptoJS<span class="token punctuation">.</span>format<span class="token punctuation">.</span>OpenSSL<span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">;</span>

            t<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>decrypt <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                var e <span class="token operator">=</span> <span class="token punctuation">(</span>t <span class="token operator">=</span> CryptoJS<span class="token punctuation">.</span>format<span class="token punctuation">.</span>OpenSSL<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>ciphertext<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    o <span class="token operator">=</span> CryptoJS<span class="token punctuation">.</span>enc<span class="token punctuation">.</span>Hex<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">,</span>
                    n <span class="token operator">=</span> CryptoJS<span class="token punctuation">.</span>enc<span class="token punctuation">.</span>Base64<span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>o<span class="token punctuation">)</span><span class="token punctuation">,</span>
                    a <span class="token operator">=</span> CryptoJS<span class="token punctuation">.</span>enc<span class="token punctuation">.</span>Utf8<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>this<span class="token punctuation">.</span>aes_key<span class="token punctuation">)</span><span class="token punctuation">,</span>
                    i <span class="token operator">=</span> CryptoJS<span class="token punctuation">.</span>enc<span class="token punctuation">.</span>Utf8<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>this<span class="token punctuation">.</span>aes_iv<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span> CryptoJS<span class="token punctuation">.</span>AES<span class="token punctuation">.</span><span class="token function">decrypt</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> a<span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span>
                    iv<span class="token punctuation">:</span> i<span class="token punctuation">,</span>
                    mode<span class="token punctuation">:</span> CryptoJS<span class="token punctuation">.</span>mode<span class="token punctuation">.</span>CBC<span class="token punctuation">,</span>
                    padding<span class="token punctuation">:</span> CryptoJS<span class="token punctuation">.</span>pad<span class="token punctuation">.</span>Pkcs7
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span>CryptoJS<span class="token punctuation">.</span>enc<span class="token punctuation">.</span>Utf8<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">;</span>

            <span class="token comment">// 示例使用</span>
            var cipher <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">t</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            var plaintext <span class="token operator">=</span> <span class="token string">"{code:200,data}"</span><span class="token punctuation">;</span>
            var encrypted_text <span class="token operator">=</span> cipher<span class="token punctuation">.</span><span class="token function">encrypt</span><span class="token punctuation">(</span>plaintext<span class="token punctuation">)</span><span class="token punctuation">;</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Encrypted:"</span><span class="token punctuation">,</span> encrypted_text<span class="token punctuation">)</span><span class="token punctuation">;</span>

            var decrypted_text <span class="token operator">=</span> cipher<span class="token punctuation">.</span><span class="token function">decrypt</span><span class="token punctuation">(</span>encrypted_text<span class="token punctuation">)</span><span class="token punctuation">;</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Decrypted:"</span><span class="token punctuation">,</span> decrypted_text<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>body<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>html<span class="token operator">&gt;</span>

</code></pre>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/5abeeb5c46cac34f6ceaf02fb4c1157e.png"/>
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
  <div class="blog-extension-box" id="blogExtensionBox" style="width:400px;margin:auto;margin-top:12px">
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f71715f33353233303132352f:61727469636c652f64657461696c732f313338353238323831" class_="artid" style="display:none">
 </p>
</div>


