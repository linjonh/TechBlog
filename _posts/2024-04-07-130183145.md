---
title: 2024-04-07-音视频八股文1--音视频基础
date: 2024-04-07 15:24:14 +0800
categories: ['音视频Golang相关']
tags: ['流媒体', '音视频']
image:
  path: https://api.vvhan.com/api/bing?rand=sj&artid=130183145
  alt: 音视频八股文1--音视频基础
artid: 130183145
render_with_liquid: false
---
</p>
<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     音视频八股文（1）--音视频基础
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-light" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h2>
     <a id="11_0">
     </a>
     1.1.音视频录制原理
    </h2>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/174c97923096c07a61b34235db2899a3.png"/>
    </p>
    <h2>
     <a id="12_2">
     </a>
     1.2.音视频播放原理
    </h2>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/901d069132d9416b40604dcfe9b026e2.png"/>
    </p>
    <h2>
     <a id="13RGBYUV_4">
     </a>
     1.3.图像表示RGB-YUV
    </h2>
    <h3>
     <a id="131__5">
     </a>
     1.3.1 图像基础概念
    </h3>
    <p>
     ◼ 像素：像素是一个图片的基本单位，pix是英语单词picture的简写，加上英
     <br/>
     语单词“元素element”，就得到了“pixel”，简称px，所以“像素”有“图像元素”
     <br/>
     之意。
     <br/>
     ◼ 分辨率：是指图像的大小或尺寸。比如1920x1080。
     <br/>
     ◼ 位深：是指在记录数字图像的颜色时，计算机实际上是用每个像素需要的
     <br/>
     位深来表示的。比如红色分量用8bit。
     <br/>
     ◼ 帧率：在1秒钟时间里传输的图片的帧数，也可以理解为图形处理器每秒钟
     <br/>
     能够刷新几次。比如25fps表示一秒有25张图片。
     <br/>
     ◼ 码率：视频文件在单位时间内使用的数据流量。比如1Mbps。
     <br/>
     ◼ Stride：指在内存中每行像素所占的空间。为了实现内存对齐每行像素在
     <br/>
     内存中所占的空间并不一定是图像的宽度
    </p>
    <h4>
     <a id="1311__19">
     </a>
     1.3.1.1 像素
    </h4>
    <p>
     像素是一个图片的基本单位，pix是英语单词picture的简写，加上英语单词“元素element”，就得到了“pixel”，简称px，所以“像素”有“图像元素”之意。
     <br/>
     例如2500×2000的照片就是指横向有2500个像素点，竖向有2000个像素点，总共是500万个像素，也俗称500万像素照片。
    </p>
    <h4>
     <a id="1312__24">
     </a>
     1.3.1.2 分辨率
    </h4>
    <p>
     图像（或视频）的分辨率是指图像的大小或尺寸。我们通常用像素表示图像的尺寸。
     <br/>
     例如2500×2000的照片就是指横向(宽)有2500个像素点，竖向(高)有2000个像素点。
     <br/>
     常见的分辨率：
     <br/>
     360P(640x360)、720P(1280x720)、1080P(1920x1080)、4K(3840x2160)、8K(7680x4320)
    </p>
    <h4>
     <a id="1312__30">
     </a>
     1.3.1.2 分辨率-不同分辨率之间的区别
    </h4>
    <p>
     常说的 1080 和 720 其实是指垂直像素数，分辨率除去垂直像素，还需要考虑到水平像
     <br/>
     素数。按照 16:9 (宽 : 高) 的比例计算，720p 的水平像素数为 720 ÷ 9 × 16 = 1280，总
     <br/>
     计像素为921600像素即大约为 92 万像素。1080p 具有 1920 个水平像素，总计2073600
     <br/>
     像素即约 200 万像素，是 720p 的两倍多。
     <br/>
     像素越多视频就越清晰，所以 1080p 比 720p 的视频更加清晰。图像的分辨率越高，图像就越清晰。
    </p>
    <h4>
     <a id="1313__38">
     </a>
     1.3.1.3 位深
    </h4>
    <p>
     我们看到的彩色图片，都有三个通道，分别为红®、绿(G)、蓝(B)通道。（如果需
     <br/>
     要透明度则还有alpha分量）
     <br/>
     通常每个通道用8bit表示，8bit能表示256种颜色，所以可以组成
     <br/>
     256
     <em>
      256
     </em>
     256=16,777,216 = 1677万种颜色。
     <br/>
     这里的8bit就是我们讲的位深。
     <br/>
     每个通道的位深越大，能够表示的颜色值就越大，比如现在高端电视说的10bit色
     <br/>
     彩，即是每个通道用10bit表示，每个通道有1024种颜色。1024
     <em>
      1024
     </em>
     1024约为
     <br/>
     10,7374万色=10亿色， 是8bit的64倍。
     <br/>
     常见的颜色还是8bit居多。
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/0d0a78ce6ba148de39c78a7037aa7976.png"/>
    </p>
    <h4>
     <a id="1314__53">
     </a>
     1.3.1.4 帧率
    </h4>
    <p>
     帧率即 FPS（每秒有多少帧画面），经常玩游戏的同学应该会对这个词很熟悉。我们玩游
     <br/>
     戏时，FPS 帧率越高就代表游戏画面越流畅，越低则越卡顿。视频也是如此。
     <br/>
     由于视觉图像在视网膜的暂时停留，一般图像帧率能达到24帧，我们就认为图像是连续
     <br/>
     动态的。
     <br/>
     电影帧率一般是 24fps（帧每秒）；
     <br/>
     电视剧一般是25fps；
     <br/>
     监控行业常用 25fps；
     <br/>
     音视频通话常用15fps；
     <br/>
     帧率越高，画面越流畅，需要的设备性能也越高。
     <br/>
     播放 5帧、24帧视频对比。
    </p>
    <h4>
     <a id="1315__66">
     </a>
     1.3.1.5 码率
    </h4>
    <p>
     ◼ 视频文件在单位时间内使用的数据流量。比如1Mbps。
     <br/>
     ◼ 大多数情况下码率越高 分辨率越高，也就越清晰。但模糊的视频文件大小（码率）也可以很大，分辨率小的视频文件可能也比分辨率大的视频文件清晰。
     <br/>
     ◼ 对于同一个原始图像源的时候，同样的编码算法，则码率越高，图像的失真就会越小，视频画面就会越清晰
    </p>
    <p>
     对比不同码率的转码。
    </p>
    <h4>
     <a id="1316_Stride_74">
     </a>
     1.3.1.6 Stride跨距
    </h4>
    <p>
     ◼ Stride ：指在内存中每行像素所占的空间。为了实现内存对齐每行像素在内存中所占的空间并不一定是图像的宽度。
     <br/>
     ◼ Stride 就是这些扩展内容的名称，Stride 也被称作 Pitch，如果图像的每一行像素末尾拥有扩展内容，Stride 的值一定大于图像的宽度值，就像下图所示：
     <br/>
     ◼ 比如分辨率638x480的RGB24图像，我们在内存处理的时候如果要以16字节对齐，则638
     <em>
      3/16=119.625不能整除，因此不能16字节对齐，我们需要在每行尾部填充6
      <br/>
      个字节。就是(638+2-&gt;640), 640
     </em>
     3/16=120。此时该图片的stride为1920字节。
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/9715da776281d600d1d473e5bc39c32a.png"/>
    </p>
    <h3>
     <a id="132_RGBYUV_82">
     </a>
     1.3.2 RGB、YUV深入讲解
    </h3>
    <h4>
     <a id="1321_RGB_84">
     </a>
     1.3.2.1 RGB
    </h4>
    <p>
     ◼ 我们前面已经讲过RGB色彩表示，这里我们重点讲RGB的排列。通常的图像像素是按RGB顺序进行排列，但有些图像处理要转成其他顺序，比如OpenCV经常转成BGR的排列方式。
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/23de088d016ecfd9f68f6ee4b0e49e13.png"/>
    </p>
    <h4>
     <a id="1322_YUV_90">
     </a>
     1.3.2.2 YUV
    </h4>
    <p>
     ◼ 与我们熟知RGB类似，YUV也是一种颜色编码方法，它是指将亮度参量（Y：Luminance或Luma）和色度参量（UV：Chrominance或Chroma）分开进行表示的像素编码格式。
     <br/>
     ◼ 这样分开的好处就是不但可以避免相互干扰，没有UV信息一样可以显示完整的图像，
     <br/>
     因而解决了彩色电视与黑白电视的兼容问题；还可以降低色度的采样率而不会对图像质量影响太大，降低了视屏信号传输时对频宽（带宽）的要求。
     <br/>
     ◼ Y Y共用一组UV分量。
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/7f089010e9761acfe929452ee2bbe4d4.png"/>
    </p>
    <p>
     ◼ YUV是一个比较笼统地说法，针对它的具体排列方式，可以分为很多种具体的格式：
     <br/>
     ◼ 打包（packed）格式：将每个像素点的Y、U、V分量交叉排列并以像素点为单元连续的存放在同一数组中，通常几个相邻的像素组成一个宏像素（macro-pixel）
     <br/>
     ◼ 平面（planar）格式：使用三个数组分开连续的存放Y、U、V三个分量，即Y、U、V分别存放在各自的数组中。
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/187f7c6aae54ac4fa2cbe402e95778c9.png"/>
    </p>
    <h5>
     <a id="13221_YUV_102">
     </a>
     1.3.2.2.1 YUV采样表示法
    </h5>
    <p>
     ◼ YUV采用A:B:C表示法来描述Y,U,V采样频率比例，下图中黑点表示采样像素点Y分量，空心圆表示采样像素点的UV分量。主要分为 YUV 4:4:4、YUV 4:2:2、YUV 4:2:0 这几种常用的类型。
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/1fdf5fc2a908f711f5bdfbf3ecd2d5e9.png"/>
    </p>
    <h5>
     <a id="13222_YUV_107">
     </a>
     1.3.2.2.2 YUV数据存储
    </h5>
    <p>
     ◼ 下面以每个分量数据存储在一个char（或byte）中为例描述YUV的数据存储方式。
    </p>
    <ol>
     <li>
      4:4:4格式
     </li>
     <li>
      4:2:2格式
     </li>
     <li>
      4:2:0格式
     </li>
    </ol>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/4177d6a5521e5de0386994abcd845fcd.png"/>
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/8a3be53b8103d56071f6ab36cdaf28f2.png"/>
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/91bf8c5a1fadf771e14c1ec6d8208625.png"/>
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/167c0bf264408fd76b9f33ce77f8418a.png"/>
     <br/>
     YUV数据存储-4:2:0格式-参考
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/be0b67fd9a20954f0d158aef36cb6259.png"/>
    </p>
    <h4>
     <a id="1323_RGBYUV_121">
     </a>
     1.3.2.3 RGB和YUV的转换
    </h4>
    <p>
     ◼ 通常情况下RGB和YUV直接的相互转换都是调用接口实现，比如Ffmpeg的swscale或者
     <br/>
     libyuv等库。
     <br/>
     ◼ 主要转换标准是 BT601 和 BT709。
     <br/>
     YUV(256 级别) 可以从8位 RGB 直接计算：
     <br/>
     Y = 0.299
     <em>
      R + 0.587
     </em>
     G + 0.114
     <em>
      B;
      <br/>
      U = -0.169
     </em>
     R - 0.331*G + 0.5
     <em>
      B ;
      <br/>
      V = 0.5
      <em>
       R - 0.419
      </em>
      G - 0.081
     </em>
     B;
     <br/>
     8bit位深的情况下
     <br/>
     ◼ TV range是16-235(Y)、16-240(UV) , 也叫Limited Range
     <br/>
     ◼ PC range是0-255，也叫Full Range
     <br/>
     ◼ 而RGB没有range之分，全是0-255
     <br/>
     反过来，RGB 也可以直接从YUV (256级别) 计算:
     <br/>
     R = Y + 1.402 (Y-128)
     <br/>
     G = Y - 0.34414 (U-128) - 0.71414 (U-128)
     <br/>
     B = Y + 1.772 (V-128)
     <br/>
     ◼ 从YUV 转到 RGB 如果值小于0要取0，如果大于255要取255
     <br/>
     谷歌的libyuv库
    </p>
    <h4>
     <a id="1324_RGBYUV_140">
     </a>
     1.3.2.4 RGB和YUV的转换-为什么解码出错显示绿屏
    </h4>
    <p>
     因为解码失败时YUV分量都填为0值，然后根据公式：
     <br/>
     R = 1.402 * (-128) = -126.598
     <br/>
     G = -0.34414*(-128) - 0.71414*(-128) = 44.04992 + 91.40992 = 135.45984
     <br/>
     B = 1.772 * (-128) = -126.228
     <br/>
     RGB 值范围为[0，255]， 所以最终的值为：
     <br/>
     R = 0
     <br/>
     G = 135.45984
     <br/>
     B = 0
     <br/>
     此时只有G分量有值所以为绿色。
     <br/>
     YUV -&gt; RGB
    </p>
    <h4>
     <a id="1325_YUV_Stride_153">
     </a>
     1.3.2.5 YUV Stride对齐问题
    </h4>
    <p>
     比如分辨率638x480的YUV420P图像，我们在内存处理的时候如果要以16字
     <br/>
     节对齐，则638不能被16整除，我们需要在每行尾部填充2个字节。就是640。
     <br/>
     此时该图片的Y stride为640字节。
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/da4e789e927f7a6909fc37d8ed70ca04.png"/>
    </p>
    <h2>
     <a id="14_161">
     </a>
     1.4.视频的主要概念
    </h2>
    <h3>
     <a id="141__163">
     </a>
     1.4.1 概念
    </h3>
    <p>
     视频码率：kb/s，是指视频文件在单位时间内使用的数据流量，也叫码流率。码率越大，说明单位时间内取样率越大，数据流精度就越高。
    </p>
    <p>
     视频帧率：fps，通常说一个视频的25帧，指的就是这个视频帧率，即1秒中会显示25帧。帧率越高，给人的视觉就越流畅。
    </p>
    <p>
     视频分辨率：分辨率就是我们常说的640x480分辨率、1920x1080分辨率，分辨率影响视频图像的大小。
    </p>
    <p>
     I 帧（Intra coded frames）：I帧不需要参考其他画面而生成,解码时仅靠自己就重构完整图像;
     <br/>
     I帧图像采用帧内编码方式;
     <br/>
     I帧所占数据的信息量比较大;
     <br/>
     I帧图像是周期性出现在图像序列中的，出现频率可由编码器选择;
     <br/>
     I帧是P帧和B帧的参考帧(其质量直接影响到同组中以后各帧的质量);
     <br/>
     I帧是帧组GOP的基础帧(第一帧),在一组中只有一个I帧;
     <br/>
     I帧不需要考虑运动矢量;
    </p>
    <p>
     P 帧（Predicted frames）：根据本帧与相邻的前一帧（I帧或P帧）的不同点来压缩本帧数据，同时利用了空间和时间上的相关性。
     <br/>
     P帧属于前向预测的帧间编码。它需要参考前面最靠近它的I帧或P帧来解码。
     <br/>
     B 帧（Bi-directional predicted frames）：B 帧图像采用双向时间预测，可以大大提高压缩倍数。
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/f34d09bf8600b7918ae5afc1a63af9b5.png"/>
    </p>
    <h3>
     <a id="142__183">
     </a>
     1.4.2 常用的视频压缩算法
    </h3>
    <p>
     MPEG2 MPEG阵营
     <br/>
     H264 MPEG阵营
     <br/>
     H265 MPEG阵营
     <br/>
     AVS 中国阵营
     <br/>
     VP8 Google阵营
     <br/>
     VP9 Google阵营
    </p>
    <p>
     音频基础-课程大纲
     <br/>
     2.1 声音的物理性质
     <br/>
     2.2 数字音频
     <br/>
     2.3 音频基础名词
     <br/>
     2.4 音频编码基本原理
     <br/>
     2.5 音频编解码器选型
    </p>
    <h3>
     <a id="143__198">
     </a>
     1.4.3 测试视频下载地址
    </h3>
    <p>
     1、地址：http://clips.vorwaerts-gmbh.de/big_buck_bunny.mp4 1分钟
     <br/>
     2、地址：http://vjs.zencdn.net/v/oceans.mp4
     <br/>
     3、地址：https://media.w3.org/2010/05/sintel/trailer.mp4 52秒
     <br/>
     4、http://mirror.aarnet.edu.au/pub/TED-talks/911Mothers_2010W-480p.mp4 10分
     <br/>
     钟
     <br/>
     其他各种格式，MP4, flv, mkv, 3gp 视频下载
     <br/>
     https://www.sample-videos.com/index.php#sample-mp4-video
    </p>
    <p>
     参考文档
    </p>
    <p>
     <a href="https://segmentfault.com/a/1190000023769775" rel="nofollow">
      看视频常见的 720p、1080p、4k，这些分辨率到底包含了什么
     </a>
     <br/>
     YUV详解：https://blog.csdn.net/u013898698/article/details/54927203
    </p>
    <h2>
     <a id="15__212">
     </a>
     1.5 音频
    </h2>
    <h3>
     <a id="151__214">
     </a>
     1.5.1 声音的物理性质
    </h3>
    <h4>
     <a id="1521__215">
     </a>
     1.5.2.1 声音的物理性质-振动
    </h4>
    <p>
     声音是一种由物体振动引发的物理现象，如小提琴的弦声等。物体的振动使其四周空气的压强产生变化，这种忽强忽弱变化以波的形式向四周传播，当被人耳所接收时，我们就听见了声音。
     <br/>
     2.1 声音的物理性质-波形
     <br/>
     声音是由物体的振动产生的，这种振动引起了周围空气压强的振荡，我们称这种振荡的函数表现形式为波形.
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/c49ab207213c1b58c75dc26eaeeaa275.jpeg"/>
    </p>
    <h4>
     <a id="1521__220">
     </a>
     1.5.2.1 声音的物理性质-频率
    </h4>
    <p>
     声音的频率是周期的倒数，它表示的是声音在1秒钟内的周期数，单位是赫兹(Hz)。千赫(kHz),即1000Hz,表示每秒振动1000次。声音按频率可作如下划分:
     <br/>
     次声 0～20Hz
     <br/>
     人耳能听见的声音 20Hz～20KHz
     <br/>
     超声 20KHz～1GHz
     <br/>
     特超声 1GHz～10THz
    </p>
    <h4>
     <a id="1521__227">
     </a>
     1.5.2.1 声音的物理性质-振幅
    </h4>
    <p>
     声音有振幅，振幅的主观感觉是声音的大小。声音的振幅大小取决于空气压力波距平均值(也称平衡态)的最大偏移量。
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/828a1a34fbf3cdfcc13dd4a760ded0e4.jpeg"/>
    </p>
    <h3>
     <a id="152__230">
     </a>
     1.5.2 数字音频
    </h3>
    <p>
     为了将模拟信号数字化，本节将分为3个概念进行讲解：
     <br/>
     采样频率、采样量化、编码
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/368802158560b018a2e3ade543d3d6ac.png"/>
    </p>
    <h4>
     <a id="1521__235">
     </a>
     1.5.2.1 数字音频-采样频率
    </h4>
    <p>
     根据Nyguist采样定律，要从采样中完全恢复原始信号波形，采样频率必须至少是信号中最高频率的两倍。
    </p>
    <p>
     前面提到人耳能听到的频率范围是[20H~20kHz]，所以采样频率一般为44.1Khz，这样就能保证声音到达20Khz也能被数字化，从而使得经过数字化处理之后，人耳听到的声音质量不会被降低。
    </p>
    <p>
     采样频率：每秒钟采样的点的个数。常用的采样频率有：
     <br/>
     22000（22kHz）： 无线广播。
     <br/>
     44100（44.1kHz）： CD音质。
     <br/>
     48000（48kHz）： 数字电视，DVD。
     <br/>
     96000（96kHz）： 蓝光，高清DVD。
     <br/>
     192000(192kHz): 蓝光，高清DVD。
    </p>
    <h4>
     <a id="1522__247">
     </a>
     1.5.2.2 数字音频-采样量化
    </h4>
    <p>
     采样是在离散的时间点上进行的，而采样值本身在计算机中也是离散的。
     <br/>
     采样值的精度取决于它用多少位来表示，这就是量化。例如8位量化可以表示256个不同值，而CD质量的16位量化可以表示65 536个值，范围为[-32768, 32767]。
    </p>
    <p>
     下图是一个3位量化的示意图，可以看出3位量化只能表示8个值:0.75,0.5,0.25,0,─0.25,─0.5,─0.75和 ─1，因而量化位数越少，波形就越难辨认，还原后的声音质量也就越差(可能除了一片嗡嗡声之外什么都没有)
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/2e003ae57a695a2dd02c439a9b02a3fd.png"/>
    </p>
    <h4>
     <a id="1523__253">
     </a>
     1.5.2.3 音频常见名词
    </h4>
    <p>
     采样频率：每秒钟采样的点的个数。常用的采样频率有：
     <br/>
     22000（22kHz）： 无线广播。
     <br/>
     44100（44.1kHz）：CD音质。
     <br/>
     48000（48kHz）： 数字电视，DVD。
     <br/>
     96000（96kHz）： 蓝光，高清DVD。
     <br/>
     192000(192kHz): 蓝光，高清DVD。
    </p>
    <p>
     采样精度（采样深度）：每个“样本点”的大小，
     <br/>
     常用的大小为8bit， 16bit，24bit。
    </p>
    <p>
     通道数：单声道，双声道，四声道，5.1声道。
    </p>
    <p>
     比特率：每秒传输的bit数，单位为：bps（Bit Per Second）
     <br/>
     间接衡量声音质量的一个标准。
     <br/>
     没有压缩的音频数据的比特率 = 采样频率 * 采样精度 * 通道数。
    </p>
    <p>
     码率： 压缩后的音频数据的比特率。常见的码率：
     <br/>
     96kbps： FM质量
     <br/>
     128-160kbps：一般质量音频。
     <br/>
     192kbps： CD质量。
     <br/>
     256-320Kbps：高质量音频
    </p>
    <pre><code>码率越大，压缩效率越低，音质越好，压缩后数据越大。
码率 = 音频文件大小/时长。
</code></pre>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/3d5b717deb24a322e00776430c09acbb.png"/>
     <br/>
     帧：每次编码的采样单元数，比如MP3通常是1152个采样点作为一个编码单元，AAC通常是1024个采样点作为一个编码单元。
    </p>
    <p>
     帧长：
     <br/>
     可以指每帧播放持续的时间：每帧持续时间(秒) = 每帧采样点数 / 采样频率（HZ）
     <br/>
     比如：MP3 48k, 1152个采样点,每帧则为 24毫秒
     <br/>
     1152/48000= 0.024 秒 = 24毫秒；
     <br/>
     也可以指压缩后每帧的数据长度。
    </p>
    <p>
     所以讲到帧的时候要注意他适用的场合。
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/bf9ba399538a11cd89a5b1823694ac73.png"/>
    </p>
    <h3>
     <a id="153__291">
     </a>
     1.5.3 音频编码原理简介
    </h3>
    <p>
     数字音频信号如果不加压缩地直接进行传送，将会占用极大的带宽。例如，一套双声道数字音频若取样频率为44.1KHz，每样值按16bit量化，则其码率为：
     <br/>
     2
     <em>
      44.1kHz
     </em>
     16bit=1.411Mbit/s
     <br/>
     如此大的带宽将给信号的传输和处理都带来许多困难和成本（阿里云服务器带宽大于5M后，每M价格是100元/月），
     <br/>
     因此必须采取音频压缩技术对音频数据进行处理，才能有效地传输音频数据。
    </p>
    <p>
     数字音频压缩编码在保证信号在听觉方面不产生失真的前提下，对音频数据信号进行尽可能大的压缩，降低数据量。数字音频压缩编码采取去除声音信号中冗余成分的方法来实现。所谓冗余成分指的是音频中不能被人耳感知到的信号，它们对确定声音的音色，音调等信息没有任何的帮助。
    </p>
    <p>
     冗余信号包含人耳听觉范围外的音频信号以及被掩蔽掉的音频信号等。例如，人耳所能察觉的声音信号的频率范围为20Hz～20KHz，除此之外的其它频率人耳无法察觉，都可视为冗余信号。
    </p>
    <p>
     此外，根据人耳听觉的生理和心理声学现象，当一个强音信号与一个弱音信号同时存在时，弱音信号将被强音信号所掩蔽而听不见，这样弱音信号就可以视为冗余信号而不用传送。这就是人耳听觉的掩蔽效应，主要表现在频谱掩蔽效应和时域掩蔽效应。
    </p>
    <h4>
     <a id="1531__303">
     </a>
     1.5.3.1 音频编码-频谱掩蔽效应
    </h4>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/b9099a6c8cb1d8952445ea3247ddcdfd.png"/>
    </p>
    <h4>
     <a id="1532__305">
     </a>
     1.5.3.2 音频编码-时域掩蔽效应
    </h4>
    <p>
     当强音信号和弱音信号同时出现时，还存在时域掩蔽效应。即两者发生时间很接近的时候，也会发生掩蔽效应。时域掩蔽过程曲线如图所示，分为前掩蔽、同时掩蔽和后掩蔽三部分。
    </p>
    <p>
     时域掩蔽效应可以分成三种：前掩蔽，同时掩蔽，后掩蔽。前掩蔽是指人耳在听到强信号之前的短暂时间内，已经存在的弱信号会被掩蔽而听不到。同时掩蔽是指当强信号与弱信号同时存在时，弱信号会被强信号所掩蔽而听不到。后掩蔽是指当强信号消失后，需经过较长的一段时间才能重新听见弱信号，称为后掩蔽。这些被掩蔽的弱信号即可视为冗余信号。
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/f3a07e35235a48fd7925f66bcd2d3a2f.png"/>
    </p>
    <h4>
     <a id="1533__312">
     </a>
     1.5.3.3 音频编码-压缩编码方法
    </h4>
    <p>
     当前数字音频编码领域存在着不同的编码方案和实现方式, 但基本的编码思路大同小异, 如图所示。
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/b0b7fac091a2c7dd6a7f589f453ac83a.png"/>
     <br/>
     对每一个音频声道中的音频采样信号：
     <br/>
     将它们映射到频域中,这种时域到频域的映射可通过子带滤波器实现。每个声道中的音频采样块首先要根据心理声学模型来计算掩蔽门限值；
     <br/>
     由计算出的掩蔽门限值决定从公共比特池中分配给该声道的不同频率域中多少比特数，接着进行量化以及编码工作；
     <br/>
     将控制参数及辅助数据加入数据之中，产生编码后的数据流。
    </p>
    <h4>
     <a id="1534__320">
     </a>
     1.5.3.4 音频编解码器选型
    </h4>
    <p>
     OPUS
     <br/>
     MP3
     <br/>
     AAC
     <br/>
     AC3和EAC3 杜比公司的方案
    </p>
    <p>
     请参考：《详解音频编解码的原理、演进和应用选型等 - 知乎 (zhihu.com) 》
     <br/>
     https://zhuanlan.zhihu.com/p/55218899
    </p>
    <h2>
     <a id="16__330">
     </a>
     1.6 封装格式的概念
    </h2>
    <p>
     封装格式(也叫容器）就是将已经编码压缩好的视频流、音频流及字幕按照一定的方案放到一个文件中，便于播放软件播放。
     <br/>
     一般来说，视频文件的后缀名就是它的封装格式。
    </p>
    <p>
     封装的格式不一样，后缀名也就不一样。
    </p>
    <p>
     比如：同样的陷可以做成饺子也可以做成包子。对于视频也是一个道理，同样的音视频流可以用不同容器来承载。
    </p>
    <p>
     封装格式示例
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/af46ccf2fb90bb89aa7130619a827a8b.png"/>
     <br/>
     这里的压缩算法：
     <br/>
     视频Video：使用了H264/AVC压缩算法
     <br/>
     音频Audio：使用了AAC压缩算法
    </p>
    <h3>
     <a id="161_MP4_346">
     </a>
     1.6.1 封装则使用MP4封装格式
    </h3>
    <p>
     常见的视频封装格式
     <br/>
     AVI、MKV、MPE、MPG、MPEG
     <br/>
     MP4、WMV、MOV、3GP
     <br/>
     M2V、M1V、M4V、OGM
     <br/>
     RM、RMS、RMM、RMVB、IFO
     <br/>
     SWF、FLV、F4V、
     <br/>
     ASF、PMF、XMB、DIVX、PART
     <br/>
     DAT、VOB、M2TS、TS、PS
    </p>
    <p>
     H264+AAC封装为FLV或MP4是最为流行的模式
    </p>
    <h2>
     <a id="17__360">
     </a>
     1.7 音视频同步基础
    </h2>
    <h4>
     <a id="171__362">
     </a>
     1.7.1 音视频同步概念
    </h4>
    <p>
     DTS（Decoding Time Stamp）：即解码时间戳，这个时间戳的意义在于告诉播放器该在什么时候解码这一帧的数据。
     <br/>
     PTS（Presentation Time Stamp）：即显示时间戳，这个时间戳用来告诉播放器该在什么时候显示这一帧的数据。
    </p>
    <h4>
     <a id="172__367">
     </a>
     1.7.2 音视频同步方式
    </h4>
    <p>
     Audio Master：同步视频到音频
     <br/>
     Video Master：同步音频到视频
     <br/>
     External Clock Master：同步音频和视频到外部时钟。
    </p>
    <p>
     一般情况下 Audio Master &gt; External Clock Master &gt; Video Master
    </p>
    <h4>
     <a id="173__375">
     </a>
     1.7.3 音视频同步
    </h4>
    <p>
     Avsync模块
     <br/>
     目前只支持audio master的方式
    </p>
    <p>
     各个模块关键时间点的监测
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/8fdece626510a5d7aa52101babff341d.png"/>
    </p>
    <h4>
     <a id="174__384">
     </a>
     1.7.4 其他
    </h4>
    <ol>
     <li>
      客户端的首帧秒开，本质上就是不做同步先把第一帧显示出来。
     </li>
     <li>
      推流没有问题时，如果拉流不能正常播放：
     </li>
     <li>
      没有声音：dump rtmp拉流后的数据是否可以正常播放
     </li>
     <li>
      声音异常：是否有解码错误报告，重采样前的pcm数据是否正常
     </li>
     <li>
      没有图像： dump rtmp拉流后的数据是否可以正常播放
     </li>
     <li>
      画面异常：是否有解码错误报告，scale前的数据是否正常
      <br/>
      服务器首帧秒开：这个功能不能降低延迟
     </li>
    </ol>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
  <div class="blog-extension-box" id="blogExtensionBox" style="width:400px;margin:auto;margin-top:12px">
  </div>
 </article>
</div>


<p class="artid" style="display:none">68747470733a2f2f626c6f672e:6373646e2e6e65742f77656978696e5f34383530323036322f:61727469636c652f64657461696c732f313330313833313435
