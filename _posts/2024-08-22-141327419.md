---
layout: post
title: "visual-studio连接sql-server数据库"
date: 2024-08-22 15:30:52 +0800
description: "sql server是关系数据库管理系统，专门用来查询、visu"
keywords: "vs连接sqlserver数据库步骤"
categories: ['上位机软件开发']
tags: ['软件工程', '数据库', 'Visual', 'Studio', 'Sqlserver']
artid: "141327419"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=141327419
    alt: "visual-studio连接sql-server数据库"
render_with_liquid: false
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     visual studio连接sql server数据库
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
    </p>
    <div class="toc">
     <h4>
      目录
     </h4>
     <ul>
      <li>
       <ul>
        <li>
         <a href="#1_9" rel="nofollow">
          1、为什么要建立连接
         </a>
        </li>
        <li>
         <a href="#2sql_server_12" rel="nofollow">
          2、在sql server中建立数据库
         </a>
        </li>
        <li>
         <a href="#3visual_studiosql_server_58" rel="nofollow">
          3、visual studio连接sql server数据库
         </a>
        </li>
        <li>
         <a href="#4_76" rel="nofollow">
          4、学生信息管理系统页面布局
         </a>
        </li>
        <li>
         <a href="#5_92" rel="nofollow">
          5、添加事件逻辑
         </a>
        </li>
        <li>
         <ul>
          <li>
           <a href="#51__95" rel="nofollow">
            5.1 页面跳转
           </a>
          </li>
          <li>
           <a href="#52__107" rel="nofollow">
            5.2 读取学生信息
           </a>
          </li>
          <li>
           <a href="#53__187" rel="nofollow">
            5.3 查询学生信息
           </a>
          </li>
          <li>
           <a href="#54__236" rel="nofollow">
            5.4 修改学生信息
           </a>
          </li>
          <li>
           <a href="#55__291" rel="nofollow">
            5.5 删除学生信息
           </a>
          </li>
          <li>
           <a href="#56__329" rel="nofollow">
            5.6 添加学生信息
           </a>
          </li>
         </ul>
        </li>
       </ul>
      </li>
     </ul>
    </div>
    <p>
    </p>
    <hr/>
    <p>
     <a href="https://www.bilibili.com/video/BV1MCWGeiEmU/?vd_source=be164573e789df9e391588d6ad22f4ed" rel="nofollow">
      bilibili演示视频
     </a>
     <br/>
     <a href="https://github.com/whos2/StuMes-Management/tree/master">
      github源码
     </a>
    </p>
    <hr/>
    <h3>
     <a id="1_9">
     </a>
     1、为什么要建立连接
    </h3>
    <p>
     sql server是关系数据库管理系统，专门用来查询、操作和管理数据库。visual studio和sql server连接后，可以读取数据库中的数据，还能对数据进行增删改查。比如，我们在visual studio中用C#语言开发一个学生信息管理软件，具体功能有读取学生信息、更改学生信息、删除学生信息、添加学生信息等，这些学生的信息就存储在sql server中，软件可以根据用户的操作读取和更改数据库中的信息。
    </p>
    <h3>
     <a id="2sql_server_12">
     </a>
     2、在sql server中建立数据库
    </h3>
    <p>
     打开SQL Server Management Studio(SSMS)软件，连接到服务器。
     <br/>
     选择“数据库”，右键，“新建数据库”，建立一个学生信息数据库，数据库名为StuMes。
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/082910c068ee41568d1587a09054ad7a.png">
      <br/>
      输入数据库名称，点击确定。这样，学生信息数据库就建立好了。
     </img>
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/84b54406a46c490dbc5e6bcf032217d5.png"/>
    </p>
    <p>
     在数据库中新建一个表，用来存储学生信息，包括姓名、年龄、性别、学号。
     <br/>
     点击“表”，右键，“新建”–&gt;“表”。
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/36b168107f1b4fe2976517021933afd2.png">
      <br/>
      输入列名和数据类型。
     </img>
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/629bcd3000534a86ae6f857f81c3a6dd.png">
      <br/>
      <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/bd783a98a54d4d23951b4b694776d1eb.png"/>
     </img>
    </p>
    <p>
     保存，输入表名称Table_Stu，点击确定。
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/f39142e0d7264a3d9f2ef94fe18fdb2f.png"/>
    </p>
    <p>
     选择StuMes数据库，右键，刷新，这时就可以看到刚刚新建的表了，目前表中只包含列名，没有实际的内容。当然，列的添加也可以通过代码的方式，我这里是手动添加的。
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/7e55ea1b6d8748bbbfb7b33c4dce530c.png"/>
    </p>
    <p>
     向表中添加学生信息。点击“新建查询”，通过代码的方式向表中添加5个学生的信息。
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/175745c00cc748cb8274dab580d1cdbf.png"/>
    </p>
    <p>
     代码的意思是，向Table_Stu表中插入这5个学生的信息。
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/1fa1ab030d3d4ebc8a863c74f8bf43d7.png"/>
    </p>
    <pre><code class="prism language-sql"><span class="token keyword">insert</span> <span class="token keyword">into</span> Table_Stu<span class="token punctuation">(</span>Name<span class="token punctuation">,</span>Age<span class="token punctuation">,</span>Sex<span class="token punctuation">,</span>StuNum<span class="token punctuation">)</span> <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">'小王'</span><span class="token punctuation">,</span><span class="token string">'18'</span><span class="token punctuation">,</span><span class="token string">'男'</span><span class="token punctuation">,</span><span class="token string">'12345'</span><span class="token punctuation">)</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> Table_Stu<span class="token punctuation">(</span>Name<span class="token punctuation">,</span>Age<span class="token punctuation">,</span>Sex<span class="token punctuation">,</span>StuNum<span class="token punctuation">)</span> <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">'小白'</span><span class="token punctuation">,</span><span class="token string">'20'</span><span class="token punctuation">,</span><span class="token string">'男'</span><span class="token punctuation">,</span><span class="token string">'12323'</span><span class="token punctuation">)</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> Table_Stu<span class="token punctuation">(</span>Name<span class="token punctuation">,</span>Age<span class="token punctuation">,</span>Sex<span class="token punctuation">,</span>StuNum<span class="token punctuation">)</span> <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">'小黑'</span><span class="token punctuation">,</span><span class="token string">'19'</span><span class="token punctuation">,</span><span class="token string">'男'</span><span class="token punctuation">,</span><span class="token string">'11223'</span><span class="token punctuation">)</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> Table_Stu<span class="token punctuation">(</span>Name<span class="token punctuation">,</span>Age<span class="token punctuation">,</span>Sex<span class="token punctuation">,</span>StuNum<span class="token punctuation">)</span> <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">'小赵'</span><span class="token punctuation">,</span><span class="token string">'18'</span><span class="token punctuation">,</span><span class="token string">'女'</span><span class="token punctuation">,</span><span class="token string">'32145'</span><span class="token punctuation">)</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> Table_Stu<span class="token punctuation">(</span>Name<span class="token punctuation">,</span>Age<span class="token punctuation">,</span>Sex<span class="token punctuation">,</span>StuNum<span class="token punctuation">)</span> <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">'小兰'</span><span class="token punctuation">,</span><span class="token string">'21'</span><span class="token punctuation">,</span><span class="token string">'男'</span><span class="token punctuation">,</span><span class="token string">'13254'</span><span class="token punctuation">)</span>
</code></pre>
    <p>
     全选代码，点击执行，这样就将5条学生信息记录到了数据库中的表中了。
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/989bab88cb184369a12d11f2d7feeea3.png"/>
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/8c5434f525a847dc9732e940f1e7e1ca.png"/>
    </p>
    <h3>
     <a id="3visual_studiosql_server_58">
     </a>
     3、visual studio连接sql server数据库
    </h3>
    <p>
     首先，新建一个C# Windows窗体应用 项目，我这里项目名称为DataConnect，点击确定。
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/d03b7e6c07294737810f4debf272bbcb.png"/>
     <br/>
     项目建立好后，点击“工具”–&gt;“连接到数据库”，
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/6b3eb78559774341acf936c13db0b48c.png"/>
     <br/>
     数据源选择“Microsoft SQL Server(SqlClient)”，还需要输入服务器名，以及选择数据库名称。
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/21ba2441eb654d908df110335a3e8bec.png"/>
     <br/>
     在SQL Server Management Studio软件点击“文件”–&gt;“连接对象资源管理器”，复制“服务器名称”，粘贴过来，这时就可以通过下拉框选择刚创建的学生信息数据库了。点击确定。
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/53828e21b61342f9b99a07efe5b917ab.png"/>
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/c9d0becdeeb04f7588b838686477400c.png"/>
     <br/>
     这样就可以在visual studio“服务器资源管理器”中看到连接到的数据库了。
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/6cb462b0403f40389d62ed6d7c74ae8b.png"/>
    </p>
    <h3>
     <a id="4_76">
     </a>
     4、学生信息管理系统页面布局
    </h3>
    <p>
     双击打开Form1.cs文件，该文件对应的是图中所示的窗体，我们向窗体中拖入控件，包括1个DataGridView用于显示数据库表格数据，和5个Button用于触发事件，打开跳转界面。我们为学生信息管理系统设置了5个功能，分别是学生信息读取、学生信息查询、学生信息修改、学生信息删除、学生信息添加，DataGridView用于显示学生信息。具体的控件添加方法见
     <a href="https://blog.csdn.net/sc_1313/article/details/141318393?spm=1001.2014.3001.5501">
      WinForms添加Button控件
     </a>
     。
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/cdfcde68ac4b49e49bbafe17d5701594.png"/>
    </p>
    <p>
     将第一个Button的Name改为“btnRead”，text改为“读取”；将第二个Button的Name改为“btnFind”，text改为“查询”；将第三个Button的Name改为“btnChange”，text改为“修改”；将第四个Button的Name改为“btnDel”，text改为“删除”；将第五个Button的Name改为“btnAdd”，text改为“添加”。将窗体的Text改为“学生信息管理系统”。就这样，第一个窗体的布局完毕。
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/5b2100cc34b54ea29dcfcf8b6eacfcfb.png"/>
    </p>
    <p>
     点击项目，右键，新建Windows窗体，新建窗体作为跳转界面，当主界面点击“查询”、“修改”、“删除”、“添加”后，会跳转到相应窗体。
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/d4d311d4760d423d823b70f1b5d844e4.png"/>
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/7e8587a0f4d048aebd1dfef87f3c6b7b.png"/>
    </p>
    <h3>
     <a id="5_92">
     </a>
     5、添加事件逻辑
    </h3>
    <p>
     上面我们完成了页面的绘制，但是仅仅这样并没有什么用，我们运行代码后，点击界面并不会发生任何事情，这是因为我们没有添加逻辑，也就是没有写代码，winform并不知道我们添加的这些控件是用来干什么的，下面，就依次来添加功能代码。
    </p>
    <h4>
     <a id="51__95">
     </a>
     5.1 页面跳转
    </h4>
    <p>
     双击“查询”控件，会跳转到该控件背后的代码。当鼠标点击控件后，btnFind_Click()函数会被执行，我们要实现的效果是点击“查询”后，页面跳转，因此就需要将代码添加到该函数下。
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/55a3646b911b4e1eaa656874acbbdde0.png"/>
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/c9c8a720f21b408ebd5b22212fd5e6db.png"/>
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/e74f792a699d482f81e98f5526b1492e.png"/>
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/7849cfd0647d46edae2ea6bb9632844e.png"/>
    </p>
    <p>
     同样的，给“修改”、“删除”、“添加”也加上相同的功能。
    </p>
    <h4>
     <a id="52__107">
     </a>
     5.2 读取学生信息
    </h4>
    <p>
     从数据库表格中读取学生信息，DataGridView显示。
     <br/>
     点击项目，右键，添加类。默认命名为Class1.cs。
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/ec5109ac77f44c1bbe2f15a30e543323.png"/>
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/9dd284e5a3184b109115af55e192e5ac.png"/>
    </p>
    <pre><code class="prism language-cs"><span class="token keyword">using</span> <span class="token namespace">System</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Collections<span class="token punctuation">.</span>Generic</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Data</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Data<span class="token punctuation">.</span>SqlClient</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Linq</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Text</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Threading<span class="token punctuation">.</span>Tasks</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Windows<span class="token punctuation">.</span>Forms</span><span class="token punctuation">;</span>

<span class="token keyword">namespace</span> <span class="token namespace">DataConnect</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">class</span> <span class="token class-name">Class1</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">public</span> <span class="token class-name">SqlConnection</span> conn<span class="token punctuation">;</span>
        <span class="token keyword">public</span> <span class="token return-type class-name">SqlConnection</span> <span class="token function">Connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">//连接数据库</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token comment">//Data Source指定本地数据库，Initial Catalog指定数据库名称</span>
            <span class="token comment">//Integrated Security=True 表示使用集成安全性，也就是说，用户</span>
            <span class="token comment">//的Windows帐户身份将被用来验证数据库连接，而不是使用账号和密码。</span>
            <span class="token class-name"><span class="token keyword">string</span></span> str <span class="token operator">=</span> <span class="token string">@"Data Source=.;Initial Catalog=StuMes;Integrated Security=True"</span><span class="token punctuation">;</span> <span class="token comment">//数据库连接字符串</span>
            <span class="token comment">//string constr = "server=localhost;database=数据库名;uid=账号;pwd=密码;";</span>
            conn <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">SqlConnection</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//创建SqlConnection对象</span>
            conn<span class="token punctuation">.</span><span class="token function">Open</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//打开数据库连接</span>
            <span class="token keyword">return</span> conn<span class="token punctuation">;</span>
            
        <span class="token punctuation">}</span>

        <span class="token keyword">public</span> <span class="token return-type class-name">SqlCommand</span> <span class="token function">Command</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> sql<span class="token punctuation">)</span> <span class="token comment">//执行一条sql命令</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">SqlCommand</span> cmd <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">SqlCommand</span><span class="token punctuation">(</span>sql<span class="token punctuation">,</span> <span class="token function">Connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> cmd<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">int</span></span> <span class="token function">Execute</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> sql<span class="token punctuation">)</span> <span class="token comment">//获取执行sql命令后，数据库表中数据条数的更新数量，用来判断命令是否执行成功</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> <span class="token function">Command</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ExecuteNonQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">public</span> <span class="token return-type class-name">SqlDataReader</span> <span class="token function">Read</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> sql<span class="token punctuation">)</span> <span class="token comment">//读取数据库中的数据</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> <span class="token function">Command</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ExecuteReader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//关闭数据库</span>
        <span class="token punctuation">{<!-- --></span>
            conn<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre>
    <p>
     双击“读取”，进入代码，在函数中输入代码，我们要实现的效果是，点击“读取”后，程序获取数据库数据，返回连接结果，并将获取的数据显示在DataGridView。
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/948a0a2d9e304673843ec3011c74ac36.png"/>
    </p>
    <pre><code class="prism language-cs"><span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">btnRead_Click</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">EventArgs</span> e<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">Class1</span> c1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Class1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//创建类对象</span>
            c1<span class="token punctuation">.</span><span class="token function">Connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//连接并打开数据库</span>

            <span class="token class-name"><span class="token keyword">string</span></span> sql <span class="token operator">=</span> <span class="token string">"SELECT * FROM Table_Stu"</span><span class="token punctuation">;</span> <span class="token comment">//选择表中所有数据</span>
            <span class="token class-name">SqlCommand</span> co <span class="token operator">=</span> c1<span class="token punctuation">.</span><span class="token function">Command</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//执行命令</span>
            <span class="token class-name">SqlDataAdapter</span> adapt <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">SqlDataAdapter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            adapt<span class="token punctuation">.</span>SelectCommand <span class="token operator">=</span> co<span class="token punctuation">;</span>
            <span class="token class-name">DataSet</span> ds <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">DataSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            adapt<span class="token punctuation">.</span><span class="token function">Fill</span><span class="token punctuation">(</span>ds<span class="token punctuation">,</span> <span class="token string">"t"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//第二个参数:表名，随便取</span>
            dataGridView1<span class="token punctuation">.</span>DataSource <span class="token operator">=</span> ds<span class="token punctuation">.</span>Tables<span class="token punctuation">[</span><span class="token string">"t"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

            c1<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
</code></pre>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/7f9dd72f537a4004a81c65d773caa58f.png"/>
    </p>
    <h4>
     <a id="53__187">
     </a>
     5.3 查询学生信息
    </h4>
    <p>
     通过学号进行学生信息的查询，如果查询的学生在数据库中，则返回学生的完整信息，否则，给出提示信息。
    </p>
    <pre><code class="prism language-cs"><span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">btnOk_Click</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">EventArgs</span> e<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token class-name"><span class="token keyword">string</span></span> num <span class="token operator">=</span> txtNum<span class="token punctuation">.</span>Text<span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>num<span class="token operator">!=</span><span class="token string">""</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token class-name">Class1</span> c1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Class1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                c1<span class="token punctuation">.</span><span class="token function">Connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                
                <span class="token class-name"><span class="token keyword">string</span></span> sql <span class="token operator">=</span> <span class="token interpolation-string"><span class="token string">$"select * from Table_Stu where StuNum=</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token expression language-csharp"><span class="token keyword">int</span><span class="token punctuation">.</span><span class="token function">Parse</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span></span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">;</span>
                <span class="token class-name">SqlDataReader</span> reader <span class="token operator">=</span> c1<span class="token punctuation">.</span><span class="token function">Read</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name"><span class="token keyword">bool</span></span> flag <span class="token operator">=</span> reader<span class="token punctuation">.</span><span class="token function">Read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>flag<span class="token operator">==</span><span class="token boolean">true</span><span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token string">"查询成功"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token class-name">SqlCommand</span> co <span class="token operator">=</span> c1<span class="token punctuation">.</span><span class="token function">Command</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//执行命令</span>
                    <span class="token class-name">SqlDataAdapter</span> adapt <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">SqlDataAdapter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    adapt<span class="token punctuation">.</span>SelectCommand <span class="token operator">=</span> co<span class="token punctuation">;</span>
                    <span class="token class-name">DataSet</span> ds <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">DataSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    adapt<span class="token punctuation">.</span><span class="token function">Fill</span><span class="token punctuation">(</span>ds<span class="token punctuation">,</span> <span class="token string">"t"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//第二个参数:表名，随便取</span>
                    dataGridView1<span class="token punctuation">.</span>DataSource <span class="token operator">=</span> ds<span class="token punctuation">.</span>Tables<span class="token punctuation">[</span><span class="token string">"t"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">else</span>
                <span class="token punctuation">{<!-- --></span>
                    MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token string">"不存在输入的学号信息"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    dataGridView1<span class="token punctuation">.</span>DataSource <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
                    <span class="token keyword">return</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>


                c1<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">else</span>
            <span class="token punctuation">{<!-- --></span>
                MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token string">"请输入学号"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

<span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">btnExit_Click</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">EventArgs</span> e<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
</code></pre>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/3b8af0941b5b4040937d7d06dd2b16e9.png"/>
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/direct/2b3af20a60c4423ba2c0cd1b1f17209e.png"/>
    </p>
    <h4>
     <a id="54__236">
     </a>
     5.4 修改学生信息
    </h4>
    <p>
     先判断输入的学号是否存在于数据库中，如果不存在，就返回提示信息；否则，就进行修改。
    </p>
    <pre><code class="prism language-cs">        <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">btnExit_Click</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">EventArgs</span> e<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">btnOk_Click</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">EventArgs</span> e<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token class-name"><span class="token keyword">string</span></span> name <span class="token operator">=</span> txtName<span class="token punctuation">.</span>Text<span class="token punctuation">;</span>
            <span class="token class-name"><span class="token keyword">string</span></span> age <span class="token operator">=</span> txtAge<span class="token punctuation">.</span>Text<span class="token punctuation">;</span>
            <span class="token class-name"><span class="token keyword">string</span></span> sex <span class="token operator">=</span> comSex<span class="token punctuation">.</span>Text<span class="token punctuation">;</span>
            <span class="token class-name"><span class="token keyword">string</span></span> num <span class="token operator">=</span> txtNum<span class="token punctuation">.</span>Text<span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>num <span class="token operator">!=</span> <span class="token string">""</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token class-name">Class1</span> c1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Class1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                c1<span class="token punctuation">.</span><span class="token function">Connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token class-name"><span class="token keyword">string</span></span> sql <span class="token operator">=</span> <span class="token interpolation-string"><span class="token string">$"select * from Table_Stu where StuNum=</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token expression language-csharp"><span class="token keyword">int</span><span class="token punctuation">.</span><span class="token function">Parse</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span></span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">;</span>
                <span class="token class-name">SqlDataReader</span> reader <span class="token operator">=</span> c1<span class="token punctuation">.</span><span class="token function">Read</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name"><span class="token keyword">bool</span></span> flag <span class="token operator">=</span> reader<span class="token punctuation">.</span><span class="token function">Read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>flag <span class="token operator">==</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    <span class="token comment">//MessageBox.Show("查询成功");</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>name <span class="token operator">==</span> <span class="token string">""</span> <span class="token operator">||</span> age <span class="token operator">==</span> <span class="token string">""</span> <span class="token operator">||</span> sex <span class="token operator">==</span> <span class="token string">""</span><span class="token punctuation">)</span>
                    <span class="token punctuation">{<!-- --></span>
                        MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token string">"请将信息填写完整"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                    <span class="token keyword">else</span>
                    <span class="token punctuation">{<!-- --></span>
                        sql <span class="token operator">=</span> <span class="token interpolation-string"><span class="token string">$"delete from Table_Stu where StuNum=</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token expression language-csharp"><span class="token keyword">int</span><span class="token punctuation">.</span><span class="token function">Parse</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span></span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">;</span>
                        c1<span class="token punctuation">.</span><span class="token function">Execute</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//执行命令</span>
                        sql <span class="token operator">=</span> <span class="token interpolation-string"><span class="token string">$"insert into Table_Stu values('</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token expression language-csharp">name</span><span class="token punctuation">}</span></span><span class="token string">','</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token expression language-csharp">age</span><span class="token punctuation">}</span></span><span class="token string">','</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token expression language-csharp">sex</span><span class="token punctuation">}</span></span><span class="token string">','</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token expression language-csharp">num</span><span class="token punctuation">}</span></span><span class="token string">')"</span></span><span class="token punctuation">;</span>
                        c1<span class="token punctuation">.</span><span class="token function">Execute</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token string">"修改信息成功"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">else</span>
                <span class="token punctuation">{<!-- --></span>
                    MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token string">"不存在输入的学号信息"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">return</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                c1<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">else</span>
            <span class="token punctuation">{<!-- --></span>
                MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token string">"请输入学号"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre>
    <h4>
     <a id="55__291">
     </a>
     5.5 删除学生信息
    </h4>
    <p>
     输入学号，判断是否存在于数据库中，没有则返回提示信息，有则删除该条信息。
    </p>
    <pre><code class="prism language-cs"><span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">btnExit_Click</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">EventArgs</span> e<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">btnOk_Click</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">EventArgs</span> e<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token class-name"><span class="token keyword">string</span></span> num <span class="token operator">=</span> txtNum<span class="token punctuation">.</span>Text<span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>num<span class="token operator">!=</span><span class="token string">""</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token class-name">Class1</span> c1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Class1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                c1<span class="token punctuation">.</span><span class="token function">Connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token class-name"><span class="token keyword">string</span></span> sql <span class="token operator">=</span> <span class="token interpolation-string"><span class="token string">$"select * from Table_Stu where StuNum=</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token expression language-csharp"><span class="token keyword">int</span><span class="token punctuation">.</span><span class="token function">Parse</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span></span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">;</span>
                <span class="token class-name">SqlDataReader</span> reader <span class="token operator">=</span> c1<span class="token punctuation">.</span><span class="token function">Read</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name"><span class="token keyword">bool</span></span> flag <span class="token operator">=</span> reader<span class="token punctuation">.</span><span class="token function">Read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>flag <span class="token operator">==</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    sql <span class="token operator">=</span> <span class="token interpolation-string"><span class="token string">$"delete from Table_Stu where StuNum=</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token expression language-csharp"><span class="token keyword">int</span><span class="token punctuation">.</span><span class="token function">Parse</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span></span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">;</span>
                    c1<span class="token punctuation">.</span><span class="token function">Execute</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//执行命令</span>
                    MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token string">"删除信息成功"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">else</span>
                <span class="token punctuation">{<!-- --></span>
                    MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token string">"不存在输入的学号信息"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">return</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                c1<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">else</span>
            <span class="token punctuation">{<!-- --></span>
                MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token string">"请输入学号"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
</code></pre>
    <h4>
     <a id="56__329">
     </a>
     5.6 添加学生信息
    </h4>
    <p>
     先判断输入的学生学号在数据库中是否存在，如果存在，则返回提示信息，否则就添加信息到数据库，同时，输入的信息需要完整。
    </p>
    <pre><code class="prism language-cs"><span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">btnExit_Click</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">EventArgs</span> e<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">btnOk_Click</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">EventArgs</span> e<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token class-name"><span class="token keyword">string</span></span> name <span class="token operator">=</span> txtName<span class="token punctuation">.</span>Text<span class="token punctuation">;</span>
            <span class="token class-name"><span class="token keyword">string</span></span> age <span class="token operator">=</span> txtAge<span class="token punctuation">.</span>Text<span class="token punctuation">;</span>
            <span class="token class-name"><span class="token keyword">string</span></span> sex <span class="token operator">=</span> comSex<span class="token punctuation">.</span>Text<span class="token punctuation">;</span>
            <span class="token class-name"><span class="token keyword">string</span></span> num <span class="token operator">=</span> txtNum<span class="token punctuation">.</span>Text<span class="token punctuation">;</span>

            <span class="token class-name">Class1</span> c1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Class1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            c1<span class="token punctuation">.</span><span class="token function">Connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token class-name"><span class="token keyword">string</span></span> sql <span class="token operator">=</span> <span class="token string">"select * from Table_Stu"</span><span class="token punctuation">;</span>

            <span class="token class-name">SqlDataReader</span> reader <span class="token operator">=</span> c1<span class="token punctuation">.</span><span class="token function">Read</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>
            reader<span class="token punctuation">.</span><span class="token function">Read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name"><span class="token keyword">string</span></span> tmp <span class="token operator">=</span> reader<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token keyword">if</span> <span class="token punctuation">(</span>name <span class="token operator">==</span> <span class="token string">""</span> <span class="token operator">||</span> age <span class="token operator">==</span> <span class="token string">""</span> <span class="token operator">||</span> sex <span class="token operator">==</span> <span class="token string">""</span> <span class="token operator">||</span> num <span class="token operator">==</span> <span class="token string">""</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token string">"请输入完整信息"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">else</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">if</span><span class="token punctuation">(</span>tmp<span class="token operator">==</span>num<span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token string">"您输入的学号已存在，请重新输入"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">return</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">else</span>
                <span class="token punctuation">{<!-- --></span>
                    sql <span class="token operator">=</span> <span class="token interpolation-string"><span class="token string">$"insert into Table_Stu values('</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token expression language-csharp">name</span><span class="token punctuation">}</span></span><span class="token string">','</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token expression language-csharp">age</span><span class="token punctuation">}</span></span><span class="token string">','</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token expression language-csharp">sex</span><span class="token punctuation">}</span></span><span class="token string">','</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token expression language-csharp">num</span><span class="token punctuation">}</span></span><span class="token string">')"</span></span><span class="token punctuation">;</span>
                    c1<span class="token punctuation">.</span><span class="token function">Execute</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token string">"添加信息成功"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            c1<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
</code></pre>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="6874747073:3a2f2f626c6f672e6373646e2e6e65742f73635f313331332f:61727469636c652f64657461696c732f313431333237343139" class_="artid" style="display:none">
 </p>
</div>


