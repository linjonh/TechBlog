---
layout: post
title: "Python版本管理-pyenv"
date: 2025-01-26 17:42:48 +0800
description: "pyenv 可以改变全局的 Python 版本，在系统中安装多个版本的 Python， 设置目录级别"
keywords: "python版本管理"
categories: ['']
tags: ['Virtualenv', 'Python']
artid: "131767881"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=131767881
    alt: "Python版本管理-pyenv"
render_with_liquid: false
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     Python版本管理-pyenv
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <h2 id="jLyK9">
    </h2>
    <p>
     <a href="https://github.com/yyuu/pyenv" title="pyenv">
      pyenv
     </a>
     是 Python 版本管理工具。 pyenv 可以改变全局的 Python 版本，在系统中安装多个版本的 Python， 设置目录级别的 Python 版本，还能创建和管理 virtual python environments 。所有的设置都是用户级别的操作，不需要 sudo 命令。
    </p>
    <p>
     pyenv 的一个典型使用场景就是，比如一个老项目需要使用 Python 2.x ，而另一个新项目需要 Python 3.x 。而 virtualenv 主要是用来管理相同版本 Python 不同项目的包的依赖不同的问题，就无法解决这个问题，这个时候就需要 pyenv。
    </p>
    <p>
     pyenv 通过修改系统环境变量来实现不同 Python 版本的切换。而 virtualenv 通过将 Python 包安装到一个目录来作为 Python 包虚拟环境，通过切换目录来实现不同包环境间的切换。
    </p>
    <p>
     pyenv 实现的精髓之处在于，它并没有使用将不同的
     <code>
      $PATH
     </code>
     植入不同的 shell 这种高耦合的工作方式，而是简单地在
     <code>
      $PATH
     </code>
     的最前面插入了一个垫片路径（shims）：
     <code>
      ~/.pyenv/shims:/usr/local/bin:/usr/bin:/bin
     </code>
     。所有对 Python 可执行文件的查找都会首先被这个 shims 路径截获，从而使后方的系统路径失效。
    </p>
    <p>
     pyenv常用命令:
    </p>
    <pre id="wQsGE">pyenv install -l                    #查看可以安装的python版本
pyenv install &lt;版本号&gt;              #下载python版本
pyenv uninstall &lt;版本号&gt;            #卸载python版本
pyenv versions                      #查看所有python版本与环境
pyenv version                       #查看现在使用的版本或环境
pyenv shell &lt;环境名&gt;                #激活环境
pyenv global &lt;环境名&gt;               #设置全局环境
pyenv local &lt;环境名&gt;                #设置当前目录环境
pyenv virtualenv &lt;版本号&gt; &lt;环境名&gt;  #创建新环境</pre>
    <p id="ubafb738e">
     1.安装pyenv
     <br/>
     curl -L
     <a href="https://github.com/pyenv/pyenv-installer/raw/master/bin/pyenv-installer" title="https://github.com/pyenv/pyenv-installer/raw/master/bin/pyenv-installer">
      https://github.com/pyenv/pyenv-installer/raw/master/bin/pyenv-installer
     </a>
     | bash
    </p>
    <p id="u1ced5ed4">
     或者
     <br/>
     git clone
     <a href="https://github.com/yyuu/pyenv.git" title="GitHub - pyenv/pyenv: Simple Python version management">
      GitHub - pyenv/pyenv: Simple Python version management
     </a>
     ~/.pyenv
    </p>
    <p id="ud0fd8c59">
    </p>
    <p id="ua321de5a">
     2.配置
     <br/>
     如果采用第一种，系统是会告诉你怎么做的（即将最后的三行追加到~/.bash_profile,做环境变量）
    </p>
    <p id="ub06ebe67">
     export PYENV_ROOT="$HOME/.pyenv"
    </p>
    <p id="u5df59469">
     command -v pyenv &gt;/dev/null || export PATH="$PYENV_ROOT/bin:$PATH"
    </p>
    <p id="u81045ba9">
     eval "$(pyenv init -)"
    </p>
    <p id="uee58fd45">
     如果采用第二种（同样是做环境变量）
    </p>
    <p id="u2cd7a5d6">
    </p>
    <p id="uff08b56f">
     echo 'export PYENV_ROOT="$HOME/.pyenv"' &gt;&gt; ~/.bash_profile
    </p>
    <p id="u288e58ee">
     echo 'export PATH="$PYENV_ROOT/bin:$PATH"' &gt;&gt; ~/.bash_profile
    </p>
    <p id="u7d60607f">
     echo 'eval "$(pyenv init -)"' &gt;&gt; ~/.bash_profile
    </p>
    <p id="u327e0b3e">
     Liunx
    </p>
    <pre id="RAen2">echo 'export PYENV_ROOT="$HOME/.pyenv"' &gt;&gt; ~/.bashrc
echo 'export PATH="$PYENV_ROOT/bin:$PATH"' &gt;&gt; ~/.bashrc

echo 'eval "$(pyenv virtualenv-init -)"' &gt;&gt; ~/.bashrc
</pre>
    <p id="uc3d91752">
    </p>
    <p id="u9582c813">
     3.使用变量
    </p>
    <p id="ua97f61d7">
     source ~/.bash_profile
    </p>
    <p id="u8eb3c652">
    </p>
    <p id="u0e6f9624">
     安装python的不同版本
    </p>
    <p id="u3fe3ae92">
     1.查看可安装的python的版本
    </p>
    <p id="ua7ba06a9">
     pyenv install –list
    </p>
    <p id="uec62e63b">
    </p>
    <p id="u94cf2c4c">
     2.安装python
    </p>
    <p id="u3d7a597c">
     pyenv install -v 2.7.13
    </p>
    <p id="ud75ac7bc">
     pyenv install -v 3.6.4
    </p>
    <p id="ue3145beb">
    </p>
    <p id="uc9567d12">
     卸载python
    </p>
    <p id="ubd3f35a6">
     pyenv uninstall 2.7.13
    </p>
    <p id="u22834817">
    </p>
    <p id="ufaa2c556">
     常见问题及解决方案：
    </p>
    <p id="u0b040895">
     在使用pyenv install安装python，可能会比较慢，甚至下载安装不成功
    </p>
    <p id="uae12de02">
    </p>
    <p id="u16ff2d60">
     &lt;1&gt;.这时最好使用是下载好python源码包(Python-3.10.12.tar.xz)，然后通过pyenv进行安装（可以下载到境外云服务器）
    </p>
    <p id="u89c64c51">
     &lt;2&gt;.将python源码包放置在~/.pyenv/cache/目录中（不要解压 ; 如没有cache就创建一个）
    </p>
    <p id="u2b35e778">
     &lt;3&gt;.执行pyenv install 3.6.4
    </p>
    <p id="ua7f5683e">
     3.查看版本
    </p>
    <p id="u7bc3b4de">
    </p>
    <p id="u75c302b0">
     &lt;1&gt;查看pyenv版本
    </p>
    <p id="ud200fe82">
    </p>
    <p id="u8255bf33">
     pyenv –version
    </p>
    <p id="uc0bd790a">
     pyenv 1.2.3
    </p>
    <p id="u3bb7b110">
    </p>
    <p id="ueed30e03">
     &lt;2&gt;查看当前python版本
    </p>
    <p id="u679793c5">
    </p>
    <p id="ucf106691">
     pyenv versions
    </p>
    <p id="u45830f9a">
     * system (set by /root/.pyenv/version)
    </p>
    <p id="u3ff261ac">
     2.7.13
    </p>
    <p id="ub2946c52">
     3.6.4
    </p>
    <p id="ua64a9c34">
    </p>
    <p id="u41ebf22b">
     &lt;3&gt;查看当前使用的版本（system 代表当前系统的python 版本）
    </p>
    <p id="u34bd8ccc">
    </p>
    <p id="u7ae31f1f">
     pyenv version
    </p>
    <p id="u2e1ddf37">
     system (set by /root/.pyenv/version)
    </p>
    <p id="uecb51703">
    </p>
    <p id="u8a389f6f">
     4.切换python版本
    </p>
    <p id="uc00adb74">
     pyenv global 3.6.4
    </p>
    <p id="ucb4a51c4">
    </p>
    <p id="u8637b6c2">
     pyenv version
    </p>
    <p id="uc20f267c">
     3.6.4 (set by /root/.pyenv/version)
    </p>
    <p id="uc9c96141">
    </p>
    <p id="ud3abb81f">
     pyenv versions
    </p>
    <p id="u201ec1ac">
     system
    </p>
    <p id="u879db462">
     2.7.13
    </p>
    <p id="u13f3ac37">
     * 3.6.4 (set by /root/.pyenv/version)
    </p>
    <p id="ubf6f5fc5">
    </p>
    <p id="u261523c6">
     创建虚拟python环境
    </p>
    <p id="u8a8bf1e5">
     1.安装插件
    </p>
    <p id="uaee66403">
    </p>
    <p id="uaa8eb271">
     创建虚拟的python环境需要pyenv-virtualenv的插件，试着pyenv virtual补全一下，如果存在无需安装
    </p>
    <p id="ue2c08c32">
    </p>
    <p id="u615f436a">
     如果不存在，执行如下操作
    </p>
    <p id="ued7456e0">
     git clone
     <a href="https://github.com/yyuu/pyenv-virtualenv.git" title="GitHub - pyenv/pyenv-virtualenv: a pyenv plugin to manage virtualenv (a.k.a. python-virtualenv)">
      GitHub - pyenv/pyenv-virtualenv: a pyenv plugin to manage virtualenv (a.k.a. python-virtualenv)
     </a>
     ~/.pyenv/plugins/pyenv-virtualenv
    </p>
    <p id="uba0fcac0">
     echo ‘eval “$(pyenv virtualenv-init -)”’ &gt;&gt; ~/.bash_profile
    </p>
    <p id="u4f2c2d79">
     source ~/.bash_profile
    </p>
    <p id="uab1dfdb8">
    </p>
    <p id="u6ba5c026">
     2.创建虚拟环境
    </p>
    <p id="u9ae99c9f">
     pyenv virtualenv 2.7.13 env2713
    </p>
    <p id="ube0a6a0b">
    </p>
    <p id="u4e91cdbb">
     这是创建了一个名为env2713的python虚拟环境，这个环境的目录位于：~/.pyenv/versions/
    </p>
    <p id="u5a438352">
    </p>
    <p id="ud3ad7d42">
     3.查看python版本
    </p>
    <p id="uc0028277">
    </p>
    <p id="ubbef0709">
     pyenv versions
    </p>
    <p id="u73499d82">
     * system (set by /root/.pyenv/version)
    </p>
    <p id="u4d2f88f9">
     2.7.13
    </p>
    <p id="ue41a8bf3">
     2.7.13/envs/env2713
    </p>
    <p id="u94dcd846">
     3.6.4
    </p>
    <p id="u96670f89">
     3.6.4/envs/env364
    </p>
    <p id="ud4ddbeed">
     env2713
    </p>
    <p id="ucf511432">
     env364
    </p>
    <p id="uedded680">
    </p>
    <p id="uac29292f">
     使用python虚拟环境
    </p>
    <p id="u2a6306f0">
     1.使用虚拟环境
    </p>
    <p id="u3918bb6b">
    </p>
    <p id="u7b5f4434">
     [xxx]#pyenv activate env364
    </p>
    <p id="uebccd6a8">
     pyenv-virtualenv: prompt changing will be removed from future release. configure `export PYENV_VIRTUALENV_DISABLE_PROMPT=1’ to simulate the behavior.v364)
    </p>
    <p id="u755f7c0d">
    </p>
    <p id="u4860bd69">
     [xxx]# python
    </p>
    <p id="u0cf62690">
     Python 3.6.4 (default, Apr 19 2018, 10:35:10)
    </p>
    <p id="uf68a570a">
     [GCC 4.8.5 20150623 (Red Hat 4.8.5-16)] on linux
    </p>
    <p id="ufa675d25">
     Type “help”, “copyright”, “credits” or “license” for more information.
    </p>
    <p id="u6143a82c">
    </p>
    <p id="u330a36ed">
     2.退出虚拟环境
    </p>
    <p id="u50eaca8d">
    </p>
    <p id="uaa4d50e5">
     pyenv deactivate
    </p>
    <p id="u9d54d6c1">
    </p>
    <p id="u7a43a835">
     3.环境迁移
    </p>
    <p id="ue7d07d40">
     pyenv virtualenv 2.7.13 env2713
    </p>
    <p id="u7bc5ed21">
    </p>
    <p id="u4d5d0479">
     &lt;1&gt;~./pyenv/versions/下名为2.7.14的文件夹拷贝到要迁移的服务器上
    </p>
    <p id="u2ad99f82">
     &lt;2&gt;修改env364/pyvenv.cfg文件中的home路径(迁移的服务器无需安装任何东西)
    </p>
    <p id="u070818b5">
    </p>
    <p id="ueb27058e">
     [xxx env364]# cat pyvenv.cfg
    </p>
    <p id="u62f1ca9d">
     home =/root/.pyenv/versions/2.7.13/bin
    </p>
    <p id="u190c5647">
     include-system-site-packages = false
    </p>
    <p id="u2122d369">
     version = 2.7.13
    </p>
    <p id="uef1ec4fe">
    </p>
    <p id="uc0930716">
     注意事项
    </p>
    <p id="u853fba03">
     1.在使用环境的时候不要用sudo,否则就变成使用全局环境了（例如安装django,直接pip install django就行了,不要用sudo pip install. ）
    </p>
    <p id="ua82e6e0a">
    </p>
    <p id="u7588c059">
     2.迁移时，python3由于依赖于相对高一点的glibc库，要注意迁移与被迁移服务器的glibc的版本问题，版本不同时还需要手动安装,更新时注意
    </p>
    <p id="uf7cd91da">
     (glibc是GNU发布的libc库，即c运行库;glibc是linux系统中最底层的api，几乎其它任何运行库都会依赖于glibclinux系统的依赖)
    </p>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f:2f626c6f672e6373646e2e6e65742f70656e6737383538352f:61727469636c652f64657461696c732f313331373637383831" class_="artid" style="display:none">
 </p>
</div>


