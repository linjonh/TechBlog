---
layout: post
title: "评估方法-从样例数据集中产生训练集和测试集"
date: 2023-02-12 12:20:45 +0800
description: "从样例数据集中产生训练集和测试集的几种常见做法。留出法直接将数据集D划分为两个互斥的集合，其中一个集"
keywords: "能根据数据集得出训练集和测试集吗"
categories: ['机器学习']
tags: ['无标签']
artid: "105502108"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=105502108
    alt: "评估方法-从样例数据集中产生训练集和测试集"
render_with_liquid: false
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     评估方法--从样例数据集中产生训练集和测试集
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
     从样例数据集中产生训练集和测试集的几种常见做法。
    </p>
    <h2>
     <a id="_2">
     </a>
     留出法
    </h2>
    <p>
     直接将数据集
     <em>
      D
     </em>
     划分为两个互斥的集合，其中一个集合做训练集
     <em>
      S
     </em>
     ，另一个做测试集
     <em>
      T
     </em>
     。
    </p>
    <p>
     从采样的角度来看待数据集的划分过程，保留类别比例的采样方式通常称为
     <strong>
      分层采样
     </strong>
     。
    </p>
    <p>
     给定训练/测试集的比例后，对数据集
     <em>
      D
     </em>
     的分割方式有很多种，不同的划分导致不同的训练/测试集，模型评估的结果也会有差别。单次留出法不够稳定，一般采用多次随机划分，重复进行实验评估后取平均作为留出法的评估结果。常见的做法是将大约2/3~4/5的样本用于训练，其余用于测试。
     <strong>
      测试集至少应有30个样例。
     </strong>
    </p>
    <pre><code class="prism language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_split
x <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token builtin">round</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
y <span class="token operator">=</span> np<span class="token punctuation">.</span>around<span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
X_train<span class="token punctuation">,</span> X_test<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> y_test <span class="token operator">=</span> train_test_split<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> test_size<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>y<span class="token punctuation">[</span>y<span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>size <span class="token operator">/</span> y<span class="token punctuation">.</span>size<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>y_train<span class="token punctuation">[</span>y_train<span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>size <span class="token operator">/</span> y_train<span class="token punctuation">.</span>size<span class="token punctuation">)</span>
</code></pre>
    <p>
     划分的训练集的正负比例跟训练数据中正负数据的比例一致。但是也存在比例不一致的时候，比如上面训练集和测试集数量之比是4 : 1， 标记中某一类数量不能划分成5份时，比例会不一致。
    </p>
    <h2>
     <a id="_22">
     </a>
     交叉验证法
    </h2>
    <p>
     先将数据集
     <em>
      D
     </em>
     划分成
     <em>
      k
     </em>
     个大小相似的互斥子集，即
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        D 
        
       
         = 
        
        
        
          D 
         
        
          1 
         
        
       
         ∪ 
        
        
        
          D 
         
        
          2 
         
        
       
         ∪ 
        
       
           
        
       
         . 
        
       
         . 
        
       
         . 
        
       
           
        
       
         ∪ 
        
        
        
          D 
         
        
          k 
         
        
       
         , 
        
       
           
        
        
        
          D 
         
        
          i 
         
        
       
         ∩ 
        
        
        
          D 
         
        
          j 
         
        
       
         = 
        
       
         ∅ 
        
       
         ( 
        
       
         i 
        
       
         ≠ 
        
       
         j 
        
       
         ) 
        
       
      
        D = D_1 \cup D_2 \cup \ ...\ \cup D_k,\ D_i \cap D_j = \varnothing(i \ne j)
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.68333em; vertical-align: 0em;">
         </span>
         <span class="mord mathdefault" style="margin-right: 0.02778em;">
          D
         </span>
         <span class="mspace" style="margin-right: 0.277778em;">
         </span>
         <span class="mrel">
          =
         </span>
         <span class="mspace" style="margin-right: 0.277778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.83333em; vertical-align: -0.15em;">
         </span>
         <span class="mord">
          <span class="mord mathdefault" style="margin-right: 0.02778em;">
           D
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.301108em;">
              <span class="" style="top: -2.55em; margin-left: -0.02778em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 1
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.15em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.222222em;">
         </span>
         <span class="mbin">
          ∪
         </span>
         <span class="mspace" style="margin-right: 0.222222em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.83333em; vertical-align: -0.15em;">
         </span>
         <span class="mord">
          <span class="mord mathdefault" style="margin-right: 0.02778em;">
           D
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.301108em;">
              <span class="" style="top: -2.55em; margin-left: -0.02778em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 2
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.15em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.222222em;">
         </span>
         <span class="mbin">
          ∪
         </span>
         <span class="mspace" style="margin-right: 0.222222em;">
         </span>
         <span class="mspace">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.55556em; vertical-align: 0em;">
         </span>
         <span class="mord">
          .
         </span>
         <span class="mord">
          .
         </span>
         <span class="mord">
          .
         </span>
         <span class="mspace" style="margin-right: 0.222222em;">
         </span>
         <span class="mspace">
         </span>
         <span class="mbin">
          ∪
         </span>
         <span class="mspace" style="margin-right: 0.222222em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.87777em; vertical-align: -0.19444em;">
         </span>
         <span class="mord">
          <span class="mord mathdefault" style="margin-right: 0.02778em;">
           D
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.336108em;">
              <span class="" style="top: -2.55em; margin-left: -0.02778em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mathdefault mtight" style="margin-right: 0.03148em;">
                 k
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.15em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mpunct">
          ,
         </span>
         <span class="mspace" style="margin-right: 0.166667em;">
         </span>
         <span class="mspace">
         </span>
         <span class="mord">
          <span class="mord mathdefault" style="margin-right: 0.02778em;">
           D
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.311664em;">
              <span class="" style="top: -2.55em; margin-left: -0.02778em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mathdefault mtight">
                 i
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.15em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.222222em;">
         </span>
         <span class="mbin">
          ∩
         </span>
         <span class="mspace" style="margin-right: 0.222222em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;">
         </span>
         <span class="mord">
          <span class="mord mathdefault" style="margin-right: 0.02778em;">
           D
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.311664em;">
              <span class="" style="top: -2.55em; margin-left: -0.02778em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mathdefault mtight" style="margin-right: 0.05724em;">
                 j
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.286108em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.277778em;">
         </span>
         <span class="mrel">
          =
         </span>
         <span class="mspace" style="margin-right: 0.277778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mord amsrm">
          ∅
         </span>
         <span class="mopen">
          (
         </span>
         <span class="mord mathdefault">
          i
         </span>
         <span class="mspace" style="margin-right: 0.277778em;">
         </span>
         <span class="mrel">
          <span class="mrel">
           <span class="mord">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.69444em;">
               <span class="" style="top: -3em;">
                <span class="pstrut" style="height: 3em;">
                </span>
                <span class="rlap">
                 <span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;">
                 </span>
                 <span class="inner">
                  <span class="mrel">
                   
                  </span>
                 </span>
                 <span class="fix">
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               ​
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.19444em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mrel">
           =
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.277778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mord mathdefault" style="margin-right: 0.05724em;">
          j
         </span>
         <span class="mclose">
          )
         </span>
        </span>
       </span>
      </span>
     </span>
     。 每个子集
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        D 
         
        
          i 
         
        
       
      
        D_i
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.83333em; vertical-align: -0.15em;">
         </span>
         <span class="mord">
          <span class="mord mathdefault" style="margin-right: 0.02778em;">
           D
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.311664em;">
              <span class="" style="top: -2.55em; margin-left: -0.02778em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mathdefault mtight">
                 i
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.15em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     都尽可能保持数据分布的一致性。然后每次用
     <em>
      k-1
     </em>
     个子集作为训练集，余下的那个子集作为测试集，这样就可以进行
     <em>
      k
     </em>
     次训练和测试，最终返回
     <em>
      k
     </em>
     个结果的均值。也称为
     <strong>
      <em>
       k
      </em>
      折交叉验证
     </strong>
     。
    </p>
    <p>
     当
     <em>
      k
     </em>
     等于样本的数量时，就变成了
     <strong>
      留一法（Leave-One-Out, 简称LOO）
     </strong>
     ，留一法不受划分方式的影响，因为
     <em>
      m
     </em>
     个样本只有唯一的方式划分为
     <em>
      m
     </em>
     个子集。留一法的训练时计算开销很大，有多少样本就要训练多少个模型。
    </p>
    <pre><code class="prism language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> StratifiedKFold
X <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token builtin">round</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
y <span class="token operator">=</span> np<span class="token punctuation">.</span>around<span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
skf <span class="token operator">=</span> StratifiedKFold<span class="token punctuation">(</span>n_splits<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>y<span class="token punctuation">[</span>y<span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>size <span class="token operator">/</span> y<span class="token punctuation">.</span>size<span class="token punctuation">)</span>
<span class="token keyword">for</span> train_index<span class="token punctuation">,</span> test_index <span class="token keyword">in</span> skf<span class="token punctuation">.</span>split<span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"TRAIN:"</span><span class="token punctuation">,</span> train_index<span class="token punctuation">,</span> <span class="token string">"TEST:"</span><span class="token punctuation">,</span> test_index<span class="token punctuation">)</span>
    X_train<span class="token punctuation">,</span> X_test <span class="token operator">=</span> X<span class="token punctuation">[</span>train_index<span class="token punctuation">]</span><span class="token punctuation">,</span> X<span class="token punctuation">[</span>test_index<span class="token punctuation">]</span>
    y_train<span class="token punctuation">,</span> y_test <span class="token operator">=</span> y<span class="token punctuation">[</span>train_index<span class="token punctuation">]</span><span class="token punctuation">,</span> y<span class="token punctuation">[</span>test_index<span class="token punctuation">]</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> X_test<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> y_test<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>y_train<span class="token punctuation">[</span>y_train<span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>size <span class="token operator">/</span> y_train<span class="token punctuation">.</span>size<span class="token punctuation">)</span>
</code></pre>
    <p>
     同样样本数量能被折数整除，但是样本某一类标记的数量不能被折数整除是，也会出现比例不一致的情况。
    </p>
    <p>
     另外，
     <a href="https://scikit-learn.org/stable/modules/classes.html#module-sklearn.model_selection" rel="nofollow">
      <code>
       sklearn.model_selection
      </code>
     </a>
     还提供了多种其他的交叉验证的训练数据的划分方法。比如留一法是LeaveOneOut
    </p>
    <h2>
     <a id="_47">
     </a>
     自助法
    </h2>
    <p>
     留出法和交叉验证法保留了一部分样本用于测试，实际评估的模型所使用的训练集比
     <em>
      D
     </em>
     小。
    </p>
    <p>
     自助法（boostrapping)直接以
     <strong>
      自助采样法
     </strong>
     （boostrap sampling）为基础，给定包含
     <em>
      m
     </em>
     个样本的数据集
     <em>
      D
     </em>
     ，对它进行采样产生数据集
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        D 
         
        
          ′ 
         
        
       
      
        D^ \prime
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.751892em; vertical-align: 0em;">
         </span>
         <span class="mord">
          <span class="mord mathdefault" style="margin-right: 0.02778em;">
           D
          </span>
          <span class="msupsub">
           <span class="vlist-t">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.751892em;">
              <span class="" style="top: -3.063em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 ′
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     : 每次随机从
     <em>
      D
     </em>
     中挑选一个样本，将其拷贝放入
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        D 
         
        
          ′ 
         
        
       
      
        D^ \prime
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.751892em; vertical-align: 0em;">
         </span>
         <span class="mord">
          <span class="mord mathdefault" style="margin-right: 0.02778em;">
           D
          </span>
          <span class="msupsub">
           <span class="vlist-t">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.751892em;">
              <span class="" style="top: -3.063em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 ′
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     ，然后再将样本放回初始数据集
     <em>
      D
     </em>
     中，这个过程重复
     <em>
      m
     </em>
     次，就得到了包含
     <em>
      m
     </em>
     个样本的数据集
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        D 
         
        
          ′ 
         
        
       
      
        D^ \prime
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.751892em; vertical-align: 0em;">
         </span>
         <span class="mord">
          <span class="mord mathdefault" style="margin-right: 0.02778em;">
           D
          </span>
          <span class="msupsub">
           <span class="vlist-t">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.751892em;">
              <span class="" style="top: -3.063em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 ′
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     。显然D中有一部分样本在
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        D 
         
        
          ′ 
         
        
       
      
        D^ \prime
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.751892em; vertical-align: 0em;">
         </span>
         <span class="mord">
          <span class="mord mathdefault" style="margin-right: 0.02778em;">
           D
          </span>
          <span class="msupsub">
           <span class="vlist-t">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.751892em;">
              <span class="" style="top: -3.063em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 ′
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     中多次出现，而另一部分样本不出现，样本在m次采样中始终不被采到的概率是
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        1 
        
       
         − 
        
        
        
          1 
         
        
          m 
         
        
       
      
        1- \frac {1}{m}
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.72777em; vertical-align: -0.08333em;">
         </span>
         <span class="mord">
          1
         </span>
         <span class="mspace" style="margin-right: 0.222222em;">
         </span>
         <span class="mbin">
          −
         </span>
         <span class="mspace" style="margin-right: 0.222222em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 1.19011em; vertical-align: -0.345em;">
         </span>
         <span class="mord">
          <span class="mopen nulldelimiter">
          </span>
          <span class="mfrac">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.845108em;">
              <span class="" style="top: -2.655em;">
               <span class="pstrut" style="height: 3em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathdefault mtight">
                  m
                 </span>
                </span>
               </span>
              </span>
              <span class="" style="top: -3.23em;">
               <span class="pstrut" style="height: 3em;">
               </span>
               <span class="frac-line" style="border-bottom-width: 0.04em;">
               </span>
              </span>
              <span class="" style="top: -3.394em;">
               <span class="pstrut" style="height: 3em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mtight">
                  1
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.345em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mclose nulldelimiter">
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     , 取极限得到
     <br/>
     <span class="katex--display">
      <span class="katex-display">
       <span class="katex">
        <span class="katex-mathml">
         lim 
           
          
            ⁡ 
           
          
          
          
            m 
           
          
            → 
           
          
            ∞ 
           
          
         
        
          ( 
         
        
          1 
         
        
          − 
         
         
         
           1 
          
         
           m 
          
         
         
         
           ) 
          
         
           2 
          
         
        
          = 
         
         
         
           1 
          
         
           e 
          
         
        
          ≈ 
         
        
          0.368 
         
        
       
         \lim_{m \to \infty} (1 - \frac{1}{m})^2 = \frac{1}{e} \approx 0.368
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 1.45em; vertical-align: -0.7em;">
          </span>
          <span class="mop op-limits">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.69444em;">
              <span class="" style="top: -2.1em; margin-left: 0em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathdefault mtight">
                  m
                 </span>
                 <span class="mrel mtight">
                  →
                 </span>
                 <span class="mord mtight">
                  ∞
                 </span>
                </span>
               </span>
              </span>
              <span class="" style="top: -2.7em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="">
                <span class="mop">
                 lim
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.7em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mopen">
           (
          </span>
          <span class="mord">
           1
          </span>
          <span class="mspace" style="margin-right: 0.222222em;">
          </span>
          <span class="mbin">
           −
          </span>
          <span class="mspace" style="margin-right: 0.222222em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 2.00744em; vertical-align: -0.686em;">
          </span>
          <span class="mord">
           <span class="mopen nulldelimiter">
           </span>
           <span class="mfrac">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 1.32144em;">
               <span class="" style="top: -2.314em;">
                <span class="pstrut" style="height: 3em;">
                </span>
                <span class="mord">
                 <span class="mord mathdefault">
                  m
                 </span>
                </span>
               </span>
               <span class="" style="top: -3.23em;">
                <span class="pstrut" style="height: 3em;">
                </span>
                <span class="frac-line" style="border-bottom-width: 0.04em;">
                </span>
               </span>
               <span class="" style="top: -3.677em;">
                <span class="pstrut" style="height: 3em;">
                </span>
                <span class="mord">
                 <span class="mord">
                  1
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               ​
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.686em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
           <span class="mclose nulldelimiter">
           </span>
          </span>
          <span class="mclose">
           <span class="mclose">
            )
           </span>
           <span class="msupsub">
            <span class="vlist-t">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.864108em;">
               <span class="" style="top: -3.113em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  2
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mspace" style="margin-right: 0.277778em;">
          </span>
          <span class="mrel">
           =
          </span>
          <span class="mspace" style="margin-right: 0.277778em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 2.00744em; vertical-align: -0.686em;">
          </span>
          <span class="mord">
           <span class="mopen nulldelimiter">
           </span>
           <span class="mfrac">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 1.32144em;">
               <span class="" style="top: -2.314em;">
                <span class="pstrut" style="height: 3em;">
                </span>
                <span class="mord">
                 <span class="mord mathdefault">
                  e
                 </span>
                </span>
               </span>
               <span class="" style="top: -3.23em;">
                <span class="pstrut" style="height: 3em;">
                </span>
                <span class="frac-line" style="border-bottom-width: 0.04em;">
                </span>
               </span>
               <span class="" style="top: -3.677em;">
                <span class="pstrut" style="height: 3em;">
                </span>
                <span class="mord">
                 <span class="mord">
                  1
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               ​
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.686em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
           <span class="mclose nulldelimiter">
           </span>
          </span>
          <span class="mspace" style="margin-right: 0.277778em;">
          </span>
          <span class="mrel">
           ≈
          </span>
          <span class="mspace" style="margin-right: 0.277778em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 0.64444em; vertical-align: 0em;">
          </span>
          <span class="mord">
           0
          </span>
          <span class="mord">
           .
          </span>
          <span class="mord">
           3
          </span>
          <span class="mord">
           6
          </span>
          <span class="mord">
           8
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     <br/>
     即通过自助采样，初始数据集
     <em>
      D
     </em>
     中约有36.8%的样本没有出现在数据集
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        D 
         
        
          ′ 
         
        
       
      
        D^ \prime
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.751892em; vertical-align: 0em;">
         </span>
         <span class="mord">
          <span class="mord mathdefault" style="margin-right: 0.02778em;">
           D
          </span>
          <span class="msupsub">
           <span class="vlist-t">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.751892em;">
              <span class="" style="top: -3.063em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 ′
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     中。
    </p>
    <p>
     实际评估的模型与期望评估的模型都使用
     <em>
      m
     </em>
     个训练样本，而仍有数据总量约1/3的，没在训练集中出现的样本用于测试，这样的结果称为
     <strong>
      包外估计（out-of-bag estimate)
     </strong>
     。
    </p>
    <p>
     自助法在数据集较小，难以有效划分训练/测试集时很有用；但是
     <strong>
      自助法改变了初始数据集的分布
     </strong>
     ，会引入估计偏差。因此在数据量足够时，其他两种方法更合适。
    </p>
    <pre><code class="prism language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
x <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token builtin">round</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
y <span class="token operator">=</span> np<span class="token punctuation">.</span>around<span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
index <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">.</span>sample<span class="token punctuation">(</span>frac<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> replace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>index<span class="token punctuation">.</span>values
x_train <span class="token operator">=</span> x<span class="token punctuation">[</span>index<span class="token punctuation">]</span>
y_train <span class="token operator">=</span> y<span class="token punctuation">[</span>index<span class="token punctuation">]</span>
</code></pre>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f:2f626c6f672e6373646e2e6e65742f73756e67686f7374732f:61727469636c652f64657461696c732f313035353032313038" class_="artid" style="display:none">
 </p>
</div>


