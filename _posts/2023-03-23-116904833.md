---
layout: post
title: "修改前端表单post提交时最大长度限制"
date: 2023-03-23 17:50:55 +0800
description: "问题出现的背景：做excel导出时，使用post请求发现前台传递的数小于200kb可以导出去，如果大"
keywords: "jerry7中配置maxformcontentsize"
categories: ['日常随笔']
tags: ['Tomcat', 'Jetty']
artid: "116904833"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=116904833
    alt: "修改前端表单post提交时最大长度限制"
render_with_liquid: false
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     修改前端表单post提交时最大长度限制
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
     问题出现的背景：
     <strong>
      做excel导出时，使用post请求发现前台传递的数小于200kb可以导出去，如果大于200kb,则会在请求时报400错误，无法将将请求传递到后端。
     </strong>
    </p>
    <blockquote>
     <p>
      原因：对于我们常用的WEB服务器，前端表单提交数据传给后端时参数的大小是有限制的
     </p>
    </blockquote>
    <p>
     下面我将分别举例进行说明（
     <strong>
      默认单位是KB
     </strong>
     ）：Jetty、Tomcat
    </p>
    <h3>
     <a id="Jetty_5">
     </a>
     Jetty
    </h3>
    <ol>
     <li>
      报错：**Caused by: java.lang.IllegalStateException: Form is larger than max length 200000 idea jetty **
     </li>
     <li>
      原因及解决方式
      <br/>
      原因就是Jetty默认的对于前端传递参数的设置大小是200kb,超过了会报400错误，且无法调用后端接口
      <br/>
      <strong>
       方法一：
      </strong>
      <br/>
      <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/b834abf9807f5efec8f4b77ae5dd83f2.png">
       <br/>
       方法二：
       <br/>
       在WEB-INF目录下的jetty-web.xml文件中，加入如下设置
      </img>
     </li>
    </ol>
    <pre><code class="prism language-xml"><span class="token prolog">&lt;?xml version="1.0"?&gt;</span>  
<span class="token doctype">&lt;!DOCTYPE Configure PUBLIC "-//Mort Bay Consulting//DTD Configure//EN" "http://jetty.mortbay.org/configure.dtd"&gt;</span>  
<span class="token comment">&lt;!--Jetty6设置--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Configure</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>WebAppContext<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>org.mortbay.jetty.webapp.WebAppContext<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>  
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Set</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>maxFormContentSize<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>int<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>-1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Set</span><span class="token punctuation">&gt;</span></span>  
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Configure</span><span class="token punctuation">&gt;</span></span> 

<span class="token comment">&lt;!--Jetty7设置--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Configure</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>WebAppContext<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>org.eclipse.jetty.webapp.WebAppContext<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>  
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Set</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>maxFormContentSize<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>int<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>-1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Set</span><span class="token punctuation">&gt;</span></span>  
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Configure</span><span class="token punctuation">&gt;</span></span> 

<span class="token comment">&lt;!--Jetty9设置--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Call</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>setAttribute<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Arg</span><span class="token punctuation">&gt;</span></span>org.eclipse.jetty.server.Request.maxFormContentSize<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Arg</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Arg</span><span class="token punctuation">&gt;</span></span>-1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Arg</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Call</span><span class="token punctuation">&gt;</span></span>

</code></pre>
    <p>
     (即对maxFormContentSize重新赋值，-1表示不限制，正数值表示所允许的最大bytes):
    </p>
    <h3>
     <a id="Tomcat_36">
     </a>
     Tomcat
    </h3>
    <p>
     针对以上的问题，我则顺便查了下Tomcat，他的默认值是:
     <strong>
      maxPostSize=“2097152”
     </strong>
     (也就是2M的大小)
     <br/>
     解决方式：
    </p>
    <blockquote>
     <p>
      在tomcat
      <br/>
      的TOMCAT_HOME/conf/server.xml中添加一行：
      <br/>
      找到里面的Connector节点，在该节点中添加"maxPostSize"属性，将该属性值设置成你想要的最大值（单位：byte，-1表示不限制（谨慎使用，服务器压力会太大）
     </p>
    </blockquote>
    <p>
     <a href="https://www.cnblogs.com/tongcc/p/13996216.html" rel="nofollow">
      Tomcat常见参数设置
     </a>
     <br/>
     &lt;Connector connectionTimeout=“20000” port=“8089” protocol=“HTTP/1.1” redirectPort=“8443”
    </p>
    <p>
     maxPostSize=“10485760”/&gt;
    </p>
    <h3>
     <a id="BES_48">
     </a>
     BES
    </h3>
    <blockquote>
     <p>
      BES: 默认限制为2097152bytes(2MB). 修改默认限制值的方法如下：
      <br/>
      通过BES控制台进行设置：独立实例-&gt;WEB容器-&gt;自定义属性 里添加 maxPostSize 属性（单位：KB，0表示不限制）。
     </p>
    </blockquote>
    <h3>
     <a id="Weblogic_53">
     </a>
     Weblogic
    </h3>
    <p>
     这个服务器一般生产中用的应该都比较多，但是此次我并没有找到该服务器对该值的相关设置，且将我原本报错的代码放在Weblogic上面也没出现问题，具体欢迎各位到老留言
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f71715f34333035303037372f:61727469636c652f64657461696c732f313136393034383333" class_="artid" style="display:none">
 </p>
</div>


