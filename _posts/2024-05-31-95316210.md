---
layout: post
title: "单机游戏存档修改"
date: 2024-05-31 16:30:00 +0800
description: "背景介绍：游戏是仙剑一，剧情在打苗疆三人组之前，目的是修改李逍遥属性从而可以秒杀苗疆三人组的头领。进"
keywords: "单机游戏存档修改"
categories: ['']
tags: ['数据库', 'Java']
artid: "95316210"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=95316210
    alt: "单机游戏存档修改"
render_with_liquid: false
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     单机游戏存档修改
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <div class="blogpost-body cnblogs-markdown" id="cnblogs_post_body">
     <p>
      背景介绍：游戏是仙剑一，剧情在打苗疆三人组之前，目的是修改李逍遥属性从而可以秒杀苗疆三人组的头领。
     </p>
     <p>
      进入原始存档(存档文件名为1.rpg，位于游戏根目录下)，查看李逍遥原始属性，如下图所示：
      <br/>
      <img alt="956741-20170301201805204-2102894768.jpg" src="https://i-blog.csdnimg.cn/blog_migrate/7b471fe6adbeabeac399aa787ac5f363.jpeg"/>
     </p>
     <p>
      去后山打怪升级。打了一组树怪后，李逍遥属性升级，如下图所示：
      <br/>
      <img alt="956741-20170301201817516-512743787.jpg" src="https://i-blog.csdnimg.cn/blog_migrate/3f784e0945366f23e912bc35282712c6.jpeg"/>
     </p>
     <p>
      存一个新档(存档文件名为2.rpg)。为了尽量减少存档之间的变化，存档前回到原场景（客栈门前）。备份1.rpg和2.rpg两个存档文件。用VBinDiff（开源工具，网址https://www.cjmweb.net/vbindiff/）对比两个存档文件，把他们复制到VBinDiff文件夹下，然后用cmd运行VBinDiff：
      <br/>
      <img alt="956741-20170301202231845-724408828.jpg" src="https://i-blog.csdnimg.cn/blog_migrate/bc2a9555fe8aa949461e6feb876b790a.jpeg"/>
     </p>
     <p>
      效果如图所示，按Enter键遍历所有有区别的地方：
      <br/>
      <img alt="956741-20170301202218235-578483381.jpg" src="https://i-blog.csdnimg.cn/blog_migrate/d80963f64629edef3d6bf9838e757a1e.jpeg"/>
     </p>
     <p>
      遍历一遍之后，发现两个存档文件共有7块发生不同的区域，其中许多地方是flag性质的改变（例如FF变为01，00变成0A），推测他们是一些与属性无关的变化（例如存档时的坐标、树怪被消灭后是否刷新的标记、存档时间等），最像属性改变的区域(可以目测出是数值发生了少许增加)，发生在：
      <br/>
      <img alt="956741-20170301202315454-1824837665.jpg" src="https://i-blog.csdnimg.cn/blog_migrate/c21d7d2b305084c0867b36dc3e46c05e.jpeg"/>
     </p>
     <p>
      虽然VBinDiff支持直接修改文件内容，但是为了以后使用方便，还是人工记下偏移地址和对应的变化：
     </p>
     <table>
      <thead>
       <tr class="header">
        <th>
         地址
        </th>
        <th>
         十六进制变化
        </th>
        <th>
         十进制变化
        </th>
        <th>
         推测属性
        </th>
       </tr>
      </thead>
      <tbody>
       <tr class="odd">
        <td>
         0244
        </td>
        <td>
         02-&gt;03
        </td>
        <td>
         2-&gt;3
        </td>
        <td>
         修行
        </td>
       </tr>
       <tr class="even">
        <td>
         0250
        </td>
        <td>
         AA-&gt;B6
        </td>
        <td>
         170-&gt;182
        </td>
        <td>
         体力上限
        </td>
       </tr>
       <tr class="odd">
        <td>
         025C
        </td>
        <td>
         6C-&gt;74
        </td>
        <td>
         108-&gt;116
        </td>
        <td>
         真气上限
        </td>
       </tr>
       <tr class="even">
        <td>
         0268
        </td>
        <td>
         99-&gt;B6
        </td>
        <td>
         153-&gt;182
        </td>
        <td>
         当前体力
        </td>
       </tr>
       <tr class="odd">
        <td>
         0274
        </td>
        <td>
         6C-&gt;74
        </td>
        <td>
         108-&gt;116
        </td>
        <td>
         当前真气
        </td>
       </tr>
       <tr class="even">
        <td>
         02C8
        </td>
        <td>
         26-&gt;2B
        </td>
        <td>
         38-&gt;43
        </td>
        <td>
         武术(疑似，-2)
        </td>
       </tr>
       <tr class="odd">
        <td>
         02D4
        </td>
        <td>
         19-&gt;1E
        </td>
        <td>
         25-&gt;30
        </td>
        <td>
         灵力
        </td>
       </tr>
       <tr class="even">
        <td>
         02E0
        </td>
        <td>
         24-&gt;26
        </td>
        <td>
         36-&gt;38
        </td>
        <td>
         防御(疑似，-9)
        </td>
       </tr>
       <tr class="odd">
        <td>
         02EC
        </td>
        <td>
         20-&gt;23
        </td>
        <td>
         32-&gt;35
        </td>
        <td>
         身法
        </td>
       </tr>
       <tr class="even">
        <td>
         02F8
        </td>
        <td>
         22-&gt;24
        </td>
        <td>
         34-&gt;36
        </td>
        <td>
         吉运
        </td>
       </tr>
      </tbody>
     </table>
     <blockquote>
      <p>
       其中武术和防御的偏差，应该是人物装备的影响，推测李逍遥的桃木剑+2武术，他的一身装备+9防御。
      </p>
     </blockquote>
     <p>
      为了秒杀BOSS，我们只需要修改武术。从数据的外表看，属性只占2个字节，推测属性值的类型应该是无符号短整型(unsigned short int)，则最大值是0xFFFF。
     </p>
     <p>
      回到仙剑目录，用WinHex修改存档文件2(2.rpg)的偏移地址02C8处为FFFF:
      <br/>
      <img alt="956741-20170301202334579-482973958.jpg" src="https://i-blog.csdnimg.cn/blog_migrate/ac8855a3e96a2b6ca0a573ca11a46de1.jpeg"/>
     </p>
     <p>
      保存后重新进入游戏读取存档2。发现武力值变为1了，进入boss战发现攻击力很低，这应该是由于基础武力加上装备加成，造成了最终武力值的进位（溢出）。考虑到装备的+2武力，修改基础武力为0xFFFD,试图达到最终武力的最大值：
      <br/>
      <img alt="956741-20170301202358548-254902586.jpg" src="https://i-blog.csdnimg.cn/blog_migrate/60db63d6679e98cd3027c3401d764467.jpeg"/>
     </p>
     <p>
      重新进入游戏，发现李逍遥的武力为5535,推测真实值应该是65535，而游戏只显示了后4位数:
      <br/>
      <img alt="956741-20170301202415360-224796511.jpg" src="https://i-blog.csdnimg.cn/blog_migrate/ecc7a6241c0c0c2707819daf55a542af.jpeg"/>
     </p>
     <p>
      进入客栈的boss战，一刀砍出22348（boss的总血量），秒杀boss。
      <br/>
      <img alt="956741-20170301202522688-810908131.png" src="https://i-blog.csdnimg.cn/blog_migrate/6dd25c505e8e1426baf4a30c66930ed8.png"/>
     </p>
     <p>
      存档修改成功！金钱，物品数量的修改都可以使用这个对比存档文件的方法。如果想做存档修改器的话，可以根据上面列表中的偏移地址做一个小工具。
     </p>
    </div>
    <p>
     转载于:https://www.cnblogs.com/zhugehq/p/6486085.html
    </p>
   </div>
  </div>
  <div id="recommendDown">
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f67:2e6373646e2e6e65742f77656978696e5f3330333037323637:2f61727469636c652f64657461696c732f3935333136323130" class_="artid" style="display:none">
 </p>
</div>


