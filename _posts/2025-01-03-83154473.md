---
layout: post
title: "Jmeter测试及应用-接口请求完成后,查询数据库结果,检测数据存储是否正确"
date: 2025-01-03 15:26:21 +0800
description: "Jmeter脚本逻辑\t\t发送POST请求，把数据保存到数据库中\t\t\t发讯数据库，数据库查询结果保存的"
keywords: "jmeter jdbc查询后的值检验"
categories: ['Jmeter']
tags: ['接口测试', '性能测试', 'Jmeter', 'Beanshell']
artid: "83154473"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=83154473
    alt: "Jmeter测试及应用-接口请求完成后,查询数据库结果,检测数据存储是否正确"
render_with_liquid: false
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     Jmeter测试及应用--接口请求完成后，查询数据库结果，检测数据存储是否正确
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <p>
    </p>
    <ul>
     <li>
      <h3>
       Jmeter脚本逻辑
      </h3>
     </li>
    </ul>
    <ol>
     <li>
      <p>
       发送POST请求，把数据保存到数据库中
      </p>
     </li>
     <li>
      <p>
       发讯数据库，数据库查询结果保存的变量中
      </p>
     </li>
     <li>
      <p>
       使用BeanShell判断数据库查询结果
      </p>
     </li>
    </ol>
    <ul>
     <li>
      <h3>
       <span style="color:#4f4f4f;">
        Jmeter脚本结构
       </span>
      </h3>
     </li>
    </ul>
    <ol>
     <li>
      <span style="color:#4f4f4f;">
       第一个箭头指的是JDBC Connection Configuration
      </span>
     </li>
     <li>
      <span style="color:#4f4f4f;">
       第二个箭头建立的一个普通事物控制器，方便管理不同的请求案例
      </span>
     </li>
     <li>
      <span style="color:#4f4f4f;">
       第三个箭头是一个JDBC Request
      </span>
     </li>
     <li>
      <span style="color:#4f4f4f;">
       第四个箭头是一个BeanShell的断言
      </span>
     </li>
    </ol>
    <p>
     <img alt="" class="has" height="360" src="https://i-blog.csdnimg.cn/blog_migrate/561a2ea5b7ae46982aa38d42e75557b5.jpeg" width="667"/>
    </p>
    <p>
    </p>
    <p>
     <strong>
      先讲下1-JDBC的几个重点配置：
     </strong>
    </p>
    <p>
     Variable Name for create pool：这个是连接池的配置，需要取个合适的名字，便于在sql request中使用。
    </p>
    <p>
     Database URL：这个要注意的是url前面需要加上jdbc:sqlserver（根据不同数据库而定），另外还要使用databaseName指定具体的数据库。
    </p>
    <p>
     JDBC Driver class：选择自己业务的数据库JDBC驱动，jmeter默认没有包含所有数据库提供商的jdbc驱动jar包，所以需要自己去下载，然后把下载下来的jar放到lib/ext下，重新启动jmeter加载。
    </p>
    <p>
     Username：填写数据库用户名
    </p>
    <p>
     Password：填写数据库登录密码
    </p>
    <p>
    </p>
    <p>
     <strong>
      3-JDBC-request的内容：
     </strong>
    </p>
    <p>
     <img alt="" class="has" height="419" src="https://i-blog.csdnimg.cn/blog_migrate/a326cf4e5e6aaf742393cd8c0db937c8.jpeg" width="687"/>
    </p>
    <p>
    </p>
    <p>
     这里就看到Variable Name of Pool Declare...的配置正好是前面的kingdee，所有jmeter通过jdbc执行sql的时候，会从命名叫kingdee的数据库连接池内获取已经生成好的连接进行数据库操作。
    </p>
    <p>
     Result variable name：设置用来保存从数据库获取的值，会以key=value的字符串格式保存。
    </p>
    <p>
     查询完成后，使用BeanShell断言，判断查询的值是不是期望的值：
    </p>
    <p>
     <img alt="" class="has" height="278" src="https://i-blog.csdnimg.cn/blog_migrate/046bc4ad6aebae7bf1ecf414b352787e.png" width="689"/>
    </p>
    <p>
    </p>
    <p>
     获取result中的值，然后使用indexOf方法判断是否存在期望的值，如果不存在，就设置Failure=true，同输出失败信息FailureMessage。
    </p>
    <p>
    </p>
    <p>
    </p>
    <p>
    </p>
   </div>
  </div>
 </article>
 <p alt="687474:70733a2f2f626c6f672e6373646e2e6e65742f6e6974696275:2f61727469636c652f64657461696c732f3833313534343733" class_="artid" style="display:none">
 </p>
</div>


