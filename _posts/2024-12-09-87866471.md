---
layout: post
title: "音视频入门音视频基础"
date: 2024-12-09 19:43:14 +0800
description: "直播产品的种类：泛娱乐化直播：       花椒，映客等娱乐直播， 斗鱼，熊猫，yy 等游戏直播实时"
keywords: "gop motion vector residual"
categories: ['音视频直播']
tags: ['音视频基础']
artid: "87866471"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=87866471
    alt: "音视频入门音视频基础"
render_with_liquid: false
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     音视频入门/音视频基础
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <p>
     直播产品的种类：
    </p>
    <p>
     泛娱乐化直播：
    </p>
    <p>
     花椒，映客等娱乐直播， 斗鱼，熊猫，yy 等游戏直播
    </p>
    <p>
     实时互动直播
    </p>
    <p>
     音视频会议，教育直播等， 像思科，全时，声网
    </p>
    <p>
     直播架构： todo
    </p>
    <p>
     常用的工具: ffmpeg , ffplay, flashplayer,
    </p>
    <p>
     搭建流媒体服务：
    </p>
    <p>
     准备流媒体服务器（Linux 或 Mac)
    </p>
    <p>
     编译并安装Nginx 服务
    </p>
    <p>
     配置RTMP 服务并启动 Nginx 服务
    </p>
    <p>
    </p>
    <p>
     声音三要素
    </p>
    <p>
     音调： 就是音频， 男生  &gt;  女生  &gt;  儿童
    </p>
    <p>
     音量： 振动的幅度
    </p>
    <p>
     音色： 它与材质有很大关系， 本质是谐波
    </p>
    <p>
     音量与音调
    </p>
    <p>
     图：v-9-声音三要素.jpeg
    </p>
    <p>
     <img alt="" class="has" height="584" src="https://i-blog.csdnimg.cn/blog_migrate/a025e30fc78ce9aa531cd9b176dc6fc5.jpeg" width="800"/>
    </p>
    <p>
    </p>
    <p>
     音色（音品） ： v-10-声音三要素.jpeg
    </p>
    <p>
    </p>
    <p>
     <img alt="" class="has" height="544" src="https://i-blog.csdnimg.cn/blog_migrate/d4a4ce5412a26a804417b4957fc7c102.jpeg" width="800"/>
    </p>
    <p>
    </p>
    <p>
     人类的听觉范围： 20Hz —    20kHz
    </p>
    <p>
     人类的发声范围： 85Hz ——  1100 Hz
    </p>
    <p>
    </p>
    <p>
     听觉/发声范围： v-12-声音三要素.jpeg
    </p>
    <p>
    </p>
    <p>
     <img alt="" class="has" height="477" src="https://i-blog.csdnimg.cn/blog_migrate/76456126fea3d3664e9e49ef7563c88d.jpeg" width="800"/>
    </p>
    <p>
     音频量化过程：
    </p>
    <p>
     模拟数据  —》  采样 —〉 量化 —》  编码 —〉 数字信号
    </p>
    <p>
    </p>
    <p>
     量化基本概念：
    </p>
    <p>
     采样大小： 一个采样用多少bit 存放。常用的是 16bit
    </p>
    <p>
     采样率：    采样频率 8k, 16k, 32k, 44.1k   , 48k
    </p>
    <p>
     声道数：   单声道， 双声道， 多声道
    </p>
    <p>
    </p>
    <p>
     音频量化过程： v-13-音频量化.jpeg
    </p>
    <p>
     <img alt="" class="has" height="613" src="https://i-blog.csdnimg.cn/blog_migrate/9ab52092b9a6c566eb9ae2454c3ccc29.jpeg" width="800"/>
    </p>
    <p>
    </p>
    <p>
    </p>
    <p>
     码率计算：
    </p>
    <p>
     要计算一个PCM音频流的 码率  公式如： 采样率 x 采样大小  x 声道数
    </p>
    <p>
     例如： 采样率为44.KHz,  采样大小为 16bit, 双声道的PCM 编码的WAV 文件？
    </p>
    <p>
     它的码率为 44.1K x 16 x 2 = 1411.2 kb/s
    </p>
    <p>
     音频压缩技术：
    </p>
    <p>
     目的/手段是：消除冗余数据；
    </p>
    <p>
     冗余数据包括： 人耳听觉范围外的音频信号，以及被掩蔽掉的音频 信号。
    </p>
    <p>
     信号的掩蔽分为： 频域掩蔽  和 时域掩蔽
    </p>
    <p>
     方法： 哈夫曼无损编码
    </p>
    <p>
     频域掩蔽效应： v-18-音频压缩.jpeg
    </p>
    <p>
     <img alt="" class="has" height="623" src="https://i-blog.csdnimg.cn/blog_migrate/577a941147b706c7f9eb707f63483eb5.jpeg" width="800"/>
    </p>
    <p>
     时域掩蔽效应： v-19-音频压缩.jpeg
    </p>
    <p>
     <img alt="" class="has" height="479" src="https://i-blog.csdnimg.cn/blog_migrate/36b38fd0a909d815b1e2acad2b8e305f.jpeg" width="800"/>
    </p>
    <p>
     音频编码过程：
    </p>
    <p>
     v-20-音频压缩.jpeg
    </p>
    <p>
     <img alt="" class="has" height="416" src="https://i-blog.csdnimg.cn/blog_migrate/a3aec64134f7cd1f61a5a5d07feb528b.jpeg" width="800"/>
    </p>
    <p>
    </p>
    <p>
     常见的音频编码器
    </p>
    <p>
     常见的音频编码器 包括 OPUS,   AAC,  Vorbis, Speex,  iLBC,  AMR, G.711 等。
    </p>
    <p>
     网上评测结果：     OPUS   &gt;  AAC   &gt;  Vorbis
    </p>
    <p>
     音频编码器性能对比：
    </p>
    <p>
     v-22-音频编码器.jpeg
    </p>
    <p>
     <img alt="" class="has" height="566" src="https://i-blog.csdnimg.cn/blog_migrate/52fdff7496dcb9e3e784ca6630393ade.jpeg" width="800"/>
    </p>
    <p>
     AAC介绍：
    </p>
    <p>
     AAC( Advanced Audio Coding) 目的是取代MP3 格式；
    </p>
    <p>
    </p>
    <p>
     目前常用的规格有：
    </p>
    <p>
     AAC  LC  （Low  Complexity)
    </p>
    <p>
     AAC   HE  V1  ( AAC  +  SBR 技术）
    </p>
    <p>
     AAC   HE  V2( AAC + SBR技术 +  PS技术）
    </p>
    <p>
    </p>
    <p>
     SBR (Spectral Band Replication)
    </p>
    <p>
     PS( Parametric Stereo)
    </p>
    <p>
    </p>
    <p>
     AAC 格式 有哪些？
    </p>
    <p>
     ADIF ( Audio Data Interchange Format )   //这种格式只能从头开始解码，常用在磁盘文件中。
    </p>
    <p>
     ADTS(Audio Data Transport Stream)        //这种格式每一帧都有一个同步字，可以在音频流的任何位置开始解码，它类似数据流格式
    </p>
    <p>
    </p>
    <p>
     AAC 编码库那个好？
    </p>
    <p>
    </p>
    <p>
     Libfdk_AAC  &gt; ffmpeg AAC  &gt; libfaac &gt; libvo_aacenc
    </p>
    <p>
    </p>
    <p>
     H264 基本概念
    </p>
    <p>
     I 帧：  关键帧， 采用帧内压缩技术。
    </p>
    <p>
     P 帧 ：  向前参考帧， 压缩时只参考前一个帧， 属于帧间压缩技术。
    </p>
    <p>
     B 帧 ： 双向参考帧，压缩时既参考前一帧，也参考后一帧，帧间压缩技术。
    </p>
    <p>
     GOF  : 一组帧的 结构 如图：v-29-视频.jpeg
    </p>
    <p>
     <img alt="" class="has" height="469" src="https://i-blog.csdnimg.cn/blog_migrate/e7b072f0765c71e5f39909d9eb81d617.jpeg" width="800"/>
    </p>
    <p>
     SPS  与 PPS
    </p>
    <p>
     SPS   Sequence Parameter Set , 序列参数集 ； 存放帧数，参考帧数目， 解码图像尺寸， 帧场编码模式选择标识等。
    </p>
    <p>
     PPS   Picture Parameter Set, 图像参数集； 存放熵编码模式选择标识， 片组数组，初始量化参数，去方块滤波系数调整标识等。
    </p>
    <p>
    </p>
    <p>
     视频花屏/卡顿 原因
    </p>
    <p>
     如果 GOP分组中的P 帧 丢失会造成解码端的图像发生错误。
    </p>
    <p>
     为了避免花屏问题的发生，一般如果发现P帧 或者I帧 丢失，就不显示本 GOP内的所有帧， 直到下一个 I 帧来后重新刷新图像。
    </p>
    <p>
    </p>
    <p>
     视频都有哪些视频编码器？
    </p>
    <p>
     x264/x265
    </p>
    <p>
     openH264
    </p>
    <p>
     vp8/vp9
    </p>
    <p>
    </p>
    <p>
     H264压缩技术
    </p>
    <p>
     帧内预测压缩，解决的是 空域数据冗余 问题
    </p>
    <p>
     帧间预测压缩， 解决的是  时域数据 冗余问题
    </p>
    <p>
     整数离散余弦变换（DCT)；
    </p>
    <p>
     CABAC压缩。
    </p>
    <p>
     运动矢量 与补偿压缩；  Motion Vector  + Residual Picture
    </p>
    <p>
    </p>
    <p>
     预测模式与残差值压缩：
    </p>
    <p>
     Prediction  Mode  Info  + Residual  Picture
    </p>
    <p>
     图： v-40-视频.jpeg
    </p>
    <p>
     <img alt="" class="has" height="364" src="https://i-blog.csdnimg.cn/blog_migrate/9e06b26f0b220c3babf419435d3c9e78.jpeg" width="800"/>
    </p>
    <p>
     图 ： v-41-视频.jpeg
    </p>
    <p>
    </p>
    <p>
    </p>
    <p>
     <img alt="" class="has" height="495" src="https://i-blog.csdnimg.cn/blog_migrate/45a02cc795dcd7ae3eef40238de5c386.jpeg" width="800"/>
    </p>
    <p>
     DCT 压缩：
    </p>
    <p>
     图： v-42-视频.jpeg
    </p>
    <p>
     <img alt="" class="has" height="372" src="https://i-blog.csdnimg.cn/blog_migrate/1e800e59d7acde5ade8d896b75ca619d.jpeg" width="800"/>
    </p>
    <p>
     图： v-43-视频.jpeg
    </p>
    <p>
     <img alt="" class="has" height="545" src="https://i-blog.csdnimg.cn/blog_migrate/0b926cb4648d09a578bffee3610405f9.jpeg" width="800"/>
    </p>
    <p>
     VLC压缩， 和 CABAC 压缩
    </p>
    <p>
    </p>
    <p>
     H264结构图：
    </p>
    <p>
     v-45-h264.jpeg
    </p>
    <p>
     <img alt="" class="has" height="514" src="https://i-blog.csdnimg.cn/blog_migrate/8bae6ea6592d903e08645cf6fed9bb0f.jpeg" width="800"/>
    </p>
    <p>
    </p>
    <p>
     H264编码分层：
    </p>
    <p>
     NAL层：
    </p>
    <p>
     Network Abstraction Layer, 视频数据网络抽象层
    </p>
    <p>
     VCL 层:
    </p>
    <p>
     Video Coding  Layer, 视频数据编码层。
    </p>
    <p>
     码流基本概念：
    </p>
    <p>
     SODB  （String Of  Data  Bits；） 原始数据比特流，长度不一定是 8的倍数，它是由VCL层产生的。
    </p>
    <p>
     RBSP ( Raw Byte Sequence Payload, SODB + trailing bits)  算法是在SODB最后一位补1, 不按字节对齐则补0
    </p>
    <p>
     EBSP ( Encapsulate  Byte  Sequence Payload);  需要两个连续的0x00  就增加一个0x03
    </p>
    <p>
     NALU   :  NAL  Header   + EBSP
    </p>
    <p>
    </p>
    <p>
     NAL Unit  (简称 NALU):
    </p>
    <p>
     包括： NALU头部  + 一个切片
    </p>
    <p>
     切片 包括  切片头（slice header) + 切片数据(slice data)
    </p>
    <p>
     切片数据由 很多 MacroBlock （宏块） 组成 ；
    </p>
    <p>
     MB (MacroBlock） 由 mb_type;  mb_pred;  coded residual  组成
    </p>
    <p>
     一帧图片 使用 H. 264编码器编码 ，可能可以有多张切片 分出来。
    </p>
    <p>
     H264码流分层  图
    </p>
    <p>
     <img alt="" class="has" height="614" src="https://i-blog.csdnimg.cn/blog_migrate/a114eaa67d992f0deb584309cf1c8f4a.jpeg" width="600"/>
    </p>
    <p>
     NAL Header （NALU 头部）
    </p>
    <p>
     F：  0  // 在 H.264规范中规定了这一位必须为0
    </p>
    <p>
     NRI :  // 占2位， 指示重要性，暂无用。
    </p>
    <p>
     Type :   //占5位，这个NALU 单元的类型。
    </p>
    <p>
     5   //I 帧，IDR 图像的片
    </p>
    <p>
     7  //   序列参数集
    </p>
    <p>
     8  //   图像参数集
    </p>
    <p>
    </p>
    <p>
     24   // STAP-A   单一时间的组合包
    </p>
    <p>
     25   //STAP-B 单一时间的组合包
    </p>
    <p>
     26 //MTAP16   多个时间的组合包
    </p>
    <p>
     27 //MTAP24   多个时间的组合包
    </p>
    <p>
    </p>
    <p>
     28   //FU-A    ; 分片的单元
    </p>
    <p>
     29   // FU-B   ; 分片的单元
    </p>
    <p>
     NAL 类型介绍
    </p>
    <p>
     单一类型   //一个RTP包  只包含  一个  NALU
    </p>
    <p>
     组合类型   //一个RTP包   包含多个NALU,   类型是24-27
    </p>
    <p>
     分片类型   //一个NALU 单元分成多个RTP包，类型是 28和 29
    </p>
    <p>
    </p>
    <p>
     单一NALU的RTP包
    </p>
    <p>
     图：v-57-nal.jpeg
    </p>
    <p>
     <img alt="" class="has" height="503" src="https://i-blog.csdnimg.cn/blog_migrate/90ce666a07d6c39be3124a36b2fca454.jpeg" width="800"/>
    </p>
    <p>
     组合NALU的RTP包
    </p>
    <p>
     图：v-58-nal.jpeg
    </p>
    <p>
     <img alt="" class="has" height="558" src="https://i-blog.csdnimg.cn/blog_migrate/23816226c41e2c578225682124ca322b.jpeg" width="800"/>
    </p>
    <p>
     分片NALU 的  RTP包
    </p>
    <p>
     图： v-59-nal.jpeg
    </p>
    <p>
     <img alt="" class="has" height="474" src="https://i-blog.csdnimg.cn/blog_migrate/1b7910243f0ff364298620f51c188da9.jpeg" width="800"/>
    </p>
    <p>
     FU Header  （占一个字节）
    </p>
    <p>
     S   // start bit, 用于指明分片的开始
    </p>
    <p>
     E   // end bit, 用于指明分片的结束
    </p>
    <p>
     R   //0   ; 未使用
    </p>
    <p>
     Type    //指明  NAL 类型
    </p>
    <p>
    </p>
    <p>
     YUV
    </p>
    <p>
     YUV  也称为  YCbCr :  是电视系统所采用的一种颜色编码方法
    </p>
    <p>
     Y 表示明亮度/  灰阶值， 它是基础信号。
    </p>
    <p>
     U 和 V 表示的则是 色度 ，UV的作用 是描述 影像色彩及饱和度，他们用于指定像素的颜色。
    </p>
    <p>
    </p>
    <p>
     YUV 常见格式：
    </p>
    <p>
     YUV4:2:0 (YCbCr  4:2:0)
    </p>
    <p>
     YUV4:2:2 ( YCbCr  4:2:2)
    </p>
    <p>
     YUV4:4:4 ( YCbCr  4:4:4)
    </p>
    <p>
    </p>
    <p>
     YUV4:2:0
    </p>
    <p>
     并不意味着只有  Y, Cb 两个分量，没有Cr分量。 它实际上指的是 对每行扫描线来说，只有一种色度分量，它以2:1 的抽样率存储
    </p>
    <p>
     相邻的扫描行存储不同的色度分量，也就是说，如果一行是 4:2:0， 下一行就是4:0:2， 再下一行是4:2:0  。。。以此类推。
    </p>
    <p>
    </p>
    <p>
     YUV存储格式
    </p>
    <p>
     planar(平面）
    </p>
    <p>
     I420  :  YYYYYYYY  UU  VV  =&gt; YUV420P
    </p>
    <p>
     YV12 :  YYYYYYYY  VV   UU =&gt; YUV420P
    </p>
    <p>
    </p>
    <p>
     Packed(打包）
    </p>
    <p>
     NV12 :  YYYYYYYY   UVUV  =&gt; YUV420SP
    </p>
    <p>
     NV21 :  YYYYYYYY   VUVU  =&gt; YUV420SP
    </p>
    <p>
     称为专业的音频工程师还要学习啥？
    </p>
    <p>
     音/视频采集；  音/视频硬件 编/解码；  FFMPEG;
    </p>
    <p>
     视频渲染与 OpenGL  ;   x264 优化；  交叉编译与优化；
    </p>
    <p>
     WebRTC;
    </p>
    <p>
     行业痛点？
    </p>
    <p>
     视频秒开；  回音消除；  音频降噪； 视频出现花屏/卡顿/绿边；  手机发烫；  音视频同步；
    </p>
    <p>
    </p>
    <p>
    </p>
    <p>
    </p>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f:2f626c6f672e6373646e2e6e65742f75303133383632313038:2f61727469636c652f64657461696c732f3837383636343731" class_="artid" style="display:none">
 </p>
</div>


