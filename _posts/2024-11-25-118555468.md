---
layout: post
title: Python小白的数学建模课-16.最短路径算法
date: 2024-11-25 16:47:52 +0800
description: 文章浏览阅读6.5k次，点赞31次，收藏125次。最短路径问题是图论研究中的经典算法问题，用于计算图
keywords: 数学建模 最短路 python 博客
categories: ['数学建模课']
tags: ['算法', '数学建模', '图论', '动态规划', 'python']
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=118555468
    alt: Python小白的数学建模课-16.最短路径算法
artid: 118555468
render_with_liquid: false
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     Python小白的数学建模课-16.最短路径算法
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-light" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <br/>
    <ul>
     <li>
      <strong>
       最短路径问题是图论研究中的经典算法问题，用于计算图中一个顶点到另一个顶点的最短路径。
      </strong>
     </li>
     <li>
      <strong>
       在图论中，最短路径长度与最短路径距离却是不同的概念和问题，经常会被混淆。
      </strong>
     </li>
     <li>
      <strong>
       求最短路径长度的常用算法是 Dijkstra 算法、Bellman-Ford 算法和Floyd 算法，另外还有启发式算法 A*。
      </strong>
     </li>
     <li>
      <strong>
       <a href="https://blog.csdn.net/youcans/article/details/117295222">
        『Python小白的数学建模课 @ Youcans』
       </a>
       带你从数模小白成为国赛达人。
      </strong>
     </li>
    </ul>
    <hr/>
    <br/>
    <h3>
     <a id="1__12">
     </a>
     1. 最短路径问题
    </h3>
    <p>
     最短路径问题是图论研究中的经典算法问题，用于计算图中一个顶点到另一个顶点的最短路径。
    </p>
    <p>
     最短路径问题有几种形式：确定起点的最短路径，确定终点的最短路径，确定起点和终点的最短路径，全局最短路径问题。
    </p>
    <h4>
     <a id="11__18">
     </a>
     1.1 最短路径长度与最短路径距离
    </h4>
    <p>
     在日常生活中，最短路径长度与最短路径距离好像并没什么区别。但在图论中最短路径长度与最短路径距离却是不同的概念和问题，经常会被混淆。
    </p>
    <p>
     图论中有无权图和有权图，无权图中的边没有权，赋权图的边带有权，可以表示距离、时间、费用或其它指标。在问题文字描述中，往往并不直接指出是无权图还是有权图，这时就要特别注意最短路径与最短加权路径的区别。
    </p>
    <p>
     <strong>
      路径长度是把每个顶点到相邻顶点的长度记为 1，而不是指这两个顶点之间道路的距离——两个顶点之间的道路距离是 连接边的权（weight）。
     </strong>
    </p>
    <p>
     <strong>
      通俗地说，路径长度可以认为是飞行棋的步数，或者公交站点的站数，相邻顶点之间为一步，相隔几个顶点就是几站。路径长度是从路径起点到终点的步数，计算最短路径是要计算从起点到终点步数最少的路径。
     </strong>
    </p>
    <p>
     如果问题不涉及相邻顶点间的距离，要计算从起点到终点的最短路径及对应的最短路径长度，是指这条路径从起点到终点有几步（站），在图论中称为最短路径长度。但是，如果问题给出相邻顶点之间的道路长度或距离，姑且称为各路段的距离，要计算从起点到终点的最短路径及对应的最短距离，显然并不是要找经过最少步数的路径，而是在找路径中各路段的距离之和最小的路径，在图论中称为最短加权路径长度——这里权重是路段距离。
    </p>
    <p>
     相邻顶点的连接边的权，不仅可以是路段距离，也可以是时间、费用等指标。问题就变成寻求最短时间、最低成本的路径，这实际上也是最短加权路径长度问题。
    </p>
    <br/>
    <h4>
     <a id="12__34">
     </a>
     1.2 最短路径的常用算法
    </h4>
    <p>
     求解最短路径长度的常用算法是 Dijkstra 算法、Bellman-Ford 算法和Floyd 算法，另外还有启发式算法 A*。
    </p>
    <h5>
     <a id="121_Dijkstra__38">
     </a>
     1.2.1 Dijkstra 算法
    </h5>
    <p>
     Dijkstra 算法是经典的最短路径算法，在数据结构、图论、运筹学中都是教学的基本算法。有趣的是，在数据结构中 Dijkstra 算法通常是按贪心法讲述，而在运筹学中则被认为是动态规划法。
    </p>
    <p>
     Dijkstra算法从起点开始，采用贪心法策略，每次遍历距离起点最近且未访问过的邻接顶点， 层层扩展直到终点为止。
    </p>
    <p>
     Dijkstra算法可以求出加权最短路径的最优解，算法的时间复杂度为
     <em>
      O
     </em>
     (n^2)。如果边数远小于 n^2，可以用堆结构将复杂度降为
     <em>
      O
     </em>
     ((m+n)log(n))。
    </p>
    <p>
     Dijkstar算法不能处理负权边，这是由于贪心法的选择规则决定的。
    </p>
    <h5>
     <a id="122_BellmanFord__48">
     </a>
     1.2.2 Bellman-Ford 算法
    </h5>
    <p>
     Bellman-Ford 算法是求含负权图的单源最短路径算法。算法原理是对图进行 V-1次松弛操作，得到所有可能的最短路径。
    </p>
    <p>
     Bellman-Ford 算法可以处理负权边。其基本操作“拓展”是在深度上搜索，而“松弛”操作则在广度上搜索，因此可以对负权边进行操作而不影响结果。
    </p>
    <p>
     Bellman-Ford 算法的效率很低，时间复杂度高达
     <em>
      O
     </em>
     (V*E)，V、E 分别是顶点和边的数量。SPFA 是 Bellman-Ford 的队列优化，通过维护一个队列极大地减少了重复计算，时间复杂度为
     <em>
      O
     </em>
     (k*E) 。
    </p>
    <p>
     Dijkstra 算法在求解过程中，起点到各顶点的最短路径求出后就不变了。Bellman算法在求解过程中，每次循环都要修改所有顶点间的距离，起点到各顶点最短路径一直要到算法结束才确定。
    </p>
    <h5>
     <a id="123_Floyd__58">
     </a>
     1.2.3 Floyd 算法
    </h5>
    <p>
     Floyd 算法又称插点法，运用动态规划思想求解有权图中多源点之间最短路径问题。算法从图的带权邻接矩阵开始，递归地进行 n 次更新得到图的距离矩阵，进而可以得到最短路径节点矩阵。
    </p>
    <p>
     Floyd 算法的时间复杂度为
     <em>
      O
     </em>
     (n^3)，空间复杂度为
     <em>
      O
     </em>
     (n^2)。算法时间复杂度较高，不适合计算大量数据。Floyd 算法的优点是可以一次性求解任意两个节点之间的最短距离，对于稠密图的效率高于执行 V 次 Dijkstra算法。
    </p>
    <p>
     Floyd 算法可以处理负权边。
    </p>
    <p>
     Floyd 算法号称只有 5行代码，我们来欣赏一下：
    </p>
    <pre><code class="prism language-C">for(k=0;k&lt;n;k++)//中转站0~k
    for(i=0;i&lt;n;i++) //i为起点
        for(j=0;j&lt;n;j++) //j为终点
            if(d[i][j]&gt;d[i][k]+d[k][j])//松弛操作 
                d[i][j]=d[i][k]+d[k][j]; 
</code></pre>
    <h5>
     <a id="124_A__76">
     </a>
     1.2.4 A* 算法
    </h5>
    <p>
     A*算法是一种静态路网中求解最短路径最有效的直接搜索方法。
    </p>
    <p>
     A*算法是启发式算法，采用最佳优先（Best-first）搜索策略，基于估价函数对每个搜索位置的评估结果，猜测最好的位置优先进行搜索。
    </p>
    <p>
     A*算法极大地减少了低质量的搜索路径，因而搜索效率很高，比传统的路径规划算法实时性更高、灵活性更强；但是，A*算法找到的是相对最优路径，不是绝对的最短路径，适合大规模、实时性高的问题。
    </p>
    <h5>
     <a id="13__84">
     </a>
     1.3 最短路径算法的选择
    </h5>
    <ol>
     <li>
      需要求解任意两个节点之间的最短距离，使用 Floyd 算法；
     </li>
     <li>
      只要求解单源最短路径问题，有负权边时使用 Bellman-Ford 算法，没有负权边时使用 Dijkstra 算法；
     </li>
     <li>
      A*算法找到的是相对最优路径，适合大规模、实时性高的问题。
     </li>
    </ol>
    <hr/>
    <br/>
    <h3>
     <a id="2_NetworkX__94">
     </a>
     2. NetworkX 中的最短路径算法
    </h3>
    <p>
     NetworkX 提供了丰富的最短路径函数，除了常见的 Dijkstra 算法、Bellman-ford 算法、Floyd Warshall 算法和 A*算法，还有 Goldbery-Radzik 算法和 Johnson 算法。其中，Bellman-ford 算法函数使用的是队列改进算法，即以 SPFA 算法实现。
    </p>
    <h4>
     <a id="21__99">
     </a>
     2.1 无向图和有向图的最短路径求解函数
    </h4>
    <table>
     <thead>
      <tr>
       <th>
        函数
       </th>
       <th>
        功能
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        shortest_path(G[, source, target, weight,…])
       </td>
       <td>
        计算图中的最短路径
       </td>
      </tr>
      <tr>
       <td>
        all_shortest_paths(G, source, target[,…])
       </td>
       <td>
        计算图中所有最短的简单路径
       </td>
      </tr>
      <tr>
       <td>
        shortest_path_length(G[, source, target, …])
       </td>
       <td>
        计算图中的最短路径长度
       </td>
      </tr>
      <tr>
       <td>
        average_shortest_path_length(G[, weight, method])
       </td>
       <td>
        计算平均最短路径长度
       </td>
      </tr>
     </tbody>
    </table>
    <p>
     其中，最基本的求解最短路径函数 shortest() 和 最短路径长度 shortest_path_length() 是 ‘dijkstra’ 算法和 ‘bellman-ford’ 算法的集成接口，可以通过 method=‘dijkstra’ 选择不同的算法。
    </p>
    <blockquote>
     <p>
      shortest_path(G, source=None, target=None, weight=None, method=‘dijkstra’)
      <br/>
      shortest_path_length(G, source=None, target=None, weight=None, method=‘dijkstra’)
     </p>
    </blockquote>
    <p>
     主要参数：
    </p>
    <ul>
     <li>
      <strong>
       G
      </strong>
      (NetworkX graph)：图。
     </li>
     <li>
      <strong>
       source
      </strong>
      (node)：起点。
     </li>
     <li>
      <strong>
       target
      </strong>
      (node)：终点。
     </li>
     <li>
      <strong>
       weight
      </strong>
      (string or function)：参数为字符串(string)时，按该字符串查找边的属性作为权重；如果该字符串对应的边属性不存在，则权重置为 1；参数为函数时，边的权重是函数的返回值。
     </li>
     <li>
      <strong>
       method [string, optional (default = ‘dijkstra’)]
      </strong>
      ：支持的选项为 ‘dijkstra’, ‘bellman-ford’。
     </li>
    </ul>
    <h4>
     <a id="22__122">
     </a>
     2.2 无权图最短路径算法
    </h4>
    <table>
     <thead>
      <tr>
       <th>
        函数
       </th>
       <th>
        功能
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        single_source_shortest_path(G, source[,cutoff])
       </td>
       <td>
        计算从源到所有可达节点的最短路径
       </td>
      </tr>
      <tr>
       <td>
        single_source_shortest_path_length(G,source)
       </td>
       <td>
        计算从源到所有可达节点的最短路径长度
       </td>
      </tr>
      <tr>
       <td>
        single_target_shortest_path(G, target[,cutoff])
       </td>
       <td>
        计算从所有可达节点到目标的最短路径
       </td>
      </tr>
      <tr>
       <td>
        single_target_shortest_path_length(G,target)
       </td>
       <td>
        计算从所有可达节点到目标的最短路径长度
       </td>
      </tr>
      <tr>
       <td>
        all_pairs_shortest_path(G[, cutoff])
       </td>
       <td>
        计算所有节点之间的最短路径
       </td>
      </tr>
      <tr>
       <td>
        all_pairs_shortest_path_length(G[, cutoff])
       </td>
       <td>
        计算所有节点之间的最短路径长度
       </td>
      </tr>
     </tbody>
    </table>
    <h4>
     <a id="23__133">
     </a>
     2.3 有权图最短路径算法
    </h4>
    <table>
     <thead>
      <tr>
       <th>
        函数
       </th>
       <th>
        功能
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        dijkstra_path(G, source, target[, weight])
       </td>
       <td>
        计算从源到目标的最短加权路径
       </td>
      </tr>
      <tr>
       <td>
        dijkstra_path_length(G, source, target[,weight])
       </td>
       <td>
        计算从源到目标的最短加权路径长度
       </td>
      </tr>
      <tr>
       <td>
        all_pairs_dijkstra_path(G[, cutoff, weight])
       </td>
       <td>
        计算所有节点之间的最短加权路径
       </td>
      </tr>
      <tr>
       <td>
        all_pairs_dijkstra_path_length(G[, cutoff,… ])
       </td>
       <td>
        计算所有节点之间的最短加权路径长度
       </td>
      </tr>
      <tr>
       <td>
        bellman_ford_path(G, source, target[, weight])
       </td>
       <td>
        计算从源到目标的最短路径
       </td>
      </tr>
      <tr>
       <td>
        bellman_ford_path_length(G, source, target)
       </td>
       <td>
        计算从源到目标的最短路径长度
       </td>
      </tr>
      <tr>
       <td>
        all_pairs_bellman_ford_path(G[, weight])
       </td>
       <td>
        计算所有节点之间的最短路径
       </td>
      </tr>
      <tr>
       <td>
        all_pairs_bellman_ford_path_length(G[,weight])
       </td>
       <td>
        计算所有节点之间的最短路径长度
       </td>
      </tr>
      <tr>
       <td>
        floyd_warshall(G[, weight])
       </td>
       <td>
        用 Floyd 法计算所有节点之间的最短路径长度
       </td>
      </tr>
      <tr>
       <td>
        floyd_warshall_numpy(G[, nodelist, weight])
       </td>
       <td>
        用 Floyd 法计算所有指定节点之间的最短路径长度
       </td>
      </tr>
     </tbody>
    </table>
    <hr/>
    <br/>
    <h3>
     <a id="3_NetworkX__Dijkstra__152">
     </a>
     3. NetworkX 中的 Dijkstra 算法
    </h3>
    <p>
     NetworkX 中关于 Dijkstra 算法提供了 13 个函数，很多函数的功能是重复的。这里只介绍最基本的函数 dijkstra_path() 和 dijkstra_path_length()。
    </p>
    <h4>
     <a id="31_dijkstra_path__dijkstra_path_length__155">
     </a>
     3.1 dijkstra_path() 和 dijkstra_path_length() 使用说明
    </h4>
    <p>
     dijkstra_path() 用于计算从源到目标的最短加权路径，dijkstra_path_length() 用于计算从源到目标的最短加权路径长度。
    </p>
    <blockquote>
     <p>
      dijkstra_path(G, source, target, weight=‘weight’)
      <br/>
      dijkstra_path_length(G, source, target, weight=‘weight’)
     </p>
    </blockquote>
    <p>
     主要参数：
    </p>
    <ul>
     <li>
      <strong>
       G
      </strong>
      (NetworkX graph)：图。
     </li>
     <li>
      <strong>
       source
      </strong>
      (node)：起点。
     </li>
     <li>
      <strong>
       target
      </strong>
      (node)：终点。
     </li>
     <li>
      <strong>
       weight
      </strong>
      (string or function)：参数为字符串(string)时，按该字符串查找边的属性作为权重；如果该字符串对应的边属性不存在，则权重置为1；参数为函数时，边的权重是函数的返回值。
     </li>
    </ul>
    <p>
     返回值：
    </p>
    <ul>
     <li>
      dijkstra_path() 的返回值是最短加权路径中的节点列表，数据类型为list。
     </li>
     <li>
      dijkstra_path_length() 的返回值是最短加权路径的长度（路径中的边的权重之和）。
     </li>
    </ul>
    <br/>
    <h4>
     <a id="32__1_176">
     </a>
     3.2 例题 1：无向图的最短路径问题
    </h4>
    <p>
     <strong>
      例题 1：已知如图的有权无向图，求顶点 v1 到 顶点 v11 的最短路径。
     </strong>
    </p>
    <p>
     本问题来自：司守奎、孙兆亮，数学建模算法与应用（第2版），P43，例4.3，国防工业出版社。
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/c359af4a14865c2dba05daf57720abb4.png#pic_center"/>
    </p>
    <p>
     <strong>
      程序说明：
     </strong>
    </p>
    <ol>
     <li>
      图的输入。本例的问题是稀疏的有权无向图，使用 add_weighted_edges_from() 函数可以用列表形式向图中添加多条赋权边，每个赋权边以元组 (node1,node2,weight) 表示。
     </li>
     <li>
      图的绘制。使用 nx.draw() 绘图时，默认的顶点位置可能并不理想，可以通过 pos 指定顶点位置。
     </li>
     <li>
      绘制边的属性。使用 nx.draw_networkx_edge_labels() 可以绘制边的属性，例程中选择显示权重属性。
     </li>
     <li>
      使用 dijkstra_path() 和 dijkstra_path_length() 求指定顶点之间的最短加权路径和最短加权路径长度。
     </li>
    </ol>
    <br/>
    <h4>
     <a id="33_dijkstra_path__193">
     </a>
     3.3 dijkstra_path() 算法例程
    </h4>
    <pre><code class="prism language-python"><span class="token comment"># mathmodel16_v1.py</span>
<span class="token comment"># Demo16 of mathematical modeling algorithm</span>
<span class="token comment"># Demo of shortest path with NetworkX</span>
<span class="token comment"># Copyright 2021 YouCans, XUPT</span>
<span class="token comment"># Crated：2021-07-07</span>

<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt <span class="token comment"># 导入 Matplotlib 工具包</span>
<span class="token keyword">import</span> networkx <span class="token keyword">as</span> nx  <span class="token comment"># 导入 NetworkX 工具包</span>

<span class="token comment"># 问题 1：无向图的最短路问题（司守奎，数学建模算法与应用，P43，例4.3）</span>
G1 <span class="token operator">=</span> nx<span class="token punctuation">.</span>Graph<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 创建：空的 无向图</span>
G1<span class="token punctuation">.</span>add_weighted_edges_from<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                            <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                            <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                            <span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                            <span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                            <span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                            <span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                            <span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                            <span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                            <span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># 向图中添加多条赋权边: (node1,node2,weight)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'nx.info:'</span><span class="token punctuation">,</span>G1<span class="token punctuation">.</span>nodes<span class="token punctuation">)</span>  <span class="token comment"># 返回图的基本信息</span>

<span class="token comment"># 两个指定顶点之间的最短加权路径</span>
minWPath_v1_v11 <span class="token operator">=</span> nx<span class="token punctuation">.</span>dijkstra_path<span class="token punctuation">(</span>G1<span class="token punctuation">,</span> source<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> target<span class="token operator">=</span><span class="token number">11</span><span class="token punctuation">)</span>  <span class="token comment"># 顶点 1 到 顶点 11 的最短加权路径</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"顶点 v1 到 顶点 v11 的最短加权路径: "</span><span class="token punctuation">,</span> minWPath_v1_v11<span class="token punctuation">)</span>
<span class="token comment"># 两个指定顶点之间的最短加权路径的长度</span>
lMinWPath_v1_v11 <span class="token operator">=</span> nx<span class="token punctuation">.</span>dijkstra_path_length<span class="token punctuation">(</span>G1<span class="token punctuation">,</span> source<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> target<span class="token operator">=</span><span class="token number">11</span><span class="token punctuation">)</span>  <span class="token comment"># 最短加权路径长度</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"顶点 v1 到 顶点 v11 的最短加权路径长度: "</span><span class="token punctuation">,</span> lMinWPath_v1_v11<span class="token punctuation">)</span>

pos <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">1</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       <span class="token number">8</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">}</span>  <span class="token comment"># 指定顶点位置</span>
labels <span class="token operator">=</span> nx<span class="token punctuation">.</span>get_edge_attributes<span class="token punctuation">(</span>G1<span class="token punctuation">,</span> <span class="token string">'weight'</span><span class="token punctuation">)</span>  <span class="token comment"># 设置边的 labels 为 ‘weight'</span>
nx<span class="token punctuation">.</span>draw<span class="token punctuation">(</span>G1<span class="token punctuation">,</span> pos<span class="token punctuation">,</span> with_labels<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> font_color<span class="token operator">=</span><span class="token string">'w'</span><span class="token punctuation">)</span>  <span class="token comment"># 绘制无向图</span>
nx<span class="token punctuation">.</span>draw_networkx_edge_labels<span class="token punctuation">(</span>G1<span class="token punctuation">,</span> pos<span class="token punctuation">,</span> edge_labels<span class="token operator">=</span>labels<span class="token punctuation">,</span> font_color<span class="token operator">=</span><span class="token string">'c'</span><span class="token punctuation">)</span>  <span class="token comment"># 显示边的权值</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
    <h4>
     <a id="34__233">
     </a>
     3.4 程序运行结果
    </h4>
    <pre><code class="prism language-python">nx<span class="token punctuation">.</span>info<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">]</span>
顶点 v1 到 顶点 v11 的最短加权路径<span class="token punctuation">:</span>  <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">]</span>
顶点 v1 到 顶点 v11 的最短加权路径长度<span class="token punctuation">:</span>  <span class="token number">13</span>
</code></pre>
    <hr/>
    <br/>
    <h3>
     <a id="4_NetworkX__BellmanFord__245">
     </a>
     4. NetworkX 中的 Bellman-Ford 算法
    </h3>
    <p>
     NetworkX 中关于 Bellman-Ford 算法提供了多个函数，这里只介绍最基本的函数 bellman_ford_path() 和 bellman_ford_path_length()。
    </p>
    <h4>
     <a id="41_bellman_ford_path__bellman_ford_path_length__249">
     </a>
     4.1 bellman_ford_path() 和 bellman_ford_path_length() 使用说明
    </h4>
    <p>
     bellman_ford_path() 用于计算从源到目标的最短加权路径，bellman_ford_path_length() 用于计算从源到目标的最短加权路径长度。
    </p>
    <blockquote>
     <p>
      bellman_ford_path(G, source, target, weight=‘weight’)
      <br/>
      bellman_ford_path_length(G, source, target, weight=‘weight’)
     </p>
    </blockquote>
    <p>
     主要参数：
    </p>
    <ul>
     <li>
      <strong>
       G
      </strong>
      (NetworkX graph)：图。
     </li>
     <li>
      <strong>
       source
      </strong>
      (node)：起点。
     </li>
     <li>
      <strong>
       target
      </strong>
      (node)：终点。
     </li>
     <li>
      <strong>
       weight
      </strong>
      (string)：按字符串查找边的属性作为权重。默认值为权重 ‘weight’。
     </li>
    </ul>
    <p>
     返回值：
    </p>
    <ul>
     <li>
      bellman_ford_path() 的返回值是最短加权路径中的节点列表，数据类型为list。
     </li>
     <li>
      bellman_ford_path_length() 的返回值是最短加权路径的长度（路径中的边的权重之和）。
     </li>
    </ul>
    <br/>
    <h4>
     <a id="42__2_270">
     </a>
     4.2 例题 2：城市间机票价格问题
    </h4>
    <p>
     <strong>
      例题 2：城市间机票价格问题。
     </strong>
    </p>
    <p>
     已知 6个城市之间的机票票价如矩阵所示（无穷大表示没有直航），求城市 c0 到其它城市 c1…c5 的票价最便宜的路径及票价。
    </p>
    <p>
     <span class="katex--display">
      <span class="katex-display">
       <span class="katex">
        <span class="katex-mathml">
         [ 
         
         
          
           
            
            
              0 
             
            
           
           
            
            
              50 
             
            
           
           
            
            
              ∞ 
             
            
           
           
            
            
              40 
             
            
           
           
            
            
              25 
             
            
           
           
            
            
              10 
             
            
           
          
          
           
            
            
              50 
             
            
           
           
            
            
              0 
             
            
           
           
            
            
              15 
             
            
           
           
            
            
              20 
             
            
           
           
            
            
              ∞ 
             
            
           
           
            
            
              25 
             
            
           
          
          
           
            
            
              ∞ 
             
            
           
           
            
            
              15 
             
            
           
           
            
            
              0 
             
            
           
           
            
            
              10 
             
            
           
           
            
            
              20 
             
            
           
           
            
            
              ∞ 
             
            
           
          
          
           
            
            
              40 
             
            
           
           
            
            
              20 
             
            
           
           
            
            
              10 
             
            
           
           
            
            
              0 
             
            
           
           
            
            
              10 
             
            
           
           
            
            
              25 
             
            
           
          
          
           
            
            
              25 
             
            
           
           
            
            
              ∞ 
             
            
           
           
            
            
              20 
             
            
           
           
            
            
              10 
             
            
           
           
            
            
              0 
             
            
           
           
            
            
              55 
             
            
           
          
          
           
            
            
              10 
             
            
           
           
            
            
              25 
             
            
           
           
            
            
              ∞ 
             
            
           
           
            
            
              25 
             
            
           
           
            
            
              55 
             
            
           
           
            
            
              0 
             
            
           
          
         
        
          ] 
         
        
       
         \begin{bmatrix} 0 &amp; 50 &amp; \infty &amp; 40 &amp; 25 &amp; 10\\ 50 &amp; 0 &amp; 15 &amp; 20 &amp; \infty &amp; 25\\ \infty &amp; 15 &amp; 0 &amp; 10 &amp; 20 &amp; \infty\\ 40 &amp; 20 &amp; 10 &amp; 0 &amp; 10 &amp; 25\\ 25 &amp; \infty &amp; 20 &amp; 10 &amp; 0 &amp; 55\\ 10 &amp; 25 &amp; \infty &amp; 25 &amp; 55 &amp; 0\\ \end{bmatrix}
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 7.20604em; vertical-align: -3.35005em;">
          </span>
          <span class="minner">
           <span class="mopen">
            <span class="delimsizing mult">
             <span class="vlist-t vlist-t2">
              <span class="vlist-r">
               <span class="vlist" style="height: 3.85599em;">
                <span class="" style="top: -0.44997em;">
                 <span class="pstrut" style="height: 3.155em;">
                 </span>
                 <span class="delimsizinginner delim-size4">
                  <span class="">
                   ⎣
                  </span>
                 </span>
                </span>
                <span class="" style="top: -1.60497em;">
                 <span class="pstrut" style="height: 3.155em;">
                 </span>
                 <span class="delimsizinginner delim-size4">
                  <span class="">
                   ⎢
                  </span>
                 </span>
                </span>
                <span class="" style="top: -2.20597em;">
                 <span class="pstrut" style="height: 3.155em;">
                 </span>
                 <span class="delimsizinginner delim-size4">
                  <span class="">
                   ⎢
                  </span>
                 </span>
                </span>
                <span class="" style="top: -2.80697em;">
                 <span class="pstrut" style="height: 3.155em;">
                 </span>
                 <span class="delimsizinginner delim-size4">
                  <span class="">
                   ⎢
                  </span>
                 </span>
                </span>
                <span class="" style="top: -3.40797em;">
                 <span class="pstrut" style="height: 3.155em;">
                 </span>
                 <span class="delimsizinginner delim-size4">
                  <span class="">
                   ⎢
                  </span>
                 </span>
                </span>
                <span class="" style="top: -4.00897em;">
                 <span class="pstrut" style="height: 3.155em;">
                 </span>
                 <span class="delimsizinginner delim-size4">
                  <span class="">
                   ⎢
                  </span>
                 </span>
                </span>
                <span class="" style="top: -4.60997em;">
                 <span class="pstrut" style="height: 3.155em;">
                 </span>
                 <span class="delimsizinginner delim-size4">
                  <span class="">
                   ⎢
                  </span>
                 </span>
                </span>
                <span class="" style="top: -5.85599em;">
                 <span class="pstrut" style="height: 3.155em;">
                 </span>
                 <span class="delimsizinginner delim-size4">
                  <span class="">
                   ⎡
                  </span>
                 </span>
                </span>
               </span>
               <span class="vlist-s">
                ​
               </span>
              </span>
              <span class="vlist-r">
               <span class="vlist" style="height: 3.35005em;">
                <span class="">
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
           <span class="mord">
            <span class="mtable">
             <span class="col-align-c">
              <span class="vlist-t vlist-t2">
               <span class="vlist-r">
                <span class="vlist" style="height: 3.85em;">
                 <span class="" style="top: -6.01em;">
                  <span class="pstrut" style="height: 3em;">
                  </span>
                  <span class="mord">
                   <span class="mord">
                    0
                   </span>
                  </span>
                 </span>
                 <span class="" style="top: -4.81em;">
                  <span class="pstrut" style="height: 3em;">
                  </span>
                  <span class="mord">
                   <span class="mord">
                    5
                   </span>
                   <span class="mord">
                    0
                   </span>
                  </span>
                 </span>
                 <span class="" style="top: -3.61em;">
                  <span class="pstrut" style="height: 3em;">
                  </span>
                  <span class="mord">
                   <span class="mord">
                    ∞
                   </span>
                  </span>
                 </span>
                 <span class="" style="top: -2.41em;">
                  <span class="pstrut" style="height: 3em;">
                  </span>
                  <span class="mord">
                   <span class="mord">
                    4
                   </span>
                   <span class="mord">
                    0
                   </span>
                  </span>
                 </span>
                 <span class="" style="top: -1.21em;">
                  <span class="pstrut" style="height: 3em;">
                  </span>
                  <span class="mord">
                   <span class="mord">
                    2
                   </span>
                   <span class="mord">
                    5
                   </span>
                  </span>
                 </span>
                 <span class="" style="top: -0.01em;">
                  <span class="pstrut" style="height: 3em;">
                  </span>
                  <span class="mord">
                   <span class="mord">
                    1
                   </span>
                   <span class="mord">
                    0
                   </span>
                  </span>
                 </span>
                </span>
                <span class="vlist-s">
                 ​
                </span>
               </span>
               <span class="vlist-r">
                <span class="vlist" style="height: 3.35em;">
                 <span class="">
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="arraycolsep" style="width: 0.5em;">
             </span>
             <span class="arraycolsep" style="width: 0.5em;">
             </span>
             <span class="col-align-c">
              <span class="vlist-t vlist-t2">
               <span class="vlist-r">
                <span class="vlist" style="height: 3.85em;">
                 <span class="" style="top: -6.01em;">
                  <span class="pstrut" style="height: 3em;">
                  </span>
                  <span class="mord">
                   <span class="mord">
                    5
                   </span>
                   <span class="mord">
                    0
                   </span>
                  </span>
                 </span>
                 <span class="" style="top: -4.81em;">
                  <span class="pstrut" style="height: 3em;">
                  </span>
                  <span class="mord">
                   <span class="mord">
                    0
                   </span>
                  </span>
                 </span>
                 <span class="" style="top: -3.61em;">
                  <span class="pstrut" style="height: 3em;">
                  </span>
                  <span class="mord">
                   <span class="mord">
                    1
                   </span>
                   <span class="mord">
                    5
                   </span>
                  </span>
                 </span>
                 <span class="" style="top: -2.41em;">
                  <span class="pstrut" style="height: 3em;">
                  </span>
                  <span class="mord">
                   <span class="mord">
                    2
                   </span>
                   <span class="mord">
                    0
                   </span>
                  </span>
                 </span>
                 <span class="" style="top: -1.21em;">
                  <span class="pstrut" style="height: 3em;">
                  </span>
                  <span class="mord">
                   <span class="mord">
                    ∞
                   </span>
                  </span>
                 </span>
                 <span class="" style="top: -0.01em;">
                  <span class="pstrut" style="height: 3em;">
                  </span>
                  <span class="mord">
                   <span class="mord">
                    2
                   </span>
                   <span class="mord">
                    5
                   </span>
                  </span>
                 </span>
                </span>
                <span class="vlist-s">
                 ​
                </span>
               </span>
               <span class="vlist-r">
                <span class="vlist" style="height: 3.35em;">
                 <span class="">
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="arraycolsep" style="width: 0.5em;">
             </span>
             <span class="arraycolsep" style="width: 0.5em;">
             </span>
             <span class="col-align-c">
              <span class="vlist-t vlist-t2">
               <span class="vlist-r">
                <span class="vlist" style="height: 3.85em;">
                 <span class="" style="top: -6.01em;">
                  <span class="pstrut" style="height: 3em;">
                  </span>
                  <span class="mord">
                   <span class="mord">
                    ∞
                   </span>
                  </span>
                 </span>
                 <span class="" style="top: -4.81em;">
                  <span class="pstrut" style="height: 3em;">
                  </span>
                  <span class="mord">
                   <span class="mord">
                    1
                   </span>
                   <span class="mord">
                    5
                   </span>
                  </span>
                 </span>
                 <span class="" style="top: -3.61em;">
                  <span class="pstrut" style="height: 3em;">
                  </span>
                  <span class="mord">
                   <span class="mord">
                    0
                   </span>
                  </span>
                 </span>
                 <span class="" style="top: -2.41em;">
                  <span class="pstrut" style="height: 3em;">
                  </span>
                  <span class="mord">
                   <span class="mord">
                    1
                   </span>
                   <span class="mord">
                    0
                   </span>
                  </span>
                 </span>
                 <span class="" style="top: -1.21em;">
                  <span class="pstrut" style="height: 3em;">
                  </span>
                  <span class="mord">
                   <span class="mord">
                    2
                   </span>
                   <span class="mord">
                    0
                   </span>
                  </span>
                 </span>
                 <span class="" style="top: -0.01em;">
                  <span class="pstrut" style="height: 3em;">
                  </span>
                  <span class="mord">
                   <span class="mord">
                    ∞
                   </span>
                  </span>
                 </span>
                </span>
                <span class="vlist-s">
                 ​
                </span>
               </span>
               <span class="vlist-r">
                <span class="vlist" style="height: 3.35em;">
                 <span class="">
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="arraycolsep" style="width: 0.5em;">
             </span>
             <span class="arraycolsep" style="width: 0.5em;">
             </span>
             <span class="col-align-c">
              <span class="vlist-t vlist-t2">
               <span class="vlist-r">
                <span class="vlist" style="height: 3.85em;">
                 <span class="" style="top: -6.01em;">
                  <span class="pstrut" style="height: 3em;">
                  </span>
                  <span class="mord">
                   <span class="mord">
                    4
                   </span>
                   <span class="mord">
                    0
                   </span>
                  </span>
                 </span>
                 <span class="" style="top: -4.81em;">
                  <span class="pstrut" style="height: 3em;">
                  </span>
                  <span class="mord">
                   <span class="mord">
                    2
                   </span>
                   <span class="mord">
                    0
                   </span>
                  </span>
                 </span>
                 <span class="" style="top: -3.61em;">
                  <span class="pstrut" style="height: 3em;">
                  </span>
                  <span class="mord">
                   <span class="mord">
                    1
                   </span>
                   <span class="mord">
                    0
                   </span>
                  </span>
                 </span>
                 <span class="" style="top: -2.41em;">
                  <span class="pstrut" style="height: 3em;">
                  </span>
                  <span class="mord">
                   <span class="mord">
                    0
                   </span>
                  </span>
                 </span>
                 <span class="" style="top: -1.21em;">
                  <span class="pstrut" style="height: 3em;">
                  </span>
                  <span class="mord">
                   <span class="mord">
                    1
                   </span>
                   <span class="mord">
                    0
                   </span>
                  </span>
                 </span>
                 <span class="" style="top: -0.01em;">
                  <span class="pstrut" style="height: 3em;">
                  </span>
                  <span class="mord">
                   <span class="mord">
                    2
                   </span>
                   <span class="mord">
                    5
                   </span>
                  </span>
                 </span>
                </span>
                <span class="vlist-s">
                 ​
                </span>
               </span>
               <span class="vlist-r">
                <span class="vlist" style="height: 3.35em;">
                 <span class="">
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="arraycolsep" style="width: 0.5em;">
             </span>
             <span class="arraycolsep" style="width: 0.5em;">
             </span>
             <span class="col-align-c">
              <span class="vlist-t vlist-t2">
               <span class="vlist-r">
                <span class="vlist" style="height: 3.85em;">
                 <span class="" style="top: -6.01em;">
                  <span class="pstrut" style="height: 3em;">
                  </span>
                  <span class="mord">
                   <span class="mord">
                    2
                   </span>
                   <span class="mord">
                    5
                   </span>
                  </span>
                 </span>
                 <span class="" style="top: -4.81em;">
                  <span class="pstrut" style="height: 3em;">
                  </span>
                  <span class="mord">
                   <span class="mord">
                    ∞
                   </span>
                  </span>
                 </span>
                 <span class="" style="top: -3.61em;">
                  <span class="pstrut" style="height: 3em;">
                  </span>
                  <span class="mord">
                   <span class="mord">
                    2
                   </span>
                   <span class="mord">
                    0
                   </span>
                  </span>
                 </span>
                 <span class="" style="top: -2.41em;">
                  <span class="pstrut" style="height: 3em;">
                  </span>
                  <span class="mord">
                   <span class="mord">
                    1
                   </span>
                   <span class="mord">
                    0
                   </span>
                  </span>
                 </span>
                 <span class="" style="top: -1.21em;">
                  <span class="pstrut" style="height: 3em;">
                  </span>
                  <span class="mord">
                   <span class="mord">
                    0
                   </span>
                  </span>
                 </span>
                 <span class="" style="top: -0.01em;">
                  <span class="pstrut" style="height: 3em;">
                  </span>
                  <span class="mord">
                   <span class="mord">
                    5
                   </span>
                   <span class="mord">
                    5
                   </span>
                  </span>
                 </span>
                </span>
                <span class="vlist-s">
                 ​
                </span>
               </span>
               <span class="vlist-r">
                <span class="vlist" style="height: 3.35em;">
                 <span class="">
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="arraycolsep" style="width: 0.5em;">
             </span>
             <span class="arraycolsep" style="width: 0.5em;">
             </span>
             <span class="col-align-c">
              <span class="vlist-t vlist-t2">
               <span class="vlist-r">
                <span class="vlist" style="height: 3.85em;">
                 <span class="" style="top: -6.01em;">
                  <span class="pstrut" style="height: 3em;">
                  </span>
                  <span class="mord">
                   <span class="mord">
                    1
                   </span>
                   <span class="mord">
                    0
                   </span>
                  </span>
                 </span>
                 <span class="" style="top: -4.81em;">
                  <span class="pstrut" style="height: 3em;">
                  </span>
                  <span class="mord">
                   <span class="mord">
                    2
                   </span>
                   <span class="mord">
                    5
                   </span>
                  </span>
                 </span>
                 <span class="" style="top: -3.61em;">
                  <span class="pstrut" style="height: 3em;">
                  </span>
                  <span class="mord">
                   <span class="mord">
                    ∞
                   </span>
                  </span>
                 </span>
                 <span class="" style="top: -2.41em;">
                  <span class="pstrut" style="height: 3em;">
                  </span>
                  <span class="mord">
                   <span class="mord">
                    2
                   </span>
                   <span class="mord">
                    5
                   </span>
                  </span>
                 </span>
                 <span class="" style="top: -1.21em;">
                  <span class="pstrut" style="height: 3em;">
                  </span>
                  <span class="mord">
                   <span class="mord">
                    5
                   </span>
                   <span class="mord">
                    5
                   </span>
                  </span>
                 </span>
                 <span class="" style="top: -0.01em;">
                  <span class="pstrut" style="height: 3em;">
                  </span>
                  <span class="mord">
                   <span class="mord">
                    0
                   </span>
                  </span>
                 </span>
                </span>
                <span class="vlist-s">
                 ​
                </span>
               </span>
               <span class="vlist-r">
                <span class="vlist" style="height: 3.35em;">
                 <span class="">
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
           <span class="mclose">
            <span class="delimsizing mult">
             <span class="vlist-t vlist-t2">
              <span class="vlist-r">
               <span class="vlist" style="height: 3.85599em;">
                <span class="" style="top: -0.44997em;">
                 <span class="pstrut" style="height: 3.155em;">
                 </span>
                 <span class="delimsizinginner delim-size4">
                  <span class="">
                   ⎦
                  </span>
                 </span>
                </span>
                <span class="" style="top: -1.60497em;">
                 <span class="pstrut" style="height: 3.155em;">
                 </span>
                 <span class="delimsizinginner delim-size4">
                  <span class="">
                   ⎥
                  </span>
                 </span>
                </span>
                <span class="" style="top: -2.20597em;">
                 <span class="pstrut" style="height: 3.155em;">
                 </span>
                 <span class="delimsizinginner delim-size4">
                  <span class="">
                   ⎥
                  </span>
                 </span>
                </span>
                <span class="" style="top: -2.80697em;">
                 <span class="pstrut" style="height: 3.155em;">
                 </span>
                 <span class="delimsizinginner delim-size4">
                  <span class="">
                   ⎥
                  </span>
                 </span>
                </span>
                <span class="" style="top: -3.40797em;">
                 <span class="pstrut" style="height: 3.155em;">
                 </span>
                 <span class="delimsizinginner delim-size4">
                  <span class="">
                   ⎥
                  </span>
                 </span>
                </span>
                <span class="" style="top: -4.00897em;">
                 <span class="pstrut" style="height: 3.155em;">
                 </span>
                 <span class="delimsizinginner delim-size4">
                  <span class="">
                   ⎥
                  </span>
                 </span>
                </span>
                <span class="" style="top: -4.60997em;">
                 <span class="pstrut" style="height: 3.155em;">
                 </span>
                 <span class="delimsizinginner delim-size4">
                  <span class="">
                   ⎥
                  </span>
                 </span>
                </span>
                <span class="" style="top: -5.85599em;">
                 <span class="pstrut" style="height: 3.155em;">
                 </span>
                 <span class="delimsizinginner delim-size4">
                  <span class="">
                   ⎤
                  </span>
                 </span>
                </span>
               </span>
               <span class="vlist-s">
                ​
               </span>
              </span>
              <span class="vlist-r">
               <span class="vlist" style="height: 3.35005em;">
                <span class="">
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     <br/>
     本案例问题改编自：司守奎、孙兆亮，数学建模算法与应用（第2版），P41，例4.1，国防工业出版社。
    </p>
    <p>
     <strong>
      程序说明
     </strong>
    </p>
    <ol>
     <li>
      图的输入。使用 pandas 中 DataFrame 读取数据文件非常方便，本例中以 pandas 输入顶点邻接矩阵，使用 nx.from_pandas_adjacency(dfAdj) 转换为 NetworkX 的图。
     </li>
     <li>
      邻接矩阵。邻接矩阵 dfAdj (i,j) 的值表示连接顶点 i、j 的边的权值， dfAdj (i,j) = 0 表示 i、j 不相邻， 本例中表示没有直航。
     </li>
     <li>
      最短路径与最短路径长度。nx.shortest_path() 返回最短路径。nx.shortest_path_length() 返回最短路径长度，本例中可以理解为从起点到终点的乘机次数：1 表示直航，2 表示中转一次。
     </li>
     <li>
      最短加权路径长度。nx.bellman_ford_path_length() 返回最短加权路径长度，本例中权重为票价，最短加权路径长度即为两点间最便宜的直航或中转的机票票价。
      <br/>
      通过本案例，可以直观地理解最短路径长度与最短加权路径长度的区别。
     </li>
    </ol>
    <br/>
    <h4>
     <a id="43_bellman_ford_path__299">
     </a>
     4.3 bellman_ford_path() 算法例程
    </h4>
    <pre><code class="prism language-python"><span class="token comment"># mathmodel16_v1.py</span>
<span class="token comment"># Demo16 of mathematical modeling algorithm</span>
<span class="token comment"># Demo of shortest path with NetworkX</span>
<span class="token comment"># Copyright 2021 YouCans, XUPT</span>
<span class="token comment"># Crated：2021-07-07</span>

<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt <span class="token comment"># 导入 Matplotlib 工具包</span>
<span class="token keyword">import</span> networkx <span class="token keyword">as</span> nx  <span class="token comment"># 导入 NetworkX 工具包</span>

<span class="token comment"># 问题 2：城市间机票价格问题（司守奎，数学建模算法与应用，P41，例4.1）</span>
<span class="token comment"># # 从Pandas数据格式（顶点邻接矩阵）创建 NetworkX 图</span>
<span class="token comment"># # from_pandas_adjacency(df, create_using=None) # 邻接矩阵，n行*n列，矩阵数据表示权重</span>
dfAdj <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  <span class="token comment"># 0 表示不邻接，</span>
                      <span class="token punctuation">[</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                      <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                      <span class="token punctuation">[</span><span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                      <span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0</span> <span class="token punctuation">,</span><span class="token number">55</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                      <span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">55</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
G2 <span class="token operator">=</span> nx<span class="token punctuation">.</span>from_pandas_adjacency<span class="token punctuation">(</span>dfAdj<span class="token punctuation">)</span>  <span class="token comment"># 由 pandas 顶点邻接矩阵 创建 NetworkX 图</span>

<span class="token comment"># 计算最短路径：注意最短路径与最短加权路径的不同</span>
<span class="token comment"># 两个指定顶点之间的最短路径</span>
minPath03 <span class="token operator">=</span> nx<span class="token punctuation">.</span>shortest_path<span class="token punctuation">(</span>G2<span class="token punctuation">,</span> source<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> target<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span>  <span class="token comment"># 顶点 0 到 顶点 3 的最短路径</span>
lMinPath03 <span class="token operator">=</span> nx<span class="token punctuation">.</span>shortest_path_length<span class="token punctuation">(</span>G2<span class="token punctuation">,</span> source<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> target<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span>  <span class="token comment">#最短路径长度</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"顶点 0 到 3 的最短路径为：{}，最短路径长度为：{}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>minPath03<span class="token punctuation">,</span> lMinPath03<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># 两个指定顶点之间的最短加权路径</span>
minWPath03 <span class="token operator">=</span> nx<span class="token punctuation">.</span>bellman_ford_path<span class="token punctuation">(</span>G2<span class="token punctuation">,</span> source<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> target<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span>  <span class="token comment"># 顶点 0 到 顶点 3 的最短加权路径</span>
<span class="token comment"># 两个指定顶点之间的最短加权路径的长度</span>
lMinWPath03 <span class="token operator">=</span> nx<span class="token punctuation">.</span>bellman_ford_path_length<span class="token punctuation">(</span>G2<span class="token punctuation">,</span> source<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> target<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span>  <span class="token comment">#最短加权路径长度</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"顶点 0 到 3 的最短加权路径为：{}，最短加权路径长度为：{}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>minWPath03<span class="token punctuation">,</span> lMinWPath03<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    minWPath0 <span class="token operator">=</span> nx<span class="token punctuation">.</span>bellman_ford_path<span class="token punctuation">(</span>G2<span class="token punctuation">,</span> source<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> target<span class="token operator">=</span>i<span class="token punctuation">)</span>  <span class="token comment"># 顶点 0 到其它顶点的最短加权路径</span>
    lMinPath0 <span class="token operator">=</span> nx<span class="token punctuation">.</span>bellman_ford_path_length<span class="token punctuation">(</span>G2<span class="token punctuation">,</span> source<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> target<span class="token operator">=</span>i<span class="token punctuation">)</span>  <span class="token comment">#最短加权路径长度</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"城市 0 到 城市 {} 机票票价最低的路线为: {}，票价总和为：{}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> minWPath0<span class="token punctuation">,</span> lMinPath0<span class="token punctuation">)</span><span class="token punctuation">)</span>

nx<span class="token punctuation">.</span>draw_shell<span class="token punctuation">(</span>G2<span class="token punctuation">,</span> with_labels<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> node_color<span class="token operator">=</span><span class="token string">'r'</span><span class="token punctuation">,</span> edge_color<span class="token operator">=</span><span class="token string">'b'</span><span class="token punctuation">,</span> font_color<span class="token operator">=</span><span class="token string">'w'</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
    <h4>
     <a id="44__342">
     </a>
     4.4 程序运行结果
    </h4>
    <pre><code class="prism language-python">顶点 <span class="token number">0</span> 到 <span class="token number">3</span> 的最短路径为：<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span>，最短路径长度为：<span class="token number">1</span>
顶点 <span class="token number">0</span> 到 <span class="token number">3</span> 的最短加权路径为：<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span>，最短加权路径长度为：<span class="token number">35</span>
城市 <span class="token number">0</span> 到 城市 <span class="token number">1</span> 机票票价最低的路线为<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span>，票价总和为：<span class="token number">35</span>
城市 <span class="token number">0</span> 到 城市 <span class="token number">2</span> 机票票价最低的路线为<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span>，票价总和为：<span class="token number">45</span>
城市 <span class="token number">0</span> 到 城市 <span class="token number">3</span> 机票票价最低的路线为<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span>，票价总和为：<span class="token number">35</span>
城市 <span class="token number">0</span> 到 城市 <span class="token number">4</span> 机票票价最低的路线为<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span>，票价总和为：<span class="token number">25</span>
城市 <span class="token number">0</span> 到 城市 <span class="token number">5</span> 机票票价最低的路线为<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span>，票价总和为：<span class="token number">10</span>
</code></pre>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/3ba5a26ded3ddd02a2b3cdb4cf001ba9.png#pic_center"/>
    </p>
    <br/>
    <h3>
     <a id="5__357">
     </a>
     5. 总结
    </h3>
    <ol>
     <li>
      最短路径问题是图论研究中的经典算法问题，用于计算图中一个顶点到另一个顶点的最短路径。
     </li>
     <li>
      在图论中，求最短路径长度是要计算从起点到终点步数最少的路径，而求最短路径距离是要计算最短加权路径长度。从例 2的运行结果可以对比二者的区别。
     </li>
     <li>
      求最短路径长度的常用算法是 Dijkstra 算法、Bellman-Ford 算法和Floyd 算法，另外还有启发式算法 A*。
     </li>
     <li>
      对于稀疏的图推荐使用列表形式添加赋权边，对于稠密图、完全图建议使用 DtaFrame 读取数据文件后再转换为 NetworkX 格式。
     </li>
    </ol>
    <p>
     <strong>
      【本节完】
     </strong>
    </p>
    <hr/>
    <br/>
    <p>
     <strong>
      版权声明：
     </strong>
    </p>
    <p>
     <strong>
      欢迎关注
      <a href="https://blog.csdn.net/youcans/category_11031563.html">
       『Python小白的数学建模课 @ Youcans』
      </a>
      原创作品
     </strong>
    </p>
    <p>
     原创作品，转载必须标注原文链接：(https://blog.csdn.net/youcans/article/details/118555468)。
    </p>
    <p>
     Copyright 2021 Youcans, XUPT
    </p>
    <p>
     Crated：2021-07-07
    </p>
    <br/>
    <blockquote>
     <p>
      <strong>
       欢迎关注
       <a href="https://blog.csdn.net/youcans/category_11031563.html">
        『Python小白的数学建模课 @ Youcans』
       </a>
       系列，持续更新
      </strong>
      <br/>
      <a href="https://blog.csdn.net/youcans/article/details/117295222">
       Python小白的数学建模课-01.新手必读
      </a>
      <br/>
      <a href="https://blog.csdn.net/youcans/article/details/117333479">
       Python小白的数学建模课-02.数据导入
      </a>
      <br/>
      <a href="https://blog.csdn.net/youcans/article/details/117388930">
       Python小白的数学建模课-03.线性规划
      </a>
      <br/>
      <a href="https://blog.csdn.net/youcans/article/details/117419635">
       Python小白的数学建模课-04.整数规划
      </a>
      <br/>
      <a href="https://blog.csdn.net/youcans/article/details/117463682">
       Python小白的数学建模课-05.0-1规划
      </a>
      <br/>
      <a href="https://blog.csdn.net/youcans/article/details/117618928">
       Python小白的数学建模课-06.固定费用问题
      </a>
      <br/>
      <a href="https://blog.csdn.net/youcans/article/details/117650843">
       Python小白的数学建模课-07.选址问题
      </a>
      <br/>
      <a href="https://blog.csdn.net/youcans/article/details/117702996">
       Python小白的数学建模课-09.微分方程模型
      </a>
      <br/>
      <a href="https://blog.csdn.net/youcans/article/details/118162990">
       Python小白的数学建模课-10.微分方程边值问题
      </a>
      <br/>
      <a href="https://blog.csdn.net/youcans/article/details/118396836">
       Python小白的数学建模课-12.非线性规划
      </a>
      <br/>
      <a href="https://blog.csdn.net/youcans/article/details/118497645">
       Python小白的数学建模课-15.图论的基本概念
      </a>
      <br/>
      <a href="https://blog.csdn.net/youcans/article/details/118555468">
       Python小白的数学建模课-16.最短路径算法
      </a>
      <br/>
      <a href="https://blog.csdn.net/youcans/article/details/118555468">
       Python小白的数学建模课-17.条件最短路径算法
      </a>
      <br/>
      <a href="https://blog.csdn.net/youcans/article/details/118566422">
       Python小白的数学建模课-18.最小生成树问题
      </a>
      <br/>
      <a href="https://blog.csdn.net/youcans/article/details/118726642">
       Python小白的数学建模课-19.网络流优化问题
      </a>
      <br/>
      <a href="https://blog.csdn.net/youcans/article/details/118882174">
       Python小白的数学建模课-20.网络流优化案例
      </a>
      <br/>
      <a href="https://blog.csdn.net/youcans/article/details/118754623">
       Python小白的数学建模课-21.关键路径法
      </a>
      <br/>
      <a href="https://blog.csdn.net/youcans/article/details/117410678">
       Python小白的数学建模课-A1.国赛赛题类型分析
      </a>
      <br/>
      <a href="https://blog.csdn.net/youcans/article/details/118754623">
       Python小白的数学建模课-21.关键路径法
      </a>
      <br/>
      <a href="https://blog.csdn.net/youcans/article/details/119139374">
       Python小白的数学建模课-22.插值方法
      </a>
      <br/>
      <a href="https://blog.csdn.net/youcans/article/details/117410678">
       Python小白的数学建模课-A1.国赛赛题类型分析
      </a>
      <br/>
      <a href="https://blog.csdn.net/youcans/article/details/117357477">
       Python小白的数学建模课-A2.2021年数维杯C题探讨
      </a>
      <br/>
      <a href="https://blog.csdn.net/youcans/article/details/117519025">
       Python小白的数学建模课-A3.12个新冠疫情数模竞赛赛题及短评
      </a>
      <br/>
      <a href="https://blog.csdn.net/youcans/article/details/117740466">
       Python小白的数学建模课-B2. 新冠疫情 SI模型
      </a>
      <br/>
      <a href="https://blog.csdn.net/youcans/article/details/117786272">
       Python小白的数学建模课-B3. 新冠疫情 SIS模型
      </a>
      <br/>
      <a href="https://blog.csdn.net/youcans/article/details/117843875">
       Python小白的数学建模课-B4. 新冠疫情 SIR模型
      </a>
      <br/>
      <a href="https://blog.csdn.net/youcans/article/details/117932162">
       Python小白的数学建模课-B5. 新冠疫情 SEIR模型
      </a>
      <br/>
      <a href="https://blog.csdn.net/youcans/article/details/118084539">
       Python小白的数学建模课-B6. 新冠疫情 SEIR改进模型
      </a>
     </p>
    </blockquote>
    <br/>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="6874747073:3a2f2f626c6f672e6373646e2e6e65742f796f7563616e732f:61727469636c652f64657461696c732f313138353535343638" class_="artid" style="display:none">
 </p>
</div>


