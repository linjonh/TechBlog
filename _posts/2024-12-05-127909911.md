---
layout: post
title: "小程序-云开发新手入门必看"
date: 2024-12-05 09:01:33 +0800
description: "一.云开发的概念二.云数据库的创建三.云函数的定义四.在页面中调用云函数五.在云函数中如何操作数据库"
keywords: "小程序云开发"
categories: ['前端']
tags: ['小程序', '前端']
artid: "127909911"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=127909911
    alt: "小程序-云开发新手入门必看"
render_with_liquid: false
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     小程序--云开发（新手入门必看）
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <blockquote>
     <p>
      本篇文章主要是分享给要学习云开发的小伙伴们。✅
     </p>
    </blockquote>
    <blockquote>
     <p>
      <code>
       云开发
      </code>
      （CloudBase）是云端一体化的后端云服务 ，采用 serverless 架构，免去了移动应用构建中繁琐的服务器搭建和运维。同时云开发提供的静态托管、命令行工具（CLI）、Flutter SDK 等能力降低了应用开发的门槛。使用云开发可以构建完整的小程序/小游戏、H5、Web、移动 App 等应用。
      <br/>
      有了小程序云开发，可以让让前端程序员拥有后端的能力。当前端写好云函数-&gt;上传到云服务器-&gt;实现自定义云部署，前端通过调用云函数 ，间接通过云函数对数据库进行操作，使得前端向全栈发展提供了便捷。
     </p>
    </blockquote>
    <p>
    </p>
    <div class="toc">
     <h4>
      文章目录
     </h4>
     <ul>
      <li>
       <a href="#_8" rel="nofollow">
        一.云开发的概念
       </a>
      </li>
      <li>
       <a href="#_23" rel="nofollow">
        二.云数据库的创建
       </a>
      </li>
      <li>
       <a href="#_32" rel="nofollow">
        三.云函数的定义
       </a>
      </li>
      <li>
       <a href="#_35" rel="nofollow">
        四.在页面中调用云函数
       </a>
      </li>
      <li>
       <a href="#_37" rel="nofollow">
        五.在云函数中如何操作数据库
       </a>
      </li>
      <li>
       <a href="#_53" rel="nofollow">
        六.云开发注意点(避免踩坑❌）
       </a>
      </li>
      <li>
       <a href="#__74" rel="nofollow">
        七. 上传云文件
       </a>
      </li>
      <li>
       <a href="#__87" rel="nofollow">
        八. 下载文件
       </a>
      </li>
      <li>
       <a href="#__100" rel="nofollow">
        九 .排序
       </a>
      </li>
      <li>
       <a href="#Collectionwhere_111" rel="nofollow">
        十.搜索查询Collection.where()
       </a>
      </li>
      <li>
       <a href="#Collectionskip_127" rel="nofollow">
        十一.分页Collection.skip
       </a>
      </li>
     </ul>
    </div>
    <p>
    </p>
    <h2>
     <a id="_8">
     </a>
     一.云开发的概念
    </h2>
    <ol>
     <li>
      云开发主要由三部分组成
      <br/>
      <code>
       云函数（nodejs）
      </code>
      <code>
       云数据库(mogodb)
      </code>
      <code>
       云存储
      </code>
      <br/>
      1.1 云函数
     </li>
    </ol>
    <blockquote>
     <p>
      云函数是一段运行在云端的代码，无需管理服务器，在开发工具内编写、一键上传部署即可运行后端代码。
     </p>
    </blockquote>
    <p>
     1.2云数据库
    </p>
    <blockquote>
     <p>
      数据库中的每条记录都是一个 JSON 格式的对象。一个数据库可以有多个集合（相当于关系型数据中的表），集合可看做一个 JSON 数组，数组中的每个对象就是一条记录，记录的格式是 JSON 对象。
     </p>
    </blockquote>
    <p>
     1.3 云存储
    </p>
    <blockquote>
     <p>
      云开发提供了一块存储空间，提供了上传文件到云端、带权限管理的云端下载能力，开发者可以在小程序端和云函数端通过 API 使用云存储功能。
     </p>
    </blockquote>
    <h2>
     <a id="_23">
     </a>
     二.云数据库的创建
    </h2>
    <ol>
     <li>
      <p>
       创建云开发的项目（我们可以选择使用一个月免费版本）
       <br/>
       <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/460d0ee697c1792438b9443163152bb9.png"/>
      </p>
     </li>
     <li>
      <p>
       打开右侧云开发，选择数据库，创建集合，再添加数据记录
       <br/>
       <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/25aba6b863ec51501124f6885f8e00b2.png"/>
      </p>
     </li>
     <li>
      <p>
       添加记录时，数据库的记录是不限字段的（本质是json格式，不限定具体的列）
       <br/>
       <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/32e4082d7aae6a8027ff3a9d70ce7e3d.png"/>
      </p>
     </li>
    </ol>
    <h2>
     <a id="_32">
     </a>
     三.云函数的定义
    </h2>
    <p>
     右键创建云函数
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/af7bcfec8ce40e8fa7aacd6b9a285085.png"/>
    </p>
    <h2>
     <a id="_35">
     </a>
     四.在页面中调用云函数
    </h2>
    <p>
     <code>
      wx.cloud.callFunction({name,data})
     </code>
    </p>
    <h2>
     <a id="_37">
     </a>
     五.在云函数中如何操作数据库
    </h2>
    <p>
     1️⃣初始化
    </p>
    <pre><code class="prism language-javascript"><span class="token keyword">var</span> db <span class="token operator">=</span> cloud<span class="token punctuation">.</span><span class="token function">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span>；
</code></pre>
    <p>
     2️⃣获取
    </p>
    <pre><code class="prism language-javascript">	<span class="token keyword">var</span> data <span class="token operator">=</span> <span class="token keyword">await</span> db<span class="token punctuation">.</span><span class="token function">collection</span><span class="token punctuation">(</span><span class="token string">"feedback"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
    <p>
     3️⃣添加
    </p>
    <pre><code class="prism language-javascript"><span class="token keyword">var</span>  data <span class="token operator">=</span> <span class="token keyword">await</span> db<span class="token punctuation">.</span><span class="token function">collection</span><span class="token punctuation">(</span><span class="token string">"feedback"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>data<span class="token operator">:</span><span class="token punctuation">{<!-- --></span>添加数据<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
    <h2>
     <a id="_53">
     </a>
     六.云开发注意点(避免踩坑❌）
    </h2>
    <ol>
     <li>
      遇到Error: errCode: -401003 api parameter type error | errMsg: parameter.path should be string instead of undefined;怎么解决呢
      <br/>
      <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/fc4d5c2d5d0df7c9c259c2f8870f930e.png"/>
     </li>
    </ol>
    <p>
     （1）在app.js定义云id，传入env
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/787ec1aac38a812a5ffe704d2b9e3c1b.png"/>
    </p>
    <p>
     (2)也可以在云函数index.js 定义id
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/9d30260037607da0cc728aad96c69992.png">
      <br/>
      2. 如何找到云id呢
      <br/>
      找到云开发-&gt;找到概览-&gt;复制环境id
      <br/>
      <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/c4c19e40a69715ea2cd0e87e96ff778b.png">
       <br/>
       3. 上传云函数失败怎么办( 🚩🚩🚩）
       <br/>
       <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/8a1a2452812c0546d213e41924b6c9c4.png"/>
       <br/>
       <mark>
        右键选择当前的环境即可，一般为cloud1
       </mark>
       <br/>
       <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/9e1689552dc30f33a6878b03419d4167.png"/>
      </img>
     </img>
    </p>
    <ol start="4">
     <li>
      当新建Page之后一定要记得上传并部署云安装依赖
      <br/>
      <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/bec43ce930ee28d208c0bf9fcb4bda70.png"/>
     </li>
     <li>
      当对文件进行修改之后，也一定不要忘了增量上传
      <br/>
      <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/a72cc2480e32786e4296c73f8bc7ec40.png"/>
     </li>
    </ol>
    <h2>
     <a id="__74">
     </a>
     七. 上传云文件
    </h2>
    <blockquote>
     <p>
      在小程序端可调用 wx.cloud.uploadFile 方法进行上传（上传成功后会获得文件唯一标识符，即文件 ID，后续操作都基于文件 ID 而不是 URL）
     </p>
    </blockquote>
    <pre><code class="prism language-javascript">wx<span class="token punctuation">.</span>cloud<span class="token punctuation">.</span><span class="token function">uploadFile</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
  <span class="token literal-property property">cloudPath</span><span class="token operator">:</span> <span class="token string">'example.png'</span><span class="token punctuation">,</span> <span class="token comment">// 上传至云端的路径</span>
  <span class="token literal-property property">filePath</span><span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span> <span class="token comment">// 小程序临时文件路径</span>
  <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 返回文件 ID</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>fileID<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">fail</span><span class="token operator">:</span> console<span class="token punctuation">.</span>error
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
    <h2>
     <a id="__87">
     </a>
     八. 下载文件
    </h2>
    <blockquote>
     <p>
      可以根据文件 ID 下载文件，用户仅可下载其有访问权限的文件
     </p>
    </blockquote>
    <pre><code class="prism language-javascript">wx<span class="token punctuation">.</span>cloud<span class="token punctuation">.</span><span class="token function">downloadFile</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
  <span class="token literal-property property">fileID</span><span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span> <span class="token comment">// 文件 ID</span>
  <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 返回临时文件路径</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>tempFilePath<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">fail</span><span class="token operator">:</span> console<span class="token punctuation">.</span>error
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
    <h2>
     <a id="__100">
     </a>
     九 .排序
    </h2>
    <p>
     Aggregate.sort()根据指定的字段，对输入的文档进行排序
    </p>
    <blockquote>
     <p>
      sort({
      <!-- -->
      <br/>
      &lt;字段名1&gt;: &lt;排序规则&gt;,
      <br/>
      &lt;字段名2&gt;: &lt;排序规则&gt;,
      <br/>
      })
     </p>
    </blockquote>
    <p>
     &lt;排序规则&gt;可以是以下取值：
     <br/>
     <mark>
      1 代表升序排列
     </mark>
     （从小到大）；
     <br/>
     <mark>
      -1 代表降序排列
     </mark>
     （从大到小）
    </p>
    <h2>
     <a id="Collectionwhere_111">
     </a>
     十.搜索查询Collection.where()
    </h2>
    <blockquote>
     <p>
      指定查询条件，返回带新查询条件的新的集合引用
     </p>
    </blockquote>
    <p>
     参数
    </p>
    <pre><code class="prism language-javascript">db<span class="token punctuation">.</span><span class="token function">collection</span><span class="token punctuation">(</span><span class="token string">'todos'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
  <span class="token literal-property property">_openid</span><span class="token operator">:</span> <span class="token string">'user-open-id'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">done</span><span class="token operator">:</span> <span class="token boolean">false</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
  <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// res.data 是包含以上定义的两条记录的数组</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
    <h2>
     <a id="Collectionskip_127">
     </a>
     十一.分页Collection.skip
    </h2>
    <p>
     Collection.skip指定查询返回结果时从指定序列后的结果开始返回，常用于分页
    </p>
    <pre><code class="prism language-javascript">db<span class="token punctuation">.</span><span class="token function">collection</span><span class="token punctuation">(</span><span class="token string">'todos'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">skip</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>console<span class="token punctuation">.</span>log<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span>console<span class="token punctuation">.</span>error<span class="token punctuation">)</span>
</code></pre>
    <blockquote>
     <p>
      以上就是云开发的全部内容啦，如果对你有用不要忘了一键三连哦😘
     </p>
    </blockquote>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/7733d7b0647d4a01de59cbfa0805baa1.jpeg"/>
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f6d305f35353733343033302f:61727469636c652f64657461696c732f313237393039393131" class_="artid" style="display:none">
 </p>
</div>


