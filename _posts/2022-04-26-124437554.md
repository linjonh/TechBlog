---
layout: post
title: "python数据预处理补充缺失数据,划分训练集和测试集"
date: 2022-04-26 21:25:29 +0800
description: "> 步骤回顾> 1.  pandas导入数据> 2. 自变量和因变量分离> 3. 缺失值处理> 4."
keywords: "python划分训练集"
categories: ['Python']
tags: ['Python']
artid: "124437554"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=124437554
    alt: "python数据预处理补充缺失数据,划分训练集和测试集"
render_with_liquid: false
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     python数据预处理：补充缺失数据，划分训练集和测试集
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <ol>
     <li>
      <p>
       算法处理的是数据，不是字符串，也不是布尔值True或者False。
      </p>
     </li>
     <li>
      <p>
       不可以删除数据。可以求平均值
      </p>
     </li>
     <li>
      <p>
       对于字符串类型以及布尔类型的分类数据。需要转换成0，1，2这样的数字索引。
      </p>
     </li>
    </ol>
    <h3>
     <a id="1__4">
     </a>
     1. 导入数据，划分自变量、因变量，补充缺失值
    </h3>
    <pre><code class="prism language-python">
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
dataset<span class="token operator">=</span>pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'Data2.csv'</span><span class="token punctuation">)</span>

X<span class="token operator">=</span>dataset<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>values<span class="token comment"># 取每一行的前3列</span>
y<span class="token operator">=</span>dataset<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">.</span>values<span class="token comment"># 取所有行的最后一列</span>

<span class="token comment"># 用平均数补充缺失值</span>
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>impute <span class="token keyword">import</span> SimpleImputer
imputer<span class="token operator">=</span>SimpleImputer<span class="token punctuation">(</span>missing_values<span class="token operator">=</span>np<span class="token punctuation">.</span>nan<span class="token punctuation">,</span>strategy<span class="token operator">=</span><span class="token string">"mean"</span><span class="token punctuation">)</span>
imputer<span class="token operator">=</span>imputer<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
X<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">=</span>imputer<span class="token punctuation">.</span>transform<span class="token punctuation">(</span>X<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>```
</code></pre>
    <p>
     使用数据如下：
    </p>
    <p>
     Country Age Salary Purchased
     <br/>
     0 France 44.0 72000.0 No
     <br/>
     1 Spain 27.0 48000.0 Yes
     <br/>
     2 Germany 30.0 54000.0 No
     <br/>
     3 Spain 38.0 61000.0 No
     <br/>
     4 Germany 40.0 NaN Yes
     <br/>
     5 France 35.0 58000.0 Yes
     <br/>
     6 Spain NaN 52000.0 No
     <br/>
     7 France 48.0 79000.0 Yes
     <br/>
     8 Germany 50.0 83000.0 No
     <br/>
     9 France 37.0 67000.0 Yes
    </p>
    <h3>
     <a id="2_onehot_35">
     </a>
     2. 字符串编码成数字或onehot
    </h3>
    <p>
     直接对字符编码成1，2，3的缺点
    </p>
    <blockquote>
     <p>
      本来平等的字符串，变成1，2，3之后，好像有先后或者大小顺序了。这不太好，所以要用onehot编码。
     </p>
    </blockquote>
    <pre><code class="prism language-python"><span class="token comment">#直接编码成数字</span>
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>preprocessing <span class="token keyword">import</span> LabelEncoder
labelencoder_y<span class="token operator">=</span>LabelEncoder<span class="token punctuation">(</span><span class="token punctuation">)</span>
y<span class="token operator">=</span>labelencoder_y<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>y<span class="token punctuation">)</span>

labelencoder_X<span class="token operator">=</span>LabelEncoder<span class="token punctuation">(</span><span class="token punctuation">)</span>
X<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=</span>labelencoder_X<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>X<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment"># 改成onehot编码，只对第一列就可以</span>
<span class="token comment">#onehot编码</span>
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>preprocessing <span class="token keyword">import</span> OneHotEncoder
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>compose <span class="token keyword">import</span> ColumnTransformer
onehotencoder <span class="token operator">=</span> ColumnTransformer<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token string">'encoder'</span><span class="token punctuation">,</span> OneHotEncoder<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> remainder <span class="token operator">=</span> <span class="token string">'passthrough'</span><span class="token punctuation">)</span>

X <span class="token operator">=</span> onehotencoder<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>X<span class="token punctuation">)</span>

</code></pre>
    <h3>
     <a id="3__58">
     </a>
     3. 划分训练集与测试集
    </h3>
    <pre><code class="prism language-python"><span class="token comment">#from sklearn.cross_validation import train_test_split</span>
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_split
X_train<span class="token punctuation">,</span>X_test<span class="token punctuation">,</span>y_train<span class="token punctuation">,</span>y_test<span class="token operator">=</span>train_test_split<span class="token punctuation">(</span>X<span class="token punctuation">,</span>y<span class="token punctuation">,</span>test_size<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">,</span>random_state<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
</code></pre>
    <h3>
     <a id="4__65">
     </a>
     4. 特征缩放
    </h3>
    <p>
     避免因为数据量级的不同导致不同特征对结果的影响不同。
     <br/>
     特征缩放有两种方式：
    </p>
    <ol>
     <li>
      标准化
     </li>
     <li>
      归一化
      <br/>
      标准化：
     </li>
    </ol>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/f64635c64a0242798a7280e013ef7a46.png">
      <br/>
      归一化
      <br/>
      <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/83ba537dfa48c67bcab0bc3102ac33a3.png"/>
     </img>
    </p>
    <pre><code class="prism language-python"><span class="token comment">#工资比年龄的数字大，所以需要进行特征缩放</span>
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>preprocessing <span class="token keyword">import</span> StandardScaler

standardScaler<span class="token operator">=</span>StandardScaler<span class="token punctuation">(</span><span class="token punctuation">)</span>
X_train<span class="token operator">=</span>standardScaler<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>X_train<span class="token punctuation">)</span>
X_test<span class="token operator">=</span>standardScaler<span class="token punctuation">.</span>transform<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span>
</code></pre>
    <blockquote>
     <p>
      步骤回顾
     </p>
     <ol>
      <li>
       pandas导入数据
      </li>
      <li>
       自变量和因变量分离
      </li>
      <li>
       缺失值处理
      </li>
      <li>
       字符串变成数字
      </li>
      <li>
       划分训练集和测试集
      </li>
      <li>
       特征缩放
      </li>
     </ol>
    </blockquote>
    <p>
     注意事项总结：
    </p>
    <blockquote>
     <ol>
      <li>
       不能有数据缺失的情况
      </li>
      <li>
       所有分类类型的数据变成数字类型的数据
      </li>
      <li>
       特征缩放。算法不能知道哪个特征更重要，不能让某个特征主导了计算结果。应该
       <strong>
        让不同的特征无差别地影响结果
       </strong>
       。
      </li>
     </ol>
    </blockquote>
    <p>
     预处理的好处是能够更快地收敛，更接近真实的结果，会极大地减少训练的时间，提升预测的准确度。
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f6d305f34363337313938382f:61727469636c652f64657461696c732f313234343337353534" class_="artid" style="display:none">
 </p>
</div>


