---
layout: post
title: "pytest介绍"
date: 2024-12-09 21:46:34 +0800
description: "官网方文档https://docs.pytest.org/en/latest/contents.ht"
keywords: "pytest是什么"
categories: ["未分类"]
tags: ["Selenium", "Python"]
artid: "124147614"
image:
  path: https://api.vvhan.com/api/bing?rand=sj&artid=124147614
  alt: "pytest介绍"
render_with_liquid: false
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     pytest介绍
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
     官网方文档
     <a href="https://docs.pytest.org/en/latest/contents.html" rel="nofollow">
      https://docs.pytest.org/en/latest/contents.html
     </a>
    </p>
    <pre><code class="prism language-python">

pytest 是一个非常成熟的全功能的 Python 测试框架，主要有以下几个特点：

简单灵活，容易上手
支持参数化
能够支持简单的单元测试和复杂的功能测试，还可以用来做 selenium<span class="token operator">/</span>appnium 等自动化测试、接口自动化测试（pytest<span class="token operator">+</span>requests）
pytest 具有很多第三方插件，并且可以自定义扩展，比较好用的如 pytest<span class="token operator">-</span>selenium（集成 selenium）、pytest<span class="token operator">-</span>html（完美 html 测试报告生成）、pytest<span class="token operator">-</span>rerunfailures（失败<span class="token keyword">case</span>重复执行）、pytest<span class="token operator">-</span>xdist（多 CPU 分发）等
测试用例的 skip 和 xfail 处理
可以很好的和 jenkins 集成
report 框架<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>allure 也支持了 pytest
<span class="token number">1</span>、pytest 安装
<span class="token number">1.1</span>安装

pip install <span class="token operator">-</span>U pytest

<span class="token number">1.2</span>验证安装

pytest <span class="token operator">-</span><span class="token operator">-</span>version <span class="token comment"># 会展示当前已安装版本</span>

<span class="token number">1</span><span class="token punctuation">.</span>3pytest 文档

官方文档：https<span class="token punctuation">:</span><span class="token operator">//</span>docs<span class="token punctuation">.</span>pytest<span class="token punctuation">.</span>org<span class="token operator">/</span>en<span class="token operator">/</span>latest<span class="token operator">/</span>contents<span class="token punctuation">.</span>html

在 pytest 框架中，有如下约束：

所有的单测文件名都需要满足 test*<span class="token operator">*</span><span class="token punctuation">.</span>py 格式或<span class="token operator">*</span>\_test<span class="token punctuation">.</span>py 格式。
在单测文件中，测试类以 Test 开头，并且不能带有 init 方法<span class="token punctuation">(</span>注意：定义<span class="token keyword">class</span>时，需要以 T 开头，不然 pytest 是不会去运行该<span class="token keyword">class</span>的<span class="token punctuation">)</span>
在单测类中，可以包含一个或多个 test*开头的函数。
此时，在执行 pytest 命令时，会自动从当前目录及子目录中寻找符合上述约束的测试函数来执行。

<span class="token number">1.4</span> Pytest 运行方式

<span class="token comment"># file_name: test_abc.py</span>
<span class="token keyword">import</span> pytest <span class="token comment"># 引入 pytest 包</span>
<span class="token keyword">def</span> <span class="token function">test_a</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment"># test 开头的测试函数</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-------&gt;test_a"</span><span class="token punctuation">)</span>
<span class="token keyword">assert</span> <span class="token number">1</span> <span class="token comment"># 断言成功</span>
<span class="token keyword">def</span> <span class="token function">test_b</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-------&gt;test_b"</span><span class="token punctuation">)</span>
<span class="token keyword">assert</span> <span class="token number">0</span> <span class="token comment"># 断言失败</span>
<span class="token keyword">if</span> **name** <span class="token operator">==</span> <span class="token string">'**main**'</span><span class="token punctuation">:</span>
pytest<span class="token punctuation">.</span>main<span class="token punctuation">(</span><span class="token string">"-s test_abc.py"</span><span class="token punctuation">)</span> <span class="token comment"># 调用 pytest 的 main 函数执行测试 </span>

<span class="token number">1.</span>测试类主函数模式

pytest<span class="token punctuation">.</span>main<span class="token punctuation">(</span><span class="token string">"-s test_abc.py"</span><span class="token punctuation">)</span>

<span class="token number">2.</span>命令行模式

pytest 文件路径／测试文件名
例如：pytest <span class="token punctuation">.</span><span class="token operator">/</span>test_abc<span class="token punctuation">.</span>py

<span class="token number">1.5</span> Pytest Exit Code 含义清单

Exit code <span class="token number">0</span> 所有用例执行完毕，全部通过
Exit code <span class="token number">1</span> 所有用例执行完毕，存在 Failed 的测试用例
Exit code <span class="token number">2</span> 用户中断了测试的执行
Exit code <span class="token number">3</span> 测试执行过程发生了内部错误
Exit code <span class="token number">4</span> pytest 命令行使用错误
Exit code <span class="token number">5</span> 未采集到可用测试用例文件

<span class="token number">1.6</span> 如何获取帮助信息

查看 pytest 版本

pytest <span class="token operator">-</span><span class="token operator">-</span>version
显示可用的内置函数参数

pytest <span class="token operator">-</span><span class="token operator">-</span>fixtures
通过命令行查看帮助信息及配置文件选项

pytest <span class="token operator">-</span><span class="token operator">-</span><span class="token builtin">help</span>

<span class="token number">1.7</span> 控制测试用例执行

<span class="token number">1.</span>在第 N 个用例失败后，结束测试执行

pytest <span class="token operator">-</span>x <span class="token comment"># 第 01 次失败，就停止测试</span>
pytest <span class="token operator">-</span><span class="token operator">-</span>maxfail<span class="token operator">=</span><span class="token number">2</span> <span class="token comment"># 出现 2 个失败就终止测试</span>
<span class="token number">2.</span>指定测试模块

pytest test_mod<span class="token punctuation">.</span>py
<span class="token number">3.</span>指定测试目录

pytest testing<span class="token operator">/</span>
<span class="token number">4.</span>通过关键字表达式过滤执行

pytest <span class="token operator">-</span>k <span class="token string">"MyClass and not method"</span>
这条命令会匹配文件名、类名、方法名匹配表达式的用例，这里这条命令会运行 TestMyClass<span class="token punctuation">.</span>test_something， 不会执行 TestMyClass<span class="token punctuation">.</span>test_method_simple

<span class="token number">5.</span>通过 node <span class="token builtin">id</span> 指定测试用例

nodeid 由模块文件名、分隔符、类名、方法名、参数构成，举例如下：
运行模块中的指定用例

pytest test_mod<span class="token punctuation">.</span>py<span class="token punctuation">:</span><span class="token punctuation">:</span>test_func
运行模块中的指定方法

ytest test_mod<span class="token punctuation">.</span>py<span class="token punctuation">:</span><span class="token punctuation">:</span>TestClass<span class="token punctuation">:</span><span class="token punctuation">:</span>test_method
<span class="token number">6.</span>通过标记表达式执行

pytest <span class="token operator">-</span>m slow
这条命令会执行被装饰器 @pytest<span class="token punctuation">.</span>mark<span class="token punctuation">.</span>slow 装饰的所有测试用例

<span class="token number">7.</span>通过包执行测试

pytest <span class="token operator">-</span><span class="token operator">-</span>pyargs pkg<span class="token punctuation">.</span>testing
这条命令会自动导入包 pkg<span class="token punctuation">.</span>testing，并使用该包所在的目录，执行下面的用例。

<span class="token number">1.8</span> 多进程运行 cases

当 cases 量很多时，运行时间也会变的很长，如果想缩短脚本运行的时长，就可以用多进程来运行。

安装 pytest<span class="token operator">-</span>xdist：

pip install <span class="token operator">-</span>U pytest<span class="token operator">-</span>xdist
运行模式：

pytest test_se<span class="token punctuation">.</span>py <span class="token operator">-</span>n NUM
其中 NUM 填写并发的进程数。

<span class="token number">1.9</span> 重试运行 cases

在做接口测试时，有事会遇到<span class="token number">503</span>或短时的网络波动，导致<span class="token keyword">case</span>运行失败，而这并非是我们期望的结果，此时可以就可以通过重试运行 cases 的方式来解决。

安装 pytest<span class="token operator">-</span>rerunfailures：

pip install <span class="token operator">-</span>U pytest<span class="token operator">-</span>rerunfailures
运行模式：

pytest test_se<span class="token punctuation">.</span>py <span class="token operator">-</span><span class="token operator">-</span>reruns NUM
NUM 填写重试的次数。

<span class="token number">1.10</span> 显示<span class="token keyword">print</span>内容

在运行测试脚本时，为了调试或打印一些内容，我们会在代码中加一些<span class="token keyword">print</span>内容，但是在运行 pytest 时，这些内容不会显示出来。如果带上<span class="token operator">-</span>s，就可以显示了。

运行模式：

pytest test_se<span class="token punctuation">.</span>py <span class="token operator">-</span>s
另外，pytest 的多种运行模式是可以叠加执行的，比如说，你想同时运行<span class="token number">4</span>个进程，又想打印出<span class="token keyword">print</span>的内容。可以用：

pytest test_se<span class="token punctuation">.</span>py <span class="token operator">-</span>s <span class="token operator">-</span>n <span class="token number">4</span>

<span class="token number">2</span><span class="token punctuation">.</span>Pytest 的 setup 和 teardown 函数
<span class="token number">1</span><span class="token punctuation">.</span>setup 和 teardown 主要分为：模块级<span class="token punctuation">,</span>类级，功能级，函数级。
<span class="token number">2.</span>存在于测试类内部
代码示例：

函数级别 setup<span class="token punctuation">(</span><span class="token punctuation">)</span>／teardown<span class="token punctuation">(</span><span class="token punctuation">)</span>
运行于测试方法的始末，即<span class="token punctuation">:</span>运行一次测试函数会运行一次 setup 和 teardown

<span class="token keyword">import</span> pytest
<span class="token keyword">class</span> <span class="token class-name">Test_ABC</span><span class="token punctuation">:</span>
<span class="token comment"># 函数级开始</span>
<span class="token keyword">def</span> <span class="token function">setup</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-------&gt;setup_method"</span><span class="token punctuation">)</span>
<span class="token comment"># 函数级结束</span>
<span class="token keyword">def</span> <span class="token function">teardown</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-------&gt;teardown_method"</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">test_a</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-------&gt;test_a"</span><span class="token punctuation">)</span>
<span class="token keyword">assert</span> <span class="token number">1</span>
<span class="token keyword">def</span> <span class="token function">test_b</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-------&gt;test_b"</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> **name** <span class="token operator">==</span> <span class="token string">'**main**'</span><span class="token punctuation">:</span>
pytest<span class="token punctuation">.</span>main<span class="token punctuation">(</span><span class="token string">"-s test_abc.py"</span><span class="token punctuation">)</span>
执行结果：
test_abc<span class="token punctuation">.</span>py
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>setup_method <span class="token comment"># 第一次 setup()</span>
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>test_a
<span class="token punctuation">.</span>
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>teardown_method <span class="token comment"># 第一次 teardown()</span>
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>setup_method <span class="token comment"># 第二次 setup()</span>
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>test_b
<span class="token punctuation">.</span>
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>teardown_method <span class="token comment"># 第二次 teardown()</span>
<span class="token number">2.2</span><span class="token punctuation">.</span>类级别
运行于测试类的始末，即<span class="token punctuation">:</span>在一个测试内只运行一次 setup_class 和 teardown_class，不关心测试类内有多少个测试函数。
代码示例：

<span class="token keyword">import</span> pytest
<span class="token keyword">class</span> <span class="token class-name">Test_ABC</span><span class="token punctuation">:</span>
<span class="token comment"># 测试类级开始</span>
<span class="token keyword">def</span> <span class="token function">setup_class</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-------&gt;setup_class"</span><span class="token punctuation">)</span>
<span class="token comment"># 测试类级结束</span>
<span class="token keyword">def</span> <span class="token function">teardown_class</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-------&gt;teardown_class"</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">test_a</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-------&gt;test_a"</span><span class="token punctuation">)</span>
<span class="token keyword">assert</span> <span class="token number">1</span>
<span class="token keyword">def</span> <span class="token function">test_b</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-------&gt;test_b"</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> **name** <span class="token operator">==</span> <span class="token string">'**main**'</span><span class="token punctuation">:</span>
pytest<span class="token punctuation">.</span>main<span class="token punctuation">(</span><span class="token string">"-s test_abc.py"</span><span class="token punctuation">)</span>
执行结果：
test_abc<span class="token punctuation">.</span>py
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>setup_class <span class="token comment"># 第一次 setup_class()</span>
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>test_a
<span class="token punctuation">.</span>
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>test_b
F
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>teardown_class <span class="token comment"># 第一次 teardown_class()</span>
<span class="token number">3</span><span class="token punctuation">.</span>Pytest 配置文件
pytest 的配置文件通常放在测试目录下，名称为 pytest<span class="token punctuation">.</span>ini，命令行运行时会使用该配置文件中的配置<span class="token punctuation">.</span>

<span class="token comment">#配置 pytest 命令行运行参数</span>
<span class="token punctuation">[</span>pytest<span class="token punctuation">]</span>
addopts <span class="token operator">=</span> <span class="token operator">-</span>s <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token comment"># 空格分隔，可添加多个命令行参数 -所有参数均为插件包的参数配置测试搜索的路径</span>
testpaths <span class="token operator">=</span> <span class="token punctuation">.</span><span class="token operator">/</span>scripts <span class="token comment"># 当前目录下的 scripts 文件夹 -可自定义</span>
<span class="token comment">#配置测试搜索的文件名称</span>
python*files <span class="token operator">=</span> test<span class="token operator">\*</span><span class="token punctuation">.</span>py
<span class="token comment">#当前目录下的 scripts 文件夹下，以 test 开头，以.py 结尾的所有文件 -可自定义</span>
配置测试搜索的测试类名
python_classes <span class="token operator">=</span> Test*<span class="token operator">\*</span>
<span class="token comment">#当前目录下的 scripts 文件夹下，以 test 开头，以.py 结尾的所有文件中，以 Test 开头的类 -可自定义</span>
配置测试搜索的测试函数名

python*functions <span class="token operator">=</span> test*<span class="token operator">\*</span>
<span class="token comment">#当前目录下的 scripts 文件夹下，以 test 开头，以.py 结尾的所有文件中，以 Test 开头的类内，以 test\_开头的方法 -可自定义</span>

<span class="token number">4</span> Pytest 常用插件
插件列表网址：https<span class="token punctuation">:</span><span class="token operator">//</span>plugincompat<span class="token punctuation">.</span>herokuapp<span class="token punctuation">.</span>com
包含很多插件包，大家可依据工作的需求选择使用。

<span class="token number">4.1</span> 前置条件：
<span class="token number">1.</span>文件路径：

<span class="token operator">-</span> Test_App
<span class="token operator">-</span> <span class="token operator">-</span> test_abc<span class="token punctuation">.</span>py
<span class="token operator">-</span> <span class="token operator">-</span> pytest<span class="token punctuation">.</span>ini
<span class="token number">2</span><span class="token punctuation">.</span>pyetst<span class="token punctuation">.</span>ini 配置文件内容：

<span class="token punctuation">[</span>pytest<span class="token punctuation">]</span>
<span class="token comment"># 命令行参数</span>
addopts <span class="token operator">=</span> <span class="token operator">-</span>s
<span class="token comment"># 搜索文件名</span>
python*files <span class="token operator">=</span> test*<span class="token operator">_</span><span class="token punctuation">.</span>py
<span class="token comment"># 搜索的类名</span>
python*classes <span class="token operator">=</span> Test*<span class="token operator">_</span>
<span class="token comment">#搜索的函数名</span>
python*functions <span class="token operator">=</span> test*<span class="token operator">\*</span>
<span class="token number">4.2</span> Pytest 测试报告
pytest<span class="token operator">-</span>HTML 是一个插件，pytest 用于生成测试结果的 HTML 报告。兼容 Python <span class="token number">2.7</span><span class="token punctuation">,</span><span class="token number">3.6</span>

安装方式：pip install pytest<span class="token operator">-</span>html

pip install pytest<span class="token operator">-</span>html
通过命令行方式，生成 xml<span class="token operator">/</span>html 格式的测试报告，存储于用户指定路径。插件名称：pytest<span class="token operator">-</span>html

使用方法： 命令行格式：pytest <span class="token operator">-</span><span class="token operator">-</span>html<span class="token operator">=</span>用户路径<span class="token operator">/</span>report<span class="token punctuation">.</span>html

示例：

<span class="token keyword">import</span> pytest
<span class="token keyword">class</span> <span class="token class-name">Test_ABC</span><span class="token punctuation">:</span>
<span class="token keyword">def</span> <span class="token function">setup_class</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-------&gt;setup_class"</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">teardown_class</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-------&gt;teardown_class"</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">test_a</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-------&gt;test_a"</span><span class="token punctuation">)</span>
<span class="token keyword">assert</span> <span class="token number">1</span>
<span class="token keyword">def</span> <span class="token function">test_b</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-------&gt;test_b"</span><span class="token punctuation">)</span>
<span class="token keyword">assert</span> <span class="token number">0</span> <span class="token comment"># 断言失败```</span>
运行方式：
<span class="token number">1.</span>修改 Test_App<span class="token operator">/</span>pytest<span class="token punctuation">.</span>ini 文件，添加报告参数，即：addopts <span class="token operator">=</span> <span class="token operator">-</span>s <span class="token operator">-</span><span class="token operator">-</span>html<span class="token operator">=</span><span class="token punctuation">.</span><span class="token operator">/</span>report<span class="token punctuation">.</span>html
<span class="token comment"># -s:输出程序运行信息</span>
<span class="token comment"># --html=./report.html 在当前目录下生成 report.html 文件</span>
️ 若要生成 xml 文件，可将<span class="token operator">-</span><span class="token operator">-</span>html<span class="token operator">=</span><span class="token punctuation">.</span><span class="token operator">/</span>report<span class="token punctuation">.</span>html 改成 <span class="token operator">-</span><span class="token operator">-</span>html<span class="token operator">=</span><span class="token punctuation">.</span><span class="token operator">/</span>report<span class="token punctuation">.</span>xml
<span class="token number">2.</span>命令行进入 Test_App 目录
<span class="token number">3.</span>执行命令： pytest
执行结果：
<span class="token number">1.</span>在当前目录会生成 assets 文件夹和 report<span class="token punctuation">.</span>html 文件

<span class="token number">5</span><span class="token punctuation">.</span>pytest 的高阶用法<span class="token punctuation">(</span>一<span class="token punctuation">)</span>
前置条件：

<span class="token number">1.</span>文件路径：

Test*App
<span class="token operator">-</span> <span class="token operator">-</span> test_abc<span class="token punctuation">.</span>py
<span class="token operator">-</span> <span class="token operator">-</span> pytest<span class="token punctuation">.</span>ini
<span class="token number">2</span><span class="token punctuation">.</span>pyetst<span class="token punctuation">.</span>ini 配置文件内容：
<span class="token punctuation">[</span>pytest<span class="token punctuation">]</span>
命令行参数
addopts <span class="token operator">=</span> <span class="token operator">-</span>s
搜索文件名
python_files <span class="token operator">=</span> test<span class="token operator">*</span><span class="token punctuation">.</span>py
搜索的类名
python_classes <span class="token operator">=</span> Test<span class="token operator">*</span>
搜索的函数名
python_functions <span class="token operator">=</span> test*<span class="token operator">\*</span>

<span class="token number">5</span><span class="token punctuation">.</span>1pytest 之 fixture
fixture 修饰器来标记固定的工厂函数<span class="token punctuation">,</span>在其他函数，模块，类或整个工程调用它时会被激活并优先执行<span class="token punctuation">,</span>通常会被用于完成预置处理和重复操作。

方法：fixture<span class="token punctuation">(</span>scope<span class="token operator">=</span><span class="token string">"function"</span><span class="token punctuation">,</span> params<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> autouse<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> ids<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span>
常用参数<span class="token punctuation">:</span>

scope：被标记方法的作用域
function" <span class="token punctuation">(</span>default<span class="token punctuation">)</span>：作用于每个测试方法，每个 test 都运行一次
<span class="token string">"class"</span>：作用于整个类，每个<span class="token keyword">class</span>的所有 test 只运行一次
<span class="token string">"module"</span>：作用于整个模块，每个 module 的所有 test 只运行一次
"session：作用于整个 session<span class="token punctuation">(</span>慎用<span class="token punctuation">)</span>，每个 session 只运行一次
params：<span class="token punctuation">(</span><span class="token builtin">list</span>类型<span class="token punctuation">)</span>提供参数数据，供调用标记方法的函数使用
autouse：是否自动运行<span class="token punctuation">,</span>默认为<span class="token boolean">False</span>不运行，设置为<span class="token boolean">True</span>自动运行

<span class="token number">5</span><span class="token punctuation">.</span>2fixture 第一个例子<span class="token punctuation">(</span>通过参数引用<span class="token punctuation">)</span>
示例：

<span class="token keyword">class</span> <span class="token class-name">Test_ABC</span><span class="token punctuation">:</span>
<span class="token decorator annotation punctuation">@pytest<span class="token punctuation">.</span>fixture</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">before</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-------&gt;before"</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">test_a</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>before<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment"># ️ test_a 方法传入了被 fixture 标识的函数，已变量的形式</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-------&gt;test_a"</span><span class="token punctuation">)</span>
<span class="token keyword">assert</span> <span class="token number">1</span>
<span class="token keyword">if</span> **name** <span class="token operator">==</span> <span class="token string">'**main**'</span><span class="token punctuation">:</span>
pytest<span class="token punctuation">.</span>main<span class="token punctuation">(</span><span class="token string">"-s test_abc.py"</span><span class="token punctuation">)</span>
执行结果：
test_abc<span class="token punctuation">.</span>py
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>before <span class="token comment"># 发现 before 会优先于测试函数运行</span>
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>test_a
<span class="token punctuation">.</span>
<span class="token number">5.3</span><span class="token punctuation">.</span>fixture 第二个例子<span class="token punctuation">(</span>通过函数引用<span class="token punctuation">)</span>
示例：

<span class="token keyword">import</span> pytest
<span class="token decorator annotation punctuation">@pytest<span class="token punctuation">.</span>fixture</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># fixture 标记的函数可以应用于测试类外部</span>
<span class="token keyword">def</span> <span class="token function">before</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-------&gt;before"</span><span class="token punctuation">)</span>
<span class="token decorator annotation punctuation">@pytest<span class="token punctuation">.</span>mark<span class="token punctuation">.</span>usefixtures</span><span class="token punctuation">(</span><span class="token string">"before"</span><span class="token punctuation">)</span>
<span class="token keyword">class</span> <span class="token class-name">Test_ABC</span><span class="token punctuation">:</span>
<span class="token keyword">def</span> <span class="token function">setup</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-------&gt;setup"</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">test_a</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-------&gt;test_a"</span><span class="token punctuation">)</span>
<span class="token keyword">assert</span> <span class="token number">1</span>
<span class="token keyword">if</span> **name** <span class="token operator">==</span> <span class="token string">'**main**'</span><span class="token punctuation">:</span>
pytest<span class="token punctuation">.</span>main<span class="token punctuation">(</span><span class="token string">"-s test_abc.py"</span><span class="token punctuation">)</span>
执行结果：
test_abc<span class="token punctuation">.</span>py
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>before <span class="token comment"># 发现 before 会优先于测试类运行</span>
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>setup
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>test_a
<span class="token punctuation">.</span>
<span class="token number">5.4</span><span class="token punctuation">.</span>fixture 第三个例子<span class="token punctuation">(</span>默认设置为运行<span class="token punctuation">)</span>
示例：

<span class="token keyword">import</span> pytest
<span class="token decorator annotation punctuation">@pytest<span class="token punctuation">.</span>fixture</span><span class="token punctuation">(</span>autouse<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span> <span class="token comment"># 设置为默认运行</span>
<span class="token keyword">def</span> <span class="token function">before</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-------&gt;before"</span><span class="token punctuation">)</span>
<span class="token keyword">class</span> <span class="token class-name">Test_ABC</span><span class="token punctuation">:</span>
<span class="token keyword">def</span> <span class="token function">setup</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-------&gt;setup"</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">test_a</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-------&gt;test_a"</span><span class="token punctuation">)</span>
<span class="token keyword">assert</span> <span class="token number">1</span>
<span class="token keyword">if</span> **name** <span class="token operator">==</span> <span class="token string">'**main**'</span><span class="token punctuation">:</span>
pytest<span class="token punctuation">.</span>main<span class="token punctuation">(</span><span class="token string">"-s test_abc.py"</span><span class="token punctuation">)</span>
执行结果：
test_abc<span class="token punctuation">.</span>py
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>before <span class="token comment"># 发现 before 自动优先于测试类运行</span>
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>setup
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>test_a
<span class="token punctuation">.</span>
<span class="token number">5.5</span><span class="token punctuation">.</span>fixture 第四个例子<span class="token punctuation">(</span>设置作用域为 function<span class="token punctuation">)</span>
示例：

<span class="token keyword">import</span> pytest
<span class="token decorator annotation punctuation">@pytest<span class="token punctuation">.</span>fixture</span><span class="token punctuation">(</span>scope<span class="token operator">=</span><span class="token string">'function'</span><span class="token punctuation">,</span>autouse<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span> <span class="token comment"># 作用域设置为 function，自动运行</span>
<span class="token keyword">def</span> <span class="token function">before</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-------&gt;before"</span><span class="token punctuation">)</span>
<span class="token keyword">class</span> <span class="token class-name">Test_ABC</span><span class="token punctuation">:</span>
<span class="token keyword">def</span> <span class="token function">setup</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-------&gt;setup"</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">test_a</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-------&gt;test_a"</span><span class="token punctuation">)</span>
<span class="token keyword">assert</span> <span class="token number">1</span>
<span class="token keyword">def</span> <span class="token function">test_b</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-------&gt;test_b"</span><span class="token punctuation">)</span>
<span class="token keyword">assert</span> <span class="token number">1</span>
<span class="token keyword">if</span> **name** <span class="token operator">==</span> <span class="token string">'**main**'</span><span class="token punctuation">:</span>
pytest<span class="token punctuation">.</span>main<span class="token punctuation">(</span><span class="token string">"-s test_abc.py"</span><span class="token punctuation">)</span>
执行结果：
test_abc<span class="token punctuation">.</span>py
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>before <span class="token comment"># 运行第一次</span>
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>setup
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>test_a
<span class="token punctuation">.</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>before <span class="token comment"># 运行第二次</span>
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>setup
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>test_b
<span class="token punctuation">.</span>
<span class="token number">5.6</span><span class="token punctuation">.</span>fixture 第五个例子<span class="token punctuation">(</span>设置作用域为<span class="token keyword">class</span><span class="token punctuation">)</span>
示例：

<span class="token keyword">import</span> pytest
<span class="token decorator annotation punctuation">@pytest<span class="token punctuation">.</span>fixture</span><span class="token punctuation">(</span>scope<span class="token operator">=</span><span class="token string">'class'</span><span class="token punctuation">,</span>autouse<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span> <span class="token comment"># 作用域设置为 class，自动运行</span>
<span class="token keyword">def</span> <span class="token function">before</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-------&gt;before"</span><span class="token punctuation">)</span>
<span class="token keyword">class</span> <span class="token class-name">Test_ABC</span><span class="token punctuation">:</span>
<span class="token keyword">def</span> <span class="token function">setup</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-------&gt;setup"</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">test_a</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-------&gt;test_a"</span><span class="token punctuation">)</span>
<span class="token keyword">assert</span> <span class="token number">1</span>
<span class="token keyword">def</span> <span class="token function">test_b</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-------&gt;test_b"</span><span class="token punctuation">)</span>
<span class="token keyword">assert</span> <span class="token number">1</span>
<span class="token keyword">if</span> **name** <span class="token operator">==</span> <span class="token string">'**main**'</span><span class="token punctuation">:</span>
pytest<span class="token punctuation">.</span>main<span class="token punctuation">(</span><span class="token string">"-s test_abc.py"</span><span class="token punctuation">)</span>
执行结果：
test_abc<span class="token punctuation">.</span>py
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>before <span class="token comment"># 发现只运行一次</span>
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>setup
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>test_a
<span class="token punctuation">.</span>
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>setup
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>test_b
<span class="token punctuation">.</span>
<span class="token number">5.7</span><span class="token punctuation">.</span>fixture 第六个例子<span class="token punctuation">(</span>返回值<span class="token punctuation">)</span>
示例一<span class="token punctuation">:</span>
<span class="token keyword">import</span> pytest
<span class="token decorator annotation punctuation">@pytest<span class="token punctuation">.</span>fixture</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">need_data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
<span class="token keyword">return</span> <span class="token number">2</span> <span class="token comment"># 返回数字 2</span>

<span class="token keyword">class</span> <span class="token class-name">Test_ABC</span><span class="token punctuation">:</span>

<span class="token keyword">def</span> <span class="token function">test_a</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>need_data<span class="token punctuation">)</span><span class="token punctuation">:</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-------&gt;test_a"</span><span class="token punctuation">)</span>
<span class="token keyword">assert</span> need_data <span class="token operator">!=</span> <span class="token number">3</span> <span class="token comment"># 拿到返回值做一次断言</span>

<span class="token keyword">if</span> **name** <span class="token operator">==</span> <span class="token string">'**main**'</span><span class="token punctuation">:</span>
pytest<span class="token punctuation">.</span>main<span class="token punctuation">(</span><span class="token string">"-s test_abc.py"</span><span class="token punctuation">)</span>
执行结果：
test_abc<span class="token punctuation">.</span>py
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>test_a
<span class="token punctuation">.</span>
``

示例二<span class="token punctuation">:</span>

<span class="token keyword">import</span> pytest
<span class="token decorator annotation punctuation">@pytest<span class="token punctuation">.</span>fixture</span><span class="token punctuation">(</span>params<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">need_data</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment"># 传入参数 request 系统封装参数</span>
<span class="token keyword">return</span> request<span class="token punctuation">.</span>param <span class="token comment"># 取列表中单个值，默认的取值方式</span>
<span class="token keyword">class</span> <span class="token class-name">Test_ABC</span><span class="token punctuation">:</span>

<span class="token keyword">def</span> <span class="token function">test_a</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>need_data<span class="token punctuation">)</span><span class="token punctuation">:</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-------&gt;test_a"</span><span class="token punctuation">)</span>
<span class="token keyword">assert</span> need_data <span class="token operator">!=</span> <span class="token number">3</span> <span class="token comment"># 断言 need_data 不等于 3</span>

<span class="token keyword">if</span> **name** <span class="token operator">==</span> <span class="token string">'**main**'</span><span class="token punctuation">:</span>
pytest<span class="token punctuation">.</span>main<span class="token punctuation">(</span><span class="token string">"-s test_abc.py"</span><span class="token punctuation">)</span>

执行结果：
<span class="token comment"># 可以发现结果运行了三次</span>
test_abc<span class="token punctuation">.</span>py
<span class="token number">1</span>
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>test_a
<span class="token punctuation">.</span>
<span class="token number">2</span>
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>test_a
<span class="token punctuation">.</span>
<span class="token number">3</span>
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>test_a
F
<span class="token number">6</span><span class="token punctuation">.</span>Pytest 高阶用法<span class="token punctuation">(</span>二<span class="token punctuation">)</span>
前置条件：

<span class="token number">1.</span>文件路径：

<span class="token operator">-</span> Test_App
<span class="token operator">-</span> <span class="token operator">-</span> test_abc<span class="token punctuation">.</span>py
<span class="token operator">-</span> <span class="token operator">-</span> pytest<span class="token punctuation">.</span>ini
<span class="token number">2</span><span class="token punctuation">.</span>pyetst<span class="token punctuation">.</span>ini 配置文件内容：

<span class="token punctuation">[</span>pytest<span class="token punctuation">]</span>
命令行参数
addopts <span class="token operator">=</span> <span class="token operator">-</span>s
搜索文件名
python*files <span class="token operator">=</span> test*<span class="token operator">_</span><span class="token punctuation">.</span>py
搜索的类名
python*classes <span class="token operator">=</span> Test*<span class="token operator">_</span>
搜索的函数名
python*functions <span class="token operator">=</span> test*<span class="token operator">\*</span>
<span class="token number">6.1</span><span class="token punctuation">.</span>跳过测试函数
根据特定的条件，不执行标识的测试函数<span class="token punctuation">.</span>
方法：
skipif<span class="token punctuation">(</span>condition<span class="token punctuation">,</span> reason<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span>
参数：
condition：跳过的条件，必传参数
reason：标注原因，必传参数
使用方法：
<span class="token decorator annotation punctuation">@pytest<span class="token punctuation">.</span>mark<span class="token punctuation">.</span>skipif</span><span class="token punctuation">(</span>condition<span class="token punctuation">,</span> reason<span class="token operator">=</span><span class="token string">"xxx"</span><span class="token punctuation">)</span>
示例：

<span class="token keyword">import</span> pytest
<span class="token keyword">class</span> <span class="token class-name">Test_ABC</span><span class="token punctuation">:</span>
<span class="token keyword">def</span> <span class="token function">setup_class</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-------&gt;setup_class"</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">teardown_class</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-------&gt;teardown_class"</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">test_a</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-------&gt;test_a"</span><span class="token punctuation">)</span>
<span class="token keyword">assert</span> <span class="token number">1</span>
<span class="token decorator annotation punctuation">@pytest<span class="token punctuation">.</span>mark<span class="token punctuation">.</span>skipif</span><span class="token punctuation">(</span>condition<span class="token operator">=</span><span class="token number">2</span><span class="token operator">&gt;</span><span class="token number">1</span><span class="token punctuation">,</span>reason <span class="token operator">=</span> <span class="token string">"跳过该函数"</span><span class="token punctuation">)</span> <span class="token comment"># 跳过测试函数 test_b</span>
<span class="token keyword">def</span> <span class="token function">test_b</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-------&gt;test_b"</span><span class="token punctuation">)</span>
<span class="token keyword">assert</span> <span class="token number">0</span>
执行结果：
test_abc<span class="token punctuation">.</span>py
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>setup_class
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>test_a <span class="token comment">#只执行了函数 test_a</span>
<span class="token punctuation">.</span>
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>teardown_class
s <span class="token comment"># 跳过函数```</span>

<span class="token number">6.2</span> 标记为预期失败函数
标记测试函数为失败函数
方法：
xfail<span class="token punctuation">(</span>condition<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> reason<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> raises<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> run<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> strict<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
常用参数：
condition：预期失败的条件，必传参数
reason：失败的原因，必传参数
使用方法：
<span class="token decorator annotation punctuation">@pytest<span class="token punctuation">.</span>mark<span class="token punctuation">.</span>xfail</span><span class="token punctuation">(</span>condition<span class="token punctuation">,</span> reason<span class="token operator">=</span><span class="token string">"xx"</span><span class="token punctuation">)</span>
示例：

<span class="token keyword">import</span> pytest
<span class="token keyword">class</span> <span class="token class-name">Test_ABC</span><span class="token punctuation">:</span>
<span class="token keyword">def</span> <span class="token function">setup_class</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-------&gt;setup_class"</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">teardown_class</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-------&gt;teardown_class"</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">test_a</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-------&gt;test_a"</span><span class="token punctuation">)</span>
<span class="token keyword">assert</span> <span class="token number">1</span>
<span class="token decorator annotation punctuation">@pytest<span class="token punctuation">.</span>mark<span class="token punctuation">.</span>xfail</span><span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">&gt;</span> <span class="token number">1</span><span class="token punctuation">,</span> reason<span class="token operator">=</span><span class="token string">"标注为预期失败"</span><span class="token punctuation">)</span> <span class="token comment"># 标记为预期失败函数 test_b</span>
<span class="token keyword">def</span> <span class="token function">test_b</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-------&gt;test_b"</span><span class="token punctuation">)</span>
<span class="token keyword">assert</span> <span class="token number">0</span>
执行结果：
test_abc<span class="token punctuation">.</span>py
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>setup_class
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>test_a
<span class="token punctuation">.</span>
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>test_b
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>teardown_class
x <span class="token comment"># 失败标记</span>

<span class="token number">6.3</span> 函数数据参数化
方便测试函数对测试属于的获取。
方法：
parametrize<span class="token punctuation">(</span>argnames<span class="token punctuation">,</span> argvalues<span class="token punctuation">,</span> indirect<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> ids<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> scope<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span>
常用参数：
argnames：参数名
argvalues：参数对应值，类型必须为<span class="token builtin">list</span>
当参数为一个时格式：<span class="token punctuation">[</span>value<span class="token punctuation">]</span>
当参数个数大于一个时，格式为<span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token punctuation">(</span>param_value1<span class="token punctuation">,</span>param_value2<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span>param_value1<span class="token punctuation">,</span>param_value2<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
使用方法<span class="token punctuation">:</span>
<span class="token decorator annotation punctuation">@pytest<span class="token punctuation">.</span>mark<span class="token punctuation">.</span>parametrize</span><span class="token punctuation">(</span>argnames<span class="token punctuation">,</span>argvalues<span class="token punctuation">)</span>
️ 参数值为 N 个，测试方法就会运行 N 次

单个参数示例：

<span class="token keyword">import</span> pytest
<span class="token keyword">class</span> <span class="token class-name">Test_ABC</span><span class="token punctuation">:</span>
<span class="token keyword">def</span> <span class="token function">setup_class</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-------&gt;setup_class"</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">teardown_class</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-------&gt;teardown_class"</span><span class="token punctuation">)</span>
<span class="token decorator annotation punctuation">@pytest<span class="token punctuation">.</span>mark<span class="token punctuation">.</span>parametrize</span><span class="token punctuation">(</span><span class="token string">"a"</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment"># a 参数被赋予两个值，函数会运行两遍</span>
<span class="token keyword">def</span> <span class="token function">test_a</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>a<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment"># 参数必须和 parametrize 里面的参数一致</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"test data:a=%d"</span><span class="token operator">%</span>a<span class="token punctuation">)</span>
<span class="token keyword">assert</span> a<span class="token operator">%</span><span class="token number">3</span> <span class="token operator">==</span> <span class="token number">0</span>
执行结果<span class="token punctuation">:</span>
test_abc<span class="token punctuation">.</span>py
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>setup_class
test data<span class="token punctuation">:</span>a<span class="token operator">=</span><span class="token number">3</span> <span class="token comment"># 运行第一次取值 a=3</span>
<span class="token punctuation">.</span>
test data<span class="token punctuation">:</span>a<span class="token operator">=</span><span class="token number">6</span> <span class="token comment"># 运行第二次取值 a=6</span>
<span class="token punctuation">.</span>
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>teardown_class
多个参数示例：

<span class="token keyword">import</span> pytest
<span class="token keyword">class</span> <span class="token class-name">Test_ABC</span><span class="token punctuation">:</span>
<span class="token keyword">def</span> <span class="token function">setup_class</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-------&gt;setup_class"</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">teardown_class</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-------&gt;teardown_class"</span><span class="token punctuation">)</span>
<span class="token decorator annotation punctuation">@pytest<span class="token punctuation">.</span>mark<span class="token punctuation">.</span>parametrize</span><span class="token punctuation">(</span><span class="token string">"a,b"</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment"># 参数 a,b 均被赋予两个值，函数会运行两遍</span>
<span class="token keyword">def</span> <span class="token function">test_a</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment"># 参数必须和 parametrize 里面的参数一致</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"test data:a=%d,b=%d"</span><span class="token operator">%</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">assert</span> a<span class="token operator">+</span>b <span class="token operator">==</span> <span class="token number">3</span>
执行结果：
test_abc<span class="token punctuation">.</span>py
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>setup_class
test data<span class="token punctuation">:</span>a<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>b<span class="token operator">=</span><span class="token number">2</span> <span class="token comment"># 运行第一次取值 a=1,b=2</span>
<span class="token punctuation">.</span>
test data<span class="token punctuation">:</span>a<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>b<span class="token operator">=</span><span class="token number">3</span> <span class="token comment"># 运行第二次取值 a=0,b=3</span>
<span class="token punctuation">.</span>
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>teardown_class
函数返回值类型示例：

<span class="token keyword">import</span> pytest
<span class="token keyword">def</span> <span class="token function">return_test_data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
<span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token keyword">class</span> <span class="token class-name">Test_ABC</span><span class="token punctuation">:</span>
<span class="token keyword">def</span> <span class="token function">setup_class</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-------&gt;setup_class"</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">teardown_class</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-------&gt;teardown_class"</span><span class="token punctuation">)</span>
<span class="token decorator annotation punctuation">@pytest<span class="token punctuation">.</span>mark<span class="token punctuation">.</span>parametrize</span><span class="token punctuation">(</span><span class="token string">"a,b"</span><span class="token punctuation">,</span>return_test_data<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 使用函数返回值的形式传入参数值</span>
<span class="token keyword">def</span> <span class="token function">test_a</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span><span class="token punctuation">:</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"test data:a=%d,b=%d"</span><span class="token operator">%</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">assert</span> a<span class="token operator">+</span>b <span class="token operator">==</span> <span class="token number">3</span>

执行结果：
test_abc<span class="token punctuation">.</span>py
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>setup_class
test data<span class="token punctuation">:</span>a<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>b<span class="token operator">=</span><span class="token number">2</span> <span class="token comment"># 运行第一次取值 a=1,b=2</span>
<span class="token punctuation">.</span>
test data<span class="token punctuation">:</span>a<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>b<span class="token operator">=</span><span class="token number">3</span> <span class="token comment"># 运行第二次取值 a=0,b=3</span>
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>teardown_class
<span class="token number">6.4</span> 修改 Python traceback 输出
pytest <span class="token operator">-</span><span class="token operator">-</span>showlocals <span class="token comment"># show local variables in tracebacks</span>
pytest <span class="token operator">-</span>l <span class="token comment"># show local variables (shortcut)</span>
pytest <span class="token operator">-</span><span class="token operator">-</span>tb<span class="token operator">=</span>auto <span class="token comment"># (default) 'long' tracebacks for the first and last</span>
<span class="token comment"># entry, but 'short' style for the other entries</span>
pytest <span class="token operator">-</span><span class="token operator">-</span>tb<span class="token operator">=</span><span class="token builtin">long</span> <span class="token comment"># exhaustive, informative traceback formatting</span>
pytest <span class="token operator">-</span><span class="token operator">-</span>tb<span class="token operator">=</span>short <span class="token comment"># shorter traceback format</span>
pytest <span class="token operator">-</span><span class="token operator">-</span>tb<span class="token operator">=</span>line <span class="token comment"># only one line per failure</span>
pytest <span class="token operator">-</span><span class="token operator">-</span>tb<span class="token operator">=</span>native <span class="token comment"># Python standard library formatting</span>
pytest <span class="token operator">-</span><span class="token operator">-</span>tb<span class="token operator">=</span>no <span class="token comment"># no traceback at all</span>
<span class="token operator">-</span><span class="token operator">-</span>full<span class="token operator">-</span>trace 参数会打印更多的错误输出信息，比参数 <span class="token operator">-</span><span class="token operator">-</span>tb<span class="token operator">=</span><span class="token builtin">long</span> 还多，即使是 Ctrl<span class="token operator">+</span>C 触发的错误，也会打印出来

<span class="token number">6.5</span> 执行失败的时候跳转到 PDB
执行用例的时候，跟参数 <span class="token operator">-</span><span class="token operator">-</span>pdb，这样失败的时候，每次遇到失败，会自动跳转到 PDB

pytest <span class="token operator">-</span><span class="token operator">-</span>pdb <span class="token comment"># 每次遇到失败都跳转到 PDB</span>
pytest <span class="token operator">-</span>x <span class="token operator">-</span><span class="token operator">-</span>pdb <span class="token comment"># 第一次遇到失败就跳转到 PDB，结束测试执行</span>
pytest <span class="token operator">-</span><span class="token operator">-</span>pdb <span class="token operator">-</span><span class="token operator">-</span>maxfail<span class="token operator">=</span><span class="token number">3</span> <span class="token comment"># 只有前三次失败跳转到 PDB </span>
<span class="token number">6.6</span> 设置断点
在用例脚本中加入如下 python 代码，pytest 会自动关闭执行输出的抓取，这里，其他 test 脚本不会受到影响，带断点的 test 上一个 test 正常输出

<span class="token keyword">import</span> pdb<span class="token punctuation">;</span> pdb<span class="token punctuation">.</span>set_trace<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token number">6.7</span> 获取用例执行性能数据
获取最慢的<span class="token number">10</span>个用例的执行耗时

pytest <span class="token operator">-</span><span class="token operator">-</span>durations<span class="token operator">=</span><span class="token number">10</span>
<span class="token number">6.8</span> 生成 JUnitXML 格式的结果文件
这种格式的结果文件可以被 Jenkins 或其他 CI 工具解析

pytest <span class="token operator">-</span><span class="token operator">-</span>junitxml<span class="token operator">=</span>path
<span class="token number">6.9</span>禁用插件
例如，关闭 doctest 插件

pytest <span class="token operator">-</span>p no<span class="token punctuation">:</span>doctest
<span class="token number">6.10</span> 从 Python 代码中调用 pytest
pytest<span class="token punctuation">.</span>main<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 基本用法</span>
pytest<span class="token punctuation">.</span>main<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'-x'</span><span class="token punctuation">,</span> <span class="token string">'mytestdir'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment"># 传入配置参数</span>

<span class="token operator">//</span> 指定自定义的或额外的插件
<span class="token comment"># content of myinvoke.py</span>
<span class="token keyword">import</span> pytest
<span class="token keyword">class</span> <span class="token class-name">MyPlugin</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
<span class="token keyword">def</span> <span class="token function">pytest_sessionfinish</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\*\*\* test run reporting finishing"</span><span class="token punctuation">)</span>
pytest<span class="token punctuation">.</span>main<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"-qq"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> plugins<span class="token operator">=</span><span class="token punctuation">[</span>MyPlugin<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token number">6.11</span> 测试脚本迁移后快速部署包含 pytest 的 virtualenv
例如你从 Gitlab 仓库里 clone 了项目组的刀刀同学编写的测试脚本到你自己的电脑里，你想修改些东西，并调试，咋办？可以通过下面的操作快速创建 VirtualEnv

cd <span class="token operator">&lt;</span>repository<span class="token operator">&gt;</span>
pip install <span class="token operator">-</span>e <span class="token punctuation">.</span>
This will <span class="token builtin">set</span> up a symlink to your code <span class="token keyword">in</span> site<span class="token operator">-</span>packages<span class="token punctuation">,</span> allowing you to edit your code <span class="token keyword">while</span>
your tests run against it <span class="token keyword">as</span> <span class="token keyword">if</span> it were installed<span class="token punctuation">.</span>
Setting up your project <span class="token keyword">in</span> development mode lets you avoid having to reinstall every time you want to run your tests<span class="token punctuation">,</span>
<span class="token keyword">and</span> <span class="token keyword">is</span> less brittle than mucking about <span class="token keyword">with</span> sys<span class="token punctuation">.</span>path to point your tests at local code<span class="token punctuation">.</span>
Also consider using tox
遇到的问题：
问题：
pytest 可以输出覆盖率的 html 报告

使用命令如下：

pytest <span class="token operator">-</span>vv <span class="token operator">-</span><span class="token operator">-</span>cov<span class="token operator">=</span><span class="token punctuation">.</span><span class="token operator">/</span> <span class="token operator">-</span><span class="token operator">-</span>cov<span class="token operator">-</span>report<span class="token operator">=</span>html
<span class="token builtin">open</span> htmlcov<span class="token operator">/</span>index<span class="token punctuation">.</span>html
有可能遇到报错：

<span class="token punctuation">(</span>venv<span class="token punctuation">)</span> zhangxiaofans<span class="token operator">-</span>MacBook<span class="token operator">-</span>Pro<span class="token punctuation">:</span>mgap<span class="token operator">-</span>mendel joe$ pytest <span class="token operator">-</span><span class="token operator">-</span>cov<span class="token operator">-</span>report<span class="token operator">=</span>html
usage<span class="token punctuation">:</span> pytest <span class="token punctuation">[</span>options<span class="token punctuation">]</span> <span class="token punctuation">[</span>file_or_dir<span class="token punctuation">]</span> <span class="token punctuation">[</span>file_or_dir<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span>
pytest<span class="token punctuation">:</span> error<span class="token punctuation">:</span> unrecognized arguments<span class="token punctuation">:</span> <span class="token operator">-</span><span class="token operator">-</span>cov<span class="token operator">-</span>report<span class="token operator">=</span>html
inifile<span class="token punctuation">:</span> <span class="token boolean">None</span>
rootdir<span class="token punctuation">:</span> <span class="token operator">/</span>Users<span class="token operator">/</span>joe<span class="token operator">/</span>workspace<span class="token operator">/</span>platform<span class="token operator">/</span>mgap<span class="token operator">-</span>mendel<span class="token operator">/</span>mgap<span class="token operator">-</span>mendel
原因：
缺少 pytest cov 的包

解决方法

pip install pytest<span class="token operator">-</span>cov
————————————————

</code></pre>

   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="6874747073:3a2f2f626c6f672e6373646e2e6e65742f6c69616f5f31312f:61727469636c652f64657461696c732f313234313437363134" class_="artid" style="display:none">
 </p>
</div>
