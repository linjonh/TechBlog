---
layout: post
title: "小程序之发送弹幕wx.createVideoContext"
date: 2018-03-29 18:48:41 +0800
description: "小程序之发送弹幕这个是官方定义：wx.createVideoContext(videoId, thi"
keywords: "wx.createvideocontext"
categories: ['小程序']
tags: ['小程序']
artid: "79747209"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=79747209
    alt: "小程序之发送弹幕wx.createVideoContext"
render_with_liquid: false
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     小程序之发送弹幕——wx.createVideoContext（）
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <div style="text-align:center;">
     <span style="font-size:18px;">
      小程序之发送弹幕
     </span>
    </div>
    <p>
     这个是官方定义：
    </p>
    <h4 style="font-size:1.5em;margin-bottom:.5em;font-weight:400;color:rgb(51,51,51);font-family:'Helvetica Neue', 'Hiragino Sans GB', 'Microsoft YaHei', '黑体', Arial, sans-serif;letter-spacing:.2px;background-color:rgb(255,255,255);margin-top:0px;">
     wx.createVideoContext(videoId, this)
    </h4>
    <p style="font-size:14px;margin-bottom:.85em;line-height:2;color:rgb(51,51,51);font-family:'Helvetica Neue', 'Hiragino Sans GB', 'Microsoft YaHei', '黑体', Arial, sans-serif;letter-spacing:.2px;background-color:rgb(255,255,255);">
     创建并返回 video 上下文
     <code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:.85em;margin:0px;padding:.2em;border:none;color:inherit;background-color:rgb(247,247,247);">
      videoContext
     </code>
     对象。在自定义组件下，第二个参数传入组件实例this，以操作组件内
     <code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:.85em;margin:0px;padding:.2em;border:none;color:inherit;background-color:rgb(247,247,247);">
      &lt;video/&gt;
     </code>
     组件
    </p>
    <p style="font-size:14px;margin-bottom:.85em;line-height:2;color:rgb(51,51,51);font-family:'Helvetica Neue', 'Hiragino Sans GB', 'Microsoft YaHei', '黑体', Arial, sans-serif;letter-spacing:.2px;background-color:rgb(255,255,255);">
     二、下面是效果图，这时候在开发工具中的样子，希望能理解
    </p>
    <p style="font-size:14px;margin-bottom:.85em;line-height:2;color:rgb(51,51,51);font-family:'Helvetica Neue', 'Hiragino Sans GB', 'Microsoft YaHei', '黑体', Arial, sans-serif;letter-spacing:.2px;background-color:rgb(255,255,255);">
     <img alt="" src="https://i-blog.csdnimg.cn/blog_migrate/9f597856abfc2d5541eae17c41b3c08e.png">
      <br/>
     </img>
    </p>
    <p style="font-size:14px;margin-bottom:.85em;line-height:2;color:rgb(51,51,51);font-family:'Helvetica Neue', 'Hiragino Sans GB', 'Microsoft YaHei', '黑体', Arial, sans-serif;letter-spacing:.2px;background-color:rgb(255,255,255);">
     页面代码：
    </p>
    <p style="font-size:14px;margin-bottom:.85em;line-height:2;color:rgb(51,51,51);font-family:'Helvetica Neue', 'Hiragino Sans GB', 'Microsoft YaHei', '黑体', Arial, sans-serif;letter-spacing:.2px;background-color:rgb(255,255,255);">
    </p>
    <div style="color:rgb(0,0,0);background-color:rgb(255,255,254);font-family:Consolas;font-size:14px;line-height:18px;white-space:pre;">
     <div>
      <span style="color:#0000ff;">
       &lt;
      </span>
      <span style="color:#800000;">
       view
      </span>
      <span style="color:#ff0000;">
       class
      </span>
      =
      <span style="color:#0000ff;">
       "section tc"&gt;
      </span>
     </div>
     <div>
      <span style="color:#0000ff;">
       &lt;
      </span>
      <span style="color:#800000;">
       video
      </span>
      <span style="color:#ff0000;">
       id
      </span>
      =
      <span style="color:#0000ff;">
       "myVideo"
      </span>
      <span style="color:#ff0000;">
       src
      </span>
      =
      <span style="color:#0000ff;">
       "http://wxsnsdy.tc.qq.com/105/20210/snsdyvideodownload?filekey=30280201010421301f0201690402534804102ca905ce620b1241b726bc41dcff44e00204012882540400&amp;bizid=1023&amp;hy=SH&amp;fileparam=302c020101042530230204136ffd93020457e3c4ff02024ef202031e8d7f02030f42400204045a320a0201000400"
      </span>
      <span style="color:#ff0000;">
       enable-danmu
      </span>
      <span style="color:#ff0000;">
       danmu-btn
      </span>
      <span style="color:#ff0000;">
       controls
      </span>
      <span style="color:#0000ff;">
       &gt;&lt;/
      </span>
      <span style="color:#800000;">
       video
      </span>
      <span style="color:#0000ff;">
       &gt;
      </span>
     </div>
     <div>
      <span style="color:#0000ff;">
       &lt;
      </span>
      <span style="color:#800000;">
       view
      </span>
      <span style="color:#ff0000;">
       class
      </span>
      =
      <span style="color:#0000ff;">
       "btn-area"&gt;
      </span>
     </div>
     <div>
      <span style="color:#0000ff;">
       &lt;
      </span>
      <span style="color:#800000;">
       input
      </span>
      <span style="color:#ff0000;">
       bindblur
      </span>
      =
      <span style="color:#0000ff;">
       "bindInputBlur"
      </span>
      <span style="color:#800000;">
       /
      </span>
      <span style="color:#0000ff;">
       &gt;
      </span>
     </div>
     <div>
      <span style="color:#0000ff;">
       &lt;
      </span>
      <span style="color:#800000;">
       button
      </span>
      <span style="color:#ff0000;">
       bindtap
      </span>
      =
      <span style="color:#0000ff;">
       "bindSendDanmu"&gt;
      </span>
      发送弹幕
      <span style="color:#0000ff;">
       &lt;/
      </span>
      <span style="color:#800000;">
       button
      </span>
      <span style="color:#0000ff;">
       &gt;
      </span>
     </div>
     <div>
      <span style="color:#0000ff;">
       &lt;/
      </span>
      <span style="color:#800000;">
       view
      </span>
      <span style="color:#0000ff;">
       &gt;
      </span>
     </div>
     <div>
      <span style="color:#0000ff;">
       &lt;/
      </span>
      <span style="color:#800000;">
       view
      </span>
      <span style="color:#0000ff;">
       &gt;
      </span>
     </div>
     <div>
      <span style="color:#0000ff;">
       <br/>
      </span>
     </div>
    </div>
    <p>
     js代码
    </p>
    <p>
     一、生成
     <span style="color:rgb(0,0,0);font-family:Consolas;font-size:14px;letter-spacing:.2px;white-space:pre;background-color:rgb(255,255,254);">
      videoContext 对象，绑定
      <span style="color:rgb(163,21,21);font-family:Consolas;font-size:14px;letter-spacing:.2px;white-space:pre;background-color:rgb(255,255,254);">
       myVideo；
      </span>
     </span>
    </p>
    <p>
    </p>
    <div style="color:rgb(0,0,0);background-color:rgb(255,255,254);font-family:Consolas;font-size:14px;line-height:18px;white-space:pre;">
     <div>
      onReady:
      <span style="color:#0000ff;">
       function
      </span>
      (res) {
     </div>
     <div>
      <span style="color:#0000ff;">
       this
      </span>
      .videoContext = wx.createVideoContext(
      <span style="color:#a31515;">
       'myVideo'
      </span>
      )
     </div>
     <div>
      },
     </div>
     <div>
      inputValue:
      <span style="color:#a31515;">
       ''
      </span>
      ,
     </div>
     <div>
      <br/>
     </div>
     <p>
     </p>
     <div>
      二、input失去焦点时的方法，获取input的值
     </div>
     <div>
      bindInputBlur:
      <span style="color:#0000ff;">
       function
      </span>
      (e) {
     </div>
     <div>
      <span style="color:#0000ff;">
       this
      </span>
      .inputValue = e.detail.value
     </div>
     <div>
      },
     </div>
    </div>
    <p>
     三、发送弹幕API,设置的文本，颜色
    </p>
    <div style="color:rgb(0,0,0);background-color:rgb(255,255,254);font-family:Consolas;font-size:14px;line-height:18px;white-space:pre;">
     <div>
      bindSendDanmu:
      <span style="color:#0000ff;">
       function
      </span>
      () {
     </div>
     <div>
      <span style="color:#0000ff;">
       this
      </span>
      .videoContext.sendDanmu({
     </div>
     <div>
      text:
      <span style="color:#0000ff;">
       this
      </span>
      .inputValue,
     </div>
     <div>
      color: getRandomColor()
     </div>
     <div>
      })
     </div>
     <div>
      },
     </div>
    </div>
    <p>
     四、调用随机生成颜色函数
    </p>
    <p>
    </p>
    <div style="color:rgb(0,0,0);background-color:rgb(255,255,254);font-family:Consolas;font-size:14px;line-height:18px;white-space:pre;">
     <div>
      <span style="color:#0000ff;">
       function
      </span>
      getRandomColor() {
     </div>
     <div>
      <span style="color:#0000ff;">
       let
      </span>
      rgb = []
     </div>
     <div>
      <span style="color:#0000ff;">
       for
      </span>
      (
      <span style="color:#0000ff;">
       let
      </span>
      i =
      <span style="color:#09885a;">
       0
      </span>
      ; i &lt;
      <span style="color:#09885a;">
       3
      </span>
      ; ++i) {
     </div>
     <div>
      <span style="color:#0000ff;">
       let
      </span>
      color = Math.floor(Math.random() *
      <span style="color:#09885a;">
       256
      </span>
      ).toString(
      <span style="color:#09885a;">
       16
      </span>
      )
     </div>
     <div>
      color = color.length ==
      <span style="color:#09885a;">
       1
      </span>
      ?
      <span style="color:#a31515;">
       '0'
      </span>
      + color : color
     </div>
     <div>
      rgb.push(color)
     </div>
     <div>
      }
     </div>
     <div>
      <span style="color:#0000ff;">
       return
      </span>
      <span style="color:#a31515;">
       '#'
      </span>
      + rgb.join(
      <span style="color:#a31515;">
       ''
      </span>
      )
     </div>
     <div>
      }
     </div>
    </div>
    <br/>
    <p>
     大家，快快去试试吧
    </p>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f:2f626c6f672e6373646e2e6e65742f75303132373239383332:2f61727469636c652f64657461696c732f3739373437323039" class_="artid" style="display:none">
 </p>
</div>


