---
layout: post
title: "小程序学习-01小程序简介微信小程序基础"
date: 2022-02-22 07:12:57 +0800
description: "小程序简介小程序是一个全新的、轻量级的移动端应用。起源在小程序出现之前的移动端开发的解决方案有：An"
keywords: "jsskyline和js的区别"
categories: ['小程序']
tags: ['微信小程序', '小程序', '学习']
artid: "123059910"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=123059910
    alt: "小程序学习-01小程序简介微信小程序基础"
render_with_liquid: false
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     小程序学习 - 01小程序简介+微信小程序基础
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-tomorrow-night-eighties" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h2>
     <a id="_0">
     </a>
     小程序简介
    </h2>
    <p>
     小程序是一个全新的、轻量级的移动端应用。
    </p>
    <h3>
     <a id="_4">
     </a>
     起源
    </h3>
    <p>
     在小程序出现之前的移动端开发的解决方案有：
    </p>
    <ul>
     <li>
      Android
     </li>
     <li>
      iOS
     </li>
     <li>
      Windows Phone - 后来退出历史舞台
     </li>
    </ul>
    <p>
     移动端开发发展了一段时间之后也暴漏出来一些问题，传统 App （Android / iOS）的开发和运营成本很高：
    </p>
    <ul>
     <li>
      开发一款 App，就要开发这两个版本，既要招 Android 工程师，也要招 iOS 工程师，
      <strong>
       人力成本非常高
      </strong>
     </li>
     <li>
      App 开发完成之后，还要发版，即发布到应用商店中（例如 App Store）。发版申请提交之后要等待审核，审核不通过就需要退回调整重新发版，
      <strong>
       发版过程繁琐
      </strong>
     </li>
     <li>
      发版完成后还
      <strong>
       需要推广
      </strong>
      ，常规做法是花钱在应用商店打广告，提高 App 的排名
     </li>
    </ul>
    <p>
     为了解决传统 App 的这些问题，小程序应运而生。
    </p>
    <h3>
     <a id="_20">
     </a>
     发展历程
    </h3>
    <p>
     最早推出小程序的是微信团队。
    </p>
    <ul>
     <li>
      2016 年 1 月 9 日，小程序立项
     </li>
     <li>
      2016年 9 月 21 日，开始内测
     </li>
     <li>
      2017 年 1 月 9 日，正式上线
     </li>
    </ul>
    <p>
     小程序上线之后取得了巨大的成功，这导致一些其它平台也跟风上线了小程序的内容，如支付宝、京东、今日头条、百度。
    </p>
    <p>
     微信小程序推出的最早且目前最有影响力（后文默认介绍微信小程序）。
    </p>
    <h3>
     <a id="_32">
     </a>
     优势
    </h3>
    <ul>
     <li>
      相比原生 App （Android / iOS），小程序无需单独下载
      <ul>
       <li>
        只需要扫一扫或搜一下即可打开使用
       </li>
      </ul>
     </li>
     <li>
      小程序寄宿在 App 中，宿主 App 自带流量，所以小程序推广成本低
      <ul>
       <li>
        例如 2017 年的“跳一跳”，利用朋友圈成绩排名，迅速爆红
       </li>
      </ul>
     </li>
     <li>
      小程序简单易学
      <ul>
       <li>
        Android 工程师要学习 Android 开发和 Java
       </li>
       <li>
        iOS 工程师要学习 Objective-C 或 Swift
       </li>
       <li>
        小程序只需要掌握前端技术栈
       </li>
      </ul>
     </li>
    </ul>
    <h3>
     <a id="_43">
     </a>
     小程序与传统网页开发的区别
    </h3>
    <p>
     小程序的运行环境与网页开发不同：
    </p>
    <ul>
     <li>
      网页开发的运行环境是浏览器
     </li>
     <li>
      小程序的运行环境是操作系统（Android / iOS）上的 App 客户端
      <ul>
       <li>
        如微信小程序的运行环境是微信客户端
       </li>
      </ul>
     </li>
    </ul>
    <p>
     所以小程序与网页开发有一些区别：
    </p>
    <ul>
     <li>
      小程序中不能使用 HTML
     </li>
     <li>
      小程序中可以使用 CSS
     </li>
     <li>
      小程序主要开发语言是 JavaScript
      <ul>
       <li>
        但是 BOM（操作 HTML） 和 DOM（与浏览器交互） 在小程序中不可用
       </li>
       <li>
        基于 DOM 和 BOM 的 JS 库也不能用，如 jQuery
       </li>
      </ul>
     </li>
    </ul>
    <h3>
     <a id="_59">
     </a>
     运行环境
    </h3>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/ed37cfea347c1f469ea69a48b0a718c3.png#pic_center"/>
    </p>
    <p>
     小程序的运行环境主要有两个：
    </p>
    <ul>
     <li>
      渲染层 - 主要用于渲染内容和样式
     </li>
     <li>
      逻辑层 - 主要用来处理 JS
     </li>
    </ul>
    <p>
     不同的操作系统，内部的支持也不一样：
    </p>
    <table>
     <thead>
      <tr>
       <th>
        运行环境
       </th>
       <th>
        逻辑层
       </th>
       <th>
        渲染层
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        iOS
       </td>
       <td>
        JSCore
       </td>
       <td>
        WKWebView
       </td>
      </tr>
      <tr>
       <td>
        Android
       </td>
       <td>
        V8 引擎
       </td>
       <td>
        Chromium 定制内核
       </td>
      </tr>
     </tbody>
    </table>
    <p>
     虽然不同操作系统的渲染机制和逻辑不一样，但外部的表现是一样的。
    </p>
    <h2>
     <a id="_78">
     </a>
     微信小程序基础
    </h2>
    <p>
     下面通过案例学习微信小程序的基础使用，主要包括：
    </p>
    <ol>
     <li>
      注册小程序账号
     </li>
     <li>
      搭建开发环境
     </li>
     <li>
      初始化小程序 - 类似脚手架工具生成基础代码
     </li>
    </ol>
    <h3>
     <a id="_86">
     </a>
     注册小程序账号
    </h3>
    <p>
     在小程序官网注册：
     <a href="https://mp.weixin.qq.com/wxopen/waregister?action=step1" rel="nofollow">
      https://mp.weixin.qq.com/wxopen/waregister?action=step1
     </a>
    </p>
    <blockquote>
     <p>
      注意：注册过微信公众号的邮箱，不能再注册微信小程序账号
     </p>
    </blockquote>
    <p>
     也可以
     <a href="https://developers.weixin.qq.com/miniprogram/dev/devtools/sandbox.html" rel="nofollow">
      申请测试号
     </a>
     ，免注册快速体验小程序开发（不能发布）。
    </p>
    <p>
     注册成功后，可以在后台获取小程序的 AppID，它是小程序的唯一标识。
    </p>
    <h3>
     <a id="_96">
     </a>
     搭建开发环境
    </h3>
    <p>
     去小程序官网，下载安装微信开发者工具：
     <a href="https://developers.weixin.qq.com/miniprogram/dev/devtools/download.html" rel="nofollow">
      https://developers.weixin.qq.com/miniprogram/dev/devtools/download.html
     </a>
    </p>
    <p>
     详细界面介绍参考官网文档：
     <a href="https://developers.weixin.qq.com/miniprogram/dev/devtools/page.html#%E5%90%AF%E5%8A%A8%E9%A1%B5" rel="nofollow">
      界面
     </a>
    </p>
    <h3>
     <a id="_102">
     </a>
     初始化小程序
    </h3>
    <p>
     打开微信开发者工具新建小程序项目：
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/74efc8f02dec382cc9775f43d0a2a376.png#pic_center"/>
    </p>
    <p>
     “不使用模板” 与 “JavaScript - 基础模板” 基本没区别。
    </p>
    <p>
     本文创建的项目：
    </p>
    <ul>
     <li>
      项目名称：start
     </li>
     <li>
      AppID：注册 AppID
     </li>
     <li>
      开发模式：小程序
     </li>
     <li>
      后端服务：不使用云服务
     </li>
     <li>
      语言：JavaScript
     </li>
     <li>
      模板：不使用模板
     </li>
    </ul>
    <h3>
     <a id="_120">
     </a>
     解读初始化项目
    </h3>
    <p>
     下面依次解读小程序初始化项目：
    </p>
    <ol>
     <li>
      目录结构
     </li>
     <li>
      生命周期
     </li>
     <li>
      app 代码
     </li>
     <li>
      index 页面
     </li>
     <li>
      logs 页面
     </li>
    </ol>
    <h2>
     <a id="_130">
     </a>
     目录结构
    </h2>
    <blockquote>
     <p>
      官方文档：
     </p>
     <ul>
      <li>
       <a href="https://developers.weixin.qq.com/miniprogram/dev/framework/structure.html" rel="nofollow">
        目录结构
       </a>
      </li>
      <li>
       <a href="https://developers.weixin.qq.com/miniprogram/dev/framework/config.html" rel="nofollow">
        小程序配置
       </a>
      </li>
     </ul>
    </blockquote>
    <h3>
     <a id="_137">
     </a>
     全局文件
    </h3>
    <p>
     全局文件存放在根目录，文件名是固定的，不能修改，其中包括：
    </p>
    <ul>
     <li>
      app.js - 小程序入口文件，启动小程序首先加载这个文件
     </li>
     <li>
      app.json - 小程序全局配置
     </li>
     <li>
      app.wxss - 小程序全局样式，类似网页开发的 css
     </li>
    </ul>
    <h3>
     <a id="_145">
     </a>
     页面文件
    </h3>
    <p>
     页面文件存放在 pages 文件夹下，初始包括 index 和 logs 两个页面，每个页面由四个文件组成，以 index 为例：
    </p>
    <ul>
     <li>
      index.js - 页面入口（数据绑定和逻辑代码）
     </li>
     <li>
      index.json - 页面配置，当前页面的页面级配置
     </li>
     <li>
      index.wxml - 页面内容（组件+条件渲染），类似网页开发的 html
     </li>
     <li>
      index.wxss - 页面样式，仅对当前页面有效的样式文件
     </li>
    </ul>
    <p>
     需要注意的是：
    </p>
    <ul>
     <li>
      小程序的页面由 4 个文件组成：
      <code>
       .js
      </code>
      、
      <code>
       .json
      </code>
      、
      <code>
       .wxml
      </code>
      、
      <code>
       .wxss
      </code>
      ，四个文件的文件名必须一致
     </li>
     <li>
      小程序的页面不是由开发者手动创建的，而是由小程序自动生成的，只需要配置小程序全局配置文件
      <code>
       app.json
      </code>
      的
      <code>
       pages
      </code>
      ，保存文件后就会自动创建页面文件
     </li>
    </ul>
    <p>
     例如：
    </p>
    <pre><code class="prism language-json"><span class="token string">"pages"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
  <span class="token comment">// 未指定 entryPagePath 时，数组的第一项代表小程序的初始页面（首页）</span>
  <span class="token string">"pages/index/index"</span><span class="token punctuation">,</span>
  <span class="token string">"pages/logs/logs"</span><span class="token punctuation">,</span>
   <span class="token comment">// pages 是页面存放目录</span>
   <span class="token comment">// test 是页面存放的子目录</span>
   <span class="token comment">// my-test 是页面文件名称</span>
  <span class="token string">"pages/test/my-test"</span>
<span class="token punctuation">]</span><span class="token punctuation">,</span>
</code></pre>
    <h2>
     <a id="_173">
     </a>
     生命周期
    </h2>
    <p>
     小程序生命周期主要指两个循环状态：前台到后台、初始化到销毁。
    </p>
    <blockquote>
     <p>
      关于前后台的定义参考官方文档：
      <a href="https://developers.weixin.qq.com/miniprogram/dev/framework/runtime/operating-mechanism.html" rel="nofollow">
       小程序运行机制
      </a>
     </p>
    </blockquote>
    <p>
     小程序中的生命周期有两类：
    </p>
    <ul>
     <li>
      小程序生命周期（全局生命周期）：声明在
      <code>
       app.js
      </code>
      文件中
      <ul>
       <li>
        参考文档：
        <a href="https://developers.weixin.qq.com/miniprogram/dev/framework/app-service/app.html" rel="nofollow">
         注册小程序
        </a>
       </li>
      </ul>
     </li>
     <li>
      页面生命周期：声明在页面的入口文件
      <code>
       &lt;pagename&gt;.js
      </code>
      中
      <ul>
       <li>
        参考文档：
        <a href="https://developers.weixin.qq.com/miniprogram/dev/framework/app-service/page.html" rel="nofollow">
         注册页面
        </a>
       </li>
      </ul>
     </li>
    </ul>
    <h3>
     <a id="_186">
     </a>
     小程序生命周期函数
    </h3>
    <p>
     常用小程序生命周期函数及触发时机：
    </p>
    <ul>
     <li>
      onLaunch - 小程序初始化，小程序冷启动时触发，全局只调用一次
     </li>
     <li>
      onShow - 初始化完成小程序热启动，或从后台切换到前台时触发
     </li>
     <li>
      onHide - 从前台切换到后台时触发
     </li>
    </ul>
    <h4>
     <a id="_194">
     </a>
     测试案例
    </h4>
    <pre><code class="prism language-js"><span class="token comment">// app.js</span>
<span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
  <span class="token function">onLaunch</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'onLaunch - 小程序加载'</span><span class="token punctuation">)</span>
    <span class="token comment">// 默认初始代码...</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">onShow</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'onShow - 小程序显示'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">onHide</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'onHide - 小程序隐藏'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  globalData<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
    userInfo<span class="token operator">:</span> <span class="token keyword">null</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre>
    <p>
     保存文件后，小程序会重新初始化，依次触发
     <code>
      onLaunch
     </code>
     和
     <code>
      onShow
     </code>
     。
    </p>
    <p>
     可点击工具栏上的
     <code>
      切后台
     </code>
     切换到后台触发
     <code>
      onHide
     </code>
     。
    </p>
    <blockquote>
     <p>
      PS：如果工具栏没有
      <code>
       切后台
      </code>
      按钮，可以通过
      <code>
       工具 - 工具栏管理
      </code>
      设置显示的工具栏图标。
     </p>
    </blockquote>
    <h3>
     <a id="_222">
     </a>
     页面生命周期函数
    </h3>
    <p>
     常用页面生命周期函数及触发时机：
    </p>
    <ul>
     <li>
      onLoad - 页面加载时触发，整个页面生命阶段只执行依次
     </li>
     <li>
      onShow - 页面显示或切换到前台时触发
     </li>
     <li>
      onReady - 页面准备就绪（首次渲染完毕）时触发，整个页面生命阶段只执行依次
     </li>
     <li>
      onHide - 页面隐藏或切换后台时触发
     </li>
     <li>
      onUnload - 页面销毁（切换页面）时触发
     </li>
    </ul>
    <h4>
     <a id="_232">
     </a>
     测试案例
    </h4>
    <p>
     修改 test 页面的生命周期函数
    </p>
    <pre><code class="prism language-js"><span class="token comment">// pages/test/test.js</span>
<span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>

  <span class="token comment">/**
   * 页面的初始数据
   */</span>
  data<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>

  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token comment">/**
   * 生命周期函数--监听页面加载
   */</span>
  <span class="token function-variable function">onLoad</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">options</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'onLoad - 页面加载'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token comment">/**
   * 生命周期函数--监听页面初次渲染完成
   */</span>
  <span class="token function-variable function">onReady</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'onReady - 页面就绪'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token comment">/**
   * 生命周期函数--监听页面显示
   */</span>
  <span class="token function-variable function">onShow</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'onShow - 页面显示'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token comment">/**
   * 生命周期函数--监听页面隐藏
   */</span>
  <span class="token function-variable function">onHide</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'onHide - 页面隐藏'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token comment">/**
   * 生命周期函数--监听页面卸载
   */</span>
  <span class="token function-variable function">onUnload</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'onUnload - 页面卸载'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token comment">/**
   * 页面相关事件处理函数--监听用户下拉动作
   */</span>
  <span class="token function-variable function">onPullDownRefresh</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>

  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token comment">/**
   * 页面上拉触底事件的处理函数
   */</span>
  <span class="token function-variable function">onReachBottom</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>

  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token comment">/**
   * 用户点击右上角分享
   */</span>
  <span class="token function-variable function">onShareAppMessage</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>

  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token comment">/**
   * 重载页面
   */</span>
  <span class="token function-variable function">goIndex</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 调用原生 API 重新加载页面</span>
    wx<span class="token punctuation">.</span><span class="token function">reLaunch</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
      url<span class="token operator">:</span> <span class="token string">"/pages/index/index"</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
    <p>
     添加重载功能：
    </p>
    <pre><code class="prism language-html"><span class="token comment">&lt;!--pages/test/test.wxml--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">bindtap</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>goIndex<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>跳转到 index<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>

</code></pre>
    <p>
     配置小程序的底部导航栏
     <code>
      tabBar
     </code>
     ，用于切换页面：
    </p>
    <pre><code class="prism language-json"><span class="token punctuation">{<!-- --></span>
  <span class="token string">"pages"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">"pages/index/index"</span><span class="token punctuation">,</span>
    <span class="token string">"pages/logs/logs"</span><span class="token punctuation">,</span>
    <span class="token string">"pages/test/test"</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token comment">// 窗口配置</span>
  <span class="token string">"window"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">"backgroundTextStyle"</span><span class="token operator">:</span> <span class="token string">"light"</span><span class="token punctuation">,</span>
    <span class="token comment">// 顶部导航栏背景</span>
    <span class="token string">"navigationBarBackgroundColor"</span><span class="token operator">:</span> <span class="token string">"#fff"</span><span class="token punctuation">,</span>
    <span class="token comment">// 顶部导航栏标题</span>
    <span class="token string">"navigationBarTitleText"</span><span class="token operator">:</span> <span class="token string">"Weixin"</span><span class="token punctuation">,</span>
    <span class="token comment">// 顶部导航栏文字颜色</span>
    <span class="token string">"navigationBarTextStyle"</span><span class="token operator">:</span> <span class="token string">"black"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// 底部导航配置</span>
  <span class="token string">"tabBar"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">"list"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{<!-- --></span>
        <span class="token string">"pagePath"</span><span class="token operator">:</span> <span class="token string">"pages/index/index"</span><span class="token punctuation">,</span>
        <span class="token string">"text"</span><span class="token operator">:</span> <span class="token string">"首页"</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{<!-- --></span>
        <span class="token string">"pagePath"</span><span class="token operator">:</span> <span class="token string">"pages/logs/logs"</span><span class="token punctuation">,</span>
        <span class="token string">"text"</span><span class="token operator">:</span> <span class="token string">"日志"</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{<!-- --></span>
        <span class="token string">"pagePath"</span><span class="token operator">:</span> <span class="token string">"pages/test/test"</span><span class="token punctuation">,</span>
        <span class="token string">"text"</span><span class="token operator">:</span> <span class="token string">"测试"</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string">"style"</span><span class="token operator">:</span> <span class="token string">"v2"</span><span class="token punctuation">,</span>
  <span class="token string">"sitemapLocation"</span><span class="token operator">:</span> <span class="token string">"sitemap.json"</span><span class="token punctuation">,</span>
  <span class="token string">"lazyCodeLoading"</span><span class="token operator">:</span> <span class="token string">"requiredComponents"</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/c619dff3f6fdbfd1516859685c2ebbdc.png#pic_center"/>
    </p>
    <p>
     上面的空白是图标预留，可以自行配置
     <code>
      iconPath
     </code>
     和
     <code>
      selectedIconPath
     </code>
     。
    </p>
    <p>
     现在点击导航栏切换页面，查看控制台输出：
    </p>
    <ul>
     <li>
      onShow 在 onReady 前执行
     </li>
     <li>
      切换页面会触发 onShow 和 onHide
     </li>
     <li>
      切换后台时，先触发页面的 onHide 再触发小程序的 onHide
     </li>
     <li>
      切换前台时，先触发小程序的 onShow 再触发页面的 onShow
     </li>
    </ul>
    <h3>
     <a id="_377">
     </a>
     微信小程序的启动流程
    </h3>
    <p>
     <a href="https://developers.weixin.qq.com/miniprogram/dev/framework/app-service/page-life-cycle.html" rel="nofollow">
      官方文档 - 生命周期
     </a>
     中有一张图分别介绍了 View（视图）和 AppService（App 服务）两个线程的生命周期顺序：
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/fa4cf584cfa916d03094e1a691dd1397.png#pic_center"/>
    </p>
    <p>
     综合小程序和页面的生命周期就是微信小程序的启动流程：
    </p>
    <ul>
     <li>
      首先执行小程序生命周期 onLaunch
     </li>
     <li>
      然后执行小程序生命周期 onShow
     </li>
     <li>
      接着执行页面生命周期 onLoad，执行完成后页面就加载出来了
     </li>
     <li>
      接着执行页面生命周期 onShow 显示页面
     </li>
     <li>
      请求数据执行完成后，就会执行页面生命周期 onReady
     </li>
     <li>
      onReady 执行完成后，如果切换后台就会执行页面生命周期 onHide
     </li>
     <li>
      onHide 执行完成后，就会执行小程序生命周期 onHide
     </li>
     <li>
      如果执行页面卸载 onUnload，页面就会被销毁
     </li>
     <li>
      此时如果再访问另一个页面，就会执行这个页面的 onLoad，重复上面的调用过程
     </li>
    </ul>
    <h2>
     <a id="_API_396">
     </a>
     微信原生 API
    </h2>
    <p>
     小程序开发框架提供了丰富的
     <a href="https://developers.weixin.qq.com/miniprogram/dev/framework/app-service/api.html#API" rel="nofollow">
      微信原生 API
     </a>
     ，这些 API 存放在云端（服务器端），不需要自己开发和部署。
    </p>
    <p>
     除了一些 web API，还提供了一些移动端的 API，只能在移动端调用，如：
    </p>
    <ul>
     <li>
      拍照：调用摄像头，返回照片信息
     </li>
     <li>
      扫一扫：识别二维码内容
     </li>
     <li>
      等
     </li>
    </ul>
    <p>
     原生 API 通过
     <code>
      wx.&lt;api&gt;
     </code>
     调用，详细参考
     <a href="https://developers.weixin.qq.com/miniprogram/dev/api/index.html" rel="nofollow">
      API 文档
     </a>
     。
    </p>
    <h2>
     <a id="_408">
     </a>
     代码解析
    </h2>
    <h3>
     <a id="appjs_410">
     </a>
     app.js
    </h3>
    <pre><code class="prism language-js"><span class="token comment">// app.js</span>
<span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
  <span class="token function">onLaunch</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'onLaunch - 小程序加载'</span><span class="token punctuation">)</span>
    <span class="token comment">// 展示本地存储能力</span>
    <span class="token comment">// 同步方式获取本地缓存数据</span>
    <span class="token keyword">const</span> logs <span class="token operator">=</span> wx<span class="token punctuation">.</span><span class="token function">getStorageSync</span><span class="token punctuation">(</span><span class="token string">'logs'</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token comment">// 添加当前启动时间</span>
    logs<span class="token punctuation">.</span><span class="token function">unshift</span><span class="token punctuation">(</span>Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment">// 同步方式设置本地缓存数据</span>
    wx<span class="token punctuation">.</span><span class="token function">setStorageSync</span><span class="token punctuation">(</span><span class="token string">'logs'</span><span class="token punctuation">,</span> logs<span class="token punctuation">)</span>

    <span class="token comment">// 登录</span>
    wx<span class="token punctuation">.</span><span class="token function">login</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
      <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 发送 res.code 到后台换取 openId, sessionKey, unionId</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">onShow</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'onShow - 小程序显示'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">onHide</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'onHide - 小程序隐藏'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// 全局数据</span>
  globalData<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 旧版初始化的项目将用户信息保存在这里</span>
    <span class="token comment">// 新版初始化的项目将用户信息保存在 index.js 中</span>
    userInfo<span class="token operator">:</span> <span class="token keyword">null</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre>
    <blockquote>
     <p>
      以前的版本会在
      <code>
       onLaunch
      </code>
      内部调用
      <code>
       wx.getSettings
      </code>
      获取用户当前设置，根据返回的数据判断授权状态，如果用户已授权，则调用
      <code>
       wx.getUserInfo
      </code>
      获取用户信息。
     </p>
     <p>
      现在更改为在
      <code>
       pages/index/index.js
      </code>
      中调用的
      <code>
       wx.getUserProfile
      </code>
      ，每次请求都会弹出授权窗口，用户同意后返回
      <code>
       userInfo
      </code>
      。
     </p>
    </blockquote>
    <h3>
     <a id="pagesindexindexjs_452">
     </a>
     pages/index/index.js
    </h3>
    <p>
     初始化项目默认启动获取用户信息，可将
     <code>
      canIUseOpenData
     </code>
     设置
     <code>
      false
     </code>
     变更为手动获取：小程序启动后页面会显示
     <code>
      获取头像昵称
     </code>
     ，点击请求
     <code>
      wx.getUserProfile
     </code>
    </p>
    <pre><code class="prism language-js"><span class="token comment">// index.js</span>
<span class="token comment">// 获取应用实例</span>
<span class="token comment">// 获取的是 app.js 中生成的小程序的实例</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">getApp</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
  <span class="token comment">// 绑定数据，类似 vue 的 data</span>
  data<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
    motto<span class="token operator">:</span> <span class="token string">'Hello World'</span><span class="token punctuation">,</span>
    userInfo<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    hasUserInfo<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    canIUse<span class="token operator">:</span> wx<span class="token punctuation">.</span><span class="token function">canIUse</span><span class="token punctuation">(</span><span class="token string">'button.open-type.getUserInfo'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    canIUseGetUserProfile<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    canIUseOpenData<span class="token operator">:</span> wx<span class="token punctuation">.</span><span class="token function">canIUse</span><span class="token punctuation">(</span><span class="token string">'open-data.type.userAvatarUrl'</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> wx<span class="token punctuation">.</span><span class="token function">canIUse</span><span class="token punctuation">(</span><span class="token string">'open-data.type.userNickName'</span><span class="token punctuation">)</span> <span class="token comment">// 如需尝试获取用户信息可改为false</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// 事件处理函数</span>
  <span class="token function">bindViewTap</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    wx<span class="token punctuation">.</span><span class="token function">navigateTo</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
      url<span class="token operator">:</span> <span class="token string">'../logs/logs'</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">onLoad</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>wx<span class="token punctuation">.</span>getUserProfile<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token comment">// 修改数据</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
        canIUseGetUserProfile<span class="token operator">:</span> <span class="token boolean">true</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">getUserProfile</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 推荐使用wx.getUserProfile获取用户信息，开发者每次通过该接口获取用户个人信息均需用户确认，开发者妥善保管用户快速填写的头像昵称，避免重复弹窗</span>
    wx<span class="token punctuation">.</span><span class="token function">getUserProfile</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
      desc<span class="token operator">:</span> <span class="token string">'展示用户信息'</span><span class="token punctuation">,</span> <span class="token comment">// 声明获取用户个人信息后的用途，后续会展示在弹窗中，请谨慎填写</span>
      <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
          userInfo<span class="token operator">:</span> res<span class="token punctuation">.</span>userInfo<span class="token punctuation">,</span>
          hasUserInfo<span class="token operator">:</span> <span class="token boolean">true</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">getUserInfo</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 不推荐使用getUserInfo获取用户信息，预计自2021年4月13日起，getUserInfo将不再弹出弹窗，并直接返回匿名的用户个人信息</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
      userInfo<span class="token operator">:</span> e<span class="token punctuation">.</span>detail<span class="token punctuation">.</span>userInfo<span class="token punctuation">,</span>
      hasUserInfo<span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre>
    <h2>
     <a id="WXML_511">
     </a>
     WXML
    </h2>
    <blockquote>
     <p>
      官方文档：
     </p>
     <ul>
      <li>
       <a href="https://developers.weixin.qq.com/miniprogram/dev/reference/wxml/" rel="nofollow">
        WXML 语法参考
       </a>
      </li>
      <li>
       <a href="https://developers.weixin.qq.com/miniprogram/dev/framework/view/wxml/" rel="nofollow">
        视图层 / WXML
       </a>
      </li>
      <li>
       <a href="https://developers.weixin.qq.com/miniprogram/dev/component/" rel="nofollow">
        组件
       </a>
      </li>
     </ul>
    </blockquote>
    <p>
     <strong>
      WXML
     </strong>
     （WeiXin Markup Language） 是框架设计的一套标签语言。
    </p>
    <ul>
     <li>
      WXML 相当于小程序中的模板引擎
     </li>
     <li>
      WXML 中展示内容的具体标签，称为组件
      <ul>
       <li>
        数据绑定
       </li>
       <li>
        数据展示（条件渲染、列表渲染）
       </li>
      </ul>
     </li>
     <li>
      WXML 与组件之间的关系，就相当于 HTML 与标签
     </li>
    </ul>
    <table>
     <thead>
      <tr>
       <th>
        作用
       </th>
       <th>
        小程序组件
       </th>
       <th>
        HTML 标签
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        展示区块
       </td>
       <td>
        view
       </td>
       <td>
        div
       </td>
      </tr>
      <tr>
       <td>
        展示图片
       </td>
       <td>
        image
       </td>
       <td>
        img
       </td>
      </tr>
      <tr>
       <td>
        展示文本
       </td>
       <td>
        text
       </td>
       <td>
        p
       </td>
      </tr>
      <tr>
       <td>
        链接导航
       </td>
       <td>
        navigator
       </td>
       <td>
        a
       </td>
      </tr>
      <tr>
       <td>
        …
       </td>
       <td>
        …
       </td>
       <td>
        …
       </td>
      </tr>
     </tbody>
    </table>
    <h2>
     <a id="_535">
     </a>
     模板
    </h2>
    <p>
     WXML 的
     <a href="https://developers.weixin.qq.com/miniprogram/dev/reference/wxml/template.html" rel="nofollow">
      模板
     </a>
     可以定义代码片段，在不同地方中调用。
    </p>
    <p>
     使用
     <code>
      &lt;template&gt;
     </code>
     定义模板，使用
     <code>
      &lt;import&gt;
     </code>
     引用模板，使用
     <code>
      is
     </code>
     声明需要使用的模板名称，使用
     <code>
      data
     </code>
     传入模板所需的数据。
    </p>
    <blockquote>
     <p>
      注意：如果
      <code>
       app.json
      </code>
      配置了
      <code>
       "lazyCodeLoading": "requiredComponents"
      </code>
      ，开发者工具中使用了
      <code>
       &lt;import&gt;
      </code>
      引入模板的页面会显示白屏，因为项目开启了按需注入，但真机预览中会正常显示，开发时可以将该配置项删除。
     </p>
    </blockquote>
    <h2>
     <a id="_543">
     </a>
     代码解析
    </h2>
    <h3>
     <a id="pagesindexindexwxml_545">
     </a>
     pages/index/index.wxml
    </h3>
    <pre><code class="prism language-html"><span class="token comment">&lt;!--index.wxml--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>container<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>userinfo<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- wx:if 是 WXML 的条件渲染语法 --&gt;</span>
    <span class="token comment">&lt;!-- 使用数据或表达式的语法是 {<!-- -->{}} --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>block</span> <span class="token attr-name"><span class="token namespace">wx:</span>if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{<!-- -->{canIUseOpenData}}<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token comment">&lt;!-- bindtap 是事件属性，值是需要绑定的处理函数的名称 --&gt;</span>
      <span class="token comment">&lt;!-- 事件触发时会在该页面对应的 Page 中找到相应的事件处理函数 --&gt;</span>
      <span class="token comment">&lt;!-- 小程序绑定事件处理函数只接受字符串，及处理函数名 --&gt;</span>
      <span class="token comment">&lt;!-- 无法自定义调用方式或传参，如 bindtap="{<!-- -->{(e, 'params') =&gt; bindViewTap}}" --&gt;</span>
      <span class="token comment">&lt;!-- 可以将参数绑定在标签上（如 data-param="value"），通过 event 获取 --&gt;</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>userinfo-avatar<span class="token punctuation">"</span></span> <span class="token attr-name">bindtap</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>bindViewTap<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>open-data</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>userAvatarUrl<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>open-data</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>open-data</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>userNickName<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>open-data</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>block</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- 注意这里是 elif 而不是 elseif --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>block</span> <span class="token attr-name"><span class="token namespace">wx:</span>elif</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{<!-- -->{!hasUserInfo}}<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name"><span class="token namespace">wx:</span>if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{<!-- -->{canIUseGetUserProfile}}<span class="token punctuation">"</span></span> <span class="token attr-name">bindtap</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>getUserProfile<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span> 获取头像昵称 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name"><span class="token namespace">wx:</span>elif</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{<!-- -->{canIUse}}<span class="token punctuation">"</span></span> <span class="token attr-name">open-type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>getUserInfo<span class="token punctuation">"</span></span> <span class="token attr-name">bindgetuserinfo</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>getUserInfo<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span> 获取头像昵称 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name"><span class="token namespace">wx:</span>else</span><span class="token punctuation">&gt;</span></span> 请使用1.4.4及以上版本基础库 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>block</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>block</span> <span class="token attr-name"><span class="token namespace">wx:</span>else</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span> <span class="token attr-name">bindtap</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>bindViewTap<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>userinfo-avatar<span class="token punctuation">"</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{<!-- -->{userInfo.avatarUrl}}<span class="token punctuation">"</span></span> <span class="token attr-name">mode</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>cover<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>image</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>userinfo-nickname<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>{<!-- -->{userInfo.nickName}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>block</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>usermotto<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>user-motto<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>{<!-- -->{motto}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>

</code></pre>
    <h3>
     <a id="pageslogslogsjs_582">
     </a>
     pages/logs/logs.js
    </h3>
    <pre><code class="prism language-js"><span class="token comment">// logs.js</span>
<span class="token comment">// 小程序中的模块化开发遵循 CommonJS 规范（exports 导出，require 导入）</span>
<span class="token keyword">const</span> util <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../../utils/util.js'</span><span class="token punctuation">)</span>

<span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
  data<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
    logs<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">onLoad</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 获取日志并设置到 data 中</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
      <span class="token comment">// 同步获取本地缓存</span>
      logs<span class="token operator">:</span> <span class="token punctuation">(</span>wx<span class="token punctuation">.</span><span class="token function">getStorageSync</span><span class="token punctuation">(</span><span class="token string">'logs'</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">log</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span>
          <span class="token comment">// 格式化时间</span>
          date<span class="token operator">:</span> util<span class="token punctuation">.</span><span class="token function">formatTime</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>log<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          timeStamp<span class="token operator">:</span> log
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre>
    <h3>
     <a id="pageslogslogswxml_610">
     </a>
     pages/logs/logs.wxml
    </h3>
    <pre><code class="prism language-html"><span class="token comment">&lt;!--logs.wxml--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>container log-list<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- 列表渲染 --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>block</span> <span class="token attr-name"><span class="token namespace">wx:</span>for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{<!-- -->{logs}}<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">wx:</span>key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>timeStamp<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">wx:</span>for-item</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>log<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>log-item<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>{<!-- -->{index + 1}}. {<!-- -->{log.date}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>block</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>

</code></pre>
    <h3>
     <a id="pageslogslogsjson_623">
     </a>
     pages/logs/logs.json
    </h3>
    <pre><code class="prism language-json"><span class="token punctuation">{<!-- --></span>
  <span class="token comment">// 优先级高于全局配置的导航标题</span>
  <span class="token string">"navigationBarTitleText"</span><span class="token operator">:</span> <span class="token string">"查看启动日志"</span><span class="token punctuation">,</span>
  <span class="token string">"usingComponents"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f:626c6f672e6373646e2e6e65742f753031323936313431392f:61727469636c652f64657461696c732f313233303539393130" class_="artid" style="display:none">
 </p>
</div>


