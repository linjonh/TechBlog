---
layout: post
title: "Go语言编程Go语言中JSON的处理mapstruct-和-JSON字符串的相互转换"
date: 2025-01-06 11:43:43 +0800
description: "JSON的简单介绍JSON （JavaScript Object Notation）是一种比XML更"
keywords: "go struct 转 json 在线"
categories: ['Golang']
tags: ['Json', 'Go']
artid: "80150731"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=80150731
    alt: "Go语言编程Go语言中JSON的处理mapstruct-和-JSON字符串的相互转换"
render_with_liquid: false
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     Go语言编程—Go语言中JSON的处理(map、struct 和 JSON字符串的相互转换)
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-light" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h2 id="json的简单介绍">
     JSON的简单介绍
    </h2>
    <p>
     JSON （JavaScript Object Notation）是一种比XML更轻量级的数据交换格式，在易于人们阅读和编写的同时，也易于程序解析和生成。尽管JSON是JavaScript的一个子集，但JSON采用完全独立于编程语言的文本格式，
     <strong>
      且表现为键/值对集合的文本描述形式（类似一些编程语言中的字典结构），这使它成为较为理想的、跨平台、跨语言的数据交换语言
     </strong>
     。
     <strong>
      正是由于是键值对形式，那么很好的和Go语言中的struct 和 map对应
     </strong>
     。
    </p>
    <h2 id="代码示例">
     代码示例
    </h2>
    <p>
     在下面代码中
     <strong>
      struct-&gt;json,map-&gt;json,json-&gt;struct,json-&gt;map
     </strong>
    </p>
    <pre class="prettyprint"><code class="hljs cs">package main

import (
    <span class="hljs-string">"encoding/json"</span>
    <span class="hljs-string">"fmt"</span>
)

type Student <span class="hljs-keyword">struct</span> {
    Name <span class="hljs-keyword">string</span> `json:<span class="hljs-string">"-"</span>`          <span class="hljs-comment">//对应的json的可以也是大写，可以指定json的二次编码 ,-不会输出到json</span>
    Age  <span class="hljs-keyword">int</span>    `json:<span class="hljs-string">"age,string"</span>` <span class="hljs-comment">//输出为字符串</span>
    Sex  <span class="hljs-keyword">byte</span>   `json:<span class="hljs-string">"性别"</span>`         <span class="hljs-comment">//会转出数字！怎么转出字符？</span>
    Is   <span class="hljs-keyword">bool</span>
    Like []<span class="hljs-keyword">string</span>
    Addr <span class="hljs-keyword">string</span>
}

<span class="hljs-comment">//结构体-&gt;json</span>
func structToJson() {
    <span class="hljs-comment">//转换从json的字段必须首字母大写</span>

    stu := Student{<!-- --><span class="hljs-string">"Laymond"</span>, <span class="hljs-number">18</span>, <span class="hljs-string">'m'</span>, <span class="hljs-keyword">true</span>, []<span class="hljs-keyword">string</span>{<!-- --><span class="hljs-string">"跑步"</span>, <span class="hljs-string">"爬山"</span>, <span class="hljs-string">"学习"</span>}, <span class="hljs-string">"中国.重庆"</span>}

    <span class="hljs-comment">//json_byte, err := json.Marshal(stu)</span>
    json_byte, err := json.MarshalIndent(stu, <span class="hljs-string">""</span>, <span class="hljs-string">" "</span>) <span class="hljs-comment">//看上去更加格式化</span>
    <span class="hljs-keyword">if</span> err != nil {
        fmt.Println(<span class="hljs-string">"json.Marshal error"</span>)
        <span class="hljs-keyword">return</span>
    }
    fmt.Println(<span class="hljs-keyword">string</span>(json_byte))

}

<span class="hljs-comment">//map-&gt;json</span>
func mapToJson() {
    stu := make(map[<span class="hljs-keyword">string</span>]<span class="hljs-keyword">interface</span>{}, <span class="hljs-number">6</span>)
    stu[<span class="hljs-string">"name"</span>] = <span class="hljs-string">"Laymond"</span>
    stu[<span class="hljs-string">"age"</span>] = <span class="hljs-number">18</span>
    stu[<span class="hljs-string">"sex"</span>] = <span class="hljs-string">'m'</span>
    stu[<span class="hljs-string">"is"</span>] = <span class="hljs-keyword">true</span>
    stu[<span class="hljs-string">"like"</span>] = []<span class="hljs-keyword">string</span>{<!-- --><span class="hljs-string">"看书"</span>, <span class="hljs-string">"学习"</span>}
    stu[<span class="hljs-string">"addr"</span>] = <span class="hljs-string">"中国.重庆"</span>
    <span class="hljs-comment">//json_byte, err := json.Marshal(stu)</span>
    json_byte, err := json.MarshalIndent(stu, <span class="hljs-string">""</span>, <span class="hljs-string">" "</span>) <span class="hljs-comment">//看上去更加格式化</span>
    <span class="hljs-keyword">if</span> err != nil {
        fmt.Println(<span class="hljs-string">"json.Marshal error"</span>)
        <span class="hljs-keyword">return</span>
    }
    <span class="hljs-comment">//当然map是无序</span>
    fmt.Println(<span class="hljs-keyword">string</span>(json_byte))
}

<span class="hljs-comment">//json字符串-&gt;struct</span>
func jsonToStruct() {
    <span class="hljs-comment">// 要结构体一一对应，尤其是json二次编码格式</span>
    str := `
    {
         <span class="hljs-string">"age"</span>: <span class="hljs-string">"18"</span>,
         <span class="hljs-string">"性别"</span>: <span class="hljs-number">109</span>,
         <span class="hljs-string">"Is"</span>: <span class="hljs-keyword">true</span>,
         <span class="hljs-string">"Like"</span>: [
          <span class="hljs-string">"跑步"</span>,
          <span class="hljs-string">"爬山"</span>,
          <span class="hljs-string">"学习"</span>
         ],
         <span class="hljs-string">"Addr"</span>: <span class="hljs-string">"中国.重庆"</span>
        }
    `
    <span class="hljs-keyword">var</span> stu Student
    json.Unmarshal([]<span class="hljs-keyword">byte</span>(str), &amp;stu)
    fmt.Println(stu)
}

<span class="hljs-comment">//json字符串-&gt;map</span>
func jsonToMap() {
    str := `
    {
         <span class="hljs-string">"age"</span>: <span class="hljs-number">18</span>,
         <span class="hljs-string">"sex"</span>: <span class="hljs-number">109</span>,
         <span class="hljs-string">"Is"</span>: <span class="hljs-keyword">true</span>,
         <span class="hljs-string">"like"</span>: [
          <span class="hljs-string">"跑步"</span>,
          <span class="hljs-string">"爬山"</span>,
          <span class="hljs-string">"学习"</span>
         ],
         <span class="hljs-string">"Addr"</span>: <span class="hljs-string">"中国.重庆"</span>
        }
    `
    stu := make(map[<span class="hljs-keyword">string</span>]<span class="hljs-keyword">interface</span>{}, <span class="hljs-number">10</span>)
    json.Unmarshal([]<span class="hljs-keyword">byte</span>(str), &amp;stu)
    fmt.Println(stu)
    <span class="hljs-comment">//可以用对应的value类型赋值吗？不可以 接口类型不可以转 其他类型，只能通过类型断言</span>
    <span class="hljs-keyword">var</span> name <span class="hljs-keyword">interface</span>{} = <span class="hljs-string">"Laymond"</span>
    <span class="hljs-comment">//  var name_str string = string(name) //error</span>
    <span class="hljs-keyword">var</span> name_str <span class="hljs-keyword">string</span>
    <span class="hljs-comment">//断言只能用在if 和 switch ,下面是指定类型断言</span>
    <span class="hljs-keyword">if</span> data, ok := name.(<span class="hljs-keyword">string</span>); ok == <span class="hljs-keyword">true</span> {
        name_str = data
        fmt.Println(name_str)
    }
    <span class="hljs-keyword">var</span> stu_str <span class="hljs-keyword">string</span>
    <span class="hljs-comment">//var a_int, b_int int</span>
    <span class="hljs-keyword">for</span> key, <span class="hljs-keyword">value</span> := range stu {
        <span class="hljs-keyword">switch</span> data := <span class="hljs-keyword">value</span>.(type) {
        <span class="hljs-comment">//int和byte类型匹配不到 或许int 类型太多了，不好匹配？</span>
        <span class="hljs-keyword">case</span> int8:
            fmt.Printf(<span class="hljs-string">"key = %v ,%v is int\n"</span>, key, data)
        <span class="hljs-keyword">case</span> <span class="hljs-keyword">byte</span>:
            fmt.Printf(<span class="hljs-string">"key = %v ,%v is byte\n"</span>, key, data)
        <span class="hljs-keyword">case</span> <span class="hljs-keyword">string</span>:
            stu_str = data
            fmt.Printf(<span class="hljs-string">"key = %v ,%v is string\n"</span>, key, data)
        <span class="hljs-keyword">case</span> <span class="hljs-keyword">bool</span>:
            fmt.Printf(<span class="hljs-string">"key = %v ,%v is bool\n"</span>, key, data)
        <span class="hljs-keyword">case</span> []<span class="hljs-keyword">interface</span>{}:
            fmt.Printf(<span class="hljs-string">"key = %v ,%v is interface\n"</span>, key, data)
        }
    }
    fmt.Println(stu_str)
}

func main() {
    fmt.Println(<span class="hljs-string">"---------struct-&gt; json---------"</span>)
    structToJson()
    fmt.Println(<span class="hljs-string">"---------map-&gt; json------------"</span>)
    mapToJson()
    fmt.Println(<span class="hljs-string">"---------json  -&gt; struct-------"</span>)
    jsonToStruct()
    fmt.Println(<span class="hljs-string">"---------json  -&gt; map----------"</span>)
    jsonToMap()
}
</code></pre>
    <h2 id="运行结果">
     运行结果
    </h2>
    <p>
     <img alt="这里写图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/5cb592fc99c05ae3fcbf92fa3ed942f5.png" title=""/>
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f:626c6f672e6373646e2e6e65742f71715f3239353432363131:2f61727469636c652f64657461696c732f3830313530373331" class_="artid" style="display:none">
 </p>
</div>


