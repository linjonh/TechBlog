---
layout: post
title: "python搭建简单本地服务器"
date: 2024-12-11 21:02:25 +0800
description: "没搭建过服务器的人想搭建一个确实有点头疼，ME…不过搭建出来后，如标题，没搭过的骚年继续，asser"
keywords: "个人服务器 python"
categories: ['开发', 'Android']
tags: ['服务器', 'Ubuntu', 'Server', 'Python']
artid: "50616644"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=50616644
    alt: "python搭建简单本地服务器"
render_with_liquid: false
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     python搭建简单本地服务器
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
     没搭建过服务器的人想搭建一个确实有点头疼，ME…
    </p>
    <p>
     不过搭建出来后，如标题，没搭过的骚年继续，assert(reader instanceof 没服务器经验);
    </p>
    <h3 id="环境">
     环境
    </h3>
    <p>
     Ubuntu15.04
    </p>
    <h3 id="server">
     Server
    </h3>
    <ul>
     <li>
      创建
      <code>
       webserver3g.py
      </code>
     </li>
    </ul>
    <pre class="prettyprint"><code class="hljs python"><span class="hljs-comment">###########################################################################</span>
<span class="hljs-comment"># Concurrent server - webserver3g.py                                      #</span>
<span class="hljs-comment">#                                                                         #</span>
<span class="hljs-comment"># Tested with Python 2.7.9 &amp; Python 3.4 on Ubuntu 14.04 &amp; Mac OS X        #</span>
<span class="hljs-comment">###########################################################################</span>
<span class="hljs-keyword">import</span> errno
<span class="hljs-keyword">import</span> os
<span class="hljs-keyword">import</span> signal
<span class="hljs-keyword">import</span> socket

SERVER_ADDRESS = (HOST, PORT) = <span class="hljs-string">''</span>, <span class="hljs-number">8888</span>
REQUEST_QUEUE_SIZE = <span class="hljs-number">1024</span>


<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">grim_reaper</span><span class="hljs-params">(signum, frame)</span>:</span>
    <span class="hljs-keyword">while</span> <span class="hljs-keyword">True</span>:
        <span class="hljs-keyword">try</span>:
            pid, status = os.waitpid(
                -<span class="hljs-number">1</span>,          <span class="hljs-comment"># Wait for any child process</span>
                 os.WNOHANG  <span class="hljs-comment"># Do not block and return EWOULDBLOCK error</span>
            )
        <span class="hljs-keyword">except</span> OSError:
            <span class="hljs-keyword">return</span>

        <span class="hljs-keyword">if</span> pid == <span class="hljs-number">0</span>:  <span class="hljs-comment"># no more zombies</span>
            <span class="hljs-keyword">return</span>


<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">handle_request</span><span class="hljs-params">(client_connection)</span>:</span>
    request = client_connection.recv(<span class="hljs-number">1024</span>)
    print(request.decode())
    http_response = <span class="hljs-string">b"""\
HTTP/1.1 200 OK

Hello, World!
"""</span>
    client_connection.sendall(http_response)


<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">serve_forever</span><span class="hljs-params">()</span>:</span>
    listen_socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    listen_socket.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, <span class="hljs-number">1</span>)
    listen_socket.bind(SERVER_ADDRESS)
    listen_socket.listen(REQUEST_QUEUE_SIZE)
    print(<span class="hljs-string">'Serving HTTP on port {port} ...'</span>.format(port=PORT))

    signal.signal(signal.SIGCHLD, grim_reaper)

    <span class="hljs-keyword">while</span> <span class="hljs-keyword">True</span>:
        <span class="hljs-keyword">try</span>:
            client_connection, client_address = listen_socket.accept()
        <span class="hljs-keyword">except</span> IOError <span class="hljs-keyword">as</span> e:
            code, msg = e.args
            <span class="hljs-comment"># restart 'accept' if it was interrupted</span>
            <span class="hljs-keyword">if</span> code == errno.EINTR:
                <span class="hljs-keyword">continue</span>
            <span class="hljs-keyword">else</span>:
                <span class="hljs-keyword">raise</span>

        pid = os.fork()
        <span class="hljs-keyword">if</span> pid == <span class="hljs-number">0</span>:  <span class="hljs-comment"># child</span>
            listen_socket.close()  <span class="hljs-comment"># close child copy</span>
            handle_request(client_connection)
            client_connection.close()
            os._exit(<span class="hljs-number">0</span>)
        <span class="hljs-keyword">else</span>:  <span class="hljs-comment"># parent</span>
            client_connection.close()  <span class="hljs-comment"># close parent copy and loop over</span>

<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">'__main__'</span>:
    serve_forever()</code></pre>
    <ul>
     <li>
      运行
     </li>
    </ul>
    <pre class="prettyprint"><code class="hljs ruby"><span class="hljs-variable">$ </span>python webserver3g.py</code></pre>
    <h3 id="client">
     Client
    </h3>
    <pre class="prettyprint"><code class="hljs java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">httpGet</span>() {
    String url = <span class="hljs-string">"http://192.168.0.101:8888/hello"</span>;
    OkHttpUtils.get().url(url).build()
            .execute(<span class="hljs-keyword">new</span> StringCallback() {
                <span class="hljs-annotation">@Override</span>
                <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onError</span>(Call call, Exception e) {
                }

                <span class="hljs-annotation">@Override</span>
                <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onResponse</span>(String response) {
                    Log.d(TAG, response);
                }
            });
}</code></pre>
    <p>
     **注意：**1.添加INTERNET权限;2.添加
     <code>
      compile 'com.zhy:okhttputils:2.2.0'
     </code>
     作为网络请求;3.将192.168.0.101换成自己Server的IP;4.手机与Server在同一路由
    </p>
    <h3 id="参考">
     参考
    </h3>
    <p>
     <a href="http://codingpy.com/article/build-a-simple-web-server-part-three/" rel="nofollow">
      http://codingpy.com/article/build-a-simple-web-server-part-three/
     </a>
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="6874747073:3a2f2f626c6f672e6373646e2e6e65742f7875696530303030:2f61727469636c652f64657461696c732f3530363136363434" class_="artid" style="display:none">
 </p>
</div>


