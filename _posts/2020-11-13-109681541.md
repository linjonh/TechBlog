---
layout: post
title: "科研第一步实现Linux服务器上创建python虚拟环境"
date: 2020-11-13 20:03:24 +0800
description: "科研第一步：实现Linux服务器上创建python虚拟环境为什么要创建python虚拟环境如何实现第"
keywords: "linux创建python虚拟环境"
categories: ['科研基础']
tags: ['服务器', 'Tensorflow', 'Python', 'Gpu', 'Anaconda']
artid: "109681541"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=109681541
    alt: "科研第一步实现Linux服务器上创建python虚拟环境"
render_with_liquid: false
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     科研第一步：实现Linux服务器上创建python虚拟环境
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
    </p>
    <div class="toc">
     <h4>
      科研第一步：实现Linux服务器上创建python虚拟环境
     </h4>
     <ul>
      <li>
       <a href="#python_2" rel="nofollow">
        为什么要创建python虚拟环境
       </a>
      </li>
      <li>
       <a href="#_6" rel="nofollow">
        如何实现
       </a>
      </li>
      <li>
       <ul>
        <li>
         <a href="#GPU_7" rel="nofollow">
          第一步GPU驱动安装
         </a>
        </li>
        <li>
         <a href="#anaconda_21" rel="nofollow">
          第二步anaconda实现创建虚拟环境
         </a>
        </li>
        <li>
         <ul>
          <li>
           <a href="#anaconda_22" rel="nofollow">
            为什么选择anaconda
           </a>
          </li>
          <li>
           <a href="#anaconda_24" rel="nofollow">
            安装anaconda指令
           </a>
          </li>
          <li>
           <a href="#python_40" rel="nofollow">
            创建python虚拟环境
           </a>
          </li>
          <li>
           <ul>
            <li>
             <a href="#conda_41" rel="nofollow">
              conda创建
             </a>
            </li>
            <li>
             <a href="#conda_50" rel="nofollow">
              conda激活
             </a>
            </li>
            <li>
             <a href="#_61" rel="nofollow">
              验证
             </a>
            </li>
           </ul>
          </li>
          <li>
           <a href="#tensorflowgpu_65" rel="nofollow">
            在当前虚拟环境内安装tensorflow-gpu
           </a>
          </li>
          <li>
           <a href="#tf_73" rel="nofollow">
            验证tf安装
           </a>
          </li>
         </ul>
        </li>
       </ul>
      </li>
      <li>
       <a href="#pytorch_76" rel="nofollow">
        pytorch安装
       </a>
      </li>
      <li>
       <ul>
        <li>
         <a href="#_96" rel="nofollow">
          总结
         </a>
        </li>
       </ul>
      </li>
     </ul>
    </div>
    <p>
    </p>
    <h2>
     <a id="python_2">
     </a>
     为什么要创建python虚拟环境
    </h2>
    <p>
     第一次写博客，想通过写博客的方式记录下自己研究生阶段的学习，回答标题，进入实验室之后，如果需要经常在github上跑别人的代码或者baseline的时候，基于现在的AI大多由python实现，但是在跑实验的时候由于python版本和tensorflow以及keras等各类库不兼容问题的时候很是头痛，因此我们需要实现快速构建一个python虚拟环境使得可以快速跑baseline模型，并且进行调试并且学习。
    </p>
    <h2>
     <a id="_6">
     </a>
     如何实现
    </h2>
    <h3>
     <a id="GPU_7">
     </a>
     第一步GPU驱动安装
    </h3>
    <ol>
     <li>
      查看服务器上linux的版本以及GPU信息，使用如下指令:
     </li>
    </ol>
    <p>
     <img alt="查看服务器上的GPU信息" src="https://i-blog.csdnimg.cn/blog_migrate/a5fa98dda58aa510c6f068d2717487a8.png#pic_center">
      <br/>
      2. 根据系统版本及GPU型号寻找合适的显卡驱动并下载安装
      <br/>
      <a href="https://www.nvidia.com/Download/index.aspx?lang=en-us" rel="nofollow">
       NVIDIA显卡驱动安装网址
      </a>
      <br/>
      linux安装指令
     </img>
    </p>
    <pre><code class="prism language-bash"><span class="token function">wget</span> <span class="token parameter variable">-c</span> https://us.download.nvidia.com/XFree86/Linux-x86_64/450.66/NVIDIA-Linux-x86_64-450.66.run
</code></pre>
    <p>
     测试：输入nvidia-smi,如有表格输出说明驱动安装成功，如下：
     <br/>
     <img alt="显卡驱动安装成功" src="https://i-blog.csdnimg.cn/blog_migrate/e62bc7719fbf810ea3c2e6d47e84516d.png#pic_center"/>
    </p>
    <h3>
     <a id="anaconda_21">
     </a>
     第二步anaconda实现创建虚拟环境
    </h3>
    <h4>
     <a id="anaconda_22">
     </a>
     为什么选择anaconda
    </h4>
    <p>
     Anaconda可以帮助我们创建多个开发环境，也可以帮助我们安装第三方包。比如在安装tensorflow的时候，它会帮我们安装很多其余所配套的包，以至于不会发生版本兼容问题
    </p>
    <h4>
     <a id="anaconda_24">
     </a>
     安装anaconda指令
    </h4>
    <ol>
     <li>
      下载安装包
      <br/>
      这里我们使用清华镜像文件下载会更快
     </li>
    </ol>
    <pre><code class="prism language-bash"><span class="token function">wget</span> https://mirrors.tuna.tsinghua.edu.cn/anaconda/archive/Anaconda3-2020.07-Linux-x86_64.sh
</code></pre>
    <ol start="2">
     <li>
      安装
     </li>
    </ol>
    <pre><code class="prism language-bash"><span class="token function">bash</span> Anaconda3-2020.07-Linux-x86_64.sh
</code></pre>
    <ol start="3">
     <li>
      更新环境变量
     </li>
    </ol>
    <pre><code class="prism language-bash"><span class="token builtin class-name">source</span> ~/.bashrc
</code></pre>
    <h4>
     <a id="python_40">
     </a>
     创建python虚拟环境
    </h4>
    <h5>
     <a id="conda_41">
     </a>
     conda创建
    </h5>
    <p>
     anaconda安装成功后即可以使用conda指令来创建虚拟环境
     <br/>
     建立环境指令：
     <br/>
     conda create -n
     <strong>
      name
     </strong>
     python=
     <strong>
      3.6
     </strong>
     <br/>
     <strong>
      name
     </strong>
     即想创建的虚拟环境名称，python后面可以输入想安装的python
     <br/>
     版本，如果github上面的代码会出现python2.x的情况的时候，也可以安装python2.x版本
     <br/>
     示例：
     <code>
      conda create -n tf27 python=2.7
     </code>
     <br/>
     <img alt="创建虚拟环境示例" src="https://i-blog.csdnimg.cn/blog_migrate/f4eb80dd9692e0f6a8c26fe92162ddd3.png#pic_center">
      <br/>
      如上图，创建了一个python=2.7，名称为tf27的虚拟环境
     </img>
    </p>
    <h5>
     <a id="conda_50">
     </a>
     conda激活
    </h5>
    <p>
     创建完环境之后需要激活，使用指令
     <br/>
     conda activate
     <strong>
      name
     </strong>
     <br/>
     <strong>
      name
     </strong>
     为刚才自己命名的虚拟环境名
     <br/>
     示例：
     <code>
      conda activate tf27
     </code>
     <br/>
     <img alt="虚拟环境" src="https://i-blog.csdnimg.cn/blog_migrate/50725834409c64627dd1ce67f7b1a93b.png#pic_center">
      <br/>
      此时注意左边的括号内已经从base变成了tf27，即我们从base环境切换到了tf27这个虚拟环境内，在这个虚拟环境中安装的任何python库都是只对这个虚拟环境生效的，即我们可以实现唯一的虚拟环境配置自己想要的库版本，
      <strong>
       注意
      </strong>
      ：在这个虚拟环境内配置的包在base环境下是不能用的，但是我们也一般不用base环境跑代码。
      <br/>
      若想切换回base环境只需使用指令
     </img>
    </p>
    <pre><code class="prism language-bash">conda deactivate
</code></pre>
    <h5>
     <a id="_61">
     </a>
     验证
    </h5>
    <p>
     在base环境内输入
     <code>
      conda env list
     </code>
     ，即可查看当前已经安装了哪些虚拟环境，
     <br/>
     若要删除虚拟环境，需要
     <code>
      conda env remove -n （环境名称）
     </code>
    </p>
    <h4>
     <a id="tensorflowgpu_65">
     </a>
     在当前虚拟环境内安装tensorflow-gpu
    </h4>
    <p>
     只需要使用conda命令即可，
    </p>
    <pre><code class="prism language-bash">conda <span class="token function">install</span> tensorflow-gpu
</code></pre>
    <p>
     如果需要选择版本，也可以
     <code>
      conda install tensorflow-gpu=xxx
     </code>
     <br/>
     但是这样做conda会检测要安装的tf版本是否与当前python版本兼容，不兼容则拒绝安装
    </p>
    <h4>
     <a id="tf_73">
     </a>
     验证tf安装
    </h4>
    <p>
     输入
     <code>
      python
     </code>
     会看到当前python的版本信息
     <br/>
     在python编辑环境下输入
     <code>
      import tensorflow as tf
     </code>
     以及
     <code>
      tf.__version__
     </code>
     即可看到tf的版本信息
    </p>
    <h2>
     <a id="pytorch_76">
     </a>
     pytorch安装
    </h2>
    <p>
     附上经常容易忘记的安装指令：
     <br/>
     pytorch-cuda版本的安装：
     <br/>
     <a href="https://pytorch.org/" rel="nofollow">
      pytorch官网版本下载
     </a>
     <br/>
     选择对应的适配，就可以使用不同的指令
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/00f89055438ce861e7a007e137c1c8f6.png">
      <br/>
      经常下的是python3.6的pytorch
     </img>
    </p>
    <pre><code class="prism language-c">conda install pytorch<span class="token operator">==</span><span class="token number">1.6</span><span class="token number">.0</span> torchvision<span class="token operator">==</span><span class="token number">0.7</span><span class="token number">.0</span> <span class="token operator">-</span>c pytorch
</code></pre>
    <pre><code class="prism language-bash">conda <span class="token function">install</span> <span class="token assign-left variable">pytorch</span><span class="token operator">==</span><span class="token number">1.7</span>.1 <span class="token assign-left variable">torchvision</span><span class="token operator">==</span><span class="token number">0.8</span>.2 <span class="token assign-left variable">torchaudio</span><span class="token operator">==</span><span class="token number">0.7</span>.2 <span class="token assign-left variable">cudatoolkit</span><span class="token operator">=</span><span class="token number">11.0</span> <span class="token parameter variable">-c</span> pytorch
</code></pre>
    <pre><code class="prism language-bash">conda <span class="token function">install</span> <span class="token assign-left variable">pytorch</span><span class="token operator">==</span><span class="token number">1.7</span>.0 <span class="token assign-left variable">torchvision</span><span class="token operator">==</span><span class="token number">0.8</span>.0 <span class="token assign-left variable">torchaudio</span><span class="token operator">==</span><span class="token number">0.7</span>.0 cpuonly <span class="token parameter variable">-c</span> pytorch
</code></pre>
    <h3>
     <a id="_96">
     </a>
     总结
    </h3>
    <p>
     至此，我们完成了在linux服务器上面搭建一个虚拟环境，并且可以实现安装任意版本的python和tensorflow，通过anaconda我们理论上可以创建很多的虚拟环境，用作跑出需要不同版本python以及深度学习框架的代码，但是为了更加方便的跑代码，我们一般会使用pycharm连接服务器或者jupyter与本次博客所用的东西结合起来，实现图形化编辑界面并且可以在服务器上跑代码，实现速度快，环境多，观感好等优点的写代码环境，使得更加方便的在不同虚拟环境下跑模型，下篇博客将写的就是pycharm连接服务器以及jupyter的使用。
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f626c:6f672e6373646e2e6e65742f6673313334313832353133372f:61727469636c652f64657461696c732f313039363831353431" class_="artid" style="display:none">
 </p>
</div>


