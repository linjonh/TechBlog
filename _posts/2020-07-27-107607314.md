---
layout: post
title: "VSCode切换Python2和Python3"
date: 2020-07-27 11:10:22 +0800
description: "文章浏览阅读9.2k次，点赞11次，当电脑中同时安装Python2和Python3时，通过重命名Py"
keywords: "vscode python2"
categories: ['未分类']
tags: ['Python']
artid: "107607314"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=107607314
    alt: "VSCode切换Python2和Python3"
render_with_liquid: false
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     VSCode切换Python2和Python3
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-light" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
    </p>
    <div class="toc">
     <h4>
      VSCode切换使用Python2和Python3
     </h4>
     <ul>
      <li>
       <ul>
        <li>
         <a href="#_2" rel="nofollow">
          起因
         </a>
        </li>
        <li>
         <a href="#_18" rel="nofollow">
          解决
         </a>
        </li>
       </ul>
      </li>
     </ul>
    </div>
    <p>
    </p>
    <h3>
     <a id="_2">
     </a>
     起因
    </h3>
    <p>
     其实VSCode很早之前就安装了，但是一直没用它，现在才用，所以导致现在不记得自己安装过什么插件、修改过什么配置…
    </p>
    <p>
     点击左侧的
     <kbd>
      扩展
     </kbd>
     ，可以看到我安装过
     <strong>
      Code Runner
     </strong>
     这个插件，也正是因为此，我能直接在目录下新建一个临时的
     <code>
      temp.py
     </code>
     文件，并且用VSCode打开，编写完代码后按下快捷键
     <kbd>
      Ctrl
     </kbd>
     +
     <kbd>
      Alt
     </kbd>
     +
     <kbd>
      N
     </kbd>
     ，快速运行代码；这对运行一些零散的Python脚本而言十分便捷
    </p>
    <p>
     但是今天发现编写了一些Python2的代码，点击左下角的切换到Python2的解释器，却发现无法运行：
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/6ea11941d9614c9d456bd8f0bd8dcb46.png"/>
    </p>
    <p>
     VSCode的设置中搜索
     <code>
      python.pythonpath
     </code>
     ，发现Python2的路径没有问题：
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/ee72c7192d6553ac3d805c88c38dcd76.png"/>
    </p>
    <h3>
     <a id="_18">
     </a>
     解决
    </h3>
    <p>
     原因在于我的电脑中同时安装了Python2和Python3，如果只有一个版本的Python，那么在终端进入Python窗口时，只需键入
     <code>
      python
     </code>
     ；但同时有了Python2和Python3，那么我就前往Python2的安装目录下，把Python2的可执行文件
     <code>
      python.exe
     </code>
     和
     <code>
      pythonw.exe
     </code>
     重命名为
     <strong>
      <code>
       python2.exe
      </code>
     </strong>
     和
     <strong>
      <code>
       pythonw2.exe
      </code>
     </strong>
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/9a1020358c80b0a82f7dde2f106d78f6.png"/>
    </p>
    <p>
     所以在cmd中，如果想使用Python2，就键入
     <code>
      python2
     </code>
     ；如果想使用Python3，键入默认的
     <code>
      python
     </code>
     即可
    </p>
    <p>
     留意到下图中的这里（红框处）：
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/e3456596458be0d09d73e10f69f45ccd.png"/>
    </p>
    <p>
     检查发现，无论是Python2还是Python3，
     <code>
      [Running]
     </code>
     后面的指令都是
     <code>
      python -u
     </code>
     ；这就相当于我们在cmd始终执行的是
     <code>
      python -u xxx.py
     </code>
     指令，虽然我们Python2的路径是正确的，但始终没有用到
    </p>
    <p>
     参考
     <a href="https://stackoverflow.com/questions/54299927/vscode-running-python-2-instead-of-3" rel="nofollow">
      https://stackoverflow.com/questions/54299927/vscode-running-python-2-instead-of-3
     </a>
     ，原来是之前安装的
     <strong>
      Code Runner
     </strong>
     的锅，我们打开VSCode的设置，搜索
     <strong>
      <code>
       code-runner.executormap
      </code>
     </strong>
     ，可以看到：
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/8252d36c10af68efed5984c0452109e4.png"/>
    </p>
    <p>
     <strong>
      Code Runner
     </strong>
     根据你运行的代码类型，会自动添加指令，这就相当于你在cmd下执行了指令
     <code>
      python -u xxx.py
     </code>
     ；我们尝试把黄色框中的
     <code>
      "python -u"
     </code>
     改成
     <strong>
      <code>
       "python2 -u"
      </code>
     </strong>
     ，这样Python2的代码就能成功运行了
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/cd118620766d6f9acd6752d8e6a166de.png"/>
    </p>
    <p>
     但是Python3代码反而不能运行了
    </p>
    <p>
     它坑就坑在不会对Python2和Python3进行区分，如果我们点击左下角切换解释器，会发现上图中的
     <strong>
      <code>
       python.pythonPath
      </code>
     </strong>
     会发生改变，但
     <strong>
      <code>
       code-runner.executorMap
      </code>
     </strong>
     则不会，也就是说Python2和Python3共用一个
     <strong>
      <code>
       code-runner.executorMap
      </code>
     </strong>
    </p>
    <p>
     这就导致了想快捷键直接运行Python代码，必须看你设置的是
     <code>
      python -u
     </code>
     还是
     <code>
      python2 -u
     </code>
    </p>
    <p>
    </p>
    <p>
     参考
     <strong>
      Code Runner
     </strong>
     在Github上的issue：
     <a href="https://github.com/formulahendry/vscode-code-runner/issues/395">
      https://github.com/formulahendry/vscode-code-runner/issues/395
     </a>
    </p>
    <p>
     用户dhdavvie给出了一个解决方案：
    </p>
    <pre><code class="prism language-json">    <span class="token string-property property">"code-runner.executorMap"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
        <span class="token string-property property">"python"</span><span class="token operator">:</span> <span class="token string">"$pythonPath $fullFileName"</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string-property property">"code-runner.runInTerminal"</span><span class="token operator">:</span> <span class="token boolean">true</span>
</code></pre>
    <p>
     在运行Python代码时，它不再直接执行
     <code>
      python -u xxx.py
     </code>
     或
     <code>
      python2 -u xxx.py
     </code>
     ，而是把两个参数的值作为指令：第一个参数是Python解释器的路径
     <strong>
      <code>
       $pythonPath
      </code>
     </strong>
     、第二个是待执行的文件
     <strong>
      <code>
       $fullFileName
      </code>
     </strong>
     ；这样就相当于直接用Python的可执行文件执行
     <code>
      .py
     </code>
    </p>
    <blockquote>
     <p>
      这里有点小问题，VSCode在输出
      <strong>
       <code>
        $pythonPath
       </code>
      </strong>
      时是不带双引号的，而我又是把Python2和Python3的可执行文件放在有空格的目录下，导致：
     </p>
     <p>
      <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/f002442ae8ef9292dba3faeac6e737ee.png"/>
     </p>
     <p>
      由于路径中有
      <code>
       Program Files
      </code>
      ，它直接在空格那截断了
     </p>
     <p>
      解决它的方法就是人为添加上双引号，最终我的
      <strong>
       <code>
        code-runner.executorMap
       </code>
      </strong>
      的设置为：
     </p>
     <p>
      <img alt="" src="https://i-blog.csdnimg.cn/blog_migrate/4a5e28a67eeb19d88a402e56a57acd77.png"/>
     </p>
    </blockquote>
    <p>
     最终效果为：
    </p>
    <ul>
     <li>
      <p>
       执行Python2代码：
      </p>
      <p>
       <img alt="" src="https://i-blog.csdnimg.cn/blog_migrate/780f4d995c38e0d4345662dd2cd0af71.png"/>
      </p>
     </li>
     <li>
      <p>
       点击左下角切换到Python3，直接运行：
      </p>
      <p>
       <img alt="" src="https://i-blog.csdnimg.cn/blog_migrate/ebd15c1e4d0873008bd485028d25c9db.png"/>
      </p>
     </li>
    </ul>
    <p>
     这样只用切换左下角的解释器，就能快速运行Python2和Python3的代码了
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a:2f2f626c6f672e6373646e2e6e65742f6e696d626c6532322f:61727469636c652f64657461696c732f313037363037333134" class_="artid" style="display:none">
 </p>
</div>


