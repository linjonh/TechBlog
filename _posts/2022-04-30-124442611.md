---
layout: post
title: 在Java项目中配置Redis
date: 2022-04-30 09:21:44 +0800
description: "环境：操作系统： Ubuntu 20.04Redis：6."
keywords: java redis jar
categories: ['Springboot', 'Java', 'Db']
tags: ['Springboot', 'Redis', 'Lettuce', 'Jedis']
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=124442611
    alt: 在Java项目中配置Redis
artid: 124442611
render_with_liquid: false
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     在Java项目中配置Redis
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
     环境：
    </p>
    <ul>
     <li>
      操作系统： Ubuntu 20.04
     </li>
     <li>
      Redis：6.2.6
     </li>
     <li>
      开发工具：IntelliJ IDEA 2022.1 (Community Edition)
     </li>
    </ul>
    <p>
     Redis官网（
     <a href="https://redis.io/docs/clients/#java" rel="nofollow">
      https://redis.io/docs/clients/#java
     </a>
     ）所推荐的Java客户端有：
    </p>
    <ul>
     <li>
      <code>
       Redisson
      </code>
     </li>
     <li>
      <code>
       Jedis
      </code>
     </li>
     <li>
      <code>
       lettuce
      </code>
     </li>
    </ul>
    <p>
     等等。本文将介绍
     <code>
      Jedis
     </code>
     和
     <code>
      lettuce
     </code>
     。
    </p>
    <h2>
     <a id="Jedis_12">
     </a>
     Jedis
    </h2>
    <h3>
     <a id="1_13">
     </a>
     方法1：手工配置
    </h3>
    <p>
     即手工搜索并下载所需的jar包，可以到以下网站搜索：
    </p>
    <ul>
     <li>
      <a href="https://mvnrepository.com/" rel="nofollow">
       https://mvnrepository.com/
      </a>
     </li>
     <li>
      <a href="https://search.maven.org/" rel="nofollow">
       https://search.maven.org/
      </a>
     </li>
    </ul>
    <p>
     搜索
     <code>
      jedis
     </code>
     ，下载
     <code>
      jedis-4.2.2.jar
     </code>
     文件。
    </p>
    <p>
     新建项目
     <code>
      test0427_1
     </code>
     ：
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/d3e000d91f96f81009f0ec349e696c34.png">
      <br/>
      在项目下创建
      <code>
       lib
      </code>
      目录，把
      <code>
       jedis-4.2.2.jar
      </code>
      复制到这里。
     </img>
    </p>
    <pre><code class="prism language-powershell">➜  test0427_1 mkdir lib
➜  test0427_1 <span class="token function">cp</span> ~<span class="token operator">/</span>Downloads/jedis-4<span class="token punctuation">.</span>2<span class="token punctuation">.</span>2<span class="token punctuation">.</span>jar lib/
➜  test0427_1 
</code></pre>
    <p>
     <code>
      File
     </code>
     -&gt;
     <code>
      Project Structure...
     </code>
     -&gt;
     <code>
      Modules
     </code>
     -&gt;
     <code>
      Dependencies
     </code>
     ，点击
     <code>
      +
     </code>
     图标，选择
     <code>
      JARs or Directories...
     </code>
     ，然后选择
     <code>
      jedis-4.2.2.jar
     </code>
     文件：
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/c86b7f8d0eacf860059cc89433e14749.png">
      <br/>
      创建
      <code>
       Test0427.java
      </code>
      文件如下：
     </img>
    </p>
    <pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">pkg1</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">redis<span class="token punctuation">.</span>clients<span class="token punctuation">.</span>jedis<span class="token punctuation">.</span></span><span class="token class-name">Jedis</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">redis<span class="token punctuation">.</span>clients<span class="token punctuation">.</span>jedis<span class="token punctuation">.</span></span><span class="token class-name">JedisPool</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Test0427</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">JedisPool</span> pool <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JedisPool</span><span class="token punctuation">(</span><span class="token string">"localhost"</span><span class="token punctuation">,</span> <span class="token number">6379</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">try</span> <span class="token punctuation">(</span><span class="token class-name">Jedis</span> jedis <span class="token operator">=</span> pool<span class="token punctuation">.</span><span class="token function">getResource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            jedis<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">"mykey1"</span><span class="token punctuation">,</span> <span class="token string">"500"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     运行程序，报错如下：
    </p>
    <pre><code class="prism language-powershell"><span class="token operator">/</span>home/ding/IdeaProjects/test0427_1/src/pkg1/Test0427<span class="token punctuation">.</span>java:8:26
java: cannot access org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>commons<span class="token punctuation">.</span>pool2<span class="token punctuation">.</span>impl<span class="token punctuation">.</span>GenericObjectPoolConfig
  <span class="token keyword">class</span> file <span class="token keyword">for</span> org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>commons<span class="token punctuation">.</span>pool2<span class="token punctuation">.</span>impl<span class="token punctuation">.</span>GenericObjectPoolConfig not found
</code></pre>
    <p>
     从
     <a href="http://www.bjpowernode.com/tutorial_redis/342.html" rel="nofollow">
      http://www.bjpowernode.com/tutorial_redis/342.html
     </a>
     可知，还需要下载
     <code>
      commons-pool2
     </code>
     。
    </p>
    <p>
     搜索
     <code>
      commons-pool2
     </code>
     ，并下载
     <code>
      commons-pool2-2.11.1.jar
     </code>
     文件，按前面的方法将其添加到项目里。
    </p>
    <p>
     运行程序，报错如下：
    </p>
    <pre><code class="prism language-powershell">Exception in thread <span class="token string">"main"</span> java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>NoClassDefFoundError: org/slf4j/LoggerFactory
	at redis<span class="token punctuation">.</span>clients<span class="token punctuation">.</span>jedis<span class="token punctuation">.</span>JedisPool<span class="token punctuation">.</span>&lt;clinit&gt;<span class="token punctuation">(</span>JedisPool<span class="token punctuation">.</span>java:19<span class="token punctuation">)</span>
	at pkg1<span class="token punctuation">.</span>Test0427<span class="token punctuation">.</span>main<span class="token punctuation">(</span>Test0427<span class="token punctuation">.</span>java:8<span class="token punctuation">)</span>
Caused by: java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>ClassNotFoundException: org<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span>LoggerFactory
	at java<span class="token punctuation">.</span>base/jdk<span class="token punctuation">.</span>internal<span class="token punctuation">.</span>loader<span class="token punctuation">.</span>BuiltinClassLoader<span class="token punctuation">.</span>loadClass<span class="token punctuation">(</span>BuiltinClassLoader<span class="token punctuation">.</span>java:641<span class="token punctuation">)</span>
	at java<span class="token punctuation">.</span>base/jdk<span class="token punctuation">.</span>internal<span class="token punctuation">.</span>loader<span class="token punctuation">.</span>ClassLoaders<span class="token variable">$AppClassLoader</span><span class="token punctuation">.</span>loadClass<span class="token punctuation">(</span>ClassLoaders<span class="token punctuation">.</span>java:188<span class="token punctuation">)</span>
	at java<span class="token punctuation">.</span>base/java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>ClassLoader<span class="token punctuation">.</span>loadClass<span class="token punctuation">(</span>ClassLoader<span class="token punctuation">.</span>java:520<span class="token punctuation">)</span>
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> 2 more
</code></pre>
    <p>
     继续搜索
     <code>
      slf4j.api
     </code>
     ，下载
     <code>
      slf4j-api-2.0.0-alpha7.jar
     </code>
     文件，按前面的方法将其添加到项目里。
    </p>
    <p>
     运行程序，报错如下：
    </p>
    <pre><code class="prism language-powershell">SLF4J: No SLF4J providers were found<span class="token punctuation">.</span>
SLF4J: Defaulting to no-operation <span class="token punctuation">(</span>NOP<span class="token punctuation">)</span> logger implementation
SLF4J: See http:<span class="token operator">/</span><span class="token operator">/</span>www<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span>org/codes<span class="token punctuation">.</span>html<span class="token comment">#noProviders for further details.</span>
Exception in thread <span class="token string">"main"</span> java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>NoClassDefFoundError: com/google/gson/Gson
	at redis<span class="token punctuation">.</span>clients<span class="token punctuation">.</span>jedis<span class="token punctuation">.</span>CommandObjects<span class="token punctuation">.</span>&lt;clinit&gt;<span class="token punctuation">(</span>CommandObjects<span class="token punctuation">.</span>java:3655<span class="token punctuation">)</span>
	at redis<span class="token punctuation">.</span>clients<span class="token punctuation">.</span>jedis<span class="token punctuation">.</span>Jedis<span class="token punctuation">.</span>&lt;init&gt;<span class="token punctuation">(</span>Jedis<span class="token punctuation">.</span>java:39<span class="token punctuation">)</span>
	at redis<span class="token punctuation">.</span>clients<span class="token punctuation">.</span>jedis<span class="token punctuation">.</span>JedisFactory<span class="token punctuation">.</span>makeObject<span class="token punctuation">(</span>JedisFactory<span class="token punctuation">.</span>java:181<span class="token punctuation">)</span>
	at org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>commons<span class="token punctuation">.</span>pool2<span class="token punctuation">.</span>impl<span class="token punctuation">.</span>GenericObjectPool<span class="token punctuation">.</span>create<span class="token punctuation">(</span>GenericObjectPool<span class="token punctuation">.</span>java:571<span class="token punctuation">)</span>
	at org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>commons<span class="token punctuation">.</span>pool2<span class="token punctuation">.</span>impl<span class="token punctuation">.</span>GenericObjectPool<span class="token punctuation">.</span>borrowObject<span class="token punctuation">(</span>GenericObjectPool<span class="token punctuation">.</span>java:298<span class="token punctuation">)</span>
	at org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>commons<span class="token punctuation">.</span>pool2<span class="token punctuation">.</span>impl<span class="token punctuation">.</span>GenericObjectPool<span class="token punctuation">.</span>borrowObject<span class="token punctuation">(</span>GenericObjectPool<span class="token punctuation">.</span>java:223<span class="token punctuation">)</span>
	at redis<span class="token punctuation">.</span>clients<span class="token punctuation">.</span>jedis<span class="token punctuation">.</span>util<span class="token punctuation">.</span>Pool<span class="token punctuation">.</span>getResource<span class="token punctuation">(</span>Pool<span class="token punctuation">.</span>java:34<span class="token punctuation">)</span>
	at redis<span class="token punctuation">.</span>clients<span class="token punctuation">.</span>jedis<span class="token punctuation">.</span>JedisPool<span class="token punctuation">.</span>getResource<span class="token punctuation">(</span>JedisPool<span class="token punctuation">.</span>java:364<span class="token punctuation">)</span>
	at pkg1<span class="token punctuation">.</span>Test0427<span class="token punctuation">.</span>main<span class="token punctuation">(</span>Test0427<span class="token punctuation">.</span>java:10<span class="token punctuation">)</span>
Caused by: java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>ClassNotFoundException: com<span class="token punctuation">.</span>google<span class="token punctuation">.</span>gson<span class="token punctuation">.</span>Gson
	at java<span class="token punctuation">.</span>base/jdk<span class="token punctuation">.</span>internal<span class="token punctuation">.</span>loader<span class="token punctuation">.</span>BuiltinClassLoader<span class="token punctuation">.</span>loadClass<span class="token punctuation">(</span>BuiltinClassLoader<span class="token punctuation">.</span>java:641<span class="token punctuation">)</span>
	at java<span class="token punctuation">.</span>base/jdk<span class="token punctuation">.</span>internal<span class="token punctuation">.</span>loader<span class="token punctuation">.</span>ClassLoaders<span class="token variable">$AppClassLoader</span><span class="token punctuation">.</span>loadClass<span class="token punctuation">(</span>ClassLoaders<span class="token punctuation">.</span>java:188<span class="token punctuation">)</span>
	at java<span class="token punctuation">.</span>base/java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>ClassLoader<span class="token punctuation">.</span>loadClass<span class="token punctuation">(</span>ClassLoader<span class="token punctuation">.</span>java:520<span class="token punctuation">)</span>
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> 9 more
</code></pre>
    <p>
     <code>
      SLF4J
     </code>
     的错误其实并不影响运行，真正影响运行的是
     <code>
      gson
     </code>
     的错误。继续搜索
     <code>
      gson
     </code>
     ，下载
     <code>
      gson-2.9.0.jar
     </code>
     文件，按前面的方法将其添加到项目里。
    </p>
    <p>
     运行程序，报错如下：
    </p>
    <pre><code class="prism language-powershell">SLF4J: No SLF4J providers were found<span class="token punctuation">.</span>
SLF4J: Defaulting to no-operation <span class="token punctuation">(</span>NOP<span class="token punctuation">)</span> logger implementation
SLF4J: See http:<span class="token operator">/</span><span class="token operator">/</span>www<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span>org/codes<span class="token punctuation">.</span>html<span class="token comment">#noProviders for further details.</span>
</code></pre>
    <p>
     不过也成功了。
    </p>
    <p>
     如果想移除错误，继续搜索
     <code>
      slf4j.simpl
     </code>
     ，下载
     <code>
      slf4j-simple-2.0.0-alpha7.jar
     </code>
     文件，按前面的方法将其添加到项目里。
    </p>
    <p>
     运行程序，这回终于没有任何错误了。
    </p>
    <p>
     最终所使用的的jar包如下：
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/1a7f62f62605f9edac2872ccca0f5bb9.png"/>
    </p>
    <h3>
     <a id="2Maven_122">
     </a>
     方法2：Maven配置
    </h3>
    <p>
     手工配置Jedis实在太麻烦，所以显而易见的解决方案是使用Maven来管理依赖。
    </p>
    <p>
     新建Maven项目
     <code>
      test0427_2
     </code>
     ：
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/f864fc823c4cf99235781b51853405d0.png">
      <br/>
      打开
      <code>
       pom.xml
      </code>
      文件，添加如下内容：
     </img>
    </p>
    <pre><code class="prism language-xml">        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>redis.clients<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>jedis<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>4.2.2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre>
    <p>
     注：需要加到
     <code>
      &lt;dependencies&gt;
     </code>
     里面，如果没有就手工创建一下。
    </p>
    <p>
     同样，创建
     <code>
      Test0427.java
     </code>
     文件如下：
    </p>
    <pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">pkg1</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">redis<span class="token punctuation">.</span>clients<span class="token punctuation">.</span>jedis<span class="token punctuation">.</span></span><span class="token class-name">Jedis</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">redis<span class="token punctuation">.</span>clients<span class="token punctuation">.</span>jedis<span class="token punctuation">.</span></span><span class="token class-name">JedisPool</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Test0427</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">JedisPool</span> pool <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JedisPool</span><span class="token punctuation">(</span><span class="token string">"localhost"</span><span class="token punctuation">,</span> <span class="token number">6379</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">try</span> <span class="token punctuation">(</span><span class="token class-name">Jedis</span> jedis <span class="token operator">=</span> pool<span class="token punctuation">.</span><span class="token function">getResource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            jedis<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">"mykey1"</span><span class="token punctuation">,</span> <span class="token string">"500"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     运行程序，报错如下：
    </p>
    <pre><code class="prism language-powershell">SLF4J: Failed to load <span class="token keyword">class</span> <span class="token string">"org.slf4j.impl.StaticLoggerBinder"</span><span class="token punctuation">.</span>
SLF4J: Defaulting to no-operation <span class="token punctuation">(</span>NOP<span class="token punctuation">)</span> logger implementation
SLF4J: See http:<span class="token operator">/</span><span class="token operator">/</span>www<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span>org/codes<span class="token punctuation">.</span>html<span class="token comment">#StaticLoggerBinder for further details.</span>
</code></pre>
    <p>
     不过也成功了。
    </p>
    <p>
     这个错误跟方法1缺少
     <code>
      slf4j-simple-2.0.0-alpha7.jar
     </code>
     文件的错误完全一样。
    </p>
    <p>
     查看
     <code>
      External Libraries
     </code>
     ，可见除了
     <code>
      slf4j-simple-2.0.0-alpha7.jar
     </code>
     以外，已经包含了方法1所添加的那些jar包。
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/5eaacd00e4788799012da9ccffe83292.png"/>
    </p>
    <p>
     如果想移除错误，在
     <code>
      pom.xml
     </code>
     中添加以下依赖：
    </p>
    <pre><code class="prism language-xml">        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.slf4j<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>slf4j-simple<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.7.32<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre>
    <p>
     注：版本是
     <code>
      1.7.32
     </code>
     ，因为
     <code>
      slf4j-api
     </code>
     的版本是
     <code>
      1.7.32
     </code>
     。如果换成别的版本（比如
     <code>
      2.0.0-alpha7
     </code>
     ），貌似不行，仍然报错。
    </p>
    <p>
     查看
     <code>
      External Libraries
     </code>
     ，如下：
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/5ab3b92772672c6c9dc3a43ec3b0327b.png"/>
    </p>
    <h3>
     <a id="3SpringBoot_189">
     </a>
     方法3：SpringBoot
    </h3>
    <p>
     参见下面Lettuce部分的SpringBoot配置。Spring Data Redis默认使用的是Lettuce。
    </p>
    <h2>
     <a id="Lettuce_192">
     </a>
     Lettuce
    </h2>
    <h3>
     <a id="1_193">
     </a>
     方法1：手工配置
    </h3>
    <p>
     即手工搜索并下载所需的jar包。可从（
     <a href="https://github.com/lettuce-io/lettuce-core/releases">
      https://github.com/lettuce-io/lettuce-core/releases
     </a>
     ）下载。我看到的最新版本是6.1.8，但是该版本只提供源码下载，需要自己做build，于是我下载了6.1.7的包
     <code>
      lettuce-core-6.1.7.RELEASE-bin.tar.gz
     </code>
     。
    </p>
    <p>
     解压后得到
     <code>
      lettuce-core-6.1.7.RELEASE.jar
     </code>
     以及其它一些jar包。
    </p>
    <p>
     新建项目
     <code>
      test0429_1
     </code>
     ：
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/586efc4cc2af4bbcd35f16e98f639b57.png">
      <br/>
      在项目下创建
      <code>
       lib
      </code>
      目录，把
      <code>
       lettuce-core-6.1.7.RELEASE.jar
      </code>
      以及其它所有的jar包都复制到这里。
     </img>
    </p>
    <p>
     <code>
      File
     </code>
     -&gt;
     <code>
      Project Structure...
     </code>
     -&gt;
     <code>
      Modules
     </code>
     -&gt;
     <code>
      Dependencies
     </code>
     ，点击
     <code>
      +
     </code>
     图标，选择
     <code>
      JARs or Directories...
     </code>
     ，然后选择
     <code>
      lib
     </code>
     目录下所有的文件：
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/0f76293ac3072532677c812d26f2df42.png">
      <br/>
      最终所使用的jar包如下：
     </img>
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/aee27c2d0a589dc5c43e571b94959f4a.png">
      <br/>
      创建
      <code>
       Test0429.java
      </code>
      文件如下：
     </img>
    </p>
    <pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">pkg1</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">io<span class="token punctuation">.</span>lettuce<span class="token punctuation">.</span>core<span class="token punctuation">.</span></span><span class="token class-name">RedisClient</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">io<span class="token punctuation">.</span>lettuce<span class="token punctuation">.</span>core<span class="token punctuation">.</span></span><span class="token class-name">RedisURI</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">io<span class="token punctuation">.</span>lettuce<span class="token punctuation">.</span>core<span class="token punctuation">.</span>api<span class="token punctuation">.</span></span><span class="token class-name">StatefulRedisConnection</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">io<span class="token punctuation">.</span>lettuce<span class="token punctuation">.</span>core<span class="token punctuation">.</span>api<span class="token punctuation">.</span>sync<span class="token punctuation">.</span></span><span class="token class-name">RedisCommands</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>time<span class="token punctuation">.</span></span><span class="token class-name">Duration</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>time<span class="token punctuation">.</span>temporal<span class="token punctuation">.</span></span><span class="token class-name">ChronoUnit</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Test0429</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">RedisURI</span> redisUri <span class="token operator">=</span> <span class="token class-name">RedisURI</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">withHost</span><span class="token punctuation">(</span><span class="token string">"localhost"</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">withDatabase</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">withPort</span><span class="token punctuation">(</span><span class="token number">6379</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">withTimeout</span><span class="token punctuation">(</span><span class="token class-name">Duration</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token class-name">ChronoUnit</span><span class="token punctuation">.</span>SECONDS<span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">RedisClient</span> redisClient <span class="token operator">=</span> <span class="token class-name">RedisClient</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>redisUri<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">StatefulRedisConnection</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> conn <span class="token operator">=</span> redisClient<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">RedisCommands</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> command <span class="token operator">=</span> conn<span class="token punctuation">.</span><span class="token function">sync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        command<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">"mykey1"</span><span class="token punctuation">,</span> <span class="token string">"500"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        conn<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        redisClient<span class="token punctuation">.</span><span class="token function">shutdown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     运行程序，OK，测试成功！
    </p>
    <h3>
     <a id="2Maven_248">
     </a>
     方法2：Maven配置
    </h3>
    <p>
     新建Maven项目
     <code>
      test0429_2
     </code>
     ：
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/c36f2b60df66c717b77994c05df02136.png">
      <br/>
      打开
      <code>
       pom.xml
      </code>
      文件，添加如下内容：
     </img>
    </p>
    <pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>io.lettuce<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>lettuce-core<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>6.1.8.RELEASE<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre>
    <p>
     注：需要加到
     <code>
      &lt;dependencies&gt;
     </code>
     里面，如果没有就手工创建一下。
    </p>
    <p>
     同样，创建
     <code>
      Test0429.java
     </code>
     文件如下：
    </p>
    <pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">pkg1</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">io<span class="token punctuation">.</span>lettuce<span class="token punctuation">.</span>core<span class="token punctuation">.</span></span><span class="token class-name">RedisClient</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">io<span class="token punctuation">.</span>lettuce<span class="token punctuation">.</span>core<span class="token punctuation">.</span></span><span class="token class-name">RedisURI</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">io<span class="token punctuation">.</span>lettuce<span class="token punctuation">.</span>core<span class="token punctuation">.</span>api<span class="token punctuation">.</span></span><span class="token class-name">StatefulRedisConnection</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">io<span class="token punctuation">.</span>lettuce<span class="token punctuation">.</span>core<span class="token punctuation">.</span>api<span class="token punctuation">.</span>sync<span class="token punctuation">.</span></span><span class="token class-name">RedisCommands</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>time<span class="token punctuation">.</span></span><span class="token class-name">Duration</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>time<span class="token punctuation">.</span>temporal<span class="token punctuation">.</span></span><span class="token class-name">ChronoUnit</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Test0429</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">RedisURI</span> redisUri <span class="token operator">=</span> <span class="token class-name">RedisURI</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">withHost</span><span class="token punctuation">(</span><span class="token string">"localhost"</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">withDatabase</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">withPort</span><span class="token punctuation">(</span><span class="token number">6379</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">withTimeout</span><span class="token punctuation">(</span><span class="token class-name">Duration</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token class-name">ChronoUnit</span><span class="token punctuation">.</span>SECONDS<span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">RedisClient</span> redisClient <span class="token operator">=</span> <span class="token class-name">RedisClient</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>redisUri<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">StatefulRedisConnection</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> conn <span class="token operator">=</span> redisClient<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">RedisCommands</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> command <span class="token operator">=</span> conn<span class="token punctuation">.</span><span class="token function">sync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        command<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">"mykey1"</span><span class="token punctuation">,</span> <span class="token string">"500"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        conn<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        redisClient<span class="token punctuation">.</span><span class="token function">shutdown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     运行程序，OK，测试成功！
    </p>
    <p>
     查看
     <code>
      External Libraries
     </code>
     ，如下：
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/6ebc88ca7115bfec1efcf249dc3dd78b.png"/>
    </p>
    <p>
     注：如果要使用连接池，则需要
     <code>
      commons-pool2
     </code>
     。在
     <code>
      pom.xml
     </code>
     文件中添加如下依赖：
    </p>
    <pre><code class="prism language-xml">        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.apache.commons<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>commons-pool2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.11.1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre>
    <h3>
     <a id="3SpringBoot_317">
     </a>
     方法3：SpringBoot
    </h3>
    <p>
     打开
     <a href="https://start.spring.io/" rel="nofollow">
      https://start.spring.io/
     </a>
     ，搜索
     <code>
      redis
     </code>
     ，添加依赖
     <code>
      Spring Data Redis (Access+Driver)
     </code>
     ，如下图所示：
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/94f681c6509c7c4880cf68c9ce0ea4c6.png"/>
     <br/>
     创建项目
     <code>
      test0429_3
     </code>
     ，下载
     <code>
      test0429_3.zip
     </code>
     文件，解压生成项目，并打开。
    </p>
    <p>
     打开
     <code>
      pom.xml
     </code>
     文件，可见相关的依赖为：
    </p>
    <pre><code class="prism language-xml">		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-data-redis<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre>
    <p>
     打开
     <code>
      application.properties
     </code>
     文件，添加Redis的配置信息：
    </p>
    <pre><code class="prism language-powershell">spring<span class="token punctuation">.</span>redis<span class="token punctuation">.</span>host=localhost
spring<span class="token punctuation">.</span>redis<span class="token punctuation">.</span>port=6379
</code></pre>
    <p>
     本例只配置了
     <code>
      host
     </code>
     和
     <code>
      port
     </code>
     ，若有其它信息，也可在此配置。
    </p>
    <p>
     打开
     <code>
      Test04293ApplicationTests.java
     </code>
     文件，添加依赖注入的
     <code>
      StringRedisTemplate
     </code>
     ，然后添加一个自定义Test，最终代码如下：
    </p>
    <pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>test0429_3</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>junit<span class="token punctuation">.</span>jupiter<span class="token punctuation">.</span>api<span class="token punctuation">.</span></span><span class="token class-name">Test</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Autowired</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>test<span class="token punctuation">.</span>context<span class="token punctuation">.</span></span><span class="token class-name">SpringBootTest</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>redis<span class="token punctuation">.</span>core<span class="token punctuation">.</span></span><span class="token class-name">StringRedisTemplate</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@SpringBootTest</span>
<span class="token keyword">class</span> <span class="token class-name">Test04293ApplicationTests</span> <span class="token punctuation">{<!-- --></span>

	<span class="token annotation punctuation">@Autowired</span>
	<span class="token class-name">StringRedisTemplate</span> redisTemplate<span class="token punctuation">;</span>

	<span class="token annotation punctuation">@Test</span>
	<span class="token keyword">void</span> <span class="token function">contextLoads</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token punctuation">}</span>

	<span class="token annotation punctuation">@Test</span>
	<span class="token keyword">void</span> <span class="token function">myTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		redisTemplate<span class="token punctuation">.</span><span class="token function">opsForValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">"mykey1"</span><span class="token punctuation">,</span> <span class="token string">"500"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre>
    <p>
     运行
     <code>
      myTest
     </code>
     ，OK，测试成功！
    </p>
    <p>
     注：这里使用的是
     <code>
      StringRedisTemplate
     </code>
     而不是
     <code>
      RedisTemplate
     </code>
     。如果是后者，运行也OK，但是从
     <code>
      redis-cli
     </code>
     命令行检查，key和value都是一些奇怪的编码，这是因为
     <code>
      RedisTemplate
     </code>
     默认采用的是JDK的序列化策略。
    </p>
    <p>
     最终项目结构如下：
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/2cdf158579b62311410a518e95d964e5.png"/>
    </p>
    <h2>
     <a id="_377">
     </a>
     参考
    </h2>
    <ul>
     <li>
      <a href="https://redis.io/" rel="nofollow">
       https://redis.io/
      </a>
     </li>
     <li>
      <a href="https://github.com/redis/jedis">
       https://github.com/redis/jedis
      </a>
     </li>
     <li>
      <a href="https://mvnrepository.com/" rel="nofollow">
       https://mvnrepository.com/
      </a>
     </li>
     <li>
      <a href="https://search.maven.org/" rel="nofollow">
       https://search.maven.org/
      </a>
     </li>
     <li>
      <a href="https://lettuce.io/" rel="nofollow">
       https://lettuce.io/
      </a>
     </li>
     <li>
      <a href="https://github.com/lettuce-io/">
       https://github.com/lettuce-io/
      </a>
     </li>
     <li>
      <a href="http://www.bjpowernode.com/tutorial_redis/342.html" rel="nofollow">
       http://www.bjpowernode.com/tutorial_redis/342.html
      </a>
     </li>
    </ul>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f:626c6f672e6373646e2e6e65742f64756b655f64696e67322f:61727469636c652f64657461696c732f313234343432363131" class_="artid" style="display:none">
 </p>
</div>


