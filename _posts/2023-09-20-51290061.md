---
layout: post
title: "Java通过管道进行进程间通信"
date: 2023-09-20 19:06:50 +0800
description: "Java语言中提供了各种各样的输入输出流Stream，使我们能够很方便地对数据进行操作，其中管道流（"
keywords: "java进程间 管道同行"
categories: ['Java']
tags: ['无标签']
artid: "51290061"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=51290061
    alt: "Java通过管道进行进程间通信"
render_with_liquid: false
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     Java通过管道进行进程间通信
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
     Java语言中提供了各种各样的输入输出流Stream，使我们能够很方便地对数据进行操作，其中管道流（pipeStream）是一种特殊的流，用于在不同线程间之间传送数据。一个线程发送数据到输出管道，另一个线程从输入管道中读数据。通过使用管道，实现不同线程间的通信，而无须借助类似于临时文件之类的东西。
    </p>
    <p>
     在Java的JDK中提供了4个类来使线程间可以相互通信：
     <br/>
     1）PipedInputSteam和PipedOutputStream
     <br/>
     2）PipedReader和PipedWriter
    </p>
    <p>
     PipedReader和PipedWriter在管道间传送字符流，下面以其为例说明使用。
    </p>
    <p>
     ThreadWrite类，发送数据的线程。
    </p>
    <pre class="prettyprint"><code class="hljs java"><span class="hljs-keyword">import</span> java.io.IOException;
<span class="hljs-keyword">import</span> java.io.PipedWriter;

<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ThreadWrite</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Thread</span>{<!-- --></span>
    <span class="hljs-keyword">private</span> PipedWriter out;

    <span class="hljs-keyword">public</span> <span class="hljs-title">ThreadWrite</span>(PipedWriter out){
        <span class="hljs-keyword">super</span>();
        <span class="hljs-keyword">this</span>.out = out;
    }
    <span class="hljs-annotation">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">run</span>(){
        <span class="hljs-keyword">try</span>{
            System.out.println(<span class="hljs-string">"write:"</span>);
            <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">300</span>;i++){
                String outData = <span class="hljs-string">""</span>+(i+<span class="hljs-number">1</span>);
                out.write(outData);
                System.out.print(outData);
            }
            System.out.println();
            out.close();
        }<span class="hljs-keyword">catch</span> (IOException e){
            e.printStackTrace();
        }
    }
}
</code></pre>
    <p>
     ThreadRead类，读取数据的线程。
    </p>
    <pre class="prettyprint"><code class="hljs java"><span class="hljs-keyword">import</span> java.io.IOException;
<span class="hljs-keyword">import</span> java.io.PipedReader;

<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ThreadRead</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Thread</span>{<!-- --></span>
    <span class="hljs-keyword">private</span> PipedReader input;

    <span class="hljs-keyword">public</span> <span class="hljs-title">ThreadRead</span>(PipedReader input){
        <span class="hljs-keyword">super</span>();
        <span class="hljs-keyword">this</span>.input = input;
    }

    <span class="hljs-annotation">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">run</span>(){

        <span class="hljs-keyword">try</span>{
            System.out.println(<span class="hljs-string">"read:"</span>);
            <span class="hljs-keyword">char</span>[] byteArray = <span class="hljs-keyword">new</span> <span class="hljs-keyword">char</span>[<span class="hljs-number">100</span>];
            <span class="hljs-keyword">int</span> readLength = input.read(byteArray);
            <span class="hljs-keyword">while</span> (readLength!=-<span class="hljs-number">1</span>){
                String newData = <span class="hljs-keyword">new</span> String(byteArray,<span class="hljs-number">0</span>,readLength);
                System.out.print(newData);
                readLength = input.read(byteArray);
            }
            System.out.println();
            input.close();

        }<span class="hljs-keyword">catch</span> (IOException e){
            e.printStackTrace();
        }
    }
}
</code></pre>
    <p>
     测试类：
    </p>
    <pre class="prettyprint"><code class="hljs java"><span class="hljs-keyword">import</span> java.io.PipedReader;
<span class="hljs-keyword">import</span> java.io.PipedWriter;

<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RunTest</span> {<!-- --></span>

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span>(String[] args){
        <span class="hljs-keyword">try</span>{

            PipedReader pipedReader = <span class="hljs-keyword">new</span> PipedReader();
            PipedWriter pipedWriter = <span class="hljs-keyword">new</span> PipedWriter();

            <span class="hljs-comment">//inputStream.connect(outputStream);</span>
            pipedWriter.connect(pipedReader);   <span class="hljs-comment">//将pipedWriter和pipeRead通过connect相连</span>

            ThreadRead threadRead = <span class="hljs-keyword">new</span> ThreadRead(pipedReader);    <span class="hljs-comment">//启动读线程</span>
            threadRead.start();

            Thread.sleep(<span class="hljs-number">2000</span>);

            ThreadWrite threadWrite = <span class="hljs-keyword">new</span> ThreadWrite(pipedWriter);  <span class="hljs-comment">//启动写线程</span>
            threadWrite.start();

        }<span class="hljs-keyword">catch</span> (IOException e){
            e.printStackTrace();
        } <span class="hljs-keyword">catch</span> (InterruptedException e) {
            e.printStackTrace();
        }
    }

}
</code></pre>
    <p>
     程序输入如下所示：
     <br/>
     <img alt="这里写图片描述" src="https://img-blog.csdn.net/20160501122811391" title=""/>
    </p>
    <p>
     参考《Java多线程编程核心技术》
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a:2f2f626c6f672e6373646e2e6e65742f785f695f795f755f65:2f61727469636c652f64657461696c732f3531323930303631" class_="artid" style="display:none">
 </p>
</div>


