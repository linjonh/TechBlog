---
layout: post
title: "springboot项目要如何获取当前服务器的IP以及当前项目使用的端口号Port"
date: 2022-01-05 22:20:08 +0800
description: "文章目录1. 如何获取当前服务使用的IP2. 获取启动使用的端口号1. @Value、@Config"
keywords: "springboot获取服务器ip和端口号"
categories: ['小知识']
tags: ['Springboot', 'Port', 'Java', 'Ip']
artid: "122331258"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=122331258
    alt: "springboot项目要如何获取当前服务器的IP以及当前项目使用的端口号Port"
render_with_liquid: false
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     springboot项目要如何获取当前服务器的IP以及当前项目使用的端口号Port
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-light" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
    </p>
    <div class="toc">
     <h4>
      文章目录
     </h4>
     <ul>
      <li>
       <a href="#1_IP_1" rel="nofollow">
        1. 如何获取当前服务使用的IP
       </a>
      </li>
      <li>
       <a href="#2__17" rel="nofollow">
        2. 获取启动使用的端口号
       </a>
      </li>
      <li>
       <ul>
        <li>
         <a href="#1_ValueConfigurationProperties__18" rel="nofollow">
          1. @Value、@ConfigurationProperties等方法 从配置文件中获取
         </a>
        </li>
        <li>
         <a href="#2_serverport_58" rel="nofollow">
          2. 提问：如果上面配置文件中不配server.port值会发生什么？
         </a>
        </li>
        <li>
         <a href="#3_springServerProperties_78" rel="nofollow">
          3. 使用spring带的ServerProperties类
         </a>
        </li>
        <li>
         <a href="#4_ServletWebServerApplicationContext_106" rel="nofollow">
          4. 使用ServletWebServerApplicationContext类(可推荐)
         </a>
        </li>
       </ul>
      </li>
     </ul>
    </div>
    <p>
    </p>
    <h2>
     <a id="1_IP_1">
     </a>
     1. 如何获取当前服务使用的IP
    </h2>
    <ol>
     <li>
      <p>
       使用InetAddress类即可，直接看例子：
      </p>
      <pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> test <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span><span class="token punctuation">{<!-- --></span>
        <span class="token class-name">InetAddress</span> localHost <span class="token operator">=</span> <span class="token class-name">InetAddress</span><span class="token punctuation">.</span><span class="token function">getLocalHost</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"localhost: "</span> <span class="token operator">+</span> localHost<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"getHostAddress:  "</span> <span class="token operator">+</span> localHost<span class="token punctuation">.</span><span class="token function">getHostAddress</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"getHostName:  "</span> <span class="token operator">+</span> localHost<span class="token punctuation">.</span><span class="token function">getHostName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre>
      <p>
       <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/687282ef336852e9f1514d4cf01d31ba.png"/>
      </p>
     </li>
    </ol>
    <h2>
     <a id="2__17">
     </a>
     2. 获取启动使用的端口号
    </h2>
    <h3>
     <a id="1_ValueConfigurationProperties__18">
     </a>
     1. @Value、@ConfigurationProperties等方法 从配置文件中获取
    </h3>
    <ol>
     <li>
      <p>
       在配置文件中配置server.port的值，之后通过@Value、@ConfigurationProperties 等方法从配置文件中获取
      </p>
      <pre><code class="prism language-yml"><span class="token key atrule">server</span><span class="token punctuation">:</span>
  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">8085</span>
</code></pre>
     </li>
     <li>
      <p>
       测试代码：
      </p>
      <pre><code class="prism language-java"><span class="token comment">// 配置类 注入port的值</span>
<span class="token annotation punctuation">@Configuration</span>
<span class="token annotation punctuation">@ConfigurationProperties</span><span class="token punctuation">(</span>prefix <span class="token operator">=</span> <span class="token string">"server"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PortConfig</span> <span class="token punctuation">{<!-- --></span>
    <span class="token annotation punctuation">@Getter</span>
    <span class="token annotation punctuation">@Setter</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> port<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@RestController</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestController</span> <span class="token punctuation">{<!-- --></span>

	<span class="token comment">// 或者使用@Value方式注入</span>
    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">"${server.port}"</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> port<span class="token punctuation">;</span>

	<span class="token comment">// 依赖配置</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">PortConfig</span> portConfig<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/test"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>port<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>portConfig<span class="token punctuation">.</span><span class="token function">getPort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
      <p>
       <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/96b30246101f700415421f8ad9c32456.png"/>
      </p>
     </li>
    </ol>
    <h3>
     <a id="2_serverport_58">
     </a>
     2. 提问：如果上面配置文件中不配server.port值会发生什么？
    </h3>
    <ol>
     <li>
      <p>
       <strong>
        @Value会导致启动报错，无法启动项目：
       </strong>
       <br/>
       <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/f2522ee601c8091896a58dbdf1913e8e.png"/>
      </p>
     </li>
     <li>
      <p>
       把@Value注释，启动正常，但是**@ConfigurationProperties获取到的值是0**
       <br/>
       <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/34d1f0c6e7465b10f16e249926a04e43.png">
        我们知道springboot默认的port是8080，如果你真的很想获取到port，代码只能按照下面方式写：
       </img>
      </p>
      <pre><code class="prism language-java"><span class="token keyword">if</span><span class="token punctuation">(</span>portConfig<span class="token punctuation">.</span><span class="token function">getPort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
	port <span class="token operator">=</span> <span class="token number">8080</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
	port <span class="token operator">=</span> portConfig<span class="token punctuation">.</span><span class="token function">getPort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

或者
<span class="token keyword">int</span> port <span class="token operator">=</span> portConfig<span class="token punctuation">.</span><span class="token function">getPort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&gt;=</span><span class="token number">0</span><span class="token operator">?</span>portConfig<span class="token punctuation">.</span><span class="token function">getPort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span><span class="token number">8080</span><span class="token punctuation">;</span>
</code></pre>
      <p>
       <strong>
        这样子确实也可以获取到服务启动实际使用的port
       </strong>
       .
      </p>
     </li>
    </ol>
    <h3>
     <a id="3_springServerProperties_78">
     </a>
     3. 使用spring带的ServerProperties类
    </h3>
    <ol>
     <li>
      <p>
       经过上面第二点说明，固然大家会选择使用
       <strong>
        配置类
       </strong>
       的方式，毕竟@Value会导致项目启动不起来，而
       <strong>
        springboot有又自带专门存储server开头的配置的类ServerProperties
       </strong>
       ，都不用自己创建一个配置类了。
       <br/>
       <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/83a939bbc4ddf357f383d3def78af5d7.png"/>
      </p>
     </li>
     <li>
      <p>
       如下测试代码：
      </p>
      <pre><code class="prism language-java"><span class="token annotation punctuation">@RestController</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestController</span> <span class="token punctuation">{<!-- --></span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">ServerProperties</span> serverProperties<span class="token punctuation">;</span>
    
    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/test"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>serverProperties<span class="token punctuation">.</span><span class="token function">getPort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
      <p>
       <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/4ec3d0ef26ae1fd989db7f8354497ece.png"/>
      </p>
     </li>
     <li>
      <p>
       同理，
       <strong>
        若当配置文件中不写 server.port配置，则默认值是null
       </strong>
       <br/>
       <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/03cf60492d5196b93ee131c1f06c67e2.png"/>
      </p>
     </li>
    </ol>
    <h3>
     <a id="4_ServletWebServerApplicationContext_106">
     </a>
     4. 使用ServletWebServerApplicationContext类(可推荐)
    </h3>
    <ol>
     <li>
      <p>
       ServletWebServerApplicationContext类是web的上下文，里面有很多信息可以使用。
      </p>
     </li>
     <li>
      <p>
       若没有在yaml有配置server.port，不会获取到null 而是默认值8080(内部已帮我们处理了)
       <br/>
       <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/0d43e88db58c15a4a44f5873aec5fad5.png">
        <br/>
        <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/0bee94ce99206ed4a2916552bfe9bc5d.png"/>
       </img>
      </p>
     </li>
     <li>
      <p>
       代码：
       <br/>
       不在yaml配置 server.pot
      </p>
      <pre><code class="prism language-java"><span class="token annotation punctuation">@RestController</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ConfigController</span> <span class="token punctuation">{<!-- --></span>
    
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">ServletWebServerApplicationContext</span> servletWebServerApplicationContext<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/testPort"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testPort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>servletWebServerApplicationContext<span class="token punctuation">.</span><span class="token function">getWebServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getPort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
      <p>
       <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/e9571282b91b31fb6bfa8e66f814a6bd.png"/>
      </p>
     </li>
    </ol>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a:2f2f626c6f672e6373646e2e6e65742f78756579696a696e2f:61727469636c652f64657461696c732f313232333331323538" class_="artid" style="display:none">
 </p>
</div>


