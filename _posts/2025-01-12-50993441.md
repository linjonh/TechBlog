---
layout: post
title: "Java中常见内存泄露和内存溢出错误总结"
date: 2025-01-12 15:11:49 +0800
description: "首先要弄明白两个概念：内存泄露和内存溢出。    内存泄露是指垃圾没有被完全回收，就是有空间但是要不"
keywords: "内存泄露报什么错"
categories: ['未分类']
tags: ['无标签']
artid: "50993441"
image:
  path: https://api.vvhan.com/api/bing?rand=sj&artid=50993441
  alt: "Java中常见内存泄露和内存溢出错误总结"
render_with_liquid: false
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     Java中常见内存泄露和内存溢出错误总结
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <p>
     <span style="font-size:18px">
      首先要弄明白两个概念：内存泄露和内存溢出。
     </span>
    </p>
    <p>
     <span style="font-size:18px">
      内存泄露是指垃圾没有被完全回收，就是有空间但是要不回来；
     </span>
    </p>
    <p>
     <span style="font-size:18px">
      内存溢出则是空间根本不够用。
     </span>
    </p>
    <p>
     <span style="font-size:18px">
      两者虽然不同但是可能导致相同的后果。
     </span>
    </p>
    <p>
     <span style="font-size:18px">
      1、
      <span style="font-family:Helvetica,Tahoma,Arial,sans-serif; line-height:25.2px">
       java.lang.OutOfMemoryError: Java heap space
      </span>
     </span>
    </p>
    <p>
     <span style="font-family:Helvetica,Tahoma,Arial,sans-serif; line-height:25.2px">
      <span style="font-family:Helvetica,Tahoma,Arial,sans-serif; line-height:25.2px">
       <span style="font-size:18px">
        这是最典型的内存泄漏方式，简单说就是所有堆空间都被无法回收的垃圾对象占满，虚拟机无法再在分配新空间。
       </span>
      </span>
     </span>
    </p>
    <p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Helvetica,Tahoma,Arial,sans-serif; line-height:25.2px">
     <span style="font-size:18px">
      这种方式解决一般是根据垃圾回收前后情况对比，同时根据对象引用情况（常见的集合对象引用）分析，基本都可以找到泄漏点。
     </span>
    </p>
    <p>
     <span style="font-family:Helvetica,Tahoma,Arial,sans-serif; line-height:25.2px">
      <span style="font-family:Helvetica,Tahoma,Arial,sans-serif; line-height:25.2px">
       <span style="font-size:18px">
        2、
        <span style="font-family:Helvetica,Tahoma,Arial,sans-serif; line-height:25.2px">
         java.lang.OutOfMemoryError: PermGen space
        </span>
       </span>
      </span>
     </span>
    </p>
    <p>
     <span style="font-family:Helvetica,Tahoma,Arial,sans-serif; line-height:25.2px">
      <span style="font-family:Helvetica,Tahoma,Arial,sans-serif; line-height:25.2px">
       <span style="font-family:Helvetica,Tahoma,Arial,sans-serif; line-height:25.2px">
        <span style="font-family:Helvetica,Tahoma,Arial,sans-serif; line-height:25.2px">
         <span style="font-size:18px">
          Perm空间被占满。无法为新的class分配存储空间而引发的异常。这个异常以前是没有的，但是在Java反射大量使用的今天这个异常比较常见了。主要原因就是大量动态反射生成的类不断被加载，最终导致Perm区被占满。
         </span>
        </span>
       </span>
      </span>
     </span>
    </p>
    <p>
     <span style="font-family:Helvetica,Tahoma,Arial,sans-serif; line-height:25.2px">
      <span style="font-size:18px">
       如何解决：设置
       <span style="font-family:Helvetica,Tahoma,Arial,sans-serif; line-height:25.2px">
        -XX:MaxPermSize=16m，或者换用JDK
       </span>
      </span>
     </span>
    </p>
    <p>
     <span style="font-family:Helvetica,Tahoma,Arial,sans-serif; line-height:25.2px">
      <span style="font-family:Helvetica,Tahoma,Arial,sans-serif; line-height:25.2px">
       <span style="font-size:18px">
        3、
        <span style="font-family:Helvetica,Tahoma,Arial,sans-serif; line-height:25.2px">
         java.lang.StackOverflowError
        </span>
       </span>
      </span>
     </span>
    </p>
    <p>
     <span style="font-family:Helvetica,Tahoma,Arial,sans-serif; line-height:25.2px">
      <span style="font-family:Helvetica,Tahoma,Arial,sans-serif; line-height:25.2px">
       <span style="font-family:Helvetica,Tahoma,Arial,sans-serif; line-height:25.2px">
        <span style="font-size:18px">
         一般是递归没有找到出口，或者循环调用导致。
        </span>
       </span>
      </span>
     </span>
    </p>
    <p>
     <span style="font-family:Helvetica,Tahoma,Arial,sans-serif; line-height:25.2px">
      <span style="font-family:Helvetica,Tahoma,Arial,sans-serif; line-height:25.2px">
       <span style="font-family:Helvetica,Tahoma,Arial,sans-serif; line-height:25.2px">
        <span style="font-size:18px">
         4、
         <span style="font-family:Helvetica,Tahoma,Arial,sans-serif; line-height:25.2px">
          Fatal: Stack size too small
         </span>
        </span>
       </span>
      </span>
     </span>
    </p>
    <p>
     <span style="font-family:Helvetica,Tahoma,Arial,sans-serif; line-height:25.2px">
      <span style="font-family:Helvetica,Tahoma,Arial,sans-serif; line-height:25.2px">
       <span style="font-family:Helvetica,Tahoma,Arial,sans-serif; line-height:25.2px">
        <span style="font-family:Helvetica,Tahoma,Arial,sans-serif; line-height:25.2px">
         <span style="font-size:18px">
          <span style="font-family:Helvetica,Tahoma,Arial,sans-serif; line-height:25.2px">
           线程栈空间不够用，可以通过修改线程栈大小的方式来解决，比如设置-Xss2m。但这个配置无法解决根本问题，还要看代码部分是否有造成泄漏的部分。
          </span>
          <br/>
         </span>
        </span>
       </span>
      </span>
     </span>
    </p>
    <p>
     <span style="font-family:Helvetica,Tahoma,Arial,sans-serif; line-height:25.2px">
      <span style="font-family:Helvetica,Tahoma,Arial,sans-serif; line-height:25.2px">
       <span style="font-family:Helvetica,Tahoma,Arial,sans-serif; line-height:25.2px">
        <span style="font-family:Helvetica,Tahoma,Arial,sans-serif; line-height:25.2px">
         <span style="font-family:Helvetica,Tahoma,Arial,sans-serif; line-height:25.2px">
          <span style="font-size:18px">
           5、
           <span style="font-family:Helvetica,Tahoma,Arial,sans-serif; line-height:25.2px">
            java.lang.OutOfMemoryError: unable to create new native thread
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
    </p>
    <p>
     <span style="font-family:Helvetica,Tahoma,Arial,sans-serif; line-height:25.2px">
      <span style="font-family:Helvetica,Tahoma,Arial,sans-serif; line-height:25.2px">
       <span style="font-family:Helvetica,Tahoma,Arial,sans-serif; line-height:25.2px">
        <span style="font-family:Helvetica,Tahoma,Arial,sans-serif; line-height:25.2px">
         <span style="font-family:Helvetica,Tahoma,Arial,sans-serif; line-height:25.2px">
          <span style="font-family:Helvetica,Tahoma,Arial,sans-serif; line-height:25.2px">
           <span style="font-size:18px">
            <span style="font-family:Helvetica,Tahoma,Arial,sans-serif; line-height:25.2px">
             这个异常是由于操作系统没有足够的资源来产生这个线程造成的。
            </span>
            <br/>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
    </p>
    <p>
     <span style="font-family:Helvetica,Tahoma,Arial,sans-serif; line-height:25.2px">
      <span style="font-family:Helvetica,Tahoma,Arial,sans-serif; line-height:25.2px">
       <span style="font-family:Helvetica,Tahoma,Arial,sans-serif; line-height:25.2px">
        <span style="font-family:Helvetica,Tahoma,Arial,sans-serif; line-height:25.2px">
         <span style="font-family:Helvetica,Tahoma,Arial,sans-serif; line-height:25.2px">
          <span style="font-family:Helvetica,Tahoma,Arial,sans-serif; line-height:25.2px">
           <span style="font-family:Helvetica,Tahoma,Arial,sans-serif; line-height:25.2px">
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
    </p>
    <p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-family:Helvetica,Tahoma,Arial,sans-serif; line-height:25.2px">
     <span style="font-size:18px">
      解决方式：重新设计系统减少线程数量；
      <span style="line-height:25.2px">
       线程数量不能减少的情况下，通过-Xss减小单个线程大小。以便能生产更多的线程。
      </span>
     </span>
    </p>
    <br/>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f:2f626c6f672e6373646e2e6e65742f68773230303730353735:2f61727469636c652f64657461696c732f3530393933343431" class_="artid" style="display:none">
 </p>
</div>
