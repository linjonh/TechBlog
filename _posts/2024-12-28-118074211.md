---
layout: post
title: "STC8G2K64S4的硬件PWM波实现-P0.5"
date: 2024-12-28 20:10:15 +0800
description: "STC8G2K64S4的硬件PWM波实现 P0.5STC8G2K64S4的硬件PWM共分6组，每组共"
keywords: "stc8g2k64s4pca"
categories: ['Stc']
tags: ['无标签']
artid: "118074211"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=118074211
    alt: "STC8G2K64S4的硬件PWM波实现-P0.5"
render_with_liquid: false
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     STC8G2K64S4的硬件PWM波实现 P0.5
    </h1>
   </div>
   <div class="ai-article-tag" id="ai-article-tag">
    <div class="ai-article-tag-box">
     <p class="ai-article-tag-item-active">
      <img alt="" class="item-target" src="https://img-home.csdnimg.cn/images/20240715101418.png"/>
     </p>
     <a class="ai-article-tag-item" data-report-click='{"spm":"3001.10231","extra":{"searchword":"STC8G2K64S4"}}' data-report-query="spm=1001.2101.3001.10231" data-report-view='{"spm":"3001.10231","extra":{"searchword":"STC8G2K64S4"}}' href="https://so.csdn.net/so/search/s.do?q=STC8G2K64S4&amp;t=all&amp;o=vip&amp;s=&amp;l=&amp;f=&amp;viparticle=&amp;from_tracking_code=tag_word&amp;from_code=app_blog_art" target="_blank">
      <span>
       STC8G2K64S4
      </span>
     </a>
     <a class="ai-article-tag-item" data-report-click='{"spm":"3001.10231","extra":{"searchword":"PWM"}}' data-report-query="spm=1001.2101.3001.10231" data-report-view='{"spm":"3001.10231","extra":{"searchword":"PWM"}}' href="https://so.csdn.net/so/search/s.do?q=PWM&amp;t=all&amp;o=vip&amp;s=&amp;l=&amp;f=&amp;viparticle=&amp;from_tracking_code=tag_word&amp;from_code=app_blog_art" target="_blank">
      <span>
       PWM
      </span>
     </a>
     <a class="ai-article-tag-item" data-report-click='{"spm":"3001.10231","extra":{"searchword":"单片机"}}' data-report-query="spm=1001.2101.3001.10231" data-report-view='{"spm":"3001.10231","extra":{"searchword":"单片机"}}' href="https://so.csdn.net/so/search/s.do?q=%E5%8D%95%E7%89%87%E6%9C%BA&amp;t=all&amp;o=vip&amp;s=&amp;l=&amp;f=&amp;viparticle=&amp;from_tracking_code=tag_word&amp;from_code=app_blog_art" target="_blank">
      <span>
       单片机
      </span>
     </a>
     <a class="ai-article-tag-item" data-report-click='{"spm":"3001.10231","extra":{"searchword":"占空比"}}' data-report-query="spm=1001.2101.3001.10231" data-report-view='{"spm":"3001.10231","extra":{"searchword":"占空比"}}' href="https://so.csdn.net/so/search/s.do?q=%E5%8D%A0%E7%A9%BA%E6%AF%94&amp;t=all&amp;o=vip&amp;s=&amp;l=&amp;f=&amp;viparticle=&amp;from_tracking_code=tag_word&amp;from_code=app_blog_art" target="_blank">
      <span>
       占空比
      </span>
     </a>
     <a class="ai-article-tag-item" data-report-click='{"spm":"3001.10231","extra":{"searchword":"硬件定时器"}}' data-report-query="spm=1001.2101.3001.10231" data-report-view='{"spm":"3001.10231","extra":{"searchword":"硬件定时器"}}' href="https://so.csdn.net/so/search/s.do?q=%E7%A1%AC%E4%BB%B6%E5%AE%9A%E6%97%B6%E5%99%A8&amp;t=all&amp;o=vip&amp;s=&amp;l=&amp;f=&amp;viparticle=&amp;from_tracking_code=tag_word&amp;from_code=app_blog_art" target="_blank">
      <span>
       硬件定时器
      </span>
     </a>
    </div>
    <span class="ai-article-tag-text">
     关键词由CSDN通过智能技术生成
    </span>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
     STC8G2K64S4的硬件PWM波实现 P0.5 工作笔记。
    </p>
    <p>
     STC8G2K64S4的硬件PWM共分6组，每组共7路PWM输出，这里采用0组，P0.5输出PWM方波输出。
    </p>
    <pre><code class="prism language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"reg51.h"</span> </span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"intrins.h"</span> </span>
sfr P_SW2 <span class="token operator">=</span> <span class="token number">0xba</span><span class="token punctuation">;</span> 
sfr PWMSET <span class="token operator">=</span> <span class="token number">0xF1</span><span class="token punctuation">;</span> 
sfr PWMCFG01 <span class="token operator">=</span> <span class="token number">0xF6</span><span class="token punctuation">;</span> 
sfr PWMCFG23 <span class="token operator">=</span> <span class="token number">0xF7</span><span class="token punctuation">;</span> 
sfr PWMCFG45 <span class="token operator">=</span> <span class="token number">0xFE</span><span class="token punctuation">;</span> 
<span class="token macro property">#<span class="token directive keyword">define</span> PWM0C (*(unsigned int volatile xdata *)0xFF00) </span>
<span class="token macro property">#<span class="token directive keyword">define</span> PWM0CH (*(unsigned char volatile xdata *)0xFF00) </span>
<span class="token macro property">#<span class="token directive keyword">define</span> PWM0CL (*(unsigned char volatile xdata *)0xFF01) </span>
<span class="token macro property">#<span class="token directive keyword">define</span> PWM0CKS (*(unsigned char volatile xdata *)0xFF02) </span>
<span class="token macro property">#<span class="token directive keyword">define</span> PWM0TADC (*(unsigned int volatile xdata *)0xFF03) </span>
<span class="token macro property">#<span class="token directive keyword">define</span> PWM0TADCH (*(unsigned char volatile xdata *)0xFF03) </span>

<span class="token macro property">#<span class="token directive keyword">define</span> PWM05T1 (*(unsigned int volatile xdata *)0xFF38) </span>
<span class="token macro property">#<span class="token directive keyword">define</span> PWM05T1H (*(unsigned char volatile xdata *)0xFF38) </span>
<span class="token macro property">#<span class="token directive keyword">define</span> PWM05T1L (*(unsigned char volatile xdata *)0xFF39) </span>
<span class="token macro property">#<span class="token directive keyword">define</span> PWM05T2H (*(unsigned char volatile xdata *)0xFF3A) </span>
<span class="token macro property">#<span class="token directive keyword">define</span> PWM05T2 (*(unsigned int volatile xdata *)0xFF3A) </span>
<span class="token macro property">#<span class="token directive keyword">define</span> PWM05T2L (*(unsigned char volatile xdata *)0xFF3B) </span>
<span class="token macro property">#<span class="token directive keyword">define</span> PWM05CR (*(unsigned char volatile xdata *)0xFF3C) </span>
<span class="token macro property">#<span class="token directive keyword">define</span> PWM05HLD (*(unsigned char volatile xdata *)0xFF3D) </span>
	
sfr P0M1 <span class="token operator">=</span> <span class="token number">0x93</span><span class="token punctuation">;</span> 
sfr P0M0 <span class="token operator">=</span> <span class="token number">0x94</span><span class="token punctuation">;</span> 
sfr P1M1 <span class="token operator">=</span> <span class="token number">0x91</span><span class="token punctuation">;</span> 
sfr P1M0 <span class="token operator">=</span> <span class="token number">0x92</span><span class="token punctuation">;</span> 
sfr P2M1 <span class="token operator">=</span> <span class="token number">0x95</span><span class="token punctuation">;</span> 
sfr P2M0 <span class="token operator">=</span> <span class="token number">0x96</span><span class="token punctuation">;</span> 
sfr P3M1 <span class="token operator">=</span> <span class="token number">0xb1</span><span class="token punctuation">;</span> 
sfr P3M0 <span class="token operator">=</span> <span class="token number">0xb2</span><span class="token punctuation">;</span> 
sfr P4M1 <span class="token operator">=</span> <span class="token number">0xb3</span><span class="token punctuation">;</span> 
sfr P4M0 <span class="token operator">=</span> <span class="token number">0xb4</span><span class="token punctuation">;</span> 
sfr P5M1 <span class="token operator">=</span> <span class="token number">0xc9</span><span class="token punctuation">;</span> 
sfr P5M0 <span class="token operator">=</span> <span class="token number">0xca</span><span class="token punctuation">;</span> 
<span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 
<span class="token punctuation">{<!-- --></span> 
 P0M0 <span class="token operator">=</span> <span class="token number">0x00</span><span class="token punctuation">;</span> 
 P0M1 <span class="token operator">=</span> <span class="token number">0x00</span><span class="token punctuation">;</span> 
 P1M0 <span class="token operator">=</span> <span class="token number">0x00</span><span class="token punctuation">;</span> 
 P1M1 <span class="token operator">=</span> <span class="token number">0x00</span><span class="token punctuation">;</span> 
 P2M0 <span class="token operator">=</span> <span class="token number">0x00</span><span class="token punctuation">;</span> 
 P2M1 <span class="token operator">=</span> <span class="token number">0x00</span><span class="token punctuation">;</span> 
 P3M0 <span class="token operator">=</span> <span class="token number">0x00</span><span class="token punctuation">;</span> 
 P3M1 <span class="token operator">=</span> <span class="token number">0x00</span><span class="token punctuation">;</span> 
 P4M0 <span class="token operator">=</span> <span class="token number">0x00</span><span class="token punctuation">;</span> 
 P4M1 <span class="token operator">=</span> <span class="token number">0x00</span><span class="token punctuation">;</span> 
 P5M0 <span class="token operator">=</span> <span class="token number">0x00</span><span class="token punctuation">;</span> 
 P5M1 <span class="token operator">=</span> <span class="token number">0x00</span><span class="token punctuation">;</span> 
 PWMSET <span class="token operator">=</span> <span class="token number">0x01</span><span class="token punctuation">;</span> <span class="token comment">//使能 PWM0 模块（必须先使能模块后面的设置才有效）</span>
 P_SW2 <span class="token operator">=</span> <span class="token number">0x80</span><span class="token punctuation">;</span> 
 PWM0CKS <span class="token operator">=</span> <span class="token number">0x00</span><span class="token punctuation">;</span>  <span class="token comment">//PWM0 时钟为系统时钟</span>
 PWM0C <span class="token operator">=</span> <span class="token number">0x6000</span><span class="token punctuation">;</span>  <span class="token comment">//设置 PWM0 周期为 1000H 个 PWM 时钟</span>
 PWM05T1<span class="token operator">=</span> <span class="token number">0x0000</span><span class="token punctuation">;</span> <span class="token comment">//在计数值为 00   地方 PWM00 通道输出低电平</span>
 PWM05T2<span class="token operator">=</span> <span class="token number">0x3000</span><span class="token punctuation">;</span> <span class="token comment">//在计数值为 0x300H 地方 PWM00 通道输出高电平，占空比为50%</span>
 PWM05CR<span class="token operator">=</span> <span class="token number">0x80</span><span class="token punctuation">;</span>   <span class="token comment">//使能 PWM00 输出</span>
 P_SW2 <span class="token operator">=</span> <span class="token number">0x00</span><span class="token punctuation">;</span> 
 PWMCFG01 <span class="token operator">=</span> <span class="token number">0x01</span><span class="token punctuation">;</span> <span class="token comment">//启动 PWM0 模块</span>
 <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token punctuation">}</span>

```改变PWM05T2的值可以改变占空比，需使用以下语句更改：
 <span class="token operator">*</span><span class="token operator">*</span>P_SW2 <span class="token operator">=</span> <span class="token number">0x80</span><span class="token punctuation">;</span> 
 PWM05T2<span class="token operator">=</span> <span class="token number">0x1000</span><span class="token punctuation">;</span> <span class="token comment">//占空比约为16%</span>
 P_SW2 <span class="token operator">=</span> <span class="token number">0x00</span><span class="token punctuation">;</span><span class="token operator">*</span><span class="token operator">*</span> 

</code></pre>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470:733a2f2f626c6f672e6373646e2e6e65742f636a6d7365612f:61727469636c652f64657461696c732f313138303734323131" class_="artid" style="display:none">
 </p>
</div>


