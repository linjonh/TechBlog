---
layout: post
title: "在Android-Studio中进行单元测试和UI测试"
date: 2024-12-24 16:44:53 +0800
description: "from:原文链接本篇教程翻译自Google I/O 2015中关于测试的codelab，掌握科学上"
keywords: "android studio greendao 单元测试"
categories: ["未分类"]
tags: ["无标签"]
artid: "50198963"
image:
  path: https://api.vvhan.com/api/bing?rand=sj&artid=50198963
  alt: "在Android-Studio中进行单元测试和UI测试"
render_with_liquid: false
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     在Android Studio中进行单元测试和UI测试
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <h2 class="title" style="margin:10px 0px; font-family:'lucida grande','lucida sans unicode',lucida,helvetica,'Hiragino Sans GB','Microsoft YaHei','WenQuanYi Micro Hei',sans-serif; line-height:1.5; color:rgb(85,85,85); font-size:32px; word-break:break-all">
     from:
     <a href="http://www.jianshu.com/p/03118c11c199" rel="nofollow noopener noreferrer" target="_blank">
      原文链接
     </a>
    </h2>
    <div class="show-content" style="color:rgb(47,47,47); font-size:16px; line-height:1.7; font-family:'lucida grande','lucida sans unicode',lucida,helvetica,'Hiragino Sans GB','Microsoft YaHei','WenQuanYi Micro Hei',sans-serif">
     <blockquote style="padding:10px 15px; margin:0px 0px 20px; border-left-width:4px; border-left-style:solid; border-left-color:rgb(153,153,153); word-break:break-word; font-size:15px; line-height:30px; background-color:rgb(245,245,245)">
      <p style="margin-top:0px; margin-bottom:0px; line-height:1.7; text-align:justify; word-break:break-word">
       本篇教程翻译自
       <a href="https://events.google.com/io2015/" rel="nofollow noopener noreferrer" style="color:rgb(64,148,199); text-decoration:none" target="_blank">
        Google I/O 2015
       </a>
       中关于测试的codelab，掌握科学上网的同学请点击这里阅读：
       <a href="https://io2015codelabs.appspot.com/codelabs/android-studio-testing#1" rel="nofollow noopener noreferrer" style="color:rgb(64,148,199); text-decoration:none" target="_blank">
        Unit and UI Testing in Android Studio
       </a>
       。能力有限，如有翻译错误，请批评指正。如需转载，请注明出处。
       <br/>
       <a href="https://github.com/dongdaqing/TestingExample" rel="noopener noreferrer" style="color:rgb(64,148,199); text-decoration:none" target="_blank">
        Github下载测试源码
       </a>
      </p>
     </blockquote>
     <h3 style="margin:0px; font-family:inherit; line-height:1.8; color:inherit; font-size:24px">
      <strong>
       目录
      </strong>
     </h3>
     <blockquote style="padding:10px 15px; margin:0px 0px 20px; border-left-width:4px; border-left-style:solid; border-left-color:rgb(153,153,153); word-break:break-word; font-size:15px; line-height:30px; background-color:rgb(245,245,245)">
      <ul style="padding:0px; margin:0px 0px 20px 25px; text-align:justify; word-break:break-word">
       <li>
        <a href="http://www.jianshu.com/p/de17655125f5" rel="nofollow noopener noreferrer" style="color:rgb(64,148,199); text-decoration:none" target="_blank">
         在Android Studio中进行单元测试和UI测试 - 1.概述
        </a>
       </li>
       <li>
        <a href="http://www.jianshu.com/p/e02176b5321b" rel="nofollow noopener noreferrer" style="color:rgb(64,148,199); text-decoration:none" target="_blank">
         在Android Studio中进行单元测试和UI测试 - 2.创建新的Android Studio工程
        </a>
       </li>
       <li>
        <a href="http://www.jianshu.com/p/860ac28b7d31" rel="nofollow noopener noreferrer" style="color:rgb(64,148,199); text-decoration:none" target="_blank">
         在Android Studio中进行单元测试和UI测试 - 3.配置支持单元测试的工程
        </a>
       </li>
       <li>
        <a href="http://www.jianshu.com/p/3685a601b388" rel="nofollow noopener noreferrer" style="color:rgb(64,148,199); text-decoration:none" target="_blank">
         在Android Studio中进行单元测试和UI测试 - 4.创建第一个单元测试
        </a>
       </li>
       <li>
        <a href="http://www.jianshu.com/p/18833d950bc9" rel="nofollow noopener noreferrer" style="color:rgb(64,148,199); text-decoration:none" target="_blank">
         在Android Studio中进行单元测试和UI测试 - 5.运行单元测试
        </a>
       </li>
       <li>
        <a href="http://www.jianshu.com/p/dbc81b1fec05" rel="nofollow noopener noreferrer" style="color:rgb(64,148,199); text-decoration:none" target="_blank">
         在Android Studio中进行单元测试和UI测试 - 6.配置支持Instrumentation测试的工程
        </a>
       </li>
       <li>
        <a href="http://www.jianshu.com/p/6002d7965f07" rel="nofollow noopener noreferrer" style="color:rgb(64,148,199); text-decoration:none" target="_blank">
         在Android Studio中进行单元测试和UI测试 - 7.为app添加简单的交互
        </a>
       </li>
       <li>
        <a href="http://www.jianshu.com/p/e6acb7b34e14" rel="nofollow noopener noreferrer" style="color:rgb(64,148,199); text-decoration:none" target="_blank">
         在Android Studio中进行单元测试和UI测试 - 8.创建并运行Espresso测试
        </a>
       </li>
       <li>
        <a href="http://www.jianshu.com/p/7476c0f0c400" rel="nofollow noopener noreferrer" style="color:rgb(64,148,199); text-decoration:none" target="_blank">
         在Android Studio中进行单元测试和UI测试 - 9.祝贺！
        </a>
       </li>
      </ul>
     </blockquote>
     <hr style="margin:0px 0px 20px; border-right-width:0px; border-left-width:0px; border-top-style:solid; border-top-color:rgb(217,217,217); border-bottom-style:solid; border-bottom-color:white"/>
     <h3 style="margin:0px; font-family:inherit; line-height:1.8; color:inherit; font-size:24px">
      1.概述
     </h3>
     <p style="margin-top:0px; margin-bottom:25px; text-align:justify; word-break:break-word">
      在这个codelab中，你将学习如何在Android Studio中配置工程用于测试，在开发机器上编写并运行单元测试，以及如何在手机上做功能UI测试。
     </p>
     <p style="margin-top:0px; margin-bottom:25px; text-align:justify; word-break:break-word">
      <strong>
       你会学到什么
      </strong>
     </p>
     <ul style="padding:0px; margin:0px 0px 20px 25px; text-align:justify; word-break:break-word">
      <li style="line-height:30px">
       更新包含JUnit和Android Testing Support Library的Gradle构建文件
      </li>
      <li style="line-height:30px">
       编写运行在本机Java虚拟机上的单元测试
      </li>
      <li style="line-height:30px">
       编写运行在手机或者虚拟机上的Espresso测试
      </li>
     </ul>
     <p style="margin-top:0px; margin-bottom:25px; text-align:justify; word-break:break-word">
      <strong>
       你需要什么
      </strong>
     </p>
     <ul style="padding:0px; margin:0px 0px 20px 25px; text-align:justify; word-break:break-word">
      <li style="line-height:30px">
       <a href="https://developer.android.com/sdk/installing/studio.html" rel="nofollow noopener noreferrer" style="color:rgb(64,148,199); text-decoration:none" target="_blank">
        Android Studio
       </a>
       v1.2+
      </li>
      <li style="line-height:30px">
       Android 4.0+的测试设备
      </li>
     </ul>
     <hr style="margin:0px 0px 20px; border-right-width:0px; border-left-width:0px; border-top-style:solid; border-top-color:rgb(217,217,217); border-bottom-style:solid; border-bottom-color:white"/>
     <h3 style="margin:0px; font-family:inherit; line-height:1.8; color:inherit; font-size:24px">
      2.创建新的Android Studio工程
     </h3>
     <p style="margin-top:0px; margin-bottom:25px; text-align:justify; word-break:break-word">
      如果是第一次启动Android Studio，从欢迎页选择“
      <strong>
       Start a new Android Studio project
      </strong>
      ”。如果已经打开了一个工程，选择
      <strong>
       File&gt;New&gt;New Project...
      </strong>
     </p>
     <p style="margin-top:0px; margin-bottom:25px; text-align:justify; word-break:break-word">
      “
      <em>
       Create new project
      </em>
      ”向导会指导整个过程，在第一页输入如下内容：
     </p>
     <table style="max-width:100%; border-collapse:collapse; border-spacing:0px; width:619px; margin-bottom:20px; border-top-width:1px; border-right-width:1px; border-bottom-width:1px; border-style:solid solid solid none; border-top-color:rgb(221,221,221); border-right-color:rgb(221,221,221); border-bottom-color:rgb(221,221,221); background-color:transparent">
      <thead>
       <tr>
        <th style="padding:8px; border-left-width:1px; border-left-style:solid; border-left-color:rgb(221,221,221); border-top-width:1px; border-top-style:solid; border-top-color:rgb(221,221,221); line-height:20px; vertical-align:bottom">
         Setting
        </th>
        <th style="padding:8px; border-left-width:1px; border-left-style:solid; border-left-color:rgb(221,221,221); border-top-width:1px; border-top-style:solid; border-top-color:rgb(221,221,221); line-height:20px; vertical-align:bottom">
         Value
        </th>
       </tr>
      </thead>
      <tbody>
       <tr>
        <td style="padding:8px; border-left-width:1px; border-left-style:solid; border-left-color:rgb(221,221,221); border-top-width:1px; border-top-style:solid; border-top-color:rgb(221,221,221); line-height:20px; vertical-align:top">
         <strong>
          Application Name
         </strong>
        </td>
        <td style="padding:8px; border-left-width:1px; border-left-style:solid; border-left-color:rgb(221,221,221); border-top-width:1px; border-top-style:solid; border-top-color:rgb(221,221,221); line-height:20px; vertical-align:top">
         TestingExample
        </td>
       </tr>
       <tr>
        <td style="padding:8px; border-left-width:1px; border-left-style:solid; border-left-color:rgb(221,221,221); border-top-width:1px; border-top-style:solid; border-top-color:rgb(221,221,221); line-height:20px; vertical-align:top">
         <strong>
          Company demain
         </strong>
        </td>
        <td style="padding:8px; border-left-width:1px; border-left-style:solid; border-left-color:rgb(221,221,221); border-top-width:1px; border-top-style:solid; border-top-color:rgb(221,221,221); line-height:20px; vertical-align:top">
         testing.example.com
        </td>
       </tr>
      </tbody>
     </table>
     <p style="margin-top:0px; margin-bottom:25px; text-align:justify; word-break:break-word">
      这样会保证你的代码同codelab讲解的内容具有一致的命名。其他的选项都设置为默认，一路点击
      <strong>
       Next
      </strong>
      直到工程创建完毕。
     </p>
     <p style="margin-top:0px; margin-bottom:25px; text-align:justify; word-break:break-word">
      点击
      <strong>
       Run
      </strong>
      按钮检查app是否运行正常，要么从模拟器列表中选择一个启动，要么确认开启了debug模式的设备通过USB同电脑正确连接。
     </p>
     <p style="margin-top:0px; margin-bottom:25px; text-align:justify; word-break:break-word">
      app目前没有做任何事情，但是屏幕上应该显示“Hello world!”和app的名字。
     </p>
     <div class="image-package imagebubble" style="margin:0px auto 20px; text-align:center">
      <img alt="" class="imagebubble-image" src="https://i-blog.csdnimg.cn/blog_migrate/ad96c7c2c62b6ff206fa4dd4be5651fa.webp?x-image-process=image/format,png" style="max-width:100%; height:auto; vertical-align:middle; border:0px">
       <br/>
      </img>
     </div>
     <p style="margin-top:0px; margin-bottom:25px; text-align:justify; word-break:break-word">
      <strong>
       经常被问及的问题
      </strong>
     </p>
     <ul style="padding:0px; margin:0px 0px 20px 25px; text-align:justify; word-break:break-word">
      <li style="line-height:30px">
       <a href="https://developer.android.com/sdk/index.html" rel="nofollow noopener noreferrer" style="color:rgb(64,148,199); text-decoration:none" target="_blank">
        如何安装Android Studio？
       </a>
      </li>
      <li style="line-height:30px">
       <a href="http://developer.android.com/tools/device.html" rel="nofollow noopener noreferrer" style="color:rgb(64,148,199); text-decoration:none" target="_blank">
        如何开启USB调试？
       </a>
      </li>
      <li style="line-height:30px">
       <a href="http://stackoverflow.com/questions/16596877/android-studio-doesnt-see-device" rel="nofollow noopener noreferrer" style="color:rgb(64,148,199); text-decoration:none" target="_blank">
        为什么Android Studio找不到我的设备？
       </a>
      </li>
      <li style="line-height:30px">
       <a href="http://stackoverflow.com/questions/4775603/android-error-failed-to-install-apk-on-device-timeout/4786299#4786299" rel="nofollow noopener noreferrer" style="color:rgb(64,148,199); text-decoration:none" target="_blank">
        Android错误：无法将*.apk安装到设备上：超时？
       </a>
      </li>
     </ul>
     <hr style="margin:0px 0px 20px; border-right-width:0px; border-left-width:0px; border-top-style:solid; border-top-color:rgb(217,217,217); border-bottom-style:solid; border-bottom-color:white"/>
     <h3 style="margin:0px; font-family:inherit; line-height:1.8; color:inherit; font-size:24px">
      3.配置支持单元测试的工程
     </h3>
     <p style="margin-top:0px; margin-bottom:25px; text-align:justify; word-break:break-word">
      在写测试之前，让我们做下简单的检查，确保工程配置正确。
     </p>
     <p style="margin-top:0px; margin-bottom:25px; text-align:justify; word-break:break-word">
      首先，确认在
      <strong>
       Build Variants
      </strong>
      窗口内的
      <strong>
       Test Artifact
      </strong>
      中选择了"Unit Tests"。
     </p>
     <div class="image-package imagebubble" style="margin:0px auto 20px; text-align:center">
      <img alt="" class="imagebubble-image" src="https://i-blog.csdnimg.cn/blog_migrate/d5aa3879ef3db164b90ee903472fe26b.webp?x-image-process=image/format,png" style="max-width:100%; height:auto; vertical-align:middle; border:0px">
       <br/>
      </img>
     </div>
     <p style="margin-top:0px; margin-bottom:25px; text-align:justify; word-break:break-word">
      然后，在工程的
      <code style="padding:2px 4px; font-family:Menlo,Monaco,Consolas,'Courier New',monospace; font-size:12px; color:rgb(101,123,131); border:none; white-space:pre-wrap; background-color:rgb(253,246,227)">
       src
      </code>
      文件夹内创建
      <code style="padding:2px 4px; font-family:Menlo,Monaco,Consolas,'Courier New',monospace; font-size:12px; color:rgb(101,123,131); border:none; white-space:pre-wrap; background-color:rgb(253,246,227)">
       test
      </code>
      和
      <code style="padding:2px 4px; font-family:Menlo,Monaco,Consolas,'Courier New',monospace; font-size:12px; color:rgb(101,123,131); border:none; white-space:pre-wrap; background-color:rgb(253,246,227)">
       test/java
      </code>
      文件夹。需要注意的是，你不能在
      <strong>
       Android
      </strong>
      视图下进行这些操作，要么在系统的文件管理器内创建，要么在工程窗口左上方点击下拉菜单选择
      <strong>
       Project
      </strong>
      视图。最终的工程结构应该是这样的：
     </p>
     <div class="image-package imagebubble" style="margin:0px auto 20px; text-align:center">
      <img alt="" class="imagebubble-image" src="https://i-blog.csdnimg.cn/blog_migrate/6965b56a85593cfd85e616b7226d19d5.webp?x-image-process=image/format,png" style="max-width:100%; height:auto; vertical-align:middle; border:0px">
       <br/>
      </img>
     </div>
     <p style="margin-top:0px; margin-bottom:25px; text-align:justify; word-break:break-word">
      （在codelab的剩余部分，你可以返回继续使用
      <strong>
       Android
      </strong>
      工程视图）
     </p>
     <p style="margin-top:0px; margin-bottom:25px; text-align:justify; word-break:break-word">
      最后，打开工程的
      <code style="padding:2px 4px; font-family:Menlo,Monaco,Consolas,'Courier New',monospace; font-size:12px; color:rgb(101,123,131); border:none; white-space:pre-wrap; background-color:rgb(253,246,227)">
       build.gradle（Module:app）
      </code>
      文件，添加JUnit4依赖，点击
      <strong>
       Gradle sync
      </strong>
      按钮。
     </p>
     <p style="margin-top:0px; margin-bottom:25px; text-align:justify; word-break:break-word">
      <strong>
       build.gradle
      </strong>
     </p>
     <pre class="hljs bash" style="padding:9.5px; font-family:Menlo,Monaco,Consolas,'Courier New',monospace; font-size:13px; color:rgb(101,123,131); margin-top:0px; margin-bottom:20px; line-height:20px; word-break:break-all; word-wrap:normal; overflow:auto; background:rgb(253,246,227)"><code class="bash" style="padding:0px; font-family:Menlo,Monaco,Consolas,'Courier New',monospace; font-size:12px; border:none; background-color:transparent">dependencies {
    compile fileTree(dir: <span class="hljs-string" style="color:rgb(42,161,152)">'libs'</span>, include: [<span class="hljs-string" style="color:rgb(42,161,152)">'*.jar'</span>])
    compile <span class="hljs-string" style="color:rgb(42,161,152)">'com.android.support:appcompat-v7:22.1.1'</span>
    <span class="hljs-built_in" style="color:rgb(38,139,210)">test</span>Compile <span class="hljs-string" style="color:rgb(42,161,152)">'junit:junit:4.12'</span>
}</code></pre>
     <blockquote style="padding:10px 15px; margin:0px 0px 20px; border-left-width:4px; border-left-style:solid; border-left-color:rgb(153,153,153); word-break:break-word; font-size:15px; line-height:30px; background-color:rgb(245,245,245)">
      <p style="margin-top:0px; margin-bottom:0px; line-height:1.7; text-align:justify; word-break:break-word">
       当你同步Gradle配置时，可能需要联网下载JUnit依赖。
      </p>
     </blockquote>
     <hr style="margin:0px 0px 20px; border-right-width:0px; border-left-width:0px; border-top-style:solid; border-top-color:rgb(217,217,217); border-bottom-style:solid; border-bottom-color:white"/>
     <h3 style="margin:0px; font-family:inherit; line-height:1.8; color:inherit; font-size:24px">
      4.创建第一个单元测试
     </h3>
     <p style="margin-top:0px; margin-bottom:25px; text-align:justify; word-break:break-word">
      现在，万事俱备，让我们开始写第一个测试吧。首先，创建一个非常简单的被测类：Calculator类。
     </p>
     <div class="image-package imagebubble" style="margin:0px auto 20px; text-align:center">
      <img alt="" class="imagebubble-image" src="https://i-blog.csdnimg.cn/blog_migrate/be5e877ee940558121df80a6f4bdf1da.webp?x-image-process=image/format,png" style="max-width:100%; height:auto; vertical-align:middle; border:0px">
       <br/>
      </img>
     </div>
     <p style="margin-top:0px; margin-bottom:25px; text-align:justify; word-break:break-word">
      然后，向类中添加一些基本的算术运算方法，比如加法和减法。将下列代码复制到编辑器中。不用担心实际的实现，暂时让所有的方法返回0。
     </p>
     <p style="margin-top:0px; margin-bottom:25px; text-align:justify; word-break:break-word">
      <strong>
       Calculator.java
      </strong>
     </p>
     <pre><code class="language-cpp"><code class="cpp" style="padding:0px; font-family:Menlo,Monaco,Consolas,'Courier New',monospace; font-size:12px; border:none; background-color:transparent">package com.example.testing.testingexample;

<span class="hljs-keyword" style="color:rgb(133,153,0)">public</span> <span class="hljs-keyword" style="color:rgb(133,153,0)">class</span> Calculator {

    <span class="hljs-function"><span class="hljs-keyword" style="color:rgb(133,153,0)">public</span> <span class="hljs-keyword" style="color:rgb(133,153,0)">double</span> <span class="hljs-title" style="color:rgb(38,139,210)">sum</span><span class="hljs-params">(<span class="hljs-keyword" style="color:rgb(133,153,0)">double</span> a, <span class="hljs-keyword" style="color:rgb(133,153,0)">double</span> b)</span></span>{
        <span class="hljs-keyword" style="color:rgb(133,153,0)">return</span> <span class="hljs-number" style="color:rgb(42,161,152)">0</span>;
    }

    <span class="hljs-function"><span class="hljs-keyword" style="color:rgb(133,153,0)">public</span> <span class="hljs-keyword" style="color:rgb(133,153,0)">double</span> <span class="hljs-title" style="color:rgb(38,139,210)">substract</span><span class="hljs-params">(<span class="hljs-keyword" style="color:rgb(133,153,0)">double</span> a, <span class="hljs-keyword" style="color:rgb(133,153,0)">double</span> b)</span></span>{
        <span class="hljs-keyword" style="color:rgb(133,153,0)">return</span> <span class="hljs-number" style="color:rgb(42,161,152)">0</span>;
    }

    <span class="hljs-function"><span class="hljs-keyword" style="color:rgb(133,153,0)">public</span> <span class="hljs-keyword" style="color:rgb(133,153,0)">double</span> <span class="hljs-title" style="color:rgb(38,139,210)">divide</span><span class="hljs-params">(<span class="hljs-keyword" style="color:rgb(133,153,0)">double</span> a, <span class="hljs-keyword" style="color:rgb(133,153,0)">double</span> b)</span></span>{
        <span class="hljs-keyword" style="color:rgb(133,153,0)">return</span> <span class="hljs-number" style="color:rgb(42,161,152)">0</span>;
    }

    <span class="hljs-function"><span class="hljs-keyword" style="color:rgb(133,153,0)">public</span> <span class="hljs-keyword" style="color:rgb(133,153,0)">double</span> <span class="hljs-title" style="color:rgb(38,139,210)">multiply</span><span class="hljs-params">(<span class="hljs-keyword" style="color:rgb(133,153,0)">double</span> a, <span class="hljs-keyword" style="color:rgb(133,153,0)">double</span> b)</span></span>{
        <span class="hljs-keyword" style="color:rgb(133,153,0)">return</span> <span class="hljs-number" style="color:rgb(42,161,152)">0</span>;
    }

}</code></code></pre>
<p style="margin-top:0px; margin-bottom:25px; text-align:justify; word-break:break-word">
Android Studio 提供了一个快速创建测试类的方法。只需在编辑器内右键点击 Calculator 类的声明，选择
<strong>
Go to &gt; Test
</strong>
，然后
<strong>
"Create a new test…"
</strong>
</p>
<div class="image-package imagebubble" style="margin:0px auto 20px; text-align:center">
<img alt="" class="imagebubble-image" src="https://i-blog.csdnimg.cn/blog_migrate/14b706eebaa74e259441832417ca6a38.webp?x-image-process=image/format,png" style="max-width:100%; height:auto; vertical-align:middle; border:0px">
<br/>
</img>
</div>
<p style="margin-top:0px; margin-bottom:25px; text-align:justify; word-break:break-word">
在打开的对话窗口中，选择
<strong>
JUnit4
</strong>
和"
<strong>
setUp/@Before
</strong>
"，同时为所有的计算器运算生成测试方法。
</p>
<div class="image-package imagebubble" style="margin:0px auto 20px; text-align:center">
<img alt="" class="imagebubble-image" src="https://i-blog.csdnimg.cn/blog_migrate/0dff2c6bf6afe59217fb6cf3656e04a0.webp?x-image-process=image/format,png" style="max-width:100%; height:auto; vertical-align:middle; border:0px">
<br/>
</img>
</div>
<p style="margin-top:0px; margin-bottom:25px; text-align:justify; word-break:break-word">
这样，就会在正确的文件夹内
<code style="padding:2px 4px; font-family:Menlo,Monaco,Consolas,'Courier New',monospace; font-size:12px; color:rgb(101,123,131); border:none; white-space:pre-wrap; background-color:rgb(253,246,227)">
(app/src/test/java/com/example/testing/testingexample)
</code>
生成测试类框架，在框架内填入测试方法即可。下面是一个示例：
</p>
<p style="margin-top:0px; margin-bottom:25px; text-align:justify; word-break:break-word">
<strong>
Calculator.java
</strong>
</p>
<pre><code class="language-cpp"><code class="cpp" style="padding:0px; font-family:Menlo,Monaco,Consolas,'Courier New',monospace; font-size:12px; border:none; background-color:transparent">package com.example.testing.testingexample;

import org.junit.Before;
import org.junit.Test;

import <span class="hljs-keyword" style="color:rgb(133,153,0)">static</span> org.junit.Assert.\*;

<span class="hljs-keyword" style="color:rgb(133,153,0)">public</span> <span class="hljs-keyword" style="color:rgb(133,153,0)">class</span> CalculatorTest {

    <span class="hljs-keyword" style="color:rgb(133,153,0)">private</span> Calculator mCalculator;

    @<span class="hljs-function">Before
    <span class="hljs-keyword" style="color:rgb(133,153,0)">public</span> <span class="hljs-keyword" style="color:rgb(133,153,0)">void</span> <span class="hljs-title" style="color:rgb(38,139,210)">setUp</span><span class="hljs-params">()</span> throws Exception </span>{
        mCalculator = <span class="hljs-keyword" style="color:rgb(133,153,0)">new</span> Calculator();
    }

    @<span class="hljs-function">Test
    <span class="hljs-keyword" style="color:rgb(133,153,0)">public</span> <span class="hljs-keyword" style="color:rgb(133,153,0)">void</span> <span class="hljs-title" style="color:rgb(38,139,210)">testSum</span><span class="hljs-params">()</span> throws Exception </span>{
        <span class="hljs-comment" style="color:rgb(147,161,161)">//expected: 6, sum of 1 and 5</span>
        assertEquals(<span class="hljs-number" style="color:rgb(42,161,152)">6</span>d, mCalculator.sum(<span class="hljs-number" style="color:rgb(42,161,152)">1</span>d, <span class="hljs-number" style="color:rgb(42,161,152)">5</span>d), <span class="hljs-number" style="color:rgb(42,161,152)">0</span>);
    }

    @<span class="hljs-function">Test
    <span class="hljs-keyword" style="color:rgb(133,153,0)">public</span> <span class="hljs-keyword" style="color:rgb(133,153,0)">void</span> <span class="hljs-title" style="color:rgb(38,139,210)">testSubstract</span><span class="hljs-params">()</span> throws Exception </span>{
        assertEquals(<span class="hljs-number" style="color:rgb(42,161,152)">1</span>d, mCalculator.substract(<span class="hljs-number" style="color:rgb(42,161,152)">5</span>d, <span class="hljs-number" style="color:rgb(42,161,152)">4</span>d), <span class="hljs-number" style="color:rgb(42,161,152)">0</span>);
    }

    @<span class="hljs-function">Test
    <span class="hljs-keyword" style="color:rgb(133,153,0)">public</span> <span class="hljs-keyword" style="color:rgb(133,153,0)">void</span> <span class="hljs-title" style="color:rgb(38,139,210)">testDivide</span><span class="hljs-params">()</span> throws Exception </span>{
        assertEquals(<span class="hljs-number" style="color:rgb(42,161,152)">4</span>d, mCalculator.divide(<span class="hljs-number" style="color:rgb(42,161,152)">20</span>d, <span class="hljs-number" style="color:rgb(42,161,152)">5</span>d), <span class="hljs-number" style="color:rgb(42,161,152)">0</span>);
    }

    @<span class="hljs-function">Test
    <span class="hljs-keyword" style="color:rgb(133,153,0)">public</span> <span class="hljs-keyword" style="color:rgb(133,153,0)">void</span> <span class="hljs-title" style="color:rgb(38,139,210)">testMultiply</span><span class="hljs-params">()</span> throws Exception </span>{
        assertEquals(<span class="hljs-number" style="color:rgb(42,161,152)">10</span>d, mCalculator.multiply(<span class="hljs-number" style="color:rgb(42,161,152)">2</span>d, <span class="hljs-number" style="color:rgb(42,161,152)">5</span>d), <span class="hljs-number" style="color:rgb(42,161,152)">0</span>);
    }

}</code></code></pre>
<p style="margin-top:0px; margin-bottom:25px; text-align:justify; word-break:break-word">
请将代码复制到编辑器或者使用 JUnit 框架提供的断言来编写自己的测试。
</p>
<hr style="margin:0px 0px 20px; border-right-width:0px; border-left-width:0px; border-top-style:solid; border-top-color:rgb(217,217,217); border-bottom-style:solid; border-bottom-color:white"/>
<h3 style="margin:0px; font-family:inherit; line-height:1.8; color:inherit; font-size:24px"> 5.运行单元测试
</h3>
<p style="margin-top:0px; margin-bottom:25px; text-align:justify; word-break:break-word">
终于到运行测试的时候了！右键点击
<code style="padding:2px 4px; font-family:Menlo,Monaco,Consolas,'Courier New',monospace; font-size:12px; color:rgb(101,123,131); border:none; white-space:pre-wrap; background-color:rgb(253,246,227)">
CalculatorTest
</code>
类，选择
<strong>
Run &gt; CalculatorTest
</strong>
。也可以通过命令行运行测试，在工程目录内输入：
</p>
<pre class="hljs bash" style="padding:9.5px; font-family:Menlo,Monaco,Consolas,'Courier New',monospace; font-size:13px; color:rgb(101,123,131); margin-top:0px; margin-bottom:20px; line-height:20px; word-break:break-all; word-wrap:normal; overflow:auto; background:rgb(253,246,227)"><code class="bash" style="padding:0px; font-family:Menlo,Monaco,Consolas,'Courier New',monospace; font-size:12px; border:none; background-color:transparent">./gradlew <span class="hljs-built_in" style="color:rgb(38,139,210)">test</span></code></pre>
<p style="margin-top:0px; margin-bottom:25px; text-align:justify; word-break:break-word">
无论如何运行测试，都应该看到输出显示 4 个测试都失败了。这是预期的结果，因为我们还没有实现运算操作。
</p>
<div class="image-package imagebubble" style="margin:0px auto 20px; text-align:center">
<img alt="" class="imagebubble-image" src="https://i-blog.csdnimg.cn/blog_migrate/d3f68375dfc4fef20d11b5622aee2432.webp?x-image-process=image/format,png" style="max-width:100%; height:auto; vertical-align:middle; border:0px">
<br/>
</img>
</div>
<p style="margin-top:0px; margin-bottom:25px; text-align:justify; word-break:break-word">
让我们修改 Calculator 类中的
<code style="padding:2px 4px; font-family:Menlo,Monaco,Consolas,'Courier New',monospace; font-size:12px; color:rgb(101,123,131); border:none; white-space:pre-wrap; background-color:rgb(253,246,227)">
sum(double a, double b)
</code>
方法返回一个正确的结果，重新运行测试。你应该看到 4 个测试中的 3 个失败了。
</p>
<p style="margin-top:0px; margin-bottom:25px; text-align:justify; word-break:break-word">
<strong>
Calculator.java
</strong>
</p>
<pre class="hljs cs" style="padding:9.5px; font-family:Menlo,Monaco,Consolas,'Courier New',monospace; font-size:13px; color:rgb(101,123,131); margin-top:0px; margin-bottom:20px; line-height:20px; word-break:break-all; word-wrap:normal; overflow:auto; background:rgb(253,246,227)"><code class="cs" style="padding:0px; font-family:Menlo,Monaco,Consolas,'Courier New',monospace; font-size:12px; border:none; background-color:transparent"><span class="hljs-function"><span class="hljs-keyword" style="color:rgb(133,153,0)">public</span> <span class="hljs-keyword" style="color:rgb(133,153,0)">double</span> <span class="hljs-title" style="color:rgb(38,139,210)">sum</span>(<span class="hljs-params"><span class="hljs-keyword" style="color:rgb(133,153,0)">double</span> a, <span class="hljs-keyword" style="color:rgb(133,153,0)">double</span> b</span>)</span>{
<span class="hljs-keyword" style="color:rgb(133,153,0)">return</span> a + b;
}</code></pre>
<p style="margin-top:0px; margin-bottom:25px; text-align:justify; word-break:break-word">
作为练习，你可以实现剩余的方法使所有的测试通过。
</p>
<blockquote style="padding:10px 15px; margin:0px 0px 20px; border-left-width:4px; border-left-style:solid; border-left-color:rgb(153,153,153); word-break:break-word; font-size:15px; line-height:30px; background-color:rgb(245,245,245)">
<p style="margin-top:0px; margin-bottom:0px; line-height:1.7; text-align:justify; word-break:break-word">
可能你已经注意到了 Android Studio 从来没有让你连接设备或者启动模拟器来运行测试。那是因为，位于
<code style="padding:2px 4px; font-family:Menlo,Monaco,Consolas,'Courier New',monospace; font-size:12px; color:rgb(101,123,131); border:none; white-space:pre-wrap; background-color:rgb(253,246,227)">
src/tests
</code>
目录下的测试是运行在本地电脑 Java 虚拟机上的单元测试。编写测试，实现功能使测试通过，然后再添加更多的测试...这种工作方式使快速迭代成为可能，我们称之为
<strong>
测试驱动开发
</strong>
。
<br/>
值得注意的是，当在本地运行测试时，Gradle 为你在环境变量中提供了包含 Android 框架的 android.jar 包。但是它们功能不完整（所以，打个比方，你不能单纯调用
<code style="padding:2px 4px; font-family:Menlo,Monaco,Consolas,'Courier New',monospace; font-size:12px; color:rgb(101,123,131); border:none; white-space:pre-wrap; background-color:rgb(253,246,227)">
Activity
</code>
的方法并指望它们生效）。推荐使用
<a href="http://mockito.org/" rel="nofollow noopener noreferrer" style="color:rgb(64,148,199); text-decoration:none" target="_blank">
Mockito
</a>
等 mocking 框架来 mock 你需要使用的任何 Android 方法。对于运行在设备上，并充分利用 Android 框架的测试，请继续阅读本篇教程的下个部分。
</p>
</blockquote>
<hr style="margin:0px 0px 20px; border-right-width:0px; border-left-width:0px; border-top-style:solid; border-top-color:rgb(217,217,217); border-bottom-style:solid; border-bottom-color:white"/>
<h3 style="margin:0px; font-family:inherit; line-height:1.8; color:inherit; font-size:24px"> 6.配置支持 Instrumentation 测试的工程
</h3>
<p style="margin-top:0px; margin-bottom:25px; text-align:justify; word-break:break-word">
虽然在 Android 框架内支持运行 instrumentation 测试，但是目前开发重心主要集中在刚刚发布的作为
<strong>
Android Testing Support Library
</strong>
一部分的新的
<code style="padding:2px 4px; font-family:Menlo,Monaco,Consolas,'Courier New',monospace; font-size:12px; color:rgb(101,123,131); border:none; white-space:pre-wrap; background-color:rgb(253,246,227)">
AndroidJUnitRunner
</code>
。测试库包含
<em>
Espresso
</em>
，用于运行功能 UI 测试的框架。让我们通过编辑
<code style="padding:2px 4px; font-family:Menlo,Monaco,Consolas,'Courier New',monospace; font-size:12px; color:rgb(101,123,131); border:none; white-space:pre-wrap; background-color:rgb(253,246,227)">
build.gradle
</code>
的相关部分来把它们添加进我们的工程。
</p>
<p style="margin-top:0px; margin-bottom:25px; text-align:justify; word-break:break-word">
<strong>
build.gradle
</strong>
</p>
<pre><code class="language-php"><code class="php" style="padding:0px; font-family:Menlo,Monaco,Consolas,'Courier New',monospace; font-size:12px; border:none; background-color:transparent">apply plugin: <span class="hljs-string" style="color:rgb(42,161,152)">'com.android.application'</span>

android {
compileSdkVersion <span class="hljs-number" style="color:rgb(42,161,152)">22</span>
buildToolsVersion <span class="hljs-string" style="color:rgb(42,161,152)">"22.0.1"</span>

    defaultConfig {
        applicationId <span class="hljs-string" style="color:rgb(42,161,152)">"com.example.testing.testingexample"</span>
        minSdkVersion <span class="hljs-number" style="color:rgb(42,161,152)">15</span>
        targetSdkVersion <span class="hljs-number" style="color:rgb(42,161,152)">22</span>
        versionCode <span class="hljs-number" style="color:rgb(42,161,152)">1</span>
        versionName <span class="hljs-string" style="color:rgb(42,161,152)">"1.0"</span>

        <span class="hljs-comment" style="color:rgb(147,161,161)">//ADD THIS LINE:</span>
        testInstrumentationRunner <span class="hljs-string" style="color:rgb(42,161,152)">"android.support.test.runner.AndroidJUnitRunner"</span>
    }

    buildTypes {
        release {
            minifyEnabled <span class="hljs-keyword" style="color:rgb(133,153,0)">false</span>
            proguardFiles getDefaultProguardFile(<span class="hljs-string" style="color:rgb(42,161,152)">'proguard-android.txt'</span>), <span class="hljs-string" style="color:rgb(42,161,152)">'proguard-rules.pro'</span>
        }
    }

    <span class="hljs-comment" style="color:rgb(147,161,161)">//ADD THESE LINES:</span>
    packagingOptions {
        exclude <span class="hljs-string" style="color:rgb(42,161,152)">'LICENSE.txt'</span>
    }

}

dependencies {
compile fileTree(dir: <span class="hljs-string" style="color:rgb(42,161,152)">'libs'</span>, <span class="hljs-keyword" style="color:rgb(133,153,0)">include</span>: [<span class="hljs-string" style="color:rgb(42,161,152)">'*.jar'</span>])
compile <span class="hljs-string" style="color:rgb(42,161,152)">'com.android.support:appcompat-v7:22.0.0'</span> <span class="hljs-comment" style="color:rgb(147,161,161)">//← MAKE SURE IT’S 22.0.0</span>
testCompile <span class="hljs-string" style="color:rgb(42,161,152)">'junit:junit:4.12'</span>

    <span class="hljs-comment" style="color:rgb(147,161,161)">//ADD THESE LINES:</span>
    androidTestCompile <span class="hljs-string" style="color:rgb(42,161,152)">'com.android.support.test:runner:0.2'</span>
    androidTestCompile <span class="hljs-string" style="color:rgb(42,161,152)">'com.android.support.test:rules:0.2'</span>
    androidTestCompile <span class="hljs-string" style="color:rgb(42,161,152)">'com.android.support.test.espresso:espresso-core:2.1'</span>

}</code></code></pre>
<blockquote style="padding:10px 15px; margin:0px 0px 20px; border-left-width:4px; border-left-style:solid; border-left-color:rgb(153,153,153); word-break:break-word; font-size:15px; line-height:30px; background-color:rgb(245,245,245)">
<p style="margin-top:0px; margin-bottom:0px; line-height:1.7; text-align:justify; word-break:break-word">
<strong>
重要
</strong>
：由于一些依赖版本冲突，你需要确认
<code style="padding:2px 4px; font-family:Menlo,Monaco,Consolas,'Courier New',monospace; font-size:12px; color:rgb(101,123,131); border:none; white-space:pre-wrap; background-color:rgb(253,246,227)">
com.android.support:appcompat-v7
</code>
库的版本号是
<code style="padding:2px 4px; font-family:Menlo,Monaco,Consolas,'Courier New',monospace; font-size:12px; color:rgb(101,123,131); border:none; white-space:pre-wrap; background-color:rgb(253,246,227)">
22.0.0
</code>
，像上面的代码片段一样。
<br/>
另外，Android Studio 可能会提醒你
<code style="padding:2px 4px; font-family:Menlo,Monaco,Consolas,'Courier New',monospace; font-size:12px; color:rgb(101,123,131); border:none; white-space:pre-wrap; background-color:rgb(253,246,227)">
Build Tools 22.0.1
</code>
没有安装。你应该接受修复建议，Studio 会为你安装 Build Tools 或者在 build.gradle 中把这行修改成已经安装在你电脑的版本。
</p>
</blockquote>
<p style="margin-top:0px; margin-bottom:25px; text-align:justify; word-break:break-word">
上面的工作完成后，在
<strong>
Build Variants
</strong>
窗口内切换成
<strong>
Android Instrumentation Tests
</strong>
，你的工程应该自动同步。如果没有，点击
<strong>
Gradle sync
</strong>
按钮。
</p>
<hr style="margin:0px 0px 20px; border-right-width:0px; border-left-width:0px; border-top-style:solid; border-top-color:rgb(217,217,217); border-bottom-style:solid; border-bottom-color:white"/>
<h3 style="margin:0px; font-family:inherit; line-height:1.8; color:inherit; font-size:24px"> 7.为 app 添加简单的交互
</h3>
<div class="image-package imagebubble" style="margin:0px auto 20px; text-align:center">
<img alt="" class="imagebubble-image" src="https://i-blog.csdnimg.cn/blog_migrate/a0a41c8f7a75cb321f097dadaa7c61b3.webp?x-image-process=image/format,png" style="max-width:100%; height:auto; vertical-align:middle; border:0px"/>
<br/>
</div>
<p style="margin-top:0px; margin-bottom:25px; text-align:justify; word-break:break-word">
在使用 Espresso 进行 UI 测试前，让我们为 app 添加一些 Views 和简单的交互。我们使用一个用户可以输入名字的 EditText，欢迎用户的 Button 和用于输出的 TextView。打开
<code style="padding:2px 4px; font-family:Menlo,Monaco,Consolas,'Courier New',monospace; font-size:12px; color:rgb(101,123,131); border:none; white-space:pre-wrap; background-color:rgb(253,246,227)">
res/layout/activity_main.xml
</code>
，粘贴如下代码：
<br/>
<strong>
activity_main.xml
</strong>
</p>
<pre class="hljs xml" style="padding:9.5px; font-family:Menlo,Monaco,Consolas,'Courier New',monospace; font-size:13px; color:rgb(101,123,131); margin-top:0px; margin-bottom:20px; line-height:20px; word-break:break-all; word-wrap:normal; overflow:auto; background:rgb(253,246,227)"><code class="xml" style="padding:0px; font-family:Menlo,Monaco,Consolas,'Courier New',monospace; font-size:12px; border:none; background-color:transparent"><span class="hljs-tag">&lt;<span class="hljs-title" style="color:rgb(38,139,210)">RelativeLayout</span> <span class="hljs-attribute" style="color:rgb(181,137,0)">xmlns:android</span>=<span class="hljs-value" style="color:rgb(42,161,152)">"http://schemas.android.com/apk/res/android"</span>
<span class="hljs-attribute" style="color:rgb(181,137,0)">xmlns:tools</span>=<span class="hljs-value" style="color:rgb(42,161,152)">"http://schemas.android.com/tools"</span> <span class="hljs-attribute" style="color:rgb(181,137,0)">android:layout_width</span>=<span class="hljs-value" style="color:rgb(42,161,152)">"match_parent"</span>
<span class="hljs-attribute" style="color:rgb(181,137,0)">android:layout_height</span>=<span class="hljs-value" style="color:rgb(42,161,152)">"match_parent"</span> <span class="hljs-attribute" style="color:rgb(181,137,0)">android:paddingLeft</span>=<span class="hljs-value" style="color:rgb(42,161,152)">"@dimen/activity_horizontal_margin"</span>
<span class="hljs-attribute" style="color:rgb(181,137,0)">android:paddingRight</span>=<span class="hljs-value" style="color:rgb(42,161,152)">"@dimen/activity_horizontal_margin"</span>
<span class="hljs-attribute" style="color:rgb(181,137,0)">android:paddingTop</span>=<span class="hljs-value" style="color:rgb(42,161,152)">"@dimen/activity_vertical_margin"</span>
<span class="hljs-attribute" style="color:rgb(181,137,0)">android:paddingBottom</span>=<span class="hljs-value" style="color:rgb(42,161,152)">"@dimen/activity_vertical_margin"</span> <span class="hljs-attribute" style="color:rgb(181,137,0)">tools:context</span>=<span class="hljs-value" style="color:rgb(42,161,152)">".MainActivity"</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-title" style="color:rgb(38,139,210)">TextView</span>
        <span class="hljs-attribute" style="color:rgb(181,137,0)">android:id</span>=<span class="hljs-value" style="color:rgb(42,161,152)">"@+id/textView"</span>
        <span class="hljs-attribute" style="color:rgb(181,137,0)">android:text</span>=<span class="hljs-value" style="color:rgb(42,161,152)">"@string/hello_world"</span> <span class="hljs-attribute" style="color:rgb(181,137,0)">android:layout_width</span>=<span class="hljs-value" style="color:rgb(42,161,152)">"wrap_content"</span>
        <span class="hljs-attribute" style="color:rgb(181,137,0)">android:layout_height</span>=<span class="hljs-value" style="color:rgb(42,161,152)">"wrap_content"</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title" style="color:rgb(38,139,210)">EditText</span>
        <span class="hljs-attribute" style="color:rgb(181,137,0)">android:hint</span>=<span class="hljs-value" style="color:rgb(42,161,152)">"Enter your name here"</span>
        <span class="hljs-attribute" style="color:rgb(181,137,0)">android:id</span>=<span class="hljs-value" style="color:rgb(42,161,152)">"@+id/editText"</span>
        <span class="hljs-attribute" style="color:rgb(181,137,0)">android:layout_width</span>=<span class="hljs-value" style="color:rgb(42,161,152)">"match_parent"</span>
        <span class="hljs-attribute" style="color:rgb(181,137,0)">android:layout_height</span>=<span class="hljs-value" style="color:rgb(42,161,152)">"wrap_content"</span>
        <span class="hljs-attribute" style="color:rgb(181,137,0)">android:layout_below</span>=<span class="hljs-value" style="color:rgb(42,161,152)">"@+id/textView"</span>/&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title" style="color:rgb(38,139,210)">Button</span>
        <span class="hljs-attribute" style="color:rgb(181,137,0)">android:layout_width</span>=<span class="hljs-value" style="color:rgb(42,161,152)">"match_parent"</span>
        <span class="hljs-attribute" style="color:rgb(181,137,0)">android:layout_height</span>=<span class="hljs-value" style="color:rgb(42,161,152)">"wrap_content"</span>
        <span class="hljs-attribute" style="color:rgb(181,137,0)">android:text</span>=<span class="hljs-value" style="color:rgb(42,161,152)">"Say hello!"</span>
        <span class="hljs-attribute" style="color:rgb(181,137,0)">android:layout_below</span>=<span class="hljs-value" style="color:rgb(42,161,152)">"@+id/editText"</span>
        <span class="hljs-attribute" style="color:rgb(181,137,0)">android:onClick</span>=<span class="hljs-value" style="color:rgb(42,161,152)">"sayHello"</span>/&gt;</span>

<span class="hljs-tag">&lt;/<span class="hljs-title" style="color:rgb(38,139,210)">RelativeLayout</span>&gt;</span></code></pre>
<p style="margin-top:0px; margin-bottom:25px; text-align:justify; word-break:break-word">
还需要在
<code style="padding:2px 4px; font-family:Menlo,Monaco,Consolas,'Courier New',monospace; font-size:12px; color:rgb(101,123,131); border:none; white-space:pre-wrap; background-color:rgb(253,246,227)">
MainActivity.java
</code>
中添加 onClick handler：
</p>
<p style="margin-top:0px; margin-bottom:25px; text-align:justify; word-break:break-word">
<strong>
MainActivity.java
</strong>
</p>
<pre class="hljs cs" style="padding:9.5px; font-family:Menlo,Monaco,Consolas,'Courier New',monospace; font-size:13px; color:rgb(101,123,131); margin-top:0px; margin-bottom:20px; line-height:20px; word-break:break-all; word-wrap:normal; overflow:auto; background:rgb(253,246,227)"><code class="cs" style="padding:0px; font-family:Menlo,Monaco,Consolas,'Courier New',monospace; font-size:12px; border:none; background-color:transparent"><span class="hljs-function"><span class="hljs-keyword" style="color:rgb(133,153,0)">public</span> <span class="hljs-keyword" style="color:rgb(133,153,0)">void</span> <span class="hljs-title" style="color:rgb(38,139,210)">sayHello</span>(<span class="hljs-params">View v</span>)</span>{
TextView textView = (TextView) findViewById(R.id.textView);
EditText editText = (EditText) findViewById(R.id.editText);
textView.setText(<span class="hljs-string" style="color:rgb(42,161,152)">"Hello, "</span> + editText.getText().toString() + <span class="hljs-string" style="color:rgb(42,161,152)">"!"</span>);
}</code></pre>
<p style="margin-top:0px; margin-bottom:25px; text-align:justify; word-break:break-word">
现在可以运行 app 并确认一切工作正常。在点击
<strong>
Run
</strong>
按钮之前，确认你的
<em>
Run Configuration
</em>
没有设置为运行测试。如需更改，点击下拉选项，选择
<strong>
app
</strong>
。
</p>
<hr style="margin:0px 0px 20px; border-right-width:0px; border-left-width:0px; border-top-style:solid; border-top-color:rgb(217,217,217); border-bottom-style:solid; border-bottom-color:white"/>
<h3 style="margin:0px; font-family:inherit; line-height:1.8; color:inherit; font-size:24px"> 8.创建并运行 Espresso 测试
</h3>
<div class="image-package imagebubble" style="margin:0px auto 20px; text-align:center">
<img alt="" class="imagebubble-image" src="https://i-blog.csdnimg.cn/blog_migrate/0bb1cd51f897c332d5f317e439438a7a.webp?x-image-process=image/format,png" style="max-width:100%; height:auto; vertical-align:middle; border:0px"/>
<br/>
</div>
<p style="margin-top:0px; margin-bottom:25px; text-align:justify; word-break:break-word">
在工程的整体视图上，找到以（
<code style="padding:2px 4px; font-family:Menlo,Monaco,Consolas,'Courier New',monospace; font-size:12px; color:rgb(101,123,131); border:none; white-space:pre-wrap; background-color:rgb(253,246,227)">
androidTest
</code>
）后缀结尾的包名并创建一个新的 Java 类。可以将它命名为
<code style="padding:2px 4px; font-family:Menlo,Monaco,Consolas,'Courier New',monospace; font-size:12px; color:rgb(101,123,131); border:none; white-space:pre-wrap; background-color:rgb(253,246,227)">
MainActivityInstrumentationTest
</code>
，将如下代码粘贴过去。
</p>
<p style="margin-top:0px; margin-bottom:25px; text-align:justify; word-break:break-word">
<em>
\*\* MainActivityInstrumentationTest.java
</em>
</p>
<pre><code class="language-javascript"><code class="javascript" style="padding:0px; font-family:Menlo,Monaco,Consolas,'Courier New',monospace; font-size:12px; border:none; background-color:transparent">package com.example.testing.testingexample;

<span class="hljs-keyword" style="color:rgb(133,153,0)">import</span> android.support.test.InstrumentationRegistry;
<span class="hljs-keyword" style="color:rgb(133,153,0)">import</span> android.support.test.espresso.action.ViewActions;
<span class="hljs-keyword" style="color:rgb(133,153,0)">import</span> android.support.test.rule.ActivityTestRule;
<span class="hljs-keyword" style="color:rgb(133,153,0)">import</span> android.support.test.runner.AndroidJUnit4;
<span class="hljs-keyword" style="color:rgb(133,153,0)">import</span> android.test.ActivityInstrumentationTestCase2;
<span class="hljs-keyword" style="color:rgb(133,153,0)">import</span> android.test.suitebuilder.annotation.LargeTest;

<span class="hljs-keyword" style="color:rgb(133,153,0)">import</span> org.junit.After;
<span class="hljs-keyword" style="color:rgb(133,153,0)">import</span> org.junit.Before;
<span class="hljs-keyword" style="color:rgb(133,153,0)">import</span> org.junit.Rule;
<span class="hljs-keyword" style="color:rgb(133,153,0)">import</span> org.junit.Test;
<span class="hljs-keyword" style="color:rgb(133,153,0)">import</span> org.junit.runner.RunWith;

<span class="hljs-keyword" style="color:rgb(133,153,0)">import</span> static android.support.test.espresso.Espresso.onView;
<span class="hljs-keyword" style="color:rgb(133,153,0)">import</span> static android.support.test.espresso.action.ViewActions.click;
<span class="hljs-keyword" style="color:rgb(133,153,0)">import</span> static android.support.test.espresso.action.ViewActions.closeSoftKeyboard;
<span class="hljs-keyword" style="color:rgb(133,153,0)">import</span> static android.support.test.espresso.action.ViewActions.typeText;
<span class="hljs-keyword" style="color:rgb(133,153,0)">import</span> static android.support.test.espresso.assertion.ViewAssertions.matches;
<span class="hljs-keyword" style="color:rgb(133,153,0)">import</span> static android.support.test.espresso.matcher.ViewMatchers.withId;
<span class="hljs-keyword" style="color:rgb(133,153,0)">import</span> static android.support.test.espresso.matcher.ViewMatchers.withText;

@RunWith(AndroidJUnit4.class)
@LargeTest
public <span class="hljs-class"><span class="hljs-keyword" style="color:rgb(133,153,0)">class</span> <span class="hljs-title" style="color:rgb(181,137,0)">MainActivityInstrumentationTest</span> </span>{

    private static final <span class="hljs-built_in" style="color:rgb(38,139,210)">String</span> STRING_TO_BE_TYPED = <span class="hljs-string" style="color:rgb(42,161,152)">"Peter"</span>;

    @Rule
    public ActivityTestRule&lt;MainActivity&gt; mActivityRule = <span class="hljs-keyword" style="color:rgb(133,153,0)">new</span> ActivityTestRule&lt;&gt;(
        MainActivity.class);

    @Test
    public <span class="hljs-keyword" style="color:rgb(133,153,0)">void</span> sayHello(){
        onView(withId(R.id.editText)).perform(typeText(STRING_TO_BE_TYPED), closeSoftKeyboard()); <span class="hljs-comment" style="color:rgb(147,161,161)">//line 1</span>

        onView(withText(<span class="hljs-string" style="color:rgb(42,161,152)">"Say hello!"</span>)).perform(click()); <span class="hljs-comment" style="color:rgb(147,161,161)">//line 2</span>

        <span class="hljs-built_in" style="color:rgb(38,139,210)">String</span> expectedText = <span class="hljs-string" style="color:rgb(42,161,152)">"Hello, "</span> + STRING_TO_BE_TYPED + <span class="hljs-string" style="color:rgb(42,161,152)">"!"</span>;
        onView(withId(R.id.textView)).check(matches(withText(expectedText))); <span class="hljs-comment" style="color:rgb(147,161,161)">//line 3</span>
    }

}</code></code></pre>
<p style="margin-top:0px; margin-bottom:25px; text-align:justify; word-break:break-word">
测试类通过
<strong>
AndroidJUnitRunner
</strong>
运行，并执行
<code style="padding:2px 4px; font-family:Menlo,Monaco,Consolas,'Courier New',monospace; font-size:12px; color:rgb(101,123,131); border:none; white-space:pre-wrap; background-color:rgb(253,246,227)">
sayHello()
</code>
方法。下面将逐行解释都做了什么：
</p>
<ul style="padding:0px; margin:0px 0px 20px 25px; text-align:justify; word-break:break-word">
<li style="line-height:30px"> 1.首先，找到 ID 为
<code style="padding:2px 4px; font-family:Menlo,Monaco,Consolas,'Courier New',monospace; font-size:12px; color:rgb(101,123,131); border:none; white-space:pre-wrap; background-color:rgb(253,246,227)">
editText
</code>
的 view，输入
<code style="padding:2px 4px; font-family:Menlo,Monaco,Consolas,'Courier New',monospace; font-size:12px; color:rgb(101,123,131); border:none; white-space:pre-wrap; background-color:rgb(253,246,227)">
Peter
</code>
，然后关闭键盘；
</li>
<li style="line-height:30px"> 2.接下来，点击
<code style="padding:2px 4px; font-family:Menlo,Monaco,Consolas,'Courier New',monospace; font-size:12px; color:rgb(101,123,131); border:none; white-space:pre-wrap; background-color:rgb(253,246,227)">
Say hello!
</code>
的 View，我们没有在布局的 XML 中为这个 Button 设置 id，因此，通过搜索它上面的文字来找到它；
</li>
<li style="line-height:30px"> 3.最后，将
<code style="padding:2px 4px; font-family:Menlo,Monaco,Consolas,'Courier New',monospace; font-size:12px; color:rgb(101,123,131); border:none; white-space:pre-wrap; background-color:rgb(253,246,227)">
TextView
</code>
上的文本同预期结果对比，如果一致则测试通过；
</li>
</ul>
<p style="margin-top:0px; margin-bottom:25px; text-align:justify; word-break:break-word">
你也可以右键点击域名运行测试，选择
<strong>
Run&gt;MainActivityInstrume...
</strong>
（第二个带 Android 图标的）
</p>
<div class="image-package imagebubble" style="margin:0px auto 20px; text-align:center">
<img alt="" class="imagebubble-image" src="https://i-blog.csdnimg.cn/blog_migrate/1e247befdb2a8c565c7b501f1bb87060.webp?x-image-process=image/format,png" style="max-width:100%; height:auto; vertical-align:middle; border:0px"/>
<br/>
</div>
<p style="margin-top:0px; margin-bottom:25px; text-align:justify; word-break:break-word">
这样就会在模拟器或者连接的设备上运行测试，你可以在手机屏幕上看到被执行的动作（比如在
<code style="padding:2px 4px; font-family:Menlo,Monaco,Consolas,'Courier New',monospace; font-size:12px; color:rgb(101,123,131); border:none; white-space:pre-wrap; background-color:rgb(253,246,227)">
EditText
</code>
上打字）。最后会在 Android Studio 输出通过和失败的测试结果。
</p>
<p style="margin-top:0px; margin-bottom:25px; text-align:justify; word-break:break-word">
<a href="https://github.com/dongdaqing/TestingExample" rel="noopener noreferrer" style="color:rgb(64,148,199); text-decoration:none" target="_blank">
Github 下载测试源码
</a>
</p>
<hr style="margin:0px 0px 20px; border-right-width:0px; border-left-width:0px; border-top-style:solid; border-top-color:rgb(217,217,217); border-bottom-style:solid; border-bottom-color:white"/>
<h3 style="margin:0px; font-family:inherit; line-height:1.8; color:inherit; font-size:24px"> 9.祝贺
</h3>
<p style="margin-top:0px; margin-bottom:25px; text-align:justify; word-break:break-word">
我们希望你能喜欢本篇教程，并且开始着手测试你的应用程序。接着你可以学习如下内容：
</p>
<ul style="padding:0px; margin:0px 0px 20px 25px; text-align:justify; word-break:break-word">
<li style="line-height:30px">
了解更多关于
<a href="https://developer.android.com/training/testing/unit-testing/index.html" rel="nofollow noopener noreferrer" style="color:rgb(64,148,199); text-decoration:none" target="_blank">
单元测试和 instrumentation 测试的区别
</a>
；
</li>
<li style="line-height:30px">
了解更多关于设置
<a href="https://developer.android.com/tools/testing-support-library/index.html" rel="nofollow noopener noreferrer" style="color:rgb(64,148,199); text-decoration:none" target="_blank">
Android Testing Support Library
</a>
；
</li>
<li style="line-height:30px">
<p style="margin-top:0px; margin-bottom:25px; word-break:break-word; overflow:visible">
观看下面非常棒的有关 Android Studio 的视频：
</p>
<ul style="padding:0px; margin:15px 0px 20px 25px; word-break:break-word">
<li>
<a href="https://www.youtube.com/watch?v=K2dodTXARqc" rel="nofollow noopener noreferrer" style="color:rgb(64,148,199); text-decoration:none" target="_blank">
Introduction to Android Studio
</a>
</li>
<li>
<a href="https://www.youtube.com/watch?v=cD7NPxuuXYY" rel="nofollow noopener noreferrer" style="color:rgb(64,148,199); text-decoration:none" target="_blank">
Introducing Gradle (Ep 2, Android Studio)
</a>
</li>
<li>
<a href="http://www.youtube.com/watch?v=JLLnhwtDoHw" rel="nofollow noopener noreferrer" style="color:rgb(64,148,199); text-decoration:none" target="_blank">
Layout Editor (Ep 3, Android Studio)
</a>
</li>
<li>
<a href="http://www.youtube.com/watch?v=2I6fuD20qlY" rel="nofollow noopener noreferrer" style="color:rgb(64,148,199); text-decoration:none" target="_blank">
Debugging and testing in Android Studio (Ep 4, Android Studio)
</a>
</li>
</ul>
</li>
<li style="line-height:30px">
在
<a href="https://github.com/googlesamples/android-testing/" rel="noopener noreferrer" style="color:rgb(7,91,141); text-decoration:none; outline:0px" target="_blank">
Github 下载 Google 测试示例代码
</a>
</li>
</ul>
<p style="margin-top:0px; margin-bottom:25px; text-align:justify; word-break:break-word">
（完）
</p>
</div>

   </div>
  </div>
 </article>
 <p alt="68747470733a2f2f626c:6f672e6373646e2e6e65742f6c69616f323737323138393632:2f61727469636c652f64657461696c732f3530313938393633" class_="artid" style="display:none">
 </p>
</div>
