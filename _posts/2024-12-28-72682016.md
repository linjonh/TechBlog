---
layout: post
title: "python爬虫初步-与java爬虫的比较"
date: 2024-12-28 11:15:22 +0800
description: "相比较java来说,python的http库类更佳丰富,用java需要几十行代码才能完成的事情,py"
keywords: "java python 爬取html区别"
categories: ['爬虫']
tags: ['爬虫', 'Python', 'Java']
artid: "72682016"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=72682016
    alt: "python爬虫初步-与java爬虫的比较"
render_with_liquid: false
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     python爬虫初步-与java爬虫的比较
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <p>
     相比较java来说,python的http库类更佳丰富,用java需要几十行代码才能完成的事情,python往往只需要十几行,例如打开并且存储一个网页
    </p>
    <p>
     java代码:
    </p>
    <p>
     <span style="white-space:pre">
     </span>
    </p>
    <p>
     <span style="white-space:pre">
      import java.io.BufferedReader;
      <br/>
      import java.io.FileOutputStream;
      <br/>
      import java.io.FileWriter;
      <br/>
      import java.io.IOException;
      <br/>
      import java.io.InputStreamReader;
      <br/>
      import java.net.MalformedURLException;
      <br/>
      import java.net.URL;
      <br/>
      import java.net.URLConnection;
      <br/>
      <br/>
      <br/>
      public class HeaderTest {
      <!-- -->
      <br/>
      <span style="white-space:pre">
      </span>
      public static void main(String[] args) {
      <!-- -->
      <br/>
      <span style="white-space:pre">
      </span>
      new HeaderTest().downloadHtml("http://www.bilibili.com");
      <br/>
      <span style="white-space:pre">
      </span>
      }
      <br/>
      <span style="white-space:pre">
      </span>
      public void downloadHtml(String link){
      <!-- -->
      <br/>
      <span style="white-space:pre">
      </span>
      BufferedReader reader = null;
      <br/>
      <span style="white-space:pre">
      </span>
      FileWriter writer = null;
      <br/>
      <span style="white-space:pre">
      </span>
      try {
      <!-- -->
      <br/>
      <span style="white-space:pre">
      </span>
      URL url = new URL(link);
      <br/>
      <span style="white-space:pre">
      </span>
      URLConnection con = url.openConnection();
      <br/>
      <span style="white-space:pre">
      </span>
      reader = new BufferedReader(new InputStreamReader(con.getInputStream()));
      <br/>
      <span style="white-space:pre">
      </span>
      writer = new FileWriter("f://test1.txt");
      <br/>
      <span style="white-space:pre">
      </span>
      String buff = null;
      <br/>
      <span style="white-space:pre">
      </span>
      StringBuilder sb = new StringBuilder();
      <br/>
      <span style="white-space:pre">
      </span>
      while((buff = reader.readLine()) != null){
      <!-- -->
      <br/>
      <span style="white-space:pre">
      </span>
      writer.write(buff);
      <br/>
      <span style="white-space:pre">
      </span>
      }
      <br/>
      <span style="white-space:pre">
      </span>
      } catch (MalformedURLException e) {
      <!-- -->
      <br/>
      <span style="white-space:pre">
      </span>
      // TODO Auto-generated catch block
      <br/>
      <span style="white-space:pre">
      </span>
      e.printStackTrace();
      <br/>
      <span style="white-space:pre">
      </span>
      } catch (IOException e) {
      <!-- -->
      <br/>
      <span style="white-space:pre">
      </span>
      // TODO Auto-generated catch block
      <br/>
      <span style="white-space:pre">
      </span>
      e.printStackTrace();
      <br/>
      <span style="white-space:pre">
      </span>
      }finally{
      <!-- -->
      <br/>
      <span style="white-space:pre">
      </span>
      try {
      <!-- -->
      <br/>
      <span style="white-space:pre">
      </span>
      reader.close();
      <br/>
      <span style="white-space:pre">
      </span>
      writer.close();
      <br/>
      <span style="white-space:pre">
      </span>
      } catch (IOException e) {
      <!-- -->
      <br/>
      <span style="white-space:pre">
      </span>
      // TODO Auto-generated catch block
      <br/>
      <span style="white-space:pre">
      </span>
      e.printStackTrace();
      <br/>
      <span style="white-space:pre">
      </span>
      }
      <br/>
      <span style="white-space:pre">
      </span>
      }
      <br/>
      <span style="white-space:pre">
      </span>
      }
      <br/>
      }
      <br/>
      <span style="white-space:pre">
      </span>
     </span>
    </p>
    <p>
     python代码:
     <span style="white-space:pre">
     </span>
    </p>
    <p>
    </p>
    <pre style="background-color:#2b2b2b; color:#a9b7c6; font-family:'宋体'; font-size:15.0pt"><span style="color:#cc7832"><strong>import </strong></span>urllib.request

<span style="color:#cc7832"><strong>def </strong></span><span style="font-weight:bold">downloadHtml</span>(link):
    <span style="color:#cc7832"><strong>try</strong></span>:
        data = urllib.request.urlopen(link).read()
        text = data.decode(<span style="color:#008080">'utf-8'</span><span style="color:#cc7832">,</span><span style="color:#008080">'ignore'</span>)
        file = <span style="color:#8888c6">open</span>(<span style="color:#008080">'f:</span><span style="color:#cc7832">\\</span><span style="color:#008080">test2.txt'</span><span style="color:#cc7832">,</span><span style="color:#008080">'w'</span>)
        file.write(text)
        file.close()
    <span style="color:#cc7832"><strong>except </strong></span>urllib.request.URLError <span style="color:#cc7832"><strong>as </strong></span>e:
        <span style="color:#8888c6">print</span>(e.reason)
downloadHtml(<span style="color:#008080">"http://www.bilibili.com"</span>)</pre>
    然而这种爬取网站的方式是不安全的,1是网站会根据访问者的类型来屏蔽访问.2是在爬取的时候访问网站会非常频繁,网站会封掉我们的IP
    <p>
    </p>
    <p>
     我们需要欺骗网站,在java中实现这一点比较常用的是使用HttpClient的jar包来实现
    </p>
    <p>
     java代码如下
    </p>
    <p>
     import java.io.BufferedInputStream;
     <br/>
     import java.io.BufferedReader;
     <br/>
     import java.io.IOException;
     <br/>
     import java.io.InputStreamReader;
     <br/>
     <br/>
     <br/>
     import org.apache.http.HttpEntity;
     <br/>
     import org.apache.http.HttpHost;
     <br/>
     import org.apache.http.HttpRequest;
     <br/>
     import org.apache.http.HttpResponse;
     <br/>
     import org.apache.http.client.ClientProtocolException;
     <br/>
     import org.apache.http.client.config.RequestConfig;
     <br/>
     import org.apache.http.client.methods.CloseableHttpResponse;
     <br/>
     import org.apache.http.client.methods.HttpGet;
     <br/>
     import org.apache.http.impl.client.CloseableHttpClient;
     <br/>
     import org.apache.http.impl.client.HttpClients;
     <br/>
     import org.apache.http.impl.execchain.MainClientExec;
     <br/>
     <br/>
     <br/>
     public class HttpclientTest {
     <!-- -->
     <br/>
     <span style="white-space:pre">
     </span>
     public static void main(String[] args){
     <!-- -->
     <br/>
     <span style="white-space:pre">
     </span>
     System.out.println(new HttpclientTest().gethtml("http://www.bilibili.com"));
     <br/>
     <span style="white-space:pre">
     </span>
     }
     <br/>
     <span style="white-space:pre">
     </span>
     public String gethtml(String url){
     <!-- -->
     <br/>
     <span style="white-space:pre">
     </span>
     String html = null;
     <br/>
     <span style="white-space:pre">
     </span>
     //建立HttpClient类,这是HttpClient的jar包中的一个类
     <br/>
     <span style="white-space:pre">
     </span>
     CloseableHttpClient httpclient = HttpClients.createDefault();
     <br/>
     <span style="white-space:pre">
     </span>
     //读取html的流
     <br/>
     <span style="white-space:pre">
     </span>
     BufferedReader reader = null;
     <br/>
     <span style="white-space:pre">
     </span>
     //设置请求信息
     <br/>
     <span style="white-space:pre">
     </span>
     HttpGet getmethod = new HttpGet(url);
     <br/>
     <span style="white-space:pre">
     </span>
     //响应
     <br/>
     <span style="white-space:pre">
     </span>
     HttpResponse response = null;
     <br/>
     <span style="white-space:pre">
     </span>
     //设置代理IP
     <br/>
     <span style="white-space:pre">
     </span>
     HttpHost proxy = new HttpHost("124.88.67.81",80);
     <br/>
     <span style="white-space:pre">
     </span>
     //设置超时时间
     <br/>
     <span style="white-space:pre">
     </span>
     RequestConfig config = RequestConfig.custom().setProxy(proxy).setConnectTimeout(5000).setConnectionRequestTimeout(5000).setSocketTimeout(5000).build();
     <br/>
     <span style="white-space:pre">
     </span>
     //添加请求头
     <br/>
     <span style="white-space:pre">
     </span>
     getmethod.addHeader("User-Agent","Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/56.0.2924.87 Safari/537.36");
     <br/>
     <span style="white-space:pre">
     </span>
     getmethod.setConfig(config);
     <br/>
     <span style="white-space:pre">
     </span>
     try {
     <!-- -->
     <br/>
     <span style="white-space:pre">
     </span>
     //获得响应
     <br/>
     <span style="white-space:pre">
     </span>
     response = httpclient.execute(getmethod);
     <br/>
     <span style="white-space:pre">
     </span>
     //响应体
     <br/>
     <span style="white-space:pre">
     </span>
     HttpEntity entity = response.getEntity();
     <br/>
     <span style="white-space:pre">
     </span>
     //建立一个读取流
     <br/>
     <span style="white-space:pre">
     </span>
     reader = new BufferedReader(new InputStreamReader(entity.getContent()));
     <br/>
     <span style="white-space:pre">
     </span>
     //读取html
     <br/>
     <span style="white-space:pre">
     </span>
     String buff = null;
     <br/>
     <span style="white-space:pre">
     </span>
     StringBuilder sb = new StringBuilder();
     <br/>
     <span style="white-space:pre">
     </span>
     while((buff = reader.readLine()) != null){
     <!-- -->
     <br/>
     <span style="white-space:pre">
     </span>
     sb.append(buff);
     <br/>
     <span style="white-space:pre">
     </span>
     }
     <br/>
     <span style="white-space:pre">
     </span>
     html = sb.toString();
     <br/>
     <span style="white-space:pre">
     </span>
     System.out.println();
     <br/>
     <span style="white-space:pre">
     </span>
     return html;
     <br/>
     <span style="white-space:pre">
     </span>
     } catch (ClientProtocolException e) {
     <!-- -->
     <br/>
     <span style="white-space:pre">
     </span>
     // TODO Auto-generated catch block
     <br/>
     <span style="white-space:pre">
     </span>
     e.printStackTrace();
     <br/>
     <span style="white-space:pre">
     </span>
     } catch (IOException e) {
     <!-- -->
     <br/>
     <span style="white-space:pre">
     </span>
     // TODO Auto-generated catch block
     <br/>
     <span style="white-space:pre">
     </span>
     System.out.println("读取异常");
     <br/>
     <span style="white-space:pre">
     </span>
     return null;
     <br/>
     <span style="white-space:pre">
     </span>
     }finally{
     <!-- -->
     <br/>
     <span style="white-space:pre">
     </span>
     try {
     <!-- -->
     <br/>
     <span style="white-space:pre">
     </span>
     httpclient.close();
     <br/>
     <span style="white-space:pre">
     </span>
     reader.close();
     <br/>
     <span style="white-space:pre">
     </span>
     } catch (IOException e) {
     <!-- -->
     <br/>
     <span style="white-space:pre">
     </span>
     // TODO Auto-generated catch block
     <br/>
     <span style="white-space:pre">
     </span>
     System.out.println("关闭资源失败");
     <br/>
     <span style="white-space:pre">
     </span>
     }
     <br/>
     <span style="white-space:pre">
     </span>
     }
     <br/>
     <span style="white-space:pre">
     </span>
     }
     <br/>
     }
     <br/>
    </p>
    <p>
     在这段代码中我们设置了代理ip,请求头中的user-agent被我们设置成谷歌浏览器的内核,这样网站会认为我们是浏览器
    </p>
    <p>
     python代码:
    </p>
    <p>
    </p>
    <pre style="background-color:#2b2b2b; color:#a9b7c6; font-family:'宋体'; font-size:15.0pt"><span style="color:#cc7832"><strong>import </strong></span>urllib.request

<span style="color:#cc7832"><strong>def </strong></span><span style="font-weight:bold">downloadHtml</span>(link):
    <span style="color:#cc7832"><strong>try</strong></span>:
        proxy = {<!-- --><span style="color:#008080">"http"</span>:<span style="color:#008080">"123.179.128.170:8080"</span>}
        proxy_support = urllib.request.ProxyHandler(proxy)
        headers = ( <span style="color:#008080">"User-Agent"</span><span style="color:#cc7832">,</span><span style="color:#008080">"Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/56.0.2924.87 Safari/537.36"</span>)
        opener = urllib.request.build_opener(proxy_support)
        opener.addheaders = [headers]</pre>
    <pre style="background-color:#2b2b2b; color:#a9b7c6; font-family:'宋体'; font-size:15.0pt"><pre style="background-color:#2b2b2b; color:#a9b7c6; font-family:'宋体'; font-size:15.0pt"><span style="background-color:#40332b"><span style="white-space:pre">	</span>opener</span> = urllib.request.build_opener(proxy_support)</pre>        data = opener.open(link).read()        text = data.decode(<span style="color:#008080">'utf-8'</span><span style="color:#cc7832">,</span><span style="color:#008080">'ignore'</span>)        <span style="color:#8888c6">print</span>(text)    <span style="color:#cc7832"><strong>except </strong></span>urllib.request.URLError <span style="color:#cc7832"><strong>as </strong></span>e:        <span style="color:#8888c6">print</span>(e.reason)<span style="color:#cc7832"><strong>def </strong></span><span style="font-weight:bold">dowmloadHtml2</span>(link):    req = urllib.request.Request(link)    req.add_header(<span style="color:#008080">"User-Agent"</span><span style="color:#cc7832">,</span><span style="color:#008080">"Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/56.0.2924.87 Safari/537.36"</span>)    data = urllib.request.urlopen(req<span style="color:#cc7832">,</span><span style="color:#aa4926">timeout</span>=<span style="color:#6897bb">1</span>).read()    text = data.decode(<span style="color:#008080">"utf-8"</span><span style="color:#cc7832">,</span><span style="color:#008080">"ignore"</span>)    <span style="color:#8888c6">print</span>(text)downloadHtml(<span style="color:#008080">"http://blog.csdn.net/weiwei_pig/article/details/51178226"</span>)</pre>
    <br/>
    <p>
    </p>
    <p>
     <span style="white-space:pre">
     </span>
    </p>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f2f:626c6f672e6373646e2e6e65742f71715f3335343838373639:2f61727469636c652f64657461696c732f3732363832303136" class_="artid" style="display:none">
 </p>
</div>


