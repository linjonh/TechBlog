---
layout: post
title: "Uipath-调用Python-脚本程序详解"
date: 2024-02-14 11:22:53 +0800
description: "文章浏览阅读3.3k次，点赞13次，本文详细介绍了UiPath中PythonActivities包的"
keywords: "uipath python"
categories: ['Uipath', 'Rpa', 'Python']
tags: ['Uipath', 'Rpa', 'Python']
artid: "136111447"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=136111447
    alt: "Uipath-调用Python-脚本程序详解"
render_with_liquid: false
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     Uipath 调用Python 脚本程序详解
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <h3>
     <strong>
      Python 活动概述
     </strong>
    </h3>
    <p>
     <strong>
      UiPath.Python.Activities 是一个新的活动包，创建它是为了支持直接从工作流运行 Python 脚本和方法。 其包含以下活动：
     </strong>
     <br/>
     Python 作用域(Python Scope) - 为 Python 活动提供作用域的容器。
     <br/>
     加载 Python 脚本(Load Python Script) - 将 Python 代码转换为 PythonObject 变量。
     <br/>
     调用 Python 方法(Invoke Python Method) - 在工作流中运行 Python 脚本中的调用指定方法。
     <br/>
     获取 Python 对象(Get Python Object) - 检索指定的 Python 脚本中使用的 .NET 类型。
     <br/>
     运行 Python 脚本(Run Python Script) - 执行 Python 代码或Python 文件。
    </p>
    <h3>
     <strong>
      Uipath 调用Python 前置条件
     </strong>
    </h3>
    <p>
     1。电脑安装Python 环境,Python 下载地址：
    </p>
    <p>
     <a href="https://www.python.org/downloads/windows/" rel="nofollow" title="Python Releases for Windows | Python.org">
      Python Releases for Windows | Python.org
     </a>
    </p>
    <p>
     注意：目前官方是支持Python3.11 及以下的低版本，建议安装Python3.10 环境
    </p>
    <p>
     选择对应的python 版本，本文的Python 环境是3.10.11
    </p>
    <p>
     2。电脑安装.Net 5.0 ,.Net 5.0 下载地址：
    </p>
    <p>
     <a href="https://dotnet.microsoft.com/zh-cn/download/dotnet/5.0" rel="nofollow" title="下载 .NET 5.0 (Linux、macOS 和 Windows)">
      下载 .NET 5.0 (Linux、macOS 和 Windows)
     </a>
    </p>
    <p>
     选择应对的操作系统下载：
    </p>
    <p>
     <img alt="" height="306" src="https://i-blog.csdnimg.cn/blog_migrate/217aca5829c13c5ebaa7c7922aec7e2f.png" width="700"/>
    </p>
    <p>
     <strong>
      <span style="color:#fe2c24;">
       注意：如果电脑没有安装.Net 5.0  在使用Uipath 调用Python 时，一直卡在Python Scope 作用域活动，没有反应，也没有报错，这时需注意是否有安装.Net5.0 SDK
      </span>
     </strong>
    </p>
    <p>
     3。如果Python 脚本有导入第三方类库，在Uipath 调用Python 前，先使用pip install 库名 安装后，再执行，否则提示 One or more errors occurred 类似错误
    </p>
    <h3>
     1.Python Activities 包安装
    </h3>
    <p>
     点击【管理程序包】，在对话窗口点击【所有包】，在查询输入框输入“python",找到uipath.python.activities包，选择后，点击【安装】，再点击【保存】，如下图所示：
    </p>
    <p>
     提示安装版本选择1.7.1 最新版本。
    </p>
    <p>
     <img alt="" height="843" src="https://i-blog.csdnimg.cn/blog_migrate/6e5ac3f95d4dc15a9bc39c7fa116f9ed.png" width="1200"/>
    </p>
    <h3>
     2. Python 作用域(Python Scope)
    </h3>
    <p>
     <strong>
      Python 作用域
     </strong>
     ”容器活动连接到计算机上安装的 Python 环境，使您能够使用其内部的其余活动。
    </p>
    <p>
     Python Scope 类似Excel Scope,需运行Excel 文件时，需将Excel 活动嵌套在Excel Scope 内。同样，需运行Python 活动时，需求Python 活动嵌套在Python Scope内。Python Scope 提供一个Python 运行环境。
    </p>
    <p>
     Python Scope 作用域功能：
    </p>
    <p>
     功能：Python Scope 活动提供作用域并初始化指定 Python 环境的容器。 当“
     <strong>
      Python 作用域
     </strong>
     ”活动结束时，系统将删除到目前为止加载的所有 Python 对象。
    </p>
    <h4>
     2.1 属性配置说明
    </h4>
    <ul id="GUID-911B2750-591D-40E3-BE62-6311A8DE870B__GUID-7927302D-9CD6-4020-85E3-D4D0F1DE59CB">
     <li id="GUID-911B2750-591D-40E3-BE62-6311A8DE870B__GUID-31890CBC-91F0-49D9-8677-E61B510C605E">
      <strong>
       库路径（Linux 或版本 &gt; 3.9）
      </strong>
      - 对于 Linux，为
      <code>
       libpython**.so
      </code>
      库的路径，包括库名称。对于 Windows（版本 &gt; 3.9），为
      <code>
       python**.dll
      </code>
      的路径，包括库名称。对于 Windows（版本 &lt;= 3.9），请将此字段留空。
     </li>
     <li id="GUID-911B2750-591D-40E3-BE62-6311A8DE870B__GUID-E2F23035-A5D9-4F23-8224-8447C29370D7">
      <strong>
       路径
      </strong>
      - Python 环境安装文件夹的路径
     </li>
     <li id="GUID-911B2750-591D-40E3-BE62-6311A8DE870B__GUID-467F263E-220B-4ECC-B72B-6E90A09A62E7">
      “
      <strong>
       目标
      </strong>
      ” - Python 运行时平台。 选择以下两个可用选项之一：x86 或 x64。
     </li>
     <li id="GUID-911B2750-591D-40E3-BE62-6311A8DE870B__GUID-5BAF97CD-3C1E-4A3F-98C3-D2C76899BF61">
      “
      <strong>
       超时
      </strong>
      ” - 在 Python 脚本终止并引发异常之前，允许其运行的时间（以秒为单位）。
     </li>
     <li id="GUID-911B2750-591D-40E3-BE62-6311A8DE870B__GUID-C1592917-B6D7-4EDC-A15F-4F95D79ABF85">
      <p>
       <strong>
        “版本”
       </strong>
       - 一个下拉列表，其中包含用于选择要使用的 Python 版本。 默认情况下，此属性设置为
       <strong>
        “自动”
       </strong>
       。
      </p>
     </li>
    </ul>
    <h4>
     2.2 示例说明
    </h4>
    <p>
     <img alt="" height="304" src="https://i-blog.csdnimg.cn/blog_migrate/593a87129b48dc64197f41609e938800.png" width="1095"/>
    </p>
    <p>
     如果系统是64位则选择X64 否则选择x86
    </p>
    <p>
     路径
     <strong>
      <span style="color:#fe2c24;">
       c:\python
      </span>
     </strong>
     是指python 的安装目录，如下图所示
    </p>
    <p>
     <img alt="" height="509" src="https://i-blog.csdnimg.cn/blog_migrate/1b808d4bfa4b8bac91a633b4618d280b.png" width="494"/>
    </p>
    <p>
     库路径，python脚本&gt;=3.10 则需设置dll路径，否则提示：
    </p>
    <p>
     Python Scope: Error initializing Python engine 类似错误
    </p>
    <p>
     工作文件夹：设置需要执行python 脚本的所在文件夹，可以为空
    </p>
    <h3>
     3. 加载Python脚本(Load Python Script)
    </h3>
    <p>
     Load Python Script功能：
    </p>
    <p>
     将 Python 脚本的处理程序存储在 PythonObject 变量中，则可以使用生成的变量来调用代码中的方法。
    </p>
    <h4>
     3.1 了解PythonObject变量类型
    </h4>
    <p>
     了解
     <code>
      PythonObject
     </code>
     变量类型，之前有使用string,datarow ,datatable 等类型，在和python 脚本数据交互时，我们需使用pythonobject变量类型。
    </p>
    <p>
     PythonObject 变量类型功能：
    </p>
    <p>
     用于处理和操作 Python 数据， 通过使用“ 加载 Python 脚本 ”活动，可以轻松地将包含 Python 脚本的任何文件中的代码分配给 PythonObject ，还可以使用“ 获取 Python 对象 ”活动将其转换为 .NET 数据类型。有了这个强大的变量，可以使用每个任务的专用活动来运行脚本、提取 .NET 类型或调用 Python 方法。
    </p>
    <h4>
     3.2 属性配置说明
    </h4>
    <ul id="GUID-423FBAA9-2F06-4D8B-8303-2880A43059FF__GUID-3535BE28-8F5A-4E07-A0ED-6250C12A9EE0">
     <li id="GUID-423FBAA9-2F06-4D8B-8303-2880A43059FF__GUID-0F0F4EBC-D150-43C3-A71E-26F2624B6275">
      <strong>
       “代码”
      </strong>
      - 要加载的 Python 代码。
     </li>
     <li id="GUID-423FBAA9-2F06-4D8B-8303-2880A43059FF__GUID-AC7BB03A-FCA4-4B3D-8B9E-E8D48FBEE324">
      “
      <strong>
       脚本
      </strong>
      ” - 包含要加载的 Python 代码的文件的路径。
     </li>
     <li id="GUID-423FBAA9-2F06-4D8B-8303-2880A43059FF__GUID-AED38408-A06B-45D7-93F7-656B42776FED">
      “
      <strong>
       结果
      </strong>
      ” - 指定 Python 脚本的处理程序，存储在
      <span style="color:#fe2c24;">
       <strong>
        <code>
         PythonObject
        </code>
       </strong>
      </span>
      变量中。
     </li>
    </ul>
    <p>
     <span style="color:#fe2c24;">
      <strong>
       注意：
      </strong>
     </span>
    </p>
    <p>
     1.代码和脚本 选项，二选一，建议使用脚本路径，便于维护。
    </p>
    <p>
     2.结果输出项: Python 脚本的处理程序存储在
     <code>
      PythonObject
     </code>
     变量类型中，创建其变量用来接收。
    </p>
    <h4>
     3.3 示例说明
    </h4>
    <p>
     如下图，创建变量python_excel_instance,用来保存Python脚本处理程序，后面其他活动需要与Python 交互时，则使用该变量则可。
    </p>
    <p>
     <img alt="" height="466" src="https://i-blog.csdnimg.cn/blog_migrate/84b0a1768944576048f3fff0993aa9e3.png" width="1200"/>
    </p>
    <p>
    </p>
    <h3>
     4. 调用Python方法(Invoke Python Method)
    </h3>
    <p>
     调用Python方法功能：
    </p>
    <p>
     在工作流中运行 Python 脚本中的调用指定方法。
    </p>
    <p>
     注意：
    </p>
    <p>
     使用调用Python方法活动时，先使用“ 加载 Python 脚本 ”活动拖拉到Python作用域内。
    </p>
    <h4>
     4.1 属性配置说明
    </h4>
    <ul id="GUID-D30A1EE4-968A-41E0-9B65-1490D5F4C54C__GUID-9DB3BD1C-2226-44F8-8C4D-F5DAE6C412F3">
     <li id="GUID-D30A1EE4-968A-41E0-9B65-1490D5F4C54C__GUID-8E09C3B2-DE04-498B-A1D0-79A275EA8937">
      “
      <strong>
       输入参数
      </strong>
      ” - 要调用的 Python 脚本的输入参数列表（如果调用python 方法有参数，则必填）。 字段仅支持
      <code>
       IEnumerable&lt;Object&gt;
      </code>
      变量。
     </li>
     <li id="GUID-D30A1EE4-968A-41E0-9B65-1490D5F4C54C__GUID-BD7C256B-9451-4FF1-8A43-1FD5B55EF6EA">
      <strong>
       实例
      </strong>
      - 包含要运行的方法的 Python 脚本，存储在
      <code>
       PythonObject
      </code>
      变量中。 字段仅支持
      <code>
       PythonObject
      </code>
      变量。
     </li>
     <li id="GUID-D30A1EE4-968A-41E0-9B65-1490D5F4C54C__GUID-A8197579-D9DD-4ED7-8C5A-80FA94BED7FE">
      “
      <strong>
       名称
      </strong>
      ” - 要调用的方法的名称。 此字段仅支持
      <code>
       String
      </code>
      变量。
     </li>
     <li id="GUID-D30A1EE4-968A-41E0-9B65-1490D5F4C54C__GUID-3366C8E0-F9C1-4A8D-8D50-8DDC3F55EDE8">
      “
      <strong>
       结果
      </strong>
      ” - 调用方法的结果，存储在
      <code>
       PythonObject
      </code>
      变量中。 可以使用“
      <strong>
       获取 Python 对象
      </strong>
      ”活动进一步处理，并将其转换为 .NET 数据类型。
     </li>
    </ul>
    <h4>
     4.2 示例说明
    </h4>
    <p>
     <img alt="" height="488" src="https://i-blog.csdnimg.cn/blog_migrate/02b344479d40ca321be34e6eb92a0311.png" width="1200"/>
    </p>
    <p>
     参数格为式 {}
    </p>
    <p>
     如{"参数名称值1”,"参数名称值2”,"参数名称值3”} 也可以使用变量，本文案例 参数值为：
    </p>
    <p>
     {in_TransactionItem("PdfFilePath"),in_str_OutputFolder,Convert.ToString(in_TransactionItem("fileName"))+".xlsx"}
    </p>
    <h3>
     5. 获取Python对象(Get Python Object)
    </h3>
    <p>
     获取Python对象功能：
    </p>
    <p>
     用于从 Python 对象获取 .NET 数据类型。Python 数据类型与Uipath 数据类型不一致，当Uipath 调用Python 脚本时，如果脚本有返回值，Uipath 需依其返回值做相关业务逻辑判断，这时需使用获取Python 对象活动。
    </p>
    <h4>
     5.1 属性配置说明
    </h4>
    <ul id="GUID-F0A73BF2-0C22-460C-A63A-A5CEDB5E9072__GUID-4E4541B9-B971-4F0A-9AB0-68C0C8CEA836">
     <li id="GUID-F0A73BF2-0C22-460C-A63A-A5CEDB5E9072__GUID-D7C738D6-878F-4304-BFEB-5F1B485E2B37">
      “
      <strong>
       Python 对象
      </strong>
      ” - 要从中提取值的 Python 对象。 此字段仅支持
      <code>
       PythonObject
      </code>
      变量。
     </li>
     <li id="GUID-F0A73BF2-0C22-460C-A63A-A5CEDB5E9072__GUID-5084E248-394C-4FEE-8ABB-CE5CE28E37AF">
      “类型
      <strong>
       参数
      </strong>
      ” - 要从
      <code>
       PythonObject
      </code>
      变量获取的 .NET 数据类型。 默认情况下，它设置为
      <code>
       Object
      </code>
      。 支持 Studio 中可用的所有数据类型。
     </li>
     <li id="GUID-F0A73BF2-0C22-460C-A63A-A5CEDB5E9072__GUID-94D64AF9-02AD-4FDF-B102-127F09741F76">
      “
      <strong>
       结果
      </strong>
      ” - 在“类型参数” 属性中选择的与
      <strong>
       Python
      </strong>
      对象对应的 .NET 类型变量。
     </li>
    </ul>
    <h4>
     5.2 示例说明
    </h4>
    <p>
     <img alt="" height="524" src="https://i-blog.csdnimg.cn/blog_migrate/e95a3d00ecfe2a1f70ca1db3415ddac0.png" width="1200"/>
    </p>
    <h3>
     6. 运行Python脚本(Run Python Script)
    </h3>
    <p>
     运行Python脚本功能：
    </p>
    <p>
     执行 Python 代码，支持代码或Python文件路径。
    </p>
    <h4>
     6.1 属性配置说明
    </h4>
    <ul id="GUID-DD9332F6-F6F4-40A4-8F1F-2CFF7A5DC4CA__GUID-4FD5C0A8-7AAD-490F-B30E-D034D6E3B75D">
     <li id="GUID-DD9332F6-F6F4-40A4-8F1F-2CFF7A5DC4CA__GUID-B2344DAF-9A8C-4243-8458-13265D0B3FC9">
      <strong>
       “代码”
      </strong>
      - 要运行的 Python 代码。 字段仅支持
      <code>
       String
      </code>
      变量。
     </li>
     <li id="GUID-DD9332F6-F6F4-40A4-8F1F-2CFF7A5DC4CA__GUID-8C80F600-283F-4C93-B3C1-05E5C6227F70">
      “
      <strong>
       文件
      </strong>
      ” - 包含要运行的 Python 代码的文件的路径。 字段仅支持
      <code>
       String
      </code>
      变量。
     </li>
    </ul>
    <h4>
     6.2 示例说明
    </h4>
    <p>
     <img alt="" height="483" src="https://i-blog.csdnimg.cn/blog_migrate/f5dfd4f4764781002b2303de7091cc91.png" width="1083"/>
    </p>
    <p>
    </p>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f2f:626c6f672e6373646e2e6e65742f4d61727368616c6a756e2f:61727469636c652f64657461696c732f313336313131343437" class_="artid" style="display:none">
 </p>
</div>


