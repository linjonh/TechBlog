---
layout: post
title: "SPI通信总线"
date: 2025-01-01 16:57:00 +0800
description: "SPI是一种高速、全双工的同步串行通信接口，常用于微处理器与外围设备间的通信。它包括4条线：CS（片"
keywords: "spi主从机模式怎么配合"
categories: ['嵌入式常见传输协议']
tags: ['嵌入式传输协议', '学习', '单片机']
artid: "126684376"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=126684376
    alt: "SPI通信总线"
render_with_liquid: false
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     SPI通信总线
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h3>
     <a id="SPI_0">
     </a>
     SPI通信总线
    </h3>
    <h4>
     <a id="_2">
     </a>
     注意
    </h4>
    <p>
     常用的内部通信接口：UART、IIC、SPI，大多数是用于芯片之间的通信，特点是速度快，距离比较短
    </p>
    <p>
     常用的外部通信接口：RS-232，RS-485，CAN，大多用于远距离传输，要求抗干扰能力强
    </p>
    <h4>
     <a id="SPI_8">
     </a>
     SPI介绍
    </h4>
    <p>
     SPI 是由摩托罗拉(Motorola)公司开发的
     <strong>
      全双工同步
     </strong>
     串行总线，是微处理控制单元(MCU)和外围设备之间进行通信的同步串行端口。主要应用在EEPROM、Flash、实时时钟(RTC)、数模转换器(ADC)、网络控制器、MCU、数字信号处理器(DSP)以及数字信号解码器之间。
    </p>
    <p>
     SPI 系统可直接与各个厂家生产的多种标准外围器件直接接口，一般使用4 条线：串行时钟线SCLK、主机输入/从机输出数据线MISO、主机输出/从机输入数据线MOSI 和低电平有效的从机选择线CS
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/a9654374e8cd22224b2059ac2818f3c7.png#pic_center"/>
    </p>
    <table>
     <thead>
      <tr>
       <th>
        通信线
       </th>
       <th>
        说明
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        CS
       </td>
       <td>
        Slave设备选择线，也叫片选线，低电平有效（有些手册又称为NSS）
       </td>
      </tr>
      <tr>
       <td>
        SCLK
       </td>
       <td>
        时钟信号，由Master产生，用于同步
       </td>
      </tr>
      <tr>
       <td>
        MOSI
       </td>
       <td>
        Master Out Slave Input，主机数据输出，从机数据输入
       </td>
      </tr>
      <tr>
       <td>
        MISO
       </td>
       <td>
        Master Input Slave Out，主机数据输入，从机数据输出
       </td>
      </tr>
     </tbody>
    </table>
    <p>
     起始信号：CS由高变低，为SPI通讯的起始信号
    </p>
    <p>
     停止信号：CS由低变高，为SPI通讯的停止信号
    </p>
    <p>
     说明: SPI总线为主从模式，起始信号由主机发出，通过CS选择与之通信的从机，停止信号也由主机发出，结束本次通信。
    </p>
    <p>
     SPI通信是主从模式，在有多个从机的情况下，从机通过拉低CS线来与主机通信，主机只能与一个从机通信，不能多从机，不然数据会混乱
    </p>
    <p>
     <strong>
      注意：MOSI和MISO不能交叉连接
     </strong>
    </p>
    <h4>
     <a id="_36">
     </a>
     通信过程
    </h4>
    <p>
     4线SPI进行通讯时
     <strong>
      首先拉低CS片选信号选中目标从机，因为SPI可以进行多机通讯
     </strong>
     ，然后
     <strong>
      SCK要产生连续的脉冲信号
     </strong>
     ，在
     <strong>
      每个SCK信号的边沿
     </strong>
     ，
     <strong>
      MISO线上的数据（高电平为1，低电平为0，电平由Slave控制）传输到主机Master
     </strong>
     ，
     <strong>
      而MOSI线上的数据（高电平为1，低电平为0，电平由Master控制）传输到从机Slave
     </strong>
    </p>
    <p>
     <strong>
      数据传输时高位在前，低位在后
     </strong>
    </p>
    <h4>
     <a id="_44">
     </a>
     通信模式
    </h4>
    <p>
     SPI共有4种通讯模式，由CPOL与CPHA控制。
    </p>
    <p>
     CPOL-&gt; 0：SCLK空闲时低电平 1：SCLK空闲时高电平
    </p>
    <p>
     CPHA-&gt;0：奇数边沿采集数据 1：偶数边沿采集数据
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/3a2fb54955b8a266ad0abebd2b5e0097.png#pic_center"/>
    </p>
    <p>
     经过CPOL和CPHA的组合，有4种模式
    </p>
    <p>
     模式0：CPOL = 0，CPHA = 0 （SCLK空闲时低电平，奇数边沿采集数据，即上升沿采集，下降沿发送）
    </p>
    <p>
     模式1：CPOL = 0，CPHA = 1 （SCLK空闲时低电平，偶数边沿采集数据，即下降沿采集，上升沿发送）
    </p>
    <p>
     模式2：CPOL = 1，CPHA = 0 （SCLK空闲时高电平，奇数边沿采集数据，即下降沿采集，上升沿发送）
    </p>
    <p>
     模式3：CPOL = 1，CPHA = 1 （SCLK空闲时高电平，偶数边沿采集数据，即上升沿采集，下降沿发送）
    </p>
    <p>
     <strong>
      注意：为了确保通讯正常，主机与从机的通讯模式需要匹配。
     </strong>
    </p>
    <p>
     如果不一致，导致的后果如下:
    </p>
    <p>
     比如主机工作在模式0(上升沿采集数据，下降沿发送数据)，从机工作在模式1(下降沿采集数据，上升沿发送)。下降沿时，主机发送数据，从机立马采集数据，此时数据不稳定，通讯失败；上升沿时，从机发送数据，主机立马采集数据，数据也不稳定，通讯也失败。
    </p>
    <p>
     <strong>
      正常通讯应该如下：
     </strong>
    </p>
    <p>
     主机处于模式0，从机处于模式3：主机下降沿发数据，从机上升沿采集数据
    </p>
    <p>
     从机处于模式0，主机处于模式3：从机下降沿发数据，主机上升沿采集数据
    </p>
    <p>
     主机处于模式1，从机处于模式2：主机上升沿发数据，从机下降沿采集数据
    </p>
    <p>
     从机处于模式1，主机处于模式2：从机上升沿发数据，主机下降沿采集数据
    </p>
    <p>
     参考：
    </p>
    <p>
     <a href="https://zhuanlan.zhihu.com/p/548826158" rel="nofollow">
      https://zhuanlan.zhihu.com/p/548826158
     </a>
    </p>
    <p>
     <a href="https://www.cnblogs.com/jiek/p/15501171.html" rel="nofollow">
      https://www.cnblogs.com/jiek/p/15501171.html
     </a>
    </p>
    <p>
     <a href="https://mp.weixin.qq.com/s/o_oYGlfGhm815sy6xNnXfw" rel="nofollow">
      https://mp.weixin.qq.com/s/o_oYGlfGhm815sy6xNnXfw
     </a>
    </p>
    <p>
     <a href="https://mp.weixin.qq.com/s/g2bGmGmI2DTbOmLIlkBiTABiTA" rel="nofollow">
      https://mp.weixin.qq.com/s/g2bGmGmI2DTbOmLIlkBiTABiTA
     </a>
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f672e:6373646e2e6e65742f77656978696e5f34363235313233302f:61727469636c652f64657461696c732f313236363834333736" class_="artid" style="display:none">
 </p>
</div>


