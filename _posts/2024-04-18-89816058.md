---
layout: post
title: "深度通信网络专栏2自编码器无信道模型的通信系统端到端学习"
date: 2024-04-18 17:24:28 +0800
description: "本文地址：https://arxiv.org/abs/1804.02276前言深度通信网络专栏|自编"
keywords: "基于自编码器的端到端无线通信系统设计代码"
categories: ["未分类"]
tags: ["自编码器", "端到端", "深度学习", "强化学习"]
artid: "89816058"
image:
  path: https://api.vvhan.com/api/bing?rand=sj&artid=89816058
  alt: "深度通信网络专栏2自编码器无信道模型的通信系统端到端学习"
render_with_liquid: false
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     深度通信网络专栏（2）|自编码器：无信道模型的通信系统端到端学习
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-light" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
     本文地址：https://arxiv.org/abs/1804.02276
     <br/>
    </p>
    <div class="toc">
     <h4>
      文章目录
     </h4>
     <ul>
      <li>
       <ul>
        <li>
         <a href="#_3" rel="nofollow">
          前言
         </a>
        </li>
        <li>
         <a href="#_5" rel="nofollow">
          文章中心思想
         </a>
        </li>
        <li>
         <a href="#_14" rel="nofollow">
          一点说明
         </a>
        </li>
        <li>
         <a href="#_24" rel="nofollow">
          全文概述
         </a>
        </li>
        <li>
         <ul>
          <li>
           <a href="#_25" rel="nofollow">
            系统模型
           </a>
          </li>
          <li>
           <a href="#_47" rel="nofollow">
            训练流程
           </a>
          </li>
          <li>
           <ul>
            <li>
             <a href="#_51" rel="nofollow">
              接收端训练
             </a>
            </li>
            <li>
             <a href="#_61" rel="nofollow">
              发送端训练
             </a>
            </li>
           </ul>
          </li>
         </ul>
        </li>
        <li>
         <a href="#_82" rel="nofollow">
          仿真结果
         </a>
        </li>
        <li>
         <a href="#_86" rel="nofollow">
          我的理解
         </a>
        </li>
       </ul>
      </li>
     </ul>
    </div>
    <p>
    </p>
    <h3>
     <a id="_3">
     </a>
     前言
    </h3>
    <p>
     <strong>
      深度通信网络专栏|自编码器:
     </strong>
     整理2018-2019年使用神经网络实现通信系统自编码器的论文，一点拙见，如有偏颇，望不吝赐教，顺颂时祺。
    </p>
    <h3>
     <a id="_5">
     </a>
     文章中心思想
    </h3>
    <p>
     原来的自编码器采用监督学习，需要一个可微分的信道模型，信道函数必须已知，这种情况下训练出来的模型，如要应用，实际信道应该与训练时的信道相近。为保证性能，现常常采用线下训练，线上微调的方式（即应用时，接收端根据接收的数据微调模型参数），这带来的缺点是发送端不可再微调，得到的仅是次优解。
    </p>
    <p>
     事实上，信道对我们而言只是一个黑匣子，我们只能观测输入输出，我们
     <strong>
      并不总能得到一个可微的信道模型
     </strong>
     。为解决这一问题，本文作者提出了
     <strong>
      迭代优化接收端和发送端的自编码器，其中接收端使用监督学习，发送端使用强化学习
     </strong>
     。这一方法中，发送端的强化学习是基于损失函数的梯度来优化，使用
     <strong>
      policy learning
     </strong>
     ，
     <strong>
      无需知道信道梯度
     </strong>
     。由于这一方法不需要知道信道模型，因此能在实际信道中直接训练。
    </p>
    <p>
     与
     <strong>
      将发送端、信道、接收端看作一个NN
     </strong>
     的全监督学习算法对比，本文提出的迭代算法能达到几乎一样的性能，且在瑞利信道下收敛更快。这一结果表明：
     <strong>
      信道模型和信道传递函数不是必要的，自编码器可以仅仅根据观测数据进行训练。
     </strong>
    </p>
    <blockquote>
     <p>
      原文结论：Our results are a first step towards learning of communications systems
      <strong>
       over any type of channel without prior assumptions
      </strong>
     </p>
    </blockquote>
    <h3>
     <a id="_14">
     </a>
     一点说明
    </h3>
    <ul>
     <li>
      为了使读者更好地理解
      <strong>
       发送端使用强化学习训练避免了信道函数未知的情况
      </strong>
      ，这里先做一个粗浅的说明
     </li>
     <li>
      policy learning参考： ①
      <a href="https://www.ibm.com/developerworks/cn/analytics/library/ba-lo-deep-introduce-policy-gradient/index.html" rel="nofollow">
       深入浅出介绍策略梯度 - IBM
      </a>
      ②
      <a href="https://bluefisher.github.io/2018/05/10/%E7%AD%96%E7%95%A5%E6%A2%AF%E5%BA%A6-Policy-Gradient/" rel="nofollow">
       策略梯度
      </a>
     </li>
    </ul>
    <p>
     <img alt="强化学习的结构" src="https://i-blog.csdnimg.cn/blog_migrate/46cf99d11d6e7a68addbcbf5d225f200.png">
      <br/>
      上图为强化学习的基本构成，在本文中，state对应输入数据m，reward对应接收端反馈的损失loss，agent对应输入端神经网络，action对应输入到信道的码字，environment对应
      <strong>
       信道-参数固定的接收端神经网络
      </strong>
      （注：在训练发送端时，接收端神经网络参数固定）。在迭代训练中，下一状态依旧为S
      <sub>
       t+1
      </sub>
      依旧为提供给神经网络的输入m。也就是说，每一组训练数据会迭代N次，直到满足迭代终止条件，再输入给神经网络一组新的数据进行训练。
     </img>
    </p>
    <p>
     从上面的说明可以看出，
     <strong>
      发送神经网络的训练与environment的具体形式无关
     </strong>
     ，也就是说我不需要知道信道的函数，只要你给我reward和state，我的agent就可以给出对应的action，使得reward最大（loss最小）。那么问题就是，发送端的参数是如何更新的？（如果使用我们熟知的监督学习，loss直接对θt求导来更新θt，必然涉及信道函数），
     <strong>
      这就引入了policy learning
     </strong>
     ：
     <br/>
     <img alt="" src="https://i-blog.csdnimg.cn/blog_migrate/52a1a89b7bda81eb06827f7d21f48751.png">
      <br/>
      从上图（截图来自
      <a href="https://bluefisher.github.io/2018/05/10/%E7%AD%96%E7%95%A5%E6%A2%AF%E5%BA%A6-Policy-Gradient/" rel="nofollow">
       策略梯度
      </a>
      ）可以看出，策略目标函数是
      <strong>
       奖励与策略函数的乘积
      </strong>
      （大体上先这样理解），这里奖励对应于接收端反馈的loss，对于每一次训练是一个具体的数值，而策略函数可以暂时粗浅地理解为我们要训练的输入端神经网络（要学习的编码方式即是策略）。因此根据策略目标函数更新策略函数的参数只与策略函数有关，并不涉及信道函数。
     </img>
    </p>
    <h3>
     <a id="_24">
     </a>
     全文概述
    </h3>
    <h4>
     <a id="_25">
     </a>
     系统模型
    </h4>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/e53c1539107ef5b2cbbc46dfd394c146.png">
      <br/>
      本文用两个独立的网络来实现发送端和接收端，这两个网络联合迭代优化，使得整体性能最佳。
     </img>
    </p>
    <p>
     <strong>
      发送端的神经网络（见Fig3 a）可表示为：
     </strong>
     <span class="katex--display">
      <span class="katex-display">
       <span class="katex">
        <span class="katex-mathml">
         f 
          
          
          
            θ 
           
          
            T 
           
          
          
          
            ( 
           
          
            T 
           
          
            ) 
           
          
         
        
          : 
         
        
          M 
         
        
          → 
         
         
         
           C 
          
         
           N 
          
         
        
       
         f_{\boldsymbol{\theta}_{T}}^{(T)} : \mathbb{M} \rightarrow \mathbb{C}^{N}
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 1.44641em; vertical-align: -0.401613em;">
          </span>
          <span class="mord">
           <span class="mord mathdefault" style="margin-right: 0.10764em;">
            f
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 1.0448em;">
               <span class="" style="top: -2.39869em; margin-left: -0.10764em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mtight">
                   <span class="mord mtight">
                    <span class="mord mtight">
                     <span class="mord boldsymbol mtight" style="margin-right: 0.03194em;">
                      θ
                     </span>
                    </span>
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.3448em;">
                       <span class="" style="top: -2.35671em; margin-right: 0.0714286em;">
                        <span class="pstrut" style="height: 2.5em;">
                        </span>
                        <span class="sizing reset-size3 size1 mtight">
                         <span class="mord mtight">
                          <span class="mord mathdefault mtight" style="margin-right: 0.13889em;">
                           T
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       ​
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.143293em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
               <span class="" style="top: -3.2198em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mopen mtight">
                   (
                  </span>
                  <span class="mord mathdefault mtight" style="margin-right: 0.13889em;">
                   T
                  </span>
                  <span class="mclose mtight">
                   )
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               ​
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.401613em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mspace" style="margin-right: 0.277778em;">
          </span>
          <span class="mrel">
           :
          </span>
          <span class="mspace" style="margin-right: 0.277778em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 0.68889em; vertical-align: 0em;">
          </span>
          <span class="mord">
           <span class="mord mathbb">
            M
           </span>
          </span>
          <span class="mspace" style="margin-right: 0.277778em;">
          </span>
          <span class="mrel">
           →
          </span>
          <span class="mspace" style="margin-right: 0.277778em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 0.891331em; vertical-align: 0em;">
          </span>
          <span class="mord">
           <span class="mord">
            <span class="mord mathbb">
             C
            </span>
           </span>
           <span class="msupsub">
            <span class="vlist-t">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.891331em;">
               <span class="" style="top: -3.113em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mathdefault mtight" style="margin-right: 0.10903em;">
                   N
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
    </p>
    <ul>
     <li>
      发送端的normalization保证每个符号的平均功率为1
     </li>
     <li>
      输入数据m采用one hot编码
     </li>
    </ul>
    <p>
     <strong>
      接收端的神经网络（见Fig3 b）可表示为：
     </strong>
     <span class="katex--display">
      <span class="katex-display">
       <span class="katex">
        <span class="katex-mathml">
         f 
          
          
          
            θ 
           
          
            R 
           
          
          
          
            ( 
           
          
            R 
           
          
            ) 
           
          
         
        
          : 
         
         
         
           C 
          
         
           N 
          
         
        
          → 
         
         
         
           { 
          
         
           p 
          
         
           ∈ 
          
          
          
            R 
           
          
            + 
           
          
            M 
           
          
         
           ∣ 
          
          
          
            ∑ 
           
           
           
             i 
            
           
             = 
            
           
             1 
            
           
          
            M 
           
          
          
          
            p 
           
          
            i 
           
          
         
           = 
          
         
           1 
          
         
           } 
          
         
        
       
         f_{\boldsymbol{\theta}_{R}}^{(R)} : \mathbb{C}^{N} \rightarrow\left\{\mathbf{p} \in \mathbb{R}_{+}^{M} | \sum_{i=1}^{M} p_{i}=1\right\}
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 1.44641em; vertical-align: -0.401613em;">
          </span>
          <span class="mord">
           <span class="mord mathdefault" style="margin-right: 0.10764em;">
            f
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 1.0448em;">
               <span class="" style="top: -2.39869em; margin-left: -0.10764em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mtight">
                   <span class="mord mtight">
                    <span class="mord mtight">
                     <span class="mord boldsymbol mtight" style="margin-right: 0.03194em;">
                      θ
                     </span>
                    </span>
                   </span>
                   <span class="msupsub">
                    <span class="vlist-t vlist-t2">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.3448em;">
                       <span class="" style="top: -2.35671em; margin-right: 0.0714286em;">
                        <span class="pstrut" style="height: 2.5em;">
                        </span>
                        <span class="sizing reset-size3 size1 mtight">
                         <span class="mord mtight">
                          <span class="mord mathdefault mtight" style="margin-right: 0.00773em;">
                           R
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="vlist-s">
                       ​
                      </span>
                     </span>
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.143293em;">
                       <span class="">
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
               <span class="" style="top: -3.2198em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mopen mtight">
                   (
                  </span>
                  <span class="mord mathdefault mtight" style="margin-right: 0.00773em;">
                   R
                  </span>
                  <span class="mclose mtight">
                   )
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               ​
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.401613em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mspace" style="margin-right: 0.277778em;">
          </span>
          <span class="mrel">
           :
          </span>
          <span class="mspace" style="margin-right: 0.277778em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 0.891331em; vertical-align: 0em;">
          </span>
          <span class="mord">
           <span class="mord">
            <span class="mord mathbb">
             C
            </span>
           </span>
           <span class="msupsub">
            <span class="vlist-t">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.891331em;">
               <span class="" style="top: -3.113em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mathdefault mtight" style="margin-right: 0.10903em;">
                   N
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mspace" style="margin-right: 0.277778em;">
          </span>
          <span class="mrel">
           →
          </span>
          <span class="mspace" style="margin-right: 0.277778em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 3.10601em; vertical-align: -1.27767em;">
          </span>
          <span class="minner">
           <span class="mopen delimcenter" style="top: 0em;">
            <span class="delimsizing size4">
             {
             <!-- -->
            </span>
           </span>
           <span class="mord">
            <span class="mord mathbf">
             p
            </span>
           </span>
           <span class="mspace" style="margin-right: 0.277778em;">
           </span>
           <span class="mrel">
            ∈
           </span>
           <span class="mspace" style="margin-right: 0.277778em;">
           </span>
           <span class="mord">
            <span class="mord">
             <span class="mord mathbb">
              R
             </span>
            </span>
            <span class="msupsub">
             <span class="vlist-t vlist-t2">
              <span class="vlist-r">
               <span class="vlist" style="height: 0.891331em;">
                <span class="" style="top: -2.453em; margin-right: 0.05em;">
                 <span class="pstrut" style="height: 2.7em;">
                 </span>
                 <span class="sizing reset-size6 size3 mtight">
                  <span class="mord mtight">
                   <span class="mord mtight">
                    +
                   </span>
                  </span>
                 </span>
                </span>
                <span class="" style="top: -3.113em; margin-right: 0.05em;">
                 <span class="pstrut" style="height: 2.7em;">
                 </span>
                 <span class="sizing reset-size6 size3 mtight">
                  <span class="mord mtight">
                   <span class="mord mathdefault mtight" style="margin-right: 0.10903em;">
                    M
                   </span>
                  </span>
                 </span>
                </span>
               </span>
               <span class="vlist-s">
                ​
               </span>
              </span>
              <span class="vlist-r">
               <span class="vlist" style="height: 0.305331em;">
                <span class="">
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
           <span class="mord">
            ∣
           </span>
           <span class="mspace" style="margin-right: 0.166667em;">
           </span>
           <span class="mop op-limits">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 1.82834em;">
               <span class="" style="top: -1.87233em; margin-left: 0em;">
                <span class="pstrut" style="height: 3.05em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mathdefault mtight">
                   i
                  </span>
                  <span class="mrel mtight">
                   =
                  </span>
                  <span class="mord mtight">
                   1
                  </span>
                 </span>
                </span>
               </span>
               <span class="" style="top: -3.05001em;">
                <span class="pstrut" style="height: 3.05em;">
                </span>
                <span class="">
                 <span class="mop op-symbol large-op">
                  ∑
                 </span>
                </span>
               </span>
               <span class="" style="top: -4.30001em; margin-left: 0em;">
                <span class="pstrut" style="height: 3.05em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mathdefault mtight" style="margin-right: 0.10903em;">
                   M
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               ​
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 1.27767em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
           <span class="mspace" style="margin-right: 0.166667em;">
           </span>
           <span class="mord">
            <span class="mord mathdefault">
             p
            </span>
            <span class="msupsub">
             <span class="vlist-t vlist-t2">
              <span class="vlist-r">
               <span class="vlist" style="height: 0.311664em;">
                <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                 <span class="pstrut" style="height: 2.7em;">
                 </span>
                 <span class="sizing reset-size6 size3 mtight">
                  <span class="mord mtight">
                   <span class="mord mathdefault mtight">
                    i
                   </span>
                  </span>
                 </span>
                </span>
               </span>
               <span class="vlist-s">
                ​
               </span>
              </span>
              <span class="vlist-r">
               <span class="vlist" style="height: 0.15em;">
                <span class="">
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
           <span class="mspace" style="margin-right: 0.277778em;">
           </span>
           <span class="mrel">
            =
           </span>
           <span class="mspace" style="margin-right: 0.277778em;">
           </span>
           <span class="mord">
            1
           </span>
           <span class="mclose delimcenter" style="top: 0em;">
            <span class="delimsizing size4">
             }
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
    </p>
    <ul>
     <li>
      接收神经网络根据接收的数据
      <strong>
       y
      </strong>
      输出预测的条件概率p(m|
      <strong>
       y
      </strong>
      )。softmax输出的是软信息p(m|
      <strong>
       y
      </strong>
      )，通过argmax进行硬判。
     </li>
     <li>
      更新参数
      <strong>
       θ
       <sub>
        R
       </sub>
      </strong>
      ，使交叉熵（cross entropy，CE）最小，（假设训练样本独立相同分布，S是训练集的大小）
      <span class="katex--display">
       <span class="katex-display">
        <span class="katex">
         <span class="katex-mathml">
          θ 
           
          
            R 
           
          
            ∗ 
           
          
         
           = 
          
          
           
           
             arg 
            
           
             ⁡ 
            
           
             min 
            
           
             ⁡ 
            
           
           
           
             θ 
            
           
             R 
            
           
          
         
           L 
          
          
          
            ( 
           
           
           
             θ 
            
           
             R 
            
           
          
            ) 
           
          
         
        
          \boldsymbol{\theta}_{R}^{*}=\underset{\boldsymbol{\theta}_{R}}{\arg \min } L\left(\boldsymbol{\theta}_{R}\right)
         </span>
         <span class="katex-html">
          <span class="base">
           <span class="strut" style="height: 1.02004em; vertical-align: -0.247em;">
           </span>
           <span class="mord">
            <span class="mord">
             <span class="mord">
              <span class="mord boldsymbol" style="margin-right: 0.03194em;">
               θ
              </span>
             </span>
            </span>
            <span class="msupsub">
             <span class="vlist-t vlist-t2">
              <span class="vlist-r">
               <span class="vlist" style="height: 0.773036em;">
                <span class="" style="top: -2.453em; margin-right: 0.05em;">
                 <span class="pstrut" style="height: 2.7em;">
                 </span>
                 <span class="sizing reset-size6 size3 mtight">
                  <span class="mord mtight">
                   <span class="mord mathdefault mtight" style="margin-right: 0.00773em;">
                    R
                   </span>
                  </span>
                 </span>
                </span>
                <span class="" style="top: -3.14734em; margin-right: 0.05em;">
                 <span class="pstrut" style="height: 2.7em;">
                 </span>
                 <span class="sizing reset-size6 size3 mtight">
                  <span class="mord mtight">
                   <span class="mord mtight">
                    ∗
                   </span>
                  </span>
                 </span>
                </span>
               </span>
               <span class="vlist-s">
                ​
               </span>
              </span>
              <span class="vlist-r">
               <span class="vlist" style="height: 0.247em;">
                <span class="">
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
           <span class="mspace" style="margin-right: 0.277778em;">
           </span>
           <span class="mrel">
            =
           </span>
           <span class="mspace" style="margin-right: 0.277778em;">
           </span>
          </span>
          <span class="base">
           <span class="strut" style="height: 1.79685em; vertical-align: -1.04685em;">
           </span>
           <span class="mord">
            <span class="mop op-limits">
             <span class="vlist-t vlist-t2">
              <span class="vlist-r">
               <span class="vlist" style="height: 0.66786em;">
                <span class="" style="top: -1.85345em; margin-left: 0em;">
                 <span class="pstrut" style="height: 2.7em;">
                 </span>
                 <span class="sizing reset-size6 size3 mtight">
                  <span class="mord mtight">
                   <span class="mord mtight">
                    <span class="mord mtight">
                     <span class="mord mtight">
                      <span class="mord boldsymbol mtight" style="margin-right: 0.03194em;">
                       θ
                      </span>
                     </span>
                    </span>
                    <span class="msupsub">
                     <span class="vlist-t vlist-t2">
                      <span class="vlist-r">
                       <span class="vlist" style="height: 0.3448em;">
                        <span class="" style="top: -2.35671em; margin-right: 0.0714286em;">
                         <span class="pstrut" style="height: 2.5em;">
                         </span>
                         <span class="sizing reset-size3 size1 mtight">
                          <span class="mord mtight">
                           <span class="mord mathdefault mtight" style="margin-right: 0.00773em;">
                            R
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                       <span class="vlist-s">
                        ​
                       </span>
                      </span>
                      <span class="vlist-r">
                       <span class="vlist" style="height: 0.143293em;">
                        <span class="">
                        </span>
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
                <span class="" style="top: -2.7em;">
                 <span class="pstrut" style="height: 2.7em;">
                 </span>
                 <span class="">
                  <span class="mop">
                   <span class="mop">
                    ar
                    <span style="margin-right: 0.01389em;">
                     g
                    </span>
                   </span>
                   <span class="mspace" style="margin-right: 0.166667em;">
                   </span>
                   <span class="mop">
                    min
                   </span>
                  </span>
                 </span>
                </span>
               </span>
               <span class="vlist-s">
                ​
               </span>
              </span>
              <span class="vlist-r">
               <span class="vlist" style="height: 1.04685em;">
                <span class="">
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
           <span class="mord mathdefault">
            L
           </span>
           <span class="mspace" style="margin-right: 0.166667em;">
           </span>
           <span class="minner">
            <span class="mopen delimcenter" style="top: 0em;">
             (
            </span>
            <span class="mord">
             <span class="mord">
              <span class="mord">
               <span class="mord boldsymbol" style="margin-right: 0.03194em;">
                θ
               </span>
              </span>
             </span>
             <span class="msupsub">
              <span class="vlist-t vlist-t2">
               <span class="vlist-r">
                <span class="vlist" style="height: 0.328331em;">
                 <span class="" style="top: -2.55em; margin-right: 0.05em;">
                  <span class="pstrut" style="height: 2.7em;">
                  </span>
                  <span class="sizing reset-size6 size3 mtight">
                   <span class="mord mtight">
                    <span class="mord mathdefault mtight" style="margin-right: 0.00773em;">
                     R
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
                <span class="vlist-s">
                 ​
                </span>
               </span>
               <span class="vlist-r">
                <span class="vlist" style="height: 0.15em;">
                 <span class="">
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
            <span class="mclose delimcenter" style="top: 0em;">
             )
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </li>
    </ul>
    <p>
     <span class="katex--display">
      <span class="katex-display">
       <span class="katex">
        <span class="katex-mathml">
         L 
         
         
         
           ( 
          
          
          
            θ 
           
          
            R 
           
          
         
           ) 
          
         
        
          = 
         
         
         
           1 
          
         
           S 
          
         
         
         
           ∑ 
          
          
          
            i 
           
          
            = 
           
          
            1 
           
          
         
           S 
          
         
         
          
           
           
             − 
            
           
             log 
            
           
             ⁡ 
            
            
            
              ( 
             
             
              
              
                [ 
               
               
               
                 f 
                
                
                
                  θ 
                 
                
                  R 
                 
                
                
                
                  ( 
                 
                
                  R 
                 
                
                  ) 
                 
                
               
               
               
                 ( 
                
                
                
                  y 
                 
                 
                 
                   ( 
                  
                 
                   i 
                  
                 
                   ) 
                  
                 
                
               
                 ) 
                
               
              
                ] 
               
              
              
              
                m 
               
               
               
                 ( 
                
               
                 i 
                
               
                 ) 
                
               
              
             
            
              ) 
             
            
           
          
            ⏟ 
           
          
          
          
            l 
           
           
           
             ( 
            
           
             i 
            
           
             ) 
            
           
          
         
        
       
         L\left(\boldsymbol{\theta}_{R}\right)=\frac{1}{S} \sum_{i=1}^{S} \underbrace{-\log \left(\left[f_{\boldsymbol{\theta}_{R}}^{(R)}\left(\mathbf{y}^{(i)}\right)\right]_{m^{(i)}}\right)}_{l^{(i)}}
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 1em; vertical-align: -0.25em;">
          </span>
          <span class="mord mathdefault">
           L
          </span>
          <span class="mspace" style="margin-right: 0.166667em;">
          </span>
          <span class="minner">
           <span class="mopen delimcenter" style="top: 0em;">
            (
           </span>
           <span class="mord">
            <span class="mord">
             <span class="mord">
              <span class="mord boldsymbol" style="margin-right: 0.03194em;">
               θ
              </span>
             </span>
            </span>
            <span class="msupsub">
             <span class="vlist-t vlist-t2">
              <span class="vlist-r">
               <span class="vlist" style="height: 0.328331em;">
                <span class="" style="top: -2.55em; margin-right: 0.05em;">
                 <span class="pstrut" style="height: 2.7em;">
                 </span>
                 <span class="sizing reset-size6 size3 mtight">
                  <span class="mord mtight">
                   <span class="mord mathdefault mtight" style="margin-right: 0.00773em;">
                    R
                   </span>
                  </span>
                 </span>
                </span>
               </span>
               <span class="vlist-s">
                ​
               </span>
              </span>
              <span class="vlist-r">
               <span class="vlist" style="height: 0.15em;">
                <span class="">
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
           <span class="mclose delimcenter" style="top: 0em;">
            )
           </span>
          </span>
          <span class="mspace" style="margin-right: 0.277778em;">
          </span>
          <span class="mrel">
           =
          </span>
          <span class="mspace" style="margin-right: 0.277778em;">
          </span>
         </span>
         <span class="base">
          <span class="strut" style="height: 3.95148em; vertical-align: -2.12315em;">
          </span>
          <span class="mord">
           <span class="mopen nulldelimiter">
           </span>
           <span class="mfrac">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 1.32144em;">
               <span class="" style="top: -2.314em;">
                <span class="pstrut" style="height: 3em;">
                </span>
                <span class="mord">
                 <span class="mord mathdefault" style="margin-right: 0.05764em;">
                  S
                 </span>
                </span>
               </span>
               <span class="" style="top: -3.23em;">
                <span class="pstrut" style="height: 3em;">
                </span>
                <span class="frac-line" style="border-bottom-width: 0.04em;">
                </span>
               </span>
               <span class="" style="top: -3.677em;">
                <span class="pstrut" style="height: 3em;">
                </span>
                <span class="mord">
                 <span class="mord">
                  1
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               ​
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.686em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
           <span class="mclose nulldelimiter">
           </span>
          </span>
          <span class="mspace" style="margin-right: 0.166667em;">
          </span>
          <span class="mop op-limits">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 1.82834em;">
              <span class="" style="top: -1.87233em; margin-left: 0em;">
               <span class="pstrut" style="height: 3.05em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathdefault mtight">
                  i
                 </span>
                 <span class="mrel mtight">
                  =
                 </span>
                 <span class="mord mtight">
                  1
                 </span>
                </span>
               </span>
              </span>
              <span class="" style="top: -3.05001em;">
               <span class="pstrut" style="height: 3.05em;">
               </span>
               <span class="">
                <span class="mop op-symbol large-op">
                 ∑
                </span>
               </span>
              </span>
              <span class="" style="top: -4.30001em; margin-left: 0em;">
               <span class="pstrut" style="height: 3.05em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathdefault mtight" style="margin-right: 0.05764em;">
                  S
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 1.27767em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mspace" style="margin-right: 0.166667em;">
          </span>
          <span class="mord munder">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 1.15em;">
              <span class="" style="top: -1.02685em;">
               <span class="pstrut" style="height: 3.15em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mtight">
                  <span class="mord mathdefault mtight" style="margin-right: 0.01968em;">
                   l
                  </span>
                  <span class="msupsub">
                   <span class="vlist-t">
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.822036em;">
                      <span class="" style="top: -2.82204em; margin-right: 0.0714286em;">
                       <span class="pstrut" style="height: 2.53571em;">
                       </span>
                       <span class="sizing reset-size3 size1 mtight">
                        <span class="mord mtight">
                         <span class="mopen mtight">
                          (
                         </span>
                         <span class="mord mathdefault mtight">
                          i
                         </span>
                         <span class="mclose mtight">
                          )
                         </span>
                        </span>
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="" style="top: -3.15em;">
               <span class="pstrut" style="height: 3.15em;">
               </span>
               <span class="mord munder">
                <span class="vlist-t vlist-t2">
                 <span class="vlist-r">
                  <span class="vlist" style="height: 1.15em;">
                   <span class="svg-align" style="top: -1.80228em;">
                    <span class="pstrut" style="height: 3.15em;">
                    </span>
                    <span class="stretchy" style="height: 0.548em; min-width: 1.6em;">
                     <span class="brace-left" style="height: 0.548em;">
                      <svg height="0.548em" preserveaspectratio="xMinYMin slice" viewbox="0 0 400000 548" width="400em">
                       <path d="M0 6l6-6h17c12.688 0 19.313.3 20 1 4 4 7.313 8.3 10 13
 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688
 0 2 .3 4 1 18.688 2.7 76 4.3 172 5h399450v120H429l-6-1c-124.688-8-235-61.7
-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z">
                       </path>
                      </svg>
                     </span>
                     <span class="brace-center" style="height: 0.548em;">
                      <svg height="0.548em" preserveaspectratio="xMidYMin slice" viewbox="0 0 400000 548" width="400em">
                       <path d="M199572 214
c100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14
 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62h199568v120H200432c-178.3
 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3 0
-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z">
                       </path>
                      </svg>
                     </span>
                     <span class="brace-right" style="height: 0.548em;">
                      <svg height="0.548em" preserveaspectratio="xMaxYMin slice" viewbox="0 0 400000 548" width="400em">
                       <path d="M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3
 28.7-117 45-179 50H-300V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237
-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z">
                       </path>
                      </svg>
                     </span>
                    </span>
                   </span>
                   <span class="" style="top: -3.15em;">
                    <span class="pstrut" style="height: 3.15em;">
                    </span>
                    <span class="mord">
                     <span class="mord">
                      −
                     </span>
                     <span class="mspace" style="margin-right: 0.166667em;">
                     </span>
                     <span class="mop">
                      lo
                      <span style="margin-right: 0.01389em;">
                       g
                      </span>
                     </span>
                     <span class="mspace" style="margin-right: 0.166667em;">
                     </span>
                     <span class="minner">
                      <span class="mopen delimcenter" style="top: 0em;">
                       <span class="delimsizing size2">
                        (
                       </span>
                      </span>
                      <span class="minner">
                       <span class="minner">
                        <span class="mopen delimcenter" style="top: 0em;">
                         <span class="delimsizing size2">
                          [
                         </span>
                        </span>
                        <span class="mord">
                         <span class="mord mathdefault" style="margin-right: 0.10764em;">
                          f
                         </span>
                         <span class="msupsub">
                          <span class="vlist-t vlist-t2">
                           <span class="vlist-r">
                            <span class="vlist" style="height: 1.0448em;">
                             <span class="" style="top: -2.39869em; margin-left: -0.10764em; margin-right: 0.05em;">
                              <span class="pstrut" style="height: 2.7em;">
                              </span>
                              <span class="sizing reset-size6 size3 mtight">
                               <span class="mord mtight">
                                <span class="mord mtight">
                                 <span class="mord mtight">
                                  <span class="mord mtight">
                                   <span class="mord boldsymbol mtight" style="margin-right: 0.03194em;">
                                    θ
                                   </span>
                                  </span>
                                 </span>
                                 <span class="msupsub">
                                  <span class="vlist-t vlist-t2">
                                   <span class="vlist-r">
                                    <span class="vlist" style="height: 0.3448em;">
                                     <span class="" style="top: -2.35671em; margin-right: 0.0714286em;">
                                      <span class="pstrut" style="height: 2.5em;">
                                      </span>
                                      <span class="sizing reset-size3 size1 mtight">
                                       <span class="mord mtight">
                                        <span class="mord mathdefault mtight" style="margin-right: 0.00773em;">
                                         R
                                        </span>
                                       </span>
                                      </span>
                                     </span>
                                    </span>
                                    <span class="vlist-s">
                                     ​
                                    </span>
                                   </span>
                                   <span class="vlist-r">
                                    <span class="vlist" style="height: 0.143293em;">
                                     <span class="">
                                     </span>
                                    </span>
                                   </span>
                                  </span>
                                 </span>
                                </span>
                               </span>
                              </span>
                             </span>
                             <span class="" style="top: -3.2198em; margin-right: 0.05em;">
                              <span class="pstrut" style="height: 2.7em;">
                              </span>
                              <span class="sizing reset-size6 size3 mtight">
                               <span class="mord mtight">
                                <span class="mopen mtight">
                                 (
                                </span>
                                <span class="mord mathdefault mtight" style="margin-right: 0.00773em;">
                                 R
                                </span>
                                <span class="mclose mtight">
                                 )
                                </span>
                               </span>
                              </span>
                             </span>
                            </span>
                            <span class="vlist-s">
                             ​
                            </span>
                           </span>
                           <span class="vlist-r">
                            <span class="vlist" style="height: 0.401613em;">
                             <span class="">
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                        </span>
                        <span class="mspace" style="margin-right: 0.166667em;">
                        </span>
                        <span class="minner">
                         <span class="mopen delimcenter" style="top: 0em;">
                          <span class="delimsizing size2">
                           (
                          </span>
                         </span>
                         <span class="mord">
                          <span class="mord">
                           <span class="mord mathbf" style="margin-right: 0.01597em;">
                            y
                           </span>
                          </span>
                          <span class="msupsub">
                           <span class="vlist-t">
                            <span class="vlist-r">
                             <span class="vlist" style="height: 0.938em;">
                              <span class="" style="top: -3.113em; margin-right: 0.05em;">
                               <span class="pstrut" style="height: 2.7em;">
                               </span>
                               <span class="sizing reset-size6 size3 mtight">
                                <span class="mord mtight">
                                 <span class="mopen mtight">
                                  (
                                 </span>
                                 <span class="mord mathdefault mtight">
                                  i
                                 </span>
                                 <span class="mclose mtight">
                                  )
                                 </span>
                                </span>
                               </span>
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                         <span class="mclose delimcenter" style="top: 0em;">
                          <span class="delimsizing size2">
                           )
                          </span>
                         </span>
                        </span>
                        <span class="mclose delimcenter" style="top: 0em;">
                         <span class="delimsizing size2">
                          ]
                         </span>
                        </span>
                       </span>
                       <span class="msupsub">
                        <span class="vlist-t vlist-t2">
                         <span class="vlist-r">
                          <span class="vlist">
                           <span class="" style="top: -2.00028em; margin-right: 0.05em;">
                            <span class="pstrut" style="height: 2.7em;">
                            </span>
                            <span class="sizing reset-size6 size3 mtight">
                             <span class="mord mtight">
                              <span class="mord mtight">
                               <span class="mord mathdefault mtight">
                                m
                               </span>
                               <span class="msupsub">
                                <span class="vlist-t">
                                 <span class="vlist-r">
                                  <span class="vlist" style="height: 0.822036em;">
                                   <span class="" style="top: -2.82204em; margin-right: 0.0714286em;">
                                    <span class="pstrut" style="height: 2.53571em;">
                                    </span>
                                    <span class="sizing reset-size3 size1 mtight">
                                     <span class="mord mtight">
                                      <span class="mopen mtight">
                                       (
                                      </span>
                                      <span class="mord mathdefault mtight">
                                       i
                                      </span>
                                      <span class="mclose mtight">
                                       )
                                      </span>
                                     </span>
                                    </span>
                                   </span>
                                  </span>
                                 </span>
                                </span>
                               </span>
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                          <span class="vlist-s">
                           ​
                          </span>
                         </span>
                         <span class="vlist-r">
                          <span class="vlist" style="height: 0.69972em;">
                           <span class="">
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="mclose delimcenter" style="top: 0em;">
                       <span class="delimsizing size2">
                        )
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                  <span class="vlist-s">
                   ​
                  </span>
                 </span>
                 <span class="vlist-r">
                  <span class="vlist" style="height: 1.34772em;">
                   <span class="">
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 2.12315em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
    </p>
    <blockquote>
     <p>
      暂时遗留一个小问题（之后再做说明）：接收神经网络的输入
      <strong>
       y
      </strong>
      与发送神经网络输出
      <strong>
       x
      </strong>
      是什么关系？
     </p>
    </blockquote>
    <h4>
     <a id="_47">
     </a>
     训练流程
    </h4>
    <p>
     假定
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        f 
         
         
         
           θ 
          
         
           T 
          
         
         
         
           ( 
          
         
           T 
          
         
           ) 
          
         
        
       
      
        f_{\boldsymbol{\theta}_{T}}^{(T)}
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1.44641em; vertical-align: -0.401613em;">
         </span>
         <span class="mord">
          <span class="mord mathdefault" style="margin-right: 0.10764em;">
           f
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 1.0448em;">
              <span class="" style="top: -2.39869em; margin-left: -0.10764em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mtight">
                  <span class="mord mtight">
                   <span class="mord mtight">
                    <span class="mord boldsymbol mtight" style="margin-right: 0.03194em;">
                     θ
                    </span>
                   </span>
                  </span>
                  <span class="msupsub">
                   <span class="vlist-t vlist-t2">
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.3448em;">
                      <span class="" style="top: -2.35671em; margin-right: 0.0714286em;">
                       <span class="pstrut" style="height: 2.5em;">
                       </span>
                       <span class="sizing reset-size3 size1 mtight">
                        <span class="mord mtight">
                         <span class="mord mathdefault mtight" style="margin-right: 0.13889em;">
                          T
                         </span>
                        </span>
                       </span>
                      </span>
                     </span>
                     <span class="vlist-s">
                      ​
                     </span>
                    </span>
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.143293em;">
                      <span class="">
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="" style="top: -3.2198em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mopen mtight">
                  (
                 </span>
                 <span class="mord mathdefault mtight" style="margin-right: 0.13889em;">
                  T
                 </span>
                 <span class="mclose mtight">
                  )
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.401613em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     和
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        f 
         
         
         
           θ 
          
         
           R 
          
         
         
         
           ( 
          
         
           R 
          
         
           ) 
          
         
        
       
      
        f_{\boldsymbol{\theta}_{R}}^{(R)}
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 1.44641em; vertical-align: -0.401613em;">
         </span>
         <span class="mord">
          <span class="mord mathdefault" style="margin-right: 0.10764em;">
           f
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 1.0448em;">
              <span class="" style="top: -2.39869em; margin-left: -0.10764em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mtight">
                  <span class="mord mtight">
                   <span class="mord mtight">
                    <span class="mord boldsymbol mtight" style="margin-right: 0.03194em;">
                     θ
                    </span>
                   </span>
                  </span>
                  <span class="msupsub">
                   <span class="vlist-t vlist-t2">
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.3448em;">
                      <span class="" style="top: -2.35671em; margin-right: 0.0714286em;">
                       <span class="pstrut" style="height: 2.5em;">
                       </span>
                       <span class="sizing reset-size3 size1 mtight">
                        <span class="mord mtight">
                         <span class="mord mathdefault mtight" style="margin-right: 0.00773em;">
                          R
                         </span>
                        </span>
                       </span>
                      </span>
                     </span>
                     <span class="vlist-s">
                      ​
                     </span>
                    </span>
                    <span class="vlist-r">
                     <span class="vlist" style="height: 0.143293em;">
                      <span class="">
                      </span>
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="" style="top: -3.2198em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mopen mtight">
                  (
                 </span>
                 <span class="mord mathdefault mtight" style="margin-right: 0.00773em;">
                  R
                 </span>
                 <span class="mclose mtight">
                  )
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.401613em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     可微，根据损失函数，使用梯度下降法来调整这两个网络的参数。在训练接收端时，发送端的参数固定；训练发送端时接收端的参数固定。步骤如下：
     <br/>
     <img alt="训练流程" src="https://i-blog.csdnimg.cn/blog_migrate/1d3033446d6eac573527d29e44f47be9.png">
      <br/>
      这个流程图表示得非常清楚了，下面进行简单的补充说明。
     </img>
    </p>
    <h5>
     <a id="_51">
     </a>
     接收端训练
    </h5>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/60b7e89e099f442f1eb98860dbe22ed5.png">
      <br/>
      监督学习，损失函数为CE，B
      <sub>
       R
      </sub>
      为batch size，这一阶段仅更新接收神经网络的参数
     </img>
    </p>
    <blockquote>
     <p>
      注意：在这一阶段，输入端神经网络的输出通过信道作为y，对比发送端训练时，神经网络的输出x需要先经过一个sample
      <br/>
      policy再通过信道才得到y
     </p>
    </blockquote>
    <h5>
     <a id="_61">
     </a>
     发送端训练
    </h5>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/091dcd8b47537aeaaf8fbe3a85f65e0c.png">
      <br/>
      发送端训练的目标是生成
      <strong>
       最小化接收机提供的损失
      </strong>
      的信道符号。在这里神经网络输入空间
      <strong>
       M
      </strong>
      对应状态空间，输出空间
      <span class="katex--inline">
       <span class="katex">
        <span class="katex-mathml">
         C 
         
        
          N 
         
        
       
      
        \mathbb{C}^{N}
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 0.841331em; vertical-align: 0em;">
          </span>
          <span class="mord">
           <span class="mord">
            <span class="mord mathbb">
             C
            </span>
           </span>
           <span class="msupsub">
            <span class="vlist-t">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.841331em;">
               <span class="" style="top: -3.063em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mathdefault mtight" style="margin-right: 0.10903em;">
                   N
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
      对应动作空间。
     </img>
    </p>
    <p>
     使用强化学习，损失函数充当奖励的功能，由接收端反馈给输入端，在这里使用高斯策略，
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        x 
         
        
          p 
         
        
       
         = 
        
        
         
         
           1 
          
         
           − 
          
          
          
            σ 
           
          
            π 
           
          
            2 
           
          
         
        
       
         x 
        
       
         + 
        
       
         w 
        
       
      
        \mathbf{x}_{p}=\sqrt{1-\sigma_{\pi}^{2}} \mathbf{x}+\mathbf{w}
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.730548em; vertical-align: -0.286108em;">
         </span>
         <span class="mord">
          <span class="mord">
           <span class="mord mathbf">
            x
           </span>
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.151392em;">
              <span class="" style="top: -2.55em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathdefault mtight">
                  p
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.286108em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.277778em;">
         </span>
         <span class="mrel">
          =
         </span>
         <span class="mspace" style="margin-right: 0.277778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 1.24em; vertical-align: -0.308446em;">
         </span>
         <span class="mord sqrt">
          <span class="vlist-t vlist-t2">
           <span class="vlist-r">
            <span class="vlist" style="height: 0.931554em;">
             <span class="svg-align" style="top: -3.2em;">
              <span class="pstrut" style="height: 3.2em;">
              </span>
              <span class="mord" style="padding-left: 1em;">
               <span class="mord">
                1
               </span>
               <span class="mspace" style="margin-right: 0.222222em;">
               </span>
               <span class="mbin">
                −
               </span>
               <span class="mspace" style="margin-right: 0.222222em;">
               </span>
               <span class="mord">
                <span class="mord mathdefault" style="margin-right: 0.03588em;">
                 σ
                </span>
                <span class="msupsub">
                 <span class="vlist-t vlist-t2">
                  <span class="vlist-r">
                   <span class="vlist" style="height: 0.740108em;">
                    <span class="" style="top: -2.453em; margin-left: -0.03588em; margin-right: 0.05em;">
                     <span class="pstrut" style="height: 2.7em;">
                     </span>
                     <span class="sizing reset-size6 size3 mtight">
                      <span class="mord mtight">
                       <span class="mord mathdefault mtight" style="margin-right: 0.03588em;">
                        π
                       </span>
                      </span>
                     </span>
                    </span>
                    <span class="" style="top: -2.989em; margin-right: 0.05em;">
                     <span class="pstrut" style="height: 2.7em;">
                     </span>
                     <span class="sizing reset-size6 size3 mtight">
                      <span class="mord mtight">
                       <span class="mord mtight">
                        2
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                   <span class="vlist-s">
                    ​
                   </span>
                  </span>
                  <span class="vlist-r">
                   <span class="vlist" style="height: 0.247em;">
                    <span class="">
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="" style="top: -2.89155em;">
              <span class="pstrut" style="height: 3.2em;">
              </span>
              <span class="hide-tail" style="min-width: 1.02em; height: 1.28em;">
               <svg height="1.28em" preserveaspectratio="xMinYMin slice" viewbox="0 0 400000 1296" width="400em">
                <path d="M263,681c0.7,0,18,39.7,52,119c34,79.3,68.167,
158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120c340,-704.7,510.7,-1060.3,512,-1067
c4.7,-7.3,11,-11,19,-11H40000v40H1012.3s-271.3,567,-271.3,567c-38.7,80.7,-84,
175,-136,283c-52,108,-89.167,185.3,-111.5,232c-22.3,46.7,-33.8,70.3,-34.5,71
c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1s-109,-253,-109,-253c-72.7,-168,-109.3,
-252,-110,-252c-10.7,8,-22,16.7,-34,26c-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26
s76,-59,76,-59s76,-60,76,-60z M1001 80H40000v40H1012z">
                </path>
               </svg>
              </span>
             </span>
            </span>
            <span class="vlist-s">
             ​
            </span>
           </span>
           <span class="vlist-r">
            <span class="vlist" style="height: 0.308446em;">
             <span class="">
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mord">
          <span class="mord mathbf">
           x
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.222222em;">
         </span>
         <span class="mbin">
          +
         </span>
         <span class="mspace" style="margin-right: 0.222222em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 0.44444em; vertical-align: 0em;">
         </span>
         <span class="mord">
          <span class="mord mathbf" style="margin-right: 0.01597em;">
           w
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     ，其中
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        w 
        
       
         ∼ 
        
       
         C 
        
       
         N 
        
        
        
          ( 
         
        
          0 
         
        
          , 
         
         
         
           σ 
          
         
           π 
          
         
           2 
          
         
        
          I 
         
        
          ) 
         
        
       
      
        \mathbf{w} \sim \mathcal{C} \mathcal{N}\left(\mathbf{0}, \sigma_{\pi}^{2} \mathbf{I}\right)
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.44444em; vertical-align: 0em;">
         </span>
         <span class="mord">
          <span class="mord mathbf" style="margin-right: 0.01597em;">
           w
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.277778em;">
         </span>
         <span class="mrel">
          ∼
         </span>
         <span class="mspace" style="margin-right: 0.277778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 1.20001em; vertical-align: -0.35001em;">
         </span>
         <span class="mord">
          <span class="mord mathcal" style="margin-right: 0.05834em;">
           C
          </span>
         </span>
         <span class="mord">
          <span class="mord mathcal" style="margin-right: 0.14736em;">
           N
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.166667em;">
         </span>
         <span class="minner">
          <span class="mopen delimcenter" style="top: 0em;">
           <span class="delimsizing size1">
            (
           </span>
          </span>
          <span class="mord">
           <span class="mord mathbf">
            0
           </span>
          </span>
          <span class="mpunct">
           ,
          </span>
          <span class="mspace" style="margin-right: 0.166667em;">
          </span>
          <span class="mord">
           <span class="mord mathdefault" style="margin-right: 0.03588em;">
            σ
           </span>
           <span class="msupsub">
            <span class="vlist-t vlist-t2">
             <span class="vlist-r">
              <span class="vlist" style="height: 0.814108em;">
               <span class="" style="top: -2.453em; margin-left: -0.03588em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mathdefault mtight" style="margin-right: 0.03588em;">
                   π
                  </span>
                 </span>
                </span>
               </span>
               <span class="" style="top: -3.063em; margin-right: 0.05em;">
                <span class="pstrut" style="height: 2.7em;">
                </span>
                <span class="sizing reset-size6 size3 mtight">
                 <span class="mord mtight">
                  <span class="mord mtight">
                   2
                  </span>
                 </span>
                </span>
               </span>
              </span>
              <span class="vlist-s">
               ​
              </span>
             </span>
             <span class="vlist-r">
              <span class="vlist" style="height: 0.247em;">
               <span class="">
               </span>
              </span>
             </span>
            </span>
           </span>
          </span>
          <span class="mord">
           <span class="mord mathbf">
            I
           </span>
          </span>
          <span class="mclose delimcenter" style="top: 0em;">
           <span class="delimsizing size1">
            )
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     ，
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        σ 
         
        
          π 
         
        
       
         ∈ 
        
       
         ( 
        
       
         0 
        
       
         , 
        
       
         1 
        
       
         ) 
        
       
      
        \sigma_{\pi} \in(0,1)
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0.6891em; vertical-align: -0.15em;">
         </span>
         <span class="mord">
          <span class="mord mathdefault" style="margin-right: 0.03588em;">
           σ
          </span>
          <span class="msupsub">
           <span class="vlist-t vlist-t2">
            <span class="vlist-r">
             <span class="vlist" style="height: 0.151392em;">
              <span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;">
               <span class="pstrut" style="height: 2.7em;">
               </span>
               <span class="sizing reset-size6 size3 mtight">
                <span class="mord mtight">
                 <span class="mord mathdefault mtight" style="margin-right: 0.03588em;">
                  π
                 </span>
                </span>
               </span>
              </span>
             </span>
             <span class="vlist-s">
              ​
             </span>
            </span>
            <span class="vlist-r">
             <span class="vlist" style="height: 0.15em;">
              <span class="">
              </span>
             </span>
            </span>
           </span>
          </span>
         </span>
         <span class="mspace" style="margin-right: 0.277778em;">
         </span>
         <span class="mrel">
          ∈
         </span>
         <span class="mspace" style="margin-right: 0.277778em;">
         </span>
        </span>
        <span class="base">
         <span class="strut" style="height: 1em; vertical-align: -0.25em;">
         </span>
         <span class="mopen">
          (
         </span>
         <span class="mord">
          0
         </span>
         <span class="mpunct">
          ,
         </span>
         <span class="mspace" style="margin-right: 0.166667em;">
         </span>
         <span class="mord">
          1
         </span>
         <span class="mclose">
          )
         </span>
        </span>
       </span>
      </span>
     </span>
     在这里是固定为0.02。sample policy相当于给神经网络的输出增加一个扰动，使它从原来的确定值变成满足高斯分布的输出。输入端的神经网络和sample policy共同组成发送端编码的策略函数。策略函数可表示为
     <span class="katex--display">
      <span class="katex-display">
       <span class="katex">
        <span class="katex-mathml">
         π 
             
             
             
               ( 
              
              
              
                x 
               
              
                p 
               
              
             
               ∣ 
              
              
              
                f 
               
               
               
                 θ 
                
               
                 T 
                
               
               
               
                 ( 
                
               
                 T 
                
               
                 ) 
                
               
              
             
               ( 
              
             
               m 
              
             
               ) 
              
             
               ) 
              
             
            
              = 
             
            
           
          
         
         
          
           
            
             
             
               1 
              
              
               
               
                 ( 
                
               
                 π 
                
                
                
                  σ 
                 
                
                  π 
                 
                
                  2 
                 
                
               
                 ) 
                
               
              
                N 
               
              
             
            
              exp 
             
            
              ⁡ 
             
             
             
               ( 
              
             
               − 
              
              
               
                
                
                  ∥ 
                 
                 
                 
                   x 
                  
                 
                   p 
                  
                 
                
                  − 
                 
                 
                  
                  
                    1 
                   
                  
                    − 
                   
                   
                   
                     σ 
                    
                   
                     π 
                    
                   
                     2 
                    
                   
                  
                 
                 
                 
                   f 
                  
                  
                  
                    θ 
                   
                  
                    T 
                   
                  
                  
                  
                    ( 
                   
                  
                    T 
                   
                  
                    ) 
                   
                  
                 
                
                  ( 
                 
                
                  m 
                 
                
                  ) 
                 
                
                  ∥ 
                 
                
               
                 2 
                
               
                 2 
                
               
               
               
                 σ 
                
               
                 π 
                
               
                 2 
                
               
              
             
               ) 
              
             
            
           
          
         
        
       
         \begin{array}{l}{\pi\left(\mathbf{x}_{p} | f_{\boldsymbol{\theta}_{T}}^{(T)}(m)\right)=} \\ {\frac{1}{\left(\pi \sigma_{\pi}^{2}\right)^{N}} \exp \left(-\frac{\left\|\mathbf{x}_{p}-\sqrt{1-\sigma_{\pi}^{2}} f_{\boldsymbol{\theta}_{T}}^{(T)}(m)\right\|_{2}^{2}}{\sigma_{\pi}^{2}}\right)}\end{array}
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 4.80005em; vertical-align: -2.15002em;">
          </span>
          <span class="mord">
           <span class="mtable">
            <span class="arraycolsep" style="width: 0.5em;">
            </span>
            <span class="col-align-l">
             <span class="vlist-t vlist-t2">
              <span class="vlist-r">
               <span class="vlist" style="height: 2.65002em;">
                <span class="" style="top: -5.25002em;">
                 <span class="pstrut" style="height: 3.75em;">
                 </span>
                 <span class="mord">
                  <span class="mord">
                   <span class="mord mathdefault" style="margin-right: 0.03588em;">
                    π
                   </span>
                   <span class="mspace" style="margin-right: 0.166667em;">
                   </span>
                   <span class="minner">
                    <span class="mopen delimcenter" style="top: 0em;">
                     <span class="delimsizing size2">
                      (
                     </span>
                    </span>
                    <span class="mord">
                     <span class="mord">
                      <span class="mord mathbf">
                       x
                      </span>
                     </span>
                     <span class="msupsub">
                      <span class="vlist-t vlist-t2">
                       <span class="vlist-r">
                        <span class="vlist" style="height: 0.151392em;">
                         <span class="" style="top: -2.55em; margin-right: 0.05em;">
                          <span class="pstrut" style="height: 2.7em;">
                          </span>
                          <span class="sizing reset-size6 size3 mtight">
                           <span class="mord mtight">
                            <span class="mord mathdefault mtight">
                             p
                            </span>
                           </span>
                          </span>
                         </span>
                        </span>
                        <span class="vlist-s">
                         ​
                        </span>
                       </span>
                       <span class="vlist-r">
                        <span class="vlist" style="height: 0.286108em;">
                         <span class="">
                         </span>
                        </span>
                       </span>
                      </span>
                     </span>
                    </span>
                    <span class="mord">
                     ∣
                    </span>
                    <span class="mord">
                     <span class="mord mathdefault" style="margin-right: 0.10764em;">
                      f
                     </span>
                     <span class="msupsub">
                      <span class="vlist-t vlist-t2">
                       <span class="vlist-r">
                        <span class="vlist" style="height: 1.0448em;">
                         <span class="" style="top: -2.39869em; margin-left: -0.10764em; margin-right: 0.05em;">
                          <span class="pstrut" style="height: 2.7em;">
                          </span>
                          <span class="sizing reset-size6 size3 mtight">
                           <span class="mord mtight">
                            <span class="mord mtight">
                             <span class="mord mtight">
                              <span class="mord mtight">
                               <span class="mord boldsymbol mtight" style="margin-right: 0.03194em;">
                                θ
                               </span>
                              </span>
                             </span>
                             <span class="msupsub">
                              <span class="vlist-t vlist-t2">
                               <span class="vlist-r">
                                <span class="vlist" style="height: 0.3448em;">
                                 <span class="" style="top: -2.35671em; margin-right: 0.0714286em;">
                                  <span class="pstrut" style="height: 2.5em;">
                                  </span>
                                  <span class="sizing reset-size3 size1 mtight">
                                   <span class="mord mtight">
                                    <span class="mord mathdefault mtight" style="margin-right: 0.13889em;">
                                     T
                                    </span>
                                   </span>
                                  </span>
                                 </span>
                                </span>
                                <span class="vlist-s">
                                 ​
                                </span>
                               </span>
                               <span class="vlist-r">
                                <span class="vlist" style="height: 0.143293em;">
                                 <span class="">
                                 </span>
                                </span>
                               </span>
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                         <span class="" style="top: -3.2198em; margin-right: 0.05em;">
                          <span class="pstrut" style="height: 2.7em;">
                          </span>
                          <span class="sizing reset-size6 size3 mtight">
                           <span class="mord mtight">
                            <span class="mopen mtight">
                             (
                            </span>
                            <span class="mord mathdefault mtight" style="margin-right: 0.13889em;">
                             T
                            </span>
                            <span class="mclose mtight">
                             )
                            </span>
                           </span>
                          </span>
                         </span>
                        </span>
                        <span class="vlist-s">
                         ​
                        </span>
                       </span>
                       <span class="vlist-r">
                        <span class="vlist" style="height: 0.401613em;">
                         <span class="">
                         </span>
                        </span>
                       </span>
                      </span>
                     </span>
                    </span>
                    <span class="mopen">
                     (
                    </span>
                    <span class="mord mathdefault">
                     m
                    </span>
                    <span class="mclose">
                     )
                    </span>
                    <span class="mclose delimcenter" style="top: 0em;">
                     <span class="delimsizing size2">
                      )
                     </span>
                    </span>
                   </span>
                   <span class="mspace" style="margin-right: 0.277778em;">
                   </span>
                   <span class="mrel">
                    =
                   </span>
                  </span>
                 </span>
                </span>
                <span class="" style="top: -2.85001em;">
                 <span class="pstrut" style="height: 3.75em;">
                 </span>
                 <span class="mord">
                  <span class="mord">
                   <span class="mord">
                    <span class="mopen nulldelimiter">
                    </span>
                    <span class="mfrac">
                     <span class="vlist-t vlist-t2">
                      <span class="vlist-r">
                       <span class="vlist" style="height: 0.845108em;">
                        <span class="" style="top: -2.57034em;">
                         <span class="pstrut" style="height: 3em;">
                         </span>
                         <span class="sizing reset-size6 size3 mtight">
                          <span class="mord mtight">
                           <span class="minner mtight">
                            <span class="minner mtight">
                             <span class="mopen mtight delimcenter" style="top: 0em;">
                              <span class="mtight">
                               (
                              </span>
                             </span>
                             <span class="mord mathdefault mtight" style="margin-right: 0.03588em;">
                              π
                             </span>
                             <span class="mord mtight">
                              <span class="mord mathdefault mtight" style="margin-right: 0.03588em;">
                               σ
                              </span>
                              <span class="msupsub">
                               <span class="vlist-t vlist-t2">
                                <span class="vlist-r">
                                 <span class="vlist" style="height: 0.746314em;">
                                  <span class="" style="top: -2.214em; margin-left: -0.03588em; margin-right: 0.0714286em;">
                                   <span class="pstrut" style="height: 2.5em;">
                                   </span>
                                   <span class="sizing reset-size3 size1 mtight">
                                    <span class="mord mtight">
                                     <span class="mord mathdefault mtight" style="margin-right: 0.03588em;">
                                      π
                                     </span>
                                    </span>
                                   </span>
                                  </span>
                                  <span class="" style="top: -2.786em; margin-right: 0.0714286em;">
                                   <span class="pstrut" style="height: 2.5em;">
                                   </span>
                                   <span class="sizing reset-size3 size1 mtight">
                                    <span class="mord mtight">
                                     <span class="mord mtight">
                                      2
                                     </span>
                                    </span>
                                   </span>
                                  </span>
                                 </span>
                                 <span class="vlist-s">
                                  ​
                                 </span>
                                </span>
                                <span class="vlist-r">
                                 <span class="vlist" style="height: 0.286em;">
                                  <span class="">
                                  </span>
                                 </span>
                                </span>
                               </span>
                              </span>
                             </span>
                             <span class="mclose mtight delimcenter" style="top: 0em;">
                              <span class="mtight">
                               )
                              </span>
                             </span>
                            </span>
                            <span class="msupsub">
                             <span class="vlist-t">
                              <span class="vlist-r">
                               <span class="vlist" style="height: 0.885236em;">
                                <span class="" style="top: -2.89714em; margin-right: 0.0714286em;">
                                 <span class="pstrut" style="height: 2.5em;">
                                 </span>
                                 <span class="sizing reset-size3 size1 mtight">
                                  <span class="mord mtight">
                                   <span class="mord mathdefault mtight" style="margin-right: 0.10903em;">
                                    N
                                   </span>
                                  </span>
                                 </span>
                                </span>
                               </span>
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                        </span>
                        <span class="" style="top: -3.23em;">
                         <span class="pstrut" style="height: 3em;">
                         </span>
                         <span class="frac-line" style="border-bottom-width: 0.04em;">
                         </span>
                        </span>
                        <span class="" style="top: -3.394em;">
                         <span class="pstrut" style="height: 3em;">
                         </span>
                         <span class="sizing reset-size6 size3 mtight">
                          <span class="mord mtight">
                           <span class="mord mtight">
                            1
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                       <span class="vlist-s">
                        ​
                       </span>
                      </span>
                      <span class="vlist-r">
                       <span class="vlist" style="height: 0.629865em;">
                        <span class="">
                        </span>
                       </span>
                      </span>
                     </span>
                    </span>
                    <span class="mclose nulldelimiter">
                    </span>
                   </span>
                   <span class="mspace" style="margin-right: 0.166667em;">
                   </span>
                   <span class="mop">
                    exp
                   </span>
                   <span class="mspace" style="margin-right: 0.166667em;">
                   </span>
                   <span class="minner">
                    <span class="mopen delimcenter" style="top: 0em;">
                     <span class="delimsizing size4">
                      (
                     </span>
                    </span>
                    <span class="mord">
                     −
                    </span>
                    <span class="mord">
                     <span class="mopen nulldelimiter">
                     </span>
                     <span class="mfrac">
                      <span class="vlist-t vlist-t2">
                       <span class="vlist-r">
                        <span class="vlist" style="height: 1.64722em;">
                         <span class="" style="top: -2.655em;">
                          <span class="pstrut" style="height: 3em;">
                          </span>
                          <span class="sizing reset-size6 size3 mtight">
                           <span class="mord mtight">
                            <span class="mord mtight">
                             <span class="mord mathdefault mtight" style="margin-right: 0.03588em;">
                              σ
                             </span>
                             <span class="msupsub">
                              <span class="vlist-t vlist-t2">
                               <span class="vlist-r">
                                <span class="vlist" style="height: 0.746314em;">
                                 <span class="" style="top: -2.214em; margin-left: -0.03588em; margin-right: 0.0714286em;">
                                  <span class="pstrut" style="height: 2.5em;">
                                  </span>
                                  <span class="sizing reset-size3 size1 mtight">
                                   <span class="mord mtight">
                                    <span class="mord mathdefault mtight" style="margin-right: 0.03588em;">
                                     π
                                    </span>
                                   </span>
                                  </span>
                                 </span>
                                 <span class="" style="top: -2.786em; margin-right: 0.0714286em;">
                                  <span class="pstrut" style="height: 2.5em;">
                                  </span>
                                  <span class="sizing reset-size3 size1 mtight">
                                   <span class="mord mtight">
                                    <span class="mord mtight">
                                     2
                                    </span>
                                   </span>
                                  </span>
                                 </span>
                                </span>
                                <span class="vlist-s">
                                 ​
                                </span>
                               </span>
                               <span class="vlist-r">
                                <span class="vlist" style="height: 0.286em;">
                                 <span class="">
                                 </span>
                                </span>
                               </span>
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                         <span class="" style="top: -3.23em;">
                          <span class="pstrut" style="height: 3em;">
                          </span>
                          <span class="frac-line" style="border-bottom-width: 0.04em;">
                          </span>
                         </span>
                         <span class="" style="top: -3.78501em;">
                          <span class="pstrut" style="height: 3em;">
                          </span>
                          <span class="sizing reset-size6 size3 mtight">
                           <span class="mord mtight">
                            <span class="minner mtight">
                             <span class="minner mtight">
                              <span class="mopen sizing reset-size3 size6 mtight">
                               <span class="delimsizing mult">
                                <span class="vlist-t vlist-t2">
                                 <span class="vlist-r">
                                  <span class="vlist" style="height: 0.78699em;">
                                   <span class="" style="top: -2.18099em;">
                                    <span class="pstrut" style="height: 2.606em;">
                                    </span>
                                    <span class="delimsizinginner delim-size1">
                                     <span class="">
                                      ∥
                                     </span>
                                    </span>
                                   </span>
                                   <span class="" style="top: -2.78699em;">
                                    <span class="pstrut" style="height: 2.606em;">
                                    </span>
                                    <span class="delimsizinginner delim-size1">
                                     <span class="">
                                      ∥
                                     </span>
                                    </span>
                                   </span>
                                  </span>
                                  <span class="vlist-s">
                                   ​
                                  </span>
                                 </span>
                                 <span class="vlist-r">
                                  <span class="vlist" style="height: 0.42501em;">
                                   <span class="">
                                   </span>
                                  </span>
                                 </span>
                                </span>
                               </span>
                              </span>
                              <span class="mord mtight">
                               <span class="mord mtight">
                                <span class="mord mathbf mtight">
                                 x
                                </span>
                               </span>
                               <span class="msupsub">
                                <span class="vlist-t vlist-t2">
                                 <span class="vlist-r">
                                  <span class="vlist" style="height: 0.164543em;">
                                   <span class="" style="top: -2.357em; margin-right: 0.0714286em;">
                                    <span class="pstrut" style="height: 2.5em;">
                                    </span>
                                    <span class="sizing reset-size3 size1 mtight">
                                     <span class="mord mtight">
                                      <span class="mord mathdefault mtight">
                                       p
                                      </span>
                                     </span>
                                    </span>
                                   </span>
                                  </span>
                                  <span class="vlist-s">
                                   ​
                                  </span>
                                 </span>
                                 <span class="vlist-r">
                                  <span class="vlist" style="height: 0.281886em;">
                                   <span class="">
                                   </span>
                                  </span>
                                 </span>
                                </span>
                               </span>
                              </span>
                              <span class="mbin mtight">
                               −
                              </span>
                              <span class="mord sqrt mtight">
                               <span class="vlist-t vlist-t2">
                                <span class="vlist-r">
                                 <span class="vlist" style="height: 1.01707em;">
                                  <span class="svg-align" style="top: -3.42857em;">
                                   <span class="pstrut" style="height: 3.42857em;">
                                   </span>
                                   <span class="mord mtight" style="padding-left: 1.19em;">
                                    <span class="mord mtight">
                                     1
                                    </span>
                                    <span class="mbin mtight">
                                     −
                                    </span>
                                    <span class="mord mtight">
                                     <span class="mord mathdefault mtight" style="margin-right: 0.03588em;">
                                      σ
                                     </span>
                                     <span class="msupsub">
                                      <span class="vlist-t vlist-t2">
                                       <span class="vlist-r">
                                        <span class="vlist" style="height: 0.746314em;">
                                         <span class="" style="top: -2.214em; margin-left: -0.03588em; margin-right: 0.0714286em;">
                                          <span class="pstrut" style="height: 2.5em;">
                                          </span>
                                          <span class="sizing reset-size3 size1 mtight">
                                           <span class="mord mtight">
                                            <span class="mord mathdefault mtight" style="margin-right: 0.03588em;">
                                             π
                                            </span>
                                           </span>
                                          </span>
                                         </span>
                                         <span class="" style="top: -2.786em; margin-right: 0.0714286em;">
                                          <span class="pstrut" style="height: 2.5em;">
                                          </span>
                                          <span class="sizing reset-size3 size1 mtight">
                                           <span class="mord mtight">
                                            <span class="mord mtight">
                                             2
                                            </span>
                                           </span>
                                          </span>
                                         </span>
                                        </span>
                                        <span class="vlist-s">
                                         ​
                                        </span>
                                       </span>
                                       <span class="vlist-r">
                                        <span class="vlist" style="height: 0.286em;">
                                         <span class="">
                                         </span>
                                        </span>
                                       </span>
                                      </span>
                                     </span>
                                    </span>
                                   </span>
                                  </span>
                                  <span class="" style="top: -2.98907em;">
                                   <span class="pstrut" style="height: 3.42857em;">
                                   </span>
                                   <span class="hide-tail mtight" style="min-width: 0.853em; height: 1.54286em;">
                                    <svg height="1.5428571428571431em" preserveaspectratio="xMinYMin slice" viewbox="0 0 400000 1080" width="400em">
                                     <path d="M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,
-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,
-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,
35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,
-221c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467
s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422
s-65,47,-65,47z M834 80H400000v40H845z">
                                     </path>
                                    </svg>
                                   </span>
                                  </span>
                                 </span>
                                 <span class="vlist-s">
                                  ​
                                 </span>
                                </span>
                                <span class="vlist-r">
                                 <span class="vlist" style="height: 0.439504em;">
                                  <span class="">
                                  </span>
                                 </span>
                                </span>
                               </span>
                              </span>
                              <span class="mord mtight">
                               <span class="mord mathdefault mtight" style="margin-right: 0.10764em;">
                                f
                               </span>
                               <span class="msupsub">
                                <span class="vlist-t vlist-t2">
                                 <span class="vlist-r">
                                  <span class="vlist" style="height: 1.05909em;">
                                   <span class="" style="top: -2.18849em; margin-left: -0.10764em; margin-right: 0.0714286em;">
                                    <span class="pstrut" style="height: 2.53571em;">
                                    </span>
                                    <span class="sizing reset-size3 size1 mtight">
                                     <span class="mord mtight">
                                      <span class="mord mtight">
                                       <span class="mord mtight">
                                        <span class="mord mtight">
                                         <span class="mord boldsymbol mtight" style="margin-right: 0.03194em;">
                                          θ
                                         </span>
                                        </span>
                                       </span>
                                       <span class="msupsub">
                                        <span class="vlist-t vlist-t2">
                                         <span class="vlist-r">
                                          <span class="vlist" style="height: 0.3448em;">
                                           <span class="" style="top: -2.3448em; margin-right: 0.1em;">
                                            <span class="pstrut" style="height: 2.68333em;">
                                            </span>
                                            <span class="mord mtight">
                                             <span class="mord mathdefault mtight" style="margin-right: 0.13889em;">
                                              T
                                             </span>
                                            </span>
                                           </span>
                                          </span>
                                          <span class="vlist-s">
                                           ​
                                          </span>
                                         </span>
                                         <span class="vlist-r">
                                          <span class="vlist" style="height: 0.33853em;">
                                           <span class="">
                                           </span>
                                          </span>
                                         </span>
                                        </span>
                                       </span>
                                      </span>
                                     </span>
                                    </span>
                                   </span>
                                   <span class="" style="top: -3.05909em; margin-right: 0.0714286em;">
                                    <span class="pstrut" style="height: 2.53571em;">
                                    </span>
                                    <span class="sizing reset-size3 size1 mtight">
                                     <span class="mord mtight">
                                      <span class="mopen mtight">
                                       (
                                      </span>
                                      <span class="mord mathdefault mtight" style="margin-right: 0.13889em;">
                                       T
                                      </span>
                                      <span class="mclose mtight">
                                       )
                                      </span>
                                     </span>
                                    </span>
                                   </span>
                                  </span>
                                  <span class="vlist-s">
                                   ​
                                  </span>
                                 </span>
                                 <span class="vlist-r">
                                  <span class="vlist" style="height: 0.589036em;">
                                   <span class="">
                                   </span>
                                  </span>
                                 </span>
                                </span>
                               </span>
                              </span>
                              <span class="mopen mtight">
                               (
                              </span>
                              <span class="mord mathdefault mtight">
                               m
                              </span>
                              <span class="mclose mtight">
                               )
                              </span>
                              <span class="mclose sizing reset-size3 size6 mtight">
                               <span class="delimsizing mult">
                                <span class="vlist-t vlist-t2">
                                 <span class="vlist-r">
                                  <span class="vlist" style="height: 0.78699em;">
                                   <span class="" style="top: -2.18099em;">
                                    <span class="pstrut" style="height: 2.606em;">
                                    </span>
                                    <span class="delimsizinginner delim-size1">
                                     <span class="">
                                      ∥
                                     </span>
                                    </span>
                                   </span>
                                   <span class="" style="top: -2.78699em;">
                                    <span class="pstrut" style="height: 2.606em;">
                                    </span>
                                    <span class="delimsizinginner delim-size1">
                                     <span class="">
                                      ∥
                                     </span>
                                    </span>
                                   </span>
                                  </span>
                                  <span class="vlist-s">
                                   ​
                                  </span>
                                 </span>
                                 <span class="vlist-r">
                                  <span class="vlist" style="height: 0.42501em;">
                                   <span class="">
                                   </span>
                                  </span>
                                 </span>
                                </span>
                               </span>
                              </span>
                             </span>
                             <span class="msupsub">
                              <span class="vlist-t vlist-t2">
                               <span class="vlist-r">
                                <span class="vlist" style="height: 1.23173em;">
                                 <span class="" style="top: -1.82141em; margin-right: 0.0714286em;">
                                  <span class="pstrut" style="height: 2.5em;">
                                  </span>
                                  <span class="sizing reset-size3 size1 mtight">
                                   <span class="mord mtight">
                                    <span class="mord mtight">
                                     2
                                    </span>
                                   </span>
                                  </span>
                                 </span>
                                 <span class="" style="top: -3.27141em; margin-right: 0.0714286em;">
                                  <span class="pstrut" style="height: 2.5em;">
                                  </span>
                                  <span class="sizing reset-size3 size1 mtight">
                                   <span class="mord mtight">
                                    <span class="mord mtight">
                                     2
                                    </span>
                                   </span>
                                  </span>
                                 </span>
                                </span>
                                <span class="vlist-s">
                                 ​
                                </span>
                               </span>
                               <span class="vlist-r">
                                <span class="vlist" style="height: 0.678586em;">
                                 <span class="">
                                 </span>
                                </span>
                               </span>
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                        </span>
                        <span class="vlist-s">
                         ​
                        </span>
                       </span>
                       <span class="vlist-r">
                        <span class="vlist" style="height: 0.5452em;">
                         <span class="">
                         </span>
                        </span>
                       </span>
                      </span>
                     </span>
                     <span class="mclose nulldelimiter">
                     </span>
                    </span>
                    <span class="mclose delimcenter" style="top: 0em;">
                     <span class="delimsizing size4">
                      )
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
               <span class="vlist-s">
                ​
               </span>
              </span>
              <span class="vlist-r">
               <span class="vlist" style="height: 2.15002em;">
                <span class="">
                </span>
               </span>
              </span>
             </span>
            </span>
            <span class="arraycolsep" style="width: 0.5em;">
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     <br/>
     loss gradient可表示为
     <span class="katex--display">
      <span class="katex-display">
       <span class="katex">
        <span class="katex-mathml">
         ∇ 
              
              
               
               
                 θ 
                
               
                 T 
                
               
              
                , 
               
              
                ψ 
               
              
             
             
             
               J 
              
             
               ~ 
              
             
             
             
               ( 
              
              
              
                m 
               
              
                T 
               
              
             
               , 
              
             
               l 
              
             
               , 
              
              
              
                X 
               
              
                p 
               
              
             
               ) 
              
             
            
           
          
         
         
          
           
            
             
            
              = 
             
             
             
               1 
              
              
              
                B 
               
              
                T 
               
              
             
             
             
               ∑ 
              
              
              
                i 
               
              
                = 
               
              
                1 
               
              
              
              
                B 
               
              
                T 
               
              
             
             
             
               l 
              
              
              
                ( 
               
              
                i 
               
              
                ) 
               
              
             
             
             
               ∇ 
              
              
               
               
                 θ 
                
               
                 T 
                
               
              
                , 
               
              
                ψ 
               
              
             
            
              log 
             
            
              ⁡ 
             
             
             
               ( 
              
              
              
                π 
               
              
                ψ 
               
              
              
              
                ( 
               
               
               
                 x 
                
               
                 p 
                
                
                
                  ( 
                 
                
                  i 
                 
                
                  ) 
                 
                
               
              
                ∣ 
               
               
               
                 f 
                
                
                
                  θ 
                 
                
                  T 
                 
                
                
                
                  ( 
                 
                
                  T 
                 
                
                  ) 
                 
                
               
               
               
                 ( 
                
                
                
                  m 
                 
                
                  T 
                 
                 
                 
                   ( 
                  
                 
                   i 
                  
                 
                   ) 
                  
                 
                
               
                 ) 
                
               
              
                ) 
               
              
             
               ) 
              
             
            
           
          
         
        
       
         \begin{array}{l}{\nabla_{\boldsymbol{\theta}_{T}, \boldsymbol{\psi}} \tilde{J}\left(\mathbf{m}_{\mathcal{T}}, \mathbf{l}, \mathbf{X}_{p}\right)} \\ {\quad=\frac{1}{B_{T}} \sum_{i=1}^{B_{T}} l^{(i)} \nabla_{\boldsymbol{\theta}_{T}, \boldsymbol{\psi}} \log \left(\pi_{\boldsymbol{\psi}}\left(\mathbf{x}_{p}^{(i)} | f_{\boldsymbol{\theta}_{T}}^{(T)}\left(m_{\mathcal{T}}^{(i)}\right)\right)\right)}\end{array}
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 3.08021em; vertical-align: -1.2901em;">
          </span>
          <span class="mord">
           <span class="mtable">
            <span class="arraycolsep" style="width: 0.5em;">
            </span>
            <span class="col-align-l">
             <span class="vlist-t vlist-t2">
              <span class="vlist-r">
               <span class="vlist" style="height: 1.7901em;">
                <span class="" style="top: -4.01992em;">
                 <span class="pstrut" style="height: 3.15em;">
                 </span>
                 <span class="mord">
                  <span class="mord">
                   <span class="mord">
                    <span class="mord">
                     ∇
                    </span>
                    <span class="msupsub">
                     <span class="vlist-t vlist-t2">
                      <span class="vlist-r">
                       <span class="vlist" style="height: 0.336108em;">
                        <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                         <span class="pstrut" style="height: 2.7em;">
                         </span>
                         <span class="sizing reset-size6 size3 mtight">
                          <span class="mord mtight">
                           <span class="mord mtight">
                            <span class="mord mtight">
                             <span class="mord mtight">
                              <span class="mord boldsymbol mtight" style="margin-right: 0.03194em;">
                               θ
                              </span>
                             </span>
                            </span>
                            <span class="msupsub">
                             <span class="vlist-t vlist-t2">
                              <span class="vlist-r">
                               <span class="vlist" style="height: 0.3448em;">
                                <span class="" style="top: -2.35671em; margin-right: 0.0714286em;">
                                 <span class="pstrut" style="height: 2.5em;">
                                 </span>
                                 <span class="sizing reset-size3 size1 mtight">
                                  <span class="mord mtight">
                                   <span class="mord mathdefault mtight" style="margin-right: 0.13889em;">
                                    T
                                   </span>
                                  </span>
                                 </span>
                                </span>
                               </span>
                               <span class="vlist-s">
                                ​
                               </span>
                              </span>
                              <span class="vlist-r">
                               <span class="vlist" style="height: 0.143293em;">
                                <span class="">
                                </span>
                               </span>
                              </span>
                             </span>
                            </span>
                           </span>
                           <span class="mpunct mtight">
                            ,
                           </span>
                           <span class="mord mtight">
                            <span class="mord mtight">
                             <span class="mord boldsymbol mtight" style="margin-right: 0.03704em;">
                              ψ
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                       <span class="vlist-s">
                        ​
                       </span>
                      </span>
                      <span class="vlist-r">
                       <span class="vlist" style="height: 0.286108em;">
                        <span class="">
                        </span>
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                   <span class="mord accent">
                    <span class="vlist-t">
                     <span class="vlist-r">
                      <span class="vlist" style="height: 0.92019em;">
                       <span class="" style="top: -3em;">
                        <span class="pstrut" style="height: 3em;">
                        </span>
                        <span class="mord">
                         <span class="mord mathdefault" style="margin-right: 0.09618em;">
                          J
                         </span>
                        </span>
                       </span>
                       <span class="" style="top: -3.60233em;">
                        <span class="pstrut" style="height: 3em;">
                        </span>
                        <span class="accent-body" style="left: -0.08333em;">
                         ~
                        </span>
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                   <span class="mspace" style="margin-right: 0.166667em;">
                   </span>
                   <span class="minner">
                    <span class="mopen delimcenter" style="top: 0em;">
                     (
                    </span>
                    <span class="mord">
                     <span class="mord">
                      <span class="mord mathbf">
                       m
                      </span>
                     </span>
                     <span class="msupsub">
                      <span class="vlist-t vlist-t2">
                       <span class="vlist-r">
                        <span class="vlist" style="height: 0.328331em;">
                         <span class="" style="top: -2.55em; margin-right: 0.05em;">
                          <span class="pstrut" style="height: 2.7em;">
                          </span>
                          <span class="sizing reset-size6 size3 mtight">
                           <span class="mord mtight">
                            <span class="mord mtight">
                             <span class="mord mathcal mtight" style="margin-right: 0.25417em;">
                              T
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                        </span>
                        <span class="vlist-s">
                         ​
                        </span>
                       </span>
                       <span class="vlist-r">
                        <span class="vlist" style="height: 0.15em;">
                         <span class="">
                         </span>
                        </span>
                       </span>
                      </span>
                     </span>
                    </span>
                    <span class="mpunct">
                     ,
                    </span>
                    <span class="mspace" style="margin-right: 0.166667em;">
                    </span>
                    <span class="mord">
                     <span class="mord mathbf">
                      l
                     </span>
                    </span>
                    <span class="mpunct">
                     ,
                    </span>
                    <span class="mspace" style="margin-right: 0.166667em;">
                    </span>
                    <span class="mord">
                     <span class="mord">
                      <span class="mord mathbf">
                       X
                      </span>
                     </span>
                     <span class="msupsub">
                      <span class="vlist-t vlist-t2">
                       <span class="vlist-r">
                        <span class="vlist" style="height: 0.151392em;">
                         <span class="" style="top: -2.55em; margin-right: 0.05em;">
                          <span class="pstrut" style="height: 2.7em;">
                          </span>
                          <span class="sizing reset-size6 size3 mtight">
                           <span class="mord mtight">
                            <span class="mord mathdefault mtight">
                             p
                            </span>
                           </span>
                          </span>
                         </span>
                        </span>
                        <span class="vlist-s">
                         ​
                        </span>
                       </span>
                       <span class="vlist-r">
                        <span class="vlist" style="height: 0.286108em;">
                         <span class="">
                         </span>
                        </span>
                       </span>
                      </span>
                     </span>
                    </span>
                    <span class="mclose delimcenter" style="top: 0em;">
                     )
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
                <span class="" style="top: -2.50992em;">
                 <span class="pstrut" style="height: 3.15em;">
                 </span>
                 <span class="mord">
                  <span class="mord">
                   <span class="mspace" style="margin-right: 1em;">
                   </span>
                   <span class="mrel">
                    =
                   </span>
                   <span class="mspace" style="margin-right: 0.277778em;">
                   </span>
                   <span class="mord">
                    <span class="mopen nulldelimiter">
                    </span>
                    <span class="mfrac">
                     <span class="vlist-t vlist-t2">
                      <span class="vlist-r">
                       <span class="vlist" style="height: 0.845108em;">
                        <span class="" style="top: -2.655em;">
                         <span class="pstrut" style="height: 3em;">
                         </span>
                         <span class="sizing reset-size6 size3 mtight">
                          <span class="mord mtight">
                           <span class="mord mtight">
                            <span class="mord mathdefault mtight" style="margin-right: 0.05017em;">
                             B
                            </span>
                            <span class="msupsub">
                             <span class="vlist-t vlist-t2">
                              <span class="vlist-r">
                               <span class="vlist" style="height: 0.3448em;">
                                <span class="" style="top: -2.35671em; margin-left: -0.05017em; margin-right: 0.0714286em;">
                                 <span class="pstrut" style="height: 2.5em;">
                                 </span>
                                 <span class="sizing reset-size3 size1 mtight">
                                  <span class="mord mtight">
                                   <span class="mord mathdefault mtight" style="margin-right: 0.13889em;">
                                    T
                                   </span>
                                  </span>
                                 </span>
                                </span>
                               </span>
                               <span class="vlist-s">
                                ​
                               </span>
                              </span>
                              <span class="vlist-r">
                               <span class="vlist" style="height: 0.143293em;">
                                <span class="">
                                </span>
                               </span>
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                        </span>
                        <span class="" style="top: -3.23em;">
                         <span class="pstrut" style="height: 3em;">
                         </span>
                         <span class="frac-line" style="border-bottom-width: 0.04em;">
                         </span>
                        </span>
                        <span class="" style="top: -3.394em;">
                         <span class="pstrut" style="height: 3em;">
                         </span>
                         <span class="sizing reset-size6 size3 mtight">
                          <span class="mord mtight">
                           <span class="mord mtight">
                            1
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                       <span class="vlist-s">
                        ​
                       </span>
                      </span>
                      <span class="vlist-r">
                       <span class="vlist" style="height: 0.445305em;">
                        <span class="">
                        </span>
                       </span>
                      </span>
                     </span>
                    </span>
                    <span class="mclose nulldelimiter">
                    </span>
                   </span>
                   <span class="mspace" style="margin-right: 0.166667em;">
                   </span>
                   <span class="mop">
                    <span class="mop op-symbol small-op" style="position: relative; top: -5e-06em;">
                     ∑
                    </span>
                    <span class="msupsub">
                     <span class="vlist-t vlist-t2">
                      <span class="vlist-r">
                       <span class="vlist" style="height: 0.981231em;">
                        <span class="" style="top: -2.40029em; margin-left: 0em; margin-right: 0.05em;">
                         <span class="pstrut" style="height: 2.7em;">
                         </span>
                         <span class="sizing reset-size6 size3 mtight">
                          <span class="mord mtight">
                           <span class="mord mathdefault mtight">
                            i
                           </span>
                           <span class="mrel mtight">
                            =
                           </span>
                           <span class="mord mtight">
                            1
                           </span>
                          </span>
                         </span>
                        </span>
                        <span class="" style="top: -3.2029em; margin-right: 0.05em;">
                         <span class="pstrut" style="height: 2.7em;">
                         </span>
                         <span class="sizing reset-size6 size3 mtight">
                          <span class="mord mtight">
                           <span class="mord mtight">
                            <span class="mord mathdefault mtight" style="margin-right: 0.05017em;">
                             B
                            </span>
                            <span class="msupsub">
                             <span class="vlist-t vlist-t2">
                              <span class="vlist-r">
                               <span class="vlist" style="height: 0.3448em;">
                                <span class="" style="top: -2.35671em; margin-left: -0.05017em; margin-right: 0.0714286em;">
                                 <span class="pstrut" style="height: 2.5em;">
                                 </span>
                                 <span class="sizing reset-size3 size1 mtight">
                                  <span class="mord mtight">
                                   <span class="mord mathdefault mtight" style="margin-right: 0.13889em;">
                                    T
                                   </span>
                                  </span>
                                 </span>
                                </span>
                               </span>
                               <span class="vlist-s">
                                ​
                               </span>
                              </span>
                              <span class="vlist-r">
                               <span class="vlist" style="height: 0.143293em;">
                                <span class="">
                                </span>
                               </span>
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                       <span class="vlist-s">
                        ​
                       </span>
                      </span>
                      <span class="vlist-r">
                       <span class="vlist" style="height: 0.29971em;">
                        <span class="">
                        </span>
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                   <span class="mspace" style="margin-right: 0.166667em;">
                   </span>
                   <span class="mord">
                    <span class="mord mathdefault" style="margin-right: 0.01968em;">
                     l
                    </span>
                    <span class="msupsub">
                     <span class="vlist-t">
                      <span class="vlist-r">
                       <span class="vlist" style="height: 0.888em;">
                        <span class="" style="top: -3.063em; margin-right: 0.05em;">
                         <span class="pstrut" style="height: 2.7em;">
                         </span>
                         <span class="sizing reset-size6 size3 mtight">
                          <span class="mord mtight">
                           <span class="mopen mtight">
                            (
                           </span>
                           <span class="mord mathdefault mtight">
                            i
                           </span>
                           <span class="mclose mtight">
                            )
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                   <span class="mord">
                    <span class="mord">
                     ∇
                    </span>
                    <span class="msupsub">
                     <span class="vlist-t vlist-t2">
                      <span class="vlist-r">
                       <span class="vlist" style="height: 0.336108em;">
                        <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                         <span class="pstrut" style="height: 2.7em;">
                         </span>
                         <span class="sizing reset-size6 size3 mtight">
                          <span class="mord mtight">
                           <span class="mord mtight">
                            <span class="mord mtight">
                             <span class="mord mtight">
                              <span class="mord boldsymbol mtight" style="margin-right: 0.03194em;">
                               θ
                              </span>
                             </span>
                            </span>
                            <span class="msupsub">
                             <span class="vlist-t vlist-t2">
                              <span class="vlist-r">
                               <span class="vlist" style="height: 0.3448em;">
                                <span class="" style="top: -2.35671em; margin-right: 0.0714286em;">
                                 <span class="pstrut" style="height: 2.5em;">
                                 </span>
                                 <span class="sizing reset-size3 size1 mtight">
                                  <span class="mord mtight">
                                   <span class="mord mathdefault mtight" style="margin-right: 0.13889em;">
                                    T
                                   </span>
                                  </span>
                                 </span>
                                </span>
                               </span>
                               <span class="vlist-s">
                                ​
                               </span>
                              </span>
                              <span class="vlist-r">
                               <span class="vlist" style="height: 0.143293em;">
                                <span class="">
                                </span>
                               </span>
                              </span>
                             </span>
                            </span>
                           </span>
                           <span class="mpunct mtight">
                            ,
                           </span>
                           <span class="mord mtight">
                            <span class="mord mtight">
                             <span class="mord boldsymbol mtight" style="margin-right: 0.03704em;">
                              ψ
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                       <span class="vlist-s">
                        ​
                       </span>
                      </span>
                      <span class="vlist-r">
                       <span class="vlist" style="height: 0.286108em;">
                        <span class="">
                        </span>
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                   <span class="mspace" style="margin-right: 0.166667em;">
                   </span>
                   <span class="mop">
                    lo
                    <span style="margin-right: 0.01389em;">
                     g
                    </span>
                   </span>
                   <span class="mspace" style="margin-right: 0.166667em;">
                   </span>
                   <span class="minner">
                    <span class="mopen delimcenter" style="top: 0em;">
                     <span class="delimsizing size2">
                      (
                     </span>
                    </span>
                    <span class="mord">
                     <span class="mord mathdefault" style="margin-right: 0.03588em;">
                      π
                     </span>
                     <span class="msupsub">
                      <span class="vlist-t vlist-t2">
                       <span class="vlist-r">
                        <span class="vlist" style="height: 0.336108em;">
                         <span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;">
                          <span class="pstrut" style="height: 2.7em;">
                          </span>
                          <span class="sizing reset-size6 size3 mtight">
                           <span class="mord mtight">
                            <span class="mord mtight">
                             <span class="mord mtight">
                              <span class="mord boldsymbol mtight" style="margin-right: 0.03704em;">
                               ψ
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                        </span>
                        <span class="vlist-s">
                         ​
                        </span>
                       </span>
                       <span class="vlist-r">
                        <span class="vlist" style="height: 0.286108em;">
                         <span class="">
                         </span>
                        </span>
                       </span>
                      </span>
                     </span>
                    </span>
                    <span class="mspace" style="margin-right: 0.166667em;">
                    </span>
                    <span class="minner">
                     <span class="mopen delimcenter" style="top: 0em;">
                      <span class="delimsizing size2">
                       (
                      </span>
                     </span>
                     <span class="mord">
                      <span class="mord">
                       <span class="mord mathbf">
                        x
                       </span>
                      </span>
                      <span class="msupsub">
                       <span class="vlist-t vlist-t2">
                        <span class="vlist-r">
                         <span class="vlist" style="height: 1.0448em;">
                          <span class="" style="top: -2.58341em; margin-right: 0.05em;">
                           <span class="pstrut" style="height: 2.7em;">
                           </span>
                           <span class="sizing reset-size6 size3 mtight">
                            <span class="mord mtight">
                             <span class="mord mathdefault mtight">
                              p
                             </span>
                            </span>
                           </span>
                          </span>
                          <span class="" style="top: -3.2198em; margin-right: 0.05em;">
                           <span class="pstrut" style="height: 2.7em;">
                           </span>
                           <span class="sizing reset-size6 size3 mtight">
                            <span class="mord mtight">
                             <span class="mopen mtight">
                              (
                             </span>
                             <span class="mord mathdefault mtight">
                              i
                             </span>
                             <span class="mclose mtight">
                              )
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                         <span class="vlist-s">
                          ​
                         </span>
                        </span>
                        <span class="vlist-r">
                         <span class="vlist" style="height: 0.2527em;">
                          <span class="">
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                     </span>
                     <span class="mord">
                      ∣
                     </span>
                     <span class="mord">
                      <span class="mord mathdefault" style="margin-right: 0.10764em;">
                       f
                      </span>
                      <span class="msupsub">
                       <span class="vlist-t vlist-t2">
                        <span class="vlist-r">
                         <span class="vlist" style="height: 1.0448em;">
                          <span class="" style="top: -2.39869em; margin-left: -0.10764em; margin-right: 0.05em;">
                           <span class="pstrut" style="height: 2.7em;">
                           </span>
                           <span class="sizing reset-size6 size3 mtight">
                            <span class="mord mtight">
                             <span class="mord mtight">
                              <span class="mord mtight">
                               <span class="mord mtight">
                                <span class="mord boldsymbol mtight" style="margin-right: 0.03194em;">
                                 θ
                                </span>
                               </span>
                              </span>
                              <span class="msupsub">
                               <span class="vlist-t vlist-t2">
                                <span class="vlist-r">
                                 <span class="vlist" style="height: 0.3448em;">
                                  <span class="" style="top: -2.35671em; margin-right: 0.0714286em;">
                                   <span class="pstrut" style="height: 2.5em;">
                                   </span>
                                   <span class="sizing reset-size3 size1 mtight">
                                    <span class="mord mtight">
                                     <span class="mord mathdefault mtight" style="margin-right: 0.13889em;">
                                      T
                                     </span>
                                    </span>
                                   </span>
                                  </span>
                                 </span>
                                 <span class="vlist-s">
                                  ​
                                 </span>
                                </span>
                                <span class="vlist-r">
                                 <span class="vlist" style="height: 0.143293em;">
                                  <span class="">
                                  </span>
                                 </span>
                                </span>
                               </span>
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                          <span class="" style="top: -3.2198em; margin-right: 0.05em;">
                           <span class="pstrut" style="height: 2.7em;">
                           </span>
                           <span class="sizing reset-size6 size3 mtight">
                            <span class="mord mtight">
                             <span class="mopen mtight">
                              (
                             </span>
                             <span class="mord mathdefault mtight" style="margin-right: 0.13889em;">
                              T
                             </span>
                             <span class="mclose mtight">
                              )
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                         <span class="vlist-s">
                          ​
                         </span>
                        </span>
                        <span class="vlist-r">
                         <span class="vlist" style="height: 0.401613em;">
                          <span class="">
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                     </span>
                     <span class="mspace" style="margin-right: 0.166667em;">
                     </span>
                     <span class="minner">
                      <span class="mopen delimcenter" style="top: 0em;">
                       <span class="delimsizing size2">
                        (
                       </span>
                      </span>
                      <span class="mord">
                       <span class="mord mathdefault">
                        m
                       </span>
                       <span class="msupsub">
                        <span class="vlist-t vlist-t2">
                         <span class="vlist-r">
                          <span class="vlist" style="height: 1.0448em;">
                           <span class="" style="top: -2.40647em; margin-left: 0em; margin-right: 0.05em;">
                            <span class="pstrut" style="height: 2.7em;">
                            </span>
                            <span class="sizing reset-size6 size3 mtight">
                             <span class="mord mtight">
                              <span class="mord mtight">
                               <span class="mord mathcal mtight" style="margin-right: 0.25417em;">
                                T
                               </span>
                              </span>
                             </span>
                            </span>
                           </span>
                           <span class="" style="top: -3.2198em; margin-right: 0.05em;">
                            <span class="pstrut" style="height: 2.7em;">
                            </span>
                            <span class="sizing reset-size6 size3 mtight">
                             <span class="mord mtight">
                              <span class="mopen mtight">
                               (
                              </span>
                              <span class="mord mathdefault mtight">
                               i
                              </span>
                              <span class="mclose mtight">
                               )
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                          <span class="vlist-s">
                           ​
                          </span>
                         </span>
                         <span class="vlist-r">
                          <span class="vlist" style="height: 0.293531em;">
                           <span class="">
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                      <span class="mclose delimcenter" style="top: 0em;">
                       <span class="delimsizing size2">
                        )
                       </span>
                      </span>
                     </span>
                     <span class="mclose delimcenter" style="top: 0em;">
                      <span class="delimsizing size2">
                       )
                      </span>
                     </span>
                    </span>
                    <span class="mclose delimcenter" style="top: 0em;">
                     <span class="delimsizing size2">
                      )
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
               <span class="vlist-s">
                ​
               </span>
              </span>
              <span class="vlist-r">
               <span class="vlist" style="height: 1.2901em;">
                <span class="">
                </span>
               </span>
              </span>
             </span>
            </span>
            <span class="arraycolsep" style="width: 0.5em;">
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     <br/>
     将
     <span class="katex--display">
      <span class="katex-display">
       <span class="katex">
        <span class="katex-mathml">
         ∇ 
              
              
              
                θ 
               
              
                T 
               
              
             
            
              log 
             
            
              ⁡ 
             
             
             
               ( 
              
             
               π 
              
              
              
                ( 
               
               
               
                 x 
                
               
                 p 
                
               
              
                ∣ 
               
              
                m 
               
              
                ) 
               
              
             
               ) 
              
             
            
           
          
         
         
          
           
            
             
            
              = 
             
             
              
              
                2 
               
               
                
                
                  1 
                 
                
                  − 
                 
                 
                 
                   σ 
                  
                 
                   π 
                  
                 
                   2 
                  
                 
                
               
              
              
              
                σ 
               
              
                π 
               
              
                2 
               
              
             
             
              
              
                ( 
               
               
               
                 ∇ 
                
                
                
                  θ 
                 
                
                  T 
                 
                
               
               
               
                 f 
                
                
                
                  θ 
                 
                
                  T 
                 
                
                
                
                  ( 
                 
                
                  T 
                 
                
                  ) 
                 
                
               
              
                ( 
               
              
                m 
               
              
                ) 
               
              
                ) 
               
              
             
               ⊤ 
              
             
             
             
               ( 
              
              
              
                x 
               
              
                p 
               
              
             
               − 
              
              
               
               
                 1 
                
               
                 − 
                
                
                
                  σ 
                 
                
                  π 
                 
                
                  2 
                 
                
               
              
              
              
                f 
               
               
               
                 θ 
                
               
                 T 
                
               
               
               
                 ( 
                
               
                 T 
                
               
                 ) 
                
               
              
             
               ( 
              
             
               m 
              
             
               ) 
              
             
               ) 
              
             
            
           
          
         
        
       
         \begin{array}{l}{\nabla_{\boldsymbol{\theta}_{T}} \log \left(\pi\left(\mathbf{x}_{p} | m\right)\right)} \\ {\quad=\frac{2 \sqrt{1-\sigma_{\pi}^{2}}}{\sigma_{\pi}^{2}}\left(\nabla_{\boldsymbol{\theta}_{T}} f_{\boldsymbol{\theta}_{T}}^{(T)}(m)\right)^{\top}\left(\mathbf{x}_{p}-\sqrt{1-\sigma_{\pi}^{2}} f_{\boldsymbol{\theta}_{T}}^{(T)}(m)\right)}\end{array}
        </span>
        <span class="katex-html">
         <span class="base">
          <span class="strut" style="height: 3.23903em; vertical-align: -1.36951em;">
          </span>
          <span class="mord">
           <span class="mtable">
            <span class="arraycolsep" style="width: 0.5em;">
            </span>
            <span class="col-align-l">
             <span class="vlist-t vlist-t2">
              <span class="vlist-r">
               <span class="vlist" style="height: 1.86951em;">
                <span class="" style="top: -4.41852em;">
                 <span class="pstrut" style="height: 3.38901em;">
                 </span>
                 <span class="mord">
                  <span class="mord">
                   <span class="mord">
                    <span class="mord">
                     ∇
                    </span>
                    <span class="msupsub">
                     <span class="vlist-t vlist-t2">
                      <span class="vlist-r">
                       <span class="vlist" style="height: 0.336108em;">
                        <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                         <span class="pstrut" style="height: 2.7em;">
                         </span>
                         <span class="sizing reset-size6 size3 mtight">
                          <span class="mord mtight">
                           <span class="mord mtight">
                            <span class="mord mtight">
                             <span class="mord mtight">
                              <span class="mord boldsymbol mtight" style="margin-right: 0.03194em;">
                               θ
                              </span>
                             </span>
                            </span>
                            <span class="msupsub">
                             <span class="vlist-t vlist-t2">
                              <span class="vlist-r">
                               <span class="vlist" style="height: 0.3448em;">
                                <span class="" style="top: -2.35671em; margin-right: 0.0714286em;">
                                 <span class="pstrut" style="height: 2.5em;">
                                 </span>
                                 <span class="sizing reset-size3 size1 mtight">
                                  <span class="mord mtight">
                                   <span class="mord mathdefault mtight" style="margin-right: 0.13889em;">
                                    T
                                   </span>
                                  </span>
                                 </span>
                                </span>
                               </span>
                               <span class="vlist-s">
                                ​
                               </span>
                              </span>
                              <span class="vlist-r">
                               <span class="vlist" style="height: 0.143293em;">
                                <span class="">
                                </span>
                               </span>
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                       <span class="vlist-s">
                        ​
                       </span>
                      </span>
                      <span class="vlist-r">
                       <span class="vlist" style="height: 0.250305em;">
                        <span class="">
                        </span>
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                   <span class="mspace" style="margin-right: 0.166667em;">
                   </span>
                   <span class="mop">
                    lo
                    <span style="margin-right: 0.01389em;">
                     g
                    </span>
                   </span>
                   <span class="mspace" style="margin-right: 0.166667em;">
                   </span>
                   <span class="minner">
                    <span class="mopen delimcenter" style="top: 0em;">
                     (
                    </span>
                    <span class="mord mathdefault" style="margin-right: 0.03588em;">
                     π
                    </span>
                    <span class="mspace" style="margin-right: 0.166667em;">
                    </span>
                    <span class="minner">
                     <span class="mopen delimcenter" style="top: 0em;">
                      (
                     </span>
                     <span class="mord">
                      <span class="mord">
                       <span class="mord mathbf">
                        x
                       </span>
                      </span>
                      <span class="msupsub">
                       <span class="vlist-t vlist-t2">
                        <span class="vlist-r">
                         <span class="vlist" style="height: 0.151392em;">
                          <span class="" style="top: -2.55em; margin-right: 0.05em;">
                           <span class="pstrut" style="height: 2.7em;">
                           </span>
                           <span class="sizing reset-size6 size3 mtight">
                            <span class="mord mtight">
                             <span class="mord mathdefault mtight">
                              p
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                         <span class="vlist-s">
                          ​
                         </span>
                        </span>
                        <span class="vlist-r">
                         <span class="vlist" style="height: 0.286108em;">
                          <span class="">
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                     </span>
                     <span class="mord">
                      ∣
                     </span>
                     <span class="mord mathdefault">
                      m
                     </span>
                     <span class="mclose delimcenter" style="top: 0em;">
                      )
                     </span>
                    </span>
                    <span class="mclose delimcenter" style="top: 0em;">
                     )
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
                <span class="" style="top: -2.66951em;">
                 <span class="pstrut" style="height: 3.38901em;">
                 </span>
                 <span class="mord">
                  <span class="mord">
                   <span class="mspace" style="margin-right: 1em;">
                   </span>
                   <span class="mrel">
                    =
                   </span>
                   <span class="mspace" style="margin-right: 0.277778em;">
                   </span>
                   <span class="mord">
                    <span class="mopen nulldelimiter">
                    </span>
                    <span class="mfrac">
                     <span class="vlist-t vlist-t2">
                      <span class="vlist-r">
                       <span class="vlist" style="height: 1.3296em;">
                        <span class="" style="top: -2.655em;">
                         <span class="pstrut" style="height: 3em;">
                         </span>
                         <span class="sizing reset-size6 size3 mtight">
                          <span class="mord mtight">
                           <span class="mord mtight">
                            <span class="mord mathdefault mtight" style="margin-right: 0.03588em;">
                             σ
                            </span>
                            <span class="msupsub">
                             <span class="vlist-t vlist-t2">
                              <span class="vlist-r">
                               <span class="vlist" style="height: 0.746314em;">
                                <span class="" style="top: -2.214em; margin-left: -0.03588em; margin-right: 0.0714286em;">
                                 <span class="pstrut" style="height: 2.5em;">
                                 </span>
                                 <span class="sizing reset-size3 size1 mtight">
                                  <span class="mord mtight">
                                   <span class="mord mathdefault mtight" style="margin-right: 0.03588em;">
                                    π
                                   </span>
                                  </span>
                                 </span>
                                </span>
                                <span class="" style="top: -2.786em; margin-right: 0.0714286em;">
                                 <span class="pstrut" style="height: 2.5em;">
                                 </span>
                                 <span class="sizing reset-size3 size1 mtight">
                                  <span class="mord mtight">
                                   <span class="mord mtight">
                                    2
                                   </span>
                                  </span>
                                 </span>
                                </span>
                               </span>
                               <span class="vlist-s">
                                ​
                               </span>
                              </span>
                              <span class="vlist-r">
                               <span class="vlist" style="height: 0.286em;">
                                <span class="">
                                </span>
                               </span>
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                        </span>
                        <span class="" style="top: -3.23em;">
                         <span class="pstrut" style="height: 3em;">
                         </span>
                         <span class="frac-line" style="border-bottom-width: 0.04em;">
                         </span>
                        </span>
                        <span class="" style="top: -3.61765em;">
                         <span class="pstrut" style="height: 3em;">
                         </span>
                         <span class="sizing reset-size6 size3 mtight">
                          <span class="mord mtight">
                           <span class="mord mtight">
                            2
                           </span>
                           <span class="mord sqrt mtight">
                            <span class="vlist-t vlist-t2">
                             <span class="vlist-r">
                              <span class="vlist" style="height: 1.01707em;">
                               <span class="svg-align" style="top: -3.42857em;">
                                <span class="pstrut" style="height: 3.42857em;">
                                </span>
                                <span class="mord mtight" style="padding-left: 1.19em;">
                                 <span class="mord mtight">
                                  1
                                 </span>
                                 <span class="mbin mtight">
                                  −
                                 </span>
                                 <span class="mord mtight">
                                  <span class="mord mathdefault mtight" style="margin-right: 0.03588em;">
                                   σ
                                  </span>
                                  <span class="msupsub">
                                   <span class="vlist-t vlist-t2">
                                    <span class="vlist-r">
                                     <span class="vlist" style="height: 0.746314em;">
                                      <span class="" style="top: -2.214em; margin-left: -0.03588em; margin-right: 0.0714286em;">
                                       <span class="pstrut" style="height: 2.5em;">
                                       </span>
                                       <span class="sizing reset-size3 size1 mtight">
                                        <span class="mord mtight">
                                         <span class="mord mathdefault mtight" style="margin-right: 0.03588em;">
                                          π
                                         </span>
                                        </span>
                                       </span>
                                      </span>
                                      <span class="" style="top: -2.786em; margin-right: 0.0714286em;">
                                       <span class="pstrut" style="height: 2.5em;">
                                       </span>
                                       <span class="sizing reset-size3 size1 mtight">
                                        <span class="mord mtight">
                                         <span class="mord mtight">
                                          2
                                         </span>
                                        </span>
                                       </span>
                                      </span>
                                     </span>
                                     <span class="vlist-s">
                                      ​
                                     </span>
                                    </span>
                                    <span class="vlist-r">
                                     <span class="vlist" style="height: 0.286em;">
                                      <span class="">
                                      </span>
                                     </span>
                                    </span>
                                   </span>
                                  </span>
                                 </span>
                                </span>
                               </span>
                               <span class="" style="top: -2.98907em;">
                                <span class="pstrut" style="height: 3.42857em;">
                                </span>
                                <span class="hide-tail mtight" style="min-width: 0.853em; height: 1.54286em;">
                                 <svg height="1.5428571428571431em" preserveaspectratio="xMinYMin slice" viewbox="0 0 400000 1080" width="400em">
                                  <path d="M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,
-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,
-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,
35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,
-221c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467
s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422
s-65,47,-65,47z M834 80H400000v40H845z">
                                  </path>
                                 </svg>
                                </span>
                               </span>
                              </span>
                              <span class="vlist-s">
                               ​
                              </span>
                             </span>
                             <span class="vlist-r">
                              <span class="vlist" style="height: 0.439504em;">
                               <span class="">
                               </span>
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                       <span class="vlist-s">
                        ​
                       </span>
                      </span>
                      <span class="vlist-r">
                       <span class="vlist" style="height: 0.5452em;">
                        <span class="">
                        </span>
                       </span>
                      </span>
                     </span>
                    </span>
                    <span class="mclose nulldelimiter">
                    </span>
                   </span>
                   <span class="mspace" style="margin-right: 0.166667em;">
                   </span>
                   <span class="minner">
                    <span class="minner">
                     <span class="mopen delimcenter" style="top: 0em;">
                      <span class="delimsizing size2">
                       (
                      </span>
                     </span>
                     <span class="mord">
                      <span class="mord">
                       ∇
                      </span>
                      <span class="msupsub">
                       <span class="vlist-t vlist-t2">
                        <span class="vlist-r">
                         <span class="vlist" style="height: 0.336108em;">
                          <span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;">
                           <span class="pstrut" style="height: 2.7em;">
                           </span>
                           <span class="sizing reset-size6 size3 mtight">
                            <span class="mord mtight">
                             <span class="mord mtight">
                              <span class="mord mtight">
                               <span class="mord mtight">
                                <span class="mord boldsymbol mtight" style="margin-right: 0.03194em;">
                                 θ
                                </span>
                               </span>
                              </span>
                              <span class="msupsub">
                               <span class="vlist-t vlist-t2">
                                <span class="vlist-r">
                                 <span class="vlist" style="height: 0.3448em;">
                                  <span class="" style="top: -2.35671em; margin-right: 0.0714286em;">
                                   <span class="pstrut" style="height: 2.5em;">
                                   </span>
                                   <span class="sizing reset-size3 size1 mtight">
                                    <span class="mord mtight">
                                     <span class="mord mathdefault mtight" style="margin-right: 0.13889em;">
                                      T
                                     </span>
                                    </span>
                                   </span>
                                  </span>
                                 </span>
                                 <span class="vlist-s">
                                  ​
                                 </span>
                                </span>
                                <span class="vlist-r">
                                 <span class="vlist" style="height: 0.143293em;">
                                  <span class="">
                                  </span>
                                 </span>
                                </span>
                               </span>
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                         <span class="vlist-s">
                          ​
                         </span>
                        </span>
                        <span class="vlist-r">
                         <span class="vlist" style="height: 0.250305em;">
                          <span class="">
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                     </span>
                     <span class="mord">
                      <span class="mord mathdefault" style="margin-right: 0.10764em;">
                       f
                      </span>
                      <span class="msupsub">
                       <span class="vlist-t vlist-t2">
                        <span class="vlist-r">
                         <span class="vlist" style="height: 1.0448em;">
                          <span class="" style="top: -2.39869em; margin-left: -0.10764em; margin-right: 0.05em;">
                           <span class="pstrut" style="height: 2.7em;">
                           </span>
                           <span class="sizing reset-size6 size3 mtight">
                            <span class="mord mtight">
                             <span class="mord mtight">
                              <span class="mord mtight">
                               <span class="mord mtight">
                                <span class="mord boldsymbol mtight" style="margin-right: 0.03194em;">
                                 θ
                                </span>
                               </span>
                              </span>
                              <span class="msupsub">
                               <span class="vlist-t vlist-t2">
                                <span class="vlist-r">
                                 <span class="vlist" style="height: 0.3448em;">
                                  <span class="" style="top: -2.35671em; margin-right: 0.0714286em;">
                                   <span class="pstrut" style="height: 2.5em;">
                                   </span>
                                   <span class="sizing reset-size3 size1 mtight">
                                    <span class="mord mtight">
                                     <span class="mord mathdefault mtight" style="margin-right: 0.13889em;">
                                      T
                                     </span>
                                    </span>
                                   </span>
                                  </span>
                                 </span>
                                 <span class="vlist-s">
                                  ​
                                 </span>
                                </span>
                                <span class="vlist-r">
                                 <span class="vlist" style="height: 0.143293em;">
                                  <span class="">
                                  </span>
                                 </span>
                                </span>
                               </span>
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                          <span class="" style="top: -3.2198em; margin-right: 0.05em;">
                           <span class="pstrut" style="height: 2.7em;">
                           </span>
                           <span class="sizing reset-size6 size3 mtight">
                            <span class="mord mtight">
                             <span class="mopen mtight">
                              (
                             </span>
                             <span class="mord mathdefault mtight" style="margin-right: 0.13889em;">
                              T
                             </span>
                             <span class="mclose mtight">
                              )
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                         <span class="vlist-s">
                          ​
                         </span>
                        </span>
                        <span class="vlist-r">
                         <span class="vlist" style="height: 0.401613em;">
                          <span class="">
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                     </span>
                     <span class="mopen">
                      (
                     </span>
                     <span class="mord mathdefault">
                      m
                     </span>
                     <span class="mclose">
                      )
                     </span>
                     <span class="mclose delimcenter" style="top: 0em;">
                      <span class="delimsizing size2">
                       )
                      </span>
                     </span>
                    </span>
                    <span class="msupsub">
                     <span class="vlist-t">
                      <span class="vlist-r">
                       <span class="vlist" style="height: 1.38901em;">
                        <span class="" style="top: -3.6029em; margin-right: 0.05em;">
                         <span class="pstrut" style="height: 2.7em;">
                         </span>
                         <span class="sizing reset-size6 size3 mtight">
                          <span class="mord mtight">
                           <span class="mord mtight">
                            ⊤
                           </span>
                          </span>
                         </span>
                        </span>
                       </span>
                      </span>
                     </span>
                    </span>
                   </span>
                   <span class="mspace" style="margin-right: 0.166667em;">
                   </span>
                   <span class="minner">
                    <span class="mopen delimcenter" style="top: 0em;">
                     <span class="delimsizing size2">
                      (
                     </span>
                    </span>
                    <span class="mord">
                     <span class="mord">
                      <span class="mord mathbf">
                       x
                      </span>
                     </span>
                     <span class="msupsub">
                      <span class="vlist-t vlist-t2">
                       <span class="vlist-r">
                        <span class="vlist" style="height: 0.151392em;">
                         <span class="" style="top: -2.55em; margin-right: 0.05em;">
                          <span class="pstrut" style="height: 2.7em;">
                          </span>
                          <span class="sizing reset-size6 size3 mtight">
                           <span class="mord mtight">
                            <span class="mord mathdefault mtight">
                             p
                            </span>
                           </span>
                          </span>
                         </span>
                        </span>
                        <span class="vlist-s">
                         ​
                        </span>
                       </span>
                       <span class="vlist-r">
                        <span class="vlist" style="height: 0.286108em;">
                         <span class="">
                         </span>
                        </span>
                       </span>
                      </span>
                     </span>
                    </span>
                    <span class="mspace" style="margin-right: 0.222222em;">
                    </span>
                    <span class="mbin">
                     −
                    </span>
                    <span class="mspace" style="margin-right: 0.222222em;">
                    </span>
                    <span class="mord sqrt">
                     <span class="vlist-t vlist-t2">
                      <span class="vlist-r">
                       <span class="vlist" style="height: 0.931554em;">
                        <span class="svg-align" style="top: -3.2em;">
                         <span class="pstrut" style="height: 3.2em;">
                         </span>
                         <span class="mord" style="padding-left: 1em;">
                          <span class="mord">
                           1
                          </span>
                          <span class="mspace" style="margin-right: 0.222222em;">
                          </span>
                          <span class="mbin">
                           −
                          </span>
                          <span class="mspace" style="margin-right: 0.222222em;">
                          </span>
                          <span class="mord">
                           <span class="mord mathdefault" style="margin-right: 0.03588em;">
                            σ
                           </span>
                           <span class="msupsub">
                            <span class="vlist-t vlist-t2">
                             <span class="vlist-r">
                              <span class="vlist" style="height: 0.740108em;">
                               <span class="" style="top: -2.453em; margin-left: -0.03588em; margin-right: 0.05em;">
                                <span class="pstrut" style="height: 2.7em;">
                                </span>
                                <span class="sizing reset-size6 size3 mtight">
                                 <span class="mord mtight">
                                  <span class="mord mathdefault mtight" style="margin-right: 0.03588em;">
                                   π
                                  </span>
                                 </span>
                                </span>
                               </span>
                               <span class="" style="top: -2.989em; margin-right: 0.05em;">
                                <span class="pstrut" style="height: 2.7em;">
                                </span>
                                <span class="sizing reset-size6 size3 mtight">
                                 <span class="mord mtight">
                                  <span class="mord mtight">
                                   2
                                  </span>
                                 </span>
                                </span>
                               </span>
                              </span>
                              <span class="vlist-s">
                               ​
                              </span>
                             </span>
                             <span class="vlist-r">
                              <span class="vlist" style="height: 0.247em;">
                               <span class="">
                               </span>
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                        </span>
                        <span class="" style="top: -2.89155em;">
                         <span class="pstrut" style="height: 3.2em;">
                         </span>
                         <span class="hide-tail" style="min-width: 1.02em; height: 1.28em;">
                          <svg height="1.28em" preserveaspectratio="xMinYMin slice" viewbox="0 0 400000 1296" width="400em">
                           <path d="M263,681c0.7,0,18,39.7,52,119c34,79.3,68.167,
158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120c340,-704.7,510.7,-1060.3,512,-1067
c4.7,-7.3,11,-11,19,-11H40000v40H1012.3s-271.3,567,-271.3,567c-38.7,80.7,-84,
175,-136,283c-52,108,-89.167,185.3,-111.5,232c-22.3,46.7,-33.8,70.3,-34.5,71
c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1s-109,-253,-109,-253c-72.7,-168,-109.3,
-252,-110,-252c-10.7,8,-22,16.7,-34,26c-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26
s76,-59,76,-59s76,-60,76,-60z M1001 80H40000v40H1012z">
                           </path>
                          </svg>
                         </span>
                        </span>
                       </span>
                       <span class="vlist-s">
                        ​
                       </span>
                      </span>
                      <span class="vlist-r">
                       <span class="vlist" style="height: 0.308446em;">
                        <span class="">
                        </span>
                       </span>
                      </span>
                     </span>
                    </span>
                    <span class="mord">
                     <span class="mord mathdefault" style="margin-right: 0.10764em;">
                      f
                     </span>
                     <span class="msupsub">
                      <span class="vlist-t vlist-t2">
                       <span class="vlist-r">
                        <span class="vlist" style="height: 1.0448em;">
                         <span class="" style="top: -2.39869em; margin-left: -0.10764em; margin-right: 0.05em;">
                          <span class="pstrut" style="height: 2.7em;">
                          </span>
                          <span class="sizing reset-size6 size3 mtight">
                           <span class="mord mtight">
                            <span class="mord mtight">
                             <span class="mord mtight">
                              <span class="mord mtight">
                               <span class="mord boldsymbol mtight" style="margin-right: 0.03194em;">
                                θ
                               </span>
                              </span>
                             </span>
                             <span class="msupsub">
                              <span class="vlist-t vlist-t2">
                               <span class="vlist-r">
                                <span class="vlist" style="height: 0.3448em;">
                                 <span class="" style="top: -2.35671em; margin-right: 0.0714286em;">
                                  <span class="pstrut" style="height: 2.5em;">
                                  </span>
                                  <span class="sizing reset-size3 size1 mtight">
                                   <span class="mord mtight">
                                    <span class="mord mathdefault mtight" style="margin-right: 0.13889em;">
                                     T
                                    </span>
                                   </span>
                                  </span>
                                 </span>
                                </span>
                                <span class="vlist-s">
                                 ​
                                </span>
                               </span>
                               <span class="vlist-r">
                                <span class="vlist" style="height: 0.143293em;">
                                 <span class="">
                                 </span>
                                </span>
                               </span>
                              </span>
                             </span>
                            </span>
                           </span>
                          </span>
                         </span>
                         <span class="" style="top: -3.2198em; margin-right: 0.05em;">
                          <span class="pstrut" style="height: 2.7em;">
                          </span>
                          <span class="sizing reset-size6 size3 mtight">
                           <span class="mord mtight">
                            <span class="mopen mtight">
                             (
                            </span>
                            <span class="mord mathdefault mtight" style="margin-right: 0.13889em;">
                             T
                            </span>
                            <span class="mclose mtight">
                             )
                            </span>
                           </span>
                          </span>
                         </span>
                        </span>
                        <span class="vlist-s">
                         ​
                        </span>
                       </span>
                       <span class="vlist-r">
                        <span class="vlist" style="height: 0.401613em;">
                         <span class="">
                         </span>
                        </span>
                       </span>
                      </span>
                     </span>
                    </span>
                    <span class="mopen">
                     (
                    </span>
                    <span class="mord mathdefault">
                     m
                    </span>
                    <span class="mclose">
                     )
                    </span>
                    <span class="mclose delimcenter" style="top: 0em;">
                     <span class="delimsizing size2">
                      )
                     </span>
                    </span>
                   </span>
                  </span>
                 </span>
                </span>
               </span>
               <span class="vlist-s">
                ​
               </span>
              </span>
              <span class="vlist-r">
               <span class="vlist" style="height: 1.36951em;">
                <span class="">
                </span>
               </span>
              </span>
             </span>
            </span>
            <span class="arraycolsep" style="width: 0.5em;">
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
    </p>
    <p>
     代入上式即可更新参数。
    </p>
    <p>
     现在可以回答之前遗留的小问题了：在训练发送端时，y=h
     <em>
      x
      <sub>
       p
      </sub>
      ；在训练接收端时，y=h
     </em>
     x
    </p>
    <blockquote>
     <p>
      关于接收端训练的一个疑问：为什么训练接收端时不经过sample policy，放松神经网络的输出？这样训练出来的接收端参数并
      <strong>
       不匹配
      </strong>
      实际使用的发送端学习到的编码策略
     </p>
    </blockquote>
    <h3>
     <a id="_82">
     </a>
     仿真结果
    </h3>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/380990afc3f63c1be08fbf0340183e2d.png"/>
    </p>
    <ul>
     <li>
      在高斯信道下，迭代的方法比监督学习算法收敛慢，但能得到几乎一样的性能
     </li>
     <li>
      在瑞利信道下，
      <strong>
       迭代的方法比监督学习算法收敛快，且性能更好
      </strong>
      。对此作者的解释是：监督学习算法中梯度直接受到信道响应的影响，该通道响应是随机的，因此导致高梯度方差。然而，利用交替方法，提供给发射机的损失受随机信道响应的影响较小，不会出现高梯度方差的问题。
     </li>
    </ul>
    <h3>
     <a id="_86">
     </a>
     我的理解
    </h3>
    <ul>
     <li>
      知道channel function肯定是有好处的，发送接收分开训练在避开channel function时带来的问题是，
      <strong>
       在训练发送端时需要的损失函数必须通过一个可靠的信道反馈给输入端
      </strong>
      （就好比现实中，好处总不能你一个人全占了，此消彼长嘛）。而在实际系统中，上行链路和下行链路是满足共轭关系的，这就表明这个训练方法其实只适合用在可靠信道上。这与
      <strong>
       作者的结论——由于不需要知道信道模型，此方法可以用在任何未知信道
      </strong>
      并不符合。
     </li>
     <li>
      看起来实现“避免使用信道模型”的是策略目标函数的形式，其实本质上是
      <strong>
       改变了损失函数作用于发送端的形式
      </strong>
      ：原来的方法通过反向传播作用，这个方法将损失通过上行链路
      <strong>
       反馈
      </strong>
      回发送端去更新参数，这样发送端就有了一个与loss有关的优化方向。就算不使用所谓的策略目标函数，使用其他的目标函数也是可以的。
     </li>
    </ul>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f67:2e6373646e2e6e65742f77656978696e5f3339323734363539:2f61727469636c652f64657461696c732f3839383136303538" class_="artid" style="display:none">
 </p>
</div>
