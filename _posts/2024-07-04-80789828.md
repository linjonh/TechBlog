---
layout: post
title: "数据库去重和查询指定记录区间数据"
date: 2024-07-04 16:46:21 +0800
description: "PostgreSQL数据库的去重与查询制定区间的记录数1、查询前N条记录数在PostgreSQL数据"
keywords: "区间数据去重计数"
categories: ['数据库相关']
tags: ['无标签']
artid: "80789828"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=80789828
    alt: "数据库去重和查询指定记录区间数据"
render_with_liquid: false
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     数据库去重和查询指定记录区间数据
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <p>
     <strong>
      <span style="color:#FF0000;">
       PostgreSQL
      </span>
      <span style="color:#FF0000;">
       数据库的去重与查询制定区间的记录数
      </span>
     </strong>
    </p>
    <p>
     <strong>
      1、查询前N条记录数
     </strong>
    </p>
    <p>
     在PostgreSQL数据库数据库中有一个limit函数用来查询前多少条
    </p>
    <p>
     SELECT * from  ag_actv  LIMIT 1050
    </p>
    <p>
     我们得到是 ag_actv 表中的1050行记录
    </p>
    <p>
     <strong>
      2、查询指定区间的记录数（如1000-1050）
     </strong>
    </p>
    <p>
     顺着这个思路的话我们就可得到指定区间的记录数，比如我们要查询1000到1050条之间的50条记录，我们可以先获取1050条就作为一个临时表，再从此表中查询，并让其主键id不等于前1000条记录中的id
    </p>
    <p>
     SELECT * from  (SELECT * from ag_actv   LIMIT 1050) sq WHERE sq.seq_num  not in  (SELECT seq_num  from ag_actv  LIMIT 1000)
    </p>
    <p>
     <strong>
      3、去重查询
     </strong>
    </p>
    <p>
     1、所有数据全部重复的话直接使用DISTINCT去重
    </p>
    <p>
     2 如果是主键id不同，只是记录中的某几个数据相同时，我们就需要采用分组统计来实现去重的操作
    </p>
    <p style="text-align:center;">
     <img alt="" src="https://i-blog.csdnimg.cn/blog_migrate/9215c7e1eeea37d753973343d4c2a09b.png">
      <br/>
     </img>
    </p>
    <p>
     <br/>
    </p>
    <p align="left">
     上图中sid为主键
    </p>
    <p>
     我们发现造成重复的是后面name,sex,class三列。
    </p>
    <p>
     于是我们就用分组函数以这三列作为分组的条件
    </p>
    <p>
     SELECT max(sid),name,sex,class FROM studentWHERE 1=1  GROUP BY name,sex,class 于是乎得到如下结果集
    </p>
    <p align="center">
     <img alt="" src="https://i-blog.csdnimg.cn/blog_migrate/533c790ad2e514ceb0e8cc63d96e202c.png"/>
    </p>
    <p>
     <strong>
      <span style="color:#FF0000;">
       Oracle
      </span>
      <span style="color:#FF0000;">
       数据库的去重与查询指定区间的记录数
      </span>
     </strong>
    </p>
    <p>
     1、       查询前N条记录（ROWNUM&lt;=100）
    </p>
    <p>
     select * FROM HVDN WhereROWNUM&lt;=100
    </p>
    <p>
     2、       查询指定的记录数（1000-1050）条记录数
    </p>
    <p>
     思路：首先查询表中前1050条记录，并显示出与之对应的行数，和信息数（注意：表一定要取别名，并用h.*来去表中的信息）
    </p>
    <p>
     SELECT * from (SELECT rownum as num,h.* FROM HVDN h Where ROWNUM&lt;=1050)  ss
    </p>
    <p>
     where ss.num&gt;1000 and ss.num&lt;=1050
    </p>
    <p>
     去重的方法所有数据库基本相同，找出重复的列在根据这些列（用GROUP BY函数）分组。
    </p>
    <p>
     可能不一定是最好的方法，但是基本可实现，如有更好的方法请加以指正。
    </p>
    <br/>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f67:2e6373646e2e6e65742f77656978696e5f3432333234343731:2f61727469636c652f64657461696c732f3830373839383238" class_="artid" style="display:none">
 </p>
</div>


