---
layout: post
title: "Linux-两服务器间配秘钥免密传输操作"
date: 2024-11-28 15:18:52 +0800
description: "很多情况下，我们都需要使用scp进行跨服务器之间的文件传输，但是在每一次进行传输时，都需要输入账号和"
keywords: "linux跨服务器复制文件 设置密码"
categories: ['Linux']
tags: ['服务器', '文件传输', 'Scp', 'Linux']
artid: "78459613"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=78459613
    alt: "Linux-两服务器间配秘钥免密传输操作"
render_with_liquid: false
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     Linux 两服务器间配秘钥免密传输操作
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <blockquote>
     <p>
      很多情况下，我们都需要使用scp进行跨服务器之间的文件传输，但是在每一次进行传输时，都需要输入账号和密码很是麻烦，而且如果在写shell脚本时需要此类操作则更是麻烦的不要不要的，因此我们现在可以通过配置秘钥的方式来解决这一麻烦的操作，让两服务器间的文件传输变得简单（但是会存在两服务器之间的安全问题，所以还是看具体需求再进行对应的配置）
     </p>
    </blockquote>
    <h4 id="1配置前">
     1.配置前
    </h4>
    <blockquote>
     <p>
      在未配置秘钥前，当每次进行scp传输时，需要进行输入密码操作
      <br/>
      <img alt="这里写图片描述" src="https://img-blog.csdn.net/20171106164645278?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbGlib3lhbmc3MQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" title="">
       <br/>
       接下来我们来进行秘钥配置，进行免密传输操作。
       <br/>
       为了更加明确哪些步骤是在哪个服务器上进行的操作，以下将要传输文件的服务器称为A服务器，将上图中ip为117.48.208.191(接收文件)的服务器称为B服务器。
      </img>
     </p>
    </blockquote>
    <h4 id="2配置秘钥">
     2.配置秘钥
    </h4>
    <h5 id="21-生成秘钥文件和私钥文件">
     2.1 生成秘钥文件和私钥文件
    </h5>
    <blockquote>
     <p>
      首先我们要在A服务器生成秘钥文件和私钥文件
     </p>
    </blockquote>
    <pre class="prettyprint"><code class="language-linux hljs lasso">ssh<span class="hljs-attribute">-keygen</span> <span class="hljs-attribute">-t</span> rsa </code></pre>
    <blockquote>
     <p>
      运行命令后，连续三次回车即可。如下图所示
      <br/>
      <img alt="这里写图片描述" src="https://img-blog.csdn.net/20171106165840975?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbGlib3lhbmc3MQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" title="">
       <br/>
       这样就在/root/.ssh/目录下，生成了id_rsa.pub和id_rsa两上文件。接下来，就要将id_rsa.pub文件上传到B服务器的/root/.ssh/目录下，重命名为authorized_keys,如果B服务器不存在root/.ssh/目录，则手动创建该目录即可。
      </img>
     </p>
    </blockquote>
    <p>
     之后再在A服务器上输入scp命令即可直接传输，如下图所示。
     <br/>
     <img alt="这里写图片描述" src="https://img-blog.csdn.net/20171106170536285?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbGlib3lhbmc3MQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" title=""/>
    </p>
    <blockquote>
     <p>
      如果需要配置允许多台服务器免密传输，则在目标服务器中的authorized_keys中添加多个服务器生成的秘钥即可，如图。
      <br/>
      <img alt="这里写图片描述" src="https://img-blog.csdn.net/20171106170709695?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbGlib3lhbmc3MQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" title="">
       <br/>
       本人在这台服务器上配置了允许三台服务器免密传输。
      </img>
     </p>
    </blockquote>
    <p>
     好了，以上就是服务器之间的免密传输操作。希望可以帮到更多的同学解决问题。
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f:2f626c6f672e6373646e2e6e65742f6c69626f79616e673731:2f61727469636c652f64657461696c732f3738343539363133" class_="artid" style="display:none">
 </p>
</div>


