---
layout: post
title: "私有云平台搭建OpenStack"
date: 2023-11-20 09:03:25 +0800
description: "私有云平台搭建——OpenStack搭建过程_openstack搭建私有云"
keywords: "openstack搭建私有云"
categories: ['']
tags: ['运维', 'Openstack']
artid: "134499437"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=134499437
    alt: "私有云平台搭建OpenStack"
render_with_liquid: false
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     私有云平台搭建——OpenStack
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <h3 style="margin-left:0px;text-align:center;">
    </h3>
    <h3 style="margin-left:0;text-align:justify;">
     5.1 实战案例使用脚本部署OpenStack平台
    </h3>
    <h4 style="margin-left:0;text-align:justify;">
     5.1.1 案例描述
    </h4>
    <p style="margin-left:.0001pt;text-align:justify;">
     （1）了解OpenStack平台部署方法
    </p>
    <p style="margin-left:.0001pt;text-align:justify;">
     （2）了解脚本部署方式
    </p>
    <p style="margin-left:.0001pt;text-align:justify;">
     （3）使用脚本部署OpenStack平台
    </p>
    <h4 style="margin-left:0;text-align:justify;">
     5.1.2 案例分析
    </h4>
    <h5 style="margin-left:0;text-align:justify;">
     1.部署架构
    </h5>
    <p style="margin-left:.0001pt;text-align:justify;">
     一台控制节点和一台计算节点组成简单架构OpenStack平台
    </p>
    <h5 style="margin-left:0;text-align:justify;">
     2.规划节点
    </h5>
    <p style="margin-left:.0001pt;text-align:justify;">
     192.168.190.10  controller  控制节点
    </p>
    <p style="margin-left:.0001pt;text-align:justify;">
     192.168.190.20  compute   计算节点
    </p>
    <p style="margin-left:.0001pt;text-align:justify;">
     第一张网卡为
     <span style="color:#ff0000;">
      仅主机模式
     </span>
     ，第二张网卡为
     <span style="color:#ff0000;">
      NAT
     </span>
     <span style="color:#ff0000;">
      模式
     </span>
     ，
    </p>
    <p style="margin-left:.0001pt;text-align:justify;">
     计算节点至少使用4 GB内存，
    </p>
    <p style="margin-left:.0001pt;text-align:justify;">
     硬盘不小于50 GB。
    </p>
    <p style="margin-left:.0001pt;text-align:justify;">
     给compute节点添加一块硬盘，分
     <span style="color:#ff0000;">
      两个区为
     </span>
     <span style="color:#ff0000;">
      sdb1
     </span>
     <span style="color:#ff0000;">
      与
     </span>
     <span style="color:#ff0000;">
      sdb2
     </span>
    </p>
    <p>
     <img alt="" height="146" src="https://i-blog.csdnimg.cn/blog_migrate/63804aa64f084643833574c0a0d3f16f.png" width="865"/>
    </p>
    <p style="margin-left:.0001pt;text-align:justify;">
     分区（下列步骤重复两次，分两个区）
    </p>
    <p>
     <img alt="" height="61" src="https://i-blog.csdnimg.cn/blog_migrate/eeeaad452234ae5d4b479c6f3e4ab575.png" width="583"/>
    </p>
    <p>
     <img alt="" height="236" src="https://i-blog.csdnimg.cn/blog_migrate/e6b584214b82436bcf123748b0d6d78f.png" width="865"/>
    </p>
    <h4 style="margin-left:0;text-align:justify;">
     5.1.3 案例实施
    </h4>
    <h5 style="margin-left:0;text-align:justify;">
     1.基础环境配置
    </h5>
    <h6 style="margin-left:0;text-align:justify;">
     （1）IP地址配置
    </h6>
    <p style="margin-left:.0001pt;text-align:justify;">
     Controller节点
    </p>
    <p>
     <img alt="" height="360" src="https://i-blog.csdnimg.cn/blog_migrate/318ee59d2edbb58daf3e9603af7c98f1.png" width="416"/>
    </p>
    <p style="margin-left:.0001pt;text-align:justify;">
     更改主机名
    </p>
    <p style="margin-left:.0001pt;text-align:justify;">
     hostnamectl set-hostname controller
    </p>
    <p style="margin-left:.0001pt;text-align:justify;">
     bash
    </p>
    <p style="margin-left:.0001pt;text-align:justify;">
    </p>
    <p style="margin-left:.0001pt;text-align:justify;">
     vim /etc/hosts
    </p>
    <p>
     <img alt="" height="96" src="https://i-blog.csdnimg.cn/blog_migrate/59fae02599f351508bc2daae6af73c5c.png" width="865"/>
    </p>
    <p style="margin-left:.0001pt;text-align:justify;">
    </p>
    <p style="margin-left:.0001pt;text-align:justify;">
     Compute节点
    </p>
    <p>
     <img alt="" height="417" src="https://i-blog.csdnimg.cn/blog_migrate/8cb90cd58a683fea175dd7cd6f64c084.png" width="498"/>
    </p>
    <p style="margin-left:.0001pt;text-align:justify;">
     hostnamectl set-hostname compute
    </p>
    <p style="margin-left:.0001pt;text-align:justify;">
     bash
    </p>
    <p style="margin-left:.0001pt;text-align:justify;">
    </p>
    <p style="margin-left:.0001pt;text-align:justify;">
     vim /etc/hosts
    </p>
    <p>
     <img alt="" height="114" src="https://i-blog.csdnimg.cn/blog_migrate/b2913f45147cb1858ab41e0b755ec96f.png" width="865"/>
    </p>
    <p style="margin-left:.0001pt;text-align:justify;">
    </p>
    <p style="margin-left:.0001pt;text-align:justify;">
    </p>
    <h6 style="margin-left:0;text-align:justify;">
     （2）上传基础镜像
    </h6>
    <p style="margin-left:.0001pt;text-align:justify;">
     上传chinaskills_cloud_iaas.iso和自己虚拟机使用的系统镜像（我这里是2009）两个镜像包至controller节点/root目录中（需要安装镜像下载文章尾端添加博主WX）
    </p>
    <p>
     <img alt="" height="93" src="https://i-blog.csdnimg.cn/blog_migrate/9df9c756d23160c4f6127a55f8b30f25.png" width="865"/>
    </p>
    <p style="margin-left:.0001pt;text-align:justify;">
    </p>
    <p style="margin-left:.0001pt;text-align:justify;">
     挂载
    </p>
    <p>
     <img alt="" height="36" src="https://i-blog.csdnimg.cn/blog_migrate/5b2af8b08bf162977ab9d6387b3a5066.png" width="673"/>
    </p>
    <p style="margin-left:.0001pt;text-align:justify;">
     mount CentOS-7-x86_64-DVD-2009.iso /mnt/
    </p>
    <p>
     <img alt="" height="63" src="https://i-blog.csdnimg.cn/blog_migrate/c553cb124a9419ba901a285b4de633e1.png" width="865"/>
    </p>
    <p style="margin-left:.0001pt;text-align:justify;">
    </p>
    <p style="margin-left:.0001pt;text-align:justify;">
     cp -rvf /mnt/* /opt/centos/
    </p>
    <p>
     <img alt="" height="155" src="https://i-blog.csdnimg.cn/blog_migrate/b0422dfa1a24c1d12b12e2434f1d814b.png" width="865"/>
    </p>
    <p style="margin-left:.0001pt;text-align:justify;">
    </p>
    <p style="margin-left:.0001pt;text-align:justify;">
     umount /mnt/
    </p>
    <p>
     <img alt="" height="44" src="https://i-blog.csdnimg.cn/blog_migrate/21a1d74bdf2125a36c9fdf774ae34204.png" width="583"/>
    </p>
    <p style="margin-left:.0001pt;text-align:justify;">
    </p>
    <p style="margin-left:.0001pt;text-align:justify;">
     mount chinaskills_cloud_iaas_v2.0.iso /mnt/
    </p>
    <p>
     <img alt="" height="59" src="https://i-blog.csdnimg.cn/blog_migrate/e497e878496dcd7e3de0d7b8a11bc689.png" width="865"/>
    </p>
    <p style="margin-left:.0001pt;text-align:justify;">
    </p>
    <p style="margin-left:.0001pt;text-align:justify;">
     cp -rvf  /mnt/*  /opt/
    </p>
    <p style="margin-left:.0001pt;text-align:justify;">
    </p>
    <h6 style="margin-left:0;text-align:justify;">
     （3）配置YUM源文件
    </h6>
    <p style="margin-left:.0001pt;text-align:justify;">
     controller节点
    </p>
    <p style="margin-left:.0001pt;text-align:justify;">
    </p>
    <p style="margin-left:.0001pt;text-align:justify;">
     rm -rf /etc/yum.repos.d/CentOS-*
    </p>
    <p>
     <img alt="" height="75" src="https://i-blog.csdnimg.cn/blog_migrate/257577dc459169c762f96012a163527d.png" width="865"/>
    </p>
    <p style="margin-left:.0001pt;text-align:justify;">
    </p>
    <p style="margin-left:.0001pt;text-align:justify;">
     vim /etc/yum.repos.d/local.repo
    </p>
    <p>
     <img alt="" height="249" src="https://i-blog.csdnimg.cn/blog_migrate/5fa85fdaa0e074678396d619cc746bfb.png" width="385"/>
    </p>
    <p style="margin-left:.0001pt;text-align:justify;">
    </p>
    <p style="margin-left:.0001pt;text-align:justify;">
     yum clean all
    </p>
    <p style="margin-left:.0001pt;text-align:justify;">
     yum repolist
    </p>
    <p>
     <img alt="" height="158" src="https://i-blog.csdnimg.cn/blog_migrate/f236eca516fa3d6f4853e9e84fa55117.png" width="788"/>
    </p>
    <p style="margin-left:.0001pt;text-align:justify;">
     标红位置如果为0 说明以上配置存在问题
    </p>
    <p style="margin-left:.0001pt;text-align:justify;">
    </p>
    <p style="margin-left:.0001pt;text-align:justify;">
     compute节点
    </p>
    <p style="margin-left:.0001pt;text-align:justify;">
    </p>
    <p style="margin-left:.0001pt;text-align:justify;">
     rm -rf /etc/yum.repos.d/CentOS-*
    </p>
    <p style="margin-left:.0001pt;text-align:justify;">
     vim /etc/yum.repos.d/local.repo
    </p>
    <p>
     <img alt="" height="73" src="https://i-blog.csdnimg.cn/blog_migrate/fd4bf1f7b0e8d3f1eb59ee4041657b07.png" width="865"/>
    </p>
    <p>
     <img alt="" height="237" src="https://i-blog.csdnimg.cn/blog_migrate/c61c372bcb85d88629e2acbdab355744.png" width="440"/>
    </p>
    <p style="margin-left:.0001pt;text-align:justify;">
    </p>
    <h6 style="margin-left:0;text-align:justify;">
     （4）控制节点安装ftp服务
    </h6>
    <p style="margin-left:.0001pt;text-align:justify;">
     <span style="color:#ff0000;">
      控制节点
     </span>
     安装vsftpd服务
    </p>
    <p style="margin-left:.0001pt;text-align:justify;">
     yum install vsftpd –y
    </p>
    <p>
     <img alt="" height="37" src="https://i-blog.csdnimg.cn/blog_migrate/b67a525de0e1e5aa8d2daba826928dc7.png" width="709"/>
    </p>
    <p style="margin-left:.0001pt;text-align:justify;">
     在/etc/vsftpd/vsftpd.conf配置中添加一行代码
    </p>
    <p style="margin-left:.0001pt;text-align:justify;">
     anon_root=/opt
    </p>
    <p>
     <img alt="" height="103" src="https://i-blog.csdnimg.cn/blog_migrate/ce8d51ca71aea8a6b92fb80b5033bfcc.png" width="817"/>
    </p>
    <p style="margin-left:.0001pt;text-align:justify;">
    </p>
    <p style="margin-left:.0001pt;text-align:justify;">
     重启vsftpd服务设置开机自启
    </p>
    <p style="margin-left:.0001pt;text-align:justify;">
     systemctl restart vsftpd
    </p>
    <p style="margin-left:.0001pt;text-align:justify;">
     systemctl enable vsftpd
    </p>
    <p>
     <img alt="" height="82" src="https://i-blog.csdnimg.cn/blog_migrate/c49d784c99e2bb032cce949ed1ba90d5.png" width="865"/>
    </p>
    <p style="margin-left:.0001pt;text-align:justify;">
    </p>
    <h6 style="margin-left:0;text-align:justify;">
     （5）配置防火墙策略
    </h6>
    <p style="margin-left:.0001pt;text-align:justify;">
     在
     <span style="color:#ff0000;">
      控制节点和计算节点
     </span>
     中关闭防火墙
    </p>
    <p>
     <img alt="" height="84" src="https://i-blog.csdnimg.cn/blog_migrate/cf8bbd9529d0addbf555e7a7f5bc25ff.png" width="809"/>
    </p>
    <p>
     <img alt="" height="86" src="https://i-blog.csdnimg.cn/blog_migrate/3123d95d2e57b1b6d88022c160320dd9.png" width="753"/>
    </p>
    <h6 style="margin-left:0;text-align:justify;">
     （6）安装iaas-xiandian服务
    </h6>
    <p style="margin-left:.0001pt;text-align:justify;">
     <span style="color:#ff0000;">
      在控制节点和计算节点
     </span>
     安装iaas-xiandian软件包
    </p>
    <p style="margin-left:.0001pt;text-align:justify;">
     yum install openstack-iaas  -y
    </p>
    <p>
     <img alt="" height="50" src="https://i-blog.csdnimg.cn/blog_migrate/79b8b92fac9f2f6ba36f78457cb00ff3.png" width="865"/>
    </p>
    <h6 style="margin-left:0;text-align:justify;">
     （7）配置环境变量
    </h6>
    <p style="margin-left:.0001pt;text-align:justify;">
     <span style="color:#ff0000;">
      控制节点和计算节点
     </span>
     配置环境变量的配置文件
     <span style="color:#ff0000;">
      /etc/xiandian/openrc.sh
     </span>
    </p>
    <p style="margin-left:.0001pt;text-align:justify;">
     vim /etc/openstack/openrc.sh
    </p>
    <p>
     <img alt="" height="33" src="https://i-blog.csdnimg.cn/blog_migrate/4dcfb9060a4d45f9cb852eee05c25b27.png" width="859"/>
    </p>
    <p style="margin-left:.0001pt;text-align:justify;">
     取消注释
    </p>
    <p>
     <img alt="" height="33" src="https://i-blog.csdnimg.cn/blog_migrate/25cf22740cb1629af039348f0f3eda32.png" width="173"/>
    </p>
    <p style="margin-left:.0001pt;text-align:justify;">
     更改内容
    </p>
    <p style="margin-left:.0001pt;text-align:justify;">
     <span style="color:#ff0000;">
      只要
     </span>
     <span style="color:#ff0000;">
      exmaple
     </span>
     <span style="color:#ff0000;">
      ：
     </span>
     <span style="color:#ff0000;">
      000000
     </span>
     <span style="color:#ff0000;">
      可以自定义密码但要相同，这里就拿出了特殊的地方看好怎么编辑
     </span>
    </p>
    <p>
     <img alt="" height="149" src="https://i-blog.csdnimg.cn/blog_migrate/23491aa9f5ece19bb446ca4377417f24.png" width="865"/>
    </p>
    <p>
     <img alt="" height="166" src="https://i-blog.csdnimg.cn/blog_migrate/10f7493c38bbb6fb5c846ae83814f6c1.png" width="865"/>
    </p>
    <p>
     <img alt="" height="161" src="https://i-blog.csdnimg.cn/blog_migrate/972df842d90be548f6cc3401d16f7f59.png" width="865"/>
    </p>
    <p>
     <img alt="" height="296" src="https://i-blog.csdnimg.cn/blog_migrate/7ff6b89aa4d3313c964a2bf42e2d05c9.png" width="865"/>
    </p>
    <p>
     <img alt="" height="76" src="https://i-blog.csdnimg.cn/blog_migrate/cb15f84729b56bf215895d73fc7f7faf.png" width="865"/>
    </p>
    <p style="margin-left:.0001pt;text-align:justify;">
     scp /etc/openstack/openrc.sh  @192.168.190.20: /etc/openstack/
    </p>
    <p>
     <img alt="" height="22" src="https://i-blog.csdnimg.cn/blog_migrate/4bb3335088b660a8194d041eadb48e48.png" width="865"/>
    </p>
    <p style="margin-left:.0001pt;text-align:justify;">
    </p>
    <h5 style="margin-left:0px;text-align:justify;">
     2. 用脚本安装OpenStack平台
    </h5>
    <h6 style="margin-left:0;text-align:justify;">
     1.安装基础服务
    </h6>
    <p style="margin-left:.0001pt;text-align:justify;">
     <span style="color:#ff0000;">
      控制节点和计算节点
     </span>
     通过脚本安装基础服务
    </p>
    <p style="margin-left:.0001pt;text-align:justify;">
     iaas-pre-host.sh
    </p>
    <p>
     <img alt="" height="119" src="https://i-blog.csdnimg.cn/blog_migrate/ff83aa2b3e9df466740d15c8e64548ca.png" width="708"/>
    </p>
    <p style="margin-left:.0001pt;text-align:justify;">
     reboot
    </p>
    <p style="margin-left:.0001pt;text-align:justify;">
     重启即可
    </p>
    <p style="margin-left:.0001pt;text-align:justify;">
    </p>
    <h6 style="margin-left:.0001pt;text-align:justify;">
     2.安装MySQL数据库服务
    </h6>
    <p style="margin-left:.0001pt;text-align:justify;">
     [root@controller~]# iaas-install-mysql.sh
    </p>
    <p>
     <img alt="" height="34" src="https://i-blog.csdnimg.cn/blog_migrate/d1bf5fef8fb1a777ebc3e0449b1c4563.png" width="766"/>
    </p>
    <p style="margin-left:.0001pt;text-align:justify;">
    </p>
    <h6 style="margin-left:.0001pt;text-align:justify;">
     3.安装Keystone认证服务
    </h6>
    <p style="margin-left:.0001pt;text-align:justify;">
     [root@controller ~]# iaas-install-keystone.sh
    </p>
    <p>
     <img alt="" height="44" src="https://i-blog.csdnimg.cn/blog_migrate/80a1aad861a0734a8d35d019ace18b3e.png" width="794"/>
    </p>
    <p style="margin-left:.0001pt;text-align:justify;">
    </p>
    <h6 style="margin-left:.0001pt;text-align:justify;">
     4.安装Glance镜像服务
    </h6>
    <p style="margin-left:.0001pt;text-align:justify;">
     [root@controller ~]# iaas-install-glance.sh
    </p>
    <p>
     <img alt="" height="50" src="https://i-blog.csdnimg.cn/blog_migrate/0bbc37b5834771ae9db9527cdcc07ee3.png" width="773"/>
    </p>
    <p style="margin-left:.0001pt;text-align:justify;">
    </p>
    <h6 style="margin-left:.0001pt;text-align:justify;">
     5.安装Nova计算服务
    </h6>
    <p style="margin-left:.0001pt;text-align:justify;">
     [root@controller ~]# iaas-install-nova-controller.sh
    </p>
    <p>
     <img alt="" height="44" src="https://i-blog.csdnimg.cn/blog_migrate/869bfc864db1cd13b7f7e7fedb445bbf.png" width="865"/>
    </p>
    <p style="margin-left:.0001pt;text-align:justify;">
     [root@compute~]# iaas-install-nova-compute.sh
    </p>
    <p>
     <img alt="" height="50" src="https://i-blog.csdnimg.cn/blog_migrate/9d75cbd72bdb69c97f8c62bdaaa30732.png" width="808"/>
    </p>
    <p style="margin-left:.0001pt;text-align:justify;">
    </p>
    <h6 style="margin-left:.0001pt;text-align:justify;">
     6.安装Neutron网络服务
    </h6>
    <p style="margin-left:.0001pt;text-align:justify;">
     [root@controller ~]# iaas-install-neutron-controller.sh
    </p>
    <p>
     <img alt="" height="40" src="https://i-blog.csdnimg.cn/blog_migrate/cf286b10654660e62fc46676a34dca94.png" width="865"/>
    </p>
    <p style="margin-left:.0001pt;text-align:justify;">
     [root@compute~]# iaas-install-neutron-compute.sh
    </p>
    <p>
     <img alt="" height="44" src="https://i-blog.csdnimg.cn/blog_migrate/123a923c0a682e306ee98e66686e9fc7.png" width="865"/>
    </p>
    <h6 style="margin-left:.0001pt;text-align:justify;">
     7.安装Dashboard服务
    </h6>
    <p style="margin-left:.0001pt;text-align:justify;">
     [root@controller ~]# iaas-install-dashboard.sh
    </p>
    <p>
     <img alt="" height="53" src="https://i-blog.csdnimg.cn/blog_migrate/b8e5aa60054cded6a795ecda12272d13.png" width="828"/>
    </p>
    <p>
     <img alt="" height="178" src="https://i-blog.csdnimg.cn/blog_migrate/59884228fa1c07fe9351224bad4bd8aa.png" width="865"/>
    </p>
    <h6 style="margin-left:.0001pt;text-align:justify;">
     8.安装Cinder块存储服务
    </h6>
    <p style="margin-left:.0001pt;text-align:justify;">
     [root@controller ~]# iaas-install-cinder-controller.sh
    </p>
    <p>
     <img alt="" height="45" src="https://i-blog.csdnimg.cn/blog_migrate/687bd6e142be02f1b372f9a92d906f5e.png" width="865"/>
    </p>
    <p style="margin-left:.0001pt;text-align:justify;">
     [root@compute~]# iaas-install-cinder-compute.sh
    </p>
    <p>
     <img alt="" height="44" src="https://i-blog.csdnimg.cn/blog_migrate/7bf022f989f9e1a43e1930f1cfabc6c9.png" width="856"/>
    </p>
    <p style="margin-left:.0001pt;text-align:justify;">
    </p>
    <h6 style="margin-left:.0001pt;text-align:justify;">
     9.安装Swift对象存储服务
    </h6>
    <p style="margin-left:.0001pt;text-align:justify;">
     [root@controller ~]# iaas-install-swift-controller.sh
    </p>
    <p>
     <img alt="" height="36" src="https://i-blog.csdnimg.cn/blog_migrate/34d82447bcde5fa6ec941ff9de219f87.png" width="865"/>
    </p>
    <p style="margin-left:.0001pt;text-align:justify;">
     [root@compute ~]# iaas-install-swift-compute.sh
    </p>
    <p>
     <img alt="" height="36" src="https://i-blog.csdnimg.cn/blog_migrate/7640b49686548fb1f15cb564be4f3cc5.png" width="823"/>
    </p>
    <p style="margin-left:.0001pt;text-align:justify;">
    </p>
    <h6 style="margin-left:.0001pt;text-align:justify;">
     10.访问Dashboard服务
    </h6>
    <p style="margin-left:.0001pt;text-align:justify;">
     <a href="http://192.168.190.10/dashboard" rel="nofollow" title="http://192.168.190.10/dashboard">
      http://192.168.190.10/dashboard
     </a>
    </p>
    <p style="margin-left:.0001pt;text-align:justify;">
     域为demo、用户名为admin、密码为000
    </p>
    <p>
     <img alt="" height="210" src="https://i-blog.csdnimg.cn/blog_migrate/a8c5b1ecaaa5b903a36fef364b356518.png" width="485"/>
    </p>
    <p>
     <img alt="" height="227" src="https://i-blog.csdnimg.cn/blog_migrate/181b75c4c9db3c31e16c2989ba6ab7b3.png" width="476"/>
    </p>
    <p>
    </p>
    <p>
    </p>
    <p>
     <img alt="" height="792" src="https://i-blog.csdnimg.cn/blog_migrate/a66797736e070e598e444f21ce337815.jpeg" width="581"/>
    </p>
    <p>
    </p>
    <p>
    </p>
    <p>
    </p>
    <p>
    </p>
    <p>
    </p>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f:672e6373646e2e6e65742f323330315f37393733393033362f:61727469636c652f64657461696c732f313334343939343337" class_="artid" style="display:none">
 </p>
</div>


