---
layout: post
title: "智能一代云平台十九选修课-类似秒杀的高并发业务"
date: 2017-03-30 17:35:47 +0800
description: "【前言】    选课，考试，评教这三个功能是我们的云平台中的重头戏；并发高是这三个功能的一个共同特点"
keywords: "选课系统高并发解决方案"
categories: ['智能一代云平台', '●项目实战']
tags: ['项目经验', '秒杀', '云平台']
artid: "67631670"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=67631670
    alt: "智能一代云平台十九选修课-类似秒杀的高并发业务"
render_with_liquid: false
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     智能一代云平台（十九）:选修课---类似秒杀的高并发业务
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <p>
     强烈推荐一个大神的人工智能的教程：
     <a href="http://www.captainai.net/zhanghan" rel="nofollow" title="http://www.captainai.net/zhanghan">
      http://www.captainai.net/zhanghan
     </a>
    </p>
    <h4>
     【前言】
    </h4>
    <p>
     选课，考试，评教这三个功能是我们的云平台中的重头戏；并发高是这三个功能的一个共同特点，在解决的过程中充满挑
    </p>
    <p>
     战，当然含金量也会高很多；今天就和大家一块儿分享一下我们针对高并发的业务的一些实践和解决思路。
    </p>
    <h4>
     【如何做好一个秒杀系统】
    </h4>
    <p>
     <strong>
      一、我们系统中遇到问题
     </strong>
    </p>
    <p>
     <span style="color:#4f4f4f;">
     </span>
     1、基础系统的公共选修课出现的问题：
    </p>
    <p>
     大家统一来选课时出现负数情况（类似电商中的超卖）；
    </p>
    <p>
     <span style="color:#4f4f4f;">
     </span>
     2、原因：
    </p>
    <p>
     由于判断是否课程选完是在页面做的控制，大家在加载页面的时候还有课程余量，但是实际上课程已被选完；而后
    </p>
    <p>
     端没有做课程余量的校验；
    </p>
    <p>
     <span style="color:#4f4f4f;">
     </span>
     3、解决办法：
    </p>
    <p>
     （1）在controller中提交课程方法时先去数据库中查询课程余量是否为0，但是无法防止并发情况，在方法上加
    </p>
    <p>
     synchronized；
    </p>
    <p>
     <span style="color:#4f4f4f;">
      ①
     </span>
     优点：实现简单；
    </p>
    <p>
     <span style="color:#4f4f4f;">
      ②
     </span>
     缺点：当部署是集群情况下会有问题；效率比较低；
    </p>
    <p>
     （2）利用乐观锁来控制
    </p>
    <p>
     <span style="color:#4f4f4f;">
      ①
     </span>
     优点：实现简单；
    </p>
    <p>
     <span style="color:#4f4f4f;">
     </span>
     ②缺点: 正在做相关实验，做完后会进行完善；
    </p>
    <p>
     （3）利用MQ来实现
    </p>
    <p>
     <span style="color:#4f4f4f;">
     </span>
     ①优点:速度上快；
    </p>
    <p>
     <span style="color:#4f4f4f;">
     </span>
     ②缺点:实现相对来说困难；
    </p>
    <p>
     <span style="color:#4f4f4f;">
      4
     </span>
     、模拟：
    </p>
    <p>
     <span style="color:#4f4f4f;">
     </span>
     用Jemeter通过录制脚本来进行的测试，通过压测接口这样来检查；并监控服务器的系统的性能的消耗。
    </p>
    <p>
     <strong>
      二、业界秒杀系统的思路
     </strong>
    </p>
    <p>
     <span style="color:#4f4f4f;">
     </span>
     1、大部分流量在cdn层已经拦截，直接返回给用户本次没选上；一般是随机进行筛选；
    </p>
    <p>
     <span style="color:#4f4f4f;">
      2
     </span>
     、真正能进入后端的流量非常少；
    </p>
    <p>
     <span style="color:#4f4f4f;">
      3
     </span>
     、针对大流量写入采用异步进行处理，课程余量在开始前已经预热加入到缓存中，每卖出一件缓存减1，为保证并发去
    </p>
    <p>
     减会设置相应的锁阀值，低于阈值后就会对课程余量操作加锁操作。
    </p>
    <h4>
     【总结】
    </h4>
    <p>
     随着互联网越来越深入；大流量，高并发已经成为很多系统的瓶颈，而如何处理好是一件十分具有挑战的事情；
    </p>
    <p>
     遇到挑战迎难而上，从而不断的磨砺自己，使自己成长的更快。
    </p>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f:2f626c6f672e6373646e2e6e65742f75303132383239313234:2f61727469636c652f64657461696c732f3637363331363730" class_="artid" style="display:none">
 </p>
</div>


