---
layout: post
title: -后端开发日志规范
date: 2025-01-15 10:56:37 +0800
categories: [日志规范]
tags: [日志规范,日志]
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=139030265
    alt: -后端开发日志规范
artid: 139030265
render_with_liquid: false
---
<p class="artid" style="display:none">$url</p>
<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     # 后端开发日志规范
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-tomorrow-night-eighties" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h2>
     <a id="_0">
     </a>
     后端开发日志规范
    </h2>
    <p>
    </p>
    <div class="toc">
     <h4>
      文章目录
     </h4>
     <ul>
      <li>
       <a href="#_0" rel="nofollow">
        后端开发日志规范
       </a>
      </li>
      <li>
       <ul>
        <li>
         <a href="#_3" rel="nofollow">
          日志的作用
         </a>
        </li>
        <li>
         <ul>
          <li>
           <a href="#_5" rel="nofollow">
            故障排查和调试
           </a>
          </li>
          <li>
           <a href="#_9" rel="nofollow">
            性能监控和优化
           </a>
          </li>
          <li>
           <a href="#_13" rel="nofollow">
            安全审计和监控
           </a>
          </li>
          <li>
           <a href="#_17" rel="nofollow">
            用户行为分析
           </a>
          </li>
         </ul>
        </li>
        <li>
         <a href="#_21" rel="nofollow">
          什么时候记录日志
         </a>
        </li>
        <li>
         <ul>
          <li>
           <a href="#_23" rel="nofollow">
            代码初始化时或进入逻辑入口时
           </a>
          </li>
          <li>
           <a href="#_27" rel="nofollow">
            编程语言提示异常
           </a>
          </li>
          <li>
           <a href="#_31" rel="nofollow">
            业务流程预期不符
           </a>
          </li>
          <li>
           <a href="#_35" rel="nofollow">
            系统/业务核心逻辑的关键动作
           </a>
          </li>
          <li>
           <a href="#_39" rel="nofollow">
            第三方服务远程调用
           </a>
          </li>
         </ul>
        </li>
        <li>
         <a href="#_43" rel="nofollow">
          日志记录原则
         </a>
        </li>
        <li>
         <ul>
          <li>
           <a href="#_45" rel="nofollow">
            清晰性和一致性
           </a>
          </li>
          <li>
           <a href="#_49" rel="nofollow">
            相关性
           </a>
          </li>
          <li>
           <a href="#_53" rel="nofollow">
            日志级别
           </a>
          </li>
          <li>
           <a href="#_57" rel="nofollow">
            时间戳
           </a>
          </li>
          <li>
           <a href="#_61" rel="nofollow">
            上下文信息
           </a>
          </li>
          <li>
           <a href="#_65" rel="nofollow">
            错误处理
           </a>
          </li>
          <li>
           <a href="#_69" rel="nofollow">
            性能影响
           </a>
          </li>
          <li>
           <a href="#_73" rel="nofollow">
            日志轮换和保留
           </a>
          </li>
         </ul>
        </li>
        <li>
         <a href="#_77" rel="nofollow">
          日志等级设置规范
         </a>
        </li>
        <li>
         <ul>
          <li>
           <a href="#DEBUG_79" rel="nofollow">
            DEBUG（调试）
           </a>
          </li>
          <li>
           <a href="#INFO_83" rel="nofollow">
            INFO（信息）
           </a>
          </li>
          <li>
           <a href="#WARN_88" rel="nofollow">
            WARN（警告）
           </a>
          </li>
          <li>
           <a href="#ERROR_93" rel="nofollow">
            ERROR（错误）
           </a>
          </li>
          <li>
           <a href="#TRACE_98" rel="nofollow">
            TRACE（跟踪）
           </a>
          </li>
          <li>
           <a href="#OFF_102" rel="nofollow">
            OFF（关闭）
           </a>
          </li>
         </ul>
        </li>
        <li>
         <a href="#_106" rel="nofollow">
          日志使用实践
         </a>
        </li>
        <li>
         <ul>
          <li>
           <a href="#_108" rel="nofollow">
            打印日志的代码不允许失败，阻断流程
           </a>
          </li>
          <li>
           <a href="#Systemoutprintln_120" rel="nofollow">
            禁止使用System.out.println()输出日志
           </a>
          </li>
          <li>
           <a href="#Log4jLogbackAPI_160" rel="nofollow">
            禁止直接使用日志系统(Log4j、Logback)中的API
           </a>
          </li>
          <li>
           <a href="#Loggerprivate_static_final_182" rel="nofollow">
            声明日志工具对象Logger应声明为private static final
           </a>
          </li>
          <li>
           <a href="#tracedebuginfo_196" rel="nofollow">
            对于trace/debug/info级别的日志输出，必须进行日志级别的开关判断
           </a>
          </li>
          <li>
           <a href="#eprintStackTrace_238" rel="nofollow">
            捕获异常后不要使用e.printStackTrace()打印日志
           </a>
          </li>
          <li>
           <a href="#_271" rel="nofollow">
            打印异常日志一定要输出全部错误信息
           </a>
          </li>
          <li>
           <a href="#JSONString_318" rel="nofollow">
            日志打印时禁止直接用JSON工具将对象转换成String
           </a>
          </li>
          <li>
           <a href="#id_346" rel="nofollow">
            不要打印无意义(无业务上下文、无关联日志链路id)的日志
           </a>
          </li>
          <li>
           <a href="#INFO_385" rel="nofollow">
            不要在循环中打印INFO级别日志
           </a>
          </li>
          <li>
           <a href="#_399" rel="nofollow">
            不要打印重复的日志
           </a>
          </li>
          <li>
           <a href="#_441" rel="nofollow">
            避免敏感信息输出
           </a>
          </li>
          <li>
           <a href="#_445" rel="nofollow">
            日志语言尽量使用英文
           </a>
          </li>
          <li>
           <a href="#_449" rel="nofollow">
            重要方法可以记录调用日志
           </a>
          </li>
          <li>
           <a href="#ifelse_461" rel="nofollow">
            在核心业务逻辑中遇到if...else等条件，尽量每个分支首行都打印日志
           </a>
          </li>
          <li>
           <a href="#_479" rel="nofollow">
            建议只打印必要的参数，不要整个对象打印
           </a>
          </li>
         </ul>
        </li>
       </ul>
      </li>
     </ul>
    </div>
    <p>
    </p>
    <h3>
     <a id="_3">
     </a>
     日志的作用
    </h3>
    <h4>
     <a id="_5">
     </a>
     故障排查和调试
    </h4>
    <ul>
     <li>
      日志记录了系统运行过程中的各种事件、操作和错误信息，有助于开发人员快速定位和解决问题，提高系统的稳定性和可靠性。
     </li>
    </ul>
    <h4>
     <a id="_9">
     </a>
     性能监控和优化
    </h4>
    <ul>
     <li>
      通过分析日志信息，可以了解系统的性能表现，包括请求响应时间、资源利用情况等，有助于发现性能瓶颈并进行优化。
     </li>
    </ul>
    <h4>
     <a id="_13">
     </a>
     安全审计和监控
    </h4>
    <ul>
     <li>
      日志记录了系统的操作轨迹和访问记录，可以用于安全审计和监控，及时发现异常行为和安全漏洞。
     </li>
    </ul>
    <h4>
     <a id="_17">
     </a>
     用户行为分析
    </h4>
    <ul>
     <li>
      通过分析用户的操作行为和访问记录，可以了解用户的偏好和行为习惯，为产品改进和优化提供参考。
     </li>
    </ul>
    <h3>
     <a id="_21">
     </a>
     什么时候记录日志
    </h3>
    <h4>
     <a id="_23">
     </a>
     代码初始化时或进入逻辑入口时
    </h4>
    <ul>
     <li>
      系统或者服务的启动参数。核心模块或者组件初始化过程中往往依赖一些关键配置，根据参数不同会提供不一样的服务。务必在这里记录
      <code>
       INFO
      </code>
      日志，打印出参数以及启动完成态服务表述。
     </li>
    </ul>
    <h4>
     <a id="_27">
     </a>
     编程语言提示异常
    </h4>
    <ul>
     <li>
      这类捕获的异常是系统告知开发人员需要加以关注的，是质量非常高的报错。应当适当记录日志，根据实际结合业务的情况使用
      <code>
       WARN
      </code>
      或者ERROR级别。
     </li>
    </ul>
    <h4>
     <a id="_31">
     </a>
     业务流程预期不符
    </h4>
    <ul>
     <li>
      项目代码中结果与期望不符时也是日志场景之一，简单来说所有流程分支都可以加入考虑。取决于开发人员判断能否容忍情形发生。常见的合适场景包括外部参数不正确，数据处理问题导致返回码不在合理范围内等等。
     </li>
    </ul>
    <h4>
     <a id="_35">
     </a>
     系统/业务核心逻辑的关键动作
    </h4>
    <ul>
     <li>
      系统中核心角色触发的业务动作是需要多加关注的，是衡量系统正常运行的重要指标，建议记录
      <code>
       INFO
      </code>
      级别日志。
     </li>
    </ul>
    <h4>
     <a id="_39">
     </a>
     第三方服务远程调用
    </h4>
    <ul>
     <li>
      微服务架构体系中有一个重要的点就是第三方永远不可信，对于第三方服务远程调用建议打印请求和响应的参数，方便在和各个终端定位问题，不会因为第三方服务日志的缺失变得手足无措。
     </li>
    </ul>
    <h3>
     <a id="_43">
     </a>
     日志记录原则
    </h3>
    <h4>
     <a id="_45">
     </a>
     清晰性和一致性
    </h4>
    <ul>
     <li>
      日志消息应该清晰、简洁，并且在格式上保持一致，以便开发人员更容易阅读和理解。
     </li>
    </ul>
    <h4>
     <a id="_49">
     </a>
     相关性
    </h4>
    <ul>
     <li>
      只记录与故障排查、监控或审计相关的信息。避免记录敏感信息，如密码或个人数据。
     </li>
    </ul>
    <h4>
     <a id="_53">
     </a>
     日志级别
    </h4>
    <ul>
     <li>
      适当使用不同的日志级别（如
      <code>
       DEBUG
      </code>
      、
      <code>
       INFO
      </code>
      、WARN、
      <code>
       ERROR
      </code>
      ）来指示日志消息的严重程度。这有助于过滤和优先处理日志消息。
     </li>
    </ul>
    <h4>
     <a id="_57">
     </a>
     时间戳
    </h4>
    <ul>
     <li>
      在日志消息中包含时间戳，以提供事件的时间顺序记录。这有助于理解操作的顺序和诊断问题。
     </li>
    </ul>
    <h4>
     <a id="_61">
     </a>
     上下文信息
    </h4>
    <ul>
     <li>
      在日志消息中包含相关的上下文信息，如请求参数、用户ID和错误详情，以提供更多的调试上下文。
     </li>
    </ul>
    <h4>
     <a id="_65">
     </a>
     错误处理
    </h4>
    <ul>
     <li>
      当发生异常时，记录详细的错误消息，包括堆栈跟踪。这些信息对于识别错误的根本原因至关重要。
     </li>
    </ul>
    <h4>
     <a id="_69">
     </a>
     性能影响
    </h4>
    <ul>
     <li>
      注意日志记录对性能的影响。避免过度记录可能降低系统性能的日志信息。
     </li>
    </ul>
    <h4>
     <a id="_73">
     </a>
     日志轮换和保留
    </h4>
    <ul>
     <li>
      实施日志轮换和保留策略，有效管理日志文件，并防止占用过多的磁盘空间。
     </li>
    </ul>
    <h3>
     <a id="_77">
     </a>
     日志等级设置规范
    </h3>
    <h4>
     <a id="DEBUG_79">
     </a>
     DEBUG（调试）
    </h4>
    <ul>
     <li>
      <code>
       DEUBG
      </code>
      级别的主要输出调试性质的内容，该级别日志主要用于在开发、测试阶段输出。该级别的日志应尽可能地详尽，开发人员可以将各类详细信息记录到
      <code>
       DEBUG
      </code>
      里，起到调试的作用，包括参数信息，调试细节信息，返回值信息等等，便于在开发、测试阶段出现问题或者异常时，对其进行分析。
     </li>
    </ul>
    <h4>
     <a id="INFO_83">
     </a>
     INFO（信息）
    </h4>
    <ul>
     <li>
      <code>
       INFO
      </code>
      级别的主要记录系统关键信息，旨在保留系统正常工作期间关键运行指标，开发人员可以将初始化系统配置、业务状态变化信息，或者用户业务流程中的核心处理记录到INFO日志中，方便日常运维工作以及错误回溯时上下文场景复现。
     </li>
     <li>
      建议在项目完成后，在测试环境将日志级别调成
      <code>
       INFO
      </code>
      ，然后通过
      <code>
       INFO
      </code>
      级别的信息看看是否能了解这个应用的运用情况，如果出现问题后是否这些日志能否提供有用的排查问题的信息。
     </li>
    </ul>
    <h4>
     <a id="WARN_88">
     </a>
     WARN（警告）
    </h4>
    <ul>
     <li>
      <code>
       WARN
      </code>
      级别的主要输出警告性质的内容，这些内容是可以预知且是有规划的，比如，某个方法入参为空或者该参数的值不满足运行该方法的条件时。
     </li>
     <li>
      在
      <code>
       WARN
      </code>
      级别的时应输出较为详尽的信息，以便于事后对日志进行分析。
     </li>
    </ul>
    <h4>
     <a id="ERROR_93">
     </a>
     ERROR（错误）
    </h4>
    <ul>
     <li>
      <code>
       ERROR
      </code>
      级别主要针对于一些不可预知的信息，诸如：错误、异常等，比如，在catch块中抓获的网络通信、数据库连接等异常，若异常对系统的整个流程影响不大，可以使用
      <code>
       WARN
      </code>
      级别日志输出。
     </li>
     <li>
      在输出
      <code>
       ERROR
      </code>
      级别的日志时，尽量多地输出方法入参数、方法执行过程中产生的对象等数据，在带有错误、异常对象的数据时，需要将该对象一并输出。
     </li>
    </ul>
    <h4>
     <a id="TRACE_98">
     </a>
     TRACE（跟踪）
    </h4>
    <ul>
     <li>
      用于记录非常详细的信息，有助于跟踪请求或操作在应用程序中的流程。跟踪消息比调试消息更为细致。
     </li>
    </ul>
    <h4>
     <a id="OFF_102">
     </a>
     OFF（关闭）
    </h4>
    <ul>
     <li>
      关闭所有日志记录。通常情况下不使用此级别，但可以在某些场景下设置为完全禁用日志记录。
     </li>
    </ul>
    <h3>
     <a id="_106">
     </a>
     日志使用实践
    </h3>
    <h4>
     <a id="_108">
     </a>
     打印日志的代码不允许失败，阻断流程
    </h4>
    <ul>
     <li>
      一定要确保不会因为日志打印语句抛出异常造成业务流程中断，如下图所示，
      <code>
       shop
      </code>
      为
      <code>
       null
      </code>
      的会导致抛出
      <code>
       NPE
      </code>
      。
     </li>
    </ul>
    <pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">doSth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"do sth and print log: {}"</span><span class="token punctuation">,</span> shop<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 业务逻辑</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre>
    <h4>
     <a id="Systemoutprintln_120">
     </a>
     禁止使用System.out.println()输出日志
    </h4>
    <p>
     反例：
    </p>
    <pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">doSth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"doSth..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 业务逻辑</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     分析：
    </p>
    <ul>
     <li>
      通过分析
      <code>
       System.out.println
      </code>
      源码可知，System.out.println是一个同步方法，在高并发的情况下，大量执行
      <code>
       println
      </code>
      方法会严重影响性能。
     </li>
    </ul>
    <pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">String</span> x<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">synchronized</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token function">print</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">newLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <ul>
     <li>
      不能实现日志按等级输出。具体来说就是不能和日志框架一样，有
      <code>
       debug
      </code>
      ，
      <code>
       info
      </code>
      ，
      <code>
       error
      </code>
      等级别的控制。
     </li>
     <li>
      System.out、System.error打印的日志都并没有打印在日志文件中，而是直接打印在终端，无法对日志进行收集。
     </li>
    </ul>
    <p>
     正例：
    </p>
    <p>
     在日常开发或者调试的过程中，尽量使用标准日志记录系统
     <code>
      log4j2
     </code>
     或者
     <code>
      logback
     </code>
     (但不要直接使用其中的
     <code>
      API
     </code>
     )，异步的进行日志统一收集。
    </p>
    <pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">doSth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"doSth..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 业务逻辑</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre>
    <h4>
     <a id="Log4jLogbackAPI_160">
     </a>
     禁止直接使用日志系统(Log4j、Logback)中的API
    </h4>
    <ul>
     <li>
      应用中不可直接使用日志系统(
      <code>
       Log4j
      </code>
      、Logback)中的
      <code>
       API
      </code>
      ，而应依赖使用日志框架 (SLF4J、
      <code>
       JCL--Jakarta Commons Logging
      </code>
      )中的API。
     </li>
    </ul>
    <p>
     分析：
    </p>
    <p>
     直接使用
     <code>
      Log4j
     </code>
     或者
     <code>
      Logback
     </code>
     中的API会导致系统代码实现强耦合日志系统，后续需要切换日志实现时会产生比较大的改造成本，统一使用
     <code>
      SLF4J
     </code>
     或者
     <code>
      JCL
     </code>
     等日志框架的
     <code>
      API
     </code>
     ，其是使用门面模式的日志框架，可以做到解耦具体日志实现的作用，有利于后续维护和保证各个类的日志处理方式统一。
    </p>
    <p>
     正例：
    </p>
    <pre><code class="prism language-java"><span class="token comment">// 使用 SLF4J:</span>
 <span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">Logger</span></span><span class="token punctuation">;</span>
 <span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">LoggerFactory</span></span><span class="token punctuation">;</span>
 <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">Logger</span> logger <span class="token operator">=</span> <span class="token class-name">LoggerFactory</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span>xxx<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

 <span class="token comment">// 使用 JCL:</span>
 <span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>commons<span class="token punctuation">.</span>logging<span class="token punctuation">.</span></span><span class="token class-name">Log</span></span><span class="token punctuation">;</span>
 <span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>commons<span class="token punctuation">.</span>logging<span class="token punctuation">.</span></span><span class="token class-name">LogFactory</span></span><span class="token punctuation">;</span>
 <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">Log</span> log <span class="token operator">=</span> <span class="token class-name">LogFactory</span><span class="token punctuation">.</span><span class="token function">getLog</span><span class="token punctuation">(</span>xxx<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
    <h4>
     <a id="Loggerprivate_static_final_182">
     </a>
     声明日志工具对象Logger应声明为private static final
    </h4>
    <p>
     分析：
    </p>
    <ul>
     <li>
      声明为
      <code>
       private
      </code>
      防止
      <code>
       logger
      </code>
      对象被其他类非法使用。
     </li>
     <li>
      声明为
      <code>
       static
      </code>
      是为了防止重复new出
      <code>
       logger
      </code>
      对象；防止
      <code>
       logger
      </code>
      被序列化，导致出现安全风险；处于资源考虑，logger的构造方法参数是
      <code>
       Class
      </code>
      ，决定了
      <code>
       logger
      </code>
      是根据类的结构来进行区分日志，所以一个类只要一个
      <code>
       logger
      </code>
      ，故
      <code>
       static
      </code>
      。
     </li>
     <li>
      声明为
      <code>
       final
      </code>
      是因为在类的生命周期无需变更logger，避免程序运行期对
      <code>
       logger
      </code>
      进行修改。
     </li>
    </ul>
    <p>
     正例：
    </p>
    <pre><code class="prism language-java"><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">Logger</span> <span class="token constant">LOGGER</span> <span class="token operator">=</span> <span class="token class-name">LoggerFactory</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span>xxx<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
    <h4>
     <a id="tracedebuginfo_196">
     </a>
     对于trace/debug/info级别的日志输出，必须进行日志级别的开关判断
    </h4>
    <p>
     反例：
    </p>
    <pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">doSth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token class-name">String</span> name <span class="token operator">=</span> <span class="token string">"xxx"</span><span class="token punctuation">;</span>
    logger<span class="token punctuation">.</span><span class="token function">trace</span><span class="token punctuation">(</span><span class="token string">"print debug log"</span> <span class="token operator">+</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    logger<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">"print debug log"</span> <span class="token operator">+</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"print info log"</span> <span class="token operator">+</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 业务逻辑</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     分析：
    </p>
    <p>
     如果配置的日志级别是
     <code>
      warn
     </code>
     的话，上述日志不会打印，但是会执行字符串拼接操作，如果
     <code>
      name
     </code>
     是对象， 还会执行
     <code>
      toString()
     </code>
     方法，浪费了系统资源，执行了上述操作，最终日志却没有打印，因此建议加日志开关判断。
    </p>
    <p>
     正例：
    </p>
    <p>
     在
     <code>
      trace
     </code>
     、
     <code>
      debug
     </code>
     、
     <code>
      info
     </code>
     级别日志打印前加上对应级别的日志开关判断，通常可以将开关判断逻辑包装在日志工具类中，统一实现。
    </p>
    <pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">doSth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>logger<span class="token punctuation">.</span><span class="token function">isTraceEnabled</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        logger<span class="token punctuation">.</span><span class="token function">trace</span><span class="token punctuation">(</span><span class="token string">"print trace log {}"</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>logger<span class="token punctuation">.</span><span class="token function">isDebugEnabled</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        logger<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">"print debug log {}"</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>logger<span class="token punctuation">.</span><span class="token function">isInfoEnabled</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"print info log {}"</span><span class="token punctuation">,</span> name<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 业务逻辑</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre>
    <h4>
     <a id="eprintStackTrace_238">
     </a>
     捕获异常后不要使用e.printStackTrace()打印日志
    </h4>
    <p>
     反例：
    </p>
    <pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">doSth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">try</span><span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 业务逻辑</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     分析：
    </p>
    <ul>
     <li>
      <code>
       e.printStackTrace()
      </code>
      打印出的堆栈日志跟业务代码日志是交错混合在一起的，通常排查异常日志不太方便。
     </li>
     <li>
      <code>
       e.printStackTrace()
      </code>
      语句产生的字符串记录的是堆栈信息，如果信息太长太多，字符串常量池所在的内存块没有空间了，即内存满了，系统请求将被阻塞。
     </li>
    </ul>
    <p>
     正例：
    </p>
    <pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">doSth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">try</span><span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 业务逻辑</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"execute failed"</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <h4>
     <a id="_271">
     </a>
     打印异常日志一定要输出全部错误信息
    </h4>
    <p>
     反例：
    </p>
    <ul>
     <li>
      没有打印异常
      <code>
       e
      </code>
      ，无法定位出现什么类型的异常
     </li>
    </ul>
    <pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">doSth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">try</span><span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 业务逻辑</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"execute failed"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <ul>
     <li>
      没有记录详细的堆栈异常信息，只记录错误基本描述信息，不利于排查问题。
     </li>
    </ul>
    <pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">doSth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">try</span><span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 业务逻辑</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"execute failed"</span><span class="token punctuation">,</span> e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     正例：
    </p>
    <p>
     一般日志框架中的
     <code>
      warn
     </code>
     、
     <code>
      error
     </code>
     级别均有存在传递
     <code>
      Throwable
     </code>
     异常类型的
     <code>
      API
     </code>
     ，可以直接将抛出的异常传入日志
     <code>
      API
     </code>
     中。
    </p>
    <pre><code class="prism language-java"><span class="token keyword">void</span> <span class="token function">error</span><span class="token punctuation">(</span><span class="token class-name">String</span> var1<span class="token punctuation">,</span> <span class="token class-name">Throwable</span> var2<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">doSth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">try</span><span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 业务逻辑</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"execute failed"</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <h4>
     <a id="JSONString_318">
     </a>
     日志打印时禁止直接用JSON工具将对象转换成String
    </h4>
    <p>
     反例：
    </p>
    <pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">doSth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"do sth and print log, data={}"</span><span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">toJSONString</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 业务逻辑</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     分析：
    </p>
    <ul>
     <li>
      <code>
       fastjson
      </code>
      等序列化组件是通过调用对象的
      <code>
       get
      </code>
      方法将对象进行序列化，如果对象里某些
      <code>
       get
      </code>
      方法被覆写，存在抛出异常的情况，则可能会因为打印日志而影响正常业务流程的执行。
     </li>
     <li>
      打日志过程中对一些对象的序列化过程也是比较耗性能的。首先序列化过程本身时一个计算密集型过程，费
      <code>
       cpu
      </code>
      。其次这个过程会产生很多中间对象，对内存也不太友好。
     </li>
    </ul>
    <p>
     正例：
    </p>
    <p>
     可以使用对象的
     <code>
      toString()
     </code>
     方法打印对象信息，如果代码中没有对
     <code>
      toString()
     </code>
     有定制化逻辑的话，可以使用
     <code>
      apache
     </code>
     的
     <code>
      ToStringBulider
     </code>
     工具。
    </p>
    <pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">doSth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"do sth and print log, data={}"</span><span class="token punctuation">,</span> data<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"do sth and print log, data={}"</span><span class="token punctuation">,</span> <span class="token class-name">ToStringBuilder</span><span class="token punctuation">.</span><span class="token function">reflectionToString</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token class-name">ToStringStyle</span><span class="token punctuation">.</span><span class="token constant">SHORT_PREFIX_STYLE</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <h4>
     <a id="id_346">
     </a>
     不要打印无意义(无业务上下文、无关联日志链路id)的日志
    </h4>
    <p>
     反例：
    </p>
    <ul>
     <li>
      不带任何业务信息的日志，对排查故障毫无意义。
     </li>
    </ul>
    <pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">doSth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"do sth and print log"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 业务逻辑</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre>
    <ul>
     <li>
      对于无异常分支的代码打印日志，一般流程下，异常分支都会打日志，如果没有出现异常，那就说明正常执行了。
     </li>
    </ul>
    <pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">doSth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token function">doIt1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"do sth 111"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">doIt2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"do sth 222"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     正例：
    </p>
    <ul>
     <li>
      日志一定要带相关的业务信息，有利于排查问题快速定位到原因。
     </li>
    </ul>
    <pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">doSth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"do sth and print log, id={}"</span><span class="token punctuation">,</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 业务逻辑</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre>
    <ul>
     <li>
      对于打印过多的无意义日志，可以直接干掉或者以debug级别打印。
     </li>
    </ul>
    <h4>
     <a id="INFO_385">
     </a>
     不要在循环中打印INFO级别日志
    </h4>
    <p>
     反例：
    </p>
    <pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">doSth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">String</span> s <span class="token operator">:</span> strList<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"do sth and print log: {}"</span><span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 业务逻辑</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <h4>
     <a id="_399">
     </a>
     不要打印重复的日志
    </h4>
    <p>
     反例：
    </p>
    <pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">doSth</span><span class="token punctuation">(</span><span class="token class-name">String</span> s<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"do sth and print log: {}"</span><span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">doStep</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">doStep</span><span class="token punctuation">(</span><span class="token class-name">String</span> s<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"do sth and print log: {}"</span><span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 业务逻辑</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">doSth</span><span class="token punctuation">(</span><span class="token class-name">String</span> s<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
      <span class="token function">doStep</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
      log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"something wrong"</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">doStep</span><span class="token punctuation">(</span><span class="token class-name">String</span> s<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 业务逻辑</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"something wrong"</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">throw</span> e<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     分析：
    </p>
    <ul>
     <li>
      在每一个嵌套环节都打印了重复的日志。
     </li>
     <li>
      不要记录日志后又抛出异常。抛出去的异常，一般外层会处理。如果不处理，那为什么还要抛出去？原则是，无论是否发生异常，都不要在不同地方重复记录针对同一事件的日志消息。
     </li>
    </ul>
    <p>
     正例：
    </p>
    <p>
     直接干掉或者将日志降级成debug级别日志
    </p>
    <h4>
     <a id="_441">
     </a>
     避免敏感信息输出
    </h4>
    <ul>
     <li>
      敏感信息输出会存在安全漏洞
     </li>
    </ul>
    <h4>
     <a id="_445">
     </a>
     日志语言尽量使用英文
    </h4>
    <p>
     建议：尽量在打印日志时输出英文，防止中文编码与终端不一致导致打印出现乱码的情况，对故障定位和排查存在一定的干扰。
    </p>
    <h4>
     <a id="_449">
     </a>
     重要方法可以记录调用日志
    </h4>
    <p>
     建议在重要方法入口记录方法调用日志，出口打印出参，对于排查问题会有很大的帮助。
    </p>
    <pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">doSth</span><span class="token punctuation">(</span><span class="token class-name">String</span> id<span class="token punctuation">,</span> <span class="token class-name">String</span> type<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"start: {}, {}"</span><span class="token punctuation">,</span> id<span class="token punctuation">,</span> type<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> res <span class="token operator">=</span> <span class="token function">process</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span> type<span class="token punctuation">)</span><span class="token punctuation">;</span>
    log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"end: {}, {}, {}"</span><span class="token punctuation">,</span> id<span class="token punctuation">,</span> type<span class="token punctuation">,</span> res<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <h4>
     <a id="ifelse_461">
     </a>
     在核心业务逻辑中遇到if…else等条件，尽量每个分支首行都打印日志
    </h4>
    <p>
     在编写核心业务逻辑代码时，如遇到if…else…或者switch这样的条件，可以在分支的首行就打印日志，这样排查问题时，就可以通过日志，确定进入了哪个分支，代码逻辑更清晰，也更方便排查问题了。
    </p>
    <p>
     建议：
    </p>
    <pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">doSth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span><span class="token function">isVip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"该用户是会员,Id:{},开始处理会员逻辑"</span><span class="token punctuation">,</span>user<span class="token punctuation">,</span><span class="token function">getUserId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//会员逻辑</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{<!-- --></span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"该用户是非会员,Id:{},开始处理非会员逻辑"</span><span class="token punctuation">,</span>user<span class="token punctuation">,</span><span class="token function">getUserId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token comment">//非会员逻辑</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <h4>
     <a id="_479">
     </a>
     建议只打印必要的参数，不要整个对象打印
    </h4>
    <p>
     反例：
    </p>
    <pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">doSth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"print log, data={}"</span><span class="token punctuation">,</span> data<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 业务逻辑</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     分析：
    </p>
    <p>
     首先分析下自己是否必须把所有对象里的字段打印出来？如果对象中有50个字段，但只需其中两个参数就可以定位具体的原因，那么全量打印字段将浪费内容空间且因为字段过多，影响根因排查。
    </p>
    <p>
     正例：
    </p>
    <pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">doSth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"print log, id={}, type={}"</span><span class="token punctuation">,</span> data<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> data<span class="token punctuation">.</span><span class="token function">getType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 业务逻辑</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
   <span class="token comment">//会员逻辑</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{<!-- --></span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"该用户是非会员,Id:{},开始处理非会员逻辑"</span><span class="token punctuation">,</span>user<span class="token punctuation">,</span><span class="token function">getUserId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token comment">//非会员逻辑</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
</div>


