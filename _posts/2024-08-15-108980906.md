---
layout: post
title: "H3C-Neighbor-Discovery-Protocol,邻居发现协议"
date: 2024-08-15 21:57:50 +0800
description: "NDP（Neighbor Discovery Protocol，邻居发现协议）属于HGMP协议的一部"
keywords: "h3c邻居发现协议命令"
categories: ["未分类"]
tags: ["无标签"]
artid: "108980906"
image:
  path: https://api.vvhan.com/api/bing?rand=sj&artid=108980906
  alt: "H3C-Neighbor-Discovery-Protocol,邻居发现协议"
render_with_liquid: false
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     H3C Neighbor Discovery Protocol，邻居发现协议
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <p style="margin-left:0cm;">
     <span style="color:#4d4d4d;">
      NDP
     </span>
     <span style="color:#4d4d4d;">
      （
     </span>
     <span style="color:#4d4d4d;">
      Neighbor Discovery Protocol
     </span>
     <span style="color:#4d4d4d;">
      ，邻居发现协议）属于
     </span>
     <span style="color:#4d4d4d;">
      HGMP
     </span>
     <span style="color:#4d4d4d;">
      协议的一部分，用来发现直接相连的邻居设备信息，包括邻接设备的类型、软
     </span>
     <span style="color:#4d4d4d;">
      /
     </span>
     <span style="color:#4d4d4d;">
      硬件版本、连接端口、设备
     </span>
     <span style="color:#4d4d4d;">
      ID
     </span>
     <span style="color:#4d4d4d;">
      、端口地址、硬件平台等。
     </span>
    </p>
    <p style="margin-left:0cm;">
     <a name="_Toc33081779">
      <span style="color:#4ea1db;">
       2.2.1
      </span>
     </a>
     <span style="color:#4ea1db;">
      使能系统的
     </span>
     <span style="color:#4ea1db;">
      NDP
     </span>
     <span style="color:#4d4d4d;">
      特性
     </span>
    </p>
    <p style="margin-left:0cm;">
     <span style="color:#4d4d4d;">
      要收集端口邻接设备发送的
     </span>
     <span style="color:#4d4d4d;">
      NDP
     </span>
     <span style="color:#4d4d4d;">
      信息，用户需要在交换机上使能系统
     </span>
     <span style="color:#4d4d4d;">
      NDP
     </span>
     <span style="color:#4d4d4d;">
      特性。当系统
     </span>
     <span style="color:#4d4d4d;">
      NDP
     </span>
     <span style="color:#4d4d4d;">
      使能后，交换机将定时收集
     </span>
     <span style="color:#4d4d4d;">
      NDP
     </span>
     <span style="color:#4d4d4d;">
      信息，用户可以使用
     </span>
     <span style="color:#4d4d4d;">
      display ndp
     </span>
     <span style="color:#4d4d4d;">
      命令查询这些信息；当系统的
     </span>
     <span style="color:#4d4d4d;">
      NDP
     </span>
     <span style="color:#4d4d4d;">
      特性禁止后，交换机将清除交换机保存的所有
     </span>
     <span style="color:#4d4d4d;">
      NDP
     </span>
     <span style="color:#4d4d4d;">
      邻居信息，但是仍然会转发
     </span>
     <span style="color:#4d4d4d;">
      NDP
     </span>
     <span style="color:#4d4d4d;">
      报文。
     </span>
    </p>
    <p style="margin-left:0cm;">
     <a name="_Toc17621625">
     </a>
     <a name="_Toc142278715">
     </a>
     <a name="_Toc46128896">
     </a>
     <a name="_Toc33081705">
     </a>
     <span style="color:#4ea1db;">
      表
     </span>
     <span style="color:#4ea1db;">
      2-2
     </span>
     <span style="color:#4ea1db;">
      使能系统的
     </span>
     <span style="color:#4ea1db;">
      NDP
     </span>
     <span style="color:#4d4d4d;">
      特性
     </span>
    </p>
    <table border="1" cellspacing="0">
     <tbody>
      <tr>
       <td style="border-color:#000000;width:100.5pt;">
        <p style="margin-left:0cm;">
         <span style="color:#4f4f4f;">
          操作
         </span>
        </p>
       </td>
       <td style="border-color:#000000;width:162.75pt;">
        <p style="margin-left:0cm;">
         <span style="color:#4f4f4f;">
          命令
         </span>
        </p>
       </td>
       <td style="border-color:#000000;width:115.5pt;">
        <p style="margin-left:0cm;">
         <span style="color:#4f4f4f;">
          说明
         </span>
        </p>
       </td>
      </tr>
      <tr>
       <td style="border-color:#000000;width:100.5pt;">
        <p style="margin-left:0cm;">
         <span style="color:#4f4f4f;">
          进入系统视图
         </span>
        </p>
       </td>
       <td style="width:162.75pt;">
        <p style="margin-left:0cm;">
         <strong>
          <span style="color:#4f4f4f;">
           system-view
          </span>
         </strong>
        </p>
       </td>
       <td style="width:115.5pt;">
        <p style="margin-left:0cm;">
         <span style="color:#4f4f4f;">
          -
         </span>
        </p>
       </td>
      </tr>
      <tr>
       <td style="border-color:#000000;width:100.5pt;">
        <p style="margin-left:0cm;">
         <span style="color:#4f4f4f;">
          使能系统NDP特性
         </span>
        </p>
       </td>
       <td style="width:162.75pt;">
        <p style="margin-left:0cm;">
         <strong>
          <span style="color:#4f4f4f;">
           ndp enable
          </span>
         </strong>
         <span style="color:#4f4f4f;">
          [
          <strong>
           interface
          </strong>
          <em>
           port-list
          </em>
          |
          <strong>
           all
          </strong>
          ]
         </span>
        </p>
       </td>
       <td style="border-color:#000000;width:115.5pt;">
        <p style="margin-left:0cm;">
         <span style="color:#4f4f4f;">
          缺省情况下，系统关闭NDP特性
         </span>
        </p>
       </td>
      </tr>
     </tbody>
    </table>
    <p style="margin-left:0cm;">
    </p>
    <p style="margin-left:0cm;">
     <span style="color:#4d4d4d;">
      &amp;
     </span>
     <span style="color:#4d4d4d;">
      说明：
     </span>
    </p>
    <p style="margin-left:0cm;">
     <span style="color:#4d4d4d;">
      使能所有端口的
     </span>
     <span style="color:#4d4d4d;">
      NDP
     </span>
     <span style="color:#4d4d4d;">
      时，被使能的端口只包括支持
     </span>
     <span style="color:#4d4d4d;">
      NDP
     </span>
     <span style="color:#4d4d4d;">
      协议接口板的端口：普通以太网端口以及千兆以太网端口。
     </span>
    </p>
    <p style="margin-left:0cm;">
    </p>
    <p style="margin-left:0cm;">
     <a name="_Toc33081780">
     </a>
     <a name="_Toc216233105">
     </a>
     <a name="_Toc215913296">
     </a>
     <a name="_Toc168890929">
     </a>
     <a name="_Toc127757209">
     </a>
     <a name="_Toc125168332">
     </a>
     <a name="_Ref124930302">
     </a>
     <a name="_Ref124930299">
     </a>
     <a name="_Toc119485133">
     </a>
     <span style="color:#4ea1db;">
      2.2.2
     </span>
     <span style="color:#4ea1db;">
      配置端口的
     </span>
     <span style="color:#4ea1db;">
      NDP
     </span>
     特性
    </p>
    <p style="margin-left:0cm;">
     <span style="color:#4d4d4d;">
      用户可以控制端口的
     </span>
     <span style="color:#4d4d4d;">
      NDP
     </span>
     <span style="color:#4d4d4d;">
      使能
     </span>
     <span style="color:#4d4d4d;">
      /
     </span>
     <span style="color:#4d4d4d;">
      禁止状态，从而控制对指定端口进行邻接设备的信息收集。如果使能端口的
     </span>
     <span style="color:#4d4d4d;">
      NDP
     </span>
     <span style="color:#4d4d4d;">
      特性，并且启动了系统
     </span>
     <span style="color:#4d4d4d;">
      NDP
     </span>
     <span style="color:#4d4d4d;">
      ，则系统将定时收集该端口邻接节点的
     </span>
     <span style="color:#4d4d4d;">
      NDP
     </span>
     <span style="color:#4d4d4d;">
      邻居信息；如果禁止端口
     </span>
     <span style="color:#4d4d4d;">
      NDP
     </span>
     <span style="color:#4d4d4d;">
      特性，则系统不能通过该端口收集
     </span>
     <span style="color:#4d4d4d;">
      NDP
     </span>
     <span style="color:#4d4d4d;">
      信息。
     </span>
    </p>
    <p style="margin-left:0cm;">
     <a name="_Toc17621626">
     </a>
     <a name="_Toc142278716">
     </a>
     <a name="_Toc46128897">
     </a>
     <a name="_Toc33081706">
     </a>
     <span style="color:#4ea1db;">
      表
     </span>
     <span style="color:#4ea1db;">
      2-3
     </span>
     <span style="color:#4ea1db;">
      配置端口的
     </span>
     <span style="color:#4ea1db;">
      NDP
     </span>
     <span style="color:#4d4d4d;">
      特性
     </span>
    </p>
    <table border="1" cellspacing="0">
     <tbody>
      <tr>
       <td style="border-color:#000000;width:120pt;">
        <p style="margin-left:0cm;">
         <span style="color:#4f4f4f;">
          操作
         </span>
        </p>
       </td>
       <td style="border-color:#000000;width:111.75pt;">
        <p style="margin-left:0cm;">
         <span style="color:#4f4f4f;">
          命令
         </span>
        </p>
       </td>
       <td style="border-color:#000000;width:147pt;">
        <p style="margin-left:0cm;">
         <span style="color:#4f4f4f;">
          说明
         </span>
        </p>
       </td>
      </tr>
      <tr>
       <td style="border-color:#000000;width:120pt;">
        <p style="margin-left:0cm;">
         <span style="color:#4f4f4f;">
          进入系统视图
         </span>
        </p>
       </td>
       <td style="width:111.75pt;">
        <p style="margin-left:0cm;">
         <span style="color:#4f4f4f;">
          system-view
         </span>
        </p>
       </td>
       <td style="width:147pt;">
        <p style="margin-left:0cm;">
         <span style="color:#4f4f4f;">
          -
         </span>
        </p>
       </td>
      </tr>
      <tr>
       <td style="border-color:#000000;width:120pt;">
        <p style="margin-left:0cm;">
         <span style="color:#4f4f4f;">
          进入以太网端口视图
         </span>
        </p>
       </td>
       <td style="width:111.75pt;">
        <p style="margin-left:0cm;">
         <span style="color:#4f4f4f;">
          interface interface-type interface-number
         </span>
        </p>
       </td>
       <td style="width:147pt;">
        <p style="margin-left:0cm;">
         <span style="color:#4f4f4f;">
          目前支持NDP的接口板类型只包括普通的Ethernet和Gigabitethernet接口板
         </span>
        </p>
       </td>
      </tr>
      <tr>
       <td style="border-color:#000000;width:120pt;">
        <p style="margin-left:0cm;">
         <span style="color:#4f4f4f;">
          使能端口的NDP特性
         </span>
        </p>
       </td>
       <td style="width:111.75pt;">
        <p style="margin-left:0cm;">
         <strong>
          <span style="color:#4f4f4f;">
           ndp enable
          </span>
         </strong>
        </p>
       </td>
       <td style="width:147pt;">
        <p style="margin-left:0cm;">
         <span style="color:#4f4f4f;">
          缺省情况下，端口关闭NDP特性
         </span>
        </p>
       </td>
      </tr>
     </tbody>
    </table>
    <p style="margin-left:0cm;">
     <a name="_Toc33081783">
      <span style="color:#4ea1db;">
       2.3 NDP
      </span>
     </a>
     <span style="color:#4d4d4d;">
      显示和维护
     </span>
    </p>
    <p style="margin-left:0cm;">
     <span style="color:#4d4d4d;">
      在完成上述配置后：
     </span>
    </p>
    <p style="margin-left:0cm;">
     <span style="color:#4d4d4d;">
      l
     </span>
     <span style="color:#4d4d4d;">
      在任意视图下执行
     </span>
     <strong>
      <span style="color:#4d4d4d;">
       display
      </span>
     </strong>
     <span style="color:#4d4d4d;">
      命令可以显示配置后
     </span>
     <span style="color:#4d4d4d;">
      NDP
     </span>
     <span style="color:#4d4d4d;">
      的运行情况。用户可以通过查看显示信息验证配置的效果。
     </span>
    </p>
    <p style="margin-left:0cm;">
     <span style="color:#4d4d4d;">
      l
     </span>
     <span style="color:#4d4d4d;">
      在用户视图下执行
     </span>
     <span style="color:#4d4d4d;">
      reset
     </span>
     <span style="color:#4d4d4d;">
      命令可以清除
     </span>
     <span style="color:#4d4d4d;">
      NDP
     </span>
     <span style="color:#4d4d4d;">
      的相关统计信息。
     </span>
    </p>
    <p style="margin-left:0cm;">
     <a name="_Toc17621629">
     </a>
     <a name="_Toc142278719">
     </a>
     <a name="_Toc46128900">
     </a>
     <a name="_Toc33081709">
     </a>
     <span style="color:#4ea1db;">
      表
     </span>
     <span style="color:#4ea1db;">
      2-6 NDP
     </span>
     <span style="color:#4d4d4d;">
      显示和维护
     </span>
    </p>
    <table border="1" cellspacing="0">
     <tbody>
      <tr>
       <td style="border-color:#000000;width:168.75pt;">
        <p style="margin-left:0cm;">
         <span style="color:#4f4f4f;">
          操作
         </span>
        </p>
       </td>
       <td style="border-color:#000000;width:210pt;">
        <p style="margin-left:0cm;">
         <span style="color:#4f4f4f;">
          命令
         </span>
        </p>
       </td>
      </tr>
      <tr>
       <td style="border-color:#000000;width:168.75pt;">
        <p style="margin-left:0cm;">
         <span style="color:#4f4f4f;">
          显示系统的NDP配置信息（包括报文发送时间间隔和信息有效保留时间）
         </span>
        </p>
       </td>
       <td style="width:210pt;">
        <p style="margin-left:0cm;">
         <strong>
          <span style="color:#4f4f4f;">
           display ndp
          </span>
         </strong>
        </p>
       </td>
      </tr>
      <tr>
       <td style="border-color:#000000;width:168.75pt;">
        <p style="margin-left:0cm;">
         <span style="color:#4f4f4f;">
          显示指定端口的NDP邻居信息
         </span>
        </p>
       </td>
       <td style="width:210pt;">
        <p style="margin-left:0cm;">
         <strong>
          <span style="color:#4f4f4f;">
           display ndp interface
          </span>
         </strong>
         <em>
          <span style="color:#4f4f4f;">
           port-list
          </span>
         </em>
        </p>
       </td>
      </tr>
      <tr>
       <td style="border-color:#000000;width:168.75pt;">
        <p style="margin-left:0cm;">
         <span style="color:#4f4f4f;">
          清除NDP端口的统计信息
         </span>
        </p>
       </td>
       <td style="width:210pt;">
        <p style="margin-left:0cm;">
         <strong>
          <span style="color:#4f4f4f;">
           reset ndp statistics
          </span>
         </strong>
         <span style="color:#4f4f4f;">
          [
          <strong>
           interface
          </strong>
          <em>
           port-list
          </em>
          ]
         </span>
        </p>
       </td>
      </tr>
     </tbody>
    </table>
    <p style="margin-left:0cm;">
    </p>
    <p style="margin-left:0cm;">
     <a name="_Toc37747143">
     </a>
     <a name="_Toc216233109">
     </a>
     <a name="_Toc215913300">
     </a>
     <a name="_Toc168890933">
     </a>
     <a name="_Ref166550683">
     </a>
     <a name="_Toc127757213">
     </a>
     <a name="_Toc125168336">
     </a>
     <a name="_Toc124915482">
     </a>
     <span style="color:#4ea1db;">
      2.4 NDP
     </span>
     配置举例
    </p>
    <p style="margin-left:0cm;">
     <strong>
      <span style="color:#333333;">
       一、
      </span>
     </strong>
     <strong>
      <span style="color:#333333;">
       组网需求
      </span>
     </strong>
     <span style="color:#333333;">
      ：
     </span>
    </p>
    <p style="margin-left:0cm;">
     <span style="color:#333333;">
      如下图所示，S9500-A分别和Swich B(S3500)、Swich C(S3500)相连，通过配置NDP，使得用户在S9500-A上可以获取Swich B、Swich C的一些设备信息。
     </span>
    </p>
    <p style="margin-left:0cm;">
     <span style="color:#333333;">
      NDP
     </span>
     <span style="color:#333333;">
      可以应用于拓扑比较复杂的组网中，通过配置NDP，可以清楚的获得某条链路的对端设备的信息，为描述整个组网拓扑打好基础。
     </span>
    </p>
    <p style="margin-left:0cm;">
     <strong>
      <span style="color:#333333;">
       二、组网图
      </span>
     </strong>
    </p>
    <p style="margin-left:0cm;">
     <img alt="" height="329" src="https://i-blog.csdnimg.cn/blog_migrate/980dacd83b10aaafa834dff3e604586f.png" width="425"/>
    </p>
    <p style="margin-left:0cm;">
     <strong>
      <span style="color:#333333;">
       三、配置步骤：
      </span>
     </strong>
    </p>
    <p style="margin-left:0cm;">
     <span style="color:#333333;">
      软件版本：S9500交换机1273及以后版本
     </span>
    </p>
    <p style="margin-left:0cm;">
     <span style="color:#333333;">
      硬件版本：S9500交换机全系列硬件版本
     </span>
    </p>
    <p style="margin-left:0cm;">
     <span style="color:#333333;">
      配置S9500-A
     </span>
    </p>
    <p style="margin-left:0cm;">
     <span style="color:#333333;">
      1
     </span>
     <span style="color:#333333;">
      ）全局启用NDP特性
     </span>
    </p>
    <p style="margin-left:0cm;">
     <span style="color:#333333;">
      [S9500-A] ndp enable
     </span>
    </p>
    <p style="margin-left:0cm;">
     <span style="color:#333333;">
      2
     </span>
     <span style="color:#333333;">
      ）连接Switch B和Switch C的端口分别启用NDP特性
     </span>
    </p>
    <p style="margin-left:0cm;">
     <span style="color:#333333;">
      [S9500-A-Ethernet1/1/1] ndp enable
     </span>
    </p>
    <p style="margin-left:0cm;">
     <span style="color:#333333;">
      [S9500-A-Ethernet1/1/2] ndp enable
     </span>
    </p>
    <p style="margin-left:0cm;">
     <span style="color:#333333;">
      3
     </span>
     <span style="color:#333333;">
      ）配置NDP信息的有效保留时间
     </span>
    </p>
    <p style="margin-left:0cm;">
     <span style="color:#333333;">
      [S9500-A] ndp timer aging 200
     </span>
    </p>
    <p style="margin-left:0cm;">
     <span style="color:#333333;">
      4
     </span>
     <span style="color:#333333;">
      ）配置NDP报文发送的时间间隔
     </span>
    </p>
    <p style="margin-left:0cm;">
     <span style="color:#333333;">
      [S9500-A] ndp timer hello 70
     </span>
    </p>
    <p style="margin-left:0cm;">
     <span style="color:#333333;">
      配置Switch B（Switch C类似）
     </span>
    </p>
    <p style="margin-left:0cm;">
     <span style="color:#333333;">
      1
     </span>
     <span style="color:#333333;">
      ）全局启用NDP特性
     </span>
    </p>
    <p style="margin-left:0cm;">
     <span style="color:#333333;">
      [Switch-B] ndp enable
     </span>
    </p>
    <p style="margin-left:0cm;">
     <span style="color:#333333;">
      2
     </span>
     <span style="color:#333333;">
      ）连接S9500-A的端口启用NDP特性
     </span>
    </p>
    <p style="margin-left:0cm;">
     <span style="color:#333333;">
      [Switch-B-Ethernet1/1/1] ndp enable
     </span>
    </p>
    <p style="margin-left:0cm;">
     <span style="color:#4d4d4d;">
      &amp;
     </span>
     <span style="color:#4d4d4d;">
      说明：
     </span>
    </p>
    <p style="margin-left:0cm;">
     <span style="color:#4d4d4d;">
      在进行了上述配置之后，用户只要在
     </span>
     <span style="color:#4d4d4d;">
      Switch A
     </span>
     <span style="color:#4d4d4d;">
      上通过命令
     </span>
     <strong>
      <span style="color:#4d4d4d;">
       display ndp interface
      </span>
     </strong>
     <em>
      <span style="color:#4d4d4d;">
       port-list
      </span>
     </em>
     <span style="color:#4d4d4d;">
      命令就可以查看该端口所连的邻居交换机信息。
     </span>
    </p>
   </div>
  </div>
 </article>
 <p alt="6874747073:3a2f2f626c6f672e6373646e2e6e65742f616c6c776179322f:61727469636c652f64657461696c732f313038393830393036" class_="artid" style="display:none">
 </p>
</div>
