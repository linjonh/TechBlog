---
layout: post
title: "java-使用开源免费API实现翻译功能-代码基于spring-ai和国产大模型"
date: 2025-01-25 09:31:28 +0800
description: "在当今技术快速发展的背景下，利用#java基于免费开源API实现翻译功能成为了一个既实用又高效的解决"
keywords: "java 使用开源免费API实现翻译功能 - 代码基于spring ai和国产大模型"
categories: ["未分类"]
tags: ["开源", "开发语言", "Java"]
artid: "143754469"
image:
  path: https://api.vvhan.com/api/bing?rand=sj&artid=143754469
  alt: "java-使用开源免费API实现翻译功能-代码基于spring-ai和国产大模型"
render_with_liquid: false
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     java 使用开源免费API实现翻译功能 - 代码基于spring ai和国产大模型
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <h2 id="e8Wth">
    </h2>
    <h3 id="DI4Le">
     大模型技术推动翻译进入新阶段
    </h3>
    <p id="ua5eddf38">
     过去，我们主要依赖百度或其他团队提供的翻译API来实现中英、英中、日中、中日等多种语言间的翻译。然而，随着大模型技术的发展，其在内容理解能力上已远超传统翻译工具。现在，我们可以完全依靠这些先进的大模型来进行更准确、自然的多语言翻译工作，这标志着翻译技术进入了一个新的阶段。
    </p>
    <p id="u29f18bac">
     本例子使用spring ai alibaba + QWen千问 api 完成，你可以跑通以后换自己的实现。
    </p>
    <p id="ud7789cbb">
     QWen 目前
     <span style="color:#fe2c24;">
      <strong>
       有100万免费Token额度
      </strong>
     </span>
     ，可以快速实现需求。同时，因为
     <span style="color:#fe2c24;">
      <strong>
       qwen 也是个开源的模型
      </strong>
     </span>
     ，我们可以
     <span style="color:#fe2c24;">
      <strong>
       自己搭建模型来实现免费使用
      </strong>
     </span>
    </p>
    <p>
    </p>
    <h3 id="J3Fmq">
     Spring AI Alibaba功能与应用介绍
    </h3>
    <p id="u3e5e08cd">
     Spring AI Alibaba 是 Spring AI 的一个实现，专为整合阿里云的AI能力而设计。它遵循了Spring Cloud Alibaba的最佳实践，是国内最好的Spring AI实现之一。Spring AI Alibaba 支持多种功能和能力，包括模型调用、Prompt模板、检索增强生成（RAG）、文生图、文字识别等。通过标准化接口，Spring AI Alibaba允许开发者轻松切换不同的AI服务提供者，并提供了便捷的开发体验。本文将重点介绍如何使用Prompt模板和模型调用来接入Spring AI Alibaba，展示其强大的集成能力和灵活性。
    </p>
    <p id="u54fb709f">
    </p>
    <h3 id="eY3Xh">
     阿里巴巴云开发的Qwen模型在多个测评中表现出色，而且是开源的
    </h3>
    <p id="u57c180df">
     通义千问Qwen是阿里巴巴云开发的大型语言模型，在MMLU、TheoremQA、GPQA等基准测评中表现出色，超越了Llama 3 70B。该模型在Hugging Face开源大模型排行榜Open LLM Leaderboard上荣登榜首，展示了其卓越的能力和性能。通义千问Qwen致力于提供准确、有用的信息，并为用户提供高质量的语言理解和生成体验。
    </p>
    <p>
     <img alt="" height="902" src="https://i-blog.csdnimg.cn/direct/8cadd54256e74a6b8d423ebe5eb40036.png" width="1200"/>
    </p>
    <p id="ube4e037b">
    </p>
    <h3 id="orCfY">
     基于SpringBoot与Spring AI Alibaba集成，实现英文到中文的翻译功能
    </h3>
    <p id="u5d1ff62a">
     基于SpringBoot集成Spring AI Alibaba，构建一个英文翻译中文能力的项目，支持使用Prompt的流返回接口，并且需要支持CORS跨域。我们将利用
     <code>
      ChatClient
     </code>
     的能力来处理翻译请求，通过配置和代码实现这一功能。根据提供的知识内容，以下是详细的步骤。
    </p>
    <h4 id="cejTM">
     前提条件
    </h4>
    <p id="u5e7c351c">
     确保满足以下环境要求：
    </p>
    <ul>
     <li id="uabc0898e">
      JDK版本至少为17。
     </li>
    </ul>
    <ul>
     <li id="uec9114c8">
      Spring Boot版本至少为3.3.x。
     </li>
    </ul>
    <h4 id="DdBSY">
     步骤
    </h4>
    <h5 id="ywTKY">
     1. 配置阿里云API Key
    </h5>
    <p id="u883cbc00">
     首先，在阿里云平台上申请通义千问的API Key。访问
     <a href="https://www.aliyun.com/product/bailian" rel="nofollow" title="阿里云百炼页面">
      阿里云百炼页面
     </a>
     ，登录您的账号，然后按照指引完成服务开通并生成API Key。记录此Key值，稍后用于项目配置。
    </p>
    <p id="ua283e487">
     配置API Key至环境变量中：
    </p>
    <pre id="dCBys"><code>export AI_DASHSCOPE_API_KEY=${REPLACE-WITH-VALID-API-KEY}</code></pre>
    <h5 id="dAZG6">
     2. 添加仓库与依赖
    </h5>
    <p id="u60666b38">
     在项目的pom.xml文件中添加必要的Maven仓库和依赖项，以便引入Spring AI Alibaba相关的库：
    </p>
    <pre id="lXLHK"><code>&lt;repositories&gt;
    &lt;repository&gt;
        &lt;id&gt;sonatype-snapshots&lt;/id&gt;

        &lt;url&gt;https://oss.sonatype.org/content/repositories/snapshots&lt;/url&gt;

        &lt;snapshots&gt;
            &lt;enabled&gt;true&lt;/enabled&gt;

        &lt;/snapshots&gt;

    &lt;/repository&gt;

    &lt;repository&gt;
        &lt;id&gt;spring-milestones&lt;/id&gt;

        &lt;name&gt;Spring Milestones&lt;/name&gt;

        &lt;url&gt;https://repo.spring.io/milestone&lt;/url&gt;

        &lt;snapshots&gt;
            &lt;enabled&gt;false&lt;/enabled&gt;

        &lt;/snapshots&gt;

    &lt;/repository&gt;

    &lt;repository&gt;
        &lt;id&gt;spring-snapshots&lt;/id&gt;

        &lt;name&gt;Spring Snapshots&lt;/name&gt;

        &lt;url&gt;https://repo.spring.io/snapshot&lt;/url&gt;

        &lt;releases&gt;
            &lt;enabled&gt;false&lt;/enabled&gt;

        &lt;/releases&gt;

    &lt;/repository&gt;

&lt;/repositories&gt;

&lt;dependencies&gt;
&lt;dependency&gt;
&lt;groupId&gt;com.alibaba.cloud.ai&lt;/groupId&gt;

        &lt;artifactId&gt;spring-ai-alibaba-starter&lt;/artifactId&gt;

        &lt;version&gt;1.0.0-M3.1&lt;/version&gt;

    &lt;/dependency&gt;

    &lt;!-- 其他依赖 --&gt;

&lt;/dependencies&gt;
</code></pre>
<p id="uaf83d166">
同时，确保你的 pom.xml 包含如下 Spring Boot 父级配置（如果还未添加）：
</p>
<pre id="caHpL"><code>&lt;parent&gt;
&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;

    &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;

    &lt;version&gt;3.3.4&lt;/version&gt;

    &lt;relativePath/&gt;

&lt;/parent&gt;
</code></pre>
<h5 id="hnlP6"> 3. 创建 Controller 及 ChatClient 实例
</h5>
<p id="u4a269ea4">
接下来定义一个控制器类，该类将接收 GET 请求，并通过
<code>
ChatClient
</code>
调用 AI 模型进行英文到中文的翻译。这里我们还启用了 CORS 以允许跨源请求。
</p>
<pre id="gYyB0"><code>@RestController
@RequestMapping("/ai")
@CrossOrigin(origins = "\*")
public class TranslationController {

    private final ChatClient chatClient;

    public TranslationController(ChatClient.Builder builder) {
        this.chatClient = builder.build();
    }

    @GetMapping(value = "/steamChat", produces = MediaType.TEXT_EVENT_STREAM_VALUE)
    public Flux&lt;String&gt; translate(@RequestParam String input) {
        Prompt prompt = new Prompt("Translate the following English text into Chinese: " + input);
        return chatClient.prompt(prompt).stream().content();
    }

}</code></pre>
<h5 id="S4cJ7"> 4. 配置 application.properties
</h5>
<p id="udb4ae644">
最后，在
<code>
application.properties
</code>
或
<code>
application.yml
</code>
中加入 API Key 配置：
</p>
<pre id="q2w1c"><code>spring.ai.dashscope.api-key=${AI_DASHSCOPE_API_KEY}</code></pre>
<h4 id="bNH2i">
解释
</h4>
<p id="ue52452a7">
上述步骤实现了基于 Spring Boot 的应用程序，集成了 Spring AI Alibaba 组件，提供了一个简单的英文转中文翻译服务。用户可以通过向
<code>
http://localhost:8080/ai/steamChat?input=...
</code>
发起 GET 请求来获取翻译结果，其中
<code>
input
</code>
参数携带待翻译的英文文本。本示例中的控制器利用了
<code>
ChatClient
</code>
以及 Prompt 机制来与 AI 模型交互，从而完成翻译任务。此外，为了方便开发调试，我们开启了 CORS 支持，使得不同源的前端应用也可以直接测试此 API。
</p>
<p id="ubf896f29">
</p>
<h3 id="aQbgT">
配置 React 应用以处理流式数据响应
</h3>
<p id="u566f23a3">
在构建一个基于 React 的前端项目，该前端能够处理后端以流的形式（
<code>
flux&lt;String&gt;
</code>
）返回的数据时，你需要确保你的前端应用能正确地读取并展示这些数据。在这个场景下，后端通过 URL
<code>
http://localhost:8080/ai/steamChat?input=…
</code>
提供了一个接口，用于接收输入参数并通过流方式返回响应。接下来将详细说明如何配置这样的 React 应用。
</p>
<h4 id="axZa7">
构建项目并填写代码
</h4>
<p id="u738336a1">
首先，创建一个新的 React 应用并安装所需的依赖：
</p>
<pre id="SSwT5"><code>npx create-react-app frontend
cd frontend
npm install</code></pre>
<p id="u545808d5">
接着，在
<code>
frontend
</code>
目录内创建必要的文件结构和内容。
</p>
<h5 id="s0L6h">
<code>
public/index.html
</code>
</h5>
<p id="ubfaa9fa2">
这是你项目的 HTML 模板文件，不需要修改默认生成的内容。
</p>
<pre id="UwL6T"><code>&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
&lt;meta charset="UTF-8"&gt;
&lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;
&lt;title&gt;Stream Chat App&lt;/title&gt;

&lt;/head&gt;

&lt;body&gt;
&lt;div id="root"&gt;&lt;/div&gt;

&lt;/body&gt;

&lt;/html&gt;
</code></pre>
<h5 id="iKvV6">
<code>
src/index.js
</code>
</h5>
<p id="uc7a99e75">
此文件负责渲染 React 应用程序的主要组件到 DOM 中。
</p>
<pre id="tA7tj"><code>import React from 'react';
import ReactDOM from 'react-dom/client';
import App from './App';

const root = ReactDOM.createRoot(document.getElementById('root'));
root.render(
&lt;React.StrictMode&gt;
&lt;App /&gt;
&lt;/React.StrictMode&gt;

);</code></pre>
<p id="u706d6669">
注意：这里使用了
<code>
ReactDOM.createRoot
</code>
而非
<code>
ReactDOM.render
</code>
来符合 React 18+版本的最佳实践。
</p>
<h5 id="sYpwH">
<code>
src/App.js
</code>
</h5>
<p id="u7ca96c9d">
定义应用的核心组件
<code>
App
</code>
，它包含一个名为
<code>
ChatComponent
</code>
的子组件。
</p>
<pre id="Vaqcx"><code>import React from 'react';
import ChatComponent from './components/ChatComponent';

function App() {
return (
&lt;div className="App"&gt;
&lt;ChatComponent /&gt;
&lt;/div&gt;

);
}

export default App;</code></pre>
<h5 id="mjzZh">
<code>
src/components/ChatComponent.js
</code>
</h5>
<p id="u56395bd7">
这是实现与后端通信以及显示消息的关键部分。
</p>
<pre id="CmyoL"><code>import React, { useState } from 'react';

function ChatComponent() {
const [input, setInput] = useState('');
const [messages, setMessages] = useState('');

const handleInputChange = (event) =&gt; {
setInput(event.target.value);
};

const handleSendMessage = async () =&gt; {
try {
const response = await fetch(`http://localhost:8080/ai/steamChat?input=${input}`);
const reader = response.body.getReader();
const decoder = new TextDecoder('utf-8');
let done = false;

      while (!done) {
        const { value, done: readerDone } = await reader.read();
        done = readerDone;
        const chunk = decoder.decode(value, { stream: true });
        setMessages((prevMessages) =&gt; prevMessages + chunk);
      }

      // 添加换行符以区分不同请求的结果
      setMessages((prevMessages) =&gt; prevMessages + '\n\n=============================\n\n');
    } catch (error) {
      console.error('Failed to fetch', error);
    }

};

const handleClearMessages = () =&gt; {
setMessages('');
};

return (
&lt;div&gt;
&lt;input
type="text"
value={input}
onChange={handleInputChange}
placeholder="Enter your message"
/&gt;
&lt;button onClick={handleSendMessage}&gt;Send&lt;/button&gt;

      &lt;button onClick={handleClearMessages}&gt;Clear&lt;/button&gt;

      &lt;div&gt;
        &lt;h3&gt;Messages:&lt;/h3&gt;

        &lt;pre&gt;{messages}&lt;/pre&gt;

      &lt;/div&gt;

    &lt;/div&gt;

);
}

export default ChatComponent;</code></pre>
<p id="ub711012f">
上述步骤涵盖了从零开始设置这样一个 React 应用所需的所有细节，包括如何通过 HTTP 请求获取流式响应，并将其逐步显示给用户。请确保你的后端服务支持 CORS 策略以便于跨源请求可以成功执行。
</p>
<p id="u4571eefb">
</p>
<p id="uc501355f">
<img alt="" height="670" src="https://i-blog.csdnimg.cn/direct/76fc9ba46111401fbd51e317aa1bdd16.png" width="700"/>
</p>
<h2 id="XYBpm">
</h2>

   </div>
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f776869737065727a7a7a612f:61727469636c652f64657461696c732f313433373534343639" class_="artid" style="display:none">
 </p>
</div>
