---
layout: post
title: "java读取mysql数据库表及栏目信息"
date: 2024-07-28 19:56:44 +0800
description: "用途：用于获取指定数据库中表以及栏目的各项信息（包括字段名、注释、类型、是否为空等）该类用于存储数据"
keywords: "查看栏目在数据库中的代码"
categories: ['Java']
tags: ['无标签']
artid: "88971328"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=88971328
    alt: "java读取mysql数据库表及栏目信息"
render_with_liquid: false
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     java读取mysql数据库表及栏目信息
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <h3>
     用途：用于获取指定数据库中表以及栏目的各项信息（包括字段名、注释、类型、是否为空等）
    </h3>
    <p>
     <img alt="" class="has" height="316" src="https://i-blog.csdnimg.cn/blog_migrate/84811e958d18979e07b6ff1bd0fd26c5.png" width="364"/>
    </p>
    <p>
     该类用于存储数据库信息（用户名、密码等）
    </p>
    <p>
     <img alt="" class="has" height="248" src="https://i-blog.csdnimg.cn/blog_migrate/8b0574113416844ac1225499a47ab74f.png" width="205"/>
    </p>
    <p>
     该类用于存储栏目的各项信息，按需拓展。
    </p>
    <ul>
     <li>
      获取数据库连接
     </li>
    </ul>
    <pre class="has"><code class="language-html">public static Connection getConnection(CfsDatabase cfsDatabase) {
    Connection conn = null;
    try {
        conn = DriverManager.getConnection(cfsDatabase.getUrl(), cfsDatabase.getUserName(), cfsDatabase.getPassword());
    } catch (SQLException e) {
        LOGGER.error("获取数据库连接失败", e);
    }
    return conn;
}</code></pre>
    <ul>
     <li>
      <h4>
       获取数据库下所有表名
      </h4>
     </li>
    </ul>
    <pre class="has"><code class="language-html">public static List&lt;String&gt; getTableNames(CfsDatabase cfsDatabase) {
    List&lt;String&gt; tableNames = new ArrayList&lt;&gt;();
    Connection conn = getConnection(cfsDatabase);
    ResultSet rs = null;
    try {
        //获取数据库的元数据
        DatabaseMetaData db = conn.getMetaData();
        //从元数据中获取到所有的表名
        rs = db.getTables("lwj_odin_v2", null, null, new String[]{"TABLE"});
        while (rs.next()) {
            tableNames.add(rs.getString(3));
        }
    } catch (SQLException e) {
        LOGGER.error("获取数据库表信息失败", e);
    } finally {
        try {
            rs.close();
            closeConnection(conn);
        } catch (SQLException e) {
            LOGGER.error("关闭数据库连接失败", e);
        }
    }
    return tableNames;
}</code></pre>
    <ul>
     <li>
      <h4>
       获取表中字段和注释的关系并存入map对象
      </h4>
     </li>
    </ul>
    <pre class="has"><code class="language-html">public static Map&lt;String,String&gt; getColumnComments(String tableName, CfsDatabase cfsDatabase) {
    //用于存储字段与注释
    Map&lt;String,String&gt;columnMap=new HashMap&lt;&gt;();
    //与数据库的连接
    Connection conn = getConnection(cfsDatabase);
    PreparedStatement pStemt = null;
    String tableSql = SQL + tableName;
    ResultSet rs = null;
    try {
        ps = conn.prepareStatement(tableSql);
        rs = ps.executeQuery("show full columns from " + tableName);
        while (rs.next()) {
            columnMap.put(rs.getString("Field"),rs.getString("Comment"));
        }
    } catch (SQLException e) {
        e.printStackTrace();
    } finally {
        if (rs != null) {
            try {
                rs.close();
                closeConnection(conn);
            } catch (SQLException e) {
                LOGGER.error("数据库操作失败", e);
            }
        }
    }
    return columnMap;
}</code></pre>
    <ul>
     <li>
      <h4>
       获取表中所有字段信息
      </h4>
     </li>
    </ul>
    <pre class="has"><code class="language-html">public static List&lt;DatabaseInfo&gt; getColumnNames(String tableName,CfsDatabase cfsDatabase) {
    //获取字段和注释的关联关系
    Map&lt;String,String&gt; columnMap=DatabaseUtil.getColumnComments(tableName,cfsDatabase);
    List&lt;DatabaseInfo&gt; databaseInfos = new ArrayList&lt;&gt;();
    //与数据库的连接
    Connection conn = getConnection(cfsDatabase);
    PreparedStatement pStemt = null;
    String tableSql = SQL + tableName;
    try {
        ps= conn.prepareStatement(tableSql);
        //结果集元数据
        ResultSetMetaData rsmd = ps.getMetaData();
        //表列数
        int size = rsmd.getColumnCount();
        for (int i = 1; i &lt;= size; i++) {
            DatabaseInfo databaseInfo=new DatabaseInfo();
            //获取字段名称
            databaseInfo.setFieldName(rsmd.getColumnName(i));
            //获取字段类型
            databaseInfo.setType(rsmd.getColumnTypeName(i));
            //字段是否为空
            databaseInfo.setEmptyStatus(String.valueOf(rsmd.isNullable(i)));
            //字段注释
            databaseInfo.setAnnotation(columnMap.get(rsmd.getColumnName(i)));
            databaseInfos.add(databaseInfo);
        }
    } catch (SQLException e) {
        LOGGER.error("获取数据库表的列信息失败", e);
    } finally {
        if (pStemt != null) {
            try {
                pStemt.close();
                closeConnection(conn);
            } catch (SQLException e) {
                LOGGER.error("关闭数据库连接失败", e);
            }
        }
    }
    return databaseInfos;
}</code></pre>
    <h4>
     以上的方法均可单独使用。表信息以及栏目信息可dubug查看对象rs和rsmd对象当中的属性
    </h4>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f2f:626c6f672e6373646e2e6e65742f71715f3337363832363635:2f61727469636c652f64657461696c732f3838393731333238" class_="artid" style="display:none">
 </p>
</div>


