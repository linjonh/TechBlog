---
layout: post
title: "原生小程序之仿美团外卖"
date: 2024-11-04 13:06:21 +0800
description: "根据美团外卖仿写微信小程序根据美团外卖仿写小程序,请求运用封装的微信小程序的原生方法wx.reque"
keywords: "微信小程序仿美团外卖地图导航"
categories: ["未分类"]
tags: ["小程序", "Vue"]
artid: "106725299"
image:
  path: https://api.vvhan.com/api/bing?rand=sj&artid=106725299
  alt: "原生小程序之仿美团外卖"
render_with_liquid: false
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     原生小程序之仿美团外卖
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h3>
     <a id="_0">
     </a>
     根据美团外卖仿写微信小程序
    </h3>
    <ol>
     <li>
      根据美团外卖仿写小程序,请求运用封装的微信小程序的原生方法wx.request,后台数据自己在本地搭建的mock模拟数据,封装store代替状态管理工具,即app.js中的globalData.毕竟是大厂的项目不可能一模一样,只写了部分功能,缺少登录功能,支付功能,注册功能
     </li>
     <li>
      <img alt="在这里插入图片描首页述" src="https://i-blog.csdnimg.cn/blog_migrate/96ea689addb0fab63873c406fc8f04e6.jpeg#pic_center">
       <br/>
       这是微信小程序的首页部分,地图功能用的微信小程序原生的wx.getLocation方法加腾讯地图,可以获取用户当前的位置,搜索栏的字体图标用的iconfont图标字体,阿里的图标库.在下面为swiper原生的组件,点击图片跳转到票搜索页
       <br/>
       <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/b1f013e1894f03c0fb6d7545f55b7749.jpeg#pic_center">
        <br/>
        在这个页面中点击搜索获取店铺信息列表,将据保存在globaldata中,在根目录下创建store文件夹,创建store.js,用来创建获取和赋值的方法类,即get操作和set操作,创建index.js用来定义初始变量即默认值,在app.js中引入store.js并在app.js中的globaldata中引入,在store.js中引入getApp获取整个globaldata对象
        <br/>
        <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/9c16063a130ff3956c3a084c4f0582a0.png#pic_center">
         <br/>
         这是整体的文件夹
        </img>
       </img>
      </img>
     </li>
    </ol>
    <pre><code class="prism language-javascript"><span class="token comment">//app.js</span>
<span class="token keyword">const</span> globalData<span class="token operator">=</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./store/index'</span><span class="token punctuation">)</span>
<span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
  onLaunch<span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>globalData<span class="token punctuation">.</span>globalData<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 展示本地存储能力</span>
    <span class="token keyword">var</span> logs <span class="token operator">=</span> wx<span class="token punctuation">.</span><span class="token function">getStorageSync</span><span class="token punctuation">(</span><span class="token string">'logs'</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    logs<span class="token punctuation">.</span><span class="token function">unshift</span><span class="token punctuation">(</span>Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    wx<span class="token punctuation">.</span><span class="token function">setStorageSync</span><span class="token punctuation">(</span><span class="token string">'logs'</span><span class="token punctuation">,</span> logs<span class="token punctuation">)</span>

    <span class="token comment">// 登录</span>
    wx<span class="token punctuation">.</span><span class="token function">login</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
      success<span class="token punctuation">:</span> res <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 发送 res.code 到后台换取 openId, sessionKey, unionId</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token comment">// 获取用户信息</span>
    wx<span class="token punctuation">.</span><span class="token function">getSetting</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
      success<span class="token punctuation">:</span> res <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>res<span class="token punctuation">.</span>authSetting<span class="token punctuation">[</span><span class="token string">'scope.userInfo'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
          <span class="token comment">// 已经授权，可以直接调用 getUserInfo 获取头像昵称，不会弹框</span>
          wx<span class="token punctuation">.</span><span class="token function">getUserInfo</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
            success<span class="token punctuation">:</span> res <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
              <span class="token comment">// 可以将 res 发送给后台解码出 unionId</span>
              <span class="token keyword">this</span><span class="token punctuation">.</span>globalData<span class="token punctuation">.</span>userInfo <span class="token operator">=</span> res<span class="token punctuation">.</span>userInfo

              <span class="token comment">// 由于 getUserInfo 是网络请求，可能会在 Page.onLoad 之后才返回</span>
              <span class="token comment">// 所以此处加入 callback 以防止这种情况</span>
              <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>userInfoReadyCallback<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">userInfoReadyCallback</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
              <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token punctuation">}</span><span class="token punctuation">,</span>
globalData<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
userInfo<span class="token punctuation">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
<span class="token operator">...</span>globalData<span class="token punctuation">.</span>globalData
<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
<p>
这是在 app.js 中引入封装的 store
</p>
<pre><code class="prism language-javascript">module<span class="token punctuation">.</span>exports<span class="token operator">=</span><span class="token punctuation">{<!-- --></span>
globalData<span class="token punctuation">:</span><span class="token punctuation">{<!-- --></span>
userpwd<span class="token punctuation">:</span><span class="token number">123456</span><span class="token punctuation">,</span>
historylist<span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'麻辣烫'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
orderlist<span class="token punctuation">:</span><span class="token punctuation">[</span>
<span class="token punctuation">{<!-- --></span>
image<span class="token punctuation">:</span><span class="token string">'http://p0.meituan.net/168.0.80/waimaipoi/ea39cf8507bd8193fd029842bb6d05af38659.jpg@80w_80h_1e_1c.webp'</span><span class="token punctuation">,</span>
title<span class="token punctuation">:</span> <span class="token string">"塔哈尔新疆盛宴·烧烤（北京国瑞店）"</span><span class="token punctuation">,</span>
productlist<span class="token punctuation">:</span><span class="token punctuation">[</span>
<span class="token punctuation">{<!-- --></span>
product<span class="token punctuation">:</span><span class="token string">'[鱼跃]玻璃体温计 CRW-11(三角型棒式口腔性)'</span><span class="token punctuation">,</span>
count<span class="token punctuation">:</span><span class="token number">1</span>
<span class="token punctuation">}</span>
<span class="token punctuation">]</span><span class="token punctuation">,</span>
sumproduct<span class="token punctuation">:</span><span class="token number">100</span>
<span class="token punctuation">}</span>
<span class="token punctuation">]</span>
<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>
这是 index.js 即初始化 store 中的数据,或者保存默认值
</p>
<pre><code class="prism language-javascript"><span class="token keyword">var</span> app<span class="token operator">=</span><span class="token function">getApp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name">Store</span><span class="token punctuation">{<!-- --></span>
<span class="token keyword">get</span> <span class="token function">userpwd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
<span class="token keyword">return</span> app<span class="token punctuation">.</span>globalData<span class="token punctuation">.</span>userpwd
<span class="token punctuation">}</span>
<span class="token keyword">set</span> <span class="token function">userpwd</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
app<span class="token punctuation">.</span>globalData<span class="token punctuation">.</span>userpwd<span class="token operator">=</span>value
<span class="token punctuation">}</span>
<span class="token comment">//获取和赋值历史搜索数据</span>
<span class="token keyword">get</span> <span class="token function">historylist</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
<span class="token keyword">return</span> app<span class="token punctuation">.</span>globalData<span class="token punctuation">.</span>historylist
<span class="token punctuation">}</span>
<span class="token keyword">set</span> <span class="token function">historylist</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
app<span class="token punctuation">.</span>globalData<span class="token punctuation">.</span>historylist<span class="token operator">=</span>value
<span class="token punctuation">}</span>
<span class="token comment">//赋值和获取我的订单</span>
<span class="token keyword">get</span> <span class="token function">orderlist</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
<span class="token keyword">return</span> app<span class="token punctuation">.</span>globalData<span class="token punctuation">.</span>orderlist
<span class="token punctuation">}</span>
<span class="token keyword">set</span> <span class="token function">orderlist</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
app<span class="token punctuation">.</span>globalData<span class="token punctuation">.</span>orderlist<span class="token operator">=</span>value
<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> store<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Store</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> store<span class="token punctuation">;</span>

</code></pre>
<p>
通过 es6 中的类创建 get 方法和 set 方法,创建 Store 实例,通过 export default 导出,在页面中通过 import 接收
</p>
<pre><code class="prism language-javascript"><span class="token keyword">import</span> store <span class="token keyword">from</span> <span class="token string">'./../../store/store'</span>
onLoad<span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>options<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// this.search(options.con);</span>
<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
historylist<span class="token punctuation">:</span>store<span class="token punctuation">.</span>historylist
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token function">onClickHot</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">search</span><span class="token punctuation">(</span><span class="token string">'res'</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> target<span class="token operator">=</span>e<span class="token punctuation">.</span>currentTarget<span class="token punctuation">.</span>dataset<span class="token punctuation">.</span>item<span class="token punctuation">,</span>list<span class="token operator">=</span><span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>historylist<span class="token punctuation">;</span>
<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
innersearch<span class="token punctuation">:</span>target
<span class="token punctuation">}</span><span class="token punctuation">)</span>
list<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
historylist<span class="token punctuation">:</span>list
<span class="token punctuation">}</span><span class="token punctuation">)</span>
store<span class="token punctuation">.</span>historylist<span class="token operator">=</span>list
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre>
<p>
通过 store.的方式进行取值和赋值
</p>
<p> 2.路由的封装
<br/>
在根目录下创建 router 文件夹,文件夹下创建 router.js 和 index.js,router.js 定义路由字典,index 封装条状方法,push 等
</p>
<pre><code class="prism language-javascript">module<span class="token punctuation">.</span>exports<span class="token operator">=</span><span class="token punctuation">{<!-- --></span>
search<span class="token punctuation">:</span><span class="token string">'/pages/search/search'</span><span class="token punctuation">,</span>
shoplist<span class="token punctuation">:</span><span class="token string">'/pages/shoplist/shoplist'</span>
<span class="token punctuation">}</span>
</code></pre>
<pre><code class="prism language-javascript"><span class="token keyword">const</span> routes<span class="token operator">=</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./router'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">push</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span>data<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
<span class="token keyword">const</span> querystr<span class="token operator">=</span>Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>n<span class="token operator">=&gt;</span><span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${<!-- --></span>n<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${<!-- --></span>data<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">'&amp;'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
wx<span class="token punctuation">.</span><span class="token function">navigateTo</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
url<span class="token punctuation">:</span> routes<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">'?'</span><span class="token operator">+</span>querystr
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre>
<p>
可以继续封装 wx.redirectTo 方法 wx.switchTab 方法等
</p>
<p> 3.通过 import 导入 push 方法,传递定义的路由,传递数据参数
</p>
<pre><code class="prism language-javascript"><span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span>push<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./../../router/index'</span>
<span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
options<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>  
 multipleSlots<span class="token punctuation">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>  
 properties<span class="token punctuation">:</span><span class="token punctuation">{<!-- --></span>
storeInfo<span class="token punctuation">:</span><span class="token punctuation">{<!-- --></span>
<span class="token string">'type'</span><span class="token punctuation">:</span>Object<span class="token punctuation">,</span>
<span class="token string">'value'</span><span class="token punctuation">:</span><span class="token keyword">null</span>
<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
data<span class="token punctuation">:</span><span class="token punctuation">{<!-- --></span>

<span class="token punctuation">}</span><span class="token punctuation">,</span>
methods<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
<span class="token function">togglesele</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
isActive<span class="token punctuation">:</span> <span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>isActive
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token function">detailpage</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
<span class="token function">push</span><span class="token punctuation">(</span><span class="token string">'shoplist'</span><span class="token punctuation">,</span>e<span class="token punctuation">.</span>currentTarget<span class="token punctuation">.</span>dataset<span class="token punctuation">.</span>info<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
<p>
跳转至店铺详情页面,获取传递的参数,渲染数据
<br/>
<img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/b6ec3ae35263de934a7eba00fa04dc34.jpeg#pic_center">
<br/>
附上 git 代码连接地址
<a href="https://github.com/jutisbjm120/smallproject.git">
代码地址
</a>
</img>
</p>

   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f672e:6373646e2e6e65742f77656978696e5f34323031323432392f:61727469636c652f64657461696c732f313036373235323939" class_="artid" style="display:none">
 </p>
</div>
