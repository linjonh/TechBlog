---
layout: post
title: "Java中在程序使用解析注解获取注解中定义的属性值"
date: 2023-08-09 09:59:57 +0800
description: "步骤：获取注解定义位置的对象（Class, Method, Field）获取指定的注解* getAn"
keywords: "获取注解的属性值"
categories: ['Java']
tags: ['反射', 'Java']
artid: "116139074"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=116139074
    alt: "Java中在程序使用解析注解获取注解中定义的属性值"
render_with_liquid: false
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     Java中在程序使用（解析）注解：获取注解中定义的属性值
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
     <strong>
      步骤：
     </strong>
    </p>
    <ol>
     <li>
      获取注解定义位置的对象（Class, Method, Field）
     </li>
     <li>
      获取指定的注解
      <br/>
      * getAnnotation(Class)
     </li>
     <li>
      调用注解中的抽象方法来获取配置的属性值
     </li>
    </ol>
    <p>
     先来看文件的结构
     <br/>
     <span class="katex--inline">
      <span class="katex">
       <span class="katex-mathml">
        {\\}
       </span>
       <span class="katex-html">
        <span class="base">
         <span class="strut" style="height: 0em; vertical-align: 0em;">
         </span>
         <span class="mord">
          <span class="mspace newline">
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/e9cf0aa07d7b9ee73f8feed8c3d802f0.png#pic_center">
      <br/>
      首先是Pro.java对应的Annotation
     </img>
    </p>
    <pre><code class="prism language-java"><span class="token keyword">package</span> cn<span class="token punctuation">.</span>annie<span class="token punctuation">.</span>annotation<span class="token punctuation">;</span>

<span class="token keyword">import</span> java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>ElementType<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>Retention<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>RetentionPolicy<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>Target<span class="token punctuation">;</span>

<span class="token comment">/**
 * 描述需要执行的类名和方法名
 */</span>
<span class="token annotation punctuation">@Target</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>ElementType<span class="token punctuation">.</span>TYPE<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span>RetentionPolicy<span class="token punctuation">.</span>RUNTIME<span class="token punctuation">)</span>
<span class="token keyword">public</span> @<span class="token keyword">interface</span> <span class="token class-name">Pro</span> <span class="token punctuation">{<!-- --></span>
    String <span class="token function">className</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    String <span class="token function">methodName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     其次是Demo1.java
    </p>
    <pre><code class="prism language-java"><span class="token keyword">package</span> cn<span class="token punctuation">.</span>annie<span class="token punctuation">.</span>annotation<span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Demo1</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"demo1...show"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     然后是Demo2.java
    </p>
    <pre><code class="prism language-java"><span class="token keyword">package</span> cn<span class="token punctuation">.</span>annie<span class="token punctuation">.</span>annotation<span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Demo2</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"demo2...show..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     最后是ReflectTest.java
    </p>
    <pre><code class="prism language-java"><span class="token keyword">package</span> cn<span class="token punctuation">.</span>annie<span class="token punctuation">.</span>annotation<span class="token punctuation">;</span>

<span class="token keyword">import</span> java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>reflect<span class="token punctuation">.</span>InvocationTargetException<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>reflect<span class="token punctuation">.</span>Method<span class="token punctuation">;</span>

<span class="token comment">/**
 * 框架类
 */</span>
<span class="token annotation punctuation">@Pro</span><span class="token punctuation">(</span>className <span class="token operator">=</span> <span class="token string">"cn.annie.annotation.Demo1"</span><span class="token punctuation">,</span> methodName <span class="token operator">=</span> <span class="token string">"show"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ReflectTest</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> ClassNotFoundException<span class="token punctuation">,</span> InvocationTargetException<span class="token punctuation">,</span> IllegalAccessException<span class="token punctuation">,</span> NoSuchMethodException<span class="token punctuation">,</span> InstantiationException <span class="token punctuation">{<!-- --></span>

        <span class="token comment">/**
         * 前提：不能改变该类的任何代码。可以创建任意类的对象，可以执行任意方法
         */</span>

        <span class="token comment">// 1.解析注解</span>
        <span class="token comment">// 1.1 获取该类的字节码文件对象</span>
        Class<span class="token generics function"><span class="token punctuation">&lt;</span>ReflectTest<span class="token punctuation">&gt;</span></span> reflectTestClass <span class="token operator">=</span> ReflectTest<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">;</span>

        <span class="token comment">// 2.获取上边的注解对象</span>
        <span class="token comment">// 其实就是在内存中生成了一个该注解接口的子类实现对象</span>
        Pro an <span class="token operator">=</span> reflectTestClass<span class="token punctuation">.</span><span class="token function">getAnnotation</span><span class="token punctuation">(</span>Pro<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 3.调用注解对象中定义的抽象方法，获取返回值</span>
        String className <span class="token operator">=</span> an<span class="token punctuation">.</span><span class="token function">className</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        String methodName <span class="token operator">=</span> an<span class="token punctuation">.</span><span class="token function">methodName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>className<span class="token punctuation">)</span><span class="token punctuation">;</span>
        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>methodName<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 4.加载该类进内存</span>
        Class<span class="token operator">&lt;</span><span class="token operator">?</span><span class="token operator">&gt;</span> cls <span class="token operator">=</span> Class<span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span>className<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 5.创建对象</span>
        Object obj <span class="token operator">=</span> cls<span class="token punctuation">.</span><span class="token function">newInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 6.获取方法对象</span>
        Method method <span class="token operator">=</span> cls<span class="token punctuation">.</span><span class="token function">getMethod</span><span class="token punctuation">(</span>methodName<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 7.执行方法</span>
        method<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     来看最后的运行结果
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/694bb39fed760c15d8a355ae80a80394.png#pic_center"/>
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f:626c6f672e6373646e2e6e65742f416e6e69655f303332312f:61727469636c652f64657461696c732f313136313339303734" class_="artid" style="display:none">
 </p>
</div>


