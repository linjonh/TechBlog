---
layout: post
title: "Cwinform连接Access数据库方式"
date: 2024-12-18 20:52:34 +0800
description: "开发工具使用的是VS2010一、数据库创建borrow表：info:user_table:数据库保存"
keywords: "winform access"
categories: ["未分类"]
tags: ["数据库", "Visual", "Studio", "C"]
artid: "117000406"
image:
  path: https://api.vvhan.com/api/bing?rand=sj&artid=117000406
  alt: "Cwinform连接Access数据库方式"
render_with_liquid: false
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     C#winform连接Access数据库方式
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <h3>
     开发工具使用的是VS2010
    </h3>
    <h3>
     一、数据库创建
    </h3>
    <p>
     borrow表：
    </p>
    <p>
     <img alt="" height="139" src="https://i-blog.csdnimg.cn/blog_migrate/5b06bf0776077b8287927932af8254ff.png" width="1065"/>
    </p>
    <p>
     info:
    </p>
    <p>
     <img alt="" height="160" src="https://i-blog.csdnimg.cn/blog_migrate/25d48aba425a2071d98e58d2eaba7b7d.png" width="1069"/>
    </p>
    <p>
     user_table:
    </p>
    <p>
     <img alt="" height="122" src="https://i-blog.csdnimg.cn/blog_migrate/ea8609077453ac3b10045fb40c122fd5.png" width="593"/>
    </p>
    <p>
     数据库保存:数据库另存为里选择为
     <span style="color:#f33b45;">
      Access2002-2003数据库
     </span>
     ，存到桌面就可以
    </p>
    <p>
     <img alt="" height="526" src="https://i-blog.csdnimg.cn/blog_migrate/e67e53bfa499506fce68be4816c9fc98.png" width="998"/>
    </p>
    <h3>
     二、连接数据库
    </h3>
    <p>
     回到项目界面
    </p>
    <p>
     1.在解决方案资源方案管理器里新添加数据集(Dataset)
    </p>
    <p>
     <img alt="" height="541" src="https://i-blog.csdnimg.cn/blog_migrate/55bd2f5f50b4c4687557aef97724e58b.png" width="783"/>
    </p>
    <p>
     2.在Dataset1.xsd里新添加一个TableAdapter
    </p>
    <p>
     <img alt="" height="435" src="https://i-blog.csdnimg.cn/blog_migrate/1bfe9d655c002fc1b2b0226c0ddd69a3.png" width="958"/>
    </p>
    <p>
     3.新建连接里选择
     <span style="color:#f33b45;">
      Microsoft Access数据库文件
     </span>
     ,点击继续
    </p>
    <p>
     <img alt="" height="538" src="https://i-blog.csdnimg.cn/blog_migrate/c52a830bc024d5309f327bc242bf3cb7.png" width="565"/>
    </p>
    <p>
     4.在浏览里选中刚刚保存的数据库文件，点击确定
    </p>
    <p>
     <img alt="" height="531" src="https://i-blog.csdnimg.cn/blog_migrate/08949863955322eaaabff077b90f5417.png" width="558"/>
    </p>
    <p>
     弹出提示选是
    </p>
    <p>
     <img alt="" height="528" src="https://i-blog.csdnimg.cn/blog_migrate/c6dec42b0c7aa4987983132c60b09704.png" width="555"/>
    </p>
    <p>
     一直下一步直到这个界面，点击查询生成器
    </p>
    <p>
     <img alt="" height="542" src="https://i-blog.csdnimg.cn/blog_migrate/9a8e228793fdefd3e5c532b5ebfc271e.png" width="569"/>
    </p>
    <p>
     5.添加表，如图
    </p>
    <p>
     <img alt="" height="492" src="https://i-blog.csdnimg.cn/blog_migrate/3f000299224fa02f84f562283ca785d8.png" width="585"/>
    </p>
    <p>
     <img alt="" height="535" src="https://i-blog.csdnimg.cn/blog_migrate/7dc1810780d60897f85ffe5b5661ace2.png" width="584"/>
    </p>
    <p>
     点击完成
    </p>
    <p>
     <img alt="" height="551" src="https://i-blog.csdnimg.cn/blog_migrate/8221ff36b6f7cba666a852d5e27bc68c.png" width="579"/>
    </p>
    <p>
     按照以上步骤继续添加info表和user_table表后如图所示
    </p>
    <p>
     <img alt="" height="352" src="https://i-blog.csdnimg.cn/blog_migrate/f9128bc5fb587e78bb63c395c7575ed8.png" width="775"/>
    </p>
    <h3>
     三、数据显示和连接语句
    </h3>
    <h4>
     1.数据显示
    </h4>
    <p>
     这里用DataGridView控件来显示数据，具体方式为点击控件
     <span style="color:#f33b45;">
      右上小三角
     </span>
     并按照图选择需要的数据，并且表中各列的宽度都可以编辑
    </p>
    <p>
     <img alt="" height="297" src="https://i-blog.csdnimg.cn/blog_migrate/caf5810d565d1b7aca8ffcdaf097e406.png" width="1114"/>
    </p>
    <h4>
     2.连接语句
    </h4>
    <p>
     在代码界面的顶部添加引用
    </p>
    <p>
     <img alt="" height="160" src="https://i-blog.csdnimg.cn/blog_migrate/973880adba7f60488d574545e7ffe136.png" width="365"/>
    </p>
    <pre><code class="language-cs">using System.Data.OleDb;</code></pre>
    <p>
     连接用一个按钮点击举例，在中间添加上SQL语句来增删查改就ok(误
    </p>
    <pre><code class="language-cs">private void button1_Click(object sender, EventArgs e)
        {
            string oleCon = "provider=Microsoft.Jet.OLEDB.4.0;Jet OLEDB:DataBase Password='';User Id='admin';Data source=|DataDirectory|Database2.mdb";//使用相对路径
            OleDbConnection conn = new OleDbConnection(oleCon);
            conn.Open();

            //sql语句



            conn.Close();//connOPEN了记得Close


        }</code></pre>
    <p>
    </p>
    <p>
     对于表2数据，因为需要根据用户来显示借书信息，所以单独为表2写了列的赋值:
    </p>
    <pre><code class="language-cs">        protected void refesh()
        {
            string oleCon = "provider=Microsoft.Jet.OLEDB.4.0;Jet OLEDB:DataBase Password='';User Id='admin';Data source=|DataDirectory|//Database2.mdb";
            OleDbConnection conn = new OleDbConnection(oleCon);
            conn.Open();
            string fill1 = "select * from borrow where `userna` = '" + this.label23.Text + "'";
            OleDbCommand cmdf = new OleDbCommand(fill1, conn);
            OleDbDataAdapter sda = new OleDbDataAdapter(cmdf);
            DataSet ds = new DataSet();
            sda.Fill(ds, "书号");
            dataGridView2.DataSource = ds;
            dataGridView2.DataMember = "书号";
            conn.Close();
        }</code></pre>
    <p>
     窗体载入里这句是表1的自动添加语句，可以在按钮事件里添加来刷新表1
    </p>
    <p>
     <img alt="" height="251" src="https://i-blog.csdnimg.cn/blog_migrate/6621ef4f23fb1b17f44bab307ac58aa9.png" width="681"/>
    </p>
    <p>
     完事
     <img alt="" height="89" src="https://i-blog.csdnimg.cn/blog_migrate/9935633cc269e8d572faea8a4ca43cf2.jpeg" width="89"/>
    </p>
    <p>
    </p>

   </div>
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f6d305f34373137323838352f:61727469636c652f64657461696c732f313137303030343036" class_="artid" style="display:none">
 </p>
</div>
