---
layout: post
title: "安卓开发-Jetpack-compose-kotlin-实现-俄罗斯方块游戏"
date: 2025-01-21 00:34:32 +0800
description: "文章浏览阅读3.3k次，点赞4次，文章目录前言俄罗斯方块开发文档1.摘要2.开发工具选取2.1.Co"
keywords: "打造一个 compose 版的俄罗斯方块"
categories: ['安卓开发']
tags: ['Kotlin', 'Android']
artid: "120290029"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=120290029
    alt: "安卓开发-Jetpack-compose-kotlin-实现-俄罗斯方块游戏"
render_with_liquid: false
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     安卓开发： Jetpack compose + kotlin 实现 俄罗斯方块游戏
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
    </p>
    <div class="toc">
     <h4>
      文章目录
     </h4>
     <ul>
      <li>
       <a href="#_1" rel="nofollow">
        前言
       </a>
      </li>
      <li>
       <a href="#_8" rel="nofollow">
        俄罗斯方块开发文档
       </a>
      </li>
      <li>
       <ul>
        <li>
         <a href="#1_14" rel="nofollow">
          1.摘要
         </a>
        </li>
        <li>
         <a href="#2_20" rel="nofollow">
          2.开发工具选取
         </a>
        </li>
        <li>
         <ul>
          <li>
           <a href="#21Compose__23" rel="nofollow">
            2.1.Compose 的自身优点
           </a>
          </li>
          <li>
           <a href="#22_29" rel="nofollow">
            2.2.数据驱动界面
           </a>
          </li>
         </ul>
        </li>
        <li>
         <a href="#3_35" rel="nofollow">
          3.设计需求
         </a>
        </li>
        <li>
         <ul>
          <li>
           <a href="#31_36" rel="nofollow">
            3.1.功能需求
           </a>
          </li>
          <li>
           <ul>
            <li>
             <a href="#311_37" rel="nofollow">
              3.1.1.基本游戏功能
             </a>
            </li>
            <li>
             <a href="#312_41" rel="nofollow">
              3.1.2.拓展功能
             </a>
            </li>
           </ul>
          </li>
          <li>
           <a href="#32_48" rel="nofollow">
            3.2.界面需求
           </a>
          </li>
          <li>
           <ul>
            <li>
             <a href="#321_49" rel="nofollow">
              3.2.1.整体界面设计
             </a>
            </li>
            <li>
             <a href="#322_57" rel="nofollow">
              3.2.2.特色界面设计
             </a>
            </li>
           </ul>
          </li>
         </ul>
        </li>
        <li>
         <a href="#4_69" rel="nofollow">
          4.项目文件及其功能
         </a>
        </li>
        <li>
         <ul>
          <li>
           <a href="#41_MVI__70" rel="nofollow">
            4.1.游戏架构基于 MVI 设计
           </a>
          </li>
          <li>
           <a href="#42_78" rel="nofollow">
            4.2.源文件功能简述表
           </a>
          </li>
          <li>
           <a href="#43__82" rel="nofollow">
            4.3 功能索引
           </a>
          </li>
         </ul>
        </li>
        <li>
         <a href="#5_90" rel="nofollow">
          5.遇到的困难和解决方案
         </a>
        </li>
        <li>
         <ul>
          <li>
           <a href="#51_91" rel="nofollow">
            5.1.零基础学习新的语言和框架
           </a>
          </li>
          <li>
           <a href="#52_Gitee__96" rel="nofollow">
            5.2.使用 Gitee 托管仓库
           </a>
          </li>
          <li>
           <a href="#53_buildgradle__101" rel="nofollow">
            5.3.编辑 build.gradle 环境配置文件
           </a>
          </li>
          <li>
           <a href="#54_Kotlin__Model__195" rel="nofollow">
            5.4.用 Kotlin 编写游戏逻辑实现 Model 层次
           </a>
          </li>
          <li>
           <a href="#56_Compose__View__279" rel="nofollow">
            5.6.基于 Compose 实现 View 层次
           </a>
          </li>
          <li>
           <ul>
            <li>
             <a href="#_281" rel="nofollow">
              俄罗斯方块游戏屏幕
             </a>
            </li>
            <li>
             <a href="#_317" rel="nofollow">
              俄罗斯方块游戏按钮布局
             </a>
            </li>
            <li>
             <a href="#_344" rel="nofollow">
              俄罗斯方块游戏机背景
             </a>
            </li>
            <li>
             <a href="#_379" rel="nofollow">
              游戏设置页面
             </a>
            </li>
           </ul>
          </li>
          <li>
           <a href="#57_504" rel="nofollow">
            5.7.实现界面切换和导航功能
           </a>
          </li>
          <li>
           <a href="#58_535" rel="nofollow">
            5.8.设置显示界面主题
           </a>
          </li>
          <li>
           <a href="#59_594" rel="nofollow">
            5.9.动画设计
           </a>
          </li>
         </ul>
        </li>
        <li>
         <a href="#_Git__723" rel="nofollow">
          附录：源代码 Git 仓库链接
         </a>
        </li>
       </ul>
      </li>
     </ul>
    </div>
    <p>
    </p>
    <h2>
     <a id="_1">
     </a>
     前言
    </h2>
    <blockquote>
     <p>
      项目地址：
      <a href="https://github.com/zyw-stu/Andriod_Tetris">
       github 开源地址
      </a>
      ，
      <a href="https://gitee.com/yxwang2023/android_tetris" rel="nofollow">
       码云开源地址
      </a>
      <br/>
      项目背景：刚刚结束的暑假小学期中，和我的
      <mark>
       两个神仙队友WYX,XPF
      </mark>
      （我的队友超级棒！）共同完成的第一个安卓开发项目——俄罗斯方块游戏。
      <br/>
      框架和语言：kotlin+ jetpack compose (compose 是谷歌最新推出的开发框架，AndroidStudio刚出了支持compose的稳定版本)
      <br/>
      参考项目：参考了
      <a href="https://github.com/leavesC/compose_tetris">
       https://github.com/leavesC/compose_tetris
       <br/>
      </a>
      在此基础上增加了许多丰富的功能（如切换游戏难度，切换背景音乐，记录最高分…）
     </p>
    </blockquote>
    <h2>
     <a id="_8">
     </a>
     俄罗斯方块开发文档
    </h2>
    <p>
     应用名称：鹅螺蛳方块
     <br/>
     应用类型：休闲游戏
     <br/>
     小组成员：WYX、ZYW、XPF
     <br/>
     开发时间：2021年7月26日 - 2021年8月14日
    </p>
    <h3>
     <a id="1_14">
     </a>
     1.摘要
    </h3>
    <p>
     本组使用 Android studio 作为集成式开发环境，完全自主学习 Kotlin 编程语言和 Jetpack Compose 框架，编写了一个功能齐全、具有动态界面的俄罗斯方块安卓游戏。
     <br/>
     主要工作包括：搭建 Compose Activity 项目环境，全栈开发实现俄罗斯方块的后端游戏逻辑、界面交互、前端界面设计、音效播放、动画效果等功能（详见“设计需求”一节）。
     <br/>
     学习使用全新的 Jetpack Compose 框架是本项目最大的挑战。Jetpack Compose 是谷歌推出的新式声明性界面工具包 ，包括一整套全新的渲染、布局、事件、刷新机制，需要一段时间才能入门，但有效提高了本小组的开发效率。
     <br/>
     本文档用于描述《计算机科学与技术专业实践与训练》课程所编写程序的设计方案，文档阅读对象为本课程授课教师及本课堂同学。
    </p>
    <h3>
     <a id="2_20">
     </a>
     2.开发工具选取
    </h3>
    <p>
     Jetpack Compose 是用于构建原生界面的最新的 Android 工具包，结合了反应式编程模型和 Kotlin 编程语言的简洁性和易用性。
    </p>
    <h4>
     <a id="21Compose__23">
     </a>
     2.1.Compose 的自身优点
    </h4>
    <ul>
     <li>
      采用声明式 UI 设计
     </li>
     <li>
      提供丰富的 Material 组件，加速开发
     </li>
     <li>
      具有直观的 Kotlin API
     </li>
     <li>
      拥有更简单的、自定义的实时交互预览功能
     </li>
    </ul>
    <h4>
     <a id="22_29">
     </a>
     2.2.数据驱动界面
    </h4>
    <p>
     游戏的执行程序可以概括为不断等待用户的输入信息，进行状态查询，渲染界面的过程。而这种游戏模型的逻辑非常符合前端开发的思想：数据驱动界面。
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/eda385d2b76aa24f03dda3795e3a6219.png"/>
    </p>
    <p>
     当下的小游戏多以前端为主，客户端开发成本较大，而使用 Compose 可以降低开发成本。Compose 实现数据驱动是依赖类似 Flutter 的 Provide 一样的更新机制，但并没有采用采用了传统 UI 的多层继承结构，而是多个 View 组合成一个 View ，更新数据只要在使用的实体上面加注解 @Model ，在更新实体的同时，会通知 UI 进行修改。
    </p>
    <h3>
     <a id="3_35">
     </a>
     3.设计需求
    </h3>
    <h4>
     <a id="31_36">
     </a>
     3.1.功能需求
    </h4>
    <h5>
     <a id="311_37">
     </a>
     3.1.1.基本游戏功能
    </h5>
    <ul>
     <li>
      实现俄罗斯方块的游戏的基本逻辑：控制方块的运动和旋转
     </li>
     <li>
      实现游戏整体功能控制：开始游戏、暂停游戏、重新开始、音乐开启关闭；
     </li>
    </ul>
    <h5>
     <a id="312_41">
     </a>
     3.1.2.拓展功能
    </h5>
    <ul>
     <li>
      实现游戏高级设置：调整游戏难度，游戏界面主题切换，更改游戏背景音乐；
     </li>
     <li>
      增加计分系统，在游戏界面实时显示目前得分，统计历史最高得分；
     </li>
     <li>
      增加玩家档案信息，使玩家可以输入保存自己的姓名；
     </li>
     <li>
      增加游戏说明的信息，使得玩家了解游戏规则和技巧；
     </li>
     <li>
      实现关于我们页面：展示应用版本信息、开发团队的留言、产品设计理念；
     </li>
    </ul>
    <h4>
     <a id="32_48">
     </a>
     3.2.界面需求
    </h4>
    <h5>
     <a id="321_49">
     </a>
     3.2.1.整体界面设计
    </h5>
    <ul>
     <li>
      设计导航栏使得界面的跳转更加简明快捷。
     </li>
     <li>
      设计垂直滚动式页面增加单个页面展示的空间。
     </li>
     <li>
      设计白天与黑夜两种模式的界面配色，启动应用时会自动根据手机夜间模式切换，界面内包括太阳和月亮的动画。
     </li>
     <li>
      设计多种模式的渐变色按钮，增加按钮的质感以提升玩家的体验。
     </li>
     <li>
      设计多种风格的字体样式以区分不同的内容和突出重点。
     </li>
     <li>
      设计多种矢量图标，使得信息的展现更加形象。
     </li>
    </ul>
    <h5>
     <a id="322_57">
     </a>
     3.2.2.特色界面设计
    </h5>
    <ul>
     <li>
      游戏屏幕可由用户自己调节大小，并当调节范围超出最大和最小的界限时，设计弹窗提醒用户。
     </li>
     <li>
      游戏屏幕边框实现色彩的渐变，增添游戏的炫酷感。
     </li>
     <li>
      设计手势控制的旋转圆形头像，可变带宽和模糊度的圆环边框，可变模糊度和曲线形状的顶部背景图片。
     </li>
     <li>
      设计 3D 翻折动画，隐藏和展开游戏说明，使得界面更加简洁灵动。
     </li>
     <li>
      设计水墨渲染动画，通过手势将灰度图片点亮，增添界面的高级感。
     </li>
     <li>
      设计上下两个图层，通过下图层的阴影使得可360°翻转的图片有肉眼3D的效果
     </li>
     <li>
      设计星空背景和火箭发射的动画，更形象的展示我们的理念和深层寓意。
     </li>
     <li>
      设计色彩渐变的字体，是界面更加有趣美观。
     </li>
     <li>
      仿照胶片样式，设计横向滚动的图像卡片，展示开发者留言。
     </li>
     <li>
      设计关键信息可复制的文本，展示项目地址，开发者联系方式。
     </li>
    </ul>
    <h3>
     <a id="4_69">
     </a>
     4.项目文件及其功能
    </h3>
    <h4>
     <a id="41_MVI__70">
     </a>
     4.1.游戏架构基于 MVI 设计
    </h4>
    <p>
     MVI 即 Model-View-Intent ，提倡一种单向数据流的设计思想，非常适合在 Compose 项目中实现逻辑部分，可以彻底贯彻“数据驱动 UI”的核心思想。
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/8afc3176a44098f1ae8c45c363597d22.png"/>
    </p>
    <ul>
     <li>
      View 层：基于 Compose 打造，所有 UI 元素都由代码实现
     </li>
     <li>
      Model 层：ViewModel 维护 State 的变化，游戏逻辑交由 reduce 处理
     </li>
     <li>
      V-M 通信：通过 StateFlow 驱动 Compose 刷新，用户事件由 Action 分发至 ViewModel
     </li>
    </ul>
    <h4>
     <a id="42_78">
     </a>
     4.2.源文件功能简述表
    </h4>
    <p>
     如下表所示，所有源代码部分都在 com.android_tetris 包内：
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/466050c831683cce5f30aa3e816f2039.png">
      <br/>
      <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/4316e194a4169902978713c0820f0f06.png"/>
     </img>
    </p>
    <h4>
     <a id="43__82">
     </a>
     4.3 功能索引
    </h4>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/ece3a9058a01ee503aa77ed0738535de.png">
      <br/>
      <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/0869f163663062563a53e911982d65c8.png">
       <br/>
       <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/817d6ab9e5a5ab829dc4510d14d238fe.png"/>
      </img>
     </img>
    </p>
    <h3>
     <a id="5_90">
     </a>
     5.遇到的困难和解决方案
    </h3>
    <h4>
     <a id="51_91">
     </a>
     5.1.零基础学习新的语言和框架
    </h4>
    <p>
     本程序完全使用 Kotlin 语言开发，并选用 Jetpack Compose 框架作为前端框架。
     <br/>
     我们完全自主学习了 Jetpack Compose （以下简称 Compose ）这个还未推出正式版的声明式 UI 框架。由于谷歌暂未推出 Compose 的正式版本，现在网上相关资料和教程都还非常稀少，API文档还是全英文的，我们常常在意想不到的问题上被卡住还没有什么办法。
     <br/>
     虽然入门过程极其艰难，但是在学习使用 Compose 的全新框架开发的过程中，我们的英语水平、信息检索能力、解决问题的能力，都得到了极大的锻炼，相信这段艰苦的自主学习经历对我们之后的编程之路一定有所帮助。
    </p>
    <h4>
     <a id="52_Gitee__96">
     </a>
     5.2.使用 Gitee 托管仓库
    </h4>
    <p>
     由于这是一个工程量比较大的项目，我们采用 Gitee 进行版本管理。但在使用过程中，我们上传经常遇到“文件超过 100M ”的错误提示。
     <br/>
     为解决这一问题，我们学习了 .gitignore 文件的使用方法：在该文件按优先级从高到低，写明让 Git 仓库上传时忽略掉的文件目录/后缀名， Git 就会主动忽略这些文件。
     <br/>
     我们可以用这一办法处理项目编译产生的文件和庞大的开发环境文件。
    </p>
    <h4>
     <a id="53_buildgradle__101">
     </a>
     5.3.编辑 build.gradle 环境配置文件
    </h4>
    <p>
     开发初期，由于 Kotlin 和 Compose 还在频繁更新 API ，版本迭代很快，因此我们遇到了很多次 build 不成功的情况，报错位置都出现在 build.gradle 文件。
     <br/>
     查阅资料发现， Project 层级和 Module 层级各有相对应的两个 build.gradle 文件，在 Android studio 中分别显示为 build.gradle (Project: 项目名) 和 build.gradle (Module: 项目名.app) 。
     <br/>
     在 build.gradle (Project: 项目名) 中， buildscript { } 代码块是该项目的 gradle 配置，只存放用到的代码托管库和项目构建级别的依赖：
    </p>
    <pre><code class="prism language-kotlin">buildscript <span class="token punctuation">{<!-- --></span>
    ext <span class="token punctuation">{<!-- --></span>
        compose_version <span class="token operator">=</span> <span class="token string">'1.0.0-beta08'</span>
    <span class="token punctuation">}</span>
    repositories <span class="token punctuation">{<!-- --></span>
        <span class="token function">google</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token function">mavenCentral</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    dependencies <span class="token punctuation">{<!-- --></span>
        classpath <span class="token string">'com.android.tools.build:gradle:7.1.0-alpha02'</span>
        classpath <span class="token string">"org.jetbrains.kotlin:kotlin-gradle-plugin:1.5.10"</span>
        <span class="token comment">// NOTE: Do not place your application dependencies here; they belong</span>
        <span class="token comment">// in the individual module build.gradle files</span>
        <span class="token comment">// （此处的注释提示：不要把应用程序的依赖库在此引用）</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     在 build.gradle (Module: 项目名.app) 中， build.gradle 主要用于配置模块级别的配置信息和依赖：
    </p>
    <pre><code class="prism language-kotlin">plugins <span class="token punctuation">{<!-- --></span>
    id <span class="token string">'com.android.application'</span>
    id <span class="token string">'kotlin-android'</span>
<span class="token punctuation">}</span>

android <span class="token punctuation">{<!-- --></span>
    compileSdk <span class="token number">30</span>
    buildToolsVersion <span class="token string">"30.0.3"</span>
    defaultConfig <span class="token punctuation">{<!-- --></span>
        applicationId <span class="token string">"com.android_tetris"</span>
        minSdk <span class="token number">21</span>
        targetSdk <span class="token number">30</span>
        versionCode <span class="token number">1</span>
        versionName <span class="token string">"1.0"</span>
        testInstrumentationRunner <span class="token string">"androidx.test.runner.AndroidJUnitRunner"</span>
        vectorDrawables <span class="token punctuation">{<!-- --></span>
            useSupportLibrary <span class="token boolean">true</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">// 输出 APK 用到的应用签名信息</span>
    signingConfigs <span class="token punctuation">{<!-- --></span>
        releaseConfig <span class="token punctuation">{<!-- --></span>
            storeFile <span class="token function">file</span><span class="token punctuation">(</span><span class="token string">"..\\key.jks"</span><span class="token punctuation">)</span>
            storePassword <span class="token string">"123456"</span>
            keyAlias <span class="token string">"key0"</span>
            keyPassword <span class="token string">"123456"</span>
            v1SigningEnabled <span class="token boolean">true</span>
            v2SigningEnabled <span class="token boolean">true</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    buildTypes <span class="token punctuation">{<!-- --></span>
        debug <span class="token punctuation">{<!-- --></span>
            signingConfig signingConfigs<span class="token punctuation">.</span>releaseConfig
            minifyEnabled <span class="token boolean">false</span>
            proguardFiles <span class="token function">getDefaultProguardFile</span><span class="token punctuation">(</span><span class="token string">'proguard-android-optimize.txt'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'proguard-rules.pro'</span>
        <span class="token punctuation">}</span>
        release <span class="token punctuation">{<!-- --></span>
            signingConfig signingConfigs<span class="token punctuation">.</span>releaseConfig
            minifyEnabled <span class="token boolean">true</span>
            proguardFiles <span class="token function">getDefaultProguardFile</span><span class="token punctuation">(</span><span class="token string">'proguard-android-optimize.txt'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'proguard-rules.pro'</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    compileOptions <span class="token punctuation">{<!-- --></span>
        sourceCompatibility JavaVersion<span class="token punctuation">.</span>VERSION_1_8
        targetCompatibility JavaVersion<span class="token punctuation">.</span>VERSION_1_8
    <span class="token punctuation">}</span>
    kotlinOptions <span class="token punctuation">{<!-- --></span>
        jvmTarget <span class="token operator">=</span> <span class="token string">'1.8'</span>
        useIR <span class="token operator">=</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span>
    buildFeatures <span class="token punctuation">{<!-- --></span>
        compose <span class="token boolean">true</span>
    <span class="token punctuation">}</span>
    composeOptions <span class="token punctuation">{<!-- --></span>
        kotlinCompilerExtensionVersion compose_version
        kotlinCompilerVersion <span class="token string">'1.5.10'</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

dependencies <span class="token punctuation">{<!-- --></span>
    testImplementation <span class="token string">'junit:junit:4.13.2'</span>
    androidTestImplementation <span class="token string">'androidx.test.ext:junit:1.1.2'</span>
    androidTestImplementation <span class="token string">'androidx.test.espresso:espresso-core:3.3.0'</span>
    implementation <span class="token string">'androidx.appcompat:appcompat:1.2.0'</span>
    implementation <span class="token string">'com.google.android.material:material:1.3.0'</span>
    <span class="token operator">..</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre>
    <h4>
     <a id="54_Kotlin__Model__195">
     </a>
     5.4.用 Kotlin 编写游戏逻辑实现 Model 层次
    </h4>
    <p>
     为遵守 MVI 设计逻辑，对于游戏界面，所有会由游戏内行为发出再导致前端显示刷新的变化，都集中存放在 TetrisState.kt 文件中。界面的所有变化都依赖后端 State 的变化而刷新。
     <br/>
     俄罗斯方块共有 7 种形状，每种形状有随着旋转还会有几种不同形态，本项目在 MockData.kt 文件中选用 4
     <em>
      4 的二维 IntArray 数组储存方块形状，在 TetrisState.kt 中选用 10
     </em>
     24 的二维 IntArray 数组表示存放方块的屏幕。
     <br/>
     以下是 TetrisState.kt 文件中一部分重要函数和类的代码：
    </p>
    <pre><code class="prism language-kotlin"><span class="token comment">// class Tetris：对于单个俄罗斯方块的 State 状态类</span>
<span class="token keyword">data</span> <span class="token keyword">class</span> Tetris <span class="token keyword">constructor</span><span class="token punctuation">(</span>
    <span class="token keyword">val</span> shapes<span class="token operator">:</span> List<span class="token operator">&lt;</span>List<span class="token operator">&lt;</span>Location<span class="token operator">&gt;</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token comment">// 此方块所有可能的旋转结果</span>
    <span class="token keyword">val</span> type<span class="token operator">:</span> Int<span class="token punctuation">,</span>                 <span class="token comment">// 用于标记当前处于哪种旋转状态</span>
    <span class="token keyword">val</span> offset<span class="token operator">:</span> Location<span class="token punctuation">,</span>          <span class="token comment">// 方块相对屏幕左上角的偏移量</span>
<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token operator">..</span><span class="token punctuation">.</span> <span class="token punctuation">}</span>

<span class="token comment">// class TetrisState：游戏的 State 状态类</span>
<span class="token keyword">data</span> <span class="token keyword">class</span> <span class="token function">TetrisState</span><span class="token punctuation">(</span>
    <span class="token keyword">val</span> brickArray<span class="token operator">:</span> Array<span class="token operator">&lt;</span>IntArray<span class="token operator">&gt;</span><span class="token punctuation">,</span>    <span class="token comment">//  屏幕坐标系</span>
    <span class="token keyword">val</span> tetris<span class="token operator">:</span> Tetris<span class="token punctuation">,</span>                 <span class="token comment">//  下落的方块</span>
    <span class="token keyword">val</span> gameStatus<span class="token operator">:</span> GameStatus <span class="token operator">=</span> GameStatus<span class="token punctuation">.</span>Welcome<span class="token punctuation">,</span> <span class="token comment">//  游戏状态</span>
    <span class="token keyword">val</span> soundEnable<span class="token operator">:</span> Boolean <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">,</span>    <span class="token comment">//  是否开启音效</span>
    <span class="token keyword">val</span> nextTetris<span class="token operator">:</span> Tetris <span class="token operator">=</span> <span class="token function">Tetris</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment">//  下一个方块</span>
    <span class="token keyword">var</span> currentScore<span class="token operator">:</span> Int <span class="token operator">=</span> infoStorage<span class="token punctuation">.</span>currentScore <span class="token comment">//  当前分数</span>
<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token operator">..</span><span class="token punctuation">.</span> <span class="token punctuation">}</span>

<span class="token comment">// class Action：接受用户 View 层次传入信号的 Action 类</span>
<span class="token keyword">sealed</span> <span class="token keyword">class</span> Action <span class="token punctuation">{<!-- --></span>            
    <span class="token keyword">object</span> Welcome <span class="token operator">:</span> <span class="token function">Action</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">object</span> Start <span class="token operator">:</span> <span class="token function">Action</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">object</span> Pause <span class="token operator">:</span> <span class="token function">Action</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">object</span> Reset <span class="token operator">:</span> <span class="token function">Action</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">object</span> Sound <span class="token operator">:</span> <span class="token function">Action</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">object</span> Settings <span class="token operator">:</span> <span class="token function">Action</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">object</span> Background <span class="token operator">:</span> <span class="token function">Action</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">object</span> Resume <span class="token operator">:</span> <span class="token function">Action</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">data</span> <span class="token keyword">class</span> <span class="token function">Transformation</span><span class="token punctuation">(</span><span class="token keyword">val</span> transformationType<span class="token operator">:</span> TransformationType<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">Action</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// fun combinedPlayListener() 函数：Action 行为的监听器，监听器接收到信号后，分别再发送给 private fun TetrisState.onStart() 等 TetrisState 的私有函数，进行处理</span>
<span class="token keyword">fun</span> <span class="token function">combinedPlayListener</span><span class="token punctuation">(</span>        
    onStart<span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> Unit <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    onPause<span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> Unit <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    onReset<span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> Unit <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    onSound<span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> Unit <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    onSettings<span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> Unit <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    onTransformation<span class="token operator">:</span> <span class="token punctuation">(</span>TransformationType<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> Unit <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">PlayListener</span><span class="token punctuation">(</span>
    onStart <span class="token operator">=</span> onStart<span class="token punctuation">,</span>
    onPause <span class="token operator">=</span> onPause<span class="token punctuation">,</span>
    onReset <span class="token operator">=</span> onReset<span class="token punctuation">,</span>
    onSound <span class="token operator">=</span> onSound<span class="token punctuation">,</span>
    onSettings <span class="token operator">=</span> onSettings<span class="token punctuation">,</span>
    onTransformation <span class="token operator">=</span> onTransformation
<span class="token punctuation">)</span>
</code></pre>
    <p>
     5.5.View 层和 Model 层的交互机制
     <br/>
     以下是 TetrisViewModel 类声明部分代码 ：
    </p>
    <pre><code class="prism language-kotlin"><span class="token keyword">class</span> TetrisViewModel <span class="token operator">:</span> <span class="token function">ViewModel</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">//功能：接收 Action 信号，由用户的动作改变 ViewModel</span>
	<span class="token keyword">fun</span> <span class="token function">dispatch</span><span class="token punctuation">(</span>action<span class="token operator">:</span> Action<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">}</span>  
    <span class="token comment">//功能：改变下落速度</span>
    <span class="token keyword">fun</span> <span class="token function">changeDownSpeed</span><span class="token punctuation">(</span>newSpeed <span class="token operator">:</span>Long<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">}</span>  
    <span class="token comment">//功能：初始进入软件时的欢迎效果</span>
    <span class="token keyword">private</span> <span class="token keyword">fun</span> <span class="token function">onWelcome</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">}</span>
    <span class="token comment">//功能：开始游戏</span>
    <span class="token keyword">private</span> <span class="token keyword">fun</span> <span class="token function">onStartGame</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">}</span>
    <span class="token comment">//功能：暂停游戏</span>
    <span class="token keyword">private</span> <span class="token keyword">fun</span> <span class="token function">onPauseGame</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">}</span>
    <span class="token comment">//功能：结束游戏</span>
    <span class="token keyword">private</span> <span class="token keyword">fun</span> <span class="token function">onGameOver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">}</span>
    <span class="token comment">//功能：开始清空界面</span>
    <span class="token keyword">private</span> <span class="token keyword">fun</span> <span class="token function">startClearScreenJob</span><span class="token punctuation">(</span>invokeOnCompletion<span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> Unit<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">}</span>
    <span class="token comment">//功能：取消清空界面</span>
    <span class="token keyword">private</span> <span class="token keyword">fun</span> <span class="token function">cancelClearScreenJob</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">}</span>
    <span class="token comment">//功能：方块下降</span>
    <span class="token keyword">private</span> <span class="token keyword">fun</span> <span class="token function">startDownJob</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">}</span>
    <span class="token comment">//功能：暂停方块下降</span>
    <span class="token keyword">private</span> <span class="token keyword">fun</span> <span class="token function">cancelDownJob</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">}</span>
    <span class="token comment">//功能：将当前界面状态传递给用户</span>
    <span class="token keyword">private</span> <span class="token keyword">fun</span> <span class="token function">dispatchState</span><span class="token punctuation">(</span>tetrisState<span class="token operator">:</span> TetrisState<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token operator">..</span><span class="token punctuation">}</span>
    <span class="token comment">//功能：游戏背景音乐播放</span>
    <span class="token keyword">private</span> <span class="token keyword">fun</span> <span class="token function">playSound</span><span class="token punctuation">(</span>action<span class="token operator">:</span> Action<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">}</span>
    <span class="token comment">//功能：播放不同类型的背景音乐</span>
    <span class="token keyword">private</span> <span class="token keyword">fun</span> <span class="token function">playSound</span><span class="token punctuation">(</span>soundType<span class="token operator">:</span> SoundType<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <h4>
     <a id="56_Compose__View__279">
     </a>
     5.6.基于 Compose 实现 View 层次
    </h4>
    <p>
     由于文档篇幅有限，详细的媒体内容展示可参考源代码、 PPT、和应用展示视频。
    </p>
    <h5>
     <a id="_281">
     </a>
     俄罗斯方块游戏屏幕
    </h5>
    <p>
     主要用到了 Compose 的自定义图像核心可组合项 Canvas ，预览效果如下图：
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/d2e16337d42a307c4fd1d15248eb6548.png"/>
    </p>
    <p>
     主要逻辑功能包括：绘制游戏屏幕背景、绘制以难度指定速度不断下落的方块、为方块提供按键移动功能、判断是否进行消行、如果方块超出当前屏幕则结束游戏。
     <br/>
     代码如下：
    </p>
    <pre><code class="prism language-kotlin"><span class="token comment">// 源文件：TetrisScreen.kt </span>
<span class="token keyword">package</span> com<span class="token punctuation">.</span>android_tetris<span class="token punctuation">.</span>ui
<span class="token keyword">import</span><span class="token operator">..</span><span class="token punctuation">.</span>
<span class="token annotation builtin">@Composable</span>
<span class="token keyword">fun</span> <span class="token function">TetrisScreen</span><span class="token punctuation">(</span>tetrisState<span class="token operator">:</span> TetrisState<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token operator">..</span><span class="token punctuation">.</span>  
    <span class="token function">Canvas</span><span class="token punctuation">(</span>modifier<span class="token operator">=</span>Modifier<span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token operator">..</span><span class="token punctuation">.</span>
        kotlin<span class="token punctuation">.</span><span class="token function">run</span> <span class="token punctuation">{<!-- --></span> <span class="token comment">//绘制方块矩阵</span>
            screenMatrix<span class="token punctuation">.</span><span class="token function">forEachIndexed</span> <span class="token punctuation">{<!-- --></span> y<span class="token punctuation">,</span> ints <span class="token operator">-&gt;</span>
                ints<span class="token punctuation">.</span><span class="token function">forEachIndexed</span> <span class="token punctuation">{<!-- --></span> x<span class="token punctuation">,</span> isFill <span class="token operator">-&gt;</span>
                    <span class="token function">translate</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token function">drawBrick</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> 
        kotlin<span class="token punctuation">.</span><span class="token function">run</span> <span class="token punctuation">{<!-- --></span> <span class="token operator">..</span><span class="token punctuation">.</span><span class="token function">drawPath</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token comment">//绘制下落方块        </span>
        kotlin<span class="token punctuation">.</span><span class="token function">run</span> <span class="token punctuation">{<!-- --></span> <span class="token function">drawRightPanel</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token comment">//绘制右侧得分栏   </span>
		kotlin<span class="token punctuation">.</span><span class="token function">run</span> <span class="token punctuation">{<!-- --></span> <span class="token function">drawHint</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">}</span> <span class="token comment">//绘制提示文字</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">//绘制单个方块</span>
<span class="token keyword">fun</span> DrawScope<span class="token punctuation">.</span><span class="token function">drawBrick</span><span class="token punctuation">(</span>brickSize<span class="token operator">:</span> Float<span class="token punctuation">,</span><span class="token comment">//每一个方块的size</span>
                        color<span class="token operator">:</span> Color<span class="token punctuation">,</span><span class="token comment">//砖块颜色</span>
                        background<span class="token operator">:</span> Color <span class="token comment">//背景颜色</span>
<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token operator">..</span><span class="token punctuation">.</span>
    <span class="token function">translate</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token function">drawRect</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token comment">//绘制外部矩形边框</span>
   	<span class="token function">translate</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token function">drawRect</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token comment">//绘制内部矩形边框</span>
<span class="token punctuation">}</span>
<span class="token keyword">private</span> <span class="token keyword">fun</span> DrawScope<span class="token punctuation">.</span><span class="token function">drawRightPanel</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">}</span><span class="token comment">//绘制右侧得分栏</span>
<span class="token keyword">private</span> <span class="token keyword">fun</span> DrawScope<span class="token punctuation">.</span><span class="token function">drawHint</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">}</span><span class="token comment">//绘制提示文字</span>
</code></pre>
    <h5>
     <a id="_317">
     </a>
     俄罗斯方块游戏按钮布局
    </h5>
    <p>
     预览效果如下图：
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/eacbed3c5d908c1e274fcbb0e70e5128.png"/>
    </p>
    <p>
     ConstraintLayout 是一种根据可组合项的相对位置关系显示的布局类型，代码如下：
    </p>
    <pre><code class="prism language-kotlin"><span class="token comment">//TetrisButton.kt</span>
<span class="token keyword">fun</span> <span class="token function">TetrisButton</span><span class="token punctuation">(</span>
    playListener<span class="token operator">:</span> PlayListener <span class="token operator">=</span> <span class="token function">combinedPlayListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token function">Column</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
		<span class="token function">Row</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
			<span class="token function">ControlButton</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span> playListener<span class="token punctuation">.</span><span class="token function">onStart</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token comment">//开始游戏</span>
			<span class="token function">ControlButton</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span> playListener<span class="token punctuation">.</span><span class="token function">onPause</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token comment">//暂停游戏</span>
			<span class="token function">ControlButton</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span> playListener<span class="token punctuation">.</span><span class="token function">onReset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token comment">//重新开始</span>
			<span class="token function">ControlButton</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span> playListener<span class="token punctuation">.</span><span class="token function">onSound</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token comment">//音乐开关</span>
		<span class="token punctuation">}</span>
		<span class="token function">ConstraintLayout</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
			<span class="token function">PlayButton</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>playListener<span class="token punctuation">.</span><span class="token function">onTransformation</span><span class="token punctuation">(</span>Rotate<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token comment">//旋转方块</span>
			<span class="token function">PlayButton</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>playListener<span class="token punctuation">.</span><span class="token function">onTransformation</span><span class="token punctuation">(</span>Fall<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token comment">//方块加速下落</span>
			<span class="token function">PlayButton</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span> playListener<span class="token punctuation">.</span><span class="token function">onTransformation</span><span class="token punctuation">(</span>Left<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token comment">//方块左移</span>
			<span class="token function">PlayButton</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>playListener<span class="token punctuation">.</span><span class="token function">onTransformation</span><span class="token punctuation">(</span>Right<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token comment">//方块右移</span>
			<span class="token function">PlayButton</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>playListener<span class="token punctuation">.</span><span class="token function">onTransformation</span><span class="token punctuation">(</span>FastDown<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token comment">//方块直接降落到最底部</span>
		<span class="token punctuation">}</span>	
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <h5>
     <a id="_344">
     </a>
     俄罗斯方块游戏机背景
    </h5>
    <p>
     预览效果如下图：
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/bf174b035ccc78676355d8765e886613.png"/>
    </p>
    <pre><code class="prism language-kotlin">代码如下：
<span class="token comment">// TetrisBody.kt</span>
<span class="token keyword">package</span> com<span class="token punctuation">.</span>android_tetris<span class="token punctuation">.</span>ui
<span class="token keyword">fun</span> <span class="token function">TetrisBody</span><span class="token punctuation">(</span>
    tetrisScreen<span class="token operator">:</span> <span class="token annotation builtin">@Composable</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> Unit<span class="token punctuation">)</span><span class="token punctuation">,</span> 
    tetrisButton<span class="token operator">:</span> <span class="token annotation builtin">@Composable</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> Unit<span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token operator">..</span><span class="token punctuation">.</span>
  	<span class="token keyword">val</span> size <span class="token keyword">by</span> <span class="token function">animateDpAsState</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token comment">//改变大小状态</span>
  	<span class="token keyword">val</span> color <span class="token keyword">by</span> infiniteTransition<span class="token punctuation">.</span><span class="token function">animateColor</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token comment">//改变颜色状态</span>
	<span class="token function">Column</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
		<span class="token function">TopBar</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
			<span class="token function">Row</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
				<span class="token function">Icon</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">Text</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token comment">//转到setting界面</span>
				<span class="token function">Icon</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">Text</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token comment">//转到More界面</span>
				<span class="token function">Icon</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">Text</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token comment">//增大屏幕</span>
				<span class="token function">Icon</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">Text</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token comment">//减小屏幕</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
		<span class="token function">Box</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
			<span class="token function">Column</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span> <span class="token function">tetrisScreen</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token comment">//游戏屏幕区</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	<span class="token function">tetrisButton</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">//游戏按钮区</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     最终主界面的整体组合效果：
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/20659c024f13f94ec6201af313b90227.png"/>
    </p>
    <h5>
     <a id="_379">
     </a>
     游戏设置页面
    </h5>
    <p>
     预览效果如下图：
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/65387ed78b9ef4f3782698a559133c7f.png"/>
    </p>
    <p>
     代码如下：
    </p>
    <pre><code class="prism language-kotlin"><span class="token comment">//TetrisSettingScreen.kt</span>
<span class="token keyword">fun</span> <span class="token function">SettingsScreen</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
	<span class="token function">Box</span><span class="token punctuation">(</span>modifier <span class="token operator">=</span> Modifier
            <span class="token punctuation">.</span><span class="token function">fillMaxSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">verticalScroll</span><span class="token punctuation">(</span><span class="token function">rememberScrollState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">//垂直滚动</span>
	<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
		<span class="token function">Box</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
			Box<span class="token punctuation">{<!-- --></span>
				<span class="token function">Column</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
					<span class="token function">Box</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
						 <span class="token function">LoginPageTopBlurImage</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token comment">//顶部模糊背景</span>
						 <span class="token function">LoginPageTopRotaAndScaleImage</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token comment">//顶部旋转头像</span>
					<span class="token punctuation">}</span>
					<span class="token function">Column</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
						Row<span class="token punctuation">{<!-- --></span>
							<span class="token function">Text</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token comment">//game setting 图标</span>
							<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token operator">..</span><span class="token punctuation">.</span> <span class="token function">PlanetMoon</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token comment">//黑夜模式展示月亮动画</span>
							<span class="token keyword">else</span> <span class="token function">AnimateSun</span><span class="token punctuation">(</span>Modifier<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">.</span>dp<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">//白天模式展示太阳</span>
						<span class="token punctuation">}</span>
						<span class="token function">ConstraintLayout</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token operator">..</span><span class="token punctuation">.</span>
							<span class="token function">Row</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token comment">//难度选择</span>
								<span class="token function">Column</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
									 <span class="token function">RadioSelectionButton</span><span class="token punctuation">(</span>label <span class="token operator">=</span> <span class="token string">"Easy"</span><span class="token punctuation">,</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token comment">//简单</span>
									 <span class="token function">RadioSelectionButton</span><span class="token punctuation">(</span>label <span class="token operator">=</span> <span class="token string">"Normal"</span><span class="token punctuation">,</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token comment">//普通</span>
									 <span class="token function">RadioSelectionButton</span><span class="token punctuation">(</span>label <span class="token operator">=</span> <span class="token string">"Hard"</span><span class="token punctuation">,</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token comment">//困难</span>
								<span class="token punctuation">}</span>
							<span class="token punctuation">}</span>
							<span class="token function">Row</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token comment">//主题选择</span>
								<span class="token function">Column</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
									<span class="token function">RectangularButton</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
									<span class="token punctuation">{<!-- --></span>viewModel<span class="token punctuation">.</span>Theme <span class="token operator">=</span> ComposeTetrisTheme<span class="token punctuation">.</span>Theme<span class="token punctuation">.</span>Light<span class="token punctuation">}</span> <span class="token comment">//白天模式</span>
									<span class="token function">RectangularButton</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
									<span class="token punctuation">{<!-- --></span>viewModel<span class="token punctuation">.</span>Theme <span class="token operator">=</span> ComposeTetrisTheme<span class="token punctuation">.</span>Theme<span class="token punctuation">.</span>Dark<span class="token punctuation">}</span> <span class="token comment">//黑夜模式</span>
								<span class="token punctuation">}</span>
							<span class="token punctuation">}</span>
							<span class="token function">Row</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token comment">//音乐切换</span>
								 <span class="token function">RectangularButton</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token keyword">when</span><span class="token punctuation">(</span>infoStorage<span class="token punctuation">.</span>bgm<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
							<span class="token punctuation">}</span>							
						<span class="token punctuation">}</span>
						<span class="token function">Text</span><span class="token punctuation">(</span> text <span class="token operator">=</span> <span class="token string">"Player Profile"</span><span class="token punctuation">,</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token comment">//个人主页标题</span>
						<span class="token function">ConstraintLayout</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
							<span class="token function">Row</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token comment">//用户名</span>
								<span class="token function">TextField</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
							<span class="token punctuation">}</span>
							<span class="token function">Row</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token comment">//最高分</span>
								<span class="token function">Text</span><span class="token punctuation">(</span>text <span class="token operator">=</span> <span class="token string">"<span class="token interpolation variable">$highest</span>"</span><span class="token punctuation">,</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span>                          
							<span class="token punctuation">}</span>
							<span class="token function">Row</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token comment">//帮助文档</span>
								<span class="token function">DropDownAnimate</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token function">Text</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
							<span class="token punctuation">}</span>
						<span class="token punctuation">}</span>
					<span class="token punctuation">}</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     关于我们页面
     <br/>
     预览效果如图所示：
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/5fea9d8c34d9911d8af1b582a608b475.png"/>
    </p>
    <p>
     代码如下：
    </p>
    <pre><code class="prism language-kotlin"><span class="token comment">//AboutUsScreen.kt</span>
<span class="token keyword">package</span> com<span class="token punctuation">.</span>android_tetris
<span class="token operator">..</span><span class="token punctuation">.</span>
<span class="token keyword">fun</span> <span class="token function">AboutUsScreen</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
	    <span class="token function">Box</span><span class="token punctuation">(</span>modifier <span class="token operator">=</span> Modifier<span class="token punctuation">.</span><span class="token function">verticalScroll</span><span class="token punctuation">(</span><span class="token function">rememberScrollState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">//垂直滚动界面</span>
        <span class="token punctuation">.</span><span class="token function">background</span><span class="token punctuation">(</span>color <span class="token operator">=</span> Color<span class="token punctuation">.</span>Black<span class="token punctuation">)</span>
    <span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    	<span class="token function">Column</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    		 <span class="token function">topBarView_More</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">//顶部导航栏</span>
    		 <span class="token function">Text</span><span class="token punctuation">(</span> buildAnnotatedString <span class="token punctuation">{<!-- --></span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token comment">//彩虹式标题</span>
    		 BlinkTag <span class="token punctuation">{<!-- --></span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">}</span><span class="token comment">//提示文字，点击图片</span>
    		 <span class="token function">Row</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token function">InkColorCanvas</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span> <span class="token comment">// 水墨渲染图片</span>
    		 <span class="token function">Row</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token function">Parallax</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token comment">//3D安卓小人，展示开发信息</span>
    		 <span class="token function">Row</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    		 	<span class="token function">Text</span><span class="token punctuation">(</span>text <span class="token operator">=</span> <span class="token string">"Our Faith"</span><span class="token punctuation">,</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token comment">//标题</span>
    		 	<span class="token function">Spacer</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token comment">//间距</span>
    		 	<span class="token function">Image</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token comment">//月亮图片</span>
    		 <span class="token punctuation">}</span>
    		 <span class="token function">Row</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token operator">..</span><span class="token punctuation">.</span>
    		 	<span class="token function">BoxWithConstraints</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    		 		<span class="token function">Rocket</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token comment">//发射动画</span>
    		 		<span class="token function">LaunchButton</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token comment">//发射按钮</span>
    		 	<span class="token punctuation">}</span>
    		 <span class="token punctuation">}</span>
    		 <span class="token function">Text</span><span class="token punctuation">(</span>text <span class="token operator">=</span> <span class="token string">"Message Board"</span><span class="token punctuation">,</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token comment">//标题</span>
    		 <span class="token function">Image</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token comment">//胶片上边框</span>
    		 <span class="token function">Box</span><span class="token punctuation">(</span> modifier <span class="token operator">=</span> Modifier<span class="token punctuation">.</span><span class="token function">horizontalScroll</span><span class="token punctuation">(</span><span class="token function">rememberScrollState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">..</span><span class="token punctuation">.</span>   		 		
    		 <span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token comment">//横向滚动</span>
    		 	Row<span class="token punctuation">{<!-- --></span>
    		 		<span class="token function">Box</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span> <span class="token function">ImageCard</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token comment">//留言卡片一</span>
    		 		<span class="token function">Box</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span> <span class="token function">ImageCard</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token comment">//留言卡片二</span>
    		 		<span class="token function">Box</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span> <span class="token function">ImageCard</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token comment">//留言卡片三</span>
    		 	<span class="token punctuation">}</span> 		 	
    		 <span class="token punctuation">}</span>
    		 <span class="token function">Text</span><span class="token punctuation">(</span>text <span class="token operator">=</span> <span class="token string">"Contact us"</span><span class="token punctuation">,</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token comment">//标题</span>
    		 <span class="token function">Text</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token comment">//提示信息</span>
    		 <span class="token function">Box</span><span class="token punctuation">(</span> modifier <span class="token operator">=</span> Modifier<span class="token punctuation">.</span><span class="token function">horizontalScroll</span><span class="token punctuation">(</span><span class="token function">rememberScrollState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">..</span><span class="token punctuation">.</span>   		 		
    		 <span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token comment">//横向滚动</span>
    		 	Row<span class="token punctuation">{<!-- --></span>
    		 		<span class="token function">Box</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token function">Card</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token comment">//项目地址信息</span>
    		 		<span class="token function">Box</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token function">Card</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token comment">//开发者邮箱</span>
    		 		<span class="token function">Box</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token function">Card</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token comment">//开发者码云账户</span>
    		 	<span class="token punctuation">}</span> 		 	
    		 <span class="token punctuation">}</span>
    	<span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <h4>
     <a id="57_504">
     </a>
     5.7.实现界面切换和导航功能
    </h4>
    <p>
     最开始，我们想借助 Jetpack Navigation 框架的接口实现界面跳转，但进行了很多天的尝试也未能成功。
     <br/>
     随着我们更加深入理解 Compose 的特性，我们认识到 Compose 作为“声明式界面”本身就能够自动更新其中的数据。因此，可以定义一个顶级声明变量，使该变量指代当前应该显示的屏幕，从而采用选择性显示或隐藏某界面的方式，间接实现界面切换功能。
    </p>
    <pre><code class="prism language-kotlin"><span class="token comment">// MainActivity.kt 中选择性显示界面的代码</span>
<span class="token function">ComposeTetrisTheme</span><span class="token punctuation">(</span>viewModel<span class="token punctuation">.</span>Theme<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">when</span> <span class="token punctuation">(</span>infoStorage<span class="token punctuation">.</span>currentScreen<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token number">0</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{<!-- --></span>
            <span class="token function">TetrisGameScreen</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        <span class="token number">1</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{<!-- --></span>
            <span class="token function">SettingsScreen</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        <span class="token number">2</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{<!-- --></span>
            <span class="token function">AboutUsScreen</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">//Topbar.kt</span>
<span class="token keyword">package</span> com<span class="token punctuation">.</span>android_tetris<span class="token punctuation">.</span>ui<span class="token punctuation">.</span>theme

<span class="token comment">//设置界面导航栏</span>
<span class="token annotation builtin">@Composable</span>
<span class="token keyword">fun</span> <span class="token function">topBarView_Set</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">}</span>

<span class="token comment">//关于我们界面导航栏</span>
<span class="token annotation builtin">@Preview</span>
<span class="token annotation builtin">@Composable</span>
<span class="token keyword">fun</span> <span class="token function">topBarView_More</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">}</span>
</code></pre>
    <h4>
     <a id="58_535">
     </a>
     5.8.设置显示界面主题
    </h4>
    <p>
     定义主题颜色：分白天和黑夜两个主题，对游戏界面背景颜色、设置界面背景颜色、字体和按钮等颜色进行设置。根据用户所选择的主题，确定颜色组合，赋值给 MaterialTheme 的 colors 成员。
    </p>
    <pre><code class="prism language-kotlin"><span class="token comment">// 黑色主题</span>
<span class="token keyword">private</span> <span class="token keyword">val</span> DarkColorPalette <span class="token operator">=</span> <span class="token function">darkColors</span><span class="token punctuation">(</span> <span class="token operator">..</span><span class="token punctuation">.</span> <span class="token punctuation">)</span>
<span class="token comment">// 白天主题</span>
<span class="token keyword">private</span> <span class="token keyword">val</span> LightColorPalette <span class="token operator">=</span> <span class="token function">lightColors</span><span class="token punctuation">(</span> <span class="token operator">..</span><span class="token punctuation">.</span> <span class="token punctuation">)</span>

构建 ComposeTetrisTheme 对象，用枚举类存放白天黑夜两个主题供用户选择。

<span class="token keyword">object</span> ComposeTetrisTheme <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">enum</span> <span class="token keyword">class</span> Theme <span class="token punctuation">{<!-- --></span>
        Light<span class="token punctuation">,</span> Dark
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     编写主题设置函数：定义 fun ComposeTetrisTheme () 函数，该函数第一个参数接收一个主题对象参数，用于参数判断当前的主题类型；第二个参数接收一个 content 参数确定主题函数作用范围。将变量 colors 传给 MaterialTheme。
    </p>
    <pre><code class="prism language-kotlin"><span class="token keyword">fun</span> <span class="token function">ComposeTetrisTheme</span><span class="token punctuation">(</span>
    theme<span class="token operator">:</span> ComposeTetrisTheme<span class="token punctuation">.</span>Theme <span class="token operator">=</span> ComposeTetrisTheme<span class="token punctuation">.</span>Theme<span class="token punctuation">.</span>Light<span class="token punctuation">,</span>
    content<span class="token operator">:</span> <span class="token annotation builtin">@Composable</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> Unit
<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">val</span> colors <span class="token operator">=</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>theme <span class="token operator">==</span> ComposeTetrisTheme<span class="token punctuation">.</span>Theme<span class="token punctuation">.</span>Dark<span class="token punctuation">)</span>
        DarkColorPalette
    <span class="token keyword">else</span>
        LightColorPalette

    <span class="token function">MaterialTheme</span><span class="token punctuation">(</span>
        colors <span class="token operator">=</span> colors<span class="token punctuation">,</span>
        typography <span class="token operator">=</span> Typography<span class="token punctuation">,</span>
        shapes <span class="token operator">=</span> Shapes<span class="token punctuation">,</span>
        content <span class="token operator">=</span> content
    <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre>
    <p>
     设置按钮事件实现主题切换：绘制两个按钮分别代表白天模式和黑夜模式，效果是点击按钮 day mode，将 viewModel.Theme 置为 Light，点击按钮 Night mode，将 viewModel.Theme 置为 Dark。主题 Theme 的控制变量放在 ThemeViewModel 类中。 ThemeViewModel 继承自 ViewModel ， ViewModel 旨在以生命周期意识的方式，存储和管理用户界面相关的数据，目的是存放应用程序页面所需的数据。这样页面只需要处理用户交互，以及负责展示数据的工作。
     <br/>
     ThemeViewModel 只包含一个成员 var Theme ，用 by mutableStateOf(ComposeTetrisTheme.Theme.Light) 初始化。其中 mutableStateOf 函数的作用是显式标明这个 Theme 是有状态的，如果 Theme 的状态发生了改变，所有引用这个状态的控件都需要重新绘制。
    </p>
    <pre><code class="prism language-kotlin"><span class="token keyword">var</span> viewModel <span class="token operator">:</span> ThemeViewModel <span class="token operator">=</span> <span class="token function">viewModel</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">Column</span><span class="token punctuation">(</span>modifier <span class="token operator">=</span> Modifier<span class="token punctuation">.</span><span class="token function">fillMaxWidth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token function">RectangularButton</span><span class="token punctuation">(</span>
            label <span class="token operator">=</span> <span class="token string">"Daytime mode"</span>，
        <span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            viewModel<span class="token punctuation">.</span>Theme <span class="token operator">=</span> ComposeTetrisTheme<span class="token punctuation">.</span>Theme<span class="token punctuation">.</span>Light
        <span class="token punctuation">}</span>

        <span class="token function">RectangularButton</span><span class="token punctuation">(</span>
            label <span class="token operator">=</span> <span class="token string">"Night mode"</span><span class="token punctuation">,</span>
        <span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            viewModel<span class="token punctuation">.</span>Theme <span class="token operator">=</span> ComposeTetrisTheme<span class="token punctuation">.</span>Theme<span class="token punctuation">.</span>Dark
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

<span class="token keyword">class</span> ThemeViewModel <span class="token operator">:</span> <span class="token function">ViewModel</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 选择夜间模式还是普通配色</span>
    <span class="token keyword">var</span> Theme <span class="token keyword">by</span> <span class="token function">mutableStateOf</span><span class="token punctuation">(</span>ComposeTetrisTheme<span class="token punctuation">.</span>Theme<span class="token punctuation">.</span>Light<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre>
    <h4>
     <a id="59_594">
     </a>
     5.9.动画设计
    </h4>
    <p>
     Jetpack Compose 为各种动画效果提供实验性 API，可能会在之后的版本中逐步完善：
    </p>
    <pre><code class="prism language-kotlin"><span class="token comment">// Animation.kt</span>
<span class="token keyword">package</span> com<span class="token punctuation">.</span>android_tetris<span class="token punctuation">.</span>ui<span class="token punctuation">.</span>theme

<span class="token comment">// 绘制动态月亮</span>
<span class="token annotation builtin">@Composable</span>
<span class="token keyword">fun</span> <span class="token function">PlanetMoon</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">}</span><span class="token comment">// 插入月亮图片</span>
<span class="token annotation builtin">@Composable</span>
<span class="token keyword">private</span> <span class="token keyword">fun</span> <span class="token function">buildEarthFloatAnimation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> State<span class="token operator">&lt;</span>Float<span class="token operator">&gt;</span><span class="token punctuation">{<!-- --></span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">}</span><span class="token comment">//实现月亮垂直方向浮动效果</span>
<span class="token annotation builtin">@Composable</span>
<span class="token keyword">private</span> <span class="token keyword">fun</span> <span class="token function">buildEarthRotationAnimation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> State<span class="token operator">&lt;</span>Float<span class="token operator">&gt;</span> <span class="token punctuation">{<!-- --></span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">}</span><span class="token comment">//实现月亮沿着竖直轴旋转效果</span>

<span class="token comment">// 水墨渲染动画</span>
<span class="token annotation builtin">@Composable</span>
<span class="token keyword">fun</span> <span class="token function">InkColorCanvas</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">}</span>

<span class="token comment">// 旋转太阳的动画</span>
<span class="token annotation builtin">@Composable</span>
<span class="token keyword">fun</span> <span class="token function">AnimateSun</span><span class="token punctuation">(</span>modifier<span class="token operator">:</span> Modifier <span class="token operator">=</span> Modifier<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">}</span>
<span class="token annotation builtin">@Composable</span>
<span class="token keyword">fun</span> <span class="token function">Sun</span><span class="token punctuation">(</span>modifier<span class="token operator">:</span> Modifier <span class="token operator">=</span> Modifier<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">}</span>

<span class="token comment">// 3D页面下翻动画</span>
<span class="token annotation builtin">@Composable</span>
<span class="token keyword">fun</span> <span class="token function">DropDownAnimate</span><span class="token punctuation">(</span>
    text<span class="token operator">:</span> String<span class="token punctuation">,</span>
    modifier<span class="token operator">:</span> Modifier <span class="token operator">=</span> Modifier<span class="token punctuation">,</span>
    initiallyOpened<span class="token operator">:</span> Boolean <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    content<span class="token operator">:</span> <span class="token annotation builtin">@Composable</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> Unit
<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">}</span>

<span class="token comment">//3D 安卓小人动画</span>
<span class="token keyword">fun</span> <span class="token function">Parallax</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">}</span>
<span class="token keyword">fun</span> <span class="token function">getRotationAngles</span><span class="token punctuation">(</span>
    start<span class="token operator">:</span> Pair<span class="token operator">&lt;</span>Float<span class="token punctuation">,</span> Float<span class="token operator">&gt;</span><span class="token punctuation">,</span>
    end<span class="token operator">:</span> Pair<span class="token operator">&lt;</span>Float<span class="token punctuation">,</span> Float<span class="token operator">&gt;</span><span class="token punctuation">,</span>
    size<span class="token operator">:</span> Size
<span class="token punctuation">)</span><span class="token operator">:</span> Pair<span class="token operator">&lt;</span>Float<span class="token punctuation">,</span> Float<span class="token operator">&gt;</span> <span class="token punctuation">{<!-- --></span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">}</span>
<span class="token keyword">fun</span> <span class="token function">getDistances</span><span class="token punctuation">(</span>p1<span class="token operator">:</span> Pair<span class="token operator">&lt;</span>Float<span class="token punctuation">,</span> Float<span class="token operator">&gt;</span><span class="token punctuation">,</span> p2<span class="token operator">:</span> Pair<span class="token operator">&lt;</span>Float<span class="token punctuation">,</span> Float<span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token operator">:</span> Pair<span class="token operator">&lt;</span>Float<span class="token punctuation">,</span> Float<span class="token operator">&gt;</span> <span class="token punctuation">{<!-- --></span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">}</span>
<span class="token keyword">fun</span> <span class="token function">getTranslation</span><span class="token punctuation">(</span>angle<span class="token operator">:</span> Float<span class="token punctuation">,</span> maxDistance<span class="token operator">:</span> Float<span class="token punctuation">)</span><span class="token operator">:</span> Float <span class="token punctuation">{<!-- --></span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">}</span>

<span class="token comment">// 火箭发射动画</span>
<span class="token annotation builtin">@Composable</span>
<span class="token keyword">fun</span> <span class="token function">Rocket</span><span class="token punctuation">(</span>
    isRocketEnabled<span class="token operator">:</span> Boolean<span class="token punctuation">,</span>
    maxWidth<span class="token operator">:</span> Dp<span class="token punctuation">,</span>
    maxHeight<span class="token operator">:</span> Dp
<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">}</span>
<span class="token comment">//火箭发射按钮</span>
<span class="token annotation builtin">@ExperimentalAnimationApi</span>
<span class="token annotation builtin">@Composable</span>
<span class="token keyword">fun</span> <span class="token function">LaunchButton</span><span class="token punctuation">(</span> 
    animationState<span class="token operator">:</span> Boolean<span class="token punctuation">,</span>
    onToggleAnimationState<span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> Unit<span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">}</span>

<span class="token comment">//ImageCard</span>
<span class="token annotation builtin">@Composable</span>
<span class="token keyword">fun</span> <span class="token function">ImageCard</span><span class="token punctuation">(</span>
    painter<span class="token operator">:</span> Painter<span class="token punctuation">,</span>
    contentDescription<span class="token operator">:</span> String<span class="token punctuation">,</span>
    title<span class="token operator">:</span> String<span class="token punctuation">,</span>
    modifier<span class="token operator">:</span>Modifier<span class="token operator">=</span>Modifier
<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">}</span>

<span class="token comment">// Login.kt</span>
<span class="token keyword">package</span> com<span class="token punctuation">.</span>android_tetris<span class="token punctuation">.</span>ui<span class="token punctuation">.</span>theme
<span class="token keyword">import</span><span class="token operator">..</span><span class="token punctuation">.</span>

<span class="token comment">//登陆背景模糊头缩放部图片</span>
<span class="token annotation builtin">@Composable</span>
<span class="token keyword">fun</span> <span class="token function">LoginPageTopBlurImage</span><span class="token punctuation">(</span>
    animatedBitmap<span class="token operator">:</span> Animatable<span class="token operator">&lt;</span>Float<span class="token punctuation">,</span> AnimationVector1D<span class="token operator">&gt;</span><span class="token punctuation">,</span>
    animatedOffset<span class="token operator">:</span> Animatable<span class="token operator">&lt;</span>Float<span class="token punctuation">,</span> AnimationVector1D<span class="token operator">&gt;</span><span class="token punctuation">,</span>
    animatedScales<span class="token operator">:</span> Animatable<span class="token operator">&lt;</span>Float<span class="token punctuation">,</span> AnimationVector1D<span class="token operator">&gt;</span>
<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">}</span>

<span class="token comment">//登陆页面头部旋转缩放的图片</span>
<span class="token annotation builtin">@Composable</span>
<span class="token keyword">fun</span> <span class="token function">LoginPageTopRotaAndScaleImage</span><span class="token punctuation">(</span>
    animatedColor<span class="token operator">:</span> Animatable<span class="token operator">&lt;</span>androidx<span class="token punctuation">.</span>compose<span class="token punctuation">.</span>ui<span class="token punctuation">.</span>graphics<span class="token punctuation">.</span>Color<span class="token punctuation">,</span> AnimationVector4D<span class="token operator">&gt;</span><span class="token punctuation">,</span>
    animatedScales<span class="token operator">:</span> Animatable<span class="token operator">&lt;</span>Float<span class="token punctuation">,</span> AnimationVector1D<span class="token operator">&gt;</span><span class="token punctuation">,</span>
    animatedOffset<span class="token operator">:</span> Animatable<span class="token operator">&lt;</span>Float<span class="token punctuation">,</span> AnimationVector1D<span class="token operator">&gt;</span>
<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">}</span>

<span class="token comment">//圆形图片</span>
<span class="token annotation builtin">@Stable</span>
<span class="token keyword">class</span> <span class="token function">CicleImageShape</span><span class="token punctuation">(</span><span class="token keyword">val</span> circle<span class="token operator">:</span> Float <span class="token operator">=</span> <span class="token number">0f</span><span class="token punctuation">)</span> <span class="token operator">:</span> Shape <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">override</span> <span class="token keyword">fun</span> <span class="token function">createOutline</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token operator">:</span> Outline <span class="token punctuation">{<!-- --></span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">//形状裁剪</span>
<span class="token annotation builtin">@Stable</span>
<span class="token keyword">class</span> <span class="token function">QureytoImageShapes</span><span class="token punctuation">(</span><span class="token keyword">var</span> hudu<span class="token operator">:</span> Float <span class="token operator">=</span> <span class="token number">100f</span><span class="token punctuation">,</span> <span class="token keyword">var</span> controller<span class="token operator">:</span>Float<span class="token operator">=</span><span class="token number">0f</span><span class="token punctuation">)</span> <span class="token operator">:</span> Shape <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">override</span> <span class="token keyword">fun</span> <span class="token function">createOutline</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token operator">:</span> Outline <span class="token punctuation">{<!-- --></span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 模糊效果</span>
<span class="token keyword">object</span> BitmapBlur <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">fun</span> <span class="token function">doBlur</span><span class="token punctuation">(</span>sentBitmap<span class="token operator">:</span> Bitmap<span class="token punctuation">,</span> radiu<span class="token operator">:</span> Int <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> canReuseInBitmap<span class="token operator">:</span> Boolean<span class="token punctuation">)</span><span class="token operator">:</span> Bitmap <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">//RainbowSpark.kt</span>
<span class="token keyword">package</span> com<span class="token punctuation">.</span>android_tetris<span class="token punctuation">.</span>ui<span class="token punctuation">.</span>theme
<span class="token keyword">import</span><span class="token operator">..</span><span class="token punctuation">.</span>

<span class="token comment">// 彩虹渐变字体</span>
<span class="token annotation builtin">@ExperimentalAnimationApi</span>
<span class="token annotation builtin">@Composable</span>
<span class="token keyword">fun</span> <span class="token function">MultiColorSmoothText</span><span class="token punctuation">(</span>
    modifier<span class="token operator">:</span> Modifier <span class="token operator">=</span> Modifier<span class="token punctuation">,</span>
    text<span class="token operator">:</span> String<span class="token punctuation">,</span>
    style<span class="token operator">:</span> TextStyle <span class="token operator">=</span> LocalTextStyle<span class="token punctuation">.</span>current<span class="token punctuation">,</span>
    rainbow<span class="token operator">:</span> List<span class="token operator">&lt;</span>Color<span class="token operator">&gt;</span> <span class="token operator">=</span> PastelRainbow<span class="token punctuation">,</span>
    startIndex<span class="token operator">:</span> Int <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>
    duration<span class="token operator">:</span> Int
<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">}</span>

<span class="token comment">//闪烁字体</span>
<span class="token annotation builtin">@ExperimentalAnimationApi</span>
<span class="token annotation builtin">@Composable</span>
<span class="token keyword">fun</span> <span class="token function">BlinkTag</span><span class="token punctuation">(</span>
    modifier<span class="token operator">:</span> Modifier <span class="token operator">=</span> Modifier<span class="token punctuation">,</span>
    duration<span class="token operator">:</span> Int <span class="token operator">=</span> <span class="token number">500000</span><span class="token punctuation">,</span>
    content<span class="token operator">:</span> <span class="token annotation builtin">@Composable</span> <span class="token punctuation">(</span>modifier<span class="token operator">:</span> Modifier<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> Unit
<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">}</span>
</code></pre>
    <h3>
     <a id="_Git__723">
     </a>
     附录：源代码 Git 仓库链接
    </h3>
    <p>
     Gitee：
     <a href="https://gitee.com/yxwang2023/android_tetris" rel="nofollow">
      https://gitee.com/yxwang2023/android_tetris
     </a>
     <br/>
     GitHub：
     <a href="https://github.com/zyw-stu/Andriod_Tetris">
      https://github.com/zyw-stu/Andriod_Tetris
     </a>
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="6874747073:3a2f2f626c6f672e6373646e2e6e65742f7a7977323030322f:61727469636c652f64657461696c732f313230323930303239" class_="artid" style="display:none">
 </p>
</div>


