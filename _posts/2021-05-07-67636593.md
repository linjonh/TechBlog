---
layout: post
title: "Java代码调用Sqlldr命令例子"
date: 2021-05-07 20:19:52 +0800
description: "控制文件test.ctlLOAD DATAINFILE 'C:\\case.csv'APPENDINT"
keywords: "java sqlldr"
categories: ['Oracle']
tags: ['Sqlldr', 'Oracle', 'Java']
artid: "67636593"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=67636593
    alt: "Java代码调用Sqlldr命令例子"
render_with_liquid: false
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     Java代码调用Sqlldr命令例子
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-tomorrow-night-eighties" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <ul>
     <li>
      <strong>
       控制文件test.ctl
      </strong>
     </li>
    </ul>
    <pre class="prettyprint"><code class="hljs sql"><span class="hljs-operator"><span class="hljs-keyword">LOAD</span> DATA
INFILE <span class="hljs-string">'C:\case.csv'</span>
APPEND
<span class="hljs-keyword">INTO</span> <span class="hljs-keyword">TABLE</span> T
FIELDS TERMINATED <span class="hljs-keyword">BY</span> <span class="hljs-string">','</span>
OPTIONALLY ENCLOSED <span class="hljs-keyword">BY</span> <span class="hljs-string">'"'</span>
(
A <span class="hljs-keyword">CHAR</span>,
B <span class="hljs-keyword">CHAR</span>
)</span></code></pre>
    <ul>
     <li>
      <strong>
       数据文件case.csv
      </strong>
     </li>
    </ul>
    <pre class="prettyprint"><code class="hljs livecodeserver"><span class="hljs-number">1</span>,<span class="hljs-number">2</span>
<span class="hljs-operator">a</span>,b
b,c
c,d</code></pre>
    <ul>
     <li>
      <strong>
       完整例子
      </strong>
     </li>
    </ul>
    <pre class="prettyprint"><code class="language-java hljs"><span class="hljs-keyword">import</span> java.io.BufferedReader;
<span class="hljs-keyword">import</span> java.io.InputStream;
<span class="hljs-keyword">import</span> java.io.InputStreamReader;

<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">JavaSqlldr</span> {<!-- --></span>

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String ctlFileDir = <span class="hljs-string">"C:\\"</span>;
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String logFileDir = <span class="hljs-string">"C:\\"</span>;

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span>(String[] args) {

        String username = <span class="hljs-string">"SYS"</span>;
        String password = <span class="hljs-string">"123"</span>;
        String Database = <span class="hljs-string">"@ORCL"</span>;
        String ctlFileName = <span class="hljs-string">"test.ctl"</span>;
        String logFileName = <span class="hljs-string">"test_table.log"</span>;
        <span class="hljs-keyword">boolean</span> isDBA = <span class="hljs-keyword">true</span>;

        String command = buildCommand(
                            username, 
                            password, 
                            Database, 
                            isDBA,
                            JavaSqlldr.ctlFileDir, 
                            ctlFileName, 
                            JavaSqlldr.logFileDir, 
                            logFileName
                            );

        Executive(command);
    }

    <span class="hljs-javadoc">/**
     *<span class="hljs-javadoctag"> @param</span> username
     *<span class="hljs-javadoctag"> @param</span> password
     *<span class="hljs-javadoctag"> @param</span> Database
     *<span class="hljs-javadoctag"> @param</span> isDBA
     *<span class="hljs-javadoctag"> @param</span> ctlFileDir
     *<span class="hljs-javadoctag"> @param</span> ctlFileName
     *<span class="hljs-javadoctag"> @param</span> logFileDir
     *<span class="hljs-javadoctag"> @param</span> logFileName
     *<span class="hljs-javadoctag"> @return</span> 
     *      the sql loader command
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title">buildCommand</span>(
            String username, 
            String password, 
            String Database,
            <span class="hljs-keyword">boolean</span> isDBA,
            String ctlFileDir, 
            String ctlFileName,
            String logFileDir, 
            String logFileName) {

        StringBuffer command = <span class="hljs-keyword">new</span> StringBuffer();
        command.append(<span class="hljs-string">"sqlldr "</span>);
        command.append(isDBA ? <span class="hljs-string">"'"</span> : <span class="hljs-string">""</span>);
        command.append(username);
        command.append(<span class="hljs-string">"/"</span>);
        command.append(password);
        command.append(Database);
        command.append(isDBA ? <span class="hljs-string">" as sysdba'"</span> : <span class="hljs-string">""</span>);
        command.append(<span class="hljs-string">" control="</span> + ctlFileDir + ctlFileName);
        command.append(<span class="hljs-string">" log="</span> + logFileDir + logFileName);

        System.out.println(<span class="hljs-string">"Command : "</span> + command.toString());
        <span class="hljs-comment">//command : sqlldr 'SYS/123@ORCL as sysdba' control=C:\test.ctl log=C:\test_table.log</span>
        <span class="hljs-keyword">return</span> command.toString();

    }


    <span class="hljs-javadoc">/**
     * To call DOS command
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Executive</span>(String command) {

        InputStream ins = <span class="hljs-keyword">null</span>;

        String[] cmd = <span class="hljs-keyword">new</span> String[] { <span class="hljs-string">"cmd.exe"</span>, <span class="hljs-string">"/C"</span>, command }; <span class="hljs-comment">// 命令</span>
        <span class="hljs-keyword">try</span> {
            Process process = Runtime.getRuntime().exec(cmd);
            ins = process.getInputStream(); <span class="hljs-comment">// 获取执行cmd命令后的信息</span>

            BufferedReader reader = <span class="hljs-keyword">new</span> BufferedReader(<span class="hljs-keyword">new</span> InputStreamReader(ins));
            String line = <span class="hljs-keyword">null</span>;
            <span class="hljs-keyword">while</span> ((line = reader.readLine()) != <span class="hljs-keyword">null</span>) {
                String msg = <span class="hljs-keyword">new</span> String(line.getBytes(<span class="hljs-string">"ISO-8859-1"</span>), <span class="hljs-string">"UTF-8"</span>);
                System.out.println(msg); <span class="hljs-comment">// 输出</span>
            }
            <span class="hljs-keyword">int</span> exitValue = process.waitFor();

            System.out.println(<span class="hljs-string">"Returned value was："</span> + exitValue);

            <span class="hljs-keyword">if</span>(exitValue == <span class="hljs-number">0</span>) {
                System.out.println(<span class="hljs-string">"The records were loaded successfully"</span>);
            }<span class="hljs-keyword">else</span> {
                System.out.println(<span class="hljs-string">"The records were not loaded successfully"</span>);
            }

            process.getOutputStream().close(); <span class="hljs-comment">// 关闭</span>
        } <span class="hljs-keyword">catch</span> (Exception e) {
            e.printStackTrace();
        }
    }

}</code></pre>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f:2f626c6f672e6373646e2e6e65742f75303132353537383134:2f61727469636c652f64657461696c732f3637363336353933" class_="artid" style="display:none">
 </p>
</div>


