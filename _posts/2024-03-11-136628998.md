---
layout: post
title: "利用python模拟人工操作鼠标键盘-python自动化"
date: 2024-03-11 17:24:10 +0800
description: "文章浏览阅读3.1k次，点赞11次，一个纯Python的GUI自动化工具，_python模拟人工操作"
keywords: "pyautogui,GUI自动化,鼠标控制"
categories: ['Python']
tags: ['自动化', 'Python']
artid: "136628998"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=136628998
    alt: "利用python模拟人工操作鼠标键盘-python自动化"
render_with_liquid: false
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     利用python模拟人工操作鼠标、键盘 python自动化
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <blockquote>
     <p>
      pyautogui是一个纯Python的GUI自动化工具，其目的是可以用程序自动控制鼠标和键盘操作
      <br/>
      提示：可以使用微信截图可以获取鼠标的坐标或颜色等信息
     </p>
    </blockquote>
    <h3>
     <a id="_2">
     </a>
    </h3>
    <h2>
     <a id="_3">
     </a>
     安装
    </h2>
    <ul>
     <li>
      <strong>
       普通安装
      </strong>
      ：
      <code>
       pip install pyautogui
      </code>
     </li>
     <li>
      <strong>
       国内镜像安装
      </strong>
      ：
      <code>
       pip install -i https://mirrors.aliyun.com/pypi/simple/ pyautogui
      </code>
      （推荐，安装更快）
     </li>
    </ul>
    <h2>
     <a id="_6">
     </a>
     导入
    </h2>
    <ul>
     <li>
      <code>
       import pyautogui as p
      </code>
     </li>
    </ul>
    <h2>
     <a id="_8">
     </a>
     获取参数
    </h2>
    <ul>
     <li>
      width,height = p.
      <strong>
       size
      </strong>
      ()：获取当前屏幕分辨率
     </li>
     <li>
      x,y = p.
      <strong>
       position
      </strong>
      ()：获取当前鼠标所在的位置
     </li>
    </ul>
    <h2>
     <a id="_11">
     </a>
     鼠标移动、拖动与滚动
    </h2>
    <ul>
     <li>
      p.
      <strong>
       moveTo
      </strong>
      (x, y)：移动鼠标到指定坐标,可指定移动的时间duration
     </li>
     <li>
      <ul>
       <li>
        举例：p.moveTo(width/2, height/2,duration=1)：1秒内移动到屏幕中央
       </li>
      </ul>
     </li>
     <li>
      p.
      <strong>
       moveRel
      </strong>
      (xOffset, xOffset, duration):鼠标相对移动
      <ul>
       <li>
        xOffset：相对x
       </li>
       <li>
        yOffset：相对y
       </li>
       <li>
        duration：移动时间，单位：秒
       </li>
      </ul>
     </li>
     <li>
      p.
      <strong>
       dragTo
      </strong>
      (x, y, duration=0.5)：将鼠标拖动到指定位置
     </li>
     <li>
      p.
      <strong>
       scroll
      </strong>
      (click):滚轮滚动，click代表滚动的距离，正数向上，负数向下
     </li>
    </ul>
    <h2>
     <a id="_20">
     </a>
     鼠标单击、双击与右击
    </h2>
    <ul>
     <li>
      p.
      <strong>
       click
      </strong>
      ()：单击当前鼠标所在的位置
      <ul>
       <li>
        x=None ：x坐标
       </li>
       <li>
        y=None ：y坐标
       </li>
       <li>
        clicks=1：单击次数
       </li>
       <li>
        interval=0.0 ：单击间隔时间
       </li>
       <li>
        button ：单击方式，‘left’, ‘middle’, ‘right’
       </li>
      </ul>
     </li>
     <li>
      p.
      <strong>
       doubleClick()
      </strong>
      ：双击，参数见单击
     </li>
     <li>
      p.
      <strong>
       leftClick
      </strong>
      ()、p.
      <strong>
       rightClick
      </strong>
      ()、p.
      <strong>
       middleClick
      </strong>
      ()：左击、右击、中击，参数见单击
     </li>
    </ul>
    <h2>
     <a id="_30">
     </a>
     键盘
    </h2>
    <ul>
     <li>
      p.
      <strong>
       typewrite
      </strong>
      (‘Hello World!’,interval=0.1)：每隔0.1秒输入一个字符
     </li>
     <li>
      <em>
       举例：p.typewrite(‘nihao1!’,interval=0.1)：配合输入法输入中文
      </em>
     </li>
     <li>
      p.
      <strong>
       press
      </strong>
      (‘enter’)：按键（按下+松开），esc、enter、a、1、F1等
     </li>
     <li>
      p.
      <strong>
       keyDown
      </strong>
      (key)：按下某键
     </li>
     <li>
      p.
      <strong>
       keyUp
      </strong>
      (key)：松开某键
     </li>
     <li>
      p.
      <strong>
       hotkey
      </strong>
      (‘win’, ‘e’)：按下组合键
     </li>
    </ul>
    <pre><code class="prism language-python"><span class="token keyword">import</span> pyautogui <span class="token keyword">as</span> p
<span class="token keyword">import</span> pyperclip
pyperclip<span class="token punctuation">.</span>copy<span class="token punctuation">(</span><span class="token string">"你是谁？"</span><span class="token punctuation">)</span> <span class="token comment"># 复制到剪切板</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>pyperclip<span class="token punctuation">.</span>paste<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 读取剪切板的内容</span>
p<span class="token punctuation">.</span>hotkey<span class="token punctuation">(</span><span class="token string">"ctrl"</span><span class="token punctuation">,</span><span class="token string">"v"</span><span class="token punctuation">)</span> <span class="token comment"># 输入中文</span>
</code></pre>
    <h2>
     <a id="_44">
     </a>
     消息框
    </h2>
    <ul>
     <li>
      p.
      <strong>
       alert
      </strong>
      (text, title)：消息提示框
      <ul>
       <li>
        text：输入提示或说明
       </li>
       <li>
        title：消息框标题
       </li>
      </ul>
     </li>
     <li>
      p.
      <strong>
       confirm
      </strong>
      (text, title,buttons)：按钮选择框，返回选择结果
      <ul>
       <li>
        buttons：选择框的选择，格式为列表，如[“是”,“否”,“不清楚”]
       </li>
      </ul>
     </li>
     <li>
      p.
      <strong>
       prompt
      </strong>
      (text,title)：文本输入框，返回输入内容
     </li>
     <li>
      p.
      <strong>
       password
      </strong>
      (text,title,mask)：密码输入框，返回输入内容
      <ul>
       <li>
        mask：密码显示内容
       </li>
      </ul>
     </li>
    </ul>
    <h2>
     <a id="_54">
     </a>
     屏幕截图
    </h2>
    <ul>
     <li>
      p.
      <strong>
       screenshot
      </strong>
      ( )：截取屏幕上的图像，并返回PIL图像对象
     </li>
    </ul>
    <pre><code class="prism language-python"><span class="token keyword">import</span> pyautogui <span class="token keyword">as</span> p
<span class="token comment"># 截取整个屏幕</span>
screenshot <span class="token operator">=</span> p<span class="token punctuation">.</span>screenshot<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># 显示截图</span>
screenshot<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
    <h2>
     <a id="_63">
     </a>
     查找图片
    </h2>
    <blockquote>
     <p>
      此功能还需要安装pillow库和opencv-python(用于指定精确度confidence)
     </p>
    </blockquote>
    <pre><code class="prism language-python">coords <span class="token operator">=</span> p<span class="token punctuation">.</span>locateOnScreen<span class="token punctuation">(</span><span class="token string">'folder.png'</span><span class="token punctuation">)</span> <span class="token comment">#在当前屏幕中查找指定图片(图片需要由系统截图功能截取的图)</span>
coords <span class="token operator">=</span> p<span class="token punctuation">.</span>locateOnScreen<span class="token punctuation">(</span><span class="token string">'folder.png'</span><span class="token punctuation">,</span>confidence<span class="token operator">=</span><span class="token number">0.9</span><span class="token punctuation">)</span> <span class="token comment"># 减低匹配精确度</span>
x<span class="token punctuation">,</span>y<span class="token operator">=</span>p<span class="token punctuation">.</span>center<span class="token punctuation">(</span>coords<span class="token punctuation">)</span> <span class="token comment">#获取定位到的图中间点坐标</span>
p<span class="token punctuation">.</span>click<span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span> <span class="token comment">#右击该坐标点</span>
</code></pre>
    <h2>
     <a id="_71">
     </a>
     举例：考生评语录入
    </h2>
    <pre><code class="prism language-python"><span class="token keyword">import</span> random
<span class="token keyword">import</span> pyautogui <span class="token keyword">as</span> p
<span class="token keyword">import</span> pyperclip
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'高三评语.txt'</span><span class="token punctuation">,</span><span class="token string">'r'</span><span class="token punctuation">,</span>encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token keyword">as</span> f<span class="token punctuation">:</span> <span class="token comment"># 打开文件</span>
    content<span class="token operator">=</span>f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 读取评语</span>
comment_list <span class="token operator">=</span> content<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span> <span class="token comment"># 分割评语</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"评语总条数：</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token builtin">len</span><span class="token punctuation">(</span>comment_list<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
p<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"start."</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">788</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    p<span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token number">649</span><span class="token punctuation">,</span><span class="token number">576</span><span class="token punctuation">)</span>    <span class="token comment">#单击文本框</span>
    comment <span class="token operator">=</span> random<span class="token punctuation">.</span>choice<span class="token punctuation">(</span>comment_list<span class="token punctuation">)</span>   <span class="token comment"># 随机选择一句评语</span>
    pyperclip<span class="token punctuation">.</span>copy<span class="token punctuation">(</span>comment<span class="token punctuation">)</span>    <span class="token comment"># 复制到剪贴板</span>
    p<span class="token punctuation">.</span>hotkey<span class="token punctuation">(</span><span class="token string">"ctrl"</span><span class="token punctuation">,</span><span class="token string">"a"</span><span class="token punctuation">)</span>    <span class="token comment"># 全选替换</span>
    p<span class="token punctuation">.</span>hotkey<span class="token punctuation">(</span><span class="token string">"ctrl"</span><span class="token punctuation">,</span><span class="token string">"v"</span><span class="token punctuation">)</span>    <span class="token comment"># 输入评语</span>
    p<span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token number">1047</span><span class="token punctuation">,</span><span class="token number">652</span><span class="token punctuation">)</span>   <span class="token comment"># 单击保存按钮，下一个</span>
    p<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.2</span><span class="token punctuation">)</span> <span class="token comment"># 等待0.2秒</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"已成功写入</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">}</span></span><span class="token string">行："</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"end....."</span> <span class="token punctuation">)</span>
</code></pre>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/8c94790a96e0352de41a12e9c468f828.png"/>
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f71715f34303931303738312f:61727469636c652f64657461696c732f313336363238393938" class_="artid" style="display:none">
 </p>
</div>


