---
layout: post
title: "Select2使用例子-下拉框带搜索"
date: 2023-11-06 14:33:02 +0800
description: "本文详细介绍了如何使用前端插件Select2来优化select元素，包括基本使用、设置提示语、隐藏搜"
keywords: "select2搜索框"
categories: ['Php', 'Javascript']
tags: ['Php']
artid: "120831020"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=120831020
    alt: "Select2使用例子-下拉框带搜索"
render_with_liquid: false
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     Select2使用例子 下拉框带搜索
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <p>
     参考：
     <a href="https://www.cnblogs.com/37Y37/p/11267968.html" rel="nofollow" title="https://www.cnblogs.com/37Y37/p/11267968.html">
      https://www.cnblogs.com/37Y37/p/11267968.html
     </a>
    </p>
    <p>
     本系列文章介绍我在运维系统开发过程中用到的那些顺手的前端插件，上一篇文章介绍了
     <a href="https://mp.weixin.qq.com/s/3Or2JK7_Wy9B0WqdUYDroA" rel="nofollow" title="bootstrap-duallistbox">
      bootstrap-duallistbox
     </a>
     这个插件的使用，这一篇开始Select2的征服之旅
    </p>
    <p>
     Select2是一款基于JQuery的下拉列表插件，主要用来优化select，支持单选和多选，同时也支持分组显示、列表检索、远程获取数据等众多好用的功能
    </p>
    <p>
     项目地址：
     <a href="https://select2.org/" rel="nofollow" title="Getting Started | Select2 - The jQuery replacement for select boxes">
      Getting Started | Select2 - The jQuery replacement for select boxes
     </a>
    </p>
    <h3 id="基本使用">
     基本使用
    </h3>
    <p>
     需要用到的JS和CSS文件位于项目代码下的dist目录中，需要将这个目录中的对应文件放入你的项目里，这一步不赘述
    </p>
    <ol>
     <li>
      引入CSS/JS文件，由于Select2是基于Jquery的，所以要先引入Jquery，这里我们都直接引入CDN的地址
     </li>
    </ol>
    <pre><code>&lt;!-- 加载 Jquery --&gt;
&lt;script src="https://code.jquery.com/jquery-3.2.1.min.js"&gt;&lt;/script&gt;

&lt;!-- 加载 Select2 --&gt;
&lt;link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.8/css/select2.min.css" rel="stylesheet" /&gt;
&lt;script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.8/js/select2.min.js"&gt;&lt;/script&gt;
</code></pre>
    <ol>
     <li>
      初始化Select2
     </li>
    </ol>
    <pre><code>&lt;select class="form-control" id="id_select2_demo1"&gt;
    &lt;option value=""&gt;-----单选-----&lt;/option&gt;
    &lt;option value="1"&gt;OPS-COFFEE-A&lt;/option&gt;
    &lt;option value="2"&gt;OPS-COFFEE-B&lt;/option&gt;
    &lt;option value="3"&gt;OPS-COFFEE-C&lt;/option&gt;
    &lt;option value="4"&gt;OPS-COFFEE-D&lt;/option&gt;
    &lt;option value="5"&gt;OPS-COFFEE-E&lt;/option&gt;
    &lt;option value="6"&gt;OPS-COFFEE-F&lt;/option&gt;
    &lt;option value="7"&gt;OPS-COFFEE-G&lt;/option&gt;
&lt;/select&gt;

&lt;script&gt;
    var selectorx = $('#id_select2_demo1').select2();
&lt;/script&gt;
</code></pre>
    <ol>
     <li>
      完成以上两步可以看到页面效果如下
     </li>
    </ol>
    <p style="text-align:center;">
     <img alt="" src="https://i-blog.csdnimg.cn/blog_migrate/98bc107c0b9404eb7456703ffaf5924e.png"/>
    </p>
    <h4 id="设置提示语placeholder">
     设置提示语placeholder
    </h4>
    <pre><code>$('#id_select2_demo1').select2({
    placeholder: '请选择'
});
</code></pre>
    <p>
     <strong>
      placeholder：
     </strong>
     选择框的提示语，需要注意，要想让这个提示语生效，需要select的option里边有一个value为空的option，例如上边例子中的
    </p>
    <pre><code>&lt;option value=""&gt;-----单选-----&lt;/option&gt;
</code></pre>
    <h4 id="隐藏搜索框">
     隐藏搜索框
    </h4>
    <p>
     与默认的select除了样式上的区别外，最重要的是多了个搜索框，能用来搜索option项，如果你不想显示这个搜索框，可以通过设置项
     <code>
      minimumResultsForSearch
     </code>
     隐藏
    </p>
    <pre><code>var selectorx = $('#id_select2_demo1').select2({
    minimumResultsForSearch: -1
});
</code></pre>
    <h4 id="加载本地数据">
     加载本地数据
    </h4>
    <p>
     除了实例化已经存在的select之外，也可以通过设置项
     <code>
      data
     </code>
     加载本地数据
    </p>
    <pre><code>var sdata = [
    {id: 1, text:'OPS-COFFEE-1'},
    {id: 2, text:'OPS-COFFEE-2'},
    {id: 3, text:'OPS-COFFEE-3'}
]

$('#id_select2_demo2').select2({
    data: sdata
});
</code></pre>
    <p>
     select2能够加载的数据格式如上，需要两个数据属性
     <code>
      id
     </code>
     和
     <code>
      text
     </code>
     ，当然你也可以加载其他的额外属性以在需要时获取
    </p>
    <h4 id="加载远程数据">
     加载远程数据
    </h4>
    <p>
     除了加载本地数据外，也支持ajax异步去后端获取数据，用法如下：
    </p>
    <pre><code>$('#id_select2_demo3').select2({
    placeholder: 'Ajax后端获取数据示例',
    ajax: {
      url: "sdata.json",
      dataType: 'json',
      delay: 250,
      data: function (params) {
        return {
          search: params.term,
        };
      },
      processResults: function (data) {
        return {
          results: data
        };
      },
      cache: true
    },
    minimumInputLength: 2
});
</code></pre>
    <p>
     <strong>
      delay: 250：
     </strong>
     配置告诉select2在用户停止输入多少毫秒后开始查询，合理设置可以避免频繁向后端发送请求
    </p>
    <p>
     <strong>
      search: params.term：
     </strong>
     定义了要传递给后端的查询参数，
     <code>
      search
     </code>
     为发送到服务端的参数名，
     <code>
      params.term
     </code>
     表示输入框中输入的内容，当然这里也可以添加一些自定义的参数，例如：
    </p>
    <pre><code>data: function (params) {
    return {
      search: params.term,
      site: "https://ops-coffee.cn"
    };
},
</code></pre>
    <p>
     那么当你输入
     <code>
      OPS
     </code>
     时，服务端接受到的完整参数就是
     <code>
      /sdata.json?search=OPS&amp;site=https://ops-coffee.cn
     </code>
    </p>
    <p>
     <strong>
      results: data：
     </strong>
     定义了后台返回的数据，其中
     <code>
      data
     </code>
     为select2能够识别的格式，如果后端返回的格式不是select2能够识别的格式，例如下边这样
    </p>
    <pre><code>{
    "state": 1, 
    "message":[
        {"id": 0, "text":"-----单选-----"},
        {"id": 1, "text":"OPS-COFFEE-1"},
        {"id": 2, "text":"OPS-COFFEE-2"},
        {"id": 3, "text":"OPS-COFFEE-3"}
    ]
}
</code></pre>
    <p>
     那么你需要先将其处理成select2能够识别的格式，这里我们就需要取出date中的message
    </p>
    <pre><code>processResults: function (data) {
    return {
      results: data.message
    };
},
</code></pre>
    <p>
     <strong>
      minimumInputLength：
     </strong>
     ajax异步请求通常我们会配合配置项
     <code>
      minimumInputLength
     </code>
     使用，这个配置项的意思是输入指定长度的字符后开始搜索，也就是点击select选择框默认不会去后台请求数据，当你输入指定长度的字符时才会去搜索，这样在你搜索项非常多的时候能更精确的匹配你想要的内容
    </p>
    <p>
     如果你想点击即显示所有option，那么你可以将他的值设置为
     <code>
      0
     </code>
     ，或者不配置这个配置
    </p>
    <p>
     同时也可以通过
     <code>
      maximumInputLength
     </code>
     配置项配置输入字符的最大长度
    </p>
    <h4 id="多选支持">
     多选支持
    </h4>
    <p>
     select2对多选的支持也非常简单，跟默认的select标签一样只需要在select标签中添加
     <code>
      multiple="multiple"
     </code>
     即可
    </p>
    <pre><code>&lt;select class="form-control" id="id_select2_demo4" multiple="multiple"&gt;
    &lt;option value="1"&gt;OPS-COFFEE-A&lt;/option&gt;
    &lt;option value="3"&gt;OPS-COFFEE-C&lt;/option&gt;
    &lt;option value="4"&gt;OPS-COFFEE-D&lt;/option&gt;
    &lt;option value="5"&gt;OPS-COFFEE-E&lt;/option&gt;
&lt;/select&gt;

var selectory = $('#id_select2_demo4').select2({
    placeholder: '请选择，最多选择三个',
    allowClear: true,
    maximumSelectionLength:3,
});
</code></pre>
    <p>
     显示效果如下：
    </p>
    <p style="text-align:center;">
     <img alt="" src="https://i-blog.csdnimg.cn/blog_migrate/03722d9a1d731dd75022de30b4eb1d1f.png"/>
    </p>
    <p>
     <strong>
      allowClear：
     </strong>
     是否显示清楚按钮，默认false，如果设置为
     <code>
      true
     </code>
     ，需要同时配置
     <code>
      placeholder
     </code>
     ，否则可能会引起js报错：
    </p>
    <pre><code>TypeError: Cannot read property 'id' of undefined
</code></pre>
    <p>
     <strong>
      maximumSelectionLength：
     </strong>
     配置最多能选择多少项
    </p>
    <h3 id="配置说明">
     配置说明
    </h3>
    <p>
     另外还有几个配置上边没有讲到的：
    </p>
    <p>
     <strong>
      width：
     </strong>
     宽度，例如
     <code>
      100%
     </code>
    </p>
    <p>
     <strong>
      multiple：
     </strong>
     是否支持多选，默认false
    </p>
    <p>
     <strong>
      closeOnSelect：
     </strong>
     是否选中后关闭选择框，默认true
    </p>
    <p>
     <strong>
      tags：
     </strong>
     是否可以动态创建选项
    </p>
    <p>
     <strong>
      disabled：
     </strong>
     是否禁用
    </p>
    <p>
     <strong>
      debug：
     </strong>
     是否开启debug模式
    </p>
    <h3 id="使用进阶">
     使用进阶
    </h3>
    <p>
     获取已选择的值，无论是单选还是多选都可以用下边的代码来获取选择的option
    </p>
    <pre><code>$('#id_select2_demo4').select2('val')
</code></pre>
    <p>
     获取已选择的对象
    </p>
    <pre><code>$("#id_select2_demo4").select2("data")
</code></pre>
    <p>
     如果想要拿到已选择option的text值，可以通过如下方法，以下代码中的
     <code>
      [0]
     </code>
     用来获取第一个对象，对单选合适，如果是多选的话需要循环获取
    </p>
    <pre><code>$("#id_select2_demo4").select2("data")[0].text
</code></pre>
    <p>
     selected，初始化值，设置选中项
    </p>
    <pre><code># 单选情况下val为数字，这里的selectx为
$("#id_select2_demo1").val(2).trigger("change");

# 多选情况下val为列表
$("#id_select2_demo4").val([2,3,5]).trigger("change");
</code></pre>
    <p>
     清空已选择的值，无论是单选还是多选都可以这样清除
    </p>
    <pre><code>$("#id_select2_demo1").val(null).trigger('change');
$("#id_select2_demo4").val(null).trigger('change');
</code></pre>
    <p>
     禁用select2
    </p>
    <pre><code>$("#id_select2_demo1").prop('disabled',true);;
$("#id_select2_demo4").prop('disabled',true);;
</code></pre>
    <p>
     动态添加select的option
    </p>
    <pre><code>$('#add').click(function() {
    var _html = '&lt;option value="9" selected&gt;ops-coffee.cn&lt;/option&gt;';
    $('#id_select2_demo1').append(_html).trigger('change.select2');
    $('#id_select2_demo1').select2("open");
})
</code></pre>
    <p>
     <strong>
      change.select2：
     </strong>
     新增select数据后触发select2更新
    </p>
    <p>
     <strong>
      .select2("open")：
     </strong>
     打开select，
     <code>
      open
     </code>
     改为
     <code>
      close
     </code>
     可动态关闭select，改为
     <code>
      destroy
     </code>
     可销毁select2，恢复select默认样式
    </p>
    <h3 id="完整demo">
     完整Demo
    </h3>
    <p>
     为了方便大家学习，我写了个完整的demo，你可以在线查看效果或下载代码应用到自己的项目中
    </p>
    <p>
     在线Demo地址：
     <a href="https://demo.ops-coffee.cn/select2/" rel="nofollow" title="运维咖啡吧 | ops-coffee.cn">
      运维咖啡吧 | ops-coffee.cn
     </a>
    </p>
    <p>
     Github源码地址：
     <a href="https://github.com/ops-coffee/demo/tree/master/select2" title="demo/select2 at master · ops-coffee/demo · GitHub">
      demo/select2 at master · ops-coffee/demo · GitHub
     </a>
    </p>
    <p>
    </p>
   </div>
  </div>
 </article>
 <p alt="68747470733a:2f2f626c6f672e6373646e2e6e65742f7963735f303430352f:61727469636c652f64657461696c732f313230383331303230" class_="artid" style="display:none">
 </p>
</div>


