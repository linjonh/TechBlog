---
layout: post
title: "测试php连接mysql的实例实现"
date: 2025-01-16 07:38:49 +0800
description: "1.在linux上搭建好lnmp架构后，先测试一下php是否可以连接上mysql.测试代码：test"
keywords: "测试mysql和php是否协同工作"
categories: ['未分类']
tags: ['无标签']
artid: "80583534"
image:
  path: https://api.vvhan.com/api/bing?rand=sj&artid=80583534
  alt: "测试php连接mysql的实例实现"
render_with_liquid: false
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     测试php连接mysql的实例实现
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <p>
     1.在linux上搭建好lnmp架构后，先测试一下php是否可以连接上mysql.
    </p>
    <p>
     测试代码：test.php
    </p>
    <p>
     &lt;?php
     <br/>
     $link=mysql_connect("172.25.90.14","root","redhat");
     <br/>
     if(!$link) echo "FAILD!连接错误，用户名密码不对";
     <br/>
     else echo "OK!可以连接";
     <br/>
    </p>
    <p>
     ?&gt;
     <br/>
    </p>
    <p>
     2.接下来利用php就可以对mysql进行增删改查了
    </p>
    <h6>
     <strong>
      <span style="color:#6600CC;">
       a.  config.php
       <span style="font-family:'FangSong_GB2312';font-size:16px;">
        首先可创建一个保存常量的config.php
       </span>
       <br/>
      </span>
     </strong>
    </h6>
    <p>
     &lt;?php
     <br/>
     define('MYSQL_HOST','172.25.90.14');
     <br/>
    </p>
    <p>
     define('MYSQL_USER','root');
     <br/>
    </p>
    <p>
     define('MYSQL_PW','redhat');
    </p>
    <p>
     <span style="color:#6600CC;">
      <strong>
       b.  functions.php
       <span style="font-family:'FangSong_GB2312';font-size:16px;">
        再创建一个保存函数的文件functions.php:
       </span>
       <br/>
      </strong>
     </span>
    </p>
    <p>
     &lt;?php
     <br/>
     require_once 'config.php';
     <br/>
     function connnetDb(){
     <br/>
     //连接mysql数据库
     <br/>
     $conn=mysql_connect(MYSQL_HOST,MYSQL_USER,MYSQL_PW);
     <br/>
     //排除连接数据库异常错误
     <br/>
     if(!$conn){
     <br/>
     die('can not connect db');
     <br/>
     }
     <br/>
     //在mysql中选中myapp数据库
     <br/>
     mysql_select_db("wzw");
     <br/>
     return $conn;
     <br/>
    </p>
    <p>
     }
    </p>
    <p>
     <span style="color:#6600CC;">
      <strong>
       c.  allusers.php
       <span style="font-family:SimHei;font-size:16px;">
        查询数据库
       </span>
       <br/>
      </strong>
     </span>
    </p>
    <p>
     &lt;?php
     <br/>
     require_once 'functions.php';
     <br/>
     ?&gt;
     <br/>
     &lt;!DOCTYPE html&gt;
     <br/>
     &lt;html&gt;
     <br/>
     &lt;head&gt;
     <br/>
     &lt;meta charset="UTF-8"&gt;
     <br/>
     &lt;title&gt;所有用户&lt;/title&gt;
     <br/>
     &lt;style&gt;
     <br/>
     table{
     <br/>
     border-collapse: collapse;
     <br/>
     }
     <br/>
     th,td{
     <br/>
     border:1px solid #ccccff;
     <br/>
     padding: 5px;
     <br/>
     }
     <br/>
     td{
     <br/>
     text-align: center;
     <br/>
     }
     <br/>
     &lt;/style&gt;
     <br/>
     &lt;/head&gt;
     <br/>
     &lt;body&gt;
     <br/>
     &lt;a href="adduser.html"&gt;添加用户&lt;/a&gt;
     <br/>
     &lt;table&gt;
     <br/>
     &lt;tr&gt;&lt;th&gt;id&lt;/th&gt;&lt;th&gt;名字&lt;/th&gt;&lt;th&gt;年龄&lt;/th&gt;&lt;th&gt;修改/删除&lt;/th&gt;&lt;/tr&gt;
     <br/>
     &lt;?php
     <br/>
     //连接数据库
     <br/>
     connnetDb();
     <br/>
     //查询数据表中的所有数据,并按照id降序排列
     <br/>
     $result=mysql_query("SELECT * FROM users ORDER BY id DESC");
     <br/>
     //获取数据表的数据条数
     <br/>
     $dataCount=mysql_num_rows($result);
     <br/>
     //echo $dataCount;
     <br/>
     //打印输出所有数据
     <br/>
     <br/>
     <br/>
     for($i=0;$i&lt;$dataCount;$i++){
     <br/>
     $result_arr=mysql_fetch_assoc($result);
     <br/>
     $id=$result_arr['id'];
     <br/>
     $name=$result_arr['name'];
     <br/>
     $age=$result_arr['age'];
     <br/>
     //print_r($result_arr);
     <br/>
     echo "&lt;tr&gt;&lt;td&gt;$id&lt;/td&gt;&lt;td&gt;$name&lt;/td&gt;&lt;td&gt;$age&lt;/td&gt;&lt;td&gt;&lt;a href='edituser.php?id=$id'&gt;修改&lt;/a&gt; &lt;a href='deleteuser.php?id=$id'&gt;删除&lt;/a&gt;&lt;/td&gt;&lt;/tr&gt;";
     <br/>
     }
     <br/>
     ?&gt;
     <br/>
     &lt;/table&gt;
     <br/>
     &lt;/body&gt;
     <br/>
    </p>
    <p>
     &lt;/html&gt;
    </p>
    <p>
     <span style="color:#6600CC;">
      <strong>
       d.  adduser.html
       <span style="font-family:'FangSong_GB2312';font-size:16px;">
        新建adduser.html页面，提供用户输入表单
       </span>
       <br/>
      </strong>
     </span>
    </p>
    <p>
     &lt;!DOCTYPE html&gt;
     <br/>
     &lt;html&gt;
     <br/>
     &lt;head lang="en"&gt;
     <br/>
     &lt;meta charset="UTF-8"&gt;
     <br/>
     &lt;title&gt;添加用户&lt;/title&gt;
     <br/>
     &lt;/head&gt;
     <br/>
     &lt;body&gt;
     <br/>
     &lt;form action="adduser.php" method="post"&gt;
     <br/>
     &lt;label&gt;用户ID：&lt;/label&gt;&lt;input type="text" name="id"&gt;
     <br/>
     &lt;label&gt;用户名：&lt;/label&gt;&lt;input type="text" name="name"&gt;
     <br/>
     &lt;label&gt;年龄：&lt;/label&gt;&lt;input type="text" name="age"&gt;
     <br/>
     &lt;input type="submit" value="提交"&gt;
     <br/>
     &lt;/form&gt;
     <br/>
     &lt;/body&gt;
     <br/>
    </p>
    <p>
     &lt;/html&gt;
    </p>
    <p>
     <span style="color:#6600CC;">
      <strong>
       e.  adduser.php
       <span style="font-family:'FangSong_GB2312';font-size:16px;">
        创建处理用户表单数据的服务端文件adduser.php，并将添加的数据返回到列表页面
       </span>
       <br/>
      </strong>
     </span>
    </p>
    <p>
     &lt;?php
     <br/>
     require_once 'functions.php';
     <br/>
     //首先进行非空排错
     <br/>
     if(!isset($_POST['id'])){
     <!-- -->
     <br/>
     die('id is not define');
     <br/>
     }
     <br/>
     if(!isset($_POST['name'])){
     <br/>
     die('name is not define');
     <br/>
     }
     <br/>
     if(!isset($_POST['age'])){
     <br/>
     die('age is not define');
     <br/>
     }
     <br/>
     $id=$_POST['id'];
     <br/>
     $name=$_POST['name'];
     <br/>
     $age=$_POST['age'];
     <br/>
     if(empty($id)){
     <!-- -->
     <br/>
     die('id is empty');
     <br/>
     }
     <br/>
     if(empty($name)){
     <br/>
     die('name is empty');
     <br/>
     }
     <br/>
     if(empty($age)){
     <br/>
     die('age is empty');
     <br/>
     }
     <br/>
     //连接数据库
     <br/>
     connnetDb();
     <br/>
     <br/>
     <br/>
     //执行类型转换，防止SQL注入
     <br/>
     $age=intval($age);
     <br/>
     //插入数据
     <br/>
     mysql_query("INSERT INTO users(id,name,age) VALUES ('$id','$name','$age')");
     <br/>
     //返回列表页面
     <br/>
     if(mysql_error()){
     <br/>
     echo mysql_error();
     <br/>
     }else{
     <br/>
     header("Location:allusers.php");
     <br/>
    </p>
    <p>
     }
    </p>
    <p>
     <span style="color:#6600CC;">
      <strong>
       f.  edituser.php
      </strong>
     </span>
     <span style="font-family:'FangSong_GB2312';font-size:16px;color:#6600CC;">
      创建edituser.php，获取需要修改的数据并呈现成表单，供用户修改数据
     </span>
     <br/>
    </p>
    <p>
     &lt;?php
     <br/>
     require_once 'functions.php';?&gt;
     <br/>
     &lt;!DOCTYPE html&gt;
     <br/>
     &lt;html&gt;
     <br/>
     &lt;head&gt;
     <br/>
     &lt;meta charset="UTF-8"&gt;
     <br/>
     &lt;title&gt;修改用户数据&lt;/title&gt;
     <br/>
     &lt;/head&gt;
     <br/>
     &lt;body&gt;
     <br/>
     &lt;?php
     <br/>
     if(!empty($_GET['id'])){
     <br/>
     //连接mysql数据库
     <br/>
     connnetDb();
     <br/>
     <br/>
     <br/>
     //查找id
     <br/>
     $id=intval($_GET['id']);
     <br/>
     $result=mysql_query("SELECT * FROM users WHERE id=$id");
     <br/>
     if(mysql_error()){
     <br/>
     die('can not connect db');
     <br/>
     }
     <br/>
     //获取结果数组
     <br/>
     $result_arr=mysql_fetch_assoc($result);
     <br/>
     }else{
     <br/>
     die('id not define');
     <br/>
     }
     <br/>
     ?&gt;
     <br/>
     &lt;form action="edituser_server.php" method="post"&gt;
     <br/>
     &lt;label&gt;用户ID：&lt;/label&gt;&lt;input type="text" name="id" value="&lt;?php echo $result_arr['id']?&gt;"&gt;
     <br/>
     &lt;label&gt;用户名：&lt;/label&gt;&lt;input type="text" name="name" value="&lt;?php echo $result_arr['name']?&gt;"&gt;
     <br/>
     &lt;label&gt;用户年龄：&lt;/label&gt;&lt;input type="text" name="age" value="&lt;?php echo $result_arr['age']?&gt;"&gt;
     <br/>
     &lt;input type="submit" value="提交修改"&gt;
     <br/>
     &lt;/form&gt;
     <br/>
     &lt;/body&gt;
     <br/>
    </p>
    <p>
     &lt;/html&gt;
    </p>
    <p>
     <span style="color:#6600CC;">
      <strong>
       g.  edituser_server.php
       <span style="font-family:'FangSong_GB2312';font-size:16px;">
        提交给服务端edituser_server.php处理：
       </span>
       <br/>
      </strong>
     </span>
    </p>
    <p>
     &lt;?php
     <br/>
     require_once 'functions.php';
     <br/>
     if(empty($_POST['id'])){
     <br/>
     die('id is empty');
     <br/>
     }
     <br/>
     if(empty($_POST['name'])){
     <br/>
     die('name is empty');
     <br/>
     }
     <br/>
     if(empty($_POST['age'])){
     <br/>
     die('age is empty');
     <br/>
     }
     <br/>
     <br/>
     <br/>
     $id=intval($_POST['id']);
     <br/>
     $name=$_POST['name'];
     <br/>
     $age=intval($_POST['age']);
     <br/>
     <br/>
     <br/>
     //连接数据库
     <br/>
     connnetDb();
     <br/>
     <br/>
     <br/>
     //修改指定数据
     <br/>
     mysql_query("UPDATE users SET name='$name',age=$age WHERE id=$id");
     <br/>
     <br/>
     <br/>
     //排错并返回
     <br/>
     if(mysql_error()){
     <br/>
     echo mysql_error();
     <br/>
     }else{
     <br/>
     header("Location:allusers.php");
     <br/>
    </p>
    <p>
     }
    </p>
    <p>
     <span style="color:#6600CC;">
      <strong>
       h.  deleteuser.php
       <span style="font-size:16px;">
        <span style="line-height:26px;">
         <span style="font-family:'FangSong_GB2312';">
          执行删除操作后返回主页面
         </span>
        </span>
       </span>
       <br/>
      </strong>
     </span>
    </p>
    <p>
     &lt;?php
     <br/>
     require_once 'functions.php';
     <br/>
     <br/>
     //排空错误
     <br/>
     if(empty($_GET['id'])){
     <br/>
     die('id is empty');
     <br/>
     }
     <br/>
     //连接数据库
     <br/>
     connnetDb();
     <br/>
     <br/>
     $id=intval($_GET['id']);
     <br/>
     <br/>
     //删除指定数据
     <br/>
     mysql_query("DELETE FROM users WHERE id=$id");
     <br/>
     //排错并返回页面
     <br/>
     if(mysql_error()){
     <br/>
     echo mysql_error();
     <br/>
     }else{
     <br/>
     header("Location:allusers.php");
     <br/>
    </p>
    <p>
     }
    </p>
    <p>
     <br/>
    </p>
    <p>
     <br/>
    </p>
    <p>
     <br/>
    </p>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f67:2e6373646e2e6e65742f77656978696e5f3430353535363730:2f61727469636c652f64657461696c732f3830353833353334" class_="artid" style="display:none">
 </p>
</div>
