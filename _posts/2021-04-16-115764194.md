---
layout: post
title: "DM达梦数据库license授权替换方法"
date: 2021-04-16 16:04:26 +0800
description: "本文档详细介绍了如何在达梦数据库中进行license替换，包括修改授权名称、权限，以及通过重启服务或"
keywords: "达梦数据库license价格"
categories: ['数据库']
tags: ['数据库', 'Sql', 'Data', 'Big']
artid: "115764194"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=115764194
    alt: "DM达梦数据库license授权替换方法"
render_with_liquid: false
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     DM达梦数据库:license授权替换方法
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-light" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
    </p>
    <div class="toc">
     <h4>
      达梦数据库license替换，许可证替换
     </h4>
     <ul>
      <li>
       <a href="#_1" rel="nofollow">
        环境介绍
       </a>
      </li>
      <li>
       <a href="#1__3" rel="nofollow">
        1 修改授权名称
       </a>
      </li>
      <li>
       <a href="#2_dm82__14" rel="nofollow">
        2 修改授权权限（dm8.2 专用机不需要）
       </a>
      </li>
      <li>
       <a href="#3__22" rel="nofollow">
        3 使授权生效
       </a>
      </li>
      <li>
       <ul>
        <li>
         <a href="#31__24" rel="nofollow">
          3.1 重启数据库服务
         </a>
        </li>
        <li>
         <a href="#32_SQL_41" rel="nofollow">
          3.2 执行SQL函数，不用重启数据库服务
         </a>
        </li>
       </ul>
      </li>
      <li>
       <a href="#4_DM8_VLICENSE_73" rel="nofollow">
        4 DM8 V$LICENSE介绍：
       </a>
      </li>
      <li>
       <a href="#5_DM7_VLICENSE_77" rel="nofollow">
        5 DM7 V$LICENSE介绍：
       </a>
      </li>
      <li>
       <a href="#6_DM8_80" rel="nofollow">
        6 DM8:达梦数据库替换授权遇到的错误
       </a>
      </li>
     </ul>
    </div>
    <p>
    </p>
    <h2>
     <a id="_1">
     </a>
     环境介绍
    </h2>
    <p>
     试用版环境，授权许可 dm.key 到期后，需要替换新的dm.key,
    </p>
    <h2>
     <a id="1__3">
     </a>
     1 修改授权名称
    </h2>
    <ul>
     <li>
      <strong>
       若授权的名称是dmA123456.key，
       <br/>
       dm------.key 则需要重命名为dm.key
      </strong>
     </li>
     <li>
      <strong>
       将新的 dm.key文件放到达梦数据库程序安装目录的bin 内
      </strong>
     </li>
     <li>
      （dm8.2 专用机需要放到 数据库安装目录 bin/bin 内）
     </li>
     <li>
      查询数据库 bin 执行目录
     </li>
    </ul>
    <pre><code class="prism language-powershell">$ <span class="token function">ps</span> <span class="token operator">-</span>ef<span class="token punctuation">|</span>grep dmserver 			<span class="token operator">--</span>查看数据库bin 执行目录
</code></pre>
    <h2>
     <a id="2_dm82__14">
     </a>
     2 修改授权权限（dm8.2 专用机不需要）
    </h2>
    <ul>
     <li>
      （
      <strong>
       注意权限
      </strong>
      ，用root上传后，文件默认是属 root 用户 组 ）
      <br/>
      修改权限命令（在dm.key 当前目录执行）
     </li>
    </ul>
    <pre><code class="prism language-powershell">chown dmdba:dinstall dm<span class="token punctuation">.</span>key
</code></pre>
    <h2>
     <a id="3__22">
     </a>
     3 使授权生效
    </h2>
    <ul>
     <li>
      替换方法 有2种：
     </li>
    </ul>
    <h3>
     <a id="31__24">
     </a>
     3.1 重启数据库服务
    </h3>
    <ul>
     <li>
      **重启数据库实例服务！完成dm.key替换，
      <br/>
      <strong>
       若授权与数据库服务器环境 或 数据库版本 不匹配 ，数据库服务将无法启动
      </strong>
     </li>
    </ul>
    <pre><code class="prism language-shell">$ <span class="token function">ps</span> -ef<span class="token operator">|</span><span class="token function">grep</span> dmserver 			--查看数据库bin 执行目录
$ 
$ <span class="token builtin class-name">cd</span> /home/dmdba/dmdbms/bin/  	--进入 bin执行目录
$ <span class="token function">ls</span> -l dm.key  				--是 -l 不是数字 -1
-rw-------. <span class="token number">1</span> dmdba dinstall <span class="token number">648</span> <span class="token number">11</span>月 <span class="token number">19</span> 01:49 dm.key

$ ./DmS  tab补全 stop   			--关闭数据库服务
$ ./DmS  tab补全 start   		--启动数据库服务

$ ./disql 用户名/密码@IP:port  	-- 或
$ ./disql 用户名/密码			--成功登录数据库后查询效验授权
SQL<span class="token operator">&gt;</span> SELECT * FROM V<span class="token variable">$LICENSE</span><span class="token punctuation">;</span>
</code></pre>
    <h3>
     <a id="32_SQL_41">
     </a>
     3.2 执行SQL函数，不用重启数据库服务
    </h3>
    <ul>
     <li>
      <p>
       <strong>
        若授权与数据库服务器环境 或 数据库版本 不匹配 则数据库宕机
       </strong>
      </p>
     </li>
     <li>
      <p>
       <strong>
        不用重启数据库服务，维护集群更方便
       </strong>
       <br/>
       在达梦的manager管理工具，或者disql执行此语句，即可更新dm.key 信息
      </p>
     </li>
    </ul>
    <pre><code class="prism language-sql">SP_LOAD_LIC_INFO<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">COMMIT</span><span class="token punctuation">;</span>
</code></pre>
    <ul>
     <li>
      <strong>
       执行完成后，执行此语句可效验dm.key是否生效
      </strong>
     </li>
    </ul>
    <pre><code class="prism language-sql"><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> V$LICENSE<span class="token punctuation">;</span>
</code></pre>
    <pre><code class="prism language-xml">引用于：DM8_SQL语言使用手册 &gt;&gt;&gt;附录 3 系统存储过程和函数
SP_LOAD_LIC_INFO()
定义：
VOID
SP_LOAD_LIC_INFO()
功能说明：
进行 DM 服务器的 LICENSE 校验，检查 LICENSE 与当前 DM 版本及系统运行
环境是否一致，如果有不一致则 DM 服务器主动退出。
参数说明：
无
返回值：
无
举例说明：
SP_LOAD_LIC_INFO();
</code></pre>
    <h2>
     <a id="4_DM8_VLICENSE_73">
     </a>
     4 DM8 V$LICENSE介绍：
    </h2>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/8e19f8b16f9c35093de9777b776f69c7.png#pic_center">
      <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/b22638158117a4ed52affcc148ce8519.png#pic_center"/>
     </img>
    </p>
    <h2>
     <a id="5_DM7_VLICENSE_77">
     </a>
     5 DM7 V$LICENSE介绍：
    </h2>
    <p>
     <img alt="V$LICENSE" src="https://i-blog.csdnimg.cn/blog_migrate/16b1d5ff958ef0c47ada5bfff8e5cdbb.png#pic_center"/>
    </p>
    <h2>
     <a id="6_DM8_80">
     </a>
     6 DM8:达梦数据库替换授权遇到的错误
    </h2>
    <ul>
     <li>
      <a href="https://blog.csdn.net/qq_37358909/article/details/129729371?spm=1001.2014.3001.5502">
       点我跳转
      </a>
     </li>
    </ul>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f71715f33373335383930392f:61727469636c652f64657461696c732f313135373634313934" class_="artid" style="display:none">
 </p>
</div>


