---
layout: post
title: "vue3-不同环境开发测试生产打包配置"
date: 2024-12-18 23:50:51 +0800
description: "Vue3不同环境（开发、测试、生产）打包配置需求实现原理配置步骤创建3个.env文件配置脚本代码调用"
keywords: "vue3 多个 envv"
categories: ['Web']
tags: ['不同环境打包', 'Vue']
artid: "102910758"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=102910758
    alt: "vue3-不同环境开发测试生产打包配置"
render_with_liquid: false
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     vue3 不同环境(开发、测试、生产)打包配置
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
    </p>
    <div class="toc">
     <h4>
      Vue3不同环境（开发、测试、生产）打包配置
     </h4>
     <ul>
      <li>
       <ul>
        <li>
         <a href="#_2" rel="nofollow">
          需求
         </a>
        </li>
        <li>
         <a href="#_6" rel="nofollow">
          实现原理
         </a>
        </li>
        <li>
         <a href="#_10" rel="nofollow">
          配置步骤
         </a>
        </li>
        <li>
         <ul>
          <li>
           <a href="#3env_12" rel="nofollow">
            创建3个.env文件
           </a>
          </li>
          <li>
           <a href="#_41" rel="nofollow">
            配置脚本
           </a>
          </li>
          <li>
           <a href="#_48" rel="nofollow">
            代码调用
           </a>
          </li>
         </ul>
        </li>
        <li>
         <a href="#_52" rel="nofollow">
          执行脚本
         </a>
        </li>
        <li>
         <a href="#_57" rel="nofollow">
          其他
         </a>
        </li>
        <li>
         <a href="#_62" rel="nofollow">
          参考资料：
         </a>
        </li>
       </ul>
      </li>
     </ul>
    </div>
    <p>
    </p>
    <h3>
     <a id="_2">
     </a>
     需求
    </h3>
    <p>
     在Vue3.X中，执行package.json Script 脚本命令，在项目中配置不同(本地、测试、生产)环境的
     <strong>
      API URL
     </strong>
    </p>
    <h3>
     <a id="_6">
     </a>
     实现原理
    </h3>
    <p>
     创建.env文件，在env文件中添加URL 常量，配置打包命令对应的env文件，获取不同env文件中定义URL常量值。
    </p>
    <h3>
     <a id="_10">
     </a>
     配置步骤
    </h3>
    <h4>
     <a id="3env_12">
     </a>
     创建3个.env文件
    </h4>
    <p>
     每个文件中添加
     <mark>
      VUE_APP_URL
     </mark>
     和
     <mark>
      VUE_APP_FLAG
     </mark>
     常量
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/58e02f667d042335607be1d73aa24b56.png">
      <br/>
      常量定义规范：VUE_APP_[自定义name]
     </img>
    </p>
    <ul>
     <li>
      <strong>
       文件名：.env
      </strong>
      【打包生产环境】
     </li>
    </ul>
    <pre><code>VUE_APP_URL=https://xxx.xxx.com
VUE_APP_FLAG = 'prod'
</code></pre>
    <ul>
     <li>
      <strong>
       文件名：.env.test
      </strong>
      【打包测试环境】
     </li>
    </ul>
    <p>
     文件中需要额外增加一个
     <code>
      NODE_ENV = 'production'
     </code>
     的参数，否则在package.json中执行测试脚本命令时，不会将js和css文件打包至dist。
    </p>
    <pre><code>NODE_ENV = 'production'
VUE_APP_URL=http://xxx.xx.xx.xxx:8085/wxpublic
VUE_APP_FLAG = 'test'
</code></pre>
    <ul>
     <li>
      <strong>
       文件名：.env.development
      </strong>
      【打包本地开发环境】
     </li>
    </ul>
    <pre><code>VUE_APP_URL=http://localhost:8088/wxpublic
VUE_APP_FLAG = 'dev'
</code></pre>
    <h4>
     <a id="_41">
     </a>
     配置脚本
    </h4>
    <p>
     在package.json中，在scripts对象中增加testbuild脚本，其中–mode
     <code>
      test
     </code>
     命令对应文件名env.
     <code>
      test
     </code>
     <br/>
     代码如下：
    </p>
    <pre><code>"testbuild": "vue-cli-service build --mode test"
</code></pre>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/707fc2f87268dbe84a8fb77eb8b0bacb.png"/>
    </p>
    <h4>
     <a id="_48">
     </a>
     代码调用
    </h4>
    <p>
     在网络请求或axios中，访问
     <code>
      process.env.VUE_APP_URL
     </code>
     得到API BaseURL
    </p>
    <h3>
     <a id="_52">
     </a>
     执行脚本
    </h3>
    <p>
     右键
     <strong>
      package.json
     </strong>
     文件，点击
     <mark>
      show npm Scripts
     </mark>
     菜单，双击命令打包不同环境文件。
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/1f62001831dd21bb036436f647bc7450.png"/>
    </p>
    <h3>
     <a id="_57">
     </a>
     其他
    </h3>
    <p>
     1、本机环境：@vue-cli3.12.1
     <br/>
     2、IDE：WebStorm2018.3.2
    </p>
    <h3>
     <a id="_62">
     </a>
     参考资料：
    </h3>
    <p>
     🔗
     <br/>
     [1]: https://cli.vuejs.org/zh/config/#publicpath
     <br/>
     [2]: https://blog.csdn.net/qq_36407748/article/details/82050976
     <br/>
     [2]: https://blog.csdn.net/qq_37055675/article/details/85047451
     <br/>
     [3]: https://www.jianshu.com/p/9b6ccd14d184
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f6c697562696e77797a62742f:61727469636c652f64657461696c732f313032393130373538" class_="artid" style="display:none">
 </p>
</div>


