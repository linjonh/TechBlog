---
layout: post
title: "Vue使用WebSocket实现实时获取后端推送的数据"
date: 2024-09-21 15:31:50 +0800
description: "上面的代码中，使用WebSocket连接到后端WebSocket服务器，通过监听onmessage事"
keywords: "前端实时接收后端数据"
categories: ['']
tags: ['前端', 'Websocket', 'Vue']
artid: "142417889"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=142417889
    alt: "Vue使用WebSocket实现实时获取后端推送的数据"
render_with_liquid: false
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     Vue使用WebSocket实现实时获取后端推送的数据
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <p>
     Vue可以使用WebSocket实现实时获取后端推送的数据。
    </p>
    <p>
     1.在Vue项目中安装WebSocket库
    </p>
    <p>
     可以使用npm或
     <a href="https://so.csdn.net/so/search?q=yarn%E5%AE%89%E8%A3%85&amp;spm=1001.2101.3001.7020" title="yarn安装">
      yarn安装
     </a>
     WebSocket库：
    </p>
    <pre><code>npm install --save websocket</code></pre>
    <p>
     2.创建WebSocket连接
    </p>
    <p>
     在Vue组件中创建WebSocket连接，连接到后端WebSocket服务器，代码如下：
    </p>
    <pre><code class="language-javascript">data(){
   return {
      wsUrl: "ws://192.168.1.18:8088/websocket",
      ws: null,
      testSetinterval: null,
  }
},
mounted() {
    this.websocket()
},
methods: {
    websocket() {
      this.ws = new WebSocket(this.wsUrl)
      if (typeof (WebSocket) === "undefined") {
        alert("您的浏览器不支持socket")
      } else {
        this.ws.onopen = () =&gt; {
          // Web Socket 已连接上，使用 send() 方法发送数据
          // 设置定时器
          this.testSetinterval = setInterval(() =&gt; {
            setTimeout(() =&gt; {
              this.ws.send('Holle')
            }, 0)
          }, 1000 * 2)

          // 通过$once来监听生命周期beforeDestroy钩子，在组件销毁前清除定时器。
          // 实现页面切换或者刷新时清除websocket连接
          this.$once('hook:beforeDestroy', () =&gt; {
            //清除定时器
            clearInterval(this.testSetinterval)
            //关闭websocket连接
            this.ws.close()
            console.log("定时器清除了")
          })
        }
        this.ws.onmessage = evt =&gt; {
            console.log("连接成功")
        }
        this.ws.onclose = e =&gt; {
          // 关闭 websocket
          console.log('websocket 断开')
          console.log(e.code + ' ' + e.reason + ' ' + e.wasClean);
        }
      }
    },
}
</code></pre>
    <p>
     上面的代码中，使用WebSocket连接到后端WebSocket服务器，通过监听onmessage事件，实时获取从后端推送来的数据。
    </p>
   </div>
  </div>
 </article>
 <p alt="6874747073:3a2f2f626c6f672e6373646e2e6e65742f62686a6b68686a2f:61727469636c652f64657461696c732f313432343137383839" class_="artid" style="display:none">
 </p>
</div>


