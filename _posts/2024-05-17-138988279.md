---
layout: post
title: "OpenHarmony-HarmonyOS中如何进行Http请求_harmonyos-调试本地服务请求http2"
date: 2024-05-17 06:18:31 +0800
description: "HTTP数据请求功能主要由http模块提供。_harmonyos 本地服务器"
keywords: "harmonyos 本地服务器"
categories: ["未分类"]
tags: ["鸿蒙", "面试", "学习"]
artid: "138988279"
image:
  path: https://api.vvhan.com/api/bing?rand=sj&artid=138988279
  alt: "OpenHarmony-HarmonyOS中如何进行Http请求_harmonyos-调试本地服务请求http2"
render_with_liquid: false
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     OpenHarmony HarmonyOS中如何进行Http请求_harmonyos 调试本地服务请求http(2)
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
     <img alt="img" src="https://i-blog.csdnimg.cn/blog_migrate/c18055ec1e6b6328f7e3596e0ef1914b.png">
      <br/>
      <img alt="img" src="https://i-blog.csdnimg.cn/blog_migrate/9748c5927936d8d0e779cebf9ebd171a.png"/>
     </img>
    </p>
    <p>
     <strong>
      网上学习资料一大堆，但如果学到的知识不成体系，遇到问题时只是浅尝辄止，不再深入研究，那么很难做到真正的技术提升。
     </strong>
    </p>
    <p>
     <strong>
      <a href="https://bbs.csdn.net/topics/618636735">
       需要这份系统化的资料的朋友，可以戳这里获取
      </a>
     </strong>
    </p>
    <p>
     <strong>
      一个人可以走的很快，但一群人才能走的更远！不论你是正从事IT行业的老鸟或是对IT行业感兴趣的新人，都欢迎加入我们的的圈子（技术交流、学习资源、职场吐槽、大厂内推、面试辅导），让我们一起学习成长！
     </strong>
    </p>
    <p>
     HTTP数据请求功能主要由http模块提供。
    </p>
    <h4>
     <a id="_17">
     </a>
     效果
    </h4>
    <p>
     <img alt="image-20230701160611502" src="https://i-blog.csdnimg.cn/blog_migrate/004e150eb205d053946587d7a26b9a74.png"/>
    </p>
    <h4>
     <a id="_23">
     </a>
     准备工作
    </h4>
    <p>
     本次我们要实现的是油价的查询，大家可以使用这一个API来做测试
    </p>
    <p>
     这里是对应的Key值2b9c1e5d6089c5ddb75dbf32610632bc
    </p>
    <p>
     接口地址：
    </p>
    <p>
     http://apis.juhe.cn/gnyj/query
    </p>
    <p>
     使用方法：
    </p>
    <p>
     Get
    </p>
    <p>
     请求地址：
    </p>
    <p>
     https://apis.juhe.cn/gnyj/query?key=2b9c1e5d6089c5ddb75dbf32610632bc
    </p>
    <p>
     Header：
     <br/>
     Content-Type：application/x-www-form-urlencoded
    </p>
    <h4>
     <a id="_54">
     </a>
     权限
    </h4>
    <p>
     使用该功能需要申请ohos.permission.INTERNET权限。
    </p>
    <p>
     在module.json5中添加权限
    </p>
    <pre><code>"requestPermissions": [
  {
    "name": "ohos.permission.INTERNET"
  }
],

</code></pre>
<h4>
<a id="request_73">
</a>
request 接口开发步骤
</h4>
<h5>
<a id="1HTTP_76">
</a> 1.导入 HTTP 模块
</h5>
<p>
从@ohos.net.http.d.ts 中导入 http 命名空间。
</p>
<pre><code>// 引入包名
import http from '@ohos.net.http';

</code></pre>
<h5>
<a id="2createHttp_89">
</a> 2.调用 createHttp()方法，
</h5>
<p>
创建一个 HttpRequest 对象。
</p>
<pre><code>// 每一个 httpRequest 对应一个 HTTP 请求任务，不可复用
let httpRequest = http.createHttp();

</code></pre>
<h5>
<a id="3on_102">
</a> 3.调用该对象的 on()方法
</h5>
<p>
订阅 http 响应头事件，此接口会比 request 请求先返回。可以根据业务需要订阅此消息。（可选）
</p>
<pre><code>httpRequest.on('headersReceive', (header) =&gt; {
console.info('header: ' + JSON.stringify(header));
});

</code></pre>
<h5>
<a id="4request_116">
</a> 4.调用该对象的 request()方法
</h5>
<p>
传入 http 请求的 url 地址和可选参数，发起网络请求。
</p>
<pre><code>httpRequest.request(
// 填写 HTTP 请求的 URL 地址，可以带参数也可以不带参数。URL 地址需要开发者自定义。请求的参数可以在 extraData 中指定"EXAMPLE_URL",
{
method: http.RequestMethod.POST, // 可选，默认为 http.RequestMethod.GET
// 开发者根据自身业务需要添加 header 字段
header: {
'Content-Type': 'application/json'
},
// 当使用 POST 请求时此字段用于传递内容
extraData: {
"data": "data to send",
},
expectDataType: http.HttpDataType.STRING, // 可选，指定返回数据的类型
usingCache: true, // 可选，默认为 true
priority: 1, // 可选，默认为 1
connectTimeout: 60000, // 可选，默认为 60000ms
readTimeout: 60000, // 可选，默认为 60000ms
usingProtocol: http.HttpProtocol.HTTP1_1, // 可选，协议类型默认值由系统自动指定
usingProxy: false, //可选，默认不使用网络代理，自 API 10 开始支持该属性
}, (err, data) =&gt; {

}

</code></pre>
<h5>
<a id="5_149">
</a> 5.按照实际业务需要，解析返回结果。
</h5>
<pre><code>(err, data) =&gt; {
if (!err) {
// data.result 为 HTTP 响应内容，可根据业务需要进行解析

    } else {
      console.info('error:' + JSON.stringify(err));

    }

</code></pre>
<h5>
<a id="6off_165">
</a> 6.调用该对象的 off()方法
</h5>
<p>
取消订阅 http 响应头事件。
</p>
<pre><code> httpRequest.off('headersReceive');

</code></pre>
<h5>
<a id="7_178">
</a> 7.当该请求使用完毕时
</h5>
<p>
调用 destroy()方法主动销毁。
</p>
<pre><code> httpRequest.destroy();

</code></pre>
<p>
<strong>
深知大多数程序员，想要提升技能，往往是自己摸索成长，但自己不成体系的自学效果低效又漫长，而且极易碰到天花板技术停滞不前！
</strong>
</p>
<p>
<img alt="" src="https://i-blog.csdnimg.cn/blog_migrate/1e210328c1ebf43f08d3b6c5f5c13b48.png">
<br/>
<img alt="img" src="https://i-blog.csdnimg.cn/blog_migrate/497f9770730cc9d97f3448020780b729.png">
<br/>
<img alt="img" src="https://i-blog.csdnimg.cn/blog_migrate/ea1228a9d2e7b13f708af274c1bffe44.png"/>
</img>
</img>
</p>
<p>
<strong>
既有适合小白学习的零基础资料，也有适合 3 年以上经验的小伙伴深入学习提升的进阶课程，涵盖了 95%以上鸿蒙开发知识点，真正体系化！
</strong>
</p>
<p>
<strong>
由于文件比较多，这里只是将部分目录截图出来，全套包含大厂面经、学习笔记、源码讲义、实战项目、大纲路线、讲解视频，并且后续会持续更新
</strong>
</p>
<p>
<strong>
<a href="https://bbs.csdn.net/topics/618636735">
需要这份系统化的资料的朋友，可以戳这里获取
</a>
</strong>
</p>
<p>
习的零基础资料，也有适合 3 年以上经验的小伙伴深入学习提升的进阶课程，涵盖了 95%以上鸿蒙开发知识点，真正体系化！\*\*
</p>
<p>
<strong>
由于文件比较多，这里只是将部分目录截图出来，全套包含大厂面经、学习笔记、源码讲义、实战项目、大纲路线、讲解视频，并且后续会持续更新
</strong>
</p>
<p>
<strong>
<a href="https://bbs.csdn.net/topics/618636735">
需要这份系统化的资料的朋友，可以戳这里获取
</a>
</strong>
</p>

   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f:672e6373646e2e6e65742f323430315f38343837313033312f:61727469636c652f64657461696c732f313338393838323739" class_="artid" style="display:none">
 </p>
</div>
