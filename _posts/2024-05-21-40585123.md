---
layout: post
title: "使用Iocomp工控图表工具绘制实时曲线"
date: 2024-05-21 20:26:08 +0800
description: "概述：本文为使用Iocomp工控图表工具绘制实时曲线探索及研究教程，为大家介绍了Iocomp控件、实"
keywords: "iocomp"
categories: ['未分类']
tags: ['软件开发', '控件', '工控图表', '实时曲线', 'Iocomp']
artid: "40585123"
image:
  path: https://api.vvhan.com/api/bing?rand=sj&artid=40585123
  alt: "使用Iocomp工控图表工具绘制实时曲线"
render_with_liquid: false
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     使用Iocomp工控图表工具绘制实时曲线
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <p>
     <span style="color:rgb(51,51,51); font-family:'Microsoft Yahei'; font-size:14px; line-height:28px">
      <strong>
       概述
      </strong>
      ：
     </span>
     <span style="color:rgb(51,51,51); font-family:'Microsoft Yahei'; font-size:14px; line-height:28px">
      本文为使用Iocomp工控图表工具绘制实时曲线探索及研究教程，为大家介绍了Iocomp控件、实时曲线绘制方法、Iocomp界面操作，属性分类等。帮助学习者更好的运用Iocomp。
     </span>
    </p>
    <p>
     <span style="color:rgb(51,51,51); font-family:'Microsoft Yahei'; font-size:16px; line-height:28px; text-indent:32px">
      ［摘要］数据采集是控制系统最常见的任务，对于大量的实时采集数据采用曲线加以分析已成为很重要的一种手段。文章将介绍如何用
     </span>
     <a href="http://www.evget.com/supplier/157" rel="nofollow noopener noreferrer" style="color:rgb(66,139,202); text-decoration:none; outline:0px; font-family:'Microsoft Yahei'; font-size:16px; line-height:28px; text-indent:32px" target="_blank">
      <span style="">
       Iocomp
      </span>
     </a>
     <span style="color:rgb(51,51,51); font-family:'Microsoft Yahei'; font-size:16px; line-height:28px; text-indent:32px">
      控件实现控制软件中的实时曲线的设计与绘制，并结合实例程序加以具体说明。实践表明，该方法简单可靠，对工业实时控制应用有一定借鉴意义。
     </span>
     <br/>
    </p>
    <p>
     <span style="color:rgb(51,51,51); font-family:'Microsoft Yahei'; font-size:16px; line-height:28px; text-indent:32px">
      <br/>
     </span>
    </p>
    <p>
     <span style="color:rgb(51,51,51); font-family:'Microsoft Yahei'; font-size:16px; line-height:28px; text-indent:32px">
     </span>
    </p>
    <p style="margin-top:26px; margin-bottom:26px; font-size:16px; text-indent:2em; color:rgb(51,51,51); font-family:'Microsoft Yahei'; line-height:28px">
     <span style="">
      <strong>
       Iocomp控件：
      </strong>
     </span>
    </p>
    <ul style="margin-top:5px; margin-bottom:15px; font-size:16px; color:rgb(51,51,51); font-family:'Microsoft Yahei'; line-height:28px">
     <li style="margin-left:20px">
      <p style="margin-top:26px; margin-bottom:26px; text-indent:2em">
       <a href="http://www.evget.com/product/1489" rel="nofollow noopener noreferrer" style="background-color:transparent; color:rgb(66,139,202); text-decoration:none; outline:0px" target="_blank">
        Iocomp ActiveX/VCL
       </a>
      </p>
     </li>
     <li style="margin-left:20px">
      <p style="margin-top:26px; margin-bottom:26px; text-indent:2em">
       <a href="http://www.evget.com/product/1488" rel="nofollow noopener noreferrer" style="background-color:transparent; color:rgb(66,139,202); text-decoration:none; outline:0px" target="_blank">
        Iocomp .NET WinForm
       </a>
      </p>
     </li>
     <li style="margin-left:20px">
      <p style="margin-top:26px; margin-bottom:26px; text-indent:2em">
       <a href="http://www.evget.com/product/1487" rel="nofollow noopener noreferrer" style="background-color:transparent; color:rgb(66,139,202); text-decoration:none; outline:0px" target="_blank">
        Iocomp .Net CF
       </a>
      </p>
     </li>
    </ul>
    <h4 style="font-family:'Microsoft Yahei'; line-height:1.1; color:rgb(51,51,51); margin:10px 0px; font-size:16px">
     <br style=""/>
     <span style="">
      0.引言
     </span>
    </h4>
    <p style="margin-top:26px; margin-bottom:26px; font-size:16px; text-indent:2em; color:rgb(51,51,51); font-family:'Microsoft Yahei'; line-height:28px">
     在工业控制领域，需要进行大量的数据处理和可视化显示。实时监测软件中，常常需要将采集到的数据实时显示到界面上来，以便于工作人员观测，及时发现问题和解决问题，通常还要求曲线可伸缩、可漫游、可取值，可若干条曲线的比较，以增强其可分析性。传统的控制软件开发工具多用 DOS或 Windows下的 C语言开发，导致系统开发周期长，可维护性差，并且不具有标准的 Windows图形用户界面。VB作为一种 Windows软件开发工具，既具有效率高界面友好的功能，又可以使用 DLL来实现 I/O端口的输入功能，还可以通过 API函数或 Mscomm控件实现串口通信。而本文将详细介绍一种基于 VB的 Iocomp控件实现实时曲线的绘制方法，该方法简便易行，编程也比较简单，在实际应用中得到了良好的效果。
    </p>
    <p>
     <span style="color:rgb(51,51,51); font-family:'Microsoft Yahei'; font-size:16px; line-height:28px; text-indent:32px">
     </span>
    </p>
    <p style="margin-top:26px; margin-bottom:26px; font-size:16px; text-indent:2em; color:rgb(51,51,51); font-family:'Microsoft Yahei'; line-height:28px">
     <span style="line-height:1.1; text-indent:2em">
      <strong>
       1、Iocomp Software简介
      </strong>
     </span>
    </p>
    <p style="margin-top:26px; margin-bottom:26px; font-size:16px; text-indent:2em; color:rgb(51,51,51); font-family:'Microsoft Yahei'; line-height:28px">
     <span style="text-indent:2em">
      Iocomp Software是一个让 Iocomp公司引以为豪的全新的、100%托管的、领先的、高速的、易用的、能实时绘制的控件。拥有许多在其他同类图表控件产品中所不能找到的全新特征功能及性能。Iocomp Software特征如下：
     </span>
    </p>
    <p style="margin-top:26px; margin-bottom:26px; font-size:16px; text-indent:2em; color:rgb(51,51,51); font-family:'Microsoft Yahei'; line-height:28px">
     <span style="text-indent:2em">
      属性定制编辑器：每一个控件都带有一个将属性以逻辑形式分组的属性定制编辑器，它们使得用户能够轻松的设置控件属性。在属性窗口中可以无限的搜索，属性窗口也可以无限的层叠。
     </span>
    </p>
    <p style="margin-top:26px; margin-bottom:26px; font-size:16px; text-indent:2em; color:rgb(51,51,51); font-family:'Microsoft Yahei'; line-height:28px">
     <span style="text-indent:2em">
      值相关联：大多数的控件都拥有一些值，它们在设置前可能是相关联的，这就提供了一个相关联的机制以及程序灵活性。
     </span>
    </p>
    <p style="margin-top:26px; margin-bottom:26px; font-size:16px; text-indent:2em; color:rgb(51,51,51); font-family:'Microsoft Yahei'; line-height:28px">
     <span style="text-indent:2em">
      实时 -高效：该产品的工具控件是当今最高效的。具有实时显示、缩放、滚动、即使是在进行数据绘制时、不限制 X以及 Y坐标轴、不限制通道、曲线拟合、直角坐标轴、可视化的布局管理器、支持 EMF、BMP、 JPG以及 TXT格式的文件输出。
     </span>
    </p>
    <p style="margin-top:26px; margin-bottom:26px; font-size:16px; text-indent:2em; color:rgb(51,51,51); font-family:'Microsoft Yahei'; line-height:28px">
     <span style="text-indent:2em">
     </span>
    </p>
    <h4 style="font-family:'Microsoft Yahei'; line-height:1.1; color:rgb(51,51,51); margin:10px 0px; font-size:16px">
     <span style="">
      2、实时曲线绘制方法
     </span>
    </h4>
    <p>
    </p>
    <p style="margin-top:26px; margin-bottom:26px; font-size:16px; text-indent:2em; color:rgb(51,51,51); font-family:'Microsoft Yahei'; line-height:28px">
     实时曲线的绘制方法多种多样，根据对曲线的要求，我们可以采用不同的方法来绘制，从而达到最佳的曲线效果，以下列出了几种常用的绘制实时曲线的方法：
    </p>
    <p style="margin-top:26px; margin-bottom:26px; font-size:16px; text-indent:2em; color:rgb(51,51,51); font-family:'Microsoft Yahei'; line-height:28px">
     <span style="">
      <strong>
       方法一
      </strong>
      ：
     </span>
     <span style="text-indent:2em">
      采用 TeeChart实现。TeeChart Pro是一款提供上百种 2D和 3D图形风格、40种数学和统计功能、加上无限制的轴和 22种调色板组件供选择的绘图控件。TeeChart还包括一个强大的、完整的编辑对话框，几乎可用于每个组件和子组件，允许你快速的设计复杂图表应用程序。图表编辑器通过 TeeCommander组件进一步得到增强，它提供一次点击访问图表编辑器和共同特征。
     </span>
    </p>
    <p style="margin-top:26px; margin-bottom:26px; font-size:16px; text-indent:2em; color:rgb(51,51,51); font-family:'Microsoft Yahei'; line-height:28px">
     <span style="">
      <strong>
       方法二
      </strong>
      ：
     </span>
     <span style="text-indent:2em">
      在 VB中绘制实时曲线是比较难的，一般要应用第三方控件或是 Windows API函数来完成，但是如果你对实时曲线的要求不是很高，只要能表示出当前的一般情况的话，我们可以直接应用 VB提供给我们的空间来完成。
     </span>
    </p>
    <p style="margin-top:26px; margin-bottom:26px; font-size:16px; text-indent:2em; color:rgb(51,51,51); font-family:'Microsoft Yahei'; line-height:28px">
     <span style="">
      <strong>
       方法三
      </strong>
      ：
     </span>
     <span style="text-indent:2em">
      可以采用工控组态软件来实现。组态软件具有动画显示、流程控制、数据采集、设备控制与输出、工程报表、数据与曲线等强大功能，在自动控制中占据主力军的位置，已逐渐成为工业自动化的灵魂。
     </span>
    </p>
    <p style="margin-top:26px; margin-bottom:26px; font-size:16px; text-indent:2em; color:rgb(51,51,51); font-family:'Microsoft Yahei'; line-height:28px">
     <span style="">
      <strong>
       方法四
      </strong>
      ：
     </span>
     <span style="text-indent:2em">
      采用 Iocomp控件来实现。结合 Iocomp Components图形仪表组件，易于实现 VB组态。
     </span>
    </p>
    <p style="margin-top:26px; margin-bottom:26px; font-size:16px; text-indent:2em; color:rgb(51,51,51); font-family:'Microsoft Yahei'; line-height:28px">
     <span style="text-indent:2em">
      结合以上四种方法的总结与比较，采用 Iocomp控件来实现实时曲线的绘制是最佳的，在工业控制软件当中，它将为更多的程序员提供更广的应用领域和发展空间。
     </span>
    </p>
    <p style="margin-top:26px; margin-bottom:26px; font-size:16px; text-indent:2em; color:rgb(51,51,51); font-family:'Microsoft Yahei'; line-height:28px">
     <span style="text-indent:2em">
     </span>
    </p>
    <h4 style="font-family:'Microsoft Yahei'; line-height:1.1; color:rgb(51,51,51); margin:10px 0px; font-size:16px">
     <br style=""/>
     <span style="">
      3、Iocomp控件介绍
     </span>
    </h4>
    <p>
    </p>
    <p style="margin-top:26px; margin-bottom:26px; font-size:16px; text-indent:2em; color:rgb(51,51,51); font-family:'Microsoft Yahei'; line-height:28px">
     Iocomp控件主要有三种组件：⑴iPlot ⑵iXYPlot ⑶iScope iPlot是一款即时绘图组件，支持具有连续递增的 X坐标的数据序列的绘图。其典型的用途是图表记录或滚动图表类型的应用。该组件可
     <br style=""/>
     用于所有的绘图应用。iPlot组件的应用使得绘图程序得到了最优化， iPlot组件还可提供高速接入和绘图方法。
    </p>
    <p style="margin-top:26px; margin-bottom:26px; font-size:16px; text-indent:2em; color:rgb(51,51,51); font-family:'Microsoft Yahei'; line-height:28px">
     <span style="text-indent:2em">
      iXYPlot是一个即时绘图组件，它支持具备任意 X、Y坐标值的数据。
     </span>
    </p>
    <p style="margin-top:26px; margin-bottom:26px; font-size:16px; text-indent:2em; color:rgb(51,51,51); font-family:'Microsoft Yahei'; line-height:28px">
     <span style="text-indent:2em">
      iScope是一个真正的实时模拟和数字范围的组件。支持实时处理和显示的数据时，5MHz的信号输入率如果是连续的数据或使用更高的数据传输率采用间断数据。
     </span>
    </p>
    <p style="margin-top:26px; margin-bottom:26px; font-size:16px; text-indent:2em; color:rgb(51,51,51); font-family:'Microsoft Yahei'; line-height:28px">
     <span style="text-indent:2em">
      iPlot组件和 iXYPlot组件的等级是相同的，除了通道的对象。其层次结构图如图 1。
     </span>
    </p>
    <p style="margin-top:26px; margin-bottom:26px; font-size:16px; text-indent:2em; color:rgb(51,51,51); font-family:'Microsoft Yahei'; line-height:28px">
     <span style="text-indent:2em">
      <img alt="" src="https://img-blog.csdn.net/20141029133654671?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQveWV5ZXlpMTk4OQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center">
       <br/>
      </img>
     </span>
    </p>
    <p style="margin-top:26px; margin-bottom:26px; font-size:16px; text-indent:2em; color:rgb(51,51,51); font-family:'Microsoft Yahei'; line-height:28px">
     <span style="text-indent:2em">
      <span style="color:rgb(51,51,51); font-family:'Microsoft Yahei'; font-size:16px; line-height:28px; text-indent:32px">
       图 1层次结构图常用属性简介如下表：
      </span>
      <br/>
     </span>
    </p>
    <p style="margin-top:26px; margin-bottom:26px; font-size:16px; text-indent:2em; color:rgb(51,51,51); font-family:'Microsoft Yahei'; line-height:28px">
     <span style="text-indent:2em">
      <span style="color:rgb(51,51,51); font-family:'Microsoft Yahei'; font-size:16px; line-height:28px; text-indent:32px">
       <img alt="" src="https://img-blog.csdn.net/20141029133813046?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQveWV5ZXlpMTk4OQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center">
        <br/>
       </img>
      </span>
     </span>
    </p>
    <p style="margin-top:26px; margin-bottom:26px; font-size:16px; text-indent:2em; color:rgb(51,51,51); font-family:'Microsoft Yahei'; line-height:28px">
     <span style="text-indent:2em">
      <span style="color:rgb(51,51,51); font-family:'Microsoft Yahei'; font-size:16px; line-height:28px; text-indent:32px">
       <span style="color:rgb(51,51,51); font-family:'Microsoft Yahei'; font-size:16px; line-height:28px; text-indent:32px">
        Channel属性，可以访问指定的通道。可以使用 AddChannel, DeleteChannel和 RemoveAllChannel方法在运行时间中添加或者移除某个通道。在设计时，可以使用内置的属性编辑器来改变通道。
       </span>
       <br style="color:rgb(51,51,51); font-family:'Microsoft Yahei'; font-size:16px; line-height:28px; text-indent:32px"/>
       <span style="color:rgb(51,51,51); font-family:'Microsoft Yahei'; font-size:16px; line-height:28px; text-indent:32px">
        Annotation属性，可以访问指定的注释。可以使用 AddAnnotation， DeleteAnnotation和 RemoveAllAnnotation方法在运行时间中添加或者移除某个注释。注释无法在设计时间中添加。
       </span>
       <br style="color:rgb(51,51,51); font-family:'Microsoft Yahei'; font-size:16px; line-height:28px; text-indent:32px"/>
       <span style="color:rgb(51,51,51); font-family:'Microsoft Yahei'; font-size:16px; line-height:28px; text-indent:32px">
        X-axis属性，您可以访问指定的 X轴线。您可以使用 AddXAxis, DeleteXAxis和 RemoveAllXAxes方法在运行时间中添加或者移除某个 X轴。在设计时间，可以使用内置的属性编辑器来改变某个 X轴。
       </span>
       <br style="color:rgb(51,51,51); font-family:'Microsoft Yahei'; font-size:16px; line-height:28px; text-indent:32px"/>
       <span style="color:rgb(51,51,51); font-family:'Microsoft Yahei'; font-size:16px; line-height:28px; text-indent:32px">
        YAxis属性，可以访问指定的 Y轴线。可以使用 AddYAxis, Delete YAxis和 RemoveAllYAxes方法在运行时间中添加或者移除某个 Y轴。在设计时间，可以使用内置的属性编辑器来改变某个 Y轴。
       </span>
       <br style="color:rgb(51,51,51); font-family:'Microsoft Yahei'; font-size:16px; line-height:28px; text-indent:32px"/>
       <span style="color:rgb(51,51,51); font-family:'Microsoft Yahei'; font-size:16px; line-height:28px; text-indent:32px">
        DataView属性通过索引号，可以访问数据视图。该功能接口支持多个数据视图，但是在当前版本中未提供该功能支持，期待在下面版本中推出。
       </span>
       <br style="color:rgb(51,51,51); font-family:'Microsoft Yahei'; font-size:16px; line-height:28px; text-indent:32px"/>
       <span style="color:rgb(51,51,51); font-family:'Microsoft Yahei'; font-size:16px; line-height:28px; text-indent:32px">
        ToolBar属性通过索引号，可以访问工具栏。该功能接口支持多个工具栏，但是在当前版本中未提供该功能支持，期待在下面版本中推出。
       </span>
       <br style="color:rgb(51,51,51); font-family:'Microsoft Yahei'; font-size:16px; line-height:28px; text-indent:32px"/>
       <span style="color:rgb(51,51,51); font-family:'Microsoft Yahei'; font-size:16px; line-height:28px; text-indent:32px">
        Legend属性通过索引号，可以访问图标符号。该功能接口支持多个图标符号，但是在当前版本中未提供该功能支持，期待在下面版本中推出。
       </span>
       <br/>
      </span>
     </span>
    </p>
    <p style="margin-top:26px; margin-bottom:26px; font-size:16px; text-indent:2em; color:rgb(51,51,51); font-family:'Microsoft Yahei'; line-height:28px">
     <span style="text-indent:2em">
      <span style="color:rgb(51,51,51); font-family:'Microsoft Yahei'; font-size:16px; line-height:28px; text-indent:32px">
       <span style="color:rgb(51,51,51); font-family:'Microsoft Yahei'; font-size:16px; line-height:28px; text-indent:32px">
       </span>
      </span>
     </span>
    </p>
    <h4 style="font-family:'Microsoft Yahei'; line-height:1.1; color:rgb(51,51,51); margin:10px 0px; font-size:16px">
     <span style="">
      4、编辑主界面
     </span>
    </h4>
    <p>
    </p>
    <p style="margin-top:26px; margin-bottom:26px; font-size:16px; text-indent:2em; color:rgb(51,51,51); font-family:'Microsoft Yahei'; line-height:28px">
     对界面的设置是必不可少的，它可以更直观更简捷的为我们提供绘制实时曲线的各个属性功能，我们可以直接修改程序来进行对一些属性要求的设置，也可以直接在面板的分项属性中进行设置，对各属性
    </p>
    <p style="margin-top:26px; margin-bottom:26px; font-size:16px; text-indent:2em; color:rgb(51,51,51); font-family:'Microsoft Yahei'; line-height:28px">
     不同的设置得到的结果显示也将不一样，可以根据设计员自己的要求来具体设置。下图 2是显示了本文所应用的 iPlot组建的编辑主界面。
    </p>
    <p style="margin-top:26px; margin-bottom:26px; font-size:16px; text-indent:2em; color:rgb(51,51,51); font-family:'Microsoft Yahei'; line-height:28px">
     <img alt="" src="https://img-blog.csdn.net/20141029133933812?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQveWV5ZXlpMTk4OQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center">
      <br/>
     </img>
    </p>
    <p style="margin-top:26px; margin-bottom:26px; font-size:16px; text-indent:2em; color:rgb(51,51,51); font-family:'Microsoft Yahei'; line-height:28px">
    </p>
    <h4 style="font-family:'Microsoft Yahei'; line-height:1.1; color:rgb(51,51,51); margin:10px 0px; font-size:16px">
     <span style="">
      5、具体实例
     </span>
    </h4>
    <p>
    </p>
    <p style="margin-top:26px; margin-bottom:26px; font-size:16px; text-indent:2em; color:rgb(51,51,51); font-family:'Microsoft Yahei'; line-height:28px">
     下面来看一下如何采用 Iocomp控件中的 iPlot组件来实现实时曲线的绘制，编写程序既简单又方便。
     <br style=""/>
     采用 Iocomp控件中的 iPlot组件绘制实时曲线，其实时测量值曲线绘制显示界面如图 3。
    </p>
    <p style="margin-top:26px; margin-bottom:26px; font-size:16px; text-indent:2em; color:rgb(51,51,51); font-family:'Microsoft Yahei'; line-height:28px">
     <img alt="" src="https://img-blog.csdn.net/20141029134012234?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQveWV5ZXlpMTk4OQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center">
      <br/>
     </img>
    </p>
    <p style="margin-top:26px; margin-bottom:26px; font-size:16px; text-indent:2em; color:rgb(51,51,51); font-family:'Microsoft Yahei'; line-height:28px">
     <span style="color:rgb(51,51,51); font-family:'Microsoft Yahei'; font-size:16px; line-height:28px; text-indent:32px">
      实时曲线反映的是现场数据的实时性和当前趋势，绘制实时采集数据曲线是为了实时观测，以便掌握实时采集数据变动的趋势，使曲线显示效果最佳，因此在实现时需显示曲线的动态变化，当前点在曲线的最右端显示，而整个曲线动态地向左移动。实时曲线在动态的移动时，测量值、峰值、谷值这三个通道同时相应的显示具体采样数值，一目了然。由于篇幅有限，程序只保留核心部分。编写程序如下：
     </span>
     <br/>
    </p>
    <p style="margin-top:26px; margin-bottom:26px; font-size:16px; text-indent:2em; color:rgb(51,51,51); font-family:'Microsoft Yahei'; line-height:28px">
     <span style="color:rgb(51,51,51); font-family:'Microsoft Yahei'; font-size:16px; line-height:28px; text-indent:32px">
     </span>
    </p>
    <div class="line number1 index0 alt2" style="line-height:15.390625px; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace; font-size:14px; color:rgb(51,51,51); border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px 1em!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:inherit!important; white-space:pre!important">
     <code class="csharp plain" style="white-space:nowrap; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; font-size:1em!important; padding:0px!important; color:black!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; margin:0px!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:inherit!important">
      Private Sub Form_Load()
     </code>
    </div>
    <div class="line number2 index1 alt1" style="line-height:15.390625px; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace; font-size:14px; color:rgb(51,51,51); border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px 1em!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:inherit!important; white-space:pre!important">
     <code class="csharp plain" style="white-space:nowrap; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; font-size:1em!important; padding:0px!important; color:black!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; margin:0px!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:inherit!important">
      iPlotX1.Channel(0).TitleText =
     </code>
     <code class="csharp string" style="white-space:nowrap; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; font-size:1em!important; padding:0px!important; color:blue!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; margin:0px!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:inherit!important">
      " 测量值"
     </code>
    </div>
    <div class="line number3 index2 alt2" style="line-height:15.390625px; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace; font-size:14px; color:rgb(51,51,51); border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px 1em!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:inherit!important; white-space:pre!important">
     <code class="csharp plain" style="white-space:nowrap; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; font-size:1em!important; padding:0px!important; color:black!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; margin:0px!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:inherit!important">
      iPlotX1.Channel(1).TitleText =
     </code>
     <code class="csharp string" style="white-space:nowrap; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; font-size:1em!important; padding:0px!important; color:blue!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; margin:0px!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:inherit!important">
      " 峰值"
     </code>
    </div>
    <div class="line number4 index3 alt1" style="line-height:15.390625px; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace; font-size:14px; color:rgb(51,51,51); border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px 1em!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:inherit!important; white-space:pre!important">
     <code class="csharp plain" style="white-space:nowrap; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; font-size:1em!important; padding:0px!important; color:black!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; margin:0px!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:inherit!important">
      iPlotX1.Channel(2).TitleText =
     </code>
     <code class="csharp string" style="white-space:nowrap; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; font-size:1em!important; padding:0px!important; color:blue!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; margin:0px!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:inherit!important">
      " 谷值"
     </code>
    </div>
    <div class="line number5 index4 alt2" style="line-height:15.390625px; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace; font-size:14px; color:rgb(51,51,51); border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px 1em!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:inherit!important; white-space:pre!important">
     <code class="csharp plain" style="white-space:nowrap; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; font-size:1em!important; padding:0px!important; color:black!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; margin:0px!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:inherit!important">
      Call Comm_initial
     </code>
    </div>
    <div class="line number6 index5 alt1" style="line-height:15.390625px; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace; font-size:14px; color:rgb(51,51,51); border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px 1em!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:inherit!important; white-space:pre!important">
     <code class="csharp plain" style="white-space:nowrap; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; font-size:1em!important; padding:0px!important; color:black!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; margin:0px!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:inherit!important">
      XValue = 0
     </code>
    </div>
    <div class="line number7 index6 alt2" style="line-height:15.390625px; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace; font-size:14px; color:rgb(51,51,51); border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px 1em!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:inherit!important; white-space:pre!important">
     <code class="csharp plain" style="white-space:nowrap; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; font-size:1em!important; padding:0px!important; color:black!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; margin:0px!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:inherit!important">
      If Right(App.Path, 1) = "\" Then
     </code>
    </div>
    <div class="line number8 index7 alt1" style="line-height:15.390625px; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace; font-size:14px; color:rgb(51,51,51); border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px 1em!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:inherit!important; white-space:pre!important">
     <code class="csharp plain" style="white-space:nowrap; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; font-size:1em!important; padding:0px!important; color:black!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; margin:0px!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:inherit!important">
      fpname = App.Path &amp;"data\"
     </code>
    </div>
    <div class="line number9 index8 alt2" style="line-height:15.390625px; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace; font-size:14px; color:rgb(51,51,51); border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px 1em!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:inherit!important; white-space:pre!important">
     <code class="csharp plain" style="white-space:nowrap; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; font-size:1em!important; padding:0px!important; color:black!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; margin:0px!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:inherit!important">
      Else
     </code>
    </div>
    <div class="line number10 index9 alt1" style="line-height:15.390625px; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace; font-size:14px; color:rgb(51,51,51); border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px 1em!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:inherit!important; white-space:pre!important">
     <code class="csharp plain" style="white-space:nowrap; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; font-size:1em!important; padding:0px!important; color:black!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; margin:0px!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:inherit!important">
      fpname = App.Path &amp;"\data\"
     </code>
    </div>
    <div class="line number11 index10 alt2" style="line-height:15.390625px; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace; font-size:14px; color:rgb(51,51,51); border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px 1em!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:inherit!important; white-space:pre!important">
     <code class="csharp plain" style="white-space:nowrap; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; font-size:1em!important; padding:0px!important; color:black!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; margin:0px!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:inherit!important">
      End If
     </code>
    </div>
    <div class="line number12 index11 alt1" style="line-height:15.390625px; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace; font-size:14px; color:rgb(51,51,51); border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px 1em!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:inherit!important; white-space:pre!important">
     <code class="csharp plain" style="white-space:nowrap; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; font-size:1em!important; padding:0px!important; color:black!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; margin:0px!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:inherit!important">
      ComD1.InitDir = fpname
     </code>
    </div>
    <div class="line number13 index12 alt2" style="line-height:15.390625px; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace; font-size:14px; color:rgb(51,51,51); border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px 1em!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:inherit!important; white-space:pre!important">
     <code class="csharp plain" style="white-space:nowrap; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; font-size:1em!important; padding:0px!important; color:black!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; margin:0px!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:inherit!important">
      End Sub
     </code>
    </div>
    <span style="color:rgb(51,51,51); font-family:'Microsoft Yahei'; font-size:16px; line-height:28px; text-indent:32px">
    </span>
    <p>
    </p>
    <p style="margin-top:26px; margin-bottom:26px; font-size:16px; text-indent:2em; color:rgb(51,51,51); font-family:'Microsoft Yahei'; line-height:28px">
     以上程序完成对 iPlotX控件的初始化，初始化具有三个通道，名字分别为测量值、峰值、谷值，并调用 Comm_initial函数完成对串口的初始化，设定 App.Path &amp; "data\"为采集数据存放路径。
    </p>
    <p style="margin-top:26px; margin-bottom:26px; font-size:16px; text-indent:2em; color:rgb(51,51,51); font-family:'Microsoft Yahei'; line-height:28px">
    </p>
    <div class="line number1 index0 alt2" style="line-height:15.390625px; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace; font-size:14px; color:rgb(51,51,51); border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px 1em!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:inherit!important; white-space:pre!important">
     <code class="csharp plain" style="white-space:nowrap; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; font-size:1em!important; padding:0px!important; color:black!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; margin:0px!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:inherit!important">
      Private Sub Timer1_Timer()
     </code>
    </div>
    <div class="line number2 index1 alt1" style="line-height:15.390625px; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace; font-size:14px; color:rgb(51,51,51); border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px 1em!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:inherit!important; white-space:pre!important">
     <code class="csharp plain" style="white-space:nowrap; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; font-size:1em!important; padding:0px!important; color:black!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; margin:0px!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:inherit!important">
      Dim a
     </code>
    </div>
    <div class="line number3 index2 alt2" style="line-height:15.390625px; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace; font-size:14px; color:rgb(51,51,51); border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px 1em!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:inherit!important; white-space:pre!important">
     <code class="csharp plain" style="white-space:nowrap; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; font-size:1em!important; padding:0px!important; color:black!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; margin:0px!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:inherit!important">
      Dim i%, j%, k%, l%
     </code>
    </div>
    <div class="line number4 index3 alt1" style="line-height:15.390625px; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace; font-size:14px; color:rgb(51,51,51); border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px 1em!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:inherit!important; white-space:pre!important">
     <code class="csharp plain" style="white-space:nowrap; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; font-size:1em!important; padding:0px!important; color:black!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; margin:0px!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:inherit!important">
      Dim bjsta As String
     </code>
    </div>
    <div class="line number5 index4 alt2" style="line-height:15.390625px; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace; font-size:14px; color:rgb(51,51,51); border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px 1em!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:inherit!important; white-space:pre!important">
     <code class="csharp plain" style="white-space:nowrap; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; font-size:1em!important; padding:0px!important; color:black!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; margin:0px!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:inherit!important">
      Dim otime As Long
     </code>
    </div>
    <div class="line number6 index5 alt1" style="line-height:15.390625px; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace; font-size:14px; color:rgb(51,51,51); border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px 1em!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:inherit!important; white-space:pre!important">
     <code class="csharp plain" style="white-space:nowrap; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; font-size:1em!important; padding:0px!important; color:black!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; margin:0px!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:inherit!important">
      Dim delayt As Integer
     </code>
    </div>
    <div class="line number7 index6 alt2" style="line-height:15.390625px; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace; font-size:14px; color:rgb(51,51,51); border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px 1em!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:inherit!important; white-space:pre!important">
     <code class="csharp plain" style="white-space:nowrap; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; font-size:1em!important; padding:0px!important; color:black!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; margin:0px!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:inherit!important">
      delayt = 60
     </code>
    </div>
    <div class="line number8 index7 alt1" style="line-height:15.390625px; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace; font-size:14px; color:rgb(51,51,51); border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px 1em!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:inherit!important; white-space:pre!important">
     <code class="csharp plain" style="white-space:nowrap; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; font-size:1em!important; padding:0px!important; color:black!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; margin:0px!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:inherit!important">
      i=0 '命令重发次数计数变量
     </code>
    </div>
    <div class="line number9 index8 alt2" style="line-height:15.390625px; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace; font-size:14px; color:rgb(51,51,51); border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px 1em!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:inherit!important; white-space:pre!important">
     <code class="csharp plain" style="white-space:nowrap; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; font-size:1em!important; padding:0px!important; color:black!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; margin:0px!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:inherit!important">
      j=0
     </code>
    </div>
    <div class="line number10 index9 alt1" style="line-height:15.390625px; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace; font-size:14px; color:rgb(51,51,51); border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px 1em!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:inherit!important; white-space:pre!important">
     <code class="csharp plain" style="white-space:nowrap; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; font-size:1em!important; padding:0px!important; color:black!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; margin:0px!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:inherit!important">
      k=0
     </code>
    </div>
    <div class="line number11 index10 alt2" style="line-height:15.390625px; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace; font-size:14px; color:rgb(51,51,51); border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px 1em!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:inherit!important; white-space:pre!important">
     <code class="csharp plain" style="white-space:nowrap; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; font-size:1em!important; padding:0px!important; color:black!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; margin:0px!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:inherit!important">
      l=0
     </code>
    </div>
    <div class="line number12 index11 alt1" style="line-height:15.390625px; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace; font-size:14px; color:rgb(51,51,51); border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px 1em!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:inherit!important; white-space:pre!important">
     <code class="csharp plain" style="white-space:nowrap; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; font-size:1em!important; padding:0px!important; color:black!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; margin:0px!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:inherit!important">
      fs1:
     </code>
    </div>
    <div class="line number13 index12 alt2" style="line-height:15.390625px; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace; font-size:14px; color:rgb(51,51,51); border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px 1em!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:inherit!important; white-space:pre!important">
     <code class="csharp plain" style="white-space:nowrap; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; font-size:1em!important; padding:0px!important; color:black!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; margin:0px!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:inherit!important">
      MSComm.InBufferCount = 0
     </code>
    </div>
    <div class="line number14 index13 alt1" style="line-height:15.390625px; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace; font-size:14px; color:rgb(51,51,51); border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px 1em!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:inherit!important; white-space:pre!important">
     <code class="csharp plain" style="white-space:nowrap; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; font-size:1em!important; padding:0px!important; color:black!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; margin:0px!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:inherit!important">
      MSComm.OutBufferCount = 0 '清空输出缓冲区
     </code>
    </div>
    <div class="line number15 index14 alt2" style="line-height:15.390625px; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace; font-size:14px; color:rgb(51,51,51); border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px 1em!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:inherit!important; white-space:pre!important">
    </div>
    <div class="line number16 index15 alt1" style="line-height:15.390625px; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace; font-size:14px; color:rgb(51,51,51); border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px 1em!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:inherit!important; white-space:pre!important">
     <code class="csharp plain" style="white-space:nowrap; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; font-size:1em!important; padding:0px!important; color:black!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; margin:0px!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:inherit!important">
      MSComm.Output =
     </code>
     <code class="csharp string" style="white-space:nowrap; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; font-size:1em!important; padding:0px!important; color:blue!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; margin:0px!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:inherit!important">
      "#01"
     </code>
     <code class="csharp plain" style="white-space:nowrap; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; font-size:1em!important; padding:0px!important; color:black!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; margin:0px!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:inherit!important">
      &amp; vbCr '测量值读取 otime = GetTickCount i=i+1 Do
     </code>
    </div>
    <div class="line number17 index16 alt2" style="line-height:15.390625px; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace; font-size:14px; color:rgb(51,51,51); border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px 1em!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:inherit!important; white-space:pre!important">
     <code class="csharp plain" style="white-space:nowrap; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; font-size:1em!important; padding:0px!important; color:black!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; margin:0px!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:inherit!important">
      a = DoEvents() Loop Until MSComm.InBufferCount &gt;= 10 Or GetTickCount &gt;= otime +
     </code>
    </div>
    <div class="line number18 index17 alt1" style="line-height:15.390625px; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace; font-size:14px; color:rgb(51,51,51); border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px 1em!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:inherit!important; white-space:pre!important">
     <code class="csharp plain" style="white-space:nowrap; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; font-size:1em!important; padding:0px!important; color:black!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; margin:0px!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:inherit!important">
      delayt clclz = MSComm.Input If Left(clclz, 1) =
     </code>
     <code class="csharp string" style="white-space:nowrap; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; font-size:1em!important; padding:0px!important; color:blue!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; margin:0px!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:inherit!important">
      "="
     </code>
     <code class="csharp plain" style="white-space:nowrap; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; font-size:1em!important; padding:0px!important; color:black!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; margin:0px!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:inherit!important">
      And IsNumeric(Mid(clclz, 2, 6)) Then
     </code>
    </div>
    <div class="line number19 index18 alt2" style="line-height:15.390625px; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace; font-size:14px; color:rgb(51,51,51); border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px 1em!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:inherit!important; white-space:pre!important">
     <code class="csharp plain" style="white-space:nowrap; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; font-size:1em!important; padding:0px!important; color:black!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; margin:0px!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:inherit!important">
      lbclz.Caption = Mid(clclz, 2, 6) clclz = lbclz.Caption
     </code>
    </div>
    <div class="line number20 index19 alt1" style="line-height:15.390625px; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace; font-size:14px; color:rgb(51,51,51); border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px 1em!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:inherit!important; white-space:pre!important">
     <code class="csharp plain" style="white-space:nowrap; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; font-size:1em!important; padding:0px!important; color:black!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; margin:0px!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:inherit!important">
      Else If i &gt; 10 Then GoTo fs2 GoTo fs1
     </code>
    </div>
    <div class="line number21 index20 alt2" style="line-height:15.390625px; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace; font-size:14px; color:rgb(51,51,51); border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px 1em!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:inherit!important; white-space:pre!important">
     <code class="csharp plain" style="white-space:nowrap; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; font-size:1em!important; padding:0px!important; color:black!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; margin:0px!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:inherit!important">
      End If ………………
     </code>
     <code class="csharp comments" style="white-space:nowrap; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; font-size:1em!important; padding:0px!important; color:rgb(0,130,0)!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; margin:0px!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:inherit!important">
      //省略程序数据采集峰值、谷值，其采集方法同上 fs5:
     </code>
    </div>
    <div class="line number22 index21 alt1" style="line-height:15.390625px; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace; font-size:14px; color:rgb(51,51,51); border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px 1em!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:inherit!important; white-space:pre!important">
     <code class="csharp plain" style="white-space:nowrap; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; font-size:1em!important; padding:0px!important; color:black!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; margin:0px!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:inherit!important">
      YValue = Val(lbclz.Caption) iPlotX1.Channel(0).AddYNow Yvalue YValue = Val(Lbfz.Caption) iPlotX1.Channel(1).AddYNow YValue YValue = Val(Lbgz.Caption) iPlotX1.Channel(2).AddYNow YValue YValue = yboutv2 XValue = XValue + 1 MSComm.InBufferCount = 0 MSComm.OutBufferCount = 0 ………………
     </code>
     <code class="csharp comments" style="white-space:nowrap; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; font-size:1em!important; padding:0px!important; color:rgb(0,130,0)!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; margin:0px!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:inherit!important">
      //数据保存部分省略
     </code>
    </div>
    <div class="line number23 index22 alt2" style="line-height:15.390625px; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace; font-size:14px; color:rgb(51,51,51); border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px 1em!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:inherit!important; white-space:pre!important">
     <code class="csharp plain" style="white-space:nowrap; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; font-size:1em!important; padding:0px!important; color:black!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; margin:0px!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:inherit!important">
      End Sub
     </code>
    </div>
    <span style="color:rgb(51,51,51); font-family:'Microsoft Yahei'; font-size:16px; line-height:28px; text-indent:32px">
    </span>
    <p>
    </p>
    <p style="margin-top:26px; margin-bottom:26px; font-size:16px; text-indent:2em; color:rgb(51,51,51); font-family:'Microsoft Yahei'; line-height:28px">
     以上程序为实时采集函数，其功能：用 MSComm实现与串口的通信， MSComm.Output = "#01" &amp; vbCr语句为读仪表命令。每次采样发出 3条仪表读取测量值命令，1条报警开关读取命令。采样频率在有线通信和无线通信模式下最高每秒可以达到 15次，在无线通信出错较大情况下可以保证每秒正确采样 8次，通信采用的强烈的纠错方法；采样数据测量值、峰值、谷值送入 Iocomp控件实时显示，程序会在每次采样过后将数据存入本软件的 data目录下。
    </p>
    <p style="margin-top:26px; margin-bottom:26px; font-size:16px; text-indent:2em; color:rgb(51,51,51); font-family:'Microsoft Yahei'; line-height:28px">
    </p>
    <h4 style="font-family:'Microsoft Yahei'; line-height:1.1; color:rgb(51,51,51); margin:10px 0px; font-size:16px">
     <span style="">
      6.结束语
     </span>
    </h4>
    <p>
    </p>
    <p style="margin-top:26px; margin-bottom:26px; font-size:16px; text-indent:2em; color:rgb(51,51,51); font-family:'Microsoft Yahei'; line-height:28px">
     以上程序采用 Iocomp控件实现实时曲线的绘制，曲线的采样频率可以每秒达到 50次，最高可达 100次，灵敏度极高，绘制出的曲线也比较流畅，它不仅可用在工业控制的历史数据处理，而且可以广泛地适用于商业、管理及很多有大量数据需曲线显示的应用。
     <br style=""/>
     因此，Iocomp Components图形仪表组件对于构建逼真的人机界面、处理实时数据将非常有用，相信它们会被广泛地应用到越来越多的领域和行业当中。由于控件具有界面友好、操作简单、可扩展性强等特点，因此使用这些组件可以非常方便地扩展出风格多种多样的数据图形，整个设计过程都无需编程。
    </p>
    <p style="margin-top:26px; margin-bottom:26px; font-size:16px; text-indent:2em; color:rgb(51,51,51); font-family:'Microsoft Yahei'; line-height:28px">
     <br/>
    </p>
    <p style="margin-top:26px; margin-bottom:26px; font-size:16px; text-indent:2em; color:rgb(51,51,51); font-family:'Microsoft Yahei'; line-height:28px">
     <span style="color:rgb(51,51,51); font-family:'Microsoft Yahei'; font-size:16px; line-height:28px; text-indent:32px">
      作者：陕西理工学院物理系 翟世磊 李明波 李福 刘东
     </span>
     <br/>
    </p>
    <p style="margin-top:26px; margin-bottom:26px; font-size:16px; text-indent:2em; color:rgb(51,51,51); font-family:'Microsoft Yahei'; line-height:28px">
     <span style="color:rgb(51,51,51); font-family:'Microsoft Yahei'; font-size:16px; line-height:28px; text-indent:32px">
      <span style="color:rgb(126,126,126); font-family:'Microsoft Yahei'; line-height:20px">
       文章转载自：慧都控件网 [
      </span>
      <a href="http://www.evget.com/" rel="nofollow noopener noreferrer" style="color:rgb(126,126,126); text-decoration:none; outline:0px; font-family:'Microsoft Yahei'; line-height:20px" target="_blank" title="慧都控件网">
       http://www.evget.com
      </a>
      <span style="color:rgb(126,126,126); font-family:'Microsoft Yahei'; line-height:20px">
       ]
      </span>
      <br/>
     </span>
    </p>
    <br/>
    <br/>
    <br/>
    <br/>
    <p style="margin-top:26px; margin-bottom:26px; font-size:16px; text-indent:2em; color:rgb(51,51,51); font-family:'Microsoft Yahei'; line-height:28px">
     <br/>
    </p>
    <br/>
    <p>
     <span style="color:rgb(51,51,51); font-family:'Microsoft Yahei'; font-size:16px; line-height:28px">
     </span>
    </p>
    <p style="margin-top:26px; margin-bottom:26px; font-size:16px; text-indent:2em; color:rgb(51,51,51); font-family:'Microsoft Yahei'; line-height:28px">
     <br/>
    </p>
    <div>
     <br/>
    </div>
    <br/>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f:2f626c6f672e6373646e2e6e65742f79657965796931393839:2f61727469636c652f64657461696c732f3430353835313233" class_="artid" style="display:none">
 </p>
</div>
