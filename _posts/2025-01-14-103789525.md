---
layout: post
title: "nps服务器-内网穿透"
date: 2025-01-14 15:17:32 +0800
description: "今天教大家搭建 nps服务器 内网穿透公司的环境在公网无法进行访问nps服务可以将内网服务映射到公网"
keywords: "nps v0.23.1"
categories: ['学海无涯']
tags: ['无标签']
artid: "103789525"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=103789525
    alt: "nps服务器-内网穿透"
render_with_liquid: false
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     nps服务器 内网穿透
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <p>
     今天教大家搭建 nps服务器 内网穿透
    </p>
    <p>
     公司的环境在公网无法进行访问nps服务可以将内网服务映射到公网
    </p>
    <p>
     演示图：
    </p>
    <p>
     <img alt="" class="has" height="390" src="https://i-blog.csdnimg.cn/blog_migrate/1fdd9253f15c2e9b7ef736583dbadbbd.png" width="764"/>
    </p>
    <p>
     <strong>
      下面演示步骤：首先你要有台云服务器
     </strong>
    </p>
    <h3>
     <strong>
      配置服务器端
     </strong>
    </h3>
    <p>
     <img alt="" class="has" height="314" src="https://i-blog.csdnimg.cn/blog_migrate/9ba76ea95902e57e7b124975be62a0d4.png" width="1200"/>
    </p>
    <p>
     然后将这个云服务器的防火墙根据要求打开。。。。。
    </p>
    <p>
     然后登录该服务器（我这个是centos7的）
    </p>
    <p>
     下载链接
    </p>
    <p>
     wget https://github.com/cnlh/nps/releases/download/v0.23.1/linux_amd64_server.tar.gz
    </p>
    <p>
     <img alt="" class="has" height="350" src="https://i-blog.csdnimg.cn/blog_migrate/05597dcff85e5102640e590352dcb309.png" width="641"/>
    </p>
    <p>
     tar -zxvf linux_amd64_server.tar.gz    #解压这个包
    </p>
    <p>
     cd nps/    进到这个目录
    </p>
    <p>
     ./nps start    开启服务
     <br/>
     在安装完成，启动nps后，便可访问server_IP:8080来访问nps配置dashboard了
     <br/>
     要求登陆，默认的用户名：admin，密码：123
    </p>
    <p>
     <strong>
      网页登录界面的用户名和密码可在nps/conf/nps.conf配置文件中修改
     </strong>
    </p>
    <p>
     <img alt="" class="has" height="970" src="https://i-blog.csdnimg.cn/blog_migrate/38030bd54bb5e6da343b80ce823f665e.png" width="1156"/>
    </p>
    <p>
     登陆进入登录界面后,看到界面，默认客户端为0（这里我已经创建了一个）
     <br/>
     默认的客户端链接端口为8024（该端口为客户端用于链接服务器的端口，来保持链接，原理与反向代理相似）
    </p>
    <p>
     <img alt="" class="has" height="921" src="https://i-blog.csdnimg.cn/blog_migrate/d7bcffcc1fe7efc1d25ec7882809b823.png" width="1200"/>
    </p>
    <p>
     <strong>
      新建客户端
     </strong>
     <br/>
     这里我们创建一个新的客户端，
     <br/>
     这里的客户端只是在server配置的客户端，之后使用客户端软件链接，所以要与客户端配置一致
    </p>
    <p>
     <img alt="" class="has" height="711" src="https://i-blog.csdnimg.cn/blog_migrate/a9f933940f6886887a854344e8e97aa6.png" width="1007"/>
    </p>
    <p>
     创建好的客户端是这样的，status为offline，因为客户端还没链接
     <br/>
     这里vkey=xxxxx这个要记下来（之后配置客户端会使用）
    </p>
    <p>
     <img alt="" class="has" height="306" src="https://i-blog.csdnimg.cn/blog_migrate/9c889fd053eef6af11bdeb7263d96bb8.png" width="1200"/>
    </p>
    <p>
     客户端配置
     <br/>
     Windows
    </p>
    <p>
     下载客户端
     <br/>
     https://github.com/cnlh/nps/releases/download/v0.23.1/win_amd64_client.tar.gz（windows的）
    </p>
    <p>
     wget https://github.com/cnlh/nps/releases/download/v0.23.1/linux_amd64_client.tar.gz（linux的）
     <br/>
     <br/>
     下载解压后配置vpc.conf，
     <br/>
     将其他配置删除，只保留如图所示的配置
     <br/>
     修改
     <br/>
     server_addr为VPS的公网ip和dashboard的默认客户端链接端口
     <br/>
     vkey为server网页上新建的客户端的vkey
    </p>
    <p>
     server_addr=server_IP:8024
     <br/>
     conn_type=tcp
     <br/>
     vkey=xxxxxxx
     <br/>
     auto_reconnection=true
     <br/>
     max_conn=1000
     <br/>
     flow_limit=1000
     <br/>
     rate_limit=1000
     <br/>
     basic_username=xxxx
     <br/>
     basic_password=xxxx
     <br/>
     web_username=
     <br/>
     web_password=
     <br/>
     crypt=true
     <br/>
     compress=true
    </p>
    <p>
     <img alt="" class="has" height="723" src="https://i-blog.csdnimg.cn/blog_migrate/9f6ce6ecda689f9c8cacdde0e2e720cf.png" width="767"/>
    </p>
    <p>
     配置后./npc 运行该脚本
    </p>
    <p>
     <img alt="" class="has" height="77" src="https://i-blog.csdnimg.cn/blog_migrate/1d29cab4dc07eef105b29dd28d007739.png" width="639"/>
    </p>
    <p>
     链接成功
     <br/>
     <strong>
      两者链接成功后server端中客户端status转为online
     </strong>
    </p>
    <p>
    </p>
    <h3>
     使用测试
    </h3>
    <p>
     <strong>
      创建tcp tunnel
     </strong>
     <br/>
     这里使用内网router配置网页做测试
    </p>
    <p>
     <img alt="" class="has" height="396" src="https://i-blog.csdnimg.cn/blog_migrate/6761327bd5401668da5eb00c36098aed.png" width="1200"/>
    </p>
    <p>
     点击新增
     <br/>
     这里我的router内网ip为192.168.1.1
    </p>
    <p>
     <img alt="" class="has" height="578" src="https://i-blog.csdnimg.cn/blog_migrate/4d4ed12651cd0fb967712a7fa0727127.png" width="969"/>
    </p>
    <p>
     点击保存完成隧道创建
    </p>
    <p>
     <img alt="" class="has" height="519" src="https://i-blog.csdnimg.cn/blog_migrate/4476b34cb0acdb3c03016c4a62e0276d.png" width="1200"/>
    </p>
    <p>
     <strong>
      访问测试
     </strong>
     <br/>
     访问server_ip:9001
     <br/>
     成功访问到内网router配置网页
    </p>
    <p>
     <img alt="" class="has" height="746" src="https://i-blog.csdnimg.cn/blog_migrate/0b1d7a292ed22c60ef4ead80e1acb145.png" width="1200"/>
    </p>
    <p>
    </p>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f71715f33383635363834312f:61727469636c652f64657461696c732f313033373839353235" class_="artid" style="display:none">
 </p>
</div>


