---
layout: post
title: "Notematlab中调用java类或运行java"
date: 2021-03-23 00:55:13 +0800
description: "摘要matlab中可以调用java程序或者自己写的工具类。一般情况下可以直接动态添加java类的cl"
keywords: "matlab调用java"
categories: ['Matlab']
tags: ['Matlab', 'Java', 'Class']
artid: "65448665"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=65448665
    alt: "Notematlab中调用java类或运行java"
render_with_liquid: false
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     [Note]matlab中调用java类或运行java
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-github-gist" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h3 id="摘要">
     <em>
      摘要
     </em>
    </h3>
    <p>
     <em>
      matlab中可以调用java程序或者自己写的工具类。一般情况下可以直接动态添加java类的class文件。但是对于一些自己编写的有依赖的类，例如一个ExcelUtil类调用了POI的jar包，这样添加起来就十分麻烦，我也没有找到方法添加，并且成功创建类对象==。但是可以直接把自己写的类或者项目导成jar包，把依赖的jar包也添加到matlab中就行了。
     </em>
    </p>
    <hr/>
    <p>
     <strong>
      <font color="red">
       下面三个方法需不需要重启matlab我没有过多深究，建议设置完重启一下。我设置完是后重启的，也不尽然，比如……往下看
      </font>
     </strong>
    </p>
    <hr/>
    <h3 id="方法一添加动态路径">
     <strong>
      方法一：添加动态路径
     </strong>
    </h3>
    <p>
     1、matlab中可调用的java类相关的文件（jar包）一般存放在java class path中。在matlab中输入命令：
    </p>
    <pre class="prettyprint"><code class="hljs">javaclasspath</code></pre>
    <p>
     可以查看所有的路径。其中路径分静态路径和动态路径。
    </p>
    <p>
     （静态java路径部分结果）
    </p>
    <pre class="prettyprint"><code class="hljs tex">静态 JAVA 路径

    D:<span class="hljs-command">\MATLAB</span> 2014a<span class="hljs-command">\java</span><span class="hljs-command">\patch</span>                                                       
    D:<span class="hljs-command">\MATLAB</span> 2014a<span class="hljs-command">\java</span><span class="hljs-command">\jarext</span><span class="hljs-command">\AnimatedTransitions</span>.jar                              
    D:<span class="hljs-command">\MATLAB</span> 2014a<span class="hljs-command">\java</span><span class="hljs-command">\jarext</span><span class="hljs-command">\ant</span>.jar                                              
    D:<span class="hljs-command">\MATLAB</span> 2014a<span class="hljs-command">\java</span><span class="hljs-command">\jarext</span><span class="hljs-command">\ant</span>-launcher.jar                                     
    D:<span class="hljs-command">\MATLAB</span> 2014a<span class="hljs-command">\java</span><span class="hljs-command">\jarext</span><span class="hljs-command">\antlr</span>.jar                                            
    D:<span class="hljs-command">\MATLAB</span> 2014a<span class="hljs-command">\java</span><span class="hljs-command">\jarext</span><span class="hljs-command">\felix</span>.jar                                            
    D:<span class="hljs-command">\MATLAB</span> 2014a<span class="hljs-command">\java</span><span class="hljs-command">\jarext</span><span class="hljs-command">\scr</span>.jar                                              
    D:<span class="hljs-command">\MATLAB</span> 2014a<span class="hljs-command">\java</span><span class="hljs-command">\jarext</span><span class="hljs-command">\axis</span>2<span class="hljs-command">\activation</span>.jar                                 
    D:<span class="hljs-command">\MATLAB</span> 2014a<span class="hljs-command">\java</span><span class="hljs-command">\jarext</span><span class="hljs-command">\axis</span>2<span class="hljs-command">\axiom</span>-api.jar                                  
    D:<span class="hljs-command">\MATLAB</span> 2014a<span class="hljs-command">\java</span><span class="hljs-command">\jarext</span><span class="hljs-command">\axis</span>2<span class="hljs-command">\axiom</span>-impl.jar  </code></pre>
    <p>
     把
     <font color="red">
      自己写的类
     </font>
     的class文件保存到一个文件夹，然后运行下面的代码，添加动态路径。
    </p>
    <pre class="prettyprint"><code class="hljs tex">javaaddpath('D:<span class="hljs-command">\MATLAB</span> 2014a<span class="hljs-command">\MyJavaClass</span><span class="hljs-command">\bin</span>')</code></pre>
    <p>
     显示结果（成功）：
    </p>
    <pre class="prettyprint"><code class="hljs tex">动态 JAVA 路径

    D:<span class="hljs-command">\MATLAB</span> 2014a<span class="hljs-command">\MyJavaClass</span><span class="hljs-command">\bin</span></code></pre>
    <p>
     之后就可以创建目标类的实例对象了。
     <br/>
     <strong>
      <font color="red">
       注意！！
      </font>
     </strong>
     <br/>
     <strong>
      <font color="red">
       但是这个方法是一次性的。如果第二次用就要再次添加路径了！这个方法重启？:-D
      </font>
     </strong>
    </p>
    <h3 id="方法二添加静态路径">
     <strong>
      方法二：添加静态路径
     </strong>
    </h3>
    <p>
     其实上面的系统路径下有一个文件文件classpath.txt。此文件定义了matlab环境下可以直接引用jar包（静态路径）。一般这个文件的完整路径为：
    </p>
    <pre class="prettyprint"><code class="hljs tex"><span class="hljs-special">[</span>matlabroot'<span class="hljs-command">\toolbox</span><span class="hljs-command">\local</span><span class="hljs-command">\classpath</span>.txt'<span class="hljs-special">]</span></code></pre>
    <p>
     也可以在matlab中直接输入这个命令编辑这个文件。
    </p>
    <pre class="prettyprint"><code class="hljs axapta"><span class="hljs-keyword">edit</span> classpath.txt</code></pre>
    <p>
     之后把
     <font color="red">
      自己写好类或项目创建而成的jar包和依赖的jar包
     </font>
     所在的路径写入文件最后就行。这里的ExcelTool.jar是我自己写的。而下面的5个jar包是调用POI需要的依赖包。要写上包名！
    </p>
    <pre class="prettyprint"><code class="hljs tex">D:<span class="hljs-command">\MATLAB</span> 2014a<span class="hljs-command">\MyJavaClass</span><span class="hljs-command">\jar</span><span class="hljs-command">\ExcelTool</span>.jar
D:<span class="hljs-command">\MATLAB</span> 2014a<span class="hljs-command">\MyJavaClass</span><span class="hljs-command">\jar</span><span class="hljs-command">\dom</span>4j-1.6.1.jar
D:<span class="hljs-command">\MATLAB</span> 2014a<span class="hljs-command">\MyJavaClass</span><span class="hljs-command">\jar</span><span class="hljs-command">\poi</span>-3.8-20120326.jar
D:<span class="hljs-command">\MATLAB</span> 2014a<span class="hljs-command">\MyJavaClass</span><span class="hljs-command">\jar</span><span class="hljs-command">\poi</span>-ooxml-3.8-20120326.jar
D:<span class="hljs-command">\MATLAB</span> 2014a<span class="hljs-command">\MyJavaClass</span><span class="hljs-command">\jar</span><span class="hljs-command">\poi</span>-ooxml-schemas-3.8-20120326.jar
D:<span class="hljs-command">\MATLAB</span> 2014a<span class="hljs-command">\MyJavaClass</span><span class="hljs-command">\jar</span><span class="hljs-command">\xmlbeans</span>-2.3.0.jar</code></pre>
    <p>
     结果可行，成功创建类对象。这种方法除非删了路径或者jar包，不需要再次添加。
    </p>
    <h3 id="方法三通过java加载机制添加jar包到路径">
     <strong>
      方法三：通过java加载机制，添加jar包到路径
     </strong>
    </h3>
    <p>
     1、把自己写好的类导出成为jar包。
     <br/>
     2、matlab中运行下面代码
    </p>
    <pre class="prettyprint"><code class="hljs scss"><span class="hljs-function">disp(java.lang.System.<span class="hljs-function">getProperty(<span class="hljs-string">'java.ext.dirs'</span>)</span>)</span></code></pre>
    <p>
     显示结果：
    </p>
    <pre class="prettyprint"><code class="hljs tex">D:<span class="hljs-command">\MATLAB</span> 2014a<span class="hljs-command">\sys</span><span class="hljs-command">\java</span><span class="hljs-command">\jre</span><span class="hljs-command">\win</span>64<span class="hljs-command">\jre</span><span class="hljs-command">\lib</span><span class="hljs-command">\ext</span>;C:<span class="hljs-command">\WINDOWS</span><span class="hljs-command">\Sun</span><span class="hljs-command">\Java</span><span class="hljs-command">\lib</span><span class="hljs-command">\ext</span>
</code></pre>
    <p>
     3、把我们的jar包放在第一个路径下，如果有其他依赖的jar包，一并放进来。然后就可以创建java类对象了。
     <br/>
     在matlab命令行中输入实例化类的代码：
    </p>
    <pre class="prettyprint"><code class="hljs avrasm">excelOper=<span class="hljs-keyword">com</span><span class="hljs-preprocessor">.excel</span><span class="hljs-preprocessor">.util</span><span class="hljs-preprocessor">.ExcelOperate</span><span class="hljs-comment">;</span>
</code></pre>
    <p>
     左下角工作区已经有excelOper对象成功创建。
     <br/>
     <strong>
      <font color="red">
       ！！！
      </font>
     </strong>
     <br/>
     <strong>
      <font color="red">
       这个方法保存到的jar包并不是静态路径。而是通过java的类加载机制，自己不是太懂。（大概查了一下是这样）先记下，写完毕设在仔细研究一下。先记录。
      </font>
     </strong>
     <br/>
     <strong>
      <font color="red">
       ！！！
      </font>
     </strong>
    </p>
    <hr/>
    <blockquote>
     <p>
      毕设~~~~ （+_+）
     </p>
    </blockquote>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f626c:6f672e6373646e2e6e65742f53696c656e744865617274445a:2f61727469636c652f64657461696c732f3635343438363635" class_="artid" style="display:none">
 </p>
</div>


