---
layout: post
title: "在S3C2410的6寸LCD驱动在linux2.6上的移植"
date: 2013-07-01 20:09:05 +0800
description: "在S3C2410的6寸LCD驱动在linux2.6上的移植----Figo  2007.11我的LC"
keywords: "6寸 lcd"
categories: ['']
tags: ['平台', '三星', 'Struct', 'Linux', 'Io', 'C']
artid: "3278502"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=3278502
    alt: "在S3C2410的6寸LCD驱动在linux2.6上的移植"
render_with_liquid: false
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     在S3C2410的6寸LCD驱动在linux2.6上的移植
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <p align="center" class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; TEXT-ALIGN: center; mso-pagination: widow-orphan">
     <b style="mso-bidi-font-weight: normal">
      <span style="FONT-SIZE: 14pt; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-bidi-font-family: 宋体">
       <font color="#000000">
        在
        <span lang="EN-US">
         S 
      
     
       3C 
     2410
        </span>
        的
        <span lang="EN-US">
         6
        </span>
        寸
        <span lang="EN-US">
         LCD
        </span>
        驱动在
        <span lang="EN-US">
         linux2.6
        </span>
        上的移植
        <span lang="EN-US">
        </span>
       </font>
      </span>
     </b>
    </p>
    <p align="center" class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; TEXT-ALIGN: center; mso-pagination: widow-orphan">
     <span lang="EN-US" style="FONT-FAMILY: 宋体; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-bidi-font-family: 宋体">
      <font size="3">
       <font color="#000000">
        ----Figo
        <span style="mso-spacerun: yes">
        </span>
        2007.11
       </font>
      </font>
     </span>
    </p>
    <p align="left" class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; TEXT-ALIGN: left; mso-pagination: widow-orphan">
     <span style="FONT-FAMILY: 宋体; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-bidi-font-family: 宋体">
      <font size="3">
       <font color="#000000">
        我的
        <span lang="EN-US">
         LCD
        </span>
        是
        <span lang="EN-US">
         12bit
        </span>
        的
        <span lang="EN-US">
         640*480
        </span>
        的
        <span lang="EN-US">
         TFT
        </span>
        ，硬件平台是阳初
        <span lang="EN-US">
         2410
        </span>
        板子，在
        <span lang="EN-US">
         linux- 
     
       2.6.14
        </span>
        的移植结果如下：
        <span lang="EN-US">
        </span>
       </font>
      </font>
     </span>
    </p>
    <p align="left" class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; TEXT-ALIGN: left; mso-pagination: widow-orphan">
     <span lang="EN-US" style="FONT-FAMILY: 宋体; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-bidi-font-family: 宋体">
      <font color="#000000" size="3">
      </font>
     </span>
    </p>
    <p align="left" class="MsoNormal" style="MARGIN: 0cm 0cm 0pt 18pt; TEXT-INDENT: -18pt; TEXT-ALIGN: left; tab-stops: list 18.0pt; mso-list: l0 level1 lfo1; mso-layout-grid-align: none">
     <span lang="EN-US" style="FONT-FAMILY: 宋体; mso-bidi-font-family: 宋体">
      <span style="mso-list: Ignore">
       <font color="#000000">
        <font size="3">
         1.
        </font>
        <span style="FONT: 7pt 'Times New Roman'">
        </span>
       </font>
      </span>
     </span>
     <span style="FONT-FAMILY: 宋体; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-bidi-font-family: 宋体">
      <font color="#000000" size="3">
       在
       <span lang="EN-US">
        mach-smdk2410.c
       </span>
       中添加平台信息
       <span lang="EN-US">
        .
       </span>
       主要是设置一个结构体
      </font>
      <span lang="EN-US">
       <font color="#000000" size="3">
        .
        <br style="mso-special-character: line-break"/>
        <br style="mso-special-character: line-break"/>
       </font>
      </span>
     </span>
     <span lang="EN-US" style="COLOR: #ff0102; FONT-FAMILY: Verdana">
     </span>
    </p>
    <p align="left" class="MsoNormal" style="MARGIN: 0cm 0cm 0pt 15.75pt; TEXT-ALIGN: left; mso-layout-grid-align: none; mso-para-margin-left: 1.5gd">
     <span style="FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">
      <font color="#000000" size="3">
       添加头文件
      </font>
     </span>
     <span lang="EN-US" style="FONT-SIZE: 6.5pt; FONT-FAMILY: Verdana">
      <br/>
     </span>
     <span lang="EN-US" style="FONT-FAMILY: Verdana">
      <font size="3">
       <font color="#000000">
        #include &lt;asm/arch/fb.h&gt;
       </font>
      </font>
     </span>
    </p>
    <p align="left" class="MsoNormal" style="MARGIN: 0cm 0cm 0pt 15.75pt; TEXT-INDENT: -10.5pt; TEXT-ALIGN: left; mso-layout-grid-align: none; mso-para-margin-left: .5gd; mso-char-indent-count: -1.0">
     <span lang="EN-US" style="FONT-FAMILY: 宋体; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-bidi-font-family: 宋体">
      <br/>
      <font color="#000000" size="3">
       static struct s 
   
     3c 
   2410fb_mach_info smdk2410_lcd_platdata = {
       <!-- -->
       <br/>
       .width= 640,
       <br/>
       .height= 480,
       <br/>
       .xres = {
       <!-- -->
       <br/>
       .defval= 640,
       <br/>
       .min= 640,
       <br/>
       .max= 640,
       <br/>
       },
       <br/>
       .yres = {
       <!-- -->
       <br/>
       .defval= 480,
       <br/>
       .min= 480,
       <br/>
       .max= 480,
       <br/>
       },
       <br/>
       .bpp = {
       <!-- -->
       <br/>
       .defval= 16,
       <br/>
       .min= 16,
       <br/>
       .max= 16,
       <br/>
       },
       <br/>
       .regs = {
       <!-- -->
       <br/>
      </font>
     </span>
     <span lang="EN-US" style="FONT-SIZE: 10pt; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-bidi-font-family: 宋体; mso-hansi-font-family: 'Times New Roman'">
      <font color="#000000">
       <span style="mso-tab-count: 2">
       </span>
       .lcdcon1= S 
   
     3C 
   2410_LCDCON1_TFT16BPP | S 
   
     3C 
   2410_LCDCON1_TFT | S 
   
     3C 
   2410_LCDCON1_CLKVAL(4),
      </font>
     </span>
    </p>
    <p align="left" class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; TEXT-ALIGN: left; mso-layout-grid-align: none">
     <span lang="EN-US" style="FONT-SIZE: 10pt; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-bidi-font-family: 宋体; mso-hansi-font-family: 'Times New Roman'">
      <font color="#000000">
       <span style="mso-tab-count: 2">
       </span>
       .lcdcon2= S 
   
     3C 
   2410_LCDCON2_LINEVAL(479) | S 
   
     3C 
   2410_LCDCON2_VBPD(18) | S 
   
     3C 
   2410_LCDCON2_VFPD(10) |
       <span style="mso-tab-count: 1">
       </span>
       <span style="mso-tab-count: 2">
       </span>
       S 
   
     3C 
   2410_LCDCON2_VSPW(14),
      </font>
     </span>
    </p>
    <p align="left" class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; TEXT-ALIGN: left; mso-layout-grid-align: none">
     <span lang="EN-US" style="FONT-SIZE: 10pt; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-bidi-font-family: 宋体; mso-hansi-font-family: 'Times New Roman'">
      <font color="#000000">
       <span style="mso-tab-count: 2">
       </span>
       .lcdcon3= S 
   
     3C 
   2410_LCDCON3_HOZVAL(639) | S 
   
     3C 
   2410_LCDCON3_HBPD(6) | S 
   
     3C 
   2410_LCDCON3_HFPD(15),
      </font>
     </span>
    </p>
    <p align="left" class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; TEXT-ALIGN: left; mso-layout-grid-align: none">
     <span lang="EN-US" style="FONT-SIZE: 10pt; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-bidi-font-family: 宋体; mso-hansi-font-family: 'Times New Roman'">
      <font color="#000000">
       <span style="mso-tab-count: 2">
       </span>
       .lcdcon4= S 
   
     3C 
   2410_LCDCON4_HSPW(28) | S 
   
     3C 
   2410_LCDCON4_MVAL(13),
      </font>
     </span>
    </p>
    <p align="left" class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; TEXT-ALIGN: left; mso-layout-grid-align: none">
     <span lang="EN-US" style="FONT-SIZE: 10pt; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-bidi-font-family: 宋体; mso-hansi-font-family: 'Times New Roman'">
      <font color="#000000">
       <span style="mso-tab-count: 2">
       </span>
       .lcdcon5= S 
   
     3C 
   2410_LCDCON5_FRM565 | S 
   
     3C 
   2410_LCDCON5_HWSWP | S 
   
     3C 
   2410_LCDCON5_INVVCLK|S 
   
     3C 
   2410_LCDCON5_INVVLINE|S 
   
     3C 
   2410_LCDCON5_INVVFRAME|S 
   
     3C 
   2410_LCDCON5_PWREN,
      </font>
     </span>
    </p>
    <p align="left" class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; TEXT-ALIGN: left; mso-pagination: widow-orphan">
     <font size="3">
      <font color="#000000">
       <span lang="EN-US" style="FONT-FAMILY: 宋体; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-bidi-font-family: 宋体">
        },
        <br/>
        .gpcup= 0xFFFFFFFF,
        <br/>
        .gpcup_mask= 0xFFFFFFFF,
        <br/>
        .gpccon= 0xaaaaaaaa,
        <br/>
        .gpccon_mask= 0xFFFFFFFF,
        <br/>
        .gpdup= 0xFFFFFFFF,
        <br/>
        .gpdup_mask= 0xFFFFFFFF,
        <br/>
        .gpdcon= 0xaaaaaaaa,
        <br/>
        .gpdcon_mask= 0xFFFFFFFF,
        <br/>
        .lpcsel= 0x00,
        <br/>
        };
        <br/>
       </span>
       <span style="FONT-FAMILY: 宋体; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-bidi-font-family: 宋体">
        这部分设置是关键
        <span lang="EN-US">
         ,
        </span>
        要针对自己的
        <span lang="EN-US">
         lcd
        </span>
        修改
        <span lang="EN-US">
         .
        </span>
       </span>
      </font>
     </font>
    </p>
    <p align="left" class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; TEXT-ALIGN: left; mso-pagination: widow-orphan; mso-margin-top-alt: auto; mso-margin-bottom-alt: auto">
     <span style="FONT-FAMILY: 宋体; mso-bidi-font-size: 10.5pt; mso-font-kerning: 0pt; mso-bidi-font-family: 宋体">
      <font color="#000000" size="3">
       然后
       <span lang="EN-US">
        ,
       </span>
       在
       <span lang="EN-US">
        smdk2410_map_io(void)
       </span>
       中添加
      </font>
      <span lang="EN-US">
       <br/>
       <font size="3">
        <font color="#000000">
         set_s 
     
       3c 
     2410fb_info(&amp;smdk2410_lcd_platdata);
        </font>
       </font>
      </span>
     </span>
    </p>
    <p align="left" class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; TEXT-ALIGN: left; mso-layout-grid-align: none">
     <font size="3">
      <font color="#000000">
       <span lang="EN-US" style="mso-bidi-font-size: 10.5pt">
        2
       </span>
       <span style="FONT-FAMILY: 宋体; mso-bidi-font-size: 10.5pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">
        上面的结构体中
       </span>
       <span lang="EN-US" style="mso-bidi-font-size: 10.5pt">
        reg
       </span>
       <span style="FONT-FAMILY: 宋体; mso-bidi-font-size: 10.5pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">
        部分的赋值是非常重要的，其中
       </span>
      </font>
     </font>
     <span style="FONT-SIZE: 10pt; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-bidi-font-family: 宋体; mso-hansi-font-family: 'Times New Roman'; mso-ansi-language: ZH-CN">
      <font color="#000000">
       <span style="mso-tab-count: 2">
       </span>
      </font>
     </span>
    </p>
    <p align="left" class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; TEXT-ALIGN: left; mso-layout-grid-align: none">
     <span style="FONT-SIZE: 10pt; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-bidi-font-family: 宋体; mso-hansi-font-family: 'Times New Roman'; mso-ansi-language: ZH-CN">
      <font color="#000000">
       .lcdcon2= S 
   
     3C 
   2410_LCDCON2_LINEVAL(479) | S 
   
     3C 
   2410_LCDCON2_VBPD(18) | S 
   
     3C 
   2410_LCDCON2_VFPD(10) |
       <span style="mso-tab-count: 2">
       </span>
       <span style="mso-tab-count: 1">
       </span>
       S 
   
     3C 
   2410_LCDCON2_VSPW(14),
      </font>
     </span>
    </p>
    <p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt">
     <font color="#000000">
      <span style="FONT-FAMILY: 宋体; mso-bidi-font-size: 10.5pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">
       <font size="3">
        的作用更为明显，开始不是用这些值时总是出现问题，屏幕的上面一部分出现在屏幕的下面，这个问题的产生就是因为这行值没有取正确，按照上面的取值即可成功。但是出现了另一个问题，就是屏幕抖动得非常厉害，这是因为帧频率过低，可以调低
       </font>
      </span>
      <span style="FONT-SIZE: 10pt; FONT-FAMILY: 宋体; mso-font-kerning: 0pt; mso-bidi-font-family: 宋体; mso-hansi-font-family: 'Times New Roman'; mso-ansi-language: ZH-CN">
       .lcdcon1= S 
   
     3C 
   2410_LCDCON1_TFT16BPP | S 
   
     3C 
   2410_LCDCON1_TFT | S 
   
     3C 
   2410_LCDCON1_CLKVAL(4),中CLKVAL的值为1，抖动消失了。
      </span>
      <span lang="EN-US" style="mso-bidi-font-size: 10.5pt">
      </span>
     </font>
    </p>
    <p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt">
     <font size="3">
      <font color="#000000">
       <span style="FONT-FAMILY: 宋体; mso-bidi-font-size: 10.5pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">
        这些寄存器的值在三星的说明书上看似并不影响
       </span>
       <span lang="EN-US" style="mso-bidi-font-size: 10.5pt">
        LCD
       </span>
       <span style="FONT-FAMILY: 宋体; mso-bidi-font-size: 10.5pt; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">
        的显示，但是实际上却影响很大，如果屏幕的显示出了问题二其他方面找不到答案时应该好好从这些值上考虑，深入考虑这些寄存值的意义
       </span>
       <span lang="EN-US" style="mso-bidi-font-size: 10.5pt">
       </span>
      </font>
     </font>
    </p>
    <p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt">
     <span lang="EN-US" style="mso-bidi-font-size: 10.5pt">
      <font color="#000000" size="3">
      </font>
     </span>
    </p>
    <p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt">
     <font color="#000000">
      <span lang="EN-US" style="mso-bidi-font-size: 10.5pt">
       <font size="3">
        3
       </font>
      </span>
      <span style="FONT-SIZE: 13.5pt; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">
       去除１０分钟左右自动关闭显示的程序（实验时可以这么做，我猜应该是节能作用，并未深究。）。
      </span>
     </font>
     <span lang="EN-US" style="FONT-SIZE: 6.5pt; FONT-FAMILY: Verdana">
      <br/>
      <br/>
     </span>
     <font color="#000000">
      <span lang="EN-US" style="FONT-FAMILY: Verdana">
       <font size="3">
        copy from
       </font>
      </span>
      <span style="FONT-SIZE: 10pt; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">
       《
      </span>
      <span lang="EN-US" style="FONT-SIZE: 10pt; FONT-FAMILY: Verdana">
       2410 lcd(ltv350)
      </span>
      <span style="FONT-SIZE: 10pt; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">
       驱动在 
   
     ２
       <span lang="EN-US" style="FONT-FAMILY: Verdana">
        .
       </span>
       ６
       <span lang="EN-US" style="FONT-FAMILY: Verdana">
        .
       </span>
       １４ 
   下的移植经历
      </span>
      <span style="FONT-SIZE: 6.5pt; FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">
       》：
      </span>
     </font>
     <span lang="EN-US" style="FONT-SIZE: 6.5pt; FONT-FAMILY: Verdana">
      <br/>
      <br/>
     </span>
     <font size="3">
      <font color="#000000">
       <span lang="EN-US" style="FONT-FAMILY: Verdana">
        “
       </span>
       <span style="FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">
        按
       </span>
       <span lang="EN-US" style="FONT-FAMILY: Verdana">
        seigpao
       </span>
       <span style="FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">
        大侠的做法，注释掉
       </span>
       <span lang="EN-US" style="FONT-FAMILY: Verdana">
        drivers/char/vt.c
       </span>
       <span style="FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">
        的
       </span>
       <span lang="EN-US" style="FONT-FAMILY: Verdana">
        blank_screen_t(unsigned long dummy)
       </span>
       <span style="FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">
        的函数内容，否则，
       </span>
       <span lang="EN-US" style="FONT-FAMILY: Verdana">
        lcd
       </span>
       <span style="FONT-FAMILY: 宋体; mso-ascii-font-family: Verdana; mso-hansi-font-family: Verdana">
        会在１０分钟左右关掉显示。
       </span>
       <span lang="EN-US" style="FONT-FAMILY: Verdana">
        “
       </span>
      </font>
     </font>
    </p>
   </div>
  </div>
 </article>
 <p alt="687474:70733a2f2f626c6f672e6373646e2e6e65742f6669676f6c71:742f61727469636c652f64657461696c732f33323738353032" class_="artid" style="display:none">
 </p>
</div>


