---
layout: post
title: "springboot-忽略接收请求中的参数"
date: 2022-05-09 21:43:44 +0800
description: "springboot 忽略接收请求中的参数一、场景说明在一些开发场景中，特别是前后端分开开发的场景中"
keywords: "springboot接收请求时忽略某字段"
categories: ['未分类']
tags: ['Spring', 'Spring', 'Java', 'Boot']
artid: "124676153"
image:
  path: https://api.vvhan.com/api/bing?rand=sj&artid=124676153
  alt: "springboot-忽略接收请求中的参数"
render_with_liquid: false
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     springboot 忽略接收请求中的参数
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <h4>
     <a id="springboot__0">
     </a>
     springboot 忽略接收请求中的参数
    </h4>
    <h5>
     <a id="_1">
     </a>
     一、场景说明
    </h5>
    <p>
     <code>
      在一些开发场景中，特别是前后端分开开发的场景中，由于后端接口采用的VO接收前端请求传递的参数，但是前端开发小伙伴可能会把vo中所有属性不进行过滤就直接调用接口，这样会导致后端api由于不需要某些字段而导致api运行失败，比如：id字段等。
     </code>
    </p>
    <h5>
     <a id="_3">
     </a>
     二、开发环境
    </h5>
    <blockquote>
     <p>
      <strong>
       开发工具：
      </strong>
      IDEA
      <br/>
      <strong>
       开发语言：
      </strong>
      JAVA 1.8
      <br/>
      <strong>
       开发环境：
      </strong>
      Springboot 2.4.13
     </p>
    </blockquote>
    <h5>
     <a id="_8">
     </a>
     三、实现思路
    </h5>
    <ol>
     <li>
      使用Java的注解技术，定义一个ReceiveIgnoreParam注解，作用在Controller的需要忽略接收属性的方法上。
     </li>
     <li>
      通过spring切面编程技术来实现对方法注解的操作，其判断方法参数中是否包含需要忽略的属性，如果存在直接设置为null或者空串
     </li>
    </ol>
    <h5>
     <a id="_13">
     </a>
     四、具体实现
    </h5>
    <ul>
     <li>
      注解类代码
     </li>
    </ul>
    <pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>rewloc<span class="token punctuation">.</span>annotation</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token operator">\*</span><span class="token punctuation">;</span>

<span class="token comment">/\*\*

- 类描述：忽略接收参数 注解
-
- @date 2022/5/9 10:54
- @slogan 设计就是代码，代码就是设计
- @since JDK 8
  _/</span>
  <span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span><span class="token class-name">RetentionPolicy</span><span class="token punctuation">.</span>RUNTIME<span class="token punctuation">)</span>
  <span class="token annotation punctuation">@Documented</span>
  <span class="token annotation punctuation">@Target</span><span class="token punctuation">(</span><span class="token class-name">ElementType</span><span class="token punctuation">.</span>METHOD<span class="token punctuation">)</span>
  <span class="token keyword">public</span> <span class="token annotation punctuation">@interface</span> <span class="token class-name">ReceiveIgnoreParam</span> <span class="token punctuation">{<!-- --></span>
  <span class="token comment">/\*\* 字段名数组 _/</span>
  <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">fieldName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  </code></pre>
  <ul>
  <li>
  切面类代码
  </li>
  </ul>
  <pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>rewloc<span class="token punctuation">.</span>aop</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">cn<span class="token punctuation">.</span>hutool<span class="token punctuation">.</span>core<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">ArrayUtil</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">cn<span class="token punctuation">.</span>hutool<span class="token punctuation">.</span>core<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">BooleanUtil</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>rewloc<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">ReceiveIgnoreParam</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>aspectj<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span><span class="token class-name">ProceedingJoinPoint</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>aspectj<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Around</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>aspectj<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Aspect</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>aspectj<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Pointcut</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>aspectj<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>reflect<span class="token punctuation">.</span></span><span class="token class-name">MethodSignature</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Component</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>reflect<span class="token punctuation">.</span></span><span class="token class-name">Field</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Arrays</span><span class="token punctuation">;</span>

<span class="token comment">/\*\*

- 类描述：忽略接收参数 切面类
-
- @slogan 设计就是代码，代码就是设计
- @since JDK 8
  \*/</span>
  <span class="token annotation punctuation">@Aspect</span>
  <span class="token annotation punctuation">@Component</span>
  <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ReceiveIgnoreParamAop</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> ID <span class="token operator">=</span> <span class="token string">"id"</span><span class="token punctuation">;</span>

      <span class="token comment">/**
       * 方法描述： 切面拦截器
       *
       * @slogan 设计就是代码，代码就是设计
       */</span>
      <span class="token annotation punctuation">@Pointcut</span><span class="token punctuation">(</span><span class="token string">"@annotation(com.rewloc.ReceiveIgnoreParam)"</span><span class="token punctuation">)</span>
      <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">ignoreReceiveParam</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token punctuation">}</span>

      <span class="token comment">/**
       * 方法描述： 忽略属性值拦截处理
       *
       * @param point 环绕通知处理对象
       * @return {@link Object}
       * @slogan 设计就是代码，代码就是设计
       */</span>
      <span class="token annotation punctuation">@Around</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"ignoreReceiveParam()"</span><span class="token punctuation">)</span>
      <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">doAround</span><span class="token punctuation">(</span><span class="token class-name">ProceedingJoinPoint</span> point<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
          <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
              <span class="token comment">// 获取注解信息</span>
              <span class="token class-name">MethodSignature</span> methodSignature <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">MethodSignature</span><span class="token punctuation">)</span> point<span class="token punctuation">.</span><span class="token function">getSignature</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
              <span class="token class-name">ReceiveIgnoreParam</span> ignoreReceiveParam <span class="token operator">=</span> methodSignature<span class="token punctuation">.</span><span class="token function">getMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getAnnotation</span><span class="token punctuation">(</span><span class="token class-name">ReceiveIgnoreParam</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
              <span class="token comment">// 获取方法的参数</span>
              <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args <span class="token operator">=</span> point<span class="token punctuation">.</span><span class="token function">getArgs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
              <span class="token comment">// 循环返回参数，</span>
              <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Object</span> arg <span class="token operator">:</span> args<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                  <span class="token comment">// 对需要忽略的属性进行null赋值 </span>
                  <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span>ignoreReceiveParam<span class="token punctuation">.</span><span class="token function">fieldName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>field <span class="token operator">-&gt;</span> <span class="token punctuation">{<!-- --></span>
                      <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
                          <span class="token comment">// 清空忽略属性的值</span>
                          <span class="token function">cleanValue</span><span class="token punctuation">(</span>arg<span class="token punctuation">,</span> field<span class="token punctuation">)</span><span class="token punctuation">;</span>
                      <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                      <span class="token punctuation">}</span>
                  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
              <span class="token punctuation">}</span>
              <span class="token keyword">return</span> point<span class="token punctuation">.</span><span class="token function">proceed</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Throwable</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
              <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token string">"系统繁忙，请稍后再试!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>

      <span class="token comment">/**
       * 方法描述： 情况属性的值
       *
       * @param obj       参数对象
       * @param fieldName 字段名称
       * @return {@link Object}
       * @slogan 设计就是代码，代码就是设计
       */</span>
      <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">cleanValue</span><span class="token punctuation">(</span><span class="token class-name">Object</span> obj<span class="token punctuation">,</span> <span class="token class-name">String</span> fieldName<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IllegalAccessException</span> <span class="token punctuation">{<!-- --></span>
          <span class="token comment">// 获取参数对象</span>
          <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> aClass <span class="token operator">=</span> obj<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token comment">// 获取class中的所有字段</span>
          <span class="token class-name">Field</span><span class="token punctuation">[</span><span class="token punctuation">]</span> fields <span class="token operator">=</span> aClass<span class="token punctuation">.</span><span class="token function">getDeclaredFields</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Field</span> field <span class="token operator">:</span> fields<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
              <span class="token comment">// 如果是需要忽略的字段，赋null值</span>
              <span class="token keyword">if</span> <span class="token punctuation">(</span>fieldName<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>field<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                  field<span class="token punctuation">.</span><span class="token function">setAccessible</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                  field<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
              <span class="token punctuation">}</span>
          <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>

  <span class="token punctuation">}</span>
  </code></pre>
  <ul>
  <li>
  vo 类
  </li>
  </ul>
  <pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>rewloc<span class="token punctuation">.</span>vo</span>

<span class="token keyword">import</span> <span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">Data</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Data</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ReceiveIgnoreParamVO</span> <span class="token punctuation">{<!-- --></span>
<span class="token keyword">private</span> <span class="token class-name">String</span> id<span class="token punctuation">;</span>
<span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>
<span class="token keyword">private</span> <span class="token class-name">String</span> sex<span class="token punctuation">;</span>
<span class="token keyword">private</span> <span class="token keyword">int</span> age<span class="token punctuation">;</span>
<span class="token keyword">private</span> <span class="token class-name">String</span> birthdate<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<ul>
<li>
注解使用
</li>
</ul>
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>rewloc<span class="token punctuation">.</span>web</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">PostMapping</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RequestMapping</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RestController</span><span class="token punctuation">;</span>

<span class="token comment">/\*\*

- 类描述：忽略接收参数 controller 类
-
- @slogan 设计就是代码，代码就是设计
- @since JDK 8
_/</span>
<span class="token annotation punctuation">@RestController</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/receive/ignoreParam"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ReceiveIgnoreParamController</span> <span class="token punctuation">{<!-- --></span>
<span class="token comment">/\*\*
_ 分页获取查询列表 \*
_ @param vo 接收查询参数的 VO 对象
_ @return Result
\*/</span>
<span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">"/hello"</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@ReceiveIgnoreParam</span><span class="token punctuation">(</span>fieldName <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">"id"</span><span class="token punctuation">,</span> <span class="token string">"name"</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">selectPage</span><span class="token punctuation">(</span><span class="token class-name">ReceiveIgnoreParamVO</span> vo<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
<span class="token comment">// 将当前 vo 对象返回</span>
<span class="token keyword">return</span> <span class="token class-name">JSONObject</span><span class="token punctuation">.</span><span class="token function">toJSONString</span><span class="token punctuation">(</span>vo<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h5>
<a id="_174">
</a>
五、总结
</h5>
<p>
只要注解和 spring 切面结合可以做很多事情。
</p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="6874747073:3a2f2f626c6f672e6373646e2e6e65742f6c6870333030302f:61727469636c652f64657461696c732f313234363736313533" class_="artid" style="display:none">
 </p>
</div>
