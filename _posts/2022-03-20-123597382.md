---
layout: post
title: "一文图解前端WebSocket-实时通信"
date: 2022-03-20 13:03:28 +0800
description: "文章浏览阅读6.9k次，点赞14次，本文介绍了WebSocket作为全双工通信协议的基础概念、优势，"
keywords: "websocket图解"
categories: ['后台管理系统']
tags: ['实时通信', '协议', 'Websocket']
artid: "123597382"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=123597382
    alt: "一文图解前端WebSocket-实时通信"
render_with_liquid: false
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     一文图解前端WebSocket 实时通信
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-tomorrow-night" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/529103b3602e9c0ac4b69a42d2410544.png#pic_center"/>
    </p>
    <h3>
     <a id="__1">
     </a>
     💌 作者简介
    </h3>
    <ol>
     <li>
      📖 个人介绍：小伙伴们，大家好！我是水香木鱼，【
      <code>
       前端领域创作者
      </code>
      】😜
     </li>
     <li>
      📜 CSDN主页：
      <a href="https://blog.csdn.net/weixin_48337566?type=blog">
       水香木鱼
      </a>
     </li>
     <li>
      📑 个人博客：
      <a href="https://shadow.org.cn" rel="nofollow">
       陈春波
      </a>
     </li>
     <li>
      🎨 系列专栏：
      <a href="https://blog.csdn.net/weixin_48337566/category_11790903.html">
       网络通信
      </a>
     </li>
     <li>
      🌹 一键四连：关注💋+点赞👍+收藏⭐+留言📝
     </li>
     <li>
      📢 人生箴言：即使没有万全准备，也要勇敢迈出第一步。
     </li>
    </ol>
    <hr/>
    <blockquote>
     <p>
      在
      <code>
       前端领域
      </code>
      ，
      <code>
       实时通信 WebSocket 是我们必须掌握的其中一个技术点
      </code>
      ，今天木鱼和大家通过案例，
      <code>
       快速的入门WebSocket 实时通信
      </code>
      。一🏍 届时我将代码部分，按照先后顺序，给大家通过文章的形式去分析。
     </p>
    </blockquote>
    <p>
     木鱼也是刚刚开始了解
     <code>
      WebSocket
     </code>
     ,如有不对的地方，请谅解。留言区，时刻恭候大家，我们共同迈进通信工程。
    </p>
    <p>
     为了方便大家学习，本文只展示
     <code>
      UI组件库
     </code>
     、
     <code>
      逻辑部分
     </code>
     |
     <code>
      样式部分 不做展示
     </code>
     小伙伴们可以去 👉
     <a href="https://gitee.com/chunbochen/web-socket-demo" rel="nofollow">
      案例源码
     </a>
     获取。
    </p>
    <hr/>
    <h3>
     <a id="1WebSocket_21">
     </a>
     1、什么是WebSocket？
    </h3>
    <blockquote>
     <p>
      根据百科给出的解释是：
     </p>
     <ul>
      <li>
       WebSocket是一种在
       <code>
        单个TCP连接上
       </code>
       进行
       <code>
        全双工通信
       </code>
       的协议。
      </li>
      <li>
       WebSocket通信协议于2011年被IETF定为标准RFC 6455，并由RFC7936补充规范。
      </li>
      <li>
       WebSocket API也被
       <code>
        W3C定为标准
       </code>
       。
      </li>
      <li>
       WebSocket使得客户端和服务器之间的数据交换变得更加简单，允许服务端主动向客户端推送数据。
      </li>
     </ul>
    </blockquote>
    <p>
     在WebSocket API中，浏览器和服务器只需要完成一次握手，两者之间就直接可以创建持久性的连接，并进行双向数据传输。
    </p>
    <p>
     其实一句话就可以做出概括：
     <code>
      它就是一种网络通信协议
     </code>
     ，很多高级功能都需要它。
    </p>
    <h3>
     <a id="2_WebSocket_32">
     </a>
     2、为什么需要 WebSocket？
    </h3>
    <p>
     初次接触 WebSocket 的人，都会问想一个问题：我们已经有了 HTTP 协议，为什么还需要另一个协议？它到底能带来什么好处？
    </p>
    <blockquote>
     <p>
      答案很简单，因为 HTTP 协议有一个缺陷：通信只能由客户端发起。
     </p>
    </blockquote>
    <p>
     比如说：我们想了解今天的天气，只能是客户端向服务器发出请求，服务器返回查询结果。HTTP 协议做不到服务器主动向客户端推送信息。
    </p>
    <h3>
     <a id="3_39">
     </a>
     3、特点
    </h3>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/5c3b5d4cee9c07849b8006e6e4af78f4.jpeg#pic_center"/>
    </p>
    <blockquote>
     <p>
      <code>
       服务器
      </code>
      可以
      <code>
       主动向客户端推送信息
      </code>
      ，
      <code>
       客户端
      </code>
      也可以
      <code>
       主动向服务器发送信息
      </code>
      ，是真正的双向平等对话，属于服务器推送技术的一种。
     </p>
    </blockquote>
    <p>
     （1）建立在 TCP 协议之上，服务器端的实现比较容易。
    </p>
    <p>
     （2）与 HTTP 协议有着良好的兼容性。默认端口也是80和443，并且握手阶段采用 HTTP 协议，因此握手时不容易屏蔽，能通过各种 HTTP 代理服务器。
    </p>
    <p>
     （3）数据格式比较轻量，性能开销小，通信高效。
    </p>
    <p>
     （4）可以发送文本，也可以发送二进制数据。
    </p>
    <p>
     （5）没有同源限制，客户端可以与任意服务器通信。
    </p>
    <p>
     （6）协议标识符是ws（如果加密，则为wss），服务器网址就是 URL。
    </p>
    <hr/>
    <h3>
     <a id="4vue2_58">
     </a>
     4、vue2案例
    </h3>
    <h4>
     <a id="1__60">
     </a>
     (1) 技术栈
    </h4>
    <ul>
     <li>
      vue-cli@3.12.1
     </li>
     <li>
      Ant Design of Vue
     </li>
     <li>
      vue-router
     </li>
     <li>
      localStorage
     </li>
     <li>
      moment
     </li>
     <li>
      ws
     </li>
    </ul>
    <h5>
     <a id="_Ant_Design_of_Vue__69">
     </a>
     首先我们使用的是
     <code>
      Ant Design of Vue 样式组件库
     </code>
    </h5>
    <h6>
     <a id="_antdesignvue_71">
     </a>
     ①安装
     <code>
      ant-design-vue
     </code>
    </h6>
    <pre><code class="prism language-js">npm i <span class="token operator">--</span>save ant<span class="token operator">-</span>design<span class="token operator">-</span>vue
</code></pre>
    <h6>
     <a id="mainjs__75">
     </a>
     ②在
     <code>
      main.js中
     </code>
     完整引入
    </h6>
    <pre><code class="prism language-js"><span class="token keyword">import</span> Antd <span class="token keyword">from</span> <span class="token string">'ant-design-vue'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string">'ant-design-vue/dist/antd.css'</span><span class="token punctuation">;</span>
Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>Antd<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
    <hr/>
    <h4>
     <a id="2__83">
     </a>
     (2) 目录结构
    </h4>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/bcb05136bbded25acc5997f7663c63fb.png#pic_center"/>
    </p>
    <h4>
     <a id="3routerjs_86">
     </a>
     (3)router.js配置
    </h4>
    <pre><code class="prism language-js"><span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">import</span> Router <span class="token keyword">from</span> <span class="token string">'vue-router'</span>
<span class="token comment">//导入登录页</span>
<span class="token keyword">import</span> Login <span class="token keyword">from</span> <span class="token string">'./views/Login.vue'</span>

Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>Router<span class="token punctuation">)</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">new</span> <span class="token class-name">Router</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
  <span class="token literal-property property">mode</span><span class="token operator">:</span> <span class="token string">'history'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">base</span><span class="token operator">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">BASE_URL</span><span class="token punctuation">,</span>
  <span class="token literal-property property">routes</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token comment">//登录页</span>
    <span class="token punctuation">{<!-- --></span>
      <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">'/Login'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Login'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">component</span><span class="token operator">:</span> Login
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">//首页</span>
    <span class="token punctuation">{<!-- --></span>
      <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">'/'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Home'</span><span class="token punctuation">,</span>
      <span class="token comment">// route level code-splitting</span>
      <span class="token comment">// this generates a separate chunk (about.[hash].js) for this route</span>
      <span class="token comment">// which is lazy-loaded when the route is visited.</span>
      <span class="token function-variable function">component</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token comment">/* webpackChunkName: "Home" */</span> <span class="token string">'./views/Home.vue'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
    <h4>
     <a id="4__Loginvue_117">
     </a>
     (4) 登录 【Login.vue】
    </h4>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/1eb40a03aceacea57d9881540a306707.gif#pic_center"/>
    </p>
    <hr/>
    <h5>
     <a id="_123">
     </a>
     一💕登录布局：
    </h5>
    <blockquote>
     <p>
      在布局前，我们先构思好页面分布，良好的开端，要占据开发的一半。有思路，才会事半功倍。
     </p>
    </blockquote>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/e0a95bc10b3c3a9405da7a963d421fcd.png#pic_center"/>
    </p>
    <ul>
     <li>
      聊天室标题
     </li>
     <li>
      用户名输入框
     </li>
     <li>
      进入聊天室按钮
     </li>
     <li>
      背景界面圆角 【样式处理】
     </li>
    </ul>
    <h6>
     <a id="_135">
     </a>
     ①聊天室标题
    </h6>
    <pre><code class="prism language-html"><span class="token comment">&lt;!--标题--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>boxs<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>木鱼全球·畅聊<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/5011cab8dd69848db599f9537b4c7e14.gif#pic_center"/>
    </p>
    <h6>
     <a id="_145">
     </a>
     ②用户名输入框
    </h6>
    <pre><code class="prism language-html"><span class="token comment">&lt;!--用户名输入框--&gt;</span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a-input</span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>请您输入用户名<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
   <span class="token comment">&lt;!-- 用户图标--&gt;</span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a-icon</span> <span class="token attr-name">slot</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>prefix<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>user<span class="token punctuation">"</span></span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">color</span><span class="token punctuation">:</span> <span class="token function">rgba</span><span class="token punctuation">(</span>0<span class="token punctuation">,</span> 0<span class="token punctuation">,</span> 0<span class="token punctuation">,</span> 0.25<span class="token punctuation">)</span></span><span class="token punctuation">"</span></span></span><span class="token punctuation">/&gt;</span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a-input</span><span class="token punctuation">&gt;</span></span>
</code></pre>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/92924814907bc96f3867b1e2ba0708ef.gif#pic_center"/>
    </p>
    <h6>
     <a id="_156">
     </a>
     ③进入聊天室按钮
    </h6>
    <pre><code class="prism language-html"><span class="token comment">&lt;!--进入聊天室按钮--&gt;</span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a-button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>dashed<span class="token punctuation">"</span></span> <span class="token attr-name">ghost</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!--自定义图标--&gt;</span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>iconfont icon-SEND<span class="token punctuation">"</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>添加进入聊天室事件👇<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>i</span><span class="token punctuation">&gt;</span></span>进入聊天室
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a-button</span><span class="token punctuation">&gt;</span></span>
</code></pre>
    <p>
     如何自定义图标请参考 👉
     <a href="https://chenchunbo.blog.csdn.net/article/details/123379553" rel="nofollow">
      如何引用阿里图标库
     </a>
    </p>
    <h5>
     <a id="_166">
     </a>
     一💕登录逻辑：
    </h5>
    <h6>
     <a id="__vmodelusername_167">
     </a>
     ①用户输入信息：在输入框 内绑定
     <code>
      v-model="username"
     </code>
    </h6>
    <p>
     在
     <code>
      data
     </code>
     中定义存储用户信息的桶
    </p>
    <pre><code class="prism language-js">  <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span>
      <span class="token literal-property property">username</span><span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre>
    <h6>
     <a id="clickhandleEnterBtnClick_178">
     </a>
     ②进入聊天室事件：
     <code>
      @click="handleEnterBtnClick"
     </code>
    </h6>
    <pre><code class="prism language-js">   <span class="token comment">//进入聊天室</span>
    <span class="token function">handleEnterBtnClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
     <span class="token comment">// trim() 去除用户名里的空格</span>
      <span class="token keyword">const</span> username <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>username<span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">//如果 输入的用户名 少于3位，程序会给出提示，如果满足 则跳转至首页聊天室</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>username<span class="token punctuation">.</span>length <span class="token operator">&lt;</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>$message<span class="token punctuation">.</span><span class="token function">warning</span><span class="token punctuation">(</span><span class="token string">"用户名不能小于3位"</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token comment">//将输入的用户名 保存到本地存储</span>
      localStorage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span><span class="token string">"username"</span><span class="token punctuation">,</span> username<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">//跳转到首页</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>$router<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre>
    <h6>
     <a id="__195">
     </a>
     ③针对于 本地里
     <code>
      有或者没有用户名信息
     </code>
    </h6>
    <blockquote>
     <p>
      如果有 进入首页聊天室，否则 返回登录页【首页返回的操作】
     </p>
    </blockquote>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/1eef7377406ceb37da81a5a5cd0224af.gif#pic_center"/>
    </p>
    <hr/>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/1de559c667f57e0e8dab2b4453670457.gif#pic_center"/>
    </p>
    <pre><code class="prism language-js">  <span class="token function">mounted</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token comment">//将用户信息存储在本地</span>
    <span class="token keyword">const</span> username <span class="token operator">=</span> localStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">"username"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>username<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>$router<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre>
    <h6>
     <a id="_214">
     </a>
     ④清除本地存储当中的信息【演示效果】
    </h6>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/0280258803deaabe6a8a8d8280aa3db7.gif#pic_center"/>
    </p>
    <h4>
     <a id="5_Homevue_218">
     </a>
     (5) 首页【Home.vue】
    </h4>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/d97e70320c300ca3d9f1dbb2ad7138fe.gif#pic_center"/>
    </p>
    <h5>
     <a id="_223">
     </a>
     一💕首页布局：
    </h5>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/a9f1f74bd6853a4994973069283c9f79.gif#pic_center"/>
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/70d914d41bf179b24d1f52408c4502d0.png#pic_center"/>
    </p>
    <ul>
     <li>
      消息列表
     </li>
     <li>
      内容输入框
     </li>
     <li>
      发送按钮
     </li>
    </ul>
    <h6>
     <a id="_233">
     </a>
     ①消息列表：
    </h6>
    <pre><code class="prism language-html">   <span class="token comment">&lt;!--循环 列表--&gt;</span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a-list</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>record<span class="token punctuation">"</span></span> <span class="token attr-name">item-layout</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>horizontal<span class="token punctuation">"</span></span> <span class="token attr-name">:data-source</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>msgList<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token comment">&lt;!--Ant 组件 默认的循环遍历数据结构  不可更改--&gt;</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a-list-item</span> <span class="token attr-name">slot</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>renderItem<span class="token punctuation">"</span></span> <span class="token attr-name">slot-scope</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>item<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a-list-item-meta</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">slot</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>title<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
          <span class="token comment">&lt;!--遍历用户名--&gt;</span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">&gt;</span></span> {<!-- -->{ item.user }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
           <span class="token comment">&lt;!--发布时间--&gt;</span> 
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">&gt;</span></span>发送时间：{<!-- -->{ $moment(item.dateTime).format("YYYY-MM-DD HH:mm:ss") }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
          <span class="token comment">&lt;!--会话内容--&gt;</span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">slot</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>title<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>会话内容：{<!-- -->{ item.msg }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
          <span class="token comment">&lt;!--用户头像显示--&gt;</span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a-avatar</span> <span class="token attr-name">slot</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>avatar<span class="token punctuation">"</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://gw.alicdn.com/tps/TB1W_X6OXXXXXcZXVXXXXXXXXXX-400-400.png<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a-list-item-meta</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a-list-item</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a-list</span><span class="token punctuation">&gt;</span></span>
</code></pre>
    <p>
     附加：关于遍历的时间格式处理 请看：
     <a href="https://chenchunbo.blog.csdn.net/article/details/123468209" rel="nofollow">
      vue时间格式处理(YYYY-MM-DD HH:mm:ss)
     </a>
    </p>
    <h6>
     <a id="_256">
     </a>
     ②内容输入框:
    </h6>
    <pre><code class="prism language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a-input</span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>请输入消息<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
</code></pre>
    <h6>
     <a id="_260">
     </a>
     ③发送按钮：
    </h6>
    <pre><code class="prism language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a-button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>dashed<span class="token punctuation">"</span></span> <span class="token attr-name">ghost</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>iconfont icon-SEND<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>i</span><span class="token punctuation">&gt;</span></span>
	发送
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a-button</span><span class="token punctuation">&gt;</span></span>
</code></pre>
    <h5>
     <a id="WebSocket_271">
     </a>
     一💕首页逻辑【WebSocket默认配置】：
    </h5>
    <p>
     首先建立WebSocket 连接，我们要知道 WebSocket 在前端工程 支持 4种属性一👇
    </p>
    <ul>
     <li>
      open 【建立连接】
     </li>
     <li>
      close 【关闭连接】
     </li>
     <li>
      error 【错误信息】
     </li>
     <li>
      message 【接收处理】
     </li>
    </ul>
    <p>
     附加了解内容：一🍾
    </p>
    <blockquote>
     <p>
      后端的WebSocket 支持五种：
     </p>
     <ol>
      <li>
       open 【建立连接】
      </li>
      <li>
       close 【关闭连接】
      </li>
      <li>
       error 【错误信息】
      </li>
      <li>
       message 【连接处理】
      </li>
      <li>
       connection 【信息处理函数】
      </li>
     </ol>
    </blockquote>
    <hr/>
    <p>
     在外部作用域调用：
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/c3cee8e5be1b79b58647cc251d09a013.png#pic_center"/>
     <br/>
     详细WebSocket 服务链接部署 ，请看下面
     <code>
      (6) node 通信部署
     </code>
     一🎈
    </p>
    <pre><code class="prism language-js"><span class="token comment">//调用本地的WebSocket 服务</span>
<span class="token keyword">const</span> ws <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WebSocket</span><span class="token punctuation">(</span><span class="token string">"ws://localhost:8000"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
    <p>
     此时需要vue2 项目位置–》下载
     <code>
      ws
     </code>
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/f7f370a249264a4bdf54dd496ca5da4f.png#pic_center"/>
    </p>
    <pre><code class="prism language-js">npm install ws <span class="token operator">-</span>g
</code></pre>
    <h6>
     <a id="_304">
     </a>
     ①建立连接：
    </h6>
    <blockquote>
     <p>
      在mounted 生命周期内，写出 WebSocket 连接结构代码【以下属于原生写法】
     </p>
    </blockquote>
    <p>
     注意：
    </p>
    <ol>
     <li>
      <code>
       this.handleWsOpen
      </code>
      【作用于调用 methods中的连接函数事件】
     </li>
     <li>
      <code>
       bind(this)
      </code>
      【bind(this)的作用是改变this的指向】
     </li>
    </ol>
    <h6>
     <a id="_311">
     </a>
     ②默认配置：
    </h6>
    <pre><code class="prism language-js">  <span class="token function">mounted</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">//连接   </span>
    ws<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"open"</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">handleWsOpen</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//关闭</span>
    ws<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"close"</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">handleWsClose</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//错误</span>
    ws<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"error"</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">handleWsError</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//接收处理</span>
    ws<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"message"</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">handleWsMessage</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre>
    <h6>
     <a id="_326">
     </a>
     ③配置连接参数：
    </h6>
    <blockquote>
     <p>
      在methods 生命周期内 配置，它的默认参数
     </p>
    </blockquote>
    <pre><code class="prism language-js"> <span class="token literal-property property">methods</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
</code></pre>
    <pre><code class="prism language-js"><span class="token comment">//建立连接</span>
<span class="token function">handleWsOpen</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
   console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"FE:WebSocket open"</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre>
    <pre><code class="prism language-js"><span class="token comment">//关闭连接</span>
<span class="token function">handleWsClose</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
   console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"FE:WebSocket close"</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre>
    <pre><code class="prism language-js"> <span class="token comment">//错误信息</span>
<span class="token function">handleWsError</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
   console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"FE:WebSocket error"</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre>
    <p>
     这步很重要，作用于前端接收广播数据 一🎯
    </p>
    <pre><code class="prism language-js"><span class="token comment">//接收数据处理 默认结构</span>
<span class="token function">handleWsMessage</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
   console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"FE:WebSocket message"</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre>
    <hr/>
    <h6>
     <a id="_360">
     </a>
     ④刷新处理函数事件:
    </h6>
    <blockquote>
     <p>
      我们需要在
      <code>
       mounted 生命周期
      </code>
      中 添加
      <code>
       刷新页面处理函数
      </code>
     </p>
    </blockquote>
    <p>
     判断本地存储当中有没有用户名，如果有用户名 点击浏览器刷新【F5】，不做跳转，否则跳转至登录页
    </p>
    <pre><code class="prism language-js"><span class="token function">mounted</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
   <span class="token comment">//将用户存储到本地</span>
   <span class="token keyword">this</span><span class="token punctuation">.</span>username <span class="token operator">=</span> localStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">"username"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//判断 如果本地存储没有当前用户名 则 跳转回登录页</span>
   <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>username<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
     <span class="token keyword">this</span><span class="token punctuation">.</span>$router<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">"/Login"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token keyword">return</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <h4>
     <a id="6_node_379">
     </a>
     (6) node通信部署
    </h4>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/464ff99497fb17d971c2cba2a6b525cf.gif#pic_center"/>
    </p>
    <hr/>
    <h5>
     <a id="_385">
     </a>
     一💕初始化处理
    </h5>
    <p>
     注意：在部署前，首先必须要做初始化处理
    </p>
    <blockquote>
     <p>
      在server 目录下 运行
      <code>
       npm init -y
      </code>
      初始化
      <br/>
      <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/2b3ab645455bc3eab0952c0b0204c65d.png#pic_center"/>
     </p>
    </blockquote>
    <pre><code class="prism language-js">npm init <span class="token operator">-</span>y
</code></pre>
    <h5>
     <a id="_394">
     </a>
     一💕监听处理
    </h5>
    <blockquote>
     <p>
      使用nodemon 插件 做监听处理函数 一👆 也是在server 目录下运行
     </p>
    </blockquote>
    <pre><code class="prism language-js">npm install nodemon <span class="token operator">-</span>g
</code></pre>
    <h5>
     <a id="_400">
     </a>
     一💕启用监听
    </h5>
    <blockquote>
     <p>
      在
      <code>
       package.json
      </code>
      文件中修改
      <code>
       scripts
      </code>
      内的参数
     </p>
    </blockquote>
    <ul>
     <li>
      dev 【运行方式，通过npm run dev】
     </li>
     <li>
      nodemon index.js 【使用监听nodemon】、【引用index.js 文件】
     </li>
    </ul>
    <pre><code class="prism language-js"><span class="token string-property property">"scripts"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
  <span class="token string-property property">"dev"</span><span class="token operator">:</span> <span class="token string">"nodemon index.js"</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/c3cee8e5be1b79b58647cc251d09a013.png#pic_center"/>
    </p>
    <h5>
     <a id="_ws___WebSocket_412">
     </a>
     一💕下载 ws 库【 附属于 WebSocket】
    </h5>
    <blockquote>
     <p>
      一👆 也是在server 目录下运行
     </p>
    </blockquote>
    <pre><code class="prism language-js">npm install ws
</code></pre>
    <h5>
     <a id="indexjs_418">
     </a>
     一💕新建index.js
    </h5>
    <h6>
     <a id="const_Ws__requirews_419">
     </a>
     ①导入
     <code>
      const Ws = require('ws');
     </code>
    </h6>
    <pre><code class="prism language-js"><span class="token keyword">const</span> Ws <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'ws'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//建立模块</span>
<span class="token punctuation">;</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">Ws</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
  <span class="token comment">//......主要代码 在模块内写</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span>Ws<span class="token punctuation">)</span>
</code></pre>
    <h6>
     <a id="WebSocket_427">
     </a>
     ②主要WebSocket配置【主要代码】
    </h6>
    <pre><code class="prism language-js"><span class="token comment">//接口 为8000</span>
    <span class="token keyword">const</span> server <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Ws<span class="token punctuation">.</span>Server</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
        <span class="token literal-property property">port</span><span class="token operator">:</span> <span class="token number">8000</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


    <span class="token keyword">const</span> <span class="token function-variable function">init</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        <span class="token function">bindEvent</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">function</span> <span class="token function">bindEvent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        server<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'open'</span><span class="token punctuation">,</span> handleOpen<span class="token punctuation">)</span>
        server<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'close'</span><span class="token punctuation">,</span> handleClose<span class="token punctuation">)</span>
        server<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'error'</span><span class="token punctuation">,</span> handleError<span class="token punctuation">)</span>
        server<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'connection'</span><span class="token punctuation">,</span> handleConnection<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//与前端建立连接</span>
    <span class="token keyword">function</span> <span class="token function">handleOpen</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'BE:WebSocket open'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//与前端关闭连接</span>
    <span class="token keyword">function</span> <span class="token function">handleClose</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'BE:WebSocket close'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//错误信息</span>
    <span class="token keyword">function</span> <span class="token function">handleError</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'BE:WebSocket error'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//信息处理</span>
    <span class="token keyword">function</span> <span class="token function">handleConnection</span><span class="token punctuation">(</span><span class="token parameter">ws</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'BE:WebSocket connection'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        ws<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'message'</span><span class="token punctuation">,</span> handleMessage<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//与前端建立连接</span>
    <span class="token keyword">function</span> <span class="token function">handleMessage</span><span class="token punctuation">(</span><span class="token parameter">msg</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">//遍历每一条内容信息</span>
        server<span class="token punctuation">.</span>clients<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">c</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// 发送send 信息 到前端</span>
            c<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
</code></pre>
    <h4>
     <a id="7__471">
     </a>
     (7) 首页添加触发事件函数
    </h4>
    <h6>
     <a id="___vmodelmsg_472">
     </a>
     ① 请输入消息框 绑定
     <code>
      v-model="msg"
     </code>
    </h6>
    <pre><code class="prism language-html">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a-input</span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>请输入消息<span class="token punctuation">"</span></span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>msg<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
</code></pre>
    <pre><code class="prism language-js">  <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span>
      <span class="token literal-property property">msg</span><span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">,</span><span class="token comment">//发送的内容</span>
      <span class="token literal-property property">username</span><span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">,</span><span class="token comment">//用户名</span>
      <span class="token literal-property property">msgList</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token comment">//消息列表数据</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre>
    <h6>
     <a id="_clickhandleSendBtnClick_485">
     </a>
     ②发送按钮绑定事件
     <code>
      @click="handleSendBtnClick"
     </code>
    </h6>
    <pre><code class="prism language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a-button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>dashed<span class="token punctuation">"</span></span> <span class="token attr-name">ghost</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>handleSendBtnClick<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>iconfont icon-SEND<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>i</span><span class="token punctuation">&gt;</span></span>发送
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a-button</span><span class="token punctuation">&gt;</span></span>
</code></pre>
    <pre><code class="prism language-js">   <span class="token comment">//发送逻辑</span>
    <span class="token function">handleSendBtnClick</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>msg <span class="token operator">==</span> <span class="token string">""</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>$message<span class="token punctuation">.</span><span class="token function">warning</span><span class="token punctuation">(</span><span class="token string">"不能发送空白消息"</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">const</span> msg <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>msg<span class="token punctuation">;</span>
        <span class="token comment">//去除头尾空格</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>msg<span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
          <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">//接收发送的内容</span>
        ws<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>
          <span class="token comment">//将返回的数据以对象的形式 展示在前台</span>
          <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
            <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token literal-property property">user</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>username<span class="token punctuation">,</span>
            <span class="token literal-property property">dateTime</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token literal-property property">msg</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>msg<span class="token punctuation">,</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//输入完信息后 置空</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>msg <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre>
    <h6>
     <a id="__517">
     </a>
     ③ 接收广播数据
    </h6>
    <blockquote>
     <p>
      在methods 中增加
      <code>
       handleWsMessage
      </code>
      处理函数 接收返回的数据
     </p>
    </blockquote>
    <pre><code class="prism language-js">   <span class="token comment">//前端接收广播数据</span>
    <span class="token function">handleWsMessage</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token comment">//数据类型转换 为对象的形式</span>
      <span class="token keyword">const</span> msg <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>    
	  <span class="token comment">//将输入的内容 添加到 消息列表</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>msgList<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span>

      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// console.log("FE:WebSocket message", e);</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/b817e835b192f764ff7b2936b77e6088.png#pic_center"/>
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/3032b100b732d4c2353d9aba809545f9.png#pic_center"/>
    </p>
    <h4>
     <a id="8__537">
     </a>
     (8) 通信演示
    </h4>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/6689ed28c3effebe532b82a1591045ac.gif#pic_center"/>
    </p>
    <hr/>
    <h3>
     <a id="__542">
     </a>
     📖 博主致谢
    </h3>
    <p>
     感谢大家阅读到结尾，本次的文章就分享到这里，总结了
     <code>
      【前端WebSocket 实时通信的案例】
     </code>
     ，希望可以帮到大家，谢谢。
    </p>
    <p>
     如果您觉得这篇文章有帮助到您的的话不妨【
     <code>
      关注+点赞+收藏+评论+转发
     </code>
     】支持一下哟~~😛您的支持就是我更新的最大动力。👇👇👇👇👇👇
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/671cc590e8d4c9005874bf02d41babe3.png#pic_center"/>
    </p>
    <hr/>
    <p>
     <font color="blue">
      <b>
       🛩往期精彩：
      </b>
     </font>
    </p>
    <p>
     <a href="https://chenchunbo.blog.csdn.net/article/details/123340499" rel="nofollow">
      一文图解自定义修改el-table样式
     </a>
    </p>
    <p>
     <a href="https://chenchunbo.blog.csdn.net/article/details/123422182" rel="nofollow">
      盘点，这些年你知道的鼠标移入显示小手图标的css的cursor 属性，你还记得吗？
     </a>
    </p>
    <p>
     <a href="https://chenchunbo.blog.csdn.net/article/details/123526834" rel="nofollow">
      一键图解iframe标签属性以及使用
     </a>
    </p>
    <p>
     <a href="https://chenchunbo.blog.csdn.net/article/details/123555947" rel="nofollow">
      iframe标签嵌套页面时，如何让页面内的高度自适应
     </a>
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f672e:6373646e2e6e65742f77656978696e5f34383333373536362f:61727469636c652f64657461696c732f313233353937333832" class_="artid" style="display:none">
 </p>
</div>


