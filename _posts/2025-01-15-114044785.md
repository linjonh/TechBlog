---
layout: post
title: "java-数据库-操作_Java数据库基本操作"
date: 2025-01-15 09:28:09 +0800
description: "本文介绍了如何使用Java连接SQLServer2000数据库进行基本操作，包括建立连接、执行查询和"
keywords: "java数据库基本操作"
categories: ['未分类']
tags: ['数据库', '操作', 'Java']
artid: "114044785"
image:
  path: https://api.vvhan.com/api/bing?rand=sj&artid=114044785
  alt: "java-数据库-操作_Java数据库基本操作"
render_with_liquid: false
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     java 数据库 操作_Java数据库基本操作
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <div style="font-size:16px;">
     <p>
      Java数据库基本操作
     </p>
     <p>
      一.SQLServer2000的数据库连接
     </p>
     <p>
      注: 采用直连数据库,首先应该在工程中导入链接数据库所需要的
     </p>
     <p>
      3个jar包,如果是SQLServer2005的数据库应该导入相应的2005
     </p>
     <p>
      的jar包;
     </p>
     <p>
      1.驱动
     </p>
     <p>
      string dirver="com.microsoft.jdbc.sqlserver.SQLServerDriver";
     </p>
     <p>
      2.url地址
     </p>
     <p>
      string url ="jdbc:microsoft:sqlserver://localhost:1433;databasename=North";
     </p>
     <p>
      3.连接数据库的方法getConn()
     </p>
     <p>
      public Connection getConn()
     </p>
     <p>
      {
      <!-- -->
     </p>
     <p>
      //加载驱动
     </p>
     <p>
      try {
      <!-- -->
     </p>
     <p>
      Class.forName(this.driver);
     </p>
     <p>
      //获取数据库连接
     </p>
     <p>
      this.conn=DriverManager.getConnection(url,"sa","密码");
     </p>
     <p>
      } catch (Exception e) {
      <!-- -->
     </p>
     <p>
      e.printStackTrace();
     </p>
     <p>
      }
     </p>
     <p>
      return this.conn;
     </p>
     <p>
      }
     </p>
     <p>
      二.数据库操作
     </p>
     <p>
      1.对数据库执行查询的方法executeQuery()
     </p>
     <p>
      //此方法返回结果集,返回类型为ResultSet;
     </p>
     <p>
      public ResultSet executeQuery(String sql)
     </p>
     <p>
      {
      <!-- -->
     </p>
     <p>
      getConn();
     </p>
     <p>
      try{
      <!-- -->
     </p>
     <p>
      this.stmt=this.conn.createStatement();
     </p>
     <p>
      //对数据库执行查询时用stmt.executeQuery(sql);
     </p>
     <p>
      this.rs=this.stmt.executeQuery(sql);
     </p>
     <p>
      } catch (Exception e) {
      <!-- -->
     </p>
     <p>
      e.printStackTrace();
     </p>
     <p>
      }
     </p>
     <p>
      return this.rs;
     </p>
     <p>
      }
     </p>
     <p>
      2.对数据库执行增删改的方法executeUpdate()
     </p>
     <p>
      //此方法返回True/False,返回值类型boolean
     </p>
     <p>
      public boolean executeUpdate(String sql)
     </p>
     <p>
      {
      <!-- -->
     </p>
     <p>
      getConn();
     </p>
     <p>
      try {
      <!-- -->
     </p>
     <p>
      this.stmt=this.conn.createStatement();
     </p>
     <p>
      //对数据库执行查询时用stmt.executeUpdate(sql);
     </p>
     <p>
      int i=stmt.executeUpdate(sql);
     </p>
     <p>
      if(i&gt;0){
      <!-- -->
     </p>
     <p>
      this.flag=true;
     </p>
     <p>
      }
     </p>
     <p>
      } catch (SQLException e) {
      <!-- -->
     </p>
     <p>
      e.printStackTrace();
     </p>
     <p>
      }
     </p>
     <p>
      return flag;
     </p>
     <p>
      }
     </p>
     <p>
      注: 连接数据库的方法和对数据库操作的方法都在同一个类里面即数据库连接类
     </p>
     <p>
      Public class connDB{}
     </p>
     <p>
      三.完整例题
     </p>
     <p>
      package com.qud.common;
     </p>
     <p>
      import java.sql.Connection;
     </p>
     <p>
      import java.sql.DriverManager;
     </p>
     <p>
      import java.sql.ResultSet;
     </p>
     <p>
      import java.sql.SQLException;
     </p>
     <p>
      import java.sql.Statement;
     </p>
     <p>
      public class ConnDB {
      <!-- -->
     </p>
     <p>
      private Connection conn;
     </p>
     <p>
      private Statement stmt;
     </p>
     <p>
      private ResultSet rs;
     </p>
     <p>
      private String driver="com.microsoft.jdbc.sqlserver.SQLServerDriver";
     </p>
     <p>
      private String url="jdbc:microsoft:sqlserver://localhost:1433;databasename=mydb";
     </p>
     <p>
      private boolean flag=false;
     </p>
     <p>
      public Connection getConn()
     </p>
     <p>
      {
      <!-- -->
     </p>
     <p>
      //加载驱动
     </p>
     <p>
      try {
      <!-- -->
     </p>
     <p>
      Class.forName(this.driver);
     </p>
     <p>
      //获取数据库连接
     </p>
     <p>
      this.conn=DriverManager.getConnection(url,"sa","");
     </p>
     <p>
      } catch (Exception e) {
      <!-- -->
     </p>
     <p>
      // TODO Auto-generated catch block
     </p>
     <p>
      e.printStackTrace();
     </p>
     <p>
      }
     </p>
     <p>
      return this.conn;
     </p>
     <p>
      }
     </p>
     <p>
      //公共查询的方法
     </p>
     <p>
      public ResultSet executeQuery(String sql)
     </p>
     <p>
      {
      <!-- -->
     </p>
     <p>
      getConn();
     </p>
     <p>
      try {
      <!-- -->
     </p>
     <p>
      this.stmt=this.conn.createStatement();
     </p>
     <p>
      this.rs=this.stmt.executeQuery(sql);
     </p>
     <p>
      } catch (Exception e) {
      <!-- -->
     </p>
     <p>
      e.printStackTrace();
     </p>
     <p>
      }
     </p>
     <p>
      return this.rs;
     </p>
     <p>
      }
     </p>
     <p>
      //公共增删改的方法
     </p>
     <p>
      public boolean executeUpdate(String sql)
     </p>
     <p>
      {
      <!-- -->
     </p>
     <p>
      getConn();
     </p>
     <p>
      try {
      <!-- -->
     </p>
     <p>
      this.stmt=this.conn.createStatement();
     </p>
     <p>
      int i=stmt.executeUpdate(sql);
     </p>
     <p>
      if(i&gt;0)
     </p>
     <p>
      {
      <!-- -->
     </p>
     <p>
      this.flag=true;
     </p>
     <p>
      }
     </p>
     <p>
      } catch (SQLException e) {
      <!-- -->
     </p>
     <p>
      e.printStackTrace();
     </p>
     <p>
      }
     </p>
     <p>
      return flag;
     </p>
     <p>
      }
     </p>
     <p>
      //关闭数据库
     </p>
     <p>
      public void close()
     </p>
     <p>
      {
      <!-- -->
     </p>
     <p>
      try {
      <!-- -->
     </p>
     <p>
      if(this.rs !=null )
     </p>
     <p>
      {
      <!-- -->
     </p>
     <p>
      this.rs.close();
     </p>
     <p>
      }
     </p>
     <p>
      if(this.stmt != null)
     </p>
     <p>
      {
      <!-- -->
     </p>
     <p>
      this.stmt.close();
     </p>
     <p>
      }
     </p>
     <p>
      if(this.conn !=null || !this.conn.isClosed())
     </p>
     <p>
      {
      <!-- -->
     </p>
     <p>
      this.conn.close();
     </p>
     <p>
      }
     </p>
     <p>
      } catch (Exception e) {
      <!-- -->
     </p>
     <p>
      e.printStackTrace();
     </p>
     <p>
      }
     </p>
     <p>
      }
     </p>
     <p>
      }
     </p>
    </div>
   </div>
  </div>
  <div id="recommendDown">
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f672e:6373646e2e6e65742f77656978696e5f33323435383133312f:61727469636c652f64657461696c732f313134303434373835" class_="artid" style="display:none">
 </p>
</div>
