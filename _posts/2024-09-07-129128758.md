---
layout: post
title: "Centos8.x搭建OpenACS服务器TR069"
date: 2024-09-07 20:37:36 +0800
description: "本文详细介绍了如何在CentOS8环境下搭建开源服务器OpenACS，包括安装JDK、Jboss，配"
keywords: "openacs"
categories: ['服务器搭建']
tags: ['服务器', 'Linux', 'Centos']
artid: "129128758"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=129128758
    alt: "Centos8.x搭建OpenACS服务器TR069"
render_with_liquid: false
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     Centos8.x搭建OpenACS服务器(TR069)
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-light" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
    </p>
    <div class="toc">
     <h4>
      文章目录
     </h4>
     <ul>
      <li>
       <a href="#_5" rel="nofollow">
        前言
       </a>
      </li>
      <li>
       <a href="#_10" rel="nofollow">
        一、软件环境
       </a>
      </li>
      <li>
       <a href="#root_28" rel="nofollow">
        二、环境安装（建议在root权限下操作）
       </a>
      </li>
      <li>
       <ul>
        <li>
         <a href="#1JDK_29" rel="nofollow">
          1.安装JDK
         </a>
        </li>
        <li>
         <a href="#2Jboss_53" rel="nofollow">
          2.安装Jboss
         </a>
        </li>
        <li>
         <a href="#3_76" rel="nofollow">
          3.配置数据库
         </a>
        </li>
        <li>
         <a href="#4OpenACS_111" rel="nofollow">
          4.安装OpenACS
         </a>
        </li>
        <li>
         <a href="#5OpenACS_126" rel="nofollow">
          5.运行OpenACS服务器
         </a>
        </li>
        <li>
         <a href="#6_136" rel="nofollow">
          6.异常处理
         </a>
        </li>
       </ul>
      </li>
      <li>
       <a href="#_158" rel="nofollow">
        总结(附安装包下载地址)
       </a>
      </li>
     </ul>
    </div>
    <p>
    </p>
    <hr/>
    <h2>
     <a id="_5">
     </a>
     前言
    </h2>
    <p>
     TR069：CPE广域网管理协议，称为用户终端设备广域网管理协议（CWMP）。在TR069协议定义的网管模型中，服务器称为自动配置服务器（ACS），负责对用户终端设备（CPE）进行管理。本文主要介绍开源服务器OpenACS的搭建过程。
    </p>
    <hr/>
    <h2>
     <a id="_10">
     </a>
     一、软件环境
    </h2>
    <p>
     由于OpenACS是用Java编写的，所以搭建前需要一些必须的环境配置。
    </p>
    <ul>
     <li>
      <strong>
       Linux系统(centos8.x)
      </strong>
     </li>
    </ul>
    <p>
     查看方法
    </p>
    <pre><code class="prism language-c">cat <span class="token operator">/</span>etc<span class="token operator">/</span>redhat<span class="token operator">-</span>release 
CentOS Linux release <span class="token number">8.5</span><span class="token number">.2111</span>
或者
cat <span class="token operator">/</span>proc<span class="token operator">/</span>version 
Linux version <span class="token number">4.18</span><span class="token number">.0</span><span class="token operator">-</span><span class="token number">348.</span>el8<span class="token punctuation">.</span><span class="token function">x86_64</span> <span class="token punctuation">(</span>mockbuild@kbuilder<span class="token punctuation">.</span>bsys<span class="token punctuation">.</span>centos<span class="token punctuation">.</span>org<span class="token punctuation">)</span> <span class="token punctuation">(</span>gcc version <span class="token number">8.5</span><span class="token number">.0</span> <span class="token number">20210514</span> <span class="token punctuation">(</span>Red Hat <span class="token number">8.5</span><span class="token number">.0</span><span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>GCC<span class="token punctuation">)</span><span class="token punctuation">)</span> #<span class="token number">1</span> SMP Tue Oct <span class="token number">19</span> <span class="token number">15</span><span class="token operator">:</span><span class="token number">14</span><span class="token operator">:</span><span class="token number">17</span> UTC <span class="token number">2021</span>
</code></pre>
    <ul>
     <li>
      <strong>
       JDK
      </strong>
     </li>
     <li>
      <strong>
       Jboss
      </strong>
     </li>
     <li>
      <strong>
       Mysql
      </strong>
     </li>
     <li>
      <strong>
       OpenACS
      </strong>
     </li>
    </ul>
    <h2>
     <a id="root_28">
     </a>
     二、环境安装（建议在root权限下操作）
    </h2>
    <h3>
     <a id="1JDK_29">
     </a>
     1.安装JDK
    </h3>
    <pre><code class="prism language-c">采用rpm方式安装
rpm <span class="token operator">-</span>ivh jdk<span class="token operator">-</span><span class="token number">8u</span><span class="token number">311</span><span class="token operator">-</span>linux<span class="token operator">-</span>x64<span class="token punctuation">.</span>rpm

默认安装路径在<span class="token operator">/</span>usr<span class="token operator">/</span>java<span class="token operator">/</span>
<span class="token operator">/</span>usr<span class="token operator">/</span>java<span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">8.0</span>_311<span class="token operator">-</span>amd64

在<span class="token operator">/</span>etc<span class="token operator">/</span>profile末行添加JDK环境变量
vi <span class="token operator">/</span>etc<span class="token operator">/</span>profile

export JAVA_HOME<span class="token operator">=</span><span class="token operator">/</span>usr<span class="token operator">/</span>java<span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">8.0</span>_311<span class="token operator">-</span>amd64
export JRE_HOME<span class="token operator">=</span>$<span class="token punctuation">{<!-- --></span>JAVA_HOME<span class="token punctuation">}</span><span class="token operator">/</span>jre
export CLASSPATH<span class="token operator">=</span><span class="token punctuation">.</span><span class="token operator">:</span>$<span class="token punctuation">{<!-- --></span>JAVA_HOME<span class="token punctuation">}</span><span class="token operator">/</span>lib<span class="token operator">:</span>$<span class="token punctuation">{<!-- --></span>JRE_HOME<span class="token punctuation">}</span><span class="token operator">/</span>lib<span class="token operator">:</span>$CLASSPATH
export JAVA_PATH<span class="token operator">=</span>$<span class="token punctuation">{<!-- --></span>JAVA_HOME<span class="token punctuation">}</span><span class="token operator">/</span>bin<span class="token operator">:</span>$<span class="token punctuation">{<!-- --></span>JRE_HOME<span class="token punctuation">}</span><span class="token operator">/</span>bin
export PATH<span class="token operator">=</span>$PATH<span class="token operator">:</span>$<span class="token punctuation">{<!-- --></span>JAVA_PATH<span class="token punctuation">}</span>
保存退出

生效环境变量
source <span class="token operator">/</span>etc<span class="token operator">/</span>profile
</code></pre>
    <p>
     JDK安装成功效果
    </p>
    <p>
     <img alt="JDK安装成功" src="https://i-blog.csdnimg.cn/blog_migrate/f12d89506d2e4ea6edf723ff2cd6c2d4.png"/>
    </p>
    <h3>
     <a id="2Jboss_53">
     </a>
     2.安装Jboss
    </h3>
    <pre><code class="prism language-c">在<span class="token operator">/</span>opt目录下解压包
unzip jboss<span class="token operator">-</span><span class="token number">4.2</span><span class="token number">.2</span><span class="token punctuation">.</span>GA<span class="token punctuation">.</span>zip 

在<span class="token operator">/</span>etc<span class="token operator">/</span>profile末行添加JBOSS环境变量
vi <span class="token operator">/</span>etc<span class="token operator">/</span>profile
export JBOSS_HOME<span class="token operator">=</span><span class="token operator">/</span>opt<span class="token operator">/</span>jboss<span class="token operator">-</span><span class="token number">4.2</span><span class="token number">.2</span><span class="token punctuation">.</span>GA<span class="token operator">/</span>
export PATH<span class="token operator">=</span>$PATH<span class="token operator">:</span><span class="token operator">/</span>opt<span class="token operator">/</span>jboss<span class="token operator">-</span><span class="token number">4.2</span><span class="token number">.2</span><span class="token punctuation">.</span>GA<span class="token operator">/</span>bin
保存退出

生效环境变量
source <span class="token operator">/</span>etc<span class="token operator">/</span>profile
</code></pre>
    <p>
     进入/opt/jboss-4.2.2.GA/bin目录执行
     <br/>
     <code>
      ./run.sh -b 0.0.0.0
     </code>
    </p>
    <p>
     浏览器访问：http://服务器ip地址:8080/
    </p>
    <p>
     如果成功会出现JBOSS的页面，如下所示
    </p>
    <p>
     <img alt="Jboss安装成功页面" src="https://i-blog.csdnimg.cn/blog_migrate/cbc48954db282dce2214fd1f3e77d378.png"/>
    </p>
    <h3>
     <a id="3_76">
     </a>
     3.配置数据库
    </h3>
    <p>
     <strong>
      安装数据库驱动
     </strong>
    </p>
    <p>
     <code>
      注：由于当前服务器上数据库已经存在,版本为8.0.28，就在官网下载对应版本的驱动，下载地址为：
     </code>
     <br/>
     <code>
      https://downloads.mysql.com/archives/c-j/
     </code>
    </p>
    <p>
     <img alt="数据库驱动下载" src="https://i-blog.csdnimg.cn/blog_migrate/ad634d6d7d77143af65ee41d79a97758.png"/>
    </p>
    <p>
     将下载好的mysql-connector-java-8.0.28.zip解压，将解压目录中的mysql-connector-java-8.0.28.jar复制到/opt/jboss-4.2.2.GA/server/default/lib/目录下
    </p>
    <pre><code class="prism language-powershell">unzip mysql-connector-java-8<span class="token punctuation">.</span>0<span class="token punctuation">.</span>28<span class="token punctuation">.</span>zip
cd mysql-connector-java-8<span class="token punctuation">.</span>0<span class="token punctuation">.</span>28/
<span class="token function">cp</span> mysql-connector-java-8<span class="token punctuation">.</span>0<span class="token punctuation">.</span>28<span class="token punctuation">.</span>jar <span class="token operator">/</span>opt/jboss-4<span class="token punctuation">.</span>2<span class="token punctuation">.</span>2<span class="token punctuation">.</span>GA/server/default/lib/
</code></pre>
    <p>
     <strong>
      配置数据库
     </strong>
    </p>
    <pre><code class="prism language-powershell">登录
mysql <span class="token operator">-</span>u root <span class="token operator">-</span>p

创建用户openacs，密码为123456789
create user <span class="token string">'openacs'</span>@<span class="token string">'%'</span> identified by <span class="token string">'123456789'</span><span class="token punctuation">;</span>

刷新权限
flush privileges<span class="token punctuation">;</span>

创建ACS数据库，并将该库授权给openacs用户
create database ACS<span class="token punctuation">;</span>
grant all on ACS<span class="token punctuation">.</span><span class="token operator">*</span> to openacs@<span class="token string">'%'</span><span class="token punctuation">;</span>
grant all privileges on ACS<span class="token punctuation">.</span><span class="token operator">*</span> to <span class="token string">'openacs'</span>@<span class="token string">'%'</span><span class="token punctuation">;</span>
flush privileges<span class="token punctuation">;</span>
</code></pre>
    <p>
     用openacs用户登录，密码为123456789，如下表示创建用户，授权用户成功
    </p>
    <p>
     <img alt="用户创建、授权成功" src="https://i-blog.csdnimg.cn/blog_migrate/b83fbb496b10701e2e1a13067f6c7d9b.png"/>
    </p>
    <h3>
     <a id="4OpenACS_111">
     </a>
     4.安装OpenACS
    </h3>
    <pre><code class="prism language-powershell">在<span class="token operator">/</span>opt目录下解压包
unzip openacs-bin-0<span class="token punctuation">.</span>5<span class="token punctuation">.</span>0<span class="token punctuation">.</span>3<span class="token punctuation">.</span>zip
cd openacs
<span class="token function">cp</span> acs<span class="token punctuation">.</span>ear <span class="token operator">/</span>opt/jboss-4<span class="token punctuation">.</span>2<span class="token punctuation">.</span>2<span class="token punctuation">.</span>GA/server/default/deploy/

vi openacs-ds<span class="token punctuation">.</span>xml	主要修改connection-url，user-name和password
保存退出
<span class="token function">cp</span> openacs-ds<span class="token punctuation">.</span>xml <span class="token operator">/</span>opt/jboss-4<span class="token punctuation">.</span>2<span class="token punctuation">.</span>2<span class="token punctuation">.</span>GA/server/default/deploy/
<span class="token function">cp</span> openacs-service<span class="token punctuation">.</span>xml <span class="token operator">/</span>opt/jboss-4<span class="token punctuation">.</span>2<span class="token punctuation">.</span>2<span class="token punctuation">.</span>GA/server/default/deploy/jms/
</code></pre>
    <p>
     openacs-ds.xml修改如下
    </p>
    <p>
     <img alt="openacs-ds.xml配置" src="https://i-blog.csdnimg.cn/blog_migrate/e3532fc2faa338aca3fb43ef272329b6.png"/>
    </p>
    <h3>
     <a id="5OpenACS_126">
     </a>
     5.运行OpenACS服务器
    </h3>
    <p>
     在/opt/jboss-4.2.2.GA/bin目录下运行
     <br/>
     <code>
      ./run.sh -b 0.0.0.0
     </code>
    </p>
    <p>
     浏览器访问
     <br/>
     <code>
      http://服务器ip地址:8080/openacs/
     </code>
    </p>
    <p>
     效果如下
    </p>
    <p>
     <img alt="OpenACS服务器" src="https://i-blog.csdnimg.cn/blog_migrate/30f6518eedd79d28315fd4c9996bb925.png"/>
    </p>
    <h3>
     <a id="6_136">
     </a>
     6.异常处理
    </h3>
    <p>
     Openwrt CPE上线失败，logread发现服务器返回500错误，服务器抛出如下异常
    </p>
    <p>
     <code>
      java.lang.UnsupportedOperationException: setProperty must be overridden by all subclasses of SOAPMessage
     </code>
    </p>
    <p>
     原因是Jboss的soap实现的是老的javax.xml.soap.SoapMessage接口，这个接口的setProperty方法在老版本是不需要override的，但是到高版本的java，jdk自带soap包，而自带的这个包的SoapMessage接口对setProperty方法又强制其实现类要override自身，所以抛出了上述异常。
    </p>
    <p>
     <code>
      解决方案：
     </code>
    </p>
    <p>
     把/opt/jboss-4.2.2.GA/lib/目录中除了getopt.jar, jboss-system.jar, jboss-jmx.jar之外其他所有的jar移进/opt/jboss-4.2.2.GA/lib/endorsed/，同时移动/opt/jboss-4.2.2.GA/client/目录中的jboss-saaj.jar ，jboss-jaxrpc.jar到/opt/jboss-4.2.2.GA/lib/endorsed/目录下，这样服务器将使用jboss自带的老版本。
    </p>
    <p>
     具体操作如下：
    </p>
    <pre><code class="prism language-powershell">cd <span class="token operator">/</span>opt/jboss-4<span class="token punctuation">.</span>2<span class="token punctuation">.</span>2<span class="token punctuation">.</span>GA/lib/
<span class="token function">mv</span> concurrent<span class="token punctuation">.</span>jar jboss-common<span class="token punctuation">.</span>jar jboss-xml-binding<span class="token punctuation">.</span>jar log4j-boot<span class="token punctuation">.</span>jar endorsed/
<span class="token function">mv</span> commons-<span class="token operator">*</span> endorsed/

cd <span class="token operator">/</span>opt/jboss-4<span class="token punctuation">.</span>2<span class="token punctuation">.</span>2<span class="token punctuation">.</span>GA/client
<span class="token function">mv</span> jboss-saaj<span class="token punctuation">.</span>jar jboss-jaxrpc<span class="token punctuation">.</span>jar <span class="token operator">/</span>opt/jboss-4<span class="token punctuation">.</span>2<span class="token punctuation">.</span>2<span class="token punctuation">.</span>GA/lib/endorsed/
</code></pre>
    <h2>
     <a id="_158">
     </a>
     总结(附安装包下载地址)
    </h2>
    <p>
     以上就是centos搭建OpenACS的过程，欢迎大家交流搭建过程中遇到的问题。
    </p>
    <p>
     搭建过程中所用到的包：
     <a href="https://download.csdn.net/download/m0_50994462/87472237?spm=1001.2014.3001.5503">
      下载地址(0积分下载)
     </a>
    </p>
    <p>
     <img alt="OpenACS服务器搭建用到的包" src="https://i-blog.csdnimg.cn/blog_migrate/ed31c11ffa0c9a865f0b76906018af89.png"/>
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f6d305f35303939343436322f:61727469636c652f64657461696c732f313239313238373538" class_="artid" style="display:none">
 </p>
</div>


