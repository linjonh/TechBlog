---
layout: post
title: "在嵌入式Linux下如何用QT开发UI"
date: 2024-11-28 16:33:43 +0800
description: "在嵌入式 Linux 环境下使用开发用户界面 (UI) 是一个常见的选择。Qt 提供了丰富的功能、跨"
keywords: "嵌入式linux qt"
categories: ["未分类"]
tags: ["Ui", "Qt", "Linux"]
artid: "144114930"
image:
  path: https://api.vvhan.com/api/bing?rand=sj&artid=144114930
  alt: "在嵌入式Linux下如何用QT开发UI"
render_with_liquid: false
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     在嵌入式Linux下如何用QT开发UI
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <p>
     在嵌入式 Linux 环境下使用
     <strong>
      Qt
     </strong>
     开发用户界面 (UI) 是一个常见的选择。Qt 提供了丰富的功能、跨平台支持以及优秀的图形界面开发能力，非常适合用于嵌入式系统。以下是开发流程的详细步骤：
    </p>
    <hr/>
    <h3>
     1.
     <strong>
      准备开发环境
     </strong>
    </h3>
    <h4>
     <strong>
      硬件环境
     </strong>
    </h4>
    <ul>
     <li>
      一块运行嵌入式 Linux 的开发板（如 Raspberry Pi、i.MX、BeagleBone 等）。
     </li>
     <li>
      支持触摸屏（可选）。
     </li>
    </ul>
    <h4>
     <strong>
      软件环境
     </strong>
    </h4>
    <ul>
     <li>
      <strong>
       Qt 工具链
      </strong>
      ：需要交叉编译器和 Qt 源代码。
     </li>
     <li>
      <strong>
       目标设备上的 Qt 库
      </strong>
      ：在目标设备上运行 Qt 应用需要安装 Qt 库。
     </li>
    </ul>
    <hr/>
    <h3>
     2.
     <strong>
      开发步骤
     </strong>
    </h3>
    <h4>
     <strong>
      2.1 安装开发工具
     </strong>
    </h4>
    <p>
     在主机（开发电脑）上安装 Qt 开发工具，例如：
    </p>
    <ul>
     <li>
      <strong>
       Qt Creator
      </strong>
      ：Qt 官方 IDE。
     </li>
     <li>
      <strong>
       Qt 工具包
      </strong>
      ：包含 Qt 编译器、调试器和工具链。
     </li>
    </ul>
    <h5>
     在主机上安装 Qt：
    </h5>
    <ol>
     <li>
      从
      <a href="https://www.qt.io/download" rel="nofollow" title="Qt 官网">
       Qt 官网
      </a>
      下载并安装适合你的平台的 Qt 工具包。
     </li>
     <li>
      选择安装版本时，确保包括
      <strong>
       Qt for Embedded Linux
      </strong>
      或
      <strong>
       Qt for Device Creation
      </strong>
      （需要商业授权）。
     </li>
    </ol>
    <h5>
     安装必要的工具链（以 Ubuntu 为例）：
    </h5>
    <pre><code>sudo apt update
sudo apt install build-essential cmake g++ gcc git
sudo apt install qtcreator qt5-default qt5-qmake
</code></pre>
    <hr/>
    <h4>
     <strong>
      2.2 配置交叉编译环境
     </strong>
    </h4>
    <p>
     嵌入式系统通常与主机的体系结构不同，需要交叉编译器。
    </p>
    <h5>
     获取交叉编译器
    </h5>
    <ul>
     <li>
      如果你的开发板厂商提供了交叉编译器，直接下载并配置。
     </li>
     <li>
      如果没有，可以使用
      <code>
       yocto
      </code>
      或其他工具生成一个适配目标设备的交叉编译器。
     </li>
    </ul>
    <h5>
     配置 Qt 工具链
    </h5>
    <ol>
     <li>
      在 Qt Creator 中打开
      <strong>
       工具 (Tools) → 选项 (Options) → 构建与运行 (Build &amp; Run)
      </strong>
      。
     </li>
     <li>
      添加交叉编译器路径和编译工具链（通常为 ARM 或 RISC-V）。
     </li>
     <li>
      配置目标设备的 sysroot：
      <ul>
       <li>
        将目标设备的根文件系统（sysroot）通过网络或本地存储复制到主机。
       </li>
       <li>
        设置 sysroot 路径，使交叉编译器能找到目标设备的库和头文件。
       </li>
      </ul>
     </li>
    </ol>
    <h5>
     检查交叉编译器是否可用
    </h5>
    <p>
     在终端中测试交叉编译工具，例如：
    </p>
    <pre><code>arm-linux-gnueabihf-gcc --version
</code></pre>
    <hr/>
    <h4>
     <strong>
      2.3 配置 Qt 工具链与目标设备
     </strong>
    </h4>
    <p>
     Qt 需要在目标设备上运行，因此必须确保目标设备安装了 Qt 库。
    </p>
    <h5>
     安装目标设备上的 Qt 库
    </h5>
    <ol>
     <li>
      如果目标设备没有预装 Qt 库，可以使用交叉编译的方式生成目标设备的 Qt 库。
     </li>
     <li>
      通过
      <code>
       scp
      </code>
      或类似工具将编译好的 Qt 库复制到目标设备。
     </li>
     <li>
      配置环境变量，例如：
      <pre><code>export LD_LIBRARY_PATH=/usr/local/qt5/lib:$LD_LIBRARY_PATH
export QT_QPA_PLATFORM=linuxfb # 选择 Framebuffer 模式
</code></pre>
     </li>
    </ol>
    <hr/>
    <h4>
     <strong>
      2.4 使用 Qt Creator 开发 UI
     </strong>
    </h4>
    <h5>
     创建一个 Qt 项目
    </h5>
    <ol>
     <li>
      打开 Qt Creator，选择
      <strong>
       文件 → 新建项目
      </strong>
      。
     </li>
     <li>
      选择
      <strong>
       Qt Widgets Application
      </strong>
      或
      <strong>
       Qt Quick Application
      </strong>
      ，适合嵌入式设备开发的界面。
     </li>
     <li>
      配置项目文件（
      <code>
       *.pro
      </code>
      ）以支持交叉编译：
      <pre><code># 指定交叉编译工具链
QMAKE_CC = arm-linux-gnueabihf-gcc
QMAKE_CXX = arm-linux-gnueabihf-g++
QMAKE_LINK = arm-linux-gnueabihf-g++
QMAKE_AR = arm-linux-gnueabihf-ar
</code></pre>
     </li>
     <li>
      添加必需的模块：
      <pre><code>QT += widgets # 对于 Qt Widgets
QT += quick   # 对于 Qt Quick
</code></pre>
     </li>
    </ol>
    <h5>
     设计 UI
    </h5>
    <ul>
     <li>
      使用
      <strong>
       Qt Designer
      </strong>
      拖放式工具快速设计用户界面。
     </li>
     <li>
      可以直接在
      <code>
       MainWindow.ui
      </code>
      文件中设计布局。
     </li>
    </ul>
    <hr/>
    <h4>
     <strong>
      2.5 部署到目标设备
     </strong>
    </h4>
    <h5>
     生成可执行文件
    </h5>
    <ol>
     <li>
      在 Qt Creator 中选择交叉编译的构建配置（Release 或 Debug）。
     </li>
     <li>
      点击
      <strong>
       编译 (Build)
      </strong>
      ，生成目标设备架构的可执行文件。
     </li>
    </ol>
    <h5>
     将应用程序复制到目标设备
    </h5>
    <p>
     通过 SCP 或其他工具将可执行文件传输到目标设备，例如：
    </p>
    <pre><code>scp your_app_name target_user@target_ip:/home/target_user/
</code></pre>
    <h5>
     运行 Qt 应用
    </h5>
    <p>
     在目标设备上运行 Qt 应用：
    </p>
    <pre><code>./your_app_name -platform linuxfb
</code></pre>
    <ul>
     <li>
      <strong>
       <code>
        -platform linuxfb
       </code>
      </strong>
      ：使用 Linux framebuffer（无窗口系统）。
     </li>
     <li>
      <strong>
       <code>
        -platform eglfs
       </code>
      </strong>
      ：使用 OpenGL ES 图形加速（如果设备支持）。
     </li>
    </ul>
    <hr/>
    <h4>
     <strong>
      2.6 调试
     </strong>
    </h4>
    <h5>
     使用 Qt Creator 远程调试
    </h5>
    <ol>
     <li>
      配置目标设备的调试工具（如 GDB server）。
     </li>
     <li>
      在 Qt Creator 中设置远程设备的 IP 地址和调试端口。
     </li>
     <li>
      启动远程调试。
     </li>
    </ol>
    <h5>
     检查运行日志
    </h5>
    <p>
     在目标设备上运行时查看日志输出，以排查问题：
    </p>
    <pre><code>export QT_LOGGING_RULES="qt.*=true"
./your_app_name -platform linuxfb
</code></pre>
    <hr/>
    <h3>
     3.
     <strong>
      优化 UI 性能
     </strong>
    </h3>
    <ol>
     <li>
      <p>
       <strong>
        使用 GPU 加速
       </strong>
       ： 如果嵌入式设备支持 OpenGL ES，可以通过配置 Qt 使用 EGLFS 平台进行硬件加速：
      </p>
      <pre><code>./your_app_name -platform eglfs
</code></pre>
     </li>
     <li>
      <p>
       <strong>
        最小化依赖
       </strong>
       ：
      </p>
      <ul>
       <li>
        使用定制化的 Qt 库，只包含项目需要的模块，减小应用体积。
       </li>
       <li>
        使用工具
        <code>
         qt-configure
        </code>
        定制编译 Qt。
       </li>
      </ul>
     </li>
     <li>
      <p>
       <strong>
        降低分辨率
       </strong>
       ： 对于资源受限的设备，适当降低 UI 分辨率和图形元素的复杂度。
      </p>
     </li>
    </ol>
    <hr/>
    <h3>
     4.
     <strong>
      常见问题与解决方法
     </strong>
    </h3>
    <h4>
     设备上运行失败，提示缺少库
    </h4>
    <ul>
     <li>
      确保目标设备上的
      <code>
       LD_LIBRARY_PATH
      </code>
      指向正确的 Qt 库路径。
     </li>
     <li>
      使用
      <code>
       ldd
      </code>
      检查可执行文件依赖：
      <pre><code>ldd ./your_app_name
</code></pre>
     </li>
    </ul>
    <h4>
     Framebuffer 模式下字体缺失
    </h4>
    <ul>
     <li>
      安装必要的字体文件到目标设备：
      <pre><code>sudo apt install ttf-mscorefonts-installer
</code></pre>
     </li>
     <li>
      设置字体路径：
      <pre><code>export QT_QPA_FONTDIR=/usr/share/fonts
</code></pre>
     </li>
    </ul>
    <h4>
     EGLFS 模式崩溃
    </h4>
    <ul>
     <li>
      确认设备的 GPU 驱动已正确安装。
     </li>
     <li>
      确保 Qt 编译时启用了 EGLFS 支持。
     </li>
    </ul>
    <hr/>
    <p>
     通过以上步骤，您可以在嵌入式 Linux 环境下使用 Qt 创建功能强大、性能优秀的用户界面应用程序！
    </p>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f2f62:6c6f672e6373646e2e6e65742f7a797932393138323931382f:61727469636c652f64657461696c732f313434313134393330" class_="artid" style="display:none">
 </p>
</div>
