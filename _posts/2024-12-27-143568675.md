---
layout: post
title: "vue2-配置多个后端-跨越配置"
date: 2024-12-27 15:54:50 +0800
description: "在 Vue 2 项目中，配置多个后端跨域（CORS）代理时，通常是通"
keywords: "vue2 配置跨域"
categories: ['Vue']
tags: ['前端', 'Vue', 'Javascript']
artid: "143568675"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=143568675
    alt: "vue2-配置多个后端-跨越配置"
render_with_liquid: false
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     vue2 配置多个后端 跨越配置
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
     在 Vue 2 项目中，配置多个后端跨域（CORS）代理时，通常是通过 Vue CLI 的
     <code>
      vue.config.js
     </code>
     文件进行配置。以下是如何配置多个后端 API 的跨域代理：
    </p>
    <h4>
     <a id="1__vueconfigjs__2">
     </a>
     1. 在
     <code>
      vue.config.js
     </code>
     中配置代理
    </h4>
    <p>
     在
     <code>
      vue.config.js
     </code>
     文件中，使用
     <code>
      devServer.proxy
     </code>
     来配置代理规则。你可以为不同的后端 API 配置不同的代理规则，来解决跨域问题。
    </p>
    <pre><code class="prism language-js"><span class="token comment">// vue.config.js</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
  devServer<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
    proxy<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
      <span class="token comment">// 后端1的API代理</span>
      <span class="token string">'/api1'</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
        target<span class="token operator">:</span> <span class="token string">'http://backend1.com'</span><span class="token punctuation">,</span> <span class="token comment">// 后端1的地址</span>
        changeOrigin<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 是否改变请求头中的Origin</span>
        pathRewrite<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
          <span class="token string">'^/api1'</span><span class="token operator">:</span> <span class="token string">''</span> <span class="token comment">// 把/api1替换为空，即请求中去掉/api1</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token comment">// 后端2的API代理</span>
      <span class="token string">'/api2'</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
        target<span class="token operator">:</span> <span class="token string">'http://backend2.com'</span><span class="token punctuation">,</span> <span class="token comment">// 后端2的地址</span>
        changeOrigin<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 是否改变请求头中的Origin</span>
        pathRewrite<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
          <span class="token string">'^/api2'</span><span class="token operator">:</span> <span class="token string">''</span> <span class="token comment">// 把/api2替换为空，即请求中去掉/api2</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token comment">// 其他API代理...</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
    <h4>
     <a id="2__33">
     </a>
     2. 访问方式
    </h4>
    <p>
     在你的 Vue 组件中，访问 API 时需要根据配置的代理路径来访问：
    </p>
    <ul>
     <li>
      <p>
       访问第一个后端 API（假设
       <code>
        /api1/xxx
       </code>
       ）：
      </p>
      <pre><code class="prism language-js">axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/api1/endpoint'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">response</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">error</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
     </li>
     <li>
      <p>
       访问第二个后端 API（假设
       <code>
        /api2/xxx
       </code>
       ）：
      </p>
      <pre><code class="prism language-js">axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/api2/endpoint'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">response</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">error</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
     </li>
    </ul>
    <h4>
     <a id="3_pathRewrite__58">
     </a>
     3.
     <code>
      pathRewrite
     </code>
     解释
    </h4>
    <ul>
     <li>
      <code>
       pathRewrite
      </code>
      用来重写路径，它会根据规则将请求路径的某部分去掉或替换。在上面的配置中，
      <code>
       /api1
      </code>
      会被去掉，最终请求会发到
      <code>
       http://backend1.com/endpoint
      </code>
      。
     </li>
     <li>
      如果不需要去掉
      <code>
       /api1
      </code>
      ，你可以省略
      <code>
       pathRewrite
      </code>
      配置。
     </li>
    </ul>
    <h4>
     <a id="4_changeOrigin__62">
     </a>
     4.
     <code>
      changeOrigin
     </code>
     解释
    </h4>
    <ul>
     <li>
      <code>
       changeOrigin
      </code>
      的作用是改变请求头中的
      <code>
       Origin
      </code>
      字段，确保目标后端服务器接收到正确的来源头。在跨域请求时，通常需要将其设置为
      <code>
       true
      </code>
      。
     </li>
    </ul>
    <h4>
     <a id="5__65">
     </a>
     5. 多个后端的跨域配置
    </h4>
    <p>
     你可以为不同的后端配置不同的 API 路径和目标服务器，从而在开发环境中支持多个后端的跨域请求。
    </p>
    <p>
     这样就可以方便地在 Vue 2 项目中配置多个后端 API 的跨域代理了。如果后端服务器还需要其他特殊的配置（比如修改请求头、身份验证等），也可以在
     <code>
      proxy
     </code>
     中配置更多的选项。
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f672e:6373646e2e6e65742f77656978696e5f34343330333632352f:61727469636c652f64657461696c732f313433353638363735" class_="artid" style="display:none">
 </p>
</div>


