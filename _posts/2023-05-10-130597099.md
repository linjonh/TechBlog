---
layout: post
title: 操作系统中ESP和MSR分区
date: 2023-05-10 11:22:07 +0800
description: "分区表的第四个字节为分区类型值，正常的可引导的大于32mb的基本DOS分区值
keywords: esp msr
categories: ['运维']
tags: ['运维', '网络', '服务器']
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=130597099
    alt: 操作系统中ESP和MSR分区
artid: 130597099
render_with_liquid: false
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     操作系统中ESP和MSR分区
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <p>
     操作系统中ESP和MSR分区：
     <br/>
     一：ESP即EFI系统分区：
    </p>
    <p>
     1.全称EFI System Partition,简写为ESP。msr分区本身没有做任何工作，是保留分区。ESP虽然是一个FAT16或者FAT32格式的物理分区，但是其分区标识是EF(十六进制)而非常规的OE或OC。
     <br/>
     因此，该分区在 Windows 操作系统下一般是不可见的。支持EFI模式的电脑需要从ESP启动系统，EFI固件可从ESP加载EFI启动程序和应用程序。
    </p>
    <p>
     2、ESP是一个独立于操作系统之外的分区，操作系统被引导之后，就不再依赖它。这使得ESP非常适合用来存储那些系统级的维护性的工具和数据，比如：引导管理程序、驱动程序、系统维护工具、系统备份等，甚至可以在ESP里安装一个特殊的操作系统。
    </p>
    <p>
     3、ESP也可以看做是一个安全的隐藏的分区，可以把引导管理程序、系统维护工具、系统恢复工具及镜像等放到ESP，可以自己打造“一键恢复系统”。而且，不仅可以自己进行DIY，还要更方便、更通用。
    </p>
    <p>
     二、MSR分区是保留分区
     <br/>
     1、windows不会向msr分区建立文件系统或者写数据，而是为了调整分区结构而保留的分区。在Win8以上系统更新时，会检测msr分区。msr分区本质上就是写在分区表上面的“未分配空间”，目的是微软不想让别人乱动。
    </p>
    <p>
     2、msr分区的用途是防止将一块GPT磁盘接到老系统中，被当作未格式化的空硬盘而继续操作（例如重新格式化）导致数据丢失。GPT磁盘上有了这个分区，当把它接入XP等老系统中，会提示无法识别的磁盘，也无法进一步操作。
    </p>
    <p>
     扩展资料：
    </p>
    <p>
     磁盘分区：
     <br/>
     计算机中存放信息的主要的存储设备就是硬盘，但是硬盘不能直接使用，必须对硬盘进行分割，分割成的一块一块的硬盘区域就是磁盘分区。在传统的磁盘管理中，将一个硬盘分为两大类分区：主分区和扩展分区。
     <br/>
     主分区是能够安装操作系统，能够进行计算机启动的分区，这样的分区可以直接格式化，然后安装系统，直接存放文件。
    </p>
    <p>
     目的：
     <br/>
     分区允许在一个磁盘上有多个文件系统。有许多理由需要这么做：
    </p>
    <p>
     1、有利于管理，系统一般单独放一个区，这样由于系统区只放系统，其他区不会受到系统盘出现磁盘碎片的性能影响。
     <br/>
     2、碍于技术限制（例如旧版的微软FAT文件系统不能访问超过一定的磁盘空间；旧的PC BIOS不允许从超过硬盘1024个柱面的位置启动操作系统）
     <br/>
     3、如果一个分区出现逻辑损坏，仅损坏的分区而不是整个硬盘受影响。
     <br/>
     4、在一些操作系统（如Linux）交换文件通常自己就是一个分区。在这种情况下，双重启动配置的系统就可以让几个操作系统使用同一个交换分区以节省磁盘空间。
     <br/>
     5、避免过大的日志或者其他文件占满导致整个计算机故障，将它们放在独立的分区，这样可能只有那一个分区出现空间耗尽。
     <br/>
     6、两个操作系统经常不能存在同一个分区上或者使用不同的“本地”磁盘格式。为了不同的操作系统，将磁盘分成不同的逻辑磁盘。
     <br/>
     7、许多文件系统使用固定大小的簇将文件写到磁盘上，这些簇的大小与所在分区文件系统大小直接成比例。如果一个文件大小不是簇大小的整数倍，文件簇组中的最后一个将会有不能被其它文件使用的空闲空间。
    </p>
    <p>
     这样，使用簇的文件系统使得文件在磁盘上所占空间超出它们在内存中所占空间，并且越大的分区意味着越大的簇大小和越大的浪费空间。所以，使用几个较小的分区而不是大分区可以节省空间。
    </p>
    <p>
     8、每个分区可以根据不同的需求定制。例如，如果一个分区很少往里写数据，就可以将它加载为只读。如果想要许多小文件，就需要使用有许多节点的文件系统分区。
     <br/>
     9、在运行Unix的多用户系统上，有可能需要防止用户的硬连结攻击。为了达到这个目的，/home和/tmp路径必须与如/var和/etc下的系统文件分开。
    </p>
    <p>
     分区类型：
     <br/>
     硬盘分区之后，会形成3种形式的分区状态；即主分区、扩展分区和非DOS分区。
     <br/>
     非DOS分区：
     <br/>
     在硬盘中非DOS分区(Non-DOS Partition)是一种特殊的分区形式，它是将硬盘中的一块区域单独划分出来供另一个操作系统使用，对主分区的操作系统来讲，是一块被划分出去的存储空间。只有非DOS分区的操作系统才能管理和使用这块存储区域。
    </p>
    <p>
     主分区：
     <br/>
     主分区则是一个比较单纯的分区，通常位于硬盘的最前面一块区域中，构成逻辑C磁盘。其中的主引导程序是它的一部分，此段程序主要用于检测硬盘分区的正确性，并确定活动分区，负责把引导权移交给活动分区的DOS或其他操作系统。
    </p>
    <p>
     此段程序损坏将无法从硬盘引导，但从软驱或光驱引导之后可对硬盘进行读写。
    </p>
    <p>
     扩展分区：
     <br/>
     而扩展分区的概念是比较复杂的，极容易造成硬盘分区与逻辑磁盘混淆；分区表的第四个字节为分区类型值，正常的可引导的大于32mb的基本DOS分区值为06，扩展的DOS分区值是05。如果把基本DOS分区类型改为05则无法启动系统 ，并且不能读写其中的数据。
    </p>
    <p>
     如果把06改为DOS不识别的类型如efh，则DOS认为该分区不是DOS分区，当然无法读写。很多人利用此类型值实现单个分区的加密技术，恢复原来的正确类型值即可使该分区恢复正常。
    </p>
    <p>
     磁盘分区管理方式：
     <br/>
     磁盘分区的管理方法已经不能完全满足系统的需要了，所以操作系统分都有了各种新的磁盘管理方法了。比如windows已经出现了一种动态磁盘的管理方法，linux的LVM管理方法等等。
    </p>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f672e:6373646e2e6e65742f77656978696e5f34383334353137372f:61727469636c652f64657461696c732f313330353937303939" class_="artid" style="display:none">
 </p>
</div>


