---
layout: post
title: "java.security.ProviderException-java.security.KeyException"
date: 2024-12-24 09:27:19 +0800
description: "文章浏览阅读5.问题：在centos6.5上使用openjdk8  用https请求微信api ja"
keywords: "tls 1.3 java.security.providerexception: could not derive key at sun.securit"
categories: ['随记', '各种奇怪问题']
tags: ['无标签']
artid: "52830078"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=52830078
    alt: "java.security.ProviderException-java.security.KeyException"
render_with_liquid: false
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     java.security.ProviderException: java.security.KeyException
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-dark" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
     问题：
    </p>
    <p>
     在centos6.5上使用openjdk8 用https请求微信api
    </p>
    <pre class="prettyprint"><code class="hljs avrasm"><span class="hljs-label">javax.net.ssl.SSLException:</span> java<span class="hljs-preprocessor">.security</span><span class="hljs-preprocessor">.ProviderException</span>: java<span class="hljs-preprocessor">.security</span><span class="hljs-preprocessor">.KeyException</span>
    at sun<span class="hljs-preprocessor">.security</span><span class="hljs-preprocessor">.ssl</span><span class="hljs-preprocessor">.Alerts</span><span class="hljs-preprocessor">.getSSLException</span>(Alerts<span class="hljs-preprocessor">.java</span>:<span class="hljs-number">208</span>)
    at sun<span class="hljs-preprocessor">.security</span><span class="hljs-preprocessor">.ssl</span><span class="hljs-preprocessor">.SSLSocketImpl</span><span class="hljs-preprocessor">.fatal</span>(SSLSocketImpl<span class="hljs-preprocessor">.java</span>:<span class="hljs-number">1949</span>)
    at sun<span class="hljs-preprocessor">.security</span><span class="hljs-preprocessor">.ssl</span><span class="hljs-preprocessor">.SSLSocketImpl</span><span class="hljs-preprocessor">.fatal</span>(SSLSocketImpl<span class="hljs-preprocessor">.java</span>:<span class="hljs-number">1906</span>)
    at sun<span class="hljs-preprocessor">.security</span><span class="hljs-preprocessor">.ssl</span><span class="hljs-preprocessor">.SSLSocketImpl</span><span class="hljs-preprocessor">.handleException</span>(SSLSocketImpl<span class="hljs-preprocessor">.java</span>:<span class="hljs-number">1889</span>)
    at sun<span class="hljs-preprocessor">.security</span><span class="hljs-preprocessor">.ssl</span><span class="hljs-preprocessor">.SSLSocketImpl</span><span class="hljs-preprocessor">.startHandshake</span>(SSLSocketImpl<span class="hljs-preprocessor">.java</span>:<span class="hljs-number">1410</span>)
    at sun<span class="hljs-preprocessor">.security</span><span class="hljs-preprocessor">.ssl</span><span class="hljs-preprocessor">.SSLSocketImpl</span><span class="hljs-preprocessor">.startHandshake</span>(SSLSocketImpl<span class="hljs-preprocessor">.java</span>:<span class="hljs-number">1387</span>)
    at org<span class="hljs-preprocessor">.apache</span><span class="hljs-preprocessor">.http</span><span class="hljs-preprocessor">.conn</span><span class="hljs-preprocessor">.ssl</span><span class="hljs-preprocessor">.SSLSocketFactory</span><span class="hljs-preprocessor">.connectSocket</span>(SSLSocketFactory<span class="hljs-preprocessor">.java</span>:<span class="hljs-number">553</span>)
    at org<span class="hljs-preprocessor">.apache</span><span class="hljs-preprocessor">.http</span><span class="hljs-preprocessor">.conn</span><span class="hljs-preprocessor">.ssl</span><span class="hljs-preprocessor">.SSLSocketFactory</span><span class="hljs-preprocessor">.connectSocket</span>(SSLSocketFactory<span class="hljs-preprocessor">.java</span>:<span class="hljs-number">412</span>)
    at org<span class="hljs-preprocessor">.apache</span><span class="hljs-preprocessor">.http</span><span class="hljs-preprocessor">.impl</span><span class="hljs-preprocessor">.conn</span><span class="hljs-preprocessor">.DefaultClientConnectionOperator</span><span class="hljs-preprocessor">.openConnection</span>(DefaultClientConnectionOperator<span class="hljs-preprocessor">.java</span>:<span class="hljs-number">179</span>)
    at org<span class="hljs-preprocessor">.apache</span><span class="hljs-preprocessor">.http</span><span class="hljs-preprocessor">.impl</span><span class="hljs-preprocessor">.conn</span><span class="hljs-preprocessor">.ManagedClientConnectionImpl</span><span class="hljs-preprocessor">.open</span>(ManagedClientConnectionImpl<span class="hljs-preprocessor">.java</span>:<span class="hljs-number">328</span>)
    at org<span class="hljs-preprocessor">.apache</span><span class="hljs-preprocessor">.http</span><span class="hljs-preprocessor">.impl</span><span class="hljs-preprocessor">.client</span><span class="hljs-preprocessor">.DefaultRequestDirector</span><span class="hljs-preprocessor">.tryConnect</span>(DefaultRequestDirector<span class="hljs-preprocessor">.java</span>:<span class="hljs-number">612</span>)
    at org<span class="hljs-preprocessor">.apache</span><span class="hljs-preprocessor">.http</span><span class="hljs-preprocessor">.impl</span><span class="hljs-preprocessor">.client</span><span class="hljs-preprocessor">.DefaultRequestDirector</span><span class="hljs-preprocessor">.execute</span>(DefaultRequestDirector<span class="hljs-preprocessor">.java</span>:<span class="hljs-number">447</span>)
    at org<span class="hljs-preprocessor">.apache</span><span class="hljs-preprocessor">.http</span><span class="hljs-preprocessor">.impl</span><span class="hljs-preprocessor">.client</span><span class="hljs-preprocessor">.AbstractHttpClient</span><span class="hljs-preprocessor">.doExecute</span>(AbstractHttpClient<span class="hljs-preprocessor">.java</span>:<span class="hljs-number">884</span>)
    at org<span class="hljs-preprocessor">.apache</span><span class="hljs-preprocessor">.http</span><span class="hljs-preprocessor">.impl</span><span class="hljs-preprocessor">.client</span><span class="hljs-preprocessor">.CloseableHttpClient</span><span class="hljs-preprocessor">.execute</span>(CloseableHttpClient<span class="hljs-preprocessor">.java</span>:<span class="hljs-number">82</span>)
    at org<span class="hljs-preprocessor">.apache</span><span class="hljs-preprocessor">.http</span><span class="hljs-preprocessor">.impl</span><span class="hljs-preprocessor">.client</span><span class="hljs-preprocessor">.CloseableHttpClient</span><span class="hljs-preprocessor">.execute</span>(CloseableHttpClient<span class="hljs-preprocessor">.java</span>:<span class="hljs-number">107</span>)
    at org<span class="hljs-preprocessor">.apache</span><span class="hljs-preprocessor">.http</span><span class="hljs-preprocessor">.impl</span><span class="hljs-preprocessor">.client</span><span class="hljs-preprocessor">.CloseableHttpClient</span><span class="hljs-preprocessor">.execute</span>(CloseableHttpClient<span class="hljs-preprocessor">.java</span>:<span class="hljs-number">55</span>)
    ....
    at org<span class="hljs-preprocessor">.apache</span><span class="hljs-preprocessor">.catalina</span><span class="hljs-preprocessor">.core</span><span class="hljs-preprocessor">.ApplicationFilterChain</span><span class="hljs-preprocessor">.internalDoFilter</span>(ApplicationFilterChain<span class="hljs-preprocessor">.java</span>:<span class="hljs-number">192</span>)
    at org<span class="hljs-preprocessor">.apache</span><span class="hljs-preprocessor">.catalina</span><span class="hljs-preprocessor">.core</span><span class="hljs-preprocessor">.ApplicationFilterChain</span><span class="hljs-preprocessor">.doFilter</span>(ApplicationFilterChain<span class="hljs-preprocessor">.java</span>:<span class="hljs-number">165</span>)
    at org<span class="hljs-preprocessor">.apache</span><span class="hljs-preprocessor">.catalina</span><span class="hljs-preprocessor">.core</span><span class="hljs-preprocessor">.StandardWrapperValve</span><span class="hljs-preprocessor">.invoke</span>(StandardWrapperValve<span class="hljs-preprocessor">.java</span>:<span class="hljs-number">198</span>)
    at org<span class="hljs-preprocessor">.apache</span><span class="hljs-preprocessor">.catalina</span><span class="hljs-preprocessor">.core</span><span class="hljs-preprocessor">.StandardContextValve</span><span class="hljs-preprocessor">.invoke</span>(StandardContextValve<span class="hljs-preprocessor">.java</span>:<span class="hljs-number">108</span>)
    at org<span class="hljs-preprocessor">.apache</span><span class="hljs-preprocessor">.catalina</span><span class="hljs-preprocessor">.authenticator</span><span class="hljs-preprocessor">.AuthenticatorBase</span><span class="hljs-preprocessor">.invoke</span>(AuthenticatorBase<span class="hljs-preprocessor">.java</span>:<span class="hljs-number">472</span>)
    at org<span class="hljs-preprocessor">.apache</span><span class="hljs-preprocessor">.catalina</span><span class="hljs-preprocessor">.core</span><span class="hljs-preprocessor">.StandardHostValve</span><span class="hljs-preprocessor">.invoke</span>(StandardHostValve<span class="hljs-preprocessor">.java</span>:<span class="hljs-number">140</span>)
    at org<span class="hljs-preprocessor">.apache</span><span class="hljs-preprocessor">.catalina</span><span class="hljs-preprocessor">.valves</span><span class="hljs-preprocessor">.ErrorReportValve</span><span class="hljs-preprocessor">.invoke</span>(ErrorReportValve<span class="hljs-preprocessor">.java</span>:<span class="hljs-number">79</span>)
    at org<span class="hljs-preprocessor">.apache</span><span class="hljs-preprocessor">.catalina</span><span class="hljs-preprocessor">.valves</span><span class="hljs-preprocessor">.AbstractAccessLogValve</span><span class="hljs-preprocessor">.invoke</span>(AbstractAccessLogValve<span class="hljs-preprocessor">.java</span>:<span class="hljs-number">620</span>)
    at org<span class="hljs-preprocessor">.apache</span><span class="hljs-preprocessor">.catalina</span><span class="hljs-preprocessor">.core</span><span class="hljs-preprocessor">.StandardEngineValve</span><span class="hljs-preprocessor">.invoke</span>(StandardEngineValve<span class="hljs-preprocessor">.java</span>:<span class="hljs-number">87</span>)
    at org<span class="hljs-preprocessor">.apache</span><span class="hljs-preprocessor">.catalina</span><span class="hljs-preprocessor">.connector</span><span class="hljs-preprocessor">.CoyoteAdapter</span><span class="hljs-preprocessor">.service</span>(CoyoteAdapter<span class="hljs-preprocessor">.java</span>:<span class="hljs-number">349</span>)
    at org<span class="hljs-preprocessor">.apache</span><span class="hljs-preprocessor">.coyote</span><span class="hljs-preprocessor">.http</span>11<span class="hljs-preprocessor">.Http</span>11Processor<span class="hljs-preprocessor">.service</span>(Http11Processor<span class="hljs-preprocessor">.java</span>:<span class="hljs-number">784</span>)
    at org<span class="hljs-preprocessor">.apache</span><span class="hljs-preprocessor">.coyote</span><span class="hljs-preprocessor">.AbstractProcessorLight</span><span class="hljs-preprocessor">.process</span>(AbstractProcessorLight<span class="hljs-preprocessor">.java</span>:<span class="hljs-number">66</span>)
    at org<span class="hljs-preprocessor">.apache</span><span class="hljs-preprocessor">.coyote</span><span class="hljs-preprocessor">.AbstractProtocol</span>$ConnectionHandler<span class="hljs-preprocessor">.process</span>(AbstractProtocol<span class="hljs-preprocessor">.java</span>:<span class="hljs-number">802</span>)
    at org<span class="hljs-preprocessor">.apache</span><span class="hljs-preprocessor">.tomcat</span><span class="hljs-preprocessor">.util</span><span class="hljs-preprocessor">.net</span><span class="hljs-preprocessor">.NioEndpoint</span>$SocketProcessor<span class="hljs-preprocessor">.doRun</span>(NioEndpoint<span class="hljs-preprocessor">.java</span>:<span class="hljs-number">1410</span>)
    at org<span class="hljs-preprocessor">.apache</span><span class="hljs-preprocessor">.tomcat</span><span class="hljs-preprocessor">.util</span><span class="hljs-preprocessor">.net</span><span class="hljs-preprocessor">.SocketProcessorBase</span><span class="hljs-preprocessor">.run</span>(SocketProcessorBase<span class="hljs-preprocessor">.java</span>:<span class="hljs-number">49</span>)
    at java<span class="hljs-preprocessor">.util</span><span class="hljs-preprocessor">.concurrent</span><span class="hljs-preprocessor">.ThreadPoolExecutor</span><span class="hljs-preprocessor">.runWorker</span>(ThreadPoolExecutor<span class="hljs-preprocessor">.java</span>:<span class="hljs-number">1142</span>)
    at java<span class="hljs-preprocessor">.util</span><span class="hljs-preprocessor">.concurrent</span><span class="hljs-preprocessor">.ThreadPoolExecutor</span>$Worker<span class="hljs-preprocessor">.run</span>(ThreadPoolExecutor<span class="hljs-preprocessor">.java</span>:<span class="hljs-number">617</span>)
    at org<span class="hljs-preprocessor">.apache</span><span class="hljs-preprocessor">.tomcat</span><span class="hljs-preprocessor">.util</span><span class="hljs-preprocessor">.threads</span><span class="hljs-preprocessor">.TaskThread</span>$WrappingRunnable<span class="hljs-preprocessor">.run</span>(TaskThread<span class="hljs-preprocessor">.java</span>:<span class="hljs-number">61</span>)
    at java<span class="hljs-preprocessor">.lang</span><span class="hljs-preprocessor">.Thread</span><span class="hljs-preprocessor">.run</span>(Thread<span class="hljs-preprocessor">.java</span>:<span class="hljs-number">745</span>)
Caused by: java<span class="hljs-preprocessor">.security</span><span class="hljs-preprocessor">.ProviderException</span>: java<span class="hljs-preprocessor">.security</span><span class="hljs-preprocessor">.KeyException</span>
    at sun<span class="hljs-preprocessor">.security</span><span class="hljs-preprocessor">.ec</span><span class="hljs-preprocessor">.ECKeyPairGenerator</span><span class="hljs-preprocessor">.generateKeyPair</span>(ECKeyPairGenerator<span class="hljs-preprocessor">.java</span>:<span class="hljs-number">147</span>)
    at java<span class="hljs-preprocessor">.security</span><span class="hljs-preprocessor">.KeyPairGenerator</span>$Delegate<span class="hljs-preprocessor">.generateKeyPair</span>(KeyPairGenerator<span class="hljs-preprocessor">.java</span>:<span class="hljs-number">703</span>)
    at sun<span class="hljs-preprocessor">.security</span><span class="hljs-preprocessor">.ssl</span><span class="hljs-preprocessor">.ECDHCrypt</span>.&lt;init&gt;(ECDHCrypt<span class="hljs-preprocessor">.java</span>:<span class="hljs-number">77</span>)
    at sun<span class="hljs-preprocessor">.security</span><span class="hljs-preprocessor">.ssl</span><span class="hljs-preprocessor">.ClientHandshaker</span><span class="hljs-preprocessor">.serverKeyExchange</span>(ClientHandshaker<span class="hljs-preprocessor">.java</span>:<span class="hljs-number">721</span>)
    at sun<span class="hljs-preprocessor">.security</span><span class="hljs-preprocessor">.ssl</span><span class="hljs-preprocessor">.ClientHandshaker</span><span class="hljs-preprocessor">.processMessage</span>(ClientHandshaker<span class="hljs-preprocessor">.java</span>:<span class="hljs-number">281</span>)
    at sun<span class="hljs-preprocessor">.security</span><span class="hljs-preprocessor">.ssl</span><span class="hljs-preprocessor">.Handshaker</span><span class="hljs-preprocessor">.processLoop</span>(Handshaker<span class="hljs-preprocessor">.java</span>:<span class="hljs-number">979</span>)
    at sun<span class="hljs-preprocessor">.security</span><span class="hljs-preprocessor">.ssl</span><span class="hljs-preprocessor">.Handshaker</span><span class="hljs-preprocessor">.process</span>_record(Handshaker<span class="hljs-preprocessor">.java</span>:<span class="hljs-number">914</span>)
    at sun<span class="hljs-preprocessor">.security</span><span class="hljs-preprocessor">.ssl</span><span class="hljs-preprocessor">.SSLSocketImpl</span><span class="hljs-preprocessor">.readRecord</span>(SSLSocketImpl<span class="hljs-preprocessor">.java</span>:<span class="hljs-number">1062</span>)
    at sun<span class="hljs-preprocessor">.security</span><span class="hljs-preprocessor">.ssl</span><span class="hljs-preprocessor">.SSLSocketImpl</span><span class="hljs-preprocessor">.performInitialHandshake</span>(SSLSocketImpl<span class="hljs-preprocessor">.java</span>:<span class="hljs-number">1375</span>)
    at sun<span class="hljs-preprocessor">.security</span><span class="hljs-preprocessor">.ssl</span><span class="hljs-preprocessor">.SSLSocketImpl</span><span class="hljs-preprocessor">.startHandshake</span>(SSLSocketImpl<span class="hljs-preprocessor">.java</span>:<span class="hljs-number">1403</span>)
    ... <span class="hljs-number">57</span> more
Caused by: java<span class="hljs-preprocessor">.security</span><span class="hljs-preprocessor">.KeyException</span>
    at sun<span class="hljs-preprocessor">.security</span><span class="hljs-preprocessor">.ec</span><span class="hljs-preprocessor">.ECKeyPairGenerator</span><span class="hljs-preprocessor">.generateECKeyPair</span>(Native Method)
    at sun<span class="hljs-preprocessor">.security</span><span class="hljs-preprocessor">.ec</span><span class="hljs-preprocessor">.ECKeyPairGenerator</span><span class="hljs-preprocessor">.generateKeyPair</span>(ECKeyPairGenerator<span class="hljs-preprocessor">.java</span>:<span class="hljs-number">128</span>)
    ... <span class="hljs-number">66</span> more</code></pre>
    <p>
     原因
    </p>
    <p>
     dd /usr/lib/jvm/lib/amd64/libsunec.so 依赖的是libnss,所以更新libnss即可
    </p>
    <p>
     解决：
    </p>
    <p>
     1.更新nss
    </p>
    <pre class="prettyprint"><code class="hljs bash"><span class="hljs-built_in">sudo</span> yum upgrade nss</code></pre>
    <p>
     2.重启服务器
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470:733a2f2f626c6f672e6373646e2e6e65742f73696d706c7479:2f61727469636c652f64657461696c732f3532383330303738" class_="artid" style="display:none">
 </p>
</div>


