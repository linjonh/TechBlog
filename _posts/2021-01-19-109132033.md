---
layout: post
title: "标准工业控制编程语言IEC61131-3简述"
date: 2021-01-19 14:37:21 +0800
description: "IEC61131-3定义了PLC的软件结构、编程语言和程序执行方式，"
keywords: "iec61131-3"
categories: ['编程语言']
tags: ['编程语言', '3']
artid: "109132033"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=109132033
    alt: "标准工业控制编程语言IEC61131-3简述"
render_with_liquid: false
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     标准工业控制编程语言IEC61131-3简述
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-atom-one-light" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
     <strong>
      参考文献
     </strong>
     <br/>
     [1] 王永华. 现代电气控制及PLC应用技术[M]. 第5版. 北京:北京航空航天大学出版社, 2018.
     <br/>
     [2] 台达. ISPSoft软件使用手册[M]. 第10版. , 2019.
    </p>
    <p>
     写这篇文章时，除了对IEC61131-3基本内容做摘录以外，也参考了遵循IEC61131-3标准的控制器用户手册内容，目的是了解IEC61131-3标准的实际落地情况。
    </p>
    <p>
     <em>
      本文档不介绍OOP新标准部分。
     </em>
    </p>
    <h2>
     <a id="1_7">
     </a>
     1简述
    </h2>
    <p>
     IEC61131-3是IEC61131标准的第三部分，它定义了PLC的软件结构、编程语言和程序执行方式，它综合了世界上广泛流行的编程语言的特点，并使其成为一种面向未来的PLC编程语言。IEC61131-3提供了5种PLC的标准编程语言，其中有3种图形语言：
     <strong>
      梯形图（LAD）、功能块图（FBD）和顺序功能图（SFC）
     </strong>
     ；两种文本语言：
     <strong>
      结构化文本（ST）和指令表（IL）
     </strong>
     。其中使用IL、LAD、SFC编制的程序都可以相互转换后进行显示、编辑。
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/2e200ed8609440bcb1030ba366a919d7.png" width="200"/>
    </p>
    <blockquote>
     <p>
      SFC在新标准中作为一种公共元素出现，其目的是要把它定义成构成PLC程序和功能块内部组织的元素，但其实质仍是一种编程语言，且主流出版物都将其作为一种编程语言看待。
     </p>
    </blockquote>
    <p>
     传统PLC程序架构与IEC61131-3程序架构区别见下：
    </p>
    <table>
     <thead>
      <tr>
       <th>
        传统PLC程序架构
       </th>
       <th>
        IEC61131-3 程序架构
       </th>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td>
        主程序
       </td>
       <td>
        1. 将单一的程序切割为许多独立的程序单元（Prog POU）。
        <br/>
        2. 将建立的程序单元指定为周期性的工作（TASK）。
       </td>
      </tr>
      <tr>
       <td>
        一般子程序
       </td>
       <td>
        1. 将子程序建立为功能块（FB POU）。
        <br/>
        2. 在其它的程序单元中对建立好的功能块（FB）进行调用。
       </td>
      </tr>
      <tr>
       <td>
        中断子程序
       </td>
       <td>
        1. 为不同的中断程序，分别建立独立的程序单元（Prog POU）。
        <br/>
        2. 将建立好的程序单元指定至对应的中断型工作（TASK）中。
       </td>
      </tr>
     </tbody>
    </table>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/605bc29d9cfe53c0159c07485a11ac99.png" width="500">
      <br/>
      IEC61131-3软件模型见下：
      <br/>
      <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/f6b3499cc35f2ef7d0becf189b874827.png" width="450"/>
     </img>
    </p>
    <h2>
     <a id="2_23">
     </a>
     2编程基础
    </h2>
    <h3>
     <a id="21POU_24">
     </a>
     2.1程序组织单元POU
    </h3>
    <h4>
     <a id="_25">
     </a>
     基本概念
    </h4>
    <p>
     在模块化程序设计环境下，
     <strong>
      程序组织单元POU（Program Organization Unit）
     </strong>
     是用户程序中最小的、独立的软件单元。它相当于传统编程系统中的块（Blocks），POU之间可以带参数或不带参数地相互调用。
     <br/>
     在IEC61131-3中定义了三种类型的POU，按其功能的递增顺序依次为函数（Function，FUN）、功能块（Function Block，FB）和程序（Program，PROG）。
    </p>
    <ol>
     <li>
      <strong>
       FUN
      </strong>
      （函数）
      <br/>
      FUN是可以赋予参数但没有静态变量（没有记忆）的POU，当以相同的输入参数调用时，它总是生成相同的结果作为函数输出，例如算术运算指令。
     </li>
    </ol>
    <blockquote>
     <p>
      函数没有存储器，不存储暂态结果、状态信息或内部数据，故称其无记忆。
     </p>
    </blockquote>
    <ol start="2">
     <li>
      <strong>
       FB
      </strong>
      （功能块）
      <br/>
      FB是可以赋予参数并具有静态变量（有记忆）的POU，当以相同的输入参数调用时，它的输出状态取决于
      <strong>
       其内部和外部变量的状态
      </strong>
      ，它能记忆状态信息，例如定时器和计数器等。
     </li>
     <li>
      <strong>
       PROG
      </strong>
      （程序）
      <br/>
      PROG代表PLC用户的最高层，即程序，它能存取PLC的IO变量，这些IO变量必须在POU或其上层中予以说明。
      <br/>
      在IEC61131-3中，一个程序可由多个部分组成，而每个部分所使用的编程语言不一定是相同的。
     </li>
    </ol>
    <h4>
     <a id="POU_38">
     </a>
     POU的定义
    </h4>
    <pre><code class="prism language-c">PROGRAM 程序名<span class="token operator">/</span>FUNCTION_BLOCK 功能块名<span class="token operator">/</span>FUNCTION 函数名：数据类型
	主体
END_PROGRAM<span class="token operator">/</span>END_FUNCTION_BLOCK<span class="token operator">/</span>END_FUNCTION
</code></pre>
    <h4>
     <a id="POU_44">
     </a>
     POU的相互调用
    </h4>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/c1ccd3d53f23a203568aa27599fe9a0e.png" width="350">
      <br/>
      <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/bddd0eee08af1cfbbd49a65db7a0a32b.png" width="350"/>
     </img>
    </p>
    <h3>
     <a id="22_48">
     </a>
     2.2简单语言元素
    </h3>
    <p>
     PLC程序是由一定数量的
     <strong>
      基本语言元素
     </strong>
     （最小单元）组成的，把它们组合在一起形成“说明”或“语句”。
    </p>
    <ol>
     <li>
      <strong>
       分界符
      </strong>
      <br/>
      用在“说明”或语句中起隔离、标识等作用。
      <br/>
      逗号用于隔开多个变量；分号标识ST中一条语句的结束；星号+括号（**）之间存放对程序和语句的解释部分；冒号加等号标识ST编程语句中的赋值等。
     </li>
     <li>
      <strong>
       关键字
      </strong>
      <br/>
      包括：数据类型名称；标准FUN、FB名称及其输入（仅FB）/输出参数名称；某些变量、运算符和语言元素。
      <br/>
      关键字对大小写没有严格规定（大小写不敏感），但在实际使用时常用大写来表示关键字。
     </li>
     <li>
      <strong>
       直接量
      </strong>
      <br/>
      表示某些常数的数值，有三种类型：数字直接量，字符串，时间直接量
     </li>
     <li>
      <strong>
       标识符
      </strong>
      <br/>
      用于命名各种变量、程序、配置、资源等。
     </li>
    </ol>
    <h3>
     <a id="23_60">
     </a>
     2.3数据类型
    </h3>
    <p>
     IEC61131-3定义了PLC编程中最常用的数据类型，并允许用户自己定义导出的数据类型。
    </p>
    <ol>
     <li>
      <strong>
       基本数据类型
      </strong>
      <br/>
      <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/b0449b639567ae9e7b7119a115a5f81a.png" width="550"/>
     </li>
    </ol>
    <blockquote>
     <p>
      类（ANY）数据类型：类数据类型由单个数据类型集合而成，ANY-INT表示所有整数的数据类型。
     </p>
    </blockquote>
    <ol start="2">
     <li>
      <strong>
       导出数据类型
      </strong>
      <br/>
      在基本数据类型的基础上，用户自定义数据类型的过程称为
      <strong>
       导出
      </strong>
      或类型定义（即类型重命名，相当于C语言的typeof），这种用新名词定义的数据类型称为
      <strong>
       导出数据类型
      </strong>
      。
     </li>
    </ol>
    <pre><code class="prism language-c">TYPE 
	新名称<span class="token operator">:</span> 变量类型<span class="token punctuation">;</span>
	PRESSURE<span class="token operator">:</span> REAL<span class="token punctuation">;</span> <span class="token comment">//此处将REAL数据类型重命名为PRESSURE</span>
END_TYPE
</code></pre>
    <ol start="3">
     <li>
      <strong>
       结构化数据类型
      </strong>
      <br/>
      以一个压力传感器的结构化数据类型定义举例：
     </li>
    </ol>
    <pre><code class="prism language-c">TYPE PRESSURE_SENSOR
	STRUCT
		INPUT<span class="token operator">:</span> PRESSURE<span class="token punctuation">;</span>
		STATUS<span class="token operator">:</span> BOOL<span class="token punctuation">;</span>
		CALIBRATION<span class="token operator">:</span> REAL<span class="token punctuation">;</span>
		ALARM_COUNT<span class="token operator">:</span> INT<span class="token punctuation">;</span>
	END_STRUCT
END_TYPE
</code></pre>
    <ol start="4">
     <li>
      <strong>
       枚举
      </strong>
      <br/>
      枚举允许对同一变量的不同状态（不同值）定义不同名字，如设备工作状态包含初始状态、运行状态、停止状态和故障状态。
     </li>
    </ol>
    <pre><code class="prism language-c">TYPE DEVICE_MODE<span class="token operator">:</span>
	<span class="token punctuation">(</span>INITIALISING<span class="token punctuation">,</span>RUNNING<span class="token punctuation">,</span>STANDBY<span class="token punctuation">,</span>FAULTY<span class="token punctuation">)</span>
END_TYPE
</code></pre>
    <p>
     在编程中使用导出数据类型时，使用”数据类型#具体变量名“
    </p>
    <pre><code class="prism language-c">G <span class="token operator">:</span><span class="token operator">=</span> DEVICE_MODE#INITIALISIN<span class="token punctuation">;</span>
</code></pre>
    <ol start="5">
     <li>
      <strong>
       数组
      </strong>
      <br/>
      支持多维数组。
     </li>
    </ol>
    <pre><code class="prism language-c"><span class="token punctuation">(</span><span class="token operator">*</span>一维数组<span class="token operator">*</span><span class="token punctuation">)</span>
TYPE VESSEL_PRESS_DATA<span class="token operator">:</span>
	ARRAY<span class="token punctuation">[</span><span class="token number">1.</span><span class="token number">.20</span><span class="token punctuation">]</span> OF PRESSURE<span class="token punctuation">;</span> 
<span class="token function">END_TYPE</span>
<span class="token punctuation">(</span><span class="token operator">*</span>二维数组<span class="token operator">*</span><span class="token punctuation">)</span>
TYPE VESSEL_PRESS_DATA<span class="token operator">:</span>
	ARRAY<span class="token punctuation">[</span><span class="token number">1.</span><span class="token number">.20</span>， <span class="token number">1.</span><span class="token number">.2</span><span class="token punctuation">]</span> OF PRESSURE<span class="token punctuation">;</span>
END_TYPE
</code></pre>
    <p>
     部分IEC编译器对数组上界有限制，如上界必须未0，不得指定任意值。
    </p>
    <p>
     <strong>
      关于数据范围
     </strong>
     <br/>
     在对变量进行数据类型定义时可增加。
    </p>
    <pre><code class="prism language-c">TYPE
	<span class="token function">PRESSURE</span><span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">.</span><span class="token number">.30</span><span class="token number">.0</span><span class="token punctuation">)</span><span class="token operator">:</span> REAL<span class="token punctuation">;</span> <span class="token punctuation">(</span><span class="token operator">*</span>压力范围<span class="token number">0.1</span><span class="token operator">~</span><span class="token number">30</span><span class="token operator">*</span><span class="token punctuation">)</span>
END_TYPE
</code></pre>
    <p>
     <strong>
      关于初始值
     </strong>
     <br/>
     数据变量的初始缺省值是0，字符串的初始缺省值是空串‘’（对STRING）或""（对WSTRING），日期的缺省值是“D#0001-01-01”。
     <br/>
     外部变量和输入/输出变量以外的数据变量可定义初始值。
    </p>
    <h3>
     <a id="24_123">
     </a>
     2.4变量
    </h3>
    <h4>
     <a id="241_124">
     </a>
     2.4.1主要变量类型简介
    </h4>
    <p>
     在编制POU之前，必须对变量进行定义和声明，使用变量的地方不同，所使用的变量也会有区别。
    </p>
    <ol>
     <li>
      <strong>
       输入变量
      </strong>
      VAR_INPUT：定义变量为POU入参，在编写FUN、FB时用到
     </li>
     <li>
      <strong>
       输出变量
      </strong>
      VAR_OUTPUT：定义变量为POU出参，在编写FUN、FB时用到
     </li>
     <li>
      <strong>
       输入/输出变量
      </strong>
      VAR_IN_OUT：定义变量为POU引用参数（兼具入参和出参功能），在编写FUN、FB时用到
     </li>
     <li>
      <strong>
       全局变量
      </strong>
      VAR_GLOBAL，该变量可在结构、源或程序中任何POU（除FB）中使用
     </li>
     <li>
      <strong>
       外部变量
      </strong>
      VAR_EXTERNAL，用于解决全局变量、直接地址变量和FB之间的连接问题
     </li>
     <li>
      <strong>
       临时变量
      </strong>
      VAR_TEMP：在POU内部定义的一种可以存储中间计算结果的变量，周期结束时将执行初始化
     </li>
     <li>
      <strong>
       存取通径变量
      </strong>
      VAR_ACCESS 它提供了一种配置（Configuration）之间进行数据交换（通信）的渠道
     </li>
    </ol>
    <blockquote>
     <p>
      输入/输出概念不同于外部物理输入/输出，而是用于FUN/FB的接口定义。
     </p>
    </blockquote>
    <h4>
     <a id="242__135">
     </a>
     2.4.2 变量类型的属性
    </h4>
    <p>
     在IEC61131-3中设置了一些限定符，使用它们可以将附加的特性赋给变量。
     <br/>
     <strong>
      RETAIN
     </strong>
     具有带电保持功能的变量。
     <br/>
     <strong>
      CONSTANT
     </strong>
     常数变量（带有变量名的常数）。
    </p>
    <p>
     （下述两种属性只对VAR_INPUT有效）
     <br/>
     <strong>
      R_EDGE
     </strong>
     上升沿。
     <br/>
     <strong>
      Q_EDGE
     </strong>
     下降沿。
    </p>
    <blockquote>
     <p>
      当用到上升沿或下降沿功能时，更多会使用相应标准功能块。
     </p>
    </blockquote>
    <p>
     （下述两种属性只对VAR_ACCESS有效）
     <br/>
     <strong>
      READ_ONLY
     </strong>
     只读
     <br/>
     <strong>
      READ_WRITE
     </strong>
     读写
    </p>
    <h4>
     <a id="243_148">
     </a>
     2.4.3定义变量
    </h4>
    <p>
     模板：
    </p>
    <pre><code class="prism language-c">VAR_变量类型 属性
	变量名 数据类型<span class="token operator">:</span><span class="token operator">=</span> 初始值；
END_VAR
</code></pre>
    <p>
     举例：
    </p>
    <pre><code class="prism language-c">VAR_OUTPUT RETAIN
	Motor1<span class="token operator">:</span> BOOL <span class="token operator">:</span><span class="token operator">=</span> FALSE<span class="token punctuation">;</span>
	Message<span class="token operator">:</span> <span class="token function">STRING</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
END_VAR
</code></pre>
    <p>
     可以以逗号隔开的方式连续定义几个相同类型的变量:
    </p>
    <pre><code class="prism language-c">VAR_变量类型 属性
	变量名<span class="token number">1</span><span class="token punctuation">,</span>变量名<span class="token number">2</span><span class="token punctuation">,</span>变量名<span class="token number">3</span> 数据类型 <span class="token operator">:</span><span class="token operator">=</span> 初始值；
	SB1<span class="token punctuation">,</span>SB2<span class="token punctuation">,</span>SB3 BOOL<span class="token operator">:</span><span class="token operator">=</span> FALSE<span class="token punctuation">;</span>
END_VAR
</code></pre>
    <h4>
     <a id="244_170">
     </a>
     2.4.4变量地址的直接表示
    </h4>
    <p>
     在传统PLC中，当使用其内部资源（软元件）时，用的是直接地址。在IEC61131-3中，这种变量也可以
     <strong>
      用地址直接表达或以符号变量的形式
     </strong>
     出现（即使用变量来表达地址）。它们以%开始，然后表示I（输入）、Q（输出）和M（中间继电器）的字母，接下来是表示PLC地址数据宽度的字母，如X（位）、B（字节）、W（字）、D（双字）等，最后使用分级地址表示的具体的直接地址。对这种变量进行说明时，要通过关键字
     <strong>
      AT
     </strong>
     指定。
    </p>
    <pre><code class="prism language-c">VAR
	var0 AT <span class="token operator">%</span>IX0<span class="token punctuation">.</span><span class="token number">0</span><span class="token operator">:</span> BOOL<span class="token punctuation">;</span>
	var1 AT <span class="token operator">%</span>QB1<span class="token operator">:</span> USINT<span class="token punctuation">;</span>
	var2 AT <span class="token operator">%</span>MW2<span class="token operator">:</span> INT<span class="token punctuation">;</span>
	var2 AT <span class="token operator">%</span>MD3<span class="token operator">:</span> DINT<span class="token punctuation">;</span>
END_VAR
</code></pre>
    <blockquote>
     <p>
      分级地址，位置的数量和解释取决于制造商。Z-位、Y-字、X-模块、W-机架、V-PLC
     </p>
    </blockquote>
    <h3>
     <a id="25_183">
     </a>
     2.5资源
    </h3>
    <p>
     PLC的处理器被称为
     <strong>
      资源
     </strong>
     （RESOURCE）。对资源可以进行定义或说明，定义从关键词RESOURCE开始，以END_RESOURCE结束。在资源说明中，其内容一般包括全局变量说明、通径变量说明和任务定义等。（这里的全局变量限于同一个资源。）
    </p>
    <pre><code class="prism language-vbnet">RESOURCE 资源名 <span class="token keyword">ON</span> Resource
	全局变量说明
	TASK说明
END_RESOURCE
</code></pre>
    <h3>
     <a id="26_191">
     </a>
     2.6任务
    </h3>
    <p>
     定义任务的目的在于
     <strong>
      规定程序以及功能块的运行期特性
     </strong>
     。
    </p>
    <p>
     在实时控制系统中，由于控制对象不同阶段的任务和工作过程不同，相应的程序也不同，因而需要对这些不同的程序进行灵活调用和组态。
     <br/>
     在IEC61131-3中，若干个程序能同时运行于同一个资源，它们可以有不同的优先权和类型，即程序可以是单周期执行、循环执行、按不同优先级执行。实现这样的功能由
     <strong>
      任务
     </strong>
     （TASK）来完成，每一个程序与一个（或多个）任务相
     <strong>
      关联
     </strong>
     （使用关键字WITH），这样就可以使程序进入运行期。
    </p>
    <p>
     任务运行方式可分为自由运行、周期以及事件。
    </p>
    <ul>
     <li>
      自由运行（Freewheeling）：自由运行任务没有固定持续时间，一个运行周期结束后即重启任务；
     </li>
     <li>
      周期（cyclic）： 任务按照设定的周期事件执行；
     </li>
     <li>
      事件（event）：仅在指定的事件发生时执行一次；
     </li>
    </ul>
    <p>
     通常控制器无法同时执行多个任务（不支持多线程）。每个任务须分配一个唯一的
     <strong>
      优先顺序（Priority）
     </strong>
     ，相同运行方式的任务按照设定的优先顺序执行，其中0为最高优先级；对于不同运行方式的任务，当条件同时成立时，其运行顺序为：事件&gt;自由运行&gt;周期。
    </p>
    <p>
     同一个任务下可以关联多个程序POU，其排列顺序则会决定各POU实际执行时的顺序。
     <br/>
     未关联的程序拥有最低优先权，仍会被以自由运行方式执行；
     <strong>
      但实际上绝大部分厂商会将其设置为不会参与执行
     </strong>
     。
    </p>
    <h3>
     <a id="27_207">
     </a>
     2.7配置
    </h3>
    <p>
     使用配置（CONFIGURATION）将PLC系统的所有资源集合起来。
    </p>
    <pre><code class="prism language-vbnet">CONFIGURATION 变量名
	全局变量说明
	RESOURCE说明
	<span class="token function">ACCESS</span>说明
END_CONFIGURATION
</code></pre>
    <h2>
     <a id="3_216">
     </a>
     3标准函数及功能块
    </h2>
    <p>
     IEC61131-3中定义了典型的PLC函数和功能块，它们的名字作为关键字保留。
     <br/>
     <strong>
      注意：
     </strong>
     编程软件不一定能提供IEC61131-3全部标准函数。
    </p>
    <h3>
     <a id="31_219">
     </a>
     3.1标准函数
    </h3>
    <p>
     IEC61131-3定义了以下8组标准函数：
    </p>
    <ol>
     <li>
      数据类型转换函数
     </li>
     <li>
      数值函数
     </li>
     <li>
      算术函数
     </li>
     <li>
      位-串函数
     </li>
     <li>
      选择和比较函数
     </li>
     <li>
      字符串函数
     </li>
     <li>
      用于时间数据类型的函数（未单独列出）
     </li>
     <li>
      用于枚举数据类型的函数（未单独列出）
     </li>
    </ol>
    <p>
     <strong>
      重载（Overload）
     </strong>
     <br/>
     若函数的输入变量以类数据类型描述，则称为重载。使用重载函数时，编程系统会自动选择合适的类型化函数。
     <br/>
     可以把一个重载的标准函数限制为某一数据类型，称为
     <strong>
      类型化（Typed）的标准函数
     </strong>
     ，这时需要把一个下划线及相应数据类型附加到该函数名字后。
     <br/>
     <strong>
      可扩展（Extensible）
     </strong>
     <br/>
     若函数的输入变量数可变，则称其为可扩展的。
    </p>
    <h3>
     <a id="32_235">
     </a>
     3.2标准功能块
    </h3>
    <p>
     功能块是一种重要的POU，它按一定的算法和动作组成一段程序，在某一个给定条件下产生新的输出数据，类似子程序。
     <br/>
     功能块有输入变量、输出变量、内部变量以及临时变量等。功能块的程序段由各种算法、动作和传递等组成。当功能块执行时，它会组合属于它的变量和程序来产生新的输出数据和内部数据。
     <br/>
     功能块和函数之间最大的区别就是它有
     <strong>
      储存功能
     </strong>
     ，因而被应用于需要有数据保持功能的地方。
     <br/>
     使用功能块时需要将其
     <strong>
      实例化
     </strong>
     ，简单来讲就是给使用的功能块取专用名，编程系统会自动生成内部绝对编号。
     <br/>
     IEC61131-3定义了5组
     <strong>
      标准功能块
     </strong>
     ：双稳态元素（置复位）、边沿检测、计数器、定时器和通信。
    </p>
    <h2>
     <a id="4_IEC611313_241">
     </a>
     4 IEC61131-3编程语言及使用举例
    </h2>
    <p>
     此处仅列举梯形图（LD）和结构化文本（ST）。
    </p>
    <h3>
     <a id="41LD_243">
     </a>
     4.1梯形图LD
    </h3>
    <p>
     梯形图编程语言是从继电器控制系统原理图的基础上演变而来的，其基本思想是一致的，只是在使用符号和表达方式上有一定区别。梯形图适合在以开关量为主的简单的顺序逻辑控制系统中使用，在复杂的具有数值计算的过程控制系统或逻辑判断系统中，显得不够方便和灵活。
    </p>
    <p>
     梯形图的一个关键概念是
     <strong>
      能流
     </strong>
     （能流在梯形图中实际上不存在，引入此概念是为了和继电接触器控制系统相比较）。在梯形图中，把左边的母线假想为电源相线，右边的母线假想为电源零线。如果有能流从左至右流向线圈，则线圈通电；如没有能流，则线圈不通电。能流在任何时候都不会通过触点自右向左流。
    </p>
    <p>
     IEC61131-3为用户提供了线条连接、触点、线圈、执行控制等常用的基本元素，线条连接元素包括水平连接和垂直连接等。不建议在LD中使用执行控制类的指令。
    </p>
    <h3>
     <a id="42ST_249">
     </a>
     4.2结构化文本ST
    </h3>
    <p>
     结构化文本编程语言ST是一种文本化的高级编程语言，源自PASCAL，适合数值计算、循环和选择等复杂应用的场合。
    </p>
    <h4>
     <a id="421_251">
     </a>
     4.2.1表达式和操作符
    </h4>
    <p>
     ST中最基本的元素是表达式，表达式由操作数和操作符组成。操作数为直接量或变量。操作符的优先级决定一个表达式中的计算顺序。
    </p>
    <h4>
     <a id="422_253">
     </a>
     4.2.2常用语句
    </h4>
    <p>
     一个ST程序由一定数量的语句组成，语句间用分号（；）隔开，注释需放在两个星号（**）之间。
    </p>
    <ol>
     <li>
      <strong>
       赋值语句
      </strong>
      :=
     </li>
    </ol>
    <pre><code class="prism language-vbnet">a <span class="token punctuation">:</span><span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
</code></pre>
    <ol start="2">
     <li>
      <strong>
       条件判断语句
      </strong>
      IF
     </li>
    </ol>
    <pre><code class="prism language-vbnet"><span class="token keyword">IF</span><span class="token operator">&lt;</span>条件<span class="token number">1</span><span class="token operator">&gt;</span>
<span class="token keyword">THEN</span><span class="token operator">&lt;</span>语句块<span class="token number">1</span><span class="token operator">&gt;</span>
[ELSIF<span class="token operator">&lt;</span>语句块<span class="token number">2</span><span class="token operator">&gt;</span>] <span class="token punctuation">(</span><span class="token operator">*</span>可省<span class="token operator">*</span><span class="token punctuation">)</span>
[<span class="token keyword">ELSE</span><span class="token operator">&lt;</span>语句块<span class="token number">3</span><span class="token operator">&gt;</span>] <span class="token punctuation">(</span><span class="token operator">*</span>可省<span class="token operator">*</span><span class="token punctuation">)</span>
END_IF<span class="token punctuation">;</span>
</code></pre>
    <p>
     举例：
    </p>
    <pre><code class="prism language-vbnet"><span class="token keyword">IF</span> A <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">THEN</span>
	B <span class="token punctuation">:</span><span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
ELSIF A <span class="token operator">=</span> <span class="token number">2</span> <span class="token keyword">THEN</span>
	B <span class="token punctuation">:</span><span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token keyword">ELSE</span>
	B<span class="token punctuation">:</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
END_IF<span class="token punctuation">;</span>
</code></pre>
    <p>
     IF语句可进行嵌套，ELSE部分可进行判断的嵌套，即使用ELSIF…THEN…ELSE语句。
    </p>
    <ol start="3">
     <li>
      <strong>
       多重选择语句CASE
      </strong>
     </li>
    </ol>
    <pre><code class="prism language-vbnet"><span class="token keyword">CASE</span> <span class="token operator">&lt;</span>整数表达式<span class="token operator">&gt;</span> <span class="token keyword">OF</span>
  <span class="token operator">&lt;</span>整数选择值<span class="token operator">&gt;</span>：<span class="token operator">&lt;</span>语句块<span class="token number">1</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>整数选择值<span class="token operator">&gt;</span>：<span class="token operator">&lt;</span>语句块<span class="token number">2</span><span class="token operator">&gt;</span>
  ...
<span class="token keyword">ELSE</span>
 <span class="token operator">&lt;</span>备选语句块<span class="token operator">&gt;</span>
END_CASE<span class="token punctuation">;</span>
</code></pre>
    <p>
     常被当做CASE状态机。
     <br/>
     整数选择值除了可以是一个数，也可以是一组数（2，3，4：）或一个数值范围内的数（5…10：），或者参数化的变量。
    </p>
    <ol start="4">
     <li>
      <strong>
       迭代循环语句FOR
      </strong>
     </li>
    </ol>
    <pre><code class="prism language-vbnet"><span class="token keyword">FOR</span> <span class="token operator">&lt;</span>索引变量<span class="token operator">&gt;</span><span class="token punctuation">:</span><span class="token operator">=</span><span class="token operator">&lt;</span>起始值<span class="token operator">&gt;</span> <span class="token keyword">TO</span> <span class="token operator">&lt;</span>结束值<span class="token operator">&gt;</span> [BY<span class="token operator">&lt;</span>增量值<span class="token operator">&gt;</span>]  <span class="token keyword">DO</span>
	<span class="token operator">&lt;</span>语句块<span class="token operator">&gt;</span><span class="token punctuation">;</span>
END_FOR<span class="token punctuation">;</span>
</code></pre>
    <p>
     省略BY时，默认增量值为1.
    </p>
    <ol start="5">
     <li>
      <p>
       <strong>
        RETURN语句
       </strong>
       <br/>
       用于中止当前的POU的执行。
      </p>
     </li>
     <li>
      <p>
       <strong>
        EXIT语句
       </strong>
       <br/>
       使程序跳出当前迭代语句的循环。
       <br/>
       嵌套循环时，可使用EXIT语句跳出内部循环，执行外部循环。
      </p>
     </li>
    </ol>
    <h4>
     <a id="423_311">
     </a>
     4.2.3函数和功能块的调用
    </h4>
    <p>
     函数只有一个返回值，其调用属于表达式的范畴；FB的调用属于语句的范畴，因为FB可能有多个输出值，所以在一个表达式中不允许调用FB。
     <br/>
     由于一个形式参数包括每个参数的名称和实际值，因此形式参数的顺序是任意的。 如果不写参数
     <br/>
     允许在调用时使用“=&gt;”，直接把输出值赋给指定变量。
    </p>
    <h2>
     <a id="_315">
     </a>
     更新记录
    </h2>
    <p>
     2021.1.19 初次发布；
     <br/>
     2022.1.2 例行维护；
     <br/>
     2022.9.10 例行维护；
     <br/>
     2024.12.29 修正笔误；重写描述不合理的部分；
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f626c6f672e:6373646e2e6e65742f77656978696e5f34353236333632362f:61727469636c652f64657461696c732f313039313332303333" class_="artid" style="display:none">
 </p>
</div>


