---
layout: post
title: "微信小程序小程序与服务端的http通信"
date: 2024-12-05 19:03:07 +0800
description: "文章浏览阅读7k次，点赞10次，文章目录搭建服务端小程序小程序与服务端通信get请求小程序向服务端发"
keywords: "截取微信小程序与服务器的通信"
categories: ['微信小程序']
tags: []
artid: "109464100"
image:
    path: https://api.vvhan.com/api/bing?rand=sj&artid=109464100
    alt: "微信小程序小程序与服务端的http通信"
render_with_liquid: false
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     【微信小程序】小程序与服务端的http通信
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="markdown_views prism-tomorrow-night-eighties" id="content_views">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
     <path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">
     </path>
    </svg>
    <p>
    </p>
    <div class="toc">
     <h4>
      文章目录
     </h4>
     <ul>
      <li>
       <ul>
        <li>
         <ul>
          <li>
           <ul>
            <li>
             <a href="#_1" rel="nofollow">
              搭建服务端
             </a>
            </li>
            <li>
             <a href="#_26" rel="nofollow">
              小程序
             </a>
            </li>
            <li>
             <a href="#_54" rel="nofollow">
              小程序与服务端通信
             </a>
            </li>
            <li>
             <ul>
              <li>
               <a href="#get_55" rel="nofollow">
                get请求
               </a>
              </li>
              <li>
               <ul>
                <li>
                 <a href="#_56" rel="nofollow">
                  小程序向服务端发送数据
                 </a>
                </li>
                <li>
                 <a href="#_93" rel="nofollow">
                  服务端接收小程序发送过来的数据
                 </a>
                </li>
               </ul>
              </li>
              <li>
               <a href="#post_118" rel="nofollow">
                post请求
               </a>
              </li>
              <li>
               <ul>
                <li>
                 <a href="#_119" rel="nofollow">
                  小程序向服务端发送数据
                 </a>
                </li>
                <li>
                 <a href="#_146" rel="nofollow">
                  服务端接收小程序发送过来的数据
                 </a>
                </li>
                <li>
                 <a href="#_175" rel="nofollow">
                  请求前后的状态处理
                 </a>
                </li>
               </ul>
              </li>
             </ul>
            </li>
           </ul>
          </li>
         </ul>
        </li>
       </ul>
      </li>
     </ul>
    </div>
    <p>
    </p>
    <h5>
     <a id="_1">
     </a>
     搭建服务端
    </h5>
    <pre><code class="prism language-bash"><span class="token function">npm</span> <span class="token function">install</span> -save-dev express
</code></pre>
    <pre><code class="prism language-javascript"><span class="token comment">// server.js</span>
<span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"express"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> server <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

server<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">"/test"</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span>res<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
        foo<span class="token punctuation">:</span><span class="token string">"hello"</span><span class="token punctuation">,</span>
        bar<span class="token punctuation">:</span><span class="token string">"world"</span>
    <span class="token punctuation">}</span>
    res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
server<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span>res<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">"&lt;h1&gt;hello world&lt;/h1&gt;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"listening on *:3000"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
    <p>
     <code>
      node server.js
     </code>
     启动服务器，浏览器便可访问网址
     <code>
      http://localhost:3000/
     </code>
     。
    </p>
    <h5>
     <a id="_26">
     </a>
     小程序
    </h5>
    <pre><code class="prism language-html"><span class="token comment">&lt;!-- index.wxml --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name"><span class="token namespace">bind:</span>tap</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>handleClick<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>click me<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
</code></pre>
    <pre><code class="prism language-javascript"><span class="token comment">// index.js</span>
<span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
    handleClick<span class="token punctuation">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        wx<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
            url<span class="token punctuation">:</span><span class="token string">"http://localhost:3000/test"</span><span class="token punctuation">,</span>
            success<span class="token punctuation">:</span><span class="token keyword">function</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                <span class="token keyword">const</span> <span class="token punctuation">{<!-- --></span>data<span class="token punctuation">}</span> <span class="token operator">=</span> res<span class="token punctuation">;</span>
                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
    <p>
     点击
     <kbd>
      click me
     </kbd>
     ，出现如下错误警告：
     <br/>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/c4c1b2110a8078e4396c8ea3e8dce1b1.png">
      <br/>
      解决方法是，设置&gt;项目设置&gt;勾选“不校验合法域名、web-view(业务域名)、TLS版本以及HTTPS证书”。
      <br/>
      <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/eb42bcce0c26689516987997e48e71f0.png">
       <br/>
       点击
       <kbd>
        click me
       </kbd>
       ，控制台打印出响应数据。
      </img>
     </img>
    </p>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/4baec5f99f72f3a6f21d1217f111f35c.gif"/>
    </p>
    <h5>
     <a id="_54">
     </a>
     小程序与服务端通信
    </h5>
    <h6>
     <a id="get_55">
     </a>
     get请求
    </h6>
    <h6>
     <a id="_56">
     </a>
     小程序向服务端发送数据
    </h6>
    <p>
     小程序向服务端发送数据，有两种方式。
    </p>
    <ul>
     <li>
      第一种：数据以查询字符串的形式放在url中
     </li>
    </ul>
    <pre><code class="prism language-javascript"><span class="token comment">// index.js</span>
<span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
    handleClick<span class="token punctuation">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        wx<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
            url<span class="token punctuation">:</span><span class="token string">"http://localhost:3000/test?id=1&amp;version=1.0.0"</span><span class="token punctuation">,</span>
            success<span class="token punctuation">:</span><span class="token keyword">function</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                <span class="token keyword">const</span> <span class="token punctuation">{<!-- --></span>data<span class="token punctuation">}</span> <span class="token operator">=</span> res<span class="token punctuation">;</span>
                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
    <p>
     第二种：数据放到
     <code>
      data
     </code>
     字段中
    </p>
    <pre><code class="prism language-javascript"><span class="token comment">// index.js</span>
<span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
    handleClick<span class="token punctuation">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        wx<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
            url<span class="token punctuation">:</span><span class="token string">"http://localhost:3000/test"</span><span class="token punctuation">,</span>
            data<span class="token punctuation">:</span><span class="token punctuation">{<!-- --></span>
                id<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">,</span>
                version<span class="token punctuation">:</span><span class="token string">"1.0.0"</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            success<span class="token punctuation">:</span><span class="token keyword">function</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                <span class="token keyword">const</span> <span class="token punctuation">{<!-- --></span>data<span class="token punctuation">}</span> <span class="token operator">=</span> res<span class="token punctuation">;</span>
                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
    <h6>
     <a id="_93">
     </a>
     服务端接收小程序发送过来的数据
    </h6>
    <p>
     服务端通过
     <code>
      req.query
     </code>
     获取小程序发送过来的数据
    </p>
    <pre><code class="prism language-javascript"><span class="token comment">// server.js</span>
<span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"express"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> server <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

server<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">"/test"</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span>res<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">const</span> <span class="token punctuation">{<!-- --></span>id<span class="token punctuation">,</span>version<span class="token punctuation">}</span> <span class="token operator">=</span> req<span class="token punctuation">.</span>query<span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"id:"</span><span class="token operator">+</span>id<span class="token operator">+</span><span class="token string">",version:"</span><span class="token operator">+</span>version<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
        foo<span class="token punctuation">:</span><span class="token string">"hello"</span><span class="token punctuation">,</span>
        bar<span class="token punctuation">:</span><span class="token string">"world"</span>
    <span class="token punctuation">}</span>
    res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
server<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span>res<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">"&lt;h1&gt;hello world&lt;/h1&gt;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"listening on *:3000"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/e50203d6565abf8b1c7c1142e0f63aa7.gif"/>
    </p>
    <h6>
     <a id="post_118">
     </a>
     post请求
    </h6>
    <h6>
     <a id="_119">
     </a>
     小程序向服务端发送数据
    </h6>
    <pre><code class="prism language-javascript"><span class="token comment">// index.js</span>
<span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
    handleClick<span class="token punctuation">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        wx<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
            url<span class="token punctuation">:</span><span class="token string">"http://localhost:3000/test"</span><span class="token punctuation">,</span>
            method<span class="token punctuation">:</span><span class="token string">"post"</span><span class="token punctuation">,</span>
            header<span class="token punctuation">:</span><span class="token punctuation">{<!-- --></span><span class="token string">"content-type"</span><span class="token punctuation">:</span><span class="token string">"application/json"</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            data<span class="token punctuation">:</span><span class="token punctuation">{<!-- --></span>
                foo<span class="token punctuation">:</span><span class="token punctuation">{<!-- --></span>
                    idx<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">,</span>
                    title<span class="token punctuation">:</span><span class="token string">"hello"</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                bar<span class="token punctuation">:</span><span class="token punctuation">{<!-- --></span>
                    idx<span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">,</span>
                    title<span class="token punctuation">:</span><span class="token string">"world"</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            success<span class="token punctuation">:</span><span class="token keyword">function</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                <span class="token keyword">const</span> <span class="token punctuation">{<!-- --></span>data<span class="token punctuation">}</span> <span class="token operator">=</span> res<span class="token punctuation">;</span>
                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
    <h6>
     <a id="_146">
     </a>
     服务端接收小程序发送过来的数据
    </h6>
    <pre><code class="prism language-bash"><span class="token function">npm</span> <span class="token function">install</span> --save-dev body-parser
</code></pre>
    <pre><code class="prism language-javascript"><span class="token comment">// server.js</span>
<span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"express"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> server <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> bodyParser <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"body-parser"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
server<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>bodyParser<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
server<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">"/test"</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span>res<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">const</span> <span class="token punctuation">{<!-- --></span>foo<span class="token punctuation">,</span>bar<span class="token punctuation">}</span> <span class="token operator">=</span> req<span class="token punctuation">.</span>body<span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"foo"</span><span class="token punctuation">,</span>foo<span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"bar"</span><span class="token punctuation">,</span>bar<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
        foo<span class="token punctuation">:</span><span class="token string">"hello"</span><span class="token punctuation">,</span>
        bar<span class="token punctuation">:</span><span class="token string">"world"</span>
    <span class="token punctuation">}</span>
    res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
server<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span>res<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">"&lt;h1&gt;hello world&lt;/h1&gt;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"listening on *:3000"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/69095dc04cfeb03e40f110ba2b4c8831.gif"/>
    </p>
    <h6>
     <a id="_175">
     </a>
     请求前后的状态处理
    </h6>
    <ul>
     <li>
      <code>
       success
      </code>
      <br/>
      只要服务器返回响应，无论http状态码是多少都会进入success回调
     </li>
     <li>
      <code>
       fail
      </code>
      <br/>
      接口调用失败的回调函数
     </li>
     <li>
      <code>
       complete
      </code>
      <br/>
      接口调用结束的回调函数，无论调用成功或失败都会执行
     </li>
    </ul>
    <pre><code class="prism language-javascript"><span class="token comment">// index.js</span>
<span class="token keyword">var</span> hasClick <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
    handleClick<span class="token punctuation">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>hasClick<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
        hasClick <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        wx<span class="token punctuation">.</span><span class="token function">showLoading</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        wx<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
            url<span class="token punctuation">:</span><span class="token string">"http://localhost:3000/test"</span><span class="token punctuation">,</span>
            method<span class="token punctuation">:</span><span class="token string">"post"</span><span class="token punctuation">,</span>
            header<span class="token punctuation">:</span><span class="token punctuation">{<!-- --></span><span class="token string">"content-type"</span><span class="token punctuation">:</span><span class="token string">"application/json"</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            data<span class="token punctuation">:</span><span class="token punctuation">{<!-- --></span>
                foo<span class="token punctuation">:</span><span class="token punctuation">{<!-- --></span>
                    idx<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">,</span>
                    title<span class="token punctuation">:</span><span class="token string">"hello"</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                bar<span class="token punctuation">:</span><span class="token punctuation">{<!-- --></span>
                    idx<span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">,</span>
                    title<span class="token punctuation">:</span><span class="token string">"world"</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            success<span class="token punctuation">:</span><span class="token keyword">function</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                <span class="token keyword">if</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>statusCode <span class="token operator">===</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            fail<span class="token punctuation">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                wx<span class="token punctuation">.</span><span class="token function">showToast</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
                    title<span class="token punctuation">:</span><span class="token string">"系统错误"</span><span class="token punctuation">,</span>
                    icon<span class="token punctuation">:</span><span class="token string">"none"</span><span class="token punctuation">,</span>
                    duration<span class="token punctuation">:</span><span class="token number">1000</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            complete<span class="token punctuation">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                wx<span class="token punctuation">.</span><span class="token function">hideLoading</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                hasClick <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
    <pre><code class="prism language-javascript"><span class="token comment">// server.js</span>
<span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"express"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> server <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> bodyParser <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"body-parser"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
server<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>bodyParser<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
server<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">"/test"</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span>res<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">const</span> <span class="token punctuation">{<!-- --></span>foo<span class="token punctuation">,</span>bar<span class="token punctuation">}</span> <span class="token operator">=</span> req<span class="token punctuation">.</span>body<span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"foo"</span><span class="token punctuation">,</span>foo<span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"bar"</span><span class="token punctuation">,</span>bar<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
        foo<span class="token punctuation">:</span><span class="token string">"hello"</span><span class="token punctuation">,</span>
        bar<span class="token punctuation">:</span><span class="token string">"world"</span>
    <span class="token punctuation">}</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">500</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
server<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span>res<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">"&lt;h1&gt;hello world&lt;/h1&gt;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"listening on *:3000"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
    <p>
     <img alt="在这里插入图片描述" src="https://i-blog.csdnimg.cn/blog_migrate/3e153d6de67adfca897e2ed5574c789a.gif"/>
    </p>
   </div>
   <link href="../../assets/css/markdown_views-a5d25dd831.css" rel="stylesheet"/>
   <link href="../../assets/css/style-e504d6a974.css" rel="stylesheet"/>
  </div>
 </article>
 <p alt="68747470733a2f2f626c:6f672e6373646e2e6e65742f717a773735323839303931332f:61727469636c652f64657461696c732f313039343634313030" class_="artid" style="display:none">
 </p>
</div>


