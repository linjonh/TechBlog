---
layout: post
title: "微信公众号本地环境搭建解决微信接口需要公网地址,但是只有本地环境的问题"
date: 2024-12-31 03:00:00 +0800
description: "目前移动开发处于比较火的的趋势,很多的开发者都跃跃欲试,目前移动App开发领域主要分为以下几种类型　"
keywords: "公众号请求地址是本地的怎么办"
categories: ["未分类"]
tags: ["无标签"]
artid: "79005228"
image:
  path: https://api.vvhan.com/api/bing?rand=sj&artid=79005228
  alt: "微信公众号本地环境搭建解决微信接口需要公网地址,但是只有本地环境的问题"
render_with_liquid: false
---

<div class="blog-content-box">
 <div class="article-header-box">
  <div class="article-header">
   <div class="article-title-box">
    <h1 class="title-article" id="articleContentId">
     微信公众号本地环境搭建（解决微信接口需要公网地址，但是只有本地环境的问题）
    </h1>
   </div>
  </div>
 </div>
 <article class="baidu_pl">
  <div class="article_content clearfix" id="article_content">
   <link href="../../assets/css/kdoc_html_views-1a98987dfd.css" rel="stylesheet"/>
   <link href="../../assets/css/ck_htmledit_views-704d5b9767.css" rel="stylesheet"/>
   <div class="htmledit_views" id="content_views">
    <div class="blogpost-body" id="cnblogs_post_body" style="margin-bottom:20px; word-break:break-word; color:rgb(0,0,0); font-family:Verdana,Geneva,Arial,Helvetica,sans-serif; font-size:13px">
     <p style="margin:10px auto">
      <span style="line-height:1.5">
      </span>
      <span style="line-height:1.5">
       目前移动开发处于比较火的的趋势,很多的开发者都跃跃欲试,目前移动App开发领域主要分为以下几种类型
      </span>
     </p>
     <p style="margin:10px auto">
      <img alt="" src="https://i-blog.csdnimg.cn/blog_migrate/2d182a3f740dd62930948d6f4667d425.png" style="border:1px solid black; max-width:900px"/>
     </p>
     <p style="margin:10px auto">
      我在平时的工作中接触得比较多的就是基于Android的Native App开发和基于微信公众号的Light App开发,今天就来带领大家快速进入微信公众号的开发领域.
     </p>
     <h3 id="blogTitle0" style="margin-top:10px; margin-bottom:10px; font-size:21px; line-height:1.5">
      一、微信开发环境搭建
      <strong>
       <br/>
      </strong>
     </h3>
     <p style="margin:10px auto">
      <strong>
      </strong>
      工欲善其事，必先利其器。要做微信公众号开发，那么要先准备好两样必不可少的东西：
     </p>
     <p style="margin:10px auto">
      1、要有一个
      <span style="line-height:19.5px; color:rgb(0,0,0)">
       用来
       <span style="line-height:19.5px; color:rgb(255,0,0)">
        <strong>
         测试的公众号。
        </strong>
       </span>
      </span>
     </p>
     <p style="margin:10px auto">
      2、用来
      <span style="line-height:19.5px; color:rgb(255,0,0)">
       <strong>
        调式代码的开发环境
       </strong>
      </span>
      。
     </p>
     <h4 id="blogTitle1" style="font-size:16px; line-height:1.5; margin-top:10px; margin-bottom:10px">
      1.1、注册测试公众号
     </h4>
     <p style="margin:10px auto">
      微信公众号分为服务号、订阅号、企业号，订阅号可以个人申请，服务号和企业号要有企业资质才可以。
     </p>
     <p style="margin:10px auto">
      <img alt="" src="" style="border:1px solid black; max-width:900px"/>
     </p>
     <p style="margin:10px auto">
      我们所说的微信公众号开发指的是订阅号和服务号。
     </p>
     <p style="margin:10px auto">
      关于订阅号和服务器的区别，官方是这样解释的
     </p>
     <p align="left" style="margin:10px auto">
      <strong>
       服务号
      </strong>
      ：主要偏向于服务交互（功能类似12315，114，银行，提供绑定信息，服务交互），每月可群发4条消息；服务号
      <strong>
       适用人群：
      </strong>
      媒体、企业、政府或其他组织。
     </p>
     <p align="left" style="margin:10px auto">
      <strong>
       订阅号
      </strong>
      ：主要偏向于为用户传达资讯，（功能类似报纸杂志，为用户提供新闻信息或娱乐趣事），每天可群发1条消息；订阅号
      <strong>
       适用人群
      </strong>
      ：个人、媒体、企业、政府或其他组织。
     </p>
     <p align="left" style="margin:10px auto">
      个人订阅号有一些接口是没有权限的，也就是说个人订阅号无法调用一些高级的权限接口，下图就是一个我的个人订阅号所具备权限列表，如下图所示：
     </p>
     <p align="left" style="margin:10px auto">
      <img alt="" src="https://i-blog.csdnimg.cn/blog_migrate/ae98e2b09430108c923459a2ffd0b8b1.png" style="border:1px solid black; max-width:900px" width="950"/>
     </p>
     <p align="left" style="margin:10px auto">
      而一些高级接口，如生成二维码、网页授权、自定义菜单、微信支付这样的接口权限个人订阅号是没有调用权限的，如上图红色框起来的那些接口，个人订阅号都无法调用。
     </p>
     <p style="margin:10px auto">
      幸运的是，
      <strong>
       <span style="line-height:19.5px; color:rgb(255,0,0)">
        微信公众平台提供了测试公众账号
       </span>
      </strong>
      ，测试公众号的注册地址为：
      <a href="http://mp.weixin.qq.com/debug/cgi-bin/sandbox?t=sandbox/login" rel="nofollow noopener noreferrer" style="color:rgb(7,93,179)" target="_blank">
       <span style="line-height:19.5px; color:rgb(255,0,0)">
        <strong>
         http://mp.weixin.qq.com/debug/cgi-bin/sandbox?t=sandbox/login
        </strong>
       </span>
      </a>
      ，只需要到这个页面，点击登录，并用自己的微信客户端扫码，并授权登录，就可以获得属于自己的测试公众号。
      <span style="line-height:19.5px; color:rgb(255,0,0)">
       <strong>
        测试公众号具备几乎所有的接口
       </strong>
      </span>
      ，所以平时学习微信公众号开发时，就可以去注册一个测试公众号，然后使用这个测试公众号做开发就可以了。不废话了，还是先注册一个测试公众号吧
     </p>
     <p style="margin:10px auto">
      访问
      <a href="http://mp.weixin.qq.com/debug/cgi-bin/sandbox?t=sandbox/login" rel="nofollow noopener noreferrer" style="color:rgb(7,93,179)" target="_blank">
       http://mp.weixin.qq.com/debug/cgi-bin/sandbox?t=sandbox/login
      </a>
      ，注册一个测试公众号。
     </p>
     <p style="margin:10px auto">
      注册测试公众号的步骤如下图所示：
     </p>
     <p style="margin:10px auto">
      <img alt="" src="https://i-blog.csdnimg.cn/blog_migrate/f75fadf5db63a596f908cb6fc918e198.jpeg" style="border:0px; max-width:900px" width="950"/>
     </p>
     <p style="margin:10px auto">
     </p>
     <p style="margin:10px auto">
      <img alt="" src="https://i-blog.csdnimg.cn/blog_migrate/131f6a97235d438bab5b667f613336f1.png" style="border:0px; max-width:900px"/>
     </p>
     <p style="margin:10px auto">
      用微信扫描上述的二维码进行登录，登录成功后，就可以看到腾讯分配给我们的测试公众号的信息了，如下图所示：
     </p>
     <p style="margin:10px auto">
      <img alt="" src="https://i-blog.csdnimg.cn/blog_migrate/9d8f30bbf79983e009b45051b58e1966.jpeg" style="border:1px solid black; max-width:900px" width="950"/>
     </p>
     <p style="margin:10px auto">
      测试公众号的所拥有的接口权限如下：
     </p>
     <p style="margin:10px auto">
      <img alt="" src="https://i-blog.csdnimg.cn/blog_migrate/7fe17d7f9fa0e0b3db896d8813926bad.png" style="border:1px solid black; max-width:900px" width="950"/>
     </p>
     <p style="margin:10px auto">
      可以看到，测试公众号拥有大部分的接口调用权限，因此
      <span style="line-height:19.5px; color:rgb(255,0,0)">
       <strong>
        用测试公众号来学习微信开发是完全可以的
       </strong>
      </span>
      。
     </p>
     <h4 id="blogTitle2" style="font-size:16px; line-height:1.5; margin-top:10px; margin-bottom:10px">
      1.2、搭建微信本地调试环境
     </h4>
     <p style="margin:10px auto">
      开发基于微信公众号的应用最大的痛苦之处就是调试问题，每次实现一个功能后都需要部署到一个公网服务器进行测试，因为微信用户每次向公众号发起请求时，微信服务器会先接收到用户的请求，然后再转发到我们的服务器上，也就是说，微信服务器是要和我们的服务器进行网络交互，所以我们必须保证我们的服务器外网可以访问到，这种部署到公网服务器进行测试的做法对于我们开发者来说简直是噩梦。所以我们要想一个办法可以做到本地部署，本地调试代码，而要做到这一点，那么我们要解决的问题就是将内网的部署服务器映射到外网，让微信服务器可以正常访问到，幸运的是，借助于第三方软件Ngrok，我们就可以做得到。
      <span style="line-height:19.5px; color:rgb(255,0,0)">
       <strong>
        Ngrok是一个免费的软件Ngrok,使用Ngrok后,我们就可以实现内网穿透,也就是说我们可以将内网的服务器映射到外网给别人访问
       </strong>
      </span>
      ,这对于我们在本地开发环境中调试微信代码是以及给用户演示一些东西非常快速和有帮助的,因为可以直接使用我们自己的内网的电脑作为服务器。
     </p>
     <p style="margin:10px auto">
      国内提供Ngrok服务比较好的网站是:http://natapp.cn/,如下图所示:
     </p>
     <p style="margin:10px auto">
      <img alt="" src="" style="border:0px; max-width:900px"/>
     </p>
     <p style="margin:10px auto">
      从http://natapp.cn/网站上下载ngrok客户端,如下图所示:
     </p>
     <p style="margin:10px auto">
      <img alt="" src="" style="border:1px solid black; max-width:900px"/>
     </p>
     <p style="margin:10px auto">
      下载完成后,得到一个
      <img alt="" src="" style="border:0px; max-width:900px"/>
      压缩包,解压压缩包后,得到一个
      <img alt="" src="" style="border:0px; max-width:900px"/>
      文件夹,里面有如下图所示的几个文件:
     </p>
     <p style="margin:10px auto">
      <img alt="" src="" style="border:0px; max-width:900px"/>
     </p>
     <p style="margin:10px auto">
      打开CMD命令行窗口,进入到ngrok_windows目录下,然后输入如下命令:
     </p>
     <p style="margin:10px auto">
      ngrok -config ngrok.cfg -subdomain xdp 8080,如下图所示:
     </p>
     <p style="margin:10px auto">
      <img alt="" src="" style="border:0px; max-width:900px"/>
     </p>
     <p style="margin:10px auto">
      xdp是我自己自定义的一个域名, 8080为本地服务器的运行端口,执行完上述命令后,我们就可以本地的127.0.0.1:8080服务器映射到外网了,如下图所示:
     </p>
     <p style="margin:10px auto">
      <img alt="" src="" style="border:0px; max-width:900px"/>
     </p>
     <p style="margin:10px auto">
      此时外网的用户可以直接使用http://xdp.ngrok.natapp.cn这个域名访问到我内网的127.0.0.1:8080服务器了,如下图所示:
     </p>
     <p style="margin:10px auto">
      <img alt="" src="" style="border:0px; max-width:900px"/>
     </p>
     <p style="margin:10px auto">
      <img alt="" src="" style="border:0px; max-width:900px"/>
     </p>
     <p style="margin:10px auto">
      <span style="line-height:19.5px; color:rgb(255,0,0)">
       <strong>
        使用了ngrok之后,我们就可以把内网的服务器当成公网服务器来使用了
       </strong>
      </span>
      .访问的速度也还在可以接受的范围内吧，截止到目前为止ngrok是可用的，微信公众号服务器是可以访问的，这样一来也就不妨碍我们做本地调式了。到此，我们的微信本地调试开发环境就算是搭建好了。
     </p>
     <p style="margin:10px auto">
      万丈高楼平地起，我们已经跨出了微信开发的第一步了！
     </p>
    </div>
    <div class="clear" style="clear:both; color:rgb(0,0,0); font-family:Verdana,Geneva,Arial,Helvetica,sans-serif; font-size:13px">
    </div>
    <div id="blog_post_info_block" style="margin-top:20px; color:rgb(0,0,0); font-family:Verdana,Geneva,Arial,Helvetica,sans-serif; font-size:13px">
     <div id="BlogPostCategory" style="margin-bottom:10px">
      分类:
      <a href="http://www.cnblogs.com/xdp-gacl/category/608526.html" rel="nofollow noopener noreferrer" style="color:rgb(7,93,179)" target="_blank">
       微信开发
      </a>
     </div>
    </div>
   </div>
  </div>
 </article>
 <p alt="68747470733a2f2f:626c6f672e6373646e2e6e65742f6368616f70696f6e656572:2f61727469636c652f64657461696c732f3739303035323238" class_="artid" style="display:none">
 </p>
</div>
