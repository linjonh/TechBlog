---
permalink: /:basename
---
/*!
 * jekyll-theme-chirpy v7.2.4 | © 2019 Cotes Chung | MIT Licensed | https://github.com/cotes2020/jekyll-theme-chirpy/
 */
!function(){"use strict";importScripts("./assets/js/data/swconf.js");const e=swconf.purge,t=swconf.interceptor;function r(r,s){r.respondWith(caches.match(s).then((r=>r||fetch(s).then((r=>{const n=s.url;if(e||"GET"!==s.method||!function(e){const r=new URL(e),s=r.pathname;if(!r.protocol.startsWith("http"))return!1;for(const e of t.urlPrefixes)if(r.href.startsWith(e))return!1;for(const e of t.paths)if(s.startsWith(e))return!1;return!0}(n))return r;let c=r.clone();return caches.open(swconf.cacheName).then((e=>{e.put(s,c)})),r})))))}self.addEventListener("install",(t=>{e||t.waitUntil(caches.open(swconf.cacheName).then((e=>e.addAll(swconf.resources))))})),self.addEventListener("activate",(t=>{t.waitUntil(caches.keys().then((t=>Promise.all(t.map((t=>e||t!==swconf.cacheName?caches.delete(t):void 0))))))})),self.addEventListener("message",(e=>{"SKIP_WAITING"===e.data&&self.skipWaiting()})),self.addEventListener("fetch",(e=>{let t=e.request;if(t.headers.has("range"))return;const s="https://api.allorigins.win";if(t.url.includes("csdnimg.cn")){const s=t.url,n="https://api.allorigins.win/raw?url="+encodeURIComponent(s),c=new Request(n,{method:t.method,headers:t.headers,body:t.body,mode:t.mode,credentials:t.credentials,cache:t.cache,redirect:t.redirect,referrer:t.referrer,integrity:t.integrity});r(e,c),console.log("Request Headers:",[...c.headers.entries()])}else if(t.url.includes(s)&&t.url.endsWith(".ts")){let n=t.url.replace(s+"/","");console.log("handle ts file："+n),caches.matchAll().then((s=>{s.forEach((s=>{s.url.endsWith(".m3u8")&&(console.log("macth m3u8:"+s.url),s.text().then((c=>{if(c.includes(n)){const c=new URL(s.url),a=new URL(n,c.origin+c.pathname.substring(0,c.pathname.lastIndexOf("/")+1));console.log(a);const i=new Request(a,{method:t.method,headers:t.headers,body:t.body,mode:t.mode,credentials:t.credentials,cache:t.cache,redirect:t.redirect,referrer:t.referrer,integrity:t.integrity});r(e,i)}})))}))}))}else r(e,t)}))}();
